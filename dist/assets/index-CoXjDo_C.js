var RS=Object.defineProperty;var DS=(t,e,n)=>e in t?RS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var un=(t,e,n)=>DS(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var wO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function OS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ww={exports:{}},om={},_w={exports:{}},Ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mh=Symbol.for("react.element"),MS=Symbol.for("react.portal"),FS=Symbol.for("react.fragment"),VS=Symbol.for("react.strict_mode"),US=Symbol.for("react.profiler"),BS=Symbol.for("react.provider"),qS=Symbol.for("react.context"),zS=Symbol.for("react.forward_ref"),$S=Symbol.for("react.suspense"),HS=Symbol.for("react.memo"),WS=Symbol.for("react.lazy"),Cy=Symbol.iterator;function GS(t){return t===null||typeof t!="object"?null:(t=Cy&&t[Cy]||t["@@iterator"],typeof t=="function"?t:null)}var Nw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Aw=Object.assign,Sw={};function Eu(t,e,n){this.props=t,this.context=e,this.refs=Sw,this.updater=n||Nw}Eu.prototype.isReactComponent={};Eu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Eu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Ew(){}Ew.prototype=Eu.prototype;function Y1(t,e,n){this.props=t,this.context=e,this.refs=Sw,this.updater=n||Nw}var Q1=Y1.prototype=new Ew;Q1.constructor=Y1;Aw(Q1,Eu.prototype);Q1.isPureReactComponent=!0;var ky=Array.isArray,Tw=Object.prototype.hasOwnProperty,X1={current:null},Cw={key:!0,ref:!0,__self:!0,__source:!0};function kw(t,e,n){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)Tw.call(e,r)&&!Cw.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:mh,type:t,key:s,ref:a,props:i,_owner:X1.current}}function KS(t,e){return{$$typeof:mh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function J1(t){return typeof t=="object"&&t!==null&&t.$$typeof===mh}function YS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Iy=/\/+/g;function pg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?YS(""+t.key):e.toString(36)}function Df(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case mh:case MS:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+pg(a,0):r,ky(i)?(n="",t!=null&&(n=t.replace(Iy,"$&/")+"/"),Df(i,e,n,"",function(u){return u})):i!=null&&(J1(i)&&(i=KS(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Iy,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",ky(t))for(var l=0;l<t.length;l++){s=t[l];var c=r+pg(s,l);a+=Df(s,e,n,c,i)}else if(c=GS(t),typeof c=="function")for(t=c.call(t),l=0;!(s=t.next()).done;)s=s.value,c=r+pg(s,l++),a+=Df(s,e,n,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function nf(t,e,n){if(t==null)return t;var r=[],i=0;return Df(t,r,"","",function(s){return e.call(n,s,i++)}),r}function QS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var fi={current:null},Of={transition:null},XS={ReactCurrentDispatcher:fi,ReactCurrentBatchConfig:Of,ReactCurrentOwner:X1};function Iw(){throw Error("act(...) is not supported in production builds of React.")}Ft.Children={map:nf,forEach:function(t,e,n){nf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return nf(t,function(){e++}),e},toArray:function(t){return nf(t,function(e){return e})||[]},only:function(t){if(!J1(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ft.Component=Eu;Ft.Fragment=FS;Ft.Profiler=US;Ft.PureComponent=Y1;Ft.StrictMode=VS;Ft.Suspense=$S;Ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XS;Ft.act=Iw;Ft.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Aw({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=X1.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)Tw.call(e,c)&&!Cw.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:mh,type:t.type,key:i,ref:s,props:r,_owner:a}};Ft.createContext=function(t){return t={$$typeof:qS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:BS,_context:t},t.Consumer=t};Ft.createElement=kw;Ft.createFactory=function(t){var e=kw.bind(null,t);return e.type=t,e};Ft.createRef=function(){return{current:null}};Ft.forwardRef=function(t){return{$$typeof:zS,render:t}};Ft.isValidElement=J1;Ft.lazy=function(t){return{$$typeof:WS,_payload:{_status:-1,_result:t},_init:QS}};Ft.memo=function(t,e){return{$$typeof:HS,type:t,compare:e===void 0?null:e}};Ft.startTransition=function(t){var e=Of.transition;Of.transition={};try{t()}finally{Of.transition=e}};Ft.unstable_act=Iw;Ft.useCallback=function(t,e){return fi.current.useCallback(t,e)};Ft.useContext=function(t){return fi.current.useContext(t)};Ft.useDebugValue=function(){};Ft.useDeferredValue=function(t){return fi.current.useDeferredValue(t)};Ft.useEffect=function(t,e){return fi.current.useEffect(t,e)};Ft.useId=function(){return fi.current.useId()};Ft.useImperativeHandle=function(t,e,n){return fi.current.useImperativeHandle(t,e,n)};Ft.useInsertionEffect=function(t,e){return fi.current.useInsertionEffect(t,e)};Ft.useLayoutEffect=function(t,e){return fi.current.useLayoutEffect(t,e)};Ft.useMemo=function(t,e){return fi.current.useMemo(t,e)};Ft.useReducer=function(t,e,n){return fi.current.useReducer(t,e,n)};Ft.useRef=function(t){return fi.current.useRef(t)};Ft.useState=function(t){return fi.current.useState(t)};Ft.useSyncExternalStore=function(t,e,n){return fi.current.useSyncExternalStore(t,e,n)};Ft.useTransition=function(){return fi.current.useTransition()};Ft.version="18.3.1";_w.exports=Ft;var fe=_w.exports;const JS=OS(fe);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZS=fe,eE=Symbol.for("react.element"),tE=Symbol.for("react.fragment"),nE=Object.prototype.hasOwnProperty,rE=ZS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,iE={key:!0,ref:!0,__self:!0,__source:!0};function jw(t,e,n){var r,i={},s=null,a=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)nE.call(e,r)&&!iE.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:eE,type:t,key:s,ref:a,props:i,_owner:rE.current}}om.Fragment=tE;om.jsx=jw;om.jsxs=jw;ww.exports=om;var o=ww.exports,b0={},Pw={exports:{}},Xi={},Lw={exports:{}},Rw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(q,ee){var ue=q.length;q.push(ee);e:for(;0<ue;){var ce=ue-1>>>1,_=q[ce];if(0<i(_,ee))q[ce]=ee,q[ue]=_,ue=ce;else break e}}function n(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var ee=q[0],ue=q.pop();if(ue!==ee){q[0]=ue;e:for(var ce=0,_=q.length,z=_>>>1;ce<z;){var O=2*(ce+1)-1,X=q[O],Z=O+1,le=q[Z];if(0>i(X,ue))Z<_&&0>i(le,X)?(q[ce]=le,q[Z]=ue,ce=Z):(q[ce]=X,q[O]=ue,ce=O);else if(Z<_&&0>i(le,ue))q[ce]=le,q[Z]=ue,ce=Z;else break e}}return ee}function i(q,ee){var ue=q.sortIndex-ee.sortIndex;return ue!==0?ue:q.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],f=1,g=null,y=3,p=!1,T=!1,E=!1,P=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(q){for(var ee=n(u);ee!==null;){if(ee.callback===null)r(u);else if(ee.startTime<=q)r(u),ee.sortIndex=ee.expirationTime,e(c,ee);else break;ee=n(u)}}function F(q){if(E=!1,M(q),!T)if(n(c)!==null)T=!0,W(te);else{var ee=n(u);ee!==null&&K(F,ee.startTime-q)}}function te(q,ee){T=!1,E&&(E=!1,A(I),I=-1),p=!0;var ue=y;try{for(M(ee),g=n(c);g!==null&&(!(g.expirationTime>ee)||q&&!N());){var ce=g.callback;if(typeof ce=="function"){g.callback=null,y=g.priorityLevel;var _=ce(g.expirationTime<=ee);ee=t.unstable_now(),typeof _=="function"?g.callback=_:g===n(c)&&r(c),M(ee)}else r(c);g=n(c)}if(g!==null)var z=!0;else{var O=n(u);O!==null&&K(F,O.startTime-ee),z=!1}return z}finally{g=null,y=ue,p=!1}}var ae=!1,B=null,I=-1,j=5,S=-1;function N(){return!(t.unstable_now()-S<j)}function w(){if(B!==null){var q=t.unstable_now();S=q;var ee=!0;try{ee=B(!0,q)}finally{ee?k():(ae=!1,B=null)}}else ae=!1}var k;if(typeof L=="function")k=function(){L(w)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,D=H.port2;H.port1.onmessage=w,k=function(){D.postMessage(null)}}else k=function(){P(w,0)};function W(q){B=q,ae||(ae=!0,k())}function K(q,ee){I=P(function(){q(t.unstable_now())},ee)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_continueExecution=function(){T||p||(T=!0,W(te))},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(q){switch(y){case 1:case 2:case 3:var ee=3;break;default:ee=y}var ue=y;y=ee;try{return q()}finally{y=ue}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(q,ee){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ue=y;y=q;try{return ee()}finally{y=ue}},t.unstable_scheduleCallback=function(q,ee,ue){var ce=t.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?ce+ue:ce):ue=ce,q){case 1:var _=-1;break;case 2:_=250;break;case 5:_=1073741823;break;case 4:_=1e4;break;default:_=5e3}return _=ue+_,q={id:f++,callback:ee,priorityLevel:q,startTime:ue,expirationTime:_,sortIndex:-1},ue>ce?(q.sortIndex=ue,e(u,q),n(c)===null&&q===n(u)&&(E?(A(I),I=-1):E=!0,K(F,ue-ce))):(q.sortIndex=_,e(c,q),T||p||(T=!0,W(te))),q},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(q){var ee=y;return function(){var ue=y;y=ee;try{return q.apply(this,arguments)}finally{y=ue}}}})(Rw);Lw.exports=Rw;var sE=Lw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aE=fe,Qi=sE;function Me(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Dw=new Set,Ud={};function hc(t,e){uu(t,e),uu(t+"Capture",e)}function uu(t,e){for(Ud[t]=e,t=0;t<e.length;t++)Dw.add(e[t])}var Qa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),w0=Object.prototype.hasOwnProperty,oE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,jy={},Py={};function lE(t){return w0.call(Py,t)?!0:w0.call(jy,t)?!1:oE.test(t)?Py[t]=!0:(jy[t]=!0,!1)}function cE(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function uE(t,e,n,r){if(e===null||typeof e>"u"||cE(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function pi(t,e,n,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Vr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vr[t]=new pi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vr[e]=new pi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vr[t]=new pi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vr[t]=new pi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vr[t]=new pi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vr[t]=new pi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vr[t]=new pi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vr[t]=new pi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vr[t]=new pi(t,5,!1,t.toLowerCase(),null,!1,!1)});var Z1=/[\-:]([a-z])/g;function ev(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Z1,ev);Vr[e]=new pi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Z1,ev);Vr[e]=new pi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Z1,ev);Vr[e]=new pi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vr[t]=new pi(t,1,!1,t.toLowerCase(),null,!1,!1)});Vr.xlinkHref=new pi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vr[t]=new pi(t,1,!1,t.toLowerCase(),null,!0,!0)});function tv(t,e,n,r){var i=Vr.hasOwnProperty(e)?Vr[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(uE(e,n,i,r)&&(n=null),r||i===null?lE(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var oo=aE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,rf=Symbol.for("react.element"),Dc=Symbol.for("react.portal"),Oc=Symbol.for("react.fragment"),nv=Symbol.for("react.strict_mode"),_0=Symbol.for("react.profiler"),Ow=Symbol.for("react.provider"),Mw=Symbol.for("react.context"),rv=Symbol.for("react.forward_ref"),N0=Symbol.for("react.suspense"),A0=Symbol.for("react.suspense_list"),iv=Symbol.for("react.memo"),Mo=Symbol.for("react.lazy"),Fw=Symbol.for("react.offscreen"),Ly=Symbol.iterator;function rd(t){return t===null||typeof t!="object"?null:(t=Ly&&t[Ly]||t["@@iterator"],typeof t=="function"?t:null)}var qn=Object.assign,mg;function pd(t){if(mg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);mg=e&&e[1]||""}return`
`+mg+t}var gg=!1;function vg(t,e){if(!t||gg)return"";gg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,l=s.length-1;1<=a&&0<=l&&i[a]!==s[l];)l--;for(;1<=a&&0<=l;a--,l--)if(i[a]!==s[l]){if(a!==1||l!==1)do if(a--,l--,0>l||i[a]!==s[l]){var c=`
`+i[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=l);break}}}finally{gg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?pd(t):""}function dE(t){switch(t.tag){case 5:return pd(t.type);case 16:return pd("Lazy");case 13:return pd("Suspense");case 19:return pd("SuspenseList");case 0:case 2:case 15:return t=vg(t.type,!1),t;case 11:return t=vg(t.type.render,!1),t;case 1:return t=vg(t.type,!0),t;default:return""}}function S0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Oc:return"Fragment";case Dc:return"Portal";case _0:return"Profiler";case nv:return"StrictMode";case N0:return"Suspense";case A0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Mw:return(t.displayName||"Context")+".Consumer";case Ow:return(t._context.displayName||"Context")+".Provider";case rv:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case iv:return e=t.displayName||null,e!==null?e:S0(t.type)||"Memo";case Mo:e=t._payload,t=t._init;try{return S0(t(e))}catch{}}return null}function hE(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return S0(e);case 8:return e===nv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ol(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Vw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function fE(t){var e=Vw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function sf(t){t._valueTracker||(t._valueTracker=fE(t))}function Uw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Vw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function cp(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function E0(t,e){var n=e.checked;return qn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ry(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ol(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Bw(t,e){e=e.checked,e!=null&&tv(t,"checked",e,!1)}function T0(t,e){Bw(t,e);var n=ol(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?C0(t,e.type,n):e.hasOwnProperty("defaultValue")&&C0(t,e.type,ol(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Dy(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function C0(t,e,n){(e!=="number"||cp(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var md=Array.isArray;function Yc(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ol(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function k0(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Me(91));return qn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Oy(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Me(92));if(md(n)){if(1<n.length)throw Error(Me(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ol(n)}}function qw(t,e){var n=ol(e.value),r=ol(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function My(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function zw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function I0(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?zw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var af,$w=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(af=af||document.createElement("div"),af.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=af.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Bd(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ad={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pE=["Webkit","ms","Moz","O"];Object.keys(Ad).forEach(function(t){pE.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ad[e]=Ad[t]})});function Hw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ad.hasOwnProperty(t)&&Ad[t]?(""+e).trim():e+"px"}function Ww(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Hw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var mE=qn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function j0(t,e){if(e){if(mE[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Me(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Me(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Me(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Me(62))}}function P0(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var L0=null;function sv(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var R0=null,Qc=null,Xc=null;function Fy(t){if(t=yh(t)){if(typeof R0!="function")throw Error(Me(280));var e=t.stateNode;e&&(e=hm(e),R0(t.stateNode,t.type,e))}}function Gw(t){Qc?Xc?Xc.push(t):Xc=[t]:Qc=t}function Kw(){if(Qc){var t=Qc,e=Xc;if(Xc=Qc=null,Fy(t),e)for(t=0;t<e.length;t++)Fy(e[t])}}function Yw(t,e){return t(e)}function Qw(){}var yg=!1;function Xw(t,e,n){if(yg)return t(e,n);yg=!0;try{return Yw(t,e,n)}finally{yg=!1,(Qc!==null||Xc!==null)&&(Qw(),Kw())}}function qd(t,e){var n=t.stateNode;if(n===null)return null;var r=hm(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Me(231,e,typeof n));return n}var D0=!1;if(Qa)try{var id={};Object.defineProperty(id,"passive",{get:function(){D0=!0}}),window.addEventListener("test",id,id),window.removeEventListener("test",id,id)}catch{D0=!1}function gE(t,e,n,r,i,s,a,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var Sd=!1,up=null,dp=!1,O0=null,vE={onError:function(t){Sd=!0,up=t}};function yE(t,e,n,r,i,s,a,l,c){Sd=!1,up=null,gE.apply(vE,arguments)}function xE(t,e,n,r,i,s,a,l,c){if(yE.apply(this,arguments),Sd){if(Sd){var u=up;Sd=!1,up=null}else throw Error(Me(198));dp||(dp=!0,O0=u)}}function fc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Jw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Vy(t){if(fc(t)!==t)throw Error(Me(188))}function bE(t){var e=t.alternate;if(!e){if(e=fc(t),e===null)throw Error(Me(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Vy(i),t;if(s===r)return Vy(i),e;s=s.sibling}throw Error(Me(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a)throw Error(Me(189))}}if(n.alternate!==r)throw Error(Me(190))}if(n.tag!==3)throw Error(Me(188));return n.stateNode.current===n?t:e}function Zw(t){return t=bE(t),t!==null?e_(t):null}function e_(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=e_(t);if(e!==null)return e;t=t.sibling}return null}var t_=Qi.unstable_scheduleCallback,Uy=Qi.unstable_cancelCallback,wE=Qi.unstable_shouldYield,_E=Qi.unstable_requestPaint,rr=Qi.unstable_now,NE=Qi.unstable_getCurrentPriorityLevel,av=Qi.unstable_ImmediatePriority,n_=Qi.unstable_UserBlockingPriority,hp=Qi.unstable_NormalPriority,AE=Qi.unstable_LowPriority,r_=Qi.unstable_IdlePriority,lm=null,ca=null;function SE(t){if(ca&&typeof ca.onCommitFiberRoot=="function")try{ca.onCommitFiberRoot(lm,t,void 0,(t.current.flags&128)===128)}catch{}}var Ps=Math.clz32?Math.clz32:CE,EE=Math.log,TE=Math.LN2;function CE(t){return t>>>=0,t===0?32:31-(EE(t)/TE|0)|0}var of=64,lf=4194304;function gd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function fp(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~i;l!==0?r=gd(l):(s&=a,s!==0&&(r=gd(s)))}else a=n&~i,a!==0?r=gd(a):s!==0&&(r=gd(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ps(e),i=1<<n,r|=t[n],e&=~i;return r}function kE(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function IE(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Ps(s),l=1<<a,c=i[a];c===-1?(!(l&n)||l&r)&&(i[a]=kE(l,e)):c<=e&&(t.expiredLanes|=l),s&=~l}}function M0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function i_(){var t=of;return of<<=1,!(of&4194240)&&(of=64),t}function xg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function gh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ps(e),t[e]=n}function jE(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ps(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function ov(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ps(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var hn=0;function s_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var a_,lv,o_,l_,c_,F0=!1,cf=[],Yo=null,Qo=null,Xo=null,zd=new Map,$d=new Map,Vo=[],PE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function By(t,e){switch(t){case"focusin":case"focusout":Yo=null;break;case"dragenter":case"dragleave":Qo=null;break;case"mouseover":case"mouseout":Xo=null;break;case"pointerover":case"pointerout":zd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$d.delete(e.pointerId)}}function sd(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=yh(e),e!==null&&lv(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function LE(t,e,n,r,i){switch(e){case"focusin":return Yo=sd(Yo,t,e,n,r,i),!0;case"dragenter":return Qo=sd(Qo,t,e,n,r,i),!0;case"mouseover":return Xo=sd(Xo,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return zd.set(s,sd(zd.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,$d.set(s,sd($d.get(s)||null,t,e,n,r,i)),!0}return!1}function u_(t){var e=zl(t.target);if(e!==null){var n=fc(e);if(n!==null){if(e=n.tag,e===13){if(e=Jw(n),e!==null){t.blockedOn=e,c_(t.priority,function(){o_(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Mf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=V0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);L0=r,n.target.dispatchEvent(r),L0=null}else return e=yh(n),e!==null&&lv(e),t.blockedOn=n,!1;e.shift()}return!0}function qy(t,e,n){Mf(t)&&n.delete(e)}function RE(){F0=!1,Yo!==null&&Mf(Yo)&&(Yo=null),Qo!==null&&Mf(Qo)&&(Qo=null),Xo!==null&&Mf(Xo)&&(Xo=null),zd.forEach(qy),$d.forEach(qy)}function ad(t,e){t.blockedOn===e&&(t.blockedOn=null,F0||(F0=!0,Qi.unstable_scheduleCallback(Qi.unstable_NormalPriority,RE)))}function Hd(t){function e(i){return ad(i,t)}if(0<cf.length){ad(cf[0],t);for(var n=1;n<cf.length;n++){var r=cf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Yo!==null&&ad(Yo,t),Qo!==null&&ad(Qo,t),Xo!==null&&ad(Xo,t),zd.forEach(e),$d.forEach(e),n=0;n<Vo.length;n++)r=Vo[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Vo.length&&(n=Vo[0],n.blockedOn===null);)u_(n),n.blockedOn===null&&Vo.shift()}var Jc=oo.ReactCurrentBatchConfig,pp=!0;function DE(t,e,n,r){var i=hn,s=Jc.transition;Jc.transition=null;try{hn=1,cv(t,e,n,r)}finally{hn=i,Jc.transition=s}}function OE(t,e,n,r){var i=hn,s=Jc.transition;Jc.transition=null;try{hn=4,cv(t,e,n,r)}finally{hn=i,Jc.transition=s}}function cv(t,e,n,r){if(pp){var i=V0(t,e,n,r);if(i===null)kg(t,e,r,mp,n),By(t,r);else if(LE(i,t,e,n,r))r.stopPropagation();else if(By(t,r),e&4&&-1<PE.indexOf(t)){for(;i!==null;){var s=yh(i);if(s!==null&&a_(s),s=V0(t,e,n,r),s===null&&kg(t,e,r,mp,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else kg(t,e,r,null,n)}}var mp=null;function V0(t,e,n,r){if(mp=null,t=sv(r),t=zl(t),t!==null)if(e=fc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Jw(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return mp=t,null}function d_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(NE()){case av:return 1;case n_:return 4;case hp:case AE:return 16;case r_:return 536870912;default:return 16}default:return 16}}var Ho=null,uv=null,Ff=null;function h_(){if(Ff)return Ff;var t,e=uv,n=e.length,r,i="value"in Ho?Ho.value:Ho.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[s-r];r++);return Ff=i.slice(t,1<r?1-r:void 0)}function Vf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function uf(){return!0}function zy(){return!1}function Ji(t){function e(n,r,i,s,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?uf:zy,this.isPropagationStopped=zy,this}return qn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=uf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=uf)},persist:function(){},isPersistent:uf}),e}var Tu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dv=Ji(Tu),vh=qn({},Tu,{view:0,detail:0}),ME=Ji(vh),bg,wg,od,cm=qn({},vh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hv,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==od&&(od&&t.type==="mousemove"?(bg=t.screenX-od.screenX,wg=t.screenY-od.screenY):wg=bg=0,od=t),bg)},movementY:function(t){return"movementY"in t?t.movementY:wg}}),$y=Ji(cm),FE=qn({},cm,{dataTransfer:0}),VE=Ji(FE),UE=qn({},vh,{relatedTarget:0}),_g=Ji(UE),BE=qn({},Tu,{animationName:0,elapsedTime:0,pseudoElement:0}),qE=Ji(BE),zE=qn({},Tu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),$E=Ji(zE),HE=qn({},Tu,{data:0}),Hy=Ji(HE),WE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},GE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},KE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function YE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=KE[t])?!!e[t]:!1}function hv(){return YE}var QE=qn({},vh,{key:function(t){if(t.key){var e=WE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Vf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?GE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hv,charCode:function(t){return t.type==="keypress"?Vf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Vf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),XE=Ji(QE),JE=qn({},cm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wy=Ji(JE),ZE=qn({},vh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hv}),eT=Ji(ZE),tT=qn({},Tu,{propertyName:0,elapsedTime:0,pseudoElement:0}),nT=Ji(tT),rT=qn({},cm,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),iT=Ji(rT),sT=[9,13,27,32],fv=Qa&&"CompositionEvent"in window,Ed=null;Qa&&"documentMode"in document&&(Ed=document.documentMode);var aT=Qa&&"TextEvent"in window&&!Ed,f_=Qa&&(!fv||Ed&&8<Ed&&11>=Ed),Gy=" ",Ky=!1;function p_(t,e){switch(t){case"keyup":return sT.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function m_(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Mc=!1;function oT(t,e){switch(t){case"compositionend":return m_(e);case"keypress":return e.which!==32?null:(Ky=!0,Gy);case"textInput":return t=e.data,t===Gy&&Ky?null:t;default:return null}}function lT(t,e){if(Mc)return t==="compositionend"||!fv&&p_(t,e)?(t=h_(),Ff=uv=Ho=null,Mc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return f_&&e.locale!=="ko"?null:e.data;default:return null}}var cT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!cT[t.type]:e==="textarea"}function g_(t,e,n,r){Gw(r),e=gp(e,"onChange"),0<e.length&&(n=new dv("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Td=null,Wd=null;function uT(t){T_(t,0)}function um(t){var e=Uc(t);if(Uw(e))return t}function dT(t,e){if(t==="change")return e}var v_=!1;if(Qa){var Ng;if(Qa){var Ag="oninput"in document;if(!Ag){var Qy=document.createElement("div");Qy.setAttribute("oninput","return;"),Ag=typeof Qy.oninput=="function"}Ng=Ag}else Ng=!1;v_=Ng&&(!document.documentMode||9<document.documentMode)}function Xy(){Td&&(Td.detachEvent("onpropertychange",y_),Wd=Td=null)}function y_(t){if(t.propertyName==="value"&&um(Wd)){var e=[];g_(e,Wd,t,sv(t)),Xw(uT,e)}}function hT(t,e,n){t==="focusin"?(Xy(),Td=e,Wd=n,Td.attachEvent("onpropertychange",y_)):t==="focusout"&&Xy()}function fT(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return um(Wd)}function pT(t,e){if(t==="click")return um(e)}function mT(t,e){if(t==="input"||t==="change")return um(e)}function gT(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Rs=typeof Object.is=="function"?Object.is:gT;function Gd(t,e){if(Rs(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!w0.call(e,i)||!Rs(t[i],e[i]))return!1}return!0}function Jy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Zy(t,e){var n=Jy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Jy(n)}}function x_(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?x_(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function b_(){for(var t=window,e=cp();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=cp(t.document)}return e}function pv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function vT(t){var e=b_(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&x_(n.ownerDocument.documentElement,n)){if(r!==null&&pv(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Zy(n,s);var a=Zy(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var yT=Qa&&"documentMode"in document&&11>=document.documentMode,Fc=null,U0=null,Cd=null,B0=!1;function ex(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;B0||Fc==null||Fc!==cp(r)||(r=Fc,"selectionStart"in r&&pv(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Cd&&Gd(Cd,r)||(Cd=r,r=gp(U0,"onSelect"),0<r.length&&(e=new dv("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Fc)))}function df(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Vc={animationend:df("Animation","AnimationEnd"),animationiteration:df("Animation","AnimationIteration"),animationstart:df("Animation","AnimationStart"),transitionend:df("Transition","TransitionEnd")},Sg={},w_={};Qa&&(w_=document.createElement("div").style,"AnimationEvent"in window||(delete Vc.animationend.animation,delete Vc.animationiteration.animation,delete Vc.animationstart.animation),"TransitionEvent"in window||delete Vc.transitionend.transition);function dm(t){if(Sg[t])return Sg[t];if(!Vc[t])return t;var e=Vc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in w_)return Sg[t]=e[n];return t}var __=dm("animationend"),N_=dm("animationiteration"),A_=dm("animationstart"),S_=dm("transitionend"),E_=new Map,tx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ml(t,e){E_.set(t,e),hc(e,[t])}for(var Eg=0;Eg<tx.length;Eg++){var Tg=tx[Eg],xT=Tg.toLowerCase(),bT=Tg[0].toUpperCase()+Tg.slice(1);ml(xT,"on"+bT)}ml(__,"onAnimationEnd");ml(N_,"onAnimationIteration");ml(A_,"onAnimationStart");ml("dblclick","onDoubleClick");ml("focusin","onFocus");ml("focusout","onBlur");ml(S_,"onTransitionEnd");uu("onMouseEnter",["mouseout","mouseover"]);uu("onMouseLeave",["mouseout","mouseover"]);uu("onPointerEnter",["pointerout","pointerover"]);uu("onPointerLeave",["pointerout","pointerover"]);hc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));hc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));hc("onBeforeInput",["compositionend","keypress","textInput","paste"]);hc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));hc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));hc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wT=new Set("cancel close invalid load scroll toggle".split(" ").concat(vd));function nx(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,xE(r,e,void 0,t),t.currentTarget=null}function T_(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;nx(i,l,u),s=c}else for(a=0;a<r.length;a++){if(l=r[a],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;nx(i,l,u),s=c}}}if(dp)throw t=O0,dp=!1,O0=null,t}function Sn(t,e){var n=e[W0];n===void 0&&(n=e[W0]=new Set);var r=t+"__bubble";n.has(r)||(C_(e,t,2,!1),n.add(r))}function Cg(t,e,n){var r=0;e&&(r|=4),C_(n,t,r,e)}var hf="_reactListening"+Math.random().toString(36).slice(2);function Kd(t){if(!t[hf]){t[hf]=!0,Dw.forEach(function(n){n!=="selectionchange"&&(wT.has(n)||Cg(n,!1,t),Cg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[hf]||(e[hf]=!0,Cg("selectionchange",!1,e))}}function C_(t,e,n,r){switch(d_(e)){case 1:var i=DE;break;case 4:i=OE;break;default:i=cv}n=i.bind(null,e,n,t),i=void 0,!D0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function kg(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;a=a.return}for(;l!==null;){if(a=zl(l),a===null)return;if(c=a.tag,c===5||c===6){r=s=a;continue e}l=l.parentNode}}r=r.return}Xw(function(){var u=s,f=sv(n),g=[];e:{var y=E_.get(t);if(y!==void 0){var p=dv,T=t;switch(t){case"keypress":if(Vf(n)===0)break e;case"keydown":case"keyup":p=XE;break;case"focusin":T="focus",p=_g;break;case"focusout":T="blur",p=_g;break;case"beforeblur":case"afterblur":p=_g;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=$y;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=VE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=eT;break;case __:case N_:case A_:p=qE;break;case S_:p=nT;break;case"scroll":p=ME;break;case"wheel":p=iT;break;case"copy":case"cut":case"paste":p=$E;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Wy}var E=(e&4)!==0,P=!E&&t==="scroll",A=E?y!==null?y+"Capture":null:y;E=[];for(var L=u,M;L!==null;){M=L;var F=M.stateNode;if(M.tag===5&&F!==null&&(M=F,A!==null&&(F=qd(L,A),F!=null&&E.push(Yd(L,F,M)))),P)break;L=L.return}0<E.length&&(y=new p(y,T,null,n,f),g.push({event:y,listeners:E}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",y&&n!==L0&&(T=n.relatedTarget||n.fromElement)&&(zl(T)||T[Xa]))break e;if((p||y)&&(y=f.window===f?f:(y=f.ownerDocument)?y.defaultView||y.parentWindow:window,p?(T=n.relatedTarget||n.toElement,p=u,T=T?zl(T):null,T!==null&&(P=fc(T),T!==P||T.tag!==5&&T.tag!==6)&&(T=null)):(p=null,T=u),p!==T)){if(E=$y,F="onMouseLeave",A="onMouseEnter",L="mouse",(t==="pointerout"||t==="pointerover")&&(E=Wy,F="onPointerLeave",A="onPointerEnter",L="pointer"),P=p==null?y:Uc(p),M=T==null?y:Uc(T),y=new E(F,L+"leave",p,n,f),y.target=P,y.relatedTarget=M,F=null,zl(f)===u&&(E=new E(A,L+"enter",T,n,f),E.target=M,E.relatedTarget=P,F=E),P=F,p&&T)t:{for(E=p,A=T,L=0,M=E;M;M=Ec(M))L++;for(M=0,F=A;F;F=Ec(F))M++;for(;0<L-M;)E=Ec(E),L--;for(;0<M-L;)A=Ec(A),M--;for(;L--;){if(E===A||A!==null&&E===A.alternate)break t;E=Ec(E),A=Ec(A)}E=null}else E=null;p!==null&&rx(g,y,p,E,!1),T!==null&&P!==null&&rx(g,P,T,E,!0)}}e:{if(y=u?Uc(u):window,p=y.nodeName&&y.nodeName.toLowerCase(),p==="select"||p==="input"&&y.type==="file")var te=dT;else if(Yy(y))if(v_)te=mT;else{te=fT;var ae=hT}else(p=y.nodeName)&&p.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(te=pT);if(te&&(te=te(t,u))){g_(g,te,n,f);break e}ae&&ae(t,y,u),t==="focusout"&&(ae=y._wrapperState)&&ae.controlled&&y.type==="number"&&C0(y,"number",y.value)}switch(ae=u?Uc(u):window,t){case"focusin":(Yy(ae)||ae.contentEditable==="true")&&(Fc=ae,U0=u,Cd=null);break;case"focusout":Cd=U0=Fc=null;break;case"mousedown":B0=!0;break;case"contextmenu":case"mouseup":case"dragend":B0=!1,ex(g,n,f);break;case"selectionchange":if(yT)break;case"keydown":case"keyup":ex(g,n,f)}var B;if(fv)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Mc?p_(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(f_&&n.locale!=="ko"&&(Mc||I!=="onCompositionStart"?I==="onCompositionEnd"&&Mc&&(B=h_()):(Ho=f,uv="value"in Ho?Ho.value:Ho.textContent,Mc=!0)),ae=gp(u,I),0<ae.length&&(I=new Hy(I,t,null,n,f),g.push({event:I,listeners:ae}),B?I.data=B:(B=m_(n),B!==null&&(I.data=B)))),(B=aT?oT(t,n):lT(t,n))&&(u=gp(u,"onBeforeInput"),0<u.length&&(f=new Hy("onBeforeInput","beforeinput",null,n,f),g.push({event:f,listeners:u}),f.data=B))}T_(g,e)})}function Yd(t,e,n){return{instance:t,listener:e,currentTarget:n}}function gp(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=qd(t,n),s!=null&&r.unshift(Yd(t,s,i)),s=qd(t,e),s!=null&&r.push(Yd(t,s,i))),t=t.return}return r}function Ec(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function rx(t,e,n,r,i){for(var s=e._reactName,a=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,i?(c=qd(n,s),c!=null&&a.unshift(Yd(n,c,l))):i||(c=qd(n,s),c!=null&&a.push(Yd(n,c,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var _T=/\r\n?/g,NT=/\u0000|\uFFFD/g;function ix(t){return(typeof t=="string"?t:""+t).replace(_T,`
`).replace(NT,"")}function ff(t,e,n){if(e=ix(e),ix(t)!==e&&n)throw Error(Me(425))}function vp(){}var q0=null,z0=null;function $0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var H0=typeof setTimeout=="function"?setTimeout:void 0,AT=typeof clearTimeout=="function"?clearTimeout:void 0,sx=typeof Promise=="function"?Promise:void 0,ST=typeof queueMicrotask=="function"?queueMicrotask:typeof sx<"u"?function(t){return sx.resolve(null).then(t).catch(ET)}:H0;function ET(t){setTimeout(function(){throw t})}function Ig(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Hd(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Hd(e)}function Jo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ax(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Cu=Math.random().toString(36).slice(2),aa="__reactFiber$"+Cu,Qd="__reactProps$"+Cu,Xa="__reactContainer$"+Cu,W0="__reactEvents$"+Cu,TT="__reactListeners$"+Cu,CT="__reactHandles$"+Cu;function zl(t){var e=t[aa];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Xa]||n[aa]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=ax(t);t!==null;){if(n=t[aa])return n;t=ax(t)}return e}t=n,n=t.parentNode}return null}function yh(t){return t=t[aa]||t[Xa],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Uc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Me(33))}function hm(t){return t[Qd]||null}var G0=[],Bc=-1;function gl(t){return{current:t}}function Cn(t){0>Bc||(t.current=G0[Bc],G0[Bc]=null,Bc--)}function wn(t,e){Bc++,G0[Bc]=t.current,t.current=e}var ll={},ri=gl(ll),Ai=gl(!1),ec=ll;function du(t,e){var n=t.type.contextTypes;if(!n)return ll;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Si(t){return t=t.childContextTypes,t!=null}function yp(){Cn(Ai),Cn(ri)}function ox(t,e,n){if(ri.current!==ll)throw Error(Me(168));wn(ri,e),wn(Ai,n)}function k_(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Me(108,hE(t)||"Unknown",i));return qn({},n,r)}function xp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ll,ec=ri.current,wn(ri,t),wn(Ai,Ai.current),!0}function lx(t,e,n){var r=t.stateNode;if(!r)throw Error(Me(169));n?(t=k_(t,e,ec),r.__reactInternalMemoizedMergedChildContext=t,Cn(Ai),Cn(ri),wn(ri,t)):Cn(Ai),wn(Ai,n)}var Ua=null,fm=!1,jg=!1;function I_(t){Ua===null?Ua=[t]:Ua.push(t)}function kT(t){fm=!0,I_(t)}function vl(){if(!jg&&Ua!==null){jg=!0;var t=0,e=hn;try{var n=Ua;for(hn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ua=null,fm=!1}catch(i){throw Ua!==null&&(Ua=Ua.slice(t+1)),t_(av,vl),i}finally{hn=e,jg=!1}}return null}var qc=[],zc=0,bp=null,wp=0,os=[],ls=0,tc=null,qa=1,za="";function Fl(t,e){qc[zc++]=wp,qc[zc++]=bp,bp=t,wp=e}function j_(t,e,n){os[ls++]=qa,os[ls++]=za,os[ls++]=tc,tc=t;var r=qa;t=za;var i=32-Ps(r)-1;r&=~(1<<i),n+=1;var s=32-Ps(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,qa=1<<32-Ps(e)+i|n<<i|r,za=s+t}else qa=1<<s|n<<i|r,za=t}function mv(t){t.return!==null&&(Fl(t,1),j_(t,1,0))}function gv(t){for(;t===bp;)bp=qc[--zc],qc[zc]=null,wp=qc[--zc],qc[zc]=null;for(;t===tc;)tc=os[--ls],os[ls]=null,za=os[--ls],os[ls]=null,qa=os[--ls],os[ls]=null}var Ki=null,Hi=null,Rn=!1,Is=null;function P_(t,e){var n=us(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function cx(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ki=t,Hi=Jo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ki=t,Hi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=tc!==null?{id:qa,overflow:za}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=us(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ki=t,Hi=null,!0):!1;default:return!1}}function K0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Y0(t){if(Rn){var e=Hi;if(e){var n=e;if(!cx(t,e)){if(K0(t))throw Error(Me(418));e=Jo(n.nextSibling);var r=Ki;e&&cx(t,e)?P_(r,n):(t.flags=t.flags&-4097|2,Rn=!1,Ki=t)}}else{if(K0(t))throw Error(Me(418));t.flags=t.flags&-4097|2,Rn=!1,Ki=t}}}function ux(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ki=t}function pf(t){if(t!==Ki)return!1;if(!Rn)return ux(t),Rn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!$0(t.type,t.memoizedProps)),e&&(e=Hi)){if(K0(t))throw L_(),Error(Me(418));for(;e;)P_(t,e),e=Jo(e.nextSibling)}if(ux(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Me(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Hi=Jo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Hi=null}}else Hi=Ki?Jo(t.stateNode.nextSibling):null;return!0}function L_(){for(var t=Hi;t;)t=Jo(t.nextSibling)}function hu(){Hi=Ki=null,Rn=!1}function vv(t){Is===null?Is=[t]:Is.push(t)}var IT=oo.ReactCurrentBatchConfig;function ld(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Me(309));var r=n.stateNode}if(!r)throw Error(Me(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var l=i.refs;a===null?delete l[s]:l[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(Me(284));if(!n._owner)throw Error(Me(290,t))}return t}function mf(t,e){throw t=Object.prototype.toString.call(e),Error(Me(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function dx(t){var e=t._init;return e(t._payload)}function R_(t){function e(A,L){if(t){var M=A.deletions;M===null?(A.deletions=[L],A.flags|=16):M.push(L)}}function n(A,L){if(!t)return null;for(;L!==null;)e(A,L),L=L.sibling;return null}function r(A,L){for(A=new Map;L!==null;)L.key!==null?A.set(L.key,L):A.set(L.index,L),L=L.sibling;return A}function i(A,L){return A=nl(A,L),A.index=0,A.sibling=null,A}function s(A,L,M){return A.index=M,t?(M=A.alternate,M!==null?(M=M.index,M<L?(A.flags|=2,L):M):(A.flags|=2,L)):(A.flags|=1048576,L)}function a(A){return t&&A.alternate===null&&(A.flags|=2),A}function l(A,L,M,F){return L===null||L.tag!==6?(L=Fg(M,A.mode,F),L.return=A,L):(L=i(L,M),L.return=A,L)}function c(A,L,M,F){var te=M.type;return te===Oc?f(A,L,M.props.children,F,M.key):L!==null&&(L.elementType===te||typeof te=="object"&&te!==null&&te.$$typeof===Mo&&dx(te)===L.type)?(F=i(L,M.props),F.ref=ld(A,L,M),F.return=A,F):(F=Wf(M.type,M.key,M.props,null,A.mode,F),F.ref=ld(A,L,M),F.return=A,F)}function u(A,L,M,F){return L===null||L.tag!==4||L.stateNode.containerInfo!==M.containerInfo||L.stateNode.implementation!==M.implementation?(L=Vg(M,A.mode,F),L.return=A,L):(L=i(L,M.children||[]),L.return=A,L)}function f(A,L,M,F,te){return L===null||L.tag!==7?(L=Yl(M,A.mode,F,te),L.return=A,L):(L=i(L,M),L.return=A,L)}function g(A,L,M){if(typeof L=="string"&&L!==""||typeof L=="number")return L=Fg(""+L,A.mode,M),L.return=A,L;if(typeof L=="object"&&L!==null){switch(L.$$typeof){case rf:return M=Wf(L.type,L.key,L.props,null,A.mode,M),M.ref=ld(A,null,L),M.return=A,M;case Dc:return L=Vg(L,A.mode,M),L.return=A,L;case Mo:var F=L._init;return g(A,F(L._payload),M)}if(md(L)||rd(L))return L=Yl(L,A.mode,M,null),L.return=A,L;mf(A,L)}return null}function y(A,L,M,F){var te=L!==null?L.key:null;if(typeof M=="string"&&M!==""||typeof M=="number")return te!==null?null:l(A,L,""+M,F);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case rf:return M.key===te?c(A,L,M,F):null;case Dc:return M.key===te?u(A,L,M,F):null;case Mo:return te=M._init,y(A,L,te(M._payload),F)}if(md(M)||rd(M))return te!==null?null:f(A,L,M,F,null);mf(A,M)}return null}function p(A,L,M,F,te){if(typeof F=="string"&&F!==""||typeof F=="number")return A=A.get(M)||null,l(L,A,""+F,te);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case rf:return A=A.get(F.key===null?M:F.key)||null,c(L,A,F,te);case Dc:return A=A.get(F.key===null?M:F.key)||null,u(L,A,F,te);case Mo:var ae=F._init;return p(A,L,M,ae(F._payload),te)}if(md(F)||rd(F))return A=A.get(M)||null,f(L,A,F,te,null);mf(L,F)}return null}function T(A,L,M,F){for(var te=null,ae=null,B=L,I=L=0,j=null;B!==null&&I<M.length;I++){B.index>I?(j=B,B=null):j=B.sibling;var S=y(A,B,M[I],F);if(S===null){B===null&&(B=j);break}t&&B&&S.alternate===null&&e(A,B),L=s(S,L,I),ae===null?te=S:ae.sibling=S,ae=S,B=j}if(I===M.length)return n(A,B),Rn&&Fl(A,I),te;if(B===null){for(;I<M.length;I++)B=g(A,M[I],F),B!==null&&(L=s(B,L,I),ae===null?te=B:ae.sibling=B,ae=B);return Rn&&Fl(A,I),te}for(B=r(A,B);I<M.length;I++)j=p(B,A,I,M[I],F),j!==null&&(t&&j.alternate!==null&&B.delete(j.key===null?I:j.key),L=s(j,L,I),ae===null?te=j:ae.sibling=j,ae=j);return t&&B.forEach(function(N){return e(A,N)}),Rn&&Fl(A,I),te}function E(A,L,M,F){var te=rd(M);if(typeof te!="function")throw Error(Me(150));if(M=te.call(M),M==null)throw Error(Me(151));for(var ae=te=null,B=L,I=L=0,j=null,S=M.next();B!==null&&!S.done;I++,S=M.next()){B.index>I?(j=B,B=null):j=B.sibling;var N=y(A,B,S.value,F);if(N===null){B===null&&(B=j);break}t&&B&&N.alternate===null&&e(A,B),L=s(N,L,I),ae===null?te=N:ae.sibling=N,ae=N,B=j}if(S.done)return n(A,B),Rn&&Fl(A,I),te;if(B===null){for(;!S.done;I++,S=M.next())S=g(A,S.value,F),S!==null&&(L=s(S,L,I),ae===null?te=S:ae.sibling=S,ae=S);return Rn&&Fl(A,I),te}for(B=r(A,B);!S.done;I++,S=M.next())S=p(B,A,I,S.value,F),S!==null&&(t&&S.alternate!==null&&B.delete(S.key===null?I:S.key),L=s(S,L,I),ae===null?te=S:ae.sibling=S,ae=S);return t&&B.forEach(function(w){return e(A,w)}),Rn&&Fl(A,I),te}function P(A,L,M,F){if(typeof M=="object"&&M!==null&&M.type===Oc&&M.key===null&&(M=M.props.children),typeof M=="object"&&M!==null){switch(M.$$typeof){case rf:e:{for(var te=M.key,ae=L;ae!==null;){if(ae.key===te){if(te=M.type,te===Oc){if(ae.tag===7){n(A,ae.sibling),L=i(ae,M.props.children),L.return=A,A=L;break e}}else if(ae.elementType===te||typeof te=="object"&&te!==null&&te.$$typeof===Mo&&dx(te)===ae.type){n(A,ae.sibling),L=i(ae,M.props),L.ref=ld(A,ae,M),L.return=A,A=L;break e}n(A,ae);break}else e(A,ae);ae=ae.sibling}M.type===Oc?(L=Yl(M.props.children,A.mode,F,M.key),L.return=A,A=L):(F=Wf(M.type,M.key,M.props,null,A.mode,F),F.ref=ld(A,L,M),F.return=A,A=F)}return a(A);case Dc:e:{for(ae=M.key;L!==null;){if(L.key===ae)if(L.tag===4&&L.stateNode.containerInfo===M.containerInfo&&L.stateNode.implementation===M.implementation){n(A,L.sibling),L=i(L,M.children||[]),L.return=A,A=L;break e}else{n(A,L);break}else e(A,L);L=L.sibling}L=Vg(M,A.mode,F),L.return=A,A=L}return a(A);case Mo:return ae=M._init,P(A,L,ae(M._payload),F)}if(md(M))return T(A,L,M,F);if(rd(M))return E(A,L,M,F);mf(A,M)}return typeof M=="string"&&M!==""||typeof M=="number"?(M=""+M,L!==null&&L.tag===6?(n(A,L.sibling),L=i(L,M),L.return=A,A=L):(n(A,L),L=Fg(M,A.mode,F),L.return=A,A=L),a(A)):n(A,L)}return P}var fu=R_(!0),D_=R_(!1),_p=gl(null),Np=null,$c=null,yv=null;function xv(){yv=$c=Np=null}function bv(t){var e=_p.current;Cn(_p),t._currentValue=e}function Q0(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Zc(t,e){Np=t,yv=$c=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ni=!0),t.firstContext=null)}function ps(t){var e=t._currentValue;if(yv!==t)if(t={context:t,memoizedValue:e,next:null},$c===null){if(Np===null)throw Error(Me(308));$c=t,Np.dependencies={lanes:0,firstContext:t}}else $c=$c.next=t;return e}var $l=null;function wv(t){$l===null?$l=[t]:$l.push(t)}function O_(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,wv(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ja(t,r)}function Ja(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Fo=!1;function _v(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function M_(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ga(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Zo(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Xt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ja(t,n)}return i=r.interleaved,i===null?(e.next=e,wv(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ja(t,n)}function Uf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ov(t,n)}}function hx(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ap(t,e,n,r){var i=t.updateQueue;Fo=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,a===null?s=u:a.next=u,a=c;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==a&&(l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=c))}if(s!==null){var g=i.baseState;a=0,f=u=c=null,l=s;do{var y=l.lane,p=l.eventTime;if((r&y)===y){f!==null&&(f=f.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var T=t,E=l;switch(y=e,p=n,E.tag){case 1:if(T=E.payload,typeof T=="function"){g=T.call(p,g,y);break e}g=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=E.payload,y=typeof T=="function"?T.call(p,g,y):T,y==null)break e;g=qn({},g,y);break e;case 2:Fo=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,y=i.effects,y===null?i.effects=[l]:y.push(l))}else p={eventTime:p,lane:y,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(u=f=p,c=g):f=f.next=p,a|=y;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;y=l,l=y.next,y.next=null,i.lastBaseUpdate=y,i.shared.pending=null}}while(!0);if(f===null&&(c=g),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);rc|=a,t.lanes=a,t.memoizedState=g}}function fx(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Me(191,i));i.call(r)}}}var xh={},ua=gl(xh),Xd=gl(xh),Jd=gl(xh);function Hl(t){if(t===xh)throw Error(Me(174));return t}function Nv(t,e){switch(wn(Jd,e),wn(Xd,t),wn(ua,xh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:I0(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=I0(e,t)}Cn(ua),wn(ua,e)}function pu(){Cn(ua),Cn(Xd),Cn(Jd)}function F_(t){Hl(Jd.current);var e=Hl(ua.current),n=I0(e,t.type);e!==n&&(wn(Xd,t),wn(ua,n))}function Av(t){Xd.current===t&&(Cn(ua),Cn(Xd))}var Un=gl(0);function Sp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Pg=[];function Sv(){for(var t=0;t<Pg.length;t++)Pg[t]._workInProgressVersionPrimary=null;Pg.length=0}var Bf=oo.ReactCurrentDispatcher,Lg=oo.ReactCurrentBatchConfig,nc=0,Bn=null,vr=null,Sr=null,Ep=!1,kd=!1,Zd=0,jT=0;function Wr(){throw Error(Me(321))}function Ev(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Rs(t[n],e[n]))return!1;return!0}function Tv(t,e,n,r,i,s){if(nc=s,Bn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Bf.current=t===null||t.memoizedState===null?DT:OT,t=n(r,i),kd){s=0;do{if(kd=!1,Zd=0,25<=s)throw Error(Me(301));s+=1,Sr=vr=null,e.updateQueue=null,Bf.current=MT,t=n(r,i)}while(kd)}if(Bf.current=Tp,e=vr!==null&&vr.next!==null,nc=0,Sr=vr=Bn=null,Ep=!1,e)throw Error(Me(300));return t}function Cv(){var t=Zd!==0;return Zd=0,t}function sa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sr===null?Bn.memoizedState=Sr=t:Sr=Sr.next=t,Sr}function ms(){if(vr===null){var t=Bn.alternate;t=t!==null?t.memoizedState:null}else t=vr.next;var e=Sr===null?Bn.memoizedState:Sr.next;if(e!==null)Sr=e,vr=t;else{if(t===null)throw Error(Me(310));vr=t,t={memoizedState:vr.memoizedState,baseState:vr.baseState,baseQueue:vr.baseQueue,queue:vr.queue,next:null},Sr===null?Bn.memoizedState=Sr=t:Sr=Sr.next=t}return Sr}function eh(t,e){return typeof e=="function"?e(t):e}function Rg(t){var e=ms(),n=e.queue;if(n===null)throw Error(Me(311));n.lastRenderedReducer=t;var r=vr,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=a=null,c=null,u=s;do{var f=u.lane;if((nc&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var g={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=g,a=r):c=c.next=g,Bn.lanes|=f,rc|=f}u=u.next}while(u!==null&&u!==s);c===null?a=r:c.next=l,Rs(r,e.memoizedState)||(Ni=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Bn.lanes|=s,rc|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Dg(t){var e=ms(),n=e.queue;if(n===null)throw Error(Me(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);Rs(s,e.memoizedState)||(Ni=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function V_(){}function U_(t,e){var n=Bn,r=ms(),i=e(),s=!Rs(r.memoizedState,i);if(s&&(r.memoizedState=i,Ni=!0),r=r.queue,kv(z_.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Sr!==null&&Sr.memoizedState.tag&1){if(n.flags|=2048,th(9,q_.bind(null,n,r,i,e),void 0,null),Tr===null)throw Error(Me(349));nc&30||B_(n,e,i)}return i}function B_(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Bn.updateQueue,e===null?(e={lastEffect:null,stores:null},Bn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function q_(t,e,n,r){e.value=n,e.getSnapshot=r,$_(e)&&H_(t)}function z_(t,e,n){return n(function(){$_(e)&&H_(t)})}function $_(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Rs(t,n)}catch{return!0}}function H_(t){var e=Ja(t,1);e!==null&&Ls(e,t,1,-1)}function px(t){var e=sa();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:eh,lastRenderedState:t},e.queue=t,t=t.dispatch=RT.bind(null,Bn,t),[e.memoizedState,t]}function th(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Bn.updateQueue,e===null?(e={lastEffect:null,stores:null},Bn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function W_(){return ms().memoizedState}function qf(t,e,n,r){var i=sa();Bn.flags|=t,i.memoizedState=th(1|e,n,void 0,r===void 0?null:r)}function pm(t,e,n,r){var i=ms();r=r===void 0?null:r;var s=void 0;if(vr!==null){var a=vr.memoizedState;if(s=a.destroy,r!==null&&Ev(r,a.deps)){i.memoizedState=th(e,n,s,r);return}}Bn.flags|=t,i.memoizedState=th(1|e,n,s,r)}function mx(t,e){return qf(8390656,8,t,e)}function kv(t,e){return pm(2048,8,t,e)}function G_(t,e){return pm(4,2,t,e)}function K_(t,e){return pm(4,4,t,e)}function Y_(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Q_(t,e,n){return n=n!=null?n.concat([t]):null,pm(4,4,Y_.bind(null,e,t),n)}function Iv(){}function X_(t,e){var n=ms();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ev(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function J_(t,e){var n=ms();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ev(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Z_(t,e,n){return nc&21?(Rs(n,e)||(n=i_(),Bn.lanes|=n,rc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ni=!0),t.memoizedState=n)}function PT(t,e){var n=hn;hn=n!==0&&4>n?n:4,t(!0);var r=Lg.transition;Lg.transition={};try{t(!1),e()}finally{hn=n,Lg.transition=r}}function eN(){return ms().memoizedState}function LT(t,e,n){var r=tl(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},tN(t))nN(e,n);else if(n=O_(t,e,n,r),n!==null){var i=hi();Ls(n,t,r,i),rN(n,e,r)}}function RT(t,e,n){var r=tl(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(tN(t))nN(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,l=s(a,n);if(i.hasEagerState=!0,i.eagerState=l,Rs(l,a)){var c=e.interleaved;c===null?(i.next=i,wv(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=O_(t,e,i,r),n!==null&&(i=hi(),Ls(n,t,r,i),rN(n,e,r))}}function tN(t){var e=t.alternate;return t===Bn||e!==null&&e===Bn}function nN(t,e){kd=Ep=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function rN(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ov(t,n)}}var Tp={readContext:ps,useCallback:Wr,useContext:Wr,useEffect:Wr,useImperativeHandle:Wr,useInsertionEffect:Wr,useLayoutEffect:Wr,useMemo:Wr,useReducer:Wr,useRef:Wr,useState:Wr,useDebugValue:Wr,useDeferredValue:Wr,useTransition:Wr,useMutableSource:Wr,useSyncExternalStore:Wr,useId:Wr,unstable_isNewReconciler:!1},DT={readContext:ps,useCallback:function(t,e){return sa().memoizedState=[t,e===void 0?null:e],t},useContext:ps,useEffect:mx,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,qf(4194308,4,Y_.bind(null,e,t),n)},useLayoutEffect:function(t,e){return qf(4194308,4,t,e)},useInsertionEffect:function(t,e){return qf(4,2,t,e)},useMemo:function(t,e){var n=sa();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=sa();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=LT.bind(null,Bn,t),[r.memoizedState,t]},useRef:function(t){var e=sa();return t={current:t},e.memoizedState=t},useState:px,useDebugValue:Iv,useDeferredValue:function(t){return sa().memoizedState=t},useTransition:function(){var t=px(!1),e=t[0];return t=PT.bind(null,t[1]),sa().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Bn,i=sa();if(Rn){if(n===void 0)throw Error(Me(407));n=n()}else{if(n=e(),Tr===null)throw Error(Me(349));nc&30||B_(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,mx(z_.bind(null,r,s,t),[t]),r.flags|=2048,th(9,q_.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=sa(),e=Tr.identifierPrefix;if(Rn){var n=za,r=qa;n=(r&~(1<<32-Ps(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Zd++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=jT++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},OT={readContext:ps,useCallback:X_,useContext:ps,useEffect:kv,useImperativeHandle:Q_,useInsertionEffect:G_,useLayoutEffect:K_,useMemo:J_,useReducer:Rg,useRef:W_,useState:function(){return Rg(eh)},useDebugValue:Iv,useDeferredValue:function(t){var e=ms();return Z_(e,vr.memoizedState,t)},useTransition:function(){var t=Rg(eh)[0],e=ms().memoizedState;return[t,e]},useMutableSource:V_,useSyncExternalStore:U_,useId:eN,unstable_isNewReconciler:!1},MT={readContext:ps,useCallback:X_,useContext:ps,useEffect:kv,useImperativeHandle:Q_,useInsertionEffect:G_,useLayoutEffect:K_,useMemo:J_,useReducer:Dg,useRef:W_,useState:function(){return Dg(eh)},useDebugValue:Iv,useDeferredValue:function(t){var e=ms();return vr===null?e.memoizedState=t:Z_(e,vr.memoizedState,t)},useTransition:function(){var t=Dg(eh)[0],e=ms().memoizedState;return[t,e]},useMutableSource:V_,useSyncExternalStore:U_,useId:eN,unstable_isNewReconciler:!1};function Cs(t,e){if(t&&t.defaultProps){e=qn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function X0(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:qn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var mm={isMounted:function(t){return(t=t._reactInternals)?fc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=hi(),i=tl(t),s=Ga(r,i);s.payload=e,n!=null&&(s.callback=n),e=Zo(t,s,i),e!==null&&(Ls(e,t,i,r),Uf(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=hi(),i=tl(t),s=Ga(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Zo(t,s,i),e!==null&&(Ls(e,t,i,r),Uf(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=hi(),r=tl(t),i=Ga(n,r);i.tag=2,e!=null&&(i.callback=e),e=Zo(t,i,r),e!==null&&(Ls(e,t,r,n),Uf(e,t,r))}};function gx(t,e,n,r,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!Gd(n,r)||!Gd(i,s):!0}function iN(t,e,n){var r=!1,i=ll,s=e.contextType;return typeof s=="object"&&s!==null?s=ps(s):(i=Si(e)?ec:ri.current,r=e.contextTypes,s=(r=r!=null)?du(t,i):ll),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=mm,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function vx(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&mm.enqueueReplaceState(e,e.state,null)}function J0(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},_v(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=ps(s):(s=Si(e)?ec:ri.current,i.context=du(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(X0(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&mm.enqueueReplaceState(i,i.state,null),Ap(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function mu(t,e){try{var n="",r=e;do n+=dE(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Og(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Z0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var FT=typeof WeakMap=="function"?WeakMap:Map;function sN(t,e,n){n=Ga(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){kp||(kp=!0,c1=r),Z0(t,e)},n}function aN(t,e,n){n=Ga(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Z0(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Z0(t,e),typeof r!="function"&&(el===null?el=new Set([this]):el.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function yx(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new FT;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=JT.bind(null,t,e,n),e.then(t,t))}function xx(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function bx(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ga(-1,1),e.tag=2,Zo(n,e,1))),n.lanes|=1),t)}var VT=oo.ReactCurrentOwner,Ni=!1;function di(t,e,n,r){e.child=t===null?D_(e,null,n,r):fu(e,t.child,n,r)}function wx(t,e,n,r,i){n=n.render;var s=e.ref;return Zc(e,i),r=Tv(t,e,n,r,s,i),n=Cv(),t!==null&&!Ni?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Za(t,e,i)):(Rn&&n&&mv(e),e.flags|=1,di(t,e,r,i),e.child)}function _x(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Fv(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,oN(t,e,s,r,i)):(t=Wf(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:Gd,n(a,r)&&t.ref===e.ref)return Za(t,e,i)}return e.flags|=1,t=nl(s,r),t.ref=e.ref,t.return=e,e.child=t}function oN(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Gd(s,r)&&t.ref===e.ref)if(Ni=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Ni=!0);else return e.lanes=t.lanes,Za(t,e,i)}return e1(t,e,n,r,i)}function lN(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},wn(Wc,$i),$i|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,wn(Wc,$i),$i|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,wn(Wc,$i),$i|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,wn(Wc,$i),$i|=r;return di(t,e,i,n),e.child}function cN(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function e1(t,e,n,r,i){var s=Si(n)?ec:ri.current;return s=du(e,s),Zc(e,i),n=Tv(t,e,n,r,s,i),r=Cv(),t!==null&&!Ni?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Za(t,e,i)):(Rn&&r&&mv(e),e.flags|=1,di(t,e,n,i),e.child)}function Nx(t,e,n,r,i){if(Si(n)){var s=!0;xp(e)}else s=!1;if(Zc(e,i),e.stateNode===null)zf(t,e),iN(e,n,r),J0(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var c=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=ps(u):(u=Si(n)?ec:ri.current,u=du(e,u));var f=n.getDerivedStateFromProps,g=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";g||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||c!==u)&&vx(e,a,r,u),Fo=!1;var y=e.memoizedState;a.state=y,Ap(e,r,a,i),c=e.memoizedState,l!==r||y!==c||Ai.current||Fo?(typeof f=="function"&&(X0(e,n,f,r),c=e.memoizedState),(l=Fo||gx(e,n,l,r,y,c,u))?(g||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),a.props=r,a.state=c,a.context=u,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,M_(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Cs(e.type,l),a.props=u,g=e.pendingProps,y=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=ps(c):(c=Si(n)?ec:ri.current,c=du(e,c));var p=n.getDerivedStateFromProps;(f=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==g||y!==c)&&vx(e,a,r,c),Fo=!1,y=e.memoizedState,a.state=y,Ap(e,r,a,i);var T=e.memoizedState;l!==g||y!==T||Ai.current||Fo?(typeof p=="function"&&(X0(e,n,p,r),T=e.memoizedState),(u=Fo||gx(e,n,u,r,y,T,c)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,T,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,T,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=T),a.props=r,a.state=T,a.context=c,r=u):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),r=!1)}return t1(t,e,n,r,s,i)}function t1(t,e,n,r,i,s){cN(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&lx(e,n,!1),Za(t,e,s);r=e.stateNode,VT.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=fu(e,t.child,null,s),e.child=fu(e,null,l,s)):di(t,e,l,s),e.memoizedState=r.state,i&&lx(e,n,!0),e.child}function uN(t){var e=t.stateNode;e.pendingContext?ox(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ox(t,e.context,!1),Nv(t,e.containerInfo)}function Ax(t,e,n,r,i){return hu(),vv(i),e.flags|=256,di(t,e,n,r),e.child}var n1={dehydrated:null,treeContext:null,retryLane:0};function r1(t){return{baseLanes:t,cachePool:null,transitions:null}}function dN(t,e,n){var r=e.pendingProps,i=Un.current,s=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),wn(Un,i&1),t===null)return Y0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=ym(a,r,0,null),t=Yl(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=r1(n),e.memoizedState=n1,t):jv(e,a));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return UT(t,e,a,r,l,i,n);if(s){s=r.fallback,a=e.mode,i=t.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=nl(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=nl(l,s):(s=Yl(s,a,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=t.child.memoizedState,a=a===null?r1(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~n,e.memoizedState=n1,r}return s=t.child,t=s.sibling,r=nl(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function jv(t,e){return e=ym({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function gf(t,e,n,r){return r!==null&&vv(r),fu(e,t.child,null,n),t=jv(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function UT(t,e,n,r,i,s,a){if(n)return e.flags&256?(e.flags&=-257,r=Og(Error(Me(422))),gf(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=ym({mode:"visible",children:r.children},i,0,null),s=Yl(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&fu(e,t.child,null,a),e.child.memoizedState=r1(a),e.memoizedState=n1,s);if(!(e.mode&1))return gf(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(Me(419)),r=Og(s,r,void 0),gf(t,e,a,r)}if(l=(a&t.childLanes)!==0,Ni||l){if(r=Tr,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ja(t,i),Ls(r,t,i,-1))}return Mv(),r=Og(Error(Me(421))),gf(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=ZT.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Hi=Jo(i.nextSibling),Ki=e,Rn=!0,Is=null,t!==null&&(os[ls++]=qa,os[ls++]=za,os[ls++]=tc,qa=t.id,za=t.overflow,tc=e),e=jv(e,r.children),e.flags|=4096,e)}function Sx(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Q0(t.return,e,n)}function Mg(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function hN(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(di(t,e,r.children,n),r=Un.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Sx(t,n,e);else if(t.tag===19)Sx(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(wn(Un,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Sp(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Mg(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Sp(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Mg(e,!0,n,null,s);break;case"together":Mg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function zf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Za(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),rc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Me(153));if(e.child!==null){for(t=e.child,n=nl(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=nl(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function BT(t,e,n){switch(e.tag){case 3:uN(e),hu();break;case 5:F_(e);break;case 1:Si(e.type)&&xp(e);break;case 4:Nv(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;wn(_p,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(wn(Un,Un.current&1),e.flags|=128,null):n&e.child.childLanes?dN(t,e,n):(wn(Un,Un.current&1),t=Za(t,e,n),t!==null?t.sibling:null);wn(Un,Un.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return hN(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),wn(Un,Un.current),r)break;return null;case 22:case 23:return e.lanes=0,lN(t,e,n)}return Za(t,e,n)}var fN,i1,pN,mN;fN=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};i1=function(){};pN=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Hl(ua.current);var s=null;switch(n){case"input":i=E0(t,i),r=E0(t,r),s=[];break;case"select":i=qn({},i,{value:void 0}),r=qn({},r,{value:void 0}),s=[];break;case"textarea":i=k0(t,i),r=k0(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=vp)}j0(n,r);var a;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ud.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(s||(s=[]),s.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ud.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Sn("scroll",t),s||l===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};mN=function(t,e,n,r){n!==r&&(e.flags|=4)};function cd(t,e){if(!Rn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Gr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function qT(t,e,n){var r=e.pendingProps;switch(gv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gr(e),null;case 1:return Si(e.type)&&yp(),Gr(e),null;case 3:return r=e.stateNode,pu(),Cn(Ai),Cn(ri),Sv(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(pf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Is!==null&&(h1(Is),Is=null))),i1(t,e),Gr(e),null;case 5:Av(e);var i=Hl(Jd.current);if(n=e.type,t!==null&&e.stateNode!=null)pN(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Me(166));return Gr(e),null}if(t=Hl(ua.current),pf(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[aa]=e,r[Qd]=s,t=(e.mode&1)!==0,n){case"dialog":Sn("cancel",r),Sn("close",r);break;case"iframe":case"object":case"embed":Sn("load",r);break;case"video":case"audio":for(i=0;i<vd.length;i++)Sn(vd[i],r);break;case"source":Sn("error",r);break;case"img":case"image":case"link":Sn("error",r),Sn("load",r);break;case"details":Sn("toggle",r);break;case"input":Ry(r,s),Sn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Sn("invalid",r);break;case"textarea":Oy(r,s),Sn("invalid",r)}j0(n,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&ff(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&ff(r.textContent,l,t),i=["children",""+l]):Ud.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Sn("scroll",r)}switch(n){case"input":sf(r),Dy(r,s,!0);break;case"textarea":sf(r),My(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=vp)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=zw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[aa]=e,t[Qd]=r,fN(t,e,!1,!1),e.stateNode=t;e:{switch(a=P0(n,r),n){case"dialog":Sn("cancel",t),Sn("close",t),i=r;break;case"iframe":case"object":case"embed":Sn("load",t),i=r;break;case"video":case"audio":for(i=0;i<vd.length;i++)Sn(vd[i],t);i=r;break;case"source":Sn("error",t),i=r;break;case"img":case"image":case"link":Sn("error",t),Sn("load",t),i=r;break;case"details":Sn("toggle",t),i=r;break;case"input":Ry(t,r),i=E0(t,r),Sn("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=qn({},r,{value:void 0}),Sn("invalid",t);break;case"textarea":Oy(t,r),i=k0(t,r),Sn("invalid",t);break;default:i=r}j0(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?Ww(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&$w(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Bd(t,c):typeof c=="number"&&Bd(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ud.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Sn("scroll",t):c!=null&&tv(t,s,c,a))}switch(n){case"input":sf(t),Dy(t,r,!1);break;case"textarea":sf(t),My(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ol(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Yc(t,!!r.multiple,s,!1):r.defaultValue!=null&&Yc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=vp)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Gr(e),null;case 6:if(t&&e.stateNode!=null)mN(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Me(166));if(n=Hl(Jd.current),Hl(ua.current),pf(e)){if(r=e.stateNode,n=e.memoizedProps,r[aa]=e,(s=r.nodeValue!==n)&&(t=Ki,t!==null))switch(t.tag){case 3:ff(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ff(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[aa]=e,e.stateNode=r}return Gr(e),null;case 13:if(Cn(Un),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Rn&&Hi!==null&&e.mode&1&&!(e.flags&128))L_(),hu(),e.flags|=98560,s=!1;else if(s=pf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Me(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Me(317));s[aa]=e}else hu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Gr(e),s=!1}else Is!==null&&(h1(Is),Is=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Un.current&1?xr===0&&(xr=3):Mv())),e.updateQueue!==null&&(e.flags|=4),Gr(e),null);case 4:return pu(),i1(t,e),t===null&&Kd(e.stateNode.containerInfo),Gr(e),null;case 10:return bv(e.type._context),Gr(e),null;case 17:return Si(e.type)&&yp(),Gr(e),null;case 19:if(Cn(Un),s=e.memoizedState,s===null)return Gr(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)cd(s,!1);else{if(xr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Sp(t),a!==null){for(e.flags|=128,cd(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return wn(Un,Un.current&1|2),e.child}t=t.sibling}s.tail!==null&&rr()>gu&&(e.flags|=128,r=!0,cd(s,!1),e.lanes=4194304)}else{if(!r)if(t=Sp(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),cd(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Rn)return Gr(e),null}else 2*rr()-s.renderingStartTime>gu&&n!==1073741824&&(e.flags|=128,r=!0,cd(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(n=s.last,n!==null?n.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=rr(),e.sibling=null,n=Un.current,wn(Un,r?n&1|2:n&1),e):(Gr(e),null);case 22:case 23:return Ov(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?$i&1073741824&&(Gr(e),e.subtreeFlags&6&&(e.flags|=8192)):Gr(e),null;case 24:return null;case 25:return null}throw Error(Me(156,e.tag))}function zT(t,e){switch(gv(e),e.tag){case 1:return Si(e.type)&&yp(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return pu(),Cn(Ai),Cn(ri),Sv(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Av(e),null;case 13:if(Cn(Un),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Me(340));hu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Cn(Un),null;case 4:return pu(),null;case 10:return bv(e.type._context),null;case 22:case 23:return Ov(),null;case 24:return null;default:return null}}var vf=!1,ei=!1,$T=typeof WeakSet=="function"?WeakSet:Set,We=null;function Hc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Yn(t,e,r)}else n.current=null}function s1(t,e,n){try{n()}catch(r){Yn(t,e,r)}}var Ex=!1;function HT(t,e){if(q0=pp,t=b_(),pv(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,u=0,f=0,g=t,y=null;t:for(;;){for(var p;g!==n||i!==0&&g.nodeType!==3||(l=a+i),g!==s||r!==0&&g.nodeType!==3||(c=a+r),g.nodeType===3&&(a+=g.nodeValue.length),(p=g.firstChild)!==null;)y=g,g=p;for(;;){if(g===t)break t;if(y===n&&++u===i&&(l=a),y===s&&++f===r&&(c=a),(p=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=p}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(z0={focusedElem:t,selectionRange:n},pp=!1,We=e;We!==null;)if(e=We,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,We=t;else for(;We!==null;){e=We;try{var T=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var E=T.memoizedProps,P=T.memoizedState,A=e.stateNode,L=A.getSnapshotBeforeUpdate(e.elementType===e.type?E:Cs(e.type,E),P);A.__reactInternalSnapshotBeforeUpdate=L}break;case 3:var M=e.stateNode.containerInfo;M.nodeType===1?M.textContent="":M.nodeType===9&&M.documentElement&&M.removeChild(M.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Me(163))}}catch(F){Yn(e,e.return,F)}if(t=e.sibling,t!==null){t.return=e.return,We=t;break}We=e.return}return T=Ex,Ex=!1,T}function Id(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&s1(e,n,s)}i=i.next}while(i!==r)}}function gm(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function a1(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function gN(t){var e=t.alternate;e!==null&&(t.alternate=null,gN(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[aa],delete e[Qd],delete e[W0],delete e[TT],delete e[CT])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function vN(t){return t.tag===5||t.tag===3||t.tag===4}function Tx(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||vN(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function o1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=vp));else if(r!==4&&(t=t.child,t!==null))for(o1(t,e,n),t=t.sibling;t!==null;)o1(t,e,n),t=t.sibling}function l1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(l1(t,e,n),t=t.sibling;t!==null;)l1(t,e,n),t=t.sibling}var Lr=null,ks=!1;function Lo(t,e,n){for(n=n.child;n!==null;)yN(t,e,n),n=n.sibling}function yN(t,e,n){if(ca&&typeof ca.onCommitFiberUnmount=="function")try{ca.onCommitFiberUnmount(lm,n)}catch{}switch(n.tag){case 5:ei||Hc(n,e);case 6:var r=Lr,i=ks;Lr=null,Lo(t,e,n),Lr=r,ks=i,Lr!==null&&(ks?(t=Lr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Lr.removeChild(n.stateNode));break;case 18:Lr!==null&&(ks?(t=Lr,n=n.stateNode,t.nodeType===8?Ig(t.parentNode,n):t.nodeType===1&&Ig(t,n),Hd(t)):Ig(Lr,n.stateNode));break;case 4:r=Lr,i=ks,Lr=n.stateNode.containerInfo,ks=!0,Lo(t,e,n),Lr=r,ks=i;break;case 0:case 11:case 14:case 15:if(!ei&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&s1(n,e,a),i=i.next}while(i!==r)}Lo(t,e,n);break;case 1:if(!ei&&(Hc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Yn(n,e,l)}Lo(t,e,n);break;case 21:Lo(t,e,n);break;case 22:n.mode&1?(ei=(r=ei)||n.memoizedState!==null,Lo(t,e,n),ei=r):Lo(t,e,n);break;default:Lo(t,e,n)}}function Cx(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new $T),e.forEach(function(r){var i=e6.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Es(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:Lr=l.stateNode,ks=!1;break e;case 3:Lr=l.stateNode.containerInfo,ks=!0;break e;case 4:Lr=l.stateNode.containerInfo,ks=!0;break e}l=l.return}if(Lr===null)throw Error(Me(160));yN(s,a,i),Lr=null,ks=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){Yn(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)xN(e,t),e=e.sibling}function xN(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Es(e,t),na(t),r&4){try{Id(3,t,t.return),gm(3,t)}catch(E){Yn(t,t.return,E)}try{Id(5,t,t.return)}catch(E){Yn(t,t.return,E)}}break;case 1:Es(e,t),na(t),r&512&&n!==null&&Hc(n,n.return);break;case 5:if(Es(e,t),na(t),r&512&&n!==null&&Hc(n,n.return),t.flags&32){var i=t.stateNode;try{Bd(i,"")}catch(E){Yn(t,t.return,E)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=n!==null?n.memoizedProps:s,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&Bw(i,s),P0(l,a);var u=P0(l,s);for(a=0;a<c.length;a+=2){var f=c[a],g=c[a+1];f==="style"?Ww(i,g):f==="dangerouslySetInnerHTML"?$w(i,g):f==="children"?Bd(i,g):tv(i,f,g,u)}switch(l){case"input":T0(i,s);break;case"textarea":qw(i,s);break;case"select":var y=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Yc(i,!!s.multiple,p,!1):y!==!!s.multiple&&(s.defaultValue!=null?Yc(i,!!s.multiple,s.defaultValue,!0):Yc(i,!!s.multiple,s.multiple?[]:"",!1))}i[Qd]=s}catch(E){Yn(t,t.return,E)}}break;case 6:if(Es(e,t),na(t),r&4){if(t.stateNode===null)throw Error(Me(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(E){Yn(t,t.return,E)}}break;case 3:if(Es(e,t),na(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Hd(e.containerInfo)}catch(E){Yn(t,t.return,E)}break;case 4:Es(e,t),na(t);break;case 13:Es(e,t),na(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Rv=rr())),r&4&&Cx(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(ei=(u=ei)||f,Es(e,t),ei=u):Es(e,t),na(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(We=t,f=t.child;f!==null;){for(g=We=f;We!==null;){switch(y=We,p=y.child,y.tag){case 0:case 11:case 14:case 15:Id(4,y,y.return);break;case 1:Hc(y,y.return);var T=y.stateNode;if(typeof T.componentWillUnmount=="function"){r=y,n=y.return;try{e=r,T.props=e.memoizedProps,T.state=e.memoizedState,T.componentWillUnmount()}catch(E){Yn(r,n,E)}}break;case 5:Hc(y,y.return);break;case 22:if(y.memoizedState!==null){Ix(g);continue}}p!==null?(p.return=y,We=p):Ix(g)}f=f.sibling}e:for(f=null,g=t;;){if(g.tag===5){if(f===null){f=g;try{i=g.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=g.stateNode,c=g.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Hw("display",a))}catch(E){Yn(t,t.return,E)}}}else if(g.tag===6){if(f===null)try{g.stateNode.nodeValue=u?"":g.memoizedProps}catch(E){Yn(t,t.return,E)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;f===g&&(f=null),g=g.return}f===g&&(f=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:Es(e,t),na(t),r&4&&Cx(t);break;case 21:break;default:Es(e,t),na(t)}}function na(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(vN(n)){var r=n;break e}n=n.return}throw Error(Me(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Bd(i,""),r.flags&=-33);var s=Tx(t);l1(t,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,l=Tx(t);o1(t,l,a);break;default:throw Error(Me(161))}}catch(c){Yn(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function WT(t,e,n){We=t,bN(t)}function bN(t,e,n){for(var r=(t.mode&1)!==0;We!==null;){var i=We,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||vf;if(!a){var l=i.alternate,c=l!==null&&l.memoizedState!==null||ei;l=vf;var u=ei;if(vf=a,(ei=c)&&!u)for(We=i;We!==null;)a=We,c=a.child,a.tag===22&&a.memoizedState!==null?jx(i):c!==null?(c.return=a,We=c):jx(i);for(;s!==null;)We=s,bN(s),s=s.sibling;We=i,vf=l,ei=u}kx(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,We=s):kx(t)}}function kx(t){for(;We!==null;){var e=We;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ei||gm(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ei)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Cs(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&fx(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}fx(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var g=f.dehydrated;g!==null&&Hd(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Me(163))}ei||e.flags&512&&a1(e)}catch(y){Yn(e,e.return,y)}}if(e===t){We=null;break}if(n=e.sibling,n!==null){n.return=e.return,We=n;break}We=e.return}}function Ix(t){for(;We!==null;){var e=We;if(e===t){We=null;break}var n=e.sibling;if(n!==null){n.return=e.return,We=n;break}We=e.return}}function jx(t){for(;We!==null;){var e=We;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{gm(4,e)}catch(c){Yn(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Yn(e,i,c)}}var s=e.return;try{a1(e)}catch(c){Yn(e,s,c)}break;case 5:var a=e.return;try{a1(e)}catch(c){Yn(e,a,c)}}}catch(c){Yn(e,e.return,c)}if(e===t){We=null;break}var l=e.sibling;if(l!==null){l.return=e.return,We=l;break}We=e.return}}var GT=Math.ceil,Cp=oo.ReactCurrentDispatcher,Pv=oo.ReactCurrentOwner,ds=oo.ReactCurrentBatchConfig,Xt=0,Tr=null,ur=null,Mr=0,$i=0,Wc=gl(0),xr=0,nh=null,rc=0,vm=0,Lv=0,jd=null,wi=null,Rv=0,gu=1/0,Va=null,kp=!1,c1=null,el=null,yf=!1,Wo=null,Ip=0,Pd=0,u1=null,$f=-1,Hf=0;function hi(){return Xt&6?rr():$f!==-1?$f:$f=rr()}function tl(t){return t.mode&1?Xt&2&&Mr!==0?Mr&-Mr:IT.transition!==null?(Hf===0&&(Hf=i_()),Hf):(t=hn,t!==0||(t=window.event,t=t===void 0?16:d_(t.type)),t):1}function Ls(t,e,n,r){if(50<Pd)throw Pd=0,u1=null,Error(Me(185));gh(t,n,r),(!(Xt&2)||t!==Tr)&&(t===Tr&&(!(Xt&2)&&(vm|=n),xr===4&&Uo(t,Mr)),Ei(t,r),n===1&&Xt===0&&!(e.mode&1)&&(gu=rr()+500,fm&&vl()))}function Ei(t,e){var n=t.callbackNode;IE(t,e);var r=fp(t,t===Tr?Mr:0);if(r===0)n!==null&&Uy(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Uy(n),e===1)t.tag===0?kT(Px.bind(null,t)):I_(Px.bind(null,t)),ST(function(){!(Xt&6)&&vl()}),n=null;else{switch(s_(r)){case 1:n=av;break;case 4:n=n_;break;case 16:n=hp;break;case 536870912:n=r_;break;default:n=hp}n=CN(n,wN.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function wN(t,e){if($f=-1,Hf=0,Xt&6)throw Error(Me(327));var n=t.callbackNode;if(eu()&&t.callbackNode!==n)return null;var r=fp(t,t===Tr?Mr:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=jp(t,r);else{e=r;var i=Xt;Xt|=2;var s=NN();(Tr!==t||Mr!==e)&&(Va=null,gu=rr()+500,Kl(t,e));do try{QT();break}catch(l){_N(t,l)}while(!0);xv(),Cp.current=s,Xt=i,ur!==null?e=0:(Tr=null,Mr=0,e=xr)}if(e!==0){if(e===2&&(i=M0(t),i!==0&&(r=i,e=d1(t,i))),e===1)throw n=nh,Kl(t,0),Uo(t,r),Ei(t,rr()),n;if(e===6)Uo(t,r);else{if(i=t.current.alternate,!(r&30)&&!KT(i)&&(e=jp(t,r),e===2&&(s=M0(t),s!==0&&(r=s,e=d1(t,s))),e===1))throw n=nh,Kl(t,0),Uo(t,r),Ei(t,rr()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Me(345));case 2:Vl(t,wi,Va);break;case 3:if(Uo(t,r),(r&130023424)===r&&(e=Rv+500-rr(),10<e)){if(fp(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){hi(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=H0(Vl.bind(null,t,wi,Va),e);break}Vl(t,wi,Va);break;case 4:if(Uo(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-Ps(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=rr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*GT(r/1960))-r,10<r){t.timeoutHandle=H0(Vl.bind(null,t,wi,Va),r);break}Vl(t,wi,Va);break;case 5:Vl(t,wi,Va);break;default:throw Error(Me(329))}}}return Ei(t,rr()),t.callbackNode===n?wN.bind(null,t):null}function d1(t,e){var n=jd;return t.current.memoizedState.isDehydrated&&(Kl(t,e).flags|=256),t=jp(t,e),t!==2&&(e=wi,wi=n,e!==null&&h1(e)),t}function h1(t){wi===null?wi=t:wi.push.apply(wi,t)}function KT(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Rs(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Uo(t,e){for(e&=~Lv,e&=~vm,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ps(e),r=1<<n;t[n]=-1,e&=~r}}function Px(t){if(Xt&6)throw Error(Me(327));eu();var e=fp(t,0);if(!(e&1))return Ei(t,rr()),null;var n=jp(t,e);if(t.tag!==0&&n===2){var r=M0(t);r!==0&&(e=r,n=d1(t,r))}if(n===1)throw n=nh,Kl(t,0),Uo(t,e),Ei(t,rr()),n;if(n===6)throw Error(Me(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Vl(t,wi,Va),Ei(t,rr()),null}function Dv(t,e){var n=Xt;Xt|=1;try{return t(e)}finally{Xt=n,Xt===0&&(gu=rr()+500,fm&&vl())}}function ic(t){Wo!==null&&Wo.tag===0&&!(Xt&6)&&eu();var e=Xt;Xt|=1;var n=ds.transition,r=hn;try{if(ds.transition=null,hn=1,t)return t()}finally{hn=r,ds.transition=n,Xt=e,!(Xt&6)&&vl()}}function Ov(){$i=Wc.current,Cn(Wc)}function Kl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,AT(n)),ur!==null)for(n=ur.return;n!==null;){var r=n;switch(gv(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&yp();break;case 3:pu(),Cn(Ai),Cn(ri),Sv();break;case 5:Av(r);break;case 4:pu();break;case 13:Cn(Un);break;case 19:Cn(Un);break;case 10:bv(r.type._context);break;case 22:case 23:Ov()}n=n.return}if(Tr=t,ur=t=nl(t.current,null),Mr=$i=e,xr=0,nh=null,Lv=vm=rc=0,wi=jd=null,$l!==null){for(e=0;e<$l.length;e++)if(n=$l[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}n.pending=r}$l=null}return t}function _N(t,e){do{var n=ur;try{if(xv(),Bf.current=Tp,Ep){for(var r=Bn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Ep=!1}if(nc=0,Sr=vr=Bn=null,kd=!1,Zd=0,Pv.current=null,n===null||n.return===null){xr=1,nh=e,ur=null;break}e:{var s=t,a=n.return,l=n,c=e;if(e=Mr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=l,g=f.tag;if(!(f.mode&1)&&(g===0||g===11||g===15)){var y=f.alternate;y?(f.updateQueue=y.updateQueue,f.memoizedState=y.memoizedState,f.lanes=y.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=xx(a);if(p!==null){p.flags&=-257,bx(p,a,l,s,e),p.mode&1&&yx(s,u,e),e=p,c=u;var T=e.updateQueue;if(T===null){var E=new Set;E.add(c),e.updateQueue=E}else T.add(c);break e}else{if(!(e&1)){yx(s,u,e),Mv();break e}c=Error(Me(426))}}else if(Rn&&l.mode&1){var P=xx(a);if(P!==null){!(P.flags&65536)&&(P.flags|=256),bx(P,a,l,s,e),vv(mu(c,l));break e}}s=c=mu(c,l),xr!==4&&(xr=2),jd===null?jd=[s]:jd.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var A=sN(s,c,e);hx(s,A);break e;case 1:l=c;var L=s.type,M=s.stateNode;if(!(s.flags&128)&&(typeof L.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(el===null||!el.has(M)))){s.flags|=65536,e&=-e,s.lanes|=e;var F=aN(s,l,e);hx(s,F);break e}}s=s.return}while(s!==null)}SN(n)}catch(te){e=te,ur===n&&n!==null&&(ur=n=n.return);continue}break}while(!0)}function NN(){var t=Cp.current;return Cp.current=Tp,t===null?Tp:t}function Mv(){(xr===0||xr===3||xr===2)&&(xr=4),Tr===null||!(rc&268435455)&&!(vm&268435455)||Uo(Tr,Mr)}function jp(t,e){var n=Xt;Xt|=2;var r=NN();(Tr!==t||Mr!==e)&&(Va=null,Kl(t,e));do try{YT();break}catch(i){_N(t,i)}while(!0);if(xv(),Xt=n,Cp.current=r,ur!==null)throw Error(Me(261));return Tr=null,Mr=0,xr}function YT(){for(;ur!==null;)AN(ur)}function QT(){for(;ur!==null&&!wE();)AN(ur)}function AN(t){var e=TN(t.alternate,t,$i);t.memoizedProps=t.pendingProps,e===null?SN(t):ur=e,Pv.current=null}function SN(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=zT(n,e),n!==null){n.flags&=32767,ur=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{xr=6,ur=null;return}}else if(n=qT(n,e,$i),n!==null){ur=n;return}if(e=e.sibling,e!==null){ur=e;return}ur=e=t}while(e!==null);xr===0&&(xr=5)}function Vl(t,e,n){var r=hn,i=ds.transition;try{ds.transition=null,hn=1,XT(t,e,n,r)}finally{ds.transition=i,hn=r}return null}function XT(t,e,n,r){do eu();while(Wo!==null);if(Xt&6)throw Error(Me(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Me(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(jE(t,s),t===Tr&&(ur=Tr=null,Mr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||yf||(yf=!0,CN(hp,function(){return eu(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=ds.transition,ds.transition=null;var a=hn;hn=1;var l=Xt;Xt|=4,Pv.current=null,HT(t,n),xN(n,t),vT(z0),pp=!!q0,z0=q0=null,t.current=n,WT(n),_E(),Xt=l,hn=a,ds.transition=s}else t.current=n;if(yf&&(yf=!1,Wo=t,Ip=i),s=t.pendingLanes,s===0&&(el=null),SE(n.stateNode),Ei(t,rr()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(kp)throw kp=!1,t=c1,c1=null,t;return Ip&1&&t.tag!==0&&eu(),s=t.pendingLanes,s&1?t===u1?Pd++:(Pd=0,u1=t):Pd=0,vl(),null}function eu(){if(Wo!==null){var t=s_(Ip),e=ds.transition,n=hn;try{if(ds.transition=null,hn=16>t?16:t,Wo===null)var r=!1;else{if(t=Wo,Wo=null,Ip=0,Xt&6)throw Error(Me(331));var i=Xt;for(Xt|=4,We=t.current;We!==null;){var s=We,a=s.child;if(We.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(We=u;We!==null;){var f=We;switch(f.tag){case 0:case 11:case 15:Id(8,f,s)}var g=f.child;if(g!==null)g.return=f,We=g;else for(;We!==null;){f=We;var y=f.sibling,p=f.return;if(gN(f),f===u){We=null;break}if(y!==null){y.return=p,We=y;break}We=p}}}var T=s.alternate;if(T!==null){var E=T.child;if(E!==null){T.child=null;do{var P=E.sibling;E.sibling=null,E=P}while(E!==null)}}We=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,We=a;else e:for(;We!==null;){if(s=We,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Id(9,s,s.return)}var A=s.sibling;if(A!==null){A.return=s.return,We=A;break e}We=s.return}}var L=t.current;for(We=L;We!==null;){a=We;var M=a.child;if(a.subtreeFlags&2064&&M!==null)M.return=a,We=M;else e:for(a=L;We!==null;){if(l=We,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:gm(9,l)}}catch(te){Yn(l,l.return,te)}if(l===a){We=null;break e}var F=l.sibling;if(F!==null){F.return=l.return,We=F;break e}We=l.return}}if(Xt=i,vl(),ca&&typeof ca.onPostCommitFiberRoot=="function")try{ca.onPostCommitFiberRoot(lm,t)}catch{}r=!0}return r}finally{hn=n,ds.transition=e}}return!1}function Lx(t,e,n){e=mu(n,e),e=sN(t,e,1),t=Zo(t,e,1),e=hi(),t!==null&&(gh(t,1,e),Ei(t,e))}function Yn(t,e,n){if(t.tag===3)Lx(t,t,n);else for(;e!==null;){if(e.tag===3){Lx(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(el===null||!el.has(r))){t=mu(n,t),t=aN(e,t,1),e=Zo(e,t,1),t=hi(),e!==null&&(gh(e,1,t),Ei(e,t));break}}e=e.return}}function JT(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=hi(),t.pingedLanes|=t.suspendedLanes&n,Tr===t&&(Mr&n)===n&&(xr===4||xr===3&&(Mr&130023424)===Mr&&500>rr()-Rv?Kl(t,0):Lv|=n),Ei(t,e)}function EN(t,e){e===0&&(t.mode&1?(e=lf,lf<<=1,!(lf&130023424)&&(lf=4194304)):e=1);var n=hi();t=Ja(t,e),t!==null&&(gh(t,e,n),Ei(t,n))}function ZT(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),EN(t,n)}function e6(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Me(314))}r!==null&&r.delete(e),EN(t,n)}var TN;TN=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ai.current)Ni=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ni=!1,BT(t,e,n);Ni=!!(t.flags&131072)}else Ni=!1,Rn&&e.flags&1048576&&j_(e,wp,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;zf(t,e),t=e.pendingProps;var i=du(e,ri.current);Zc(e,n),i=Tv(null,e,r,t,i,n);var s=Cv();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Si(r)?(s=!0,xp(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,_v(e),i.updater=mm,e.stateNode=i,i._reactInternals=e,J0(e,r,t,n),e=t1(null,e,r,!0,s,n)):(e.tag=0,Rn&&s&&mv(e),di(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(zf(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=n6(r),t=Cs(r,t),i){case 0:e=e1(null,e,r,t,n);break e;case 1:e=Nx(null,e,r,t,n);break e;case 11:e=wx(null,e,r,t,n);break e;case 14:e=_x(null,e,r,Cs(r.type,t),n);break e}throw Error(Me(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Cs(r,i),e1(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Cs(r,i),Nx(t,e,r,i,n);case 3:e:{if(uN(e),t===null)throw Error(Me(387));r=e.pendingProps,s=e.memoizedState,i=s.element,M_(t,e),Ap(e,r,null,n);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=mu(Error(Me(423)),e),e=Ax(t,e,r,n,i);break e}else if(r!==i){i=mu(Error(Me(424)),e),e=Ax(t,e,r,n,i);break e}else for(Hi=Jo(e.stateNode.containerInfo.firstChild),Ki=e,Rn=!0,Is=null,n=D_(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(hu(),r===i){e=Za(t,e,n);break e}di(t,e,r,n)}e=e.child}return e;case 5:return F_(e),t===null&&Y0(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,$0(r,i)?a=null:s!==null&&$0(r,s)&&(e.flags|=32),cN(t,e),di(t,e,a,n),e.child;case 6:return t===null&&Y0(e),null;case 13:return dN(t,e,n);case 4:return Nv(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=fu(e,null,r,n):di(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Cs(r,i),wx(t,e,r,i,n);case 7:return di(t,e,e.pendingProps,n),e.child;case 8:return di(t,e,e.pendingProps.children,n),e.child;case 12:return di(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,wn(_p,r._currentValue),r._currentValue=a,s!==null)if(Rs(s.value,a)){if(s.children===i.children&&!Ai.current){e=Za(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){a=s.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Ga(-1,n&-n),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),Q0(s.return,n,e),l.lanes|=n;break}c=c.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Me(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),Q0(a,n,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}di(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Zc(e,n),i=ps(i),r=r(i),e.flags|=1,di(t,e,r,n),e.child;case 14:return r=e.type,i=Cs(r,e.pendingProps),i=Cs(r.type,i),_x(t,e,r,i,n);case 15:return oN(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Cs(r,i),zf(t,e),e.tag=1,Si(r)?(t=!0,xp(e)):t=!1,Zc(e,n),iN(e,r,i),J0(e,r,i,n),t1(null,e,r,!0,t,n);case 19:return hN(t,e,n);case 22:return lN(t,e,n)}throw Error(Me(156,e.tag))};function CN(t,e){return t_(t,e)}function t6(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function us(t,e,n,r){return new t6(t,e,n,r)}function Fv(t){return t=t.prototype,!(!t||!t.isReactComponent)}function n6(t){if(typeof t=="function")return Fv(t)?1:0;if(t!=null){if(t=t.$$typeof,t===rv)return 11;if(t===iv)return 14}return 2}function nl(t,e){var n=t.alternate;return n===null?(n=us(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Wf(t,e,n,r,i,s){var a=2;if(r=t,typeof t=="function")Fv(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Oc:return Yl(n.children,i,s,e);case nv:a=8,i|=8;break;case _0:return t=us(12,n,e,i|2),t.elementType=_0,t.lanes=s,t;case N0:return t=us(13,n,e,i),t.elementType=N0,t.lanes=s,t;case A0:return t=us(19,n,e,i),t.elementType=A0,t.lanes=s,t;case Fw:return ym(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ow:a=10;break e;case Mw:a=9;break e;case rv:a=11;break e;case iv:a=14;break e;case Mo:a=16,r=null;break e}throw Error(Me(130,t==null?t:typeof t,""))}return e=us(a,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Yl(t,e,n,r){return t=us(7,t,r,e),t.lanes=n,t}function ym(t,e,n,r){return t=us(22,t,r,e),t.elementType=Fw,t.lanes=n,t.stateNode={isHidden:!1},t}function Fg(t,e,n){return t=us(6,t,null,e),t.lanes=n,t}function Vg(t,e,n){return e=us(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function r6(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xg(0),this.expirationTimes=xg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Vv(t,e,n,r,i,s,a,l,c){return t=new r6(t,e,n,l,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=us(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},_v(s),t}function i6(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Dc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function kN(t){if(!t)return ll;t=t._reactInternals;e:{if(fc(t)!==t||t.tag!==1)throw Error(Me(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Si(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Me(171))}if(t.tag===1){var n=t.type;if(Si(n))return k_(t,n,e)}return e}function IN(t,e,n,r,i,s,a,l,c){return t=Vv(n,r,!0,t,i,s,a,l,c),t.context=kN(null),n=t.current,r=hi(),i=tl(n),s=Ga(r,i),s.callback=e??null,Zo(n,s,i),t.current.lanes=i,gh(t,i,r),Ei(t,r),t}function xm(t,e,n,r){var i=e.current,s=hi(),a=tl(i);return n=kN(n),e.context===null?e.context=n:e.pendingContext=n,e=Ga(s,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Zo(i,e,a),t!==null&&(Ls(t,i,a,s),Uf(t,i,a)),a}function Pp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Rx(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Uv(t,e){Rx(t,e),(t=t.alternate)&&Rx(t,e)}function s6(){return null}var jN=typeof reportError=="function"?reportError:function(t){console.error(t)};function Bv(t){this._internalRoot=t}bm.prototype.render=Bv.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Me(409));xm(t,e,null,null)};bm.prototype.unmount=Bv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ic(function(){xm(null,t,null,null)}),e[Xa]=null}};function bm(t){this._internalRoot=t}bm.prototype.unstable_scheduleHydration=function(t){if(t){var e=l_();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Vo.length&&e!==0&&e<Vo[n].priority;n++);Vo.splice(n,0,t),n===0&&u_(t)}};function qv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function wm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Dx(){}function a6(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Pp(a);s.call(u)}}var a=IN(e,r,t,0,null,!1,!1,"",Dx);return t._reactRootContainer=a,t[Xa]=a.current,Kd(t.nodeType===8?t.parentNode:t),ic(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=Pp(c);l.call(u)}}var c=Vv(t,0,!1,null,null,!1,!1,"",Dx);return t._reactRootContainer=c,t[Xa]=c.current,Kd(t.nodeType===8?t.parentNode:t),ic(function(){xm(e,c,n,r)}),c}function _m(t,e,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var l=i;i=function(){var c=Pp(a);l.call(c)}}xm(e,a,t,i)}else a=a6(n,e,t,i,r);return Pp(a)}a_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=gd(e.pendingLanes);n!==0&&(ov(e,n|1),Ei(e,rr()),!(Xt&6)&&(gu=rr()+500,vl()))}break;case 13:ic(function(){var r=Ja(t,1);if(r!==null){var i=hi();Ls(r,t,1,i)}}),Uv(t,1)}};lv=function(t){if(t.tag===13){var e=Ja(t,134217728);if(e!==null){var n=hi();Ls(e,t,134217728,n)}Uv(t,134217728)}};o_=function(t){if(t.tag===13){var e=tl(t),n=Ja(t,e);if(n!==null){var r=hi();Ls(n,t,e,r)}Uv(t,e)}};l_=function(){return hn};c_=function(t,e){var n=hn;try{return hn=t,e()}finally{hn=n}};R0=function(t,e,n){switch(e){case"input":if(T0(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=hm(r);if(!i)throw Error(Me(90));Uw(r),T0(r,i)}}}break;case"textarea":qw(t,n);break;case"select":e=n.value,e!=null&&Yc(t,!!n.multiple,e,!1)}};Yw=Dv;Qw=ic;var o6={usingClientEntryPoint:!1,Events:[yh,Uc,hm,Gw,Kw,Dv]},ud={findFiberByHostInstance:zl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},l6={bundleType:ud.bundleType,version:ud.version,rendererPackageName:ud.rendererPackageName,rendererConfig:ud.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:oo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Zw(t),t===null?null:t.stateNode},findFiberByHostInstance:ud.findFiberByHostInstance||s6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xf.isDisabled&&xf.supportsFiber)try{lm=xf.inject(l6),ca=xf}catch{}}Xi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=o6;Xi.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qv(e))throw Error(Me(200));return i6(t,e,null,n)};Xi.createRoot=function(t,e){if(!qv(t))throw Error(Me(299));var n=!1,r="",i=jN;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Vv(t,1,!1,null,null,n,!1,r,i),t[Xa]=e.current,Kd(t.nodeType===8?t.parentNode:t),new Bv(e)};Xi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Me(188)):(t=Object.keys(t).join(","),Error(Me(268,t)));return t=Zw(e),t=t===null?null:t.stateNode,t};Xi.flushSync=function(t){return ic(t)};Xi.hydrate=function(t,e,n){if(!wm(e))throw Error(Me(200));return _m(null,t,e,!0,n)};Xi.hydrateRoot=function(t,e,n){if(!qv(t))throw Error(Me(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",a=jN;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=IN(e,null,t,1,n??null,i,!1,s,a),t[Xa]=e.current,Kd(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new bm(e)};Xi.render=function(t,e,n){if(!wm(e))throw Error(Me(200));return _m(null,t,e,!1,n)};Xi.unmountComponentAtNode=function(t){if(!wm(t))throw Error(Me(40));return t._reactRootContainer?(ic(function(){_m(null,null,t,!1,function(){t._reactRootContainer=null,t[Xa]=null})}),!0):!1};Xi.unstable_batchedUpdates=Dv;Xi.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!wm(n))throw Error(Me(200));if(t==null||t._reactInternals===void 0)throw Error(Me(38));return _m(t,e,n,!1,r)};Xi.version="18.3.1-next-f1338f8080-20240426";function PN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(PN)}catch(t){console.error(t)}}PN(),Pw.exports=Xi;var c6=Pw.exports,Ox=c6;b0.createRoot=Ox.createRoot,b0.hydrateRoot=Ox.hydrateRoot;var Mx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LN=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},u6=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],a=t[n++],l=t[n++],c=((i&7)<<18|(s&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=t[n++],a=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},RN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,l=a?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,f=s>>2,g=(s&3)<<4|l>>4;let y=(l&15)<<2|u>>6,p=u&63;c||(p=64,a||(y=64)),r.push(n[f],n[g],n[y],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(LN(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):u6(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const g=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||l==null||u==null||g==null)throw new d6;const y=s<<2|l>>4;if(r.push(y),u!==64){const p=l<<4&240|u>>2;if(r.push(p),g!==64){const T=u<<6&192|g;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class d6 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const h6=function(t){const e=LN(t);return RN.encodeByteArray(e,!0)},Lp=function(t){return h6(t).replace(/\./g,"")},DN=function(t){try{return RN.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f6(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p6=()=>f6().__FIREBASE_DEFAULTS__,m6=()=>{if(typeof process>"u"||typeof Mx>"u")return;const t=Mx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},g6=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&DN(t[1]);return e&&JSON.parse(e)},Nm=()=>{try{return p6()||m6()||g6()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},ON=t=>{var e,n;return(n=(e=Nm())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},zv=t=>{const e=ON(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},MN=()=>{var t;return(t=Nm())===null||t===void 0?void 0:t.config},FN=t=>{var e;return(e=Nm())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VN(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Lp(JSON.stringify(n)),Lp(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ii(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function y6(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ii())}function x6(){var t;const e=(t=Nm())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function b6(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function w6(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function _6(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function N6(){const t=ii();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function A6(){return!x6()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function S6(){try{return typeof indexedDB=="object"}catch{return!1}}function E6(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T6="FirebaseError";class xa extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=T6,Object.setPrototypeOf(this,xa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,bh.prototype.create)}}class bh{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?C6(s,r):"Error",l=`${this.serviceName}: ${a} (${i}).`;return new xa(i,l,r)}}function C6(t,e){return t.replace(k6,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const k6=/\{\$([^}]+)}/g;function I6(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Rp(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],a=e[i];if(Fx(s)&&Fx(a)){if(!Rp(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Fx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wh(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function yd(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function xd(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function j6(t,e){const n=new P6(t,e);return n.subscribe.bind(n)}class P6{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");L6(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Ug),i.error===void 0&&(i.error=Ug),i.complete===void 0&&(i.complete=Ug);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function L6(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Ug(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dn(t){return t&&t._delegate?t._delegate:t}class eo{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ul="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new v6;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(O6(e))try{this.getOrInitializeService({instanceIdentifier:Ul})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ul){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ul){return this.instances.has(e)}getOptions(e=Ul){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&a.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:D6(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ul){return this.component?this.component.multipleInstances?e:Ul:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function D6(t){return t===Ul?void 0:t}function O6(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M6{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new R6(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $t;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})($t||($t={}));const F6={debug:$t.DEBUG,verbose:$t.VERBOSE,info:$t.INFO,warn:$t.WARN,error:$t.ERROR,silent:$t.SILENT},V6=$t.INFO,U6={[$t.DEBUG]:"log",[$t.VERBOSE]:"log",[$t.INFO]:"info",[$t.WARN]:"warn",[$t.ERROR]:"error"},B6=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=U6[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $v{constructor(e){this.name=e,this._logLevel=V6,this._logHandler=B6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $t))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?F6[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$t.DEBUG,...e),this._logHandler(this,$t.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$t.VERBOSE,...e),this._logHandler(this,$t.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$t.INFO,...e),this._logHandler(this,$t.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$t.WARN,...e),this._logHandler(this,$t.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$t.ERROR,...e),this._logHandler(this,$t.ERROR,...e)}}const q6=(t,e)=>e.some(n=>t instanceof n);let Vx,Ux;function z6(){return Vx||(Vx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $6(){return Ux||(Ux=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const UN=new WeakMap,f1=new WeakMap,BN=new WeakMap,Bg=new WeakMap,Hv=new WeakMap;function H6(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{n(rl(t.result)),i()},a=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&UN.set(n,t)}).catch(()=>{}),Hv.set(e,t),e}function W6(t){if(f1.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{n(),i()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});f1.set(t,e)}let p1={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return f1.get(t);if(e==="objectStoreNames")return t.objectStoreNames||BN.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return rl(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function G6(t){p1=t(p1)}function K6(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(qg(this),e,...n);return BN.set(r,e.sort?e.sort():[e]),rl(r)}:$6().includes(t)?function(...e){return t.apply(qg(this),e),rl(UN.get(this))}:function(...e){return rl(t.apply(qg(this),e))}}function Y6(t){return typeof t=="function"?K6(t):(t instanceof IDBTransaction&&W6(t),q6(t,z6())?new Proxy(t,p1):t)}function rl(t){if(t instanceof IDBRequest)return H6(t);if(Bg.has(t))return Bg.get(t);const e=Y6(t);return e!==t&&(Bg.set(t,e),Hv.set(e,t)),e}const qg=t=>Hv.get(t);function Q6(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),l=rl(a);return r&&a.addEventListener("upgradeneeded",c=>{r(rl(a.result),c.oldVersion,c.newVersion,rl(a.transaction),c)}),n&&a.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const X6=["get","getKey","getAll","getAllKeys","count"],J6=["put","add","delete","clear"],zg=new Map;function Bx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(zg.get(e))return zg.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=J6.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||X6.includes(n)))return;const s=async function(a,...l){const c=this.transaction(a,i?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),i&&c.done]))[0]};return zg.set(e,s),s}G6(t=>({...t,get:(e,n,r)=>Bx(e,n)||t.get(e,n,r),has:(e,n)=>!!Bx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z6{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(eC(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function eC(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const m1="@firebase/app",qx="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to=new $v("@firebase/app"),tC="@firebase/app-compat",nC="@firebase/analytics-compat",rC="@firebase/analytics",iC="@firebase/app-check-compat",sC="@firebase/app-check",aC="@firebase/auth",oC="@firebase/auth-compat",lC="@firebase/database",cC="@firebase/data-connect",uC="@firebase/database-compat",dC="@firebase/functions",hC="@firebase/functions-compat",fC="@firebase/installations",pC="@firebase/installations-compat",mC="@firebase/messaging",gC="@firebase/messaging-compat",vC="@firebase/performance",yC="@firebase/performance-compat",xC="@firebase/remote-config",bC="@firebase/remote-config-compat",wC="@firebase/storage",_C="@firebase/storage-compat",NC="@firebase/firestore",AC="@firebase/vertexai-preview",SC="@firebase/firestore-compat",EC="firebase",TC="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g1="[DEFAULT]",CC={[m1]:"fire-core",[tC]:"fire-core-compat",[rC]:"fire-analytics",[nC]:"fire-analytics-compat",[sC]:"fire-app-check",[iC]:"fire-app-check-compat",[aC]:"fire-auth",[oC]:"fire-auth-compat",[lC]:"fire-rtdb",[cC]:"fire-data-connect",[uC]:"fire-rtdb-compat",[dC]:"fire-fn",[hC]:"fire-fn-compat",[fC]:"fire-iid",[pC]:"fire-iid-compat",[mC]:"fire-fcm",[gC]:"fire-fcm-compat",[vC]:"fire-perf",[yC]:"fire-perf-compat",[xC]:"fire-rc",[bC]:"fire-rc-compat",[wC]:"fire-gcs",[_C]:"fire-gcs-compat",[NC]:"fire-fst",[SC]:"fire-fst-compat",[AC]:"fire-vertex","fire-js":"fire-js",[EC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dp=new Map,kC=new Map,v1=new Map;function zx(t,e){try{t.container.addComponent(e)}catch(n){to.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function cl(t){const e=t.name;if(v1.has(e))return to.debug(`There were multiple attempts to register component ${e}.`),!1;v1.set(e,t);for(const n of Dp.values())zx(n,t);for(const n of kC.values())zx(n,t);return!0}function _h(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function oa(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},il=new bh("app","Firebase",IC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new eo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw il.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pc=TC;function qN(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:g1,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw il.create("bad-app-name",{appName:String(i)});if(n||(n=MN()),!n)throw il.create("no-options");const s=Dp.get(i);if(s){if(Rp(n,s.options)&&Rp(r,s.config))return s;throw il.create("duplicate-app",{appName:i})}const a=new M6(i);for(const c of v1.values())a.addComponent(c);const l=new jC(n,r,a);return Dp.set(i,l),l}function Am(t=g1){const e=Dp.get(t);if(!e&&t===g1&&MN())return qN();if(!e)throw il.create("no-app",{appName:t});return e}function hs(t,e,n){var r;let i=(r=CC[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),to.warn(l.join(" "));return}cl(new eo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PC="firebase-heartbeat-database",LC=1,rh="firebase-heartbeat-store";let $g=null;function zN(){return $g||($g=Q6(PC,LC,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(rh)}catch(n){console.warn(n)}}}}).catch(t=>{throw il.create("idb-open",{originalErrorMessage:t.message})})),$g}async function RC(t){try{const n=(await zN()).transaction(rh),r=await n.objectStore(rh).get($N(t));return await n.done,r}catch(e){if(e instanceof xa)to.warn(e.message);else{const n=il.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});to.warn(n.message)}}}async function $x(t,e){try{const r=(await zN()).transaction(rh,"readwrite");await r.objectStore(rh).put(e,$N(t)),await r.done}catch(n){if(n instanceof xa)to.warn(n.message);else{const r=il.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});to.warn(r.message)}}}function $N(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DC=1024,OC=30*24*60*60*1e3;class MC{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new VC(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Hx();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=OC}),this._storage.overwrite(this._heartbeatsCache))}catch(r){to.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Hx(),{heartbeatsToSend:r,unsentEntries:i}=FC(this._heartbeatsCache.heartbeats),s=Lp(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return to.warn(n),""}}}function Hx(){return new Date().toISOString().substring(0,10)}function FC(t,e=DC){const n=[];let r=t.slice();for(const i of t){const s=n.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Wx(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Wx(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class VC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return S6()?E6().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await RC(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return $x(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return $x(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Wx(t){return Lp(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UC(t){cl(new eo("platform-logger",e=>new Z6(e),"PRIVATE")),cl(new eo("heartbeat",e=>new MC(e),"PRIVATE")),hs(m1,qx,t),hs(m1,qx,"esm2017"),hs("fire-js","")}UC("");function Wv(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function HN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const BC=HN,WN=new bh("auth","Firebase",HN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Op=new $v("@firebase/auth");function qC(t,...e){Op.logLevel<=$t.WARN&&Op.warn(`Auth (${pc}): ${t}`,...e)}function Gf(t,...e){Op.logLevel<=$t.ERROR&&Op.error(`Auth (${pc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ds(t,...e){throw Gv(t,...e)}function da(t,...e){return Gv(t,...e)}function GN(t,e,n){const r=Object.assign(Object.assign({},BC()),{[e]:n});return new bh("auth","Firebase",r).create(e,{appName:t.name})}function Ka(t){return GN(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Gv(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return WN.create(t,...e)}function vt(t,e,...n){if(!t)throw Gv(e,...n)}function $a(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Gf(e),new Error(e)}function no(t,e){t||$a(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y1(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function zC(){return Gx()==="http:"||Gx()==="https:"}function Gx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $C(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zC()||w6()||"connection"in navigator)?navigator.onLine:!0}function HC(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh{constructor(e,n){this.shortDelay=e,this.longDelay=n,no(n>e,"Short delay should be less than long delay!"),this.isMobile=y6()||_6()}get(){return $C()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kv(t,e){no(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;$a("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;$a("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;$a("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GC=new Nh(3e4,6e4);function lo(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ba(t,e,n,r,i={}){return YN(t,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const l=wh(Object.assign({key:t.config.apiKey},a)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},s);return b6()||(u.referrerPolicy="no-referrer"),KN.fetch()(QN(t,t.config.apiHost,n,l),u)})}async function YN(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},WC),e);try{const i=new YC(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw bf(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const l=s.ok?a.errorMessage:a.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw bf(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw bf(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw bf(t,"user-disabled",a);const f=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw GN(t,f,u);Ds(t,f)}}catch(i){if(i instanceof xa)throw i;Ds(t,"network-request-failed",{message:String(i)})}}async function Ah(t,e,n,r,i={}){const s=await ba(t,e,n,r,i);return"mfaPendingCredential"in s&&Ds(t,"multi-factor-auth-required",{_serverResponse:s}),s}function QN(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?Kv(t.config,i):`${t.config.apiScheme}://${i}`}function KC(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class YC{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(da(this.auth,"network-request-failed")),GC.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function bf(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=da(t,e,r);return i.customData._tokenResponse=n,i}function Kx(t){return t!==void 0&&t.enterprise!==void 0}class QC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return KC(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function XC(t,e){return ba(t,"GET","/v2/recaptchaConfig",lo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JC(t,e){return ba(t,"POST","/v1/accounts:delete",e)}async function XN(t,e){return ba(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ld(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function ZC(t,e=!1){const n=Dn(t),r=await n.getIdToken(e),i=Yv(r);vt(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Ld(Hg(i.auth_time)),issuedAtTime:Ld(Hg(i.iat)),expirationTime:Ld(Hg(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Hg(t){return Number(t)*1e3}function Yv(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Gf("JWT malformed, contained fewer than 3 sections"),null;try{const i=DN(n);return i?JSON.parse(i):(Gf("Failed to decode base64 JWT payload"),null)}catch(i){return Gf("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Yx(t){const e=Yv(t);return vt(e,"internal-error"),vt(typeof e.exp<"u","internal-error"),vt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof xa&&ek(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function ek({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ld(this.lastLoginAt),this.creationTime=Ld(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mp(t){var e;const n=t.auth,r=await t.getIdToken(),i=await vu(t,XN(n,{idToken:r}));vt(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?JN(s.providerUserInfo):[],l=rk(t.providerData,a),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),f=c?u:!1,g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new x1(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,g)}async function nk(t){const e=Dn(t);await Mp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function rk(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function JN(t){return t.map(e=>{var{providerId:n}=e,r=Wv(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ik(t,e){const n=await YN(t,{},async()=>{const r=wh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=QN(t,i,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",KN.fetch()(a,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function sk(t,e){return ba(t,"POST","/v2/accounts:revokeToken",lo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){vt(e.idToken,"internal-error"),vt(typeof e.idToken<"u","internal-error"),vt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Yx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){vt(e.length!==0,"internal-error");const n=Yx(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(vt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await ik(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,a=new tu;return r&&(vt(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(vt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(vt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new tu,this.toJSON())}_performRefresh(){return $a("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ro(t,e){vt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ha{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=Wv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new tk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new x1(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await vu(this,this.stsTokenManager.getToken(this.auth,e));return vt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return ZC(this,e)}reload(){return nk(this)}_assign(e){this!==e&&(vt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ha(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){vt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Mp(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(oa(this.auth.app))return Promise.reject(Ka(this.auth));const e=await this.getIdToken();return await vu(this,JC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,a,l,c,u,f;const g=(r=n.displayName)!==null&&r!==void 0?r:void 0,y=(i=n.email)!==null&&i!==void 0?i:void 0,p=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,T=(a=n.photoURL)!==null&&a!==void 0?a:void 0,E=(l=n.tenantId)!==null&&l!==void 0?l:void 0,P=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,A=(u=n.createdAt)!==null&&u!==void 0?u:void 0,L=(f=n.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:M,emailVerified:F,isAnonymous:te,providerData:ae,stsTokenManager:B}=n;vt(M&&B,e,"internal-error");const I=tu.fromJSON(this.name,B);vt(typeof M=="string",e,"internal-error"),Ro(g,e.name),Ro(y,e.name),vt(typeof F=="boolean",e,"internal-error"),vt(typeof te=="boolean",e,"internal-error"),Ro(p,e.name),Ro(T,e.name),Ro(E,e.name),Ro(P,e.name),Ro(A,e.name),Ro(L,e.name);const j=new Ha({uid:M,auth:e,email:y,emailVerified:F,displayName:g,isAnonymous:te,photoURL:T,phoneNumber:p,tenantId:E,stsTokenManager:I,createdAt:A,lastLoginAt:L});return ae&&Array.isArray(ae)&&(j.providerData=ae.map(S=>Object.assign({},S))),P&&(j._redirectEventId=P),j}static async _fromIdTokenResponse(e,n,r=!1){const i=new tu;i.updateFromServerResponse(n);const s=new Ha({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Mp(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];vt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?JN(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new tu;l.updateFromIdToken(r);const c=new Ha({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new x1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qx=new Map;function Wa(t){no(t instanceof Function,"Expected a class definition");let e=Qx.get(t);return e?(no(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Qx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}ZN.type="NONE";const Xx=ZN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kf(t,e,n){return`firebase:${t}:${e}:${n}`}class nu{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Kf(this.userKey,i.apiKey,s),this.fullPersistenceKey=Kf("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ha._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new nu(Wa(Xx),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Wa(Xx);const a=Kf(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const f=await u._get(a);if(f){const g=Ha._fromJSON(e,f);u!==s&&(l=g),s=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new nu(s,e,r):(s=c[0],l&&await s._set(a,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(a)}catch{}})),new nu(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jx(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(r4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(e4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(s4(e))return"Blackberry";if(a4(e))return"Webos";if(t4(e))return"Safari";if((e.includes("chrome/")||n4(e))&&!e.includes("edge/"))return"Chrome";if(i4(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function e4(t=ii()){return/firefox\//i.test(t)}function t4(t=ii()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function n4(t=ii()){return/crios\//i.test(t)}function r4(t=ii()){return/iemobile/i.test(t)}function i4(t=ii()){return/android/i.test(t)}function s4(t=ii()){return/blackberry/i.test(t)}function a4(t=ii()){return/webos/i.test(t)}function Qv(t=ii()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function ak(t=ii()){var e;return Qv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function ok(){return N6()&&document.documentMode===10}function o4(t=ii()){return Qv(t)||i4(t)||a4(t)||s4(t)||/windows phone/i.test(t)||r4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l4(t,e=[]){let n;switch(t){case"Browser":n=Jx(ii());break;case"Worker":n=`${Jx(ii())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${pc}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((a,l)=>{try{const c=e(s);a(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ck(t,e={}){return ba(t,"GET","/v2/passwordPolicy",lo(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uk=6;class dk{constructor(e){var n,r,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:uk,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,a,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Zx(this),this.idTokenSubscription=new Zx(this),this.beforeStateQueue=new lk(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=WN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Wa(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await nu.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await XN(this,{idToken:e}),r=await Ha._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(oa(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===l)&&(c!=null&&c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return vt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Mp(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=HC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(oa(this.app))return Promise.reject(Ka(this));const n=e?Dn(e):null;return n&&vt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&vt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return oa(this.app)?Promise.reject(Ka(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return oa(this.app)?Promise.reject(Ka(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Wa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ck(this),n=new dk(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new bh("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await sk(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Wa(e)||this._popupRedirectResolver;vt(n,this,"argument-error"),this.redirectPersistenceManager=await nu.create(this,[Wa(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(vt(l,this,"internal-error"),l.then(()=>{a||s(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,i);return()=>{a=!0,c()}}else{const c=e.addObserver(n);return()=>{a=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return vt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=l4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&qC(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function mc(t){return Dn(t)}class Zx{constructor(e){this.auth=e,this.observer=null,this.addObserver=j6(n=>this.observer=n)}get next(){return vt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function fk(t){Sm=t}function c4(t){return Sm.loadJS(t)}function pk(){return Sm.recaptchaEnterpriseScript}function mk(){return Sm.gapiScript}function gk(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const vk="recaptcha-enterprise",yk="NO_RECAPTCHA";class xk{constructor(e){this.type=vk,this.auth=mc(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,l)=>{XC(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new QC(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,a(u.siteKey)}}).catch(c=>{l(c)})})}function i(s,a,l){const c=window.grecaptcha;Kx(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{a(u)}).catch(()=>{a(yk)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{r(this.auth).then(l=>{if(!n&&Kx(window.grecaptcha))i(l,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let c=pk();c.length!==0&&(c+=l),c4(c).then(()=>{i(l,s,a)}).catch(u=>{a(u)})}}).catch(l=>{a(l)})})}}async function eb(t,e,n,r=!1){const i=new xk(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function b1(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await eb(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await eb(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bk(t,e){const n=_h(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Rp(s,e??{}))return i;Ds(i,"already-initialized")}return n.initialize({options:e})}function wk(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Wa);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function _k(t,e,n){const r=mc(t);vt(r._canInitEmulator,r,"emulator-config-failed"),vt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=u4(e),{host:a,port:l}=Nk(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${s}//${a}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),Ak()}function u4(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Nk(t){const e=u4(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:tb(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:tb(a)}}}function tb(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Ak(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xv{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return $a("not implemented")}_getIdTokenResponse(e){return $a("not implemented")}_linkToIdToken(e,n){return $a("not implemented")}_getReauthenticationResolver(e){return $a("not implemented")}}async function Sk(t,e){return ba(t,"POST","/v1/accounts:update",e)}async function Ek(t,e){return ba(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tk(t,e){return Ah(t,"POST","/v1/accounts:signInWithPassword",lo(t,e))}async function Ck(t,e){return ba(t,"POST","/v1/accounts:sendOobCode",lo(t,e))}async function kk(t,e){return Ck(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ik(t,e){return Ah(t,"POST","/v1/accounts:signInWithEmailLink",lo(t,e))}async function jk(t,e){return Ah(t,"POST","/v1/accounts:signInWithEmailLink",lo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih extends Xv{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new ih(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new ih(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return b1(e,n,"signInWithPassword",Tk);case"emailLink":return Ik(e,{email:this._email,oobCode:this._password});default:Ds(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return b1(e,r,"signUpPassword",Ek);case"emailLink":return jk(e,{idToken:n,email:this._email,oobCode:this._password});default:Ds(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ru(t,e){return Ah(t,"POST","/v1/accounts:signInWithIdp",lo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pk="http://localhost";class sc extends Xv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new sc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ds("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=Wv(n,["providerId","signInMethod"]);if(!r||!i)return null;const a=new sc(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return ru(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ru(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ru(e,n)}buildRequest(){const e={requestUri:Pk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=wh(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lk(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Rk(t){const e=yd(xd(t)).link,n=e?yd(xd(e)).deep_link_id:null,r=yd(xd(t)).deep_link_id;return(r?yd(xd(r)).link:null)||r||n||e||t}class Jv{constructor(e){var n,r,i,s,a,l;const c=yd(xd(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,f=(r=c.oobCode)!==null&&r!==void 0?r:null,g=Lk((i=c.mode)!==null&&i!==void 0?i:null);vt(u&&f&&g,"argument-error"),this.apiKey=u,this.operation=g,this.code=f,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=c.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=Rk(e);try{return new Jv(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(){this.providerId=ku.PROVIDER_ID}static credential(e,n){return ih._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Jv.parseLink(n);return vt(r,"argument-error"),ih._fromEmailAndCode(e,r.code,r.tenantId)}}ku.PROVIDER_ID="password";ku.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ku.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh extends d4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo extends Sh{constructor(){super("facebook.com")}static credential(e){return sc._fromParams({providerId:Bo.PROVIDER_ID,signInMethod:Bo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bo.credentialFromTaggedObject(e)}static credentialFromError(e){return Bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bo.credential(e.oauthAccessToken)}catch{return null}}}Bo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Bo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo extends Sh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return sc._fromParams({providerId:qo.PROVIDER_ID,signInMethod:qo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return qo.credentialFromTaggedObject(e)}static credentialFromError(e){return qo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return qo.credential(n,r)}catch{return null}}}qo.GOOGLE_SIGN_IN_METHOD="google.com";qo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo extends Sh{constructor(){super("github.com")}static credential(e){return sc._fromParams({providerId:zo.PROVIDER_ID,signInMethod:zo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zo.credentialFromTaggedObject(e)}static credentialFromError(e){return zo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zo.credential(e.oauthAccessToken)}catch{return null}}}zo.GITHUB_SIGN_IN_METHOD="github.com";zo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o extends Sh{constructor(){super("twitter.com")}static credential(e,n){return sc._fromParams({providerId:$o.PROVIDER_ID,signInMethod:$o.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return $o.credentialFromTaggedObject(e)}static credentialFromError(e){return $o.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return $o.credential(n,r)}catch{return null}}}$o.TWITTER_SIGN_IN_METHOD="twitter.com";$o.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dk(t,e){return Ah(t,"POST","/v1/accounts:signUp",lo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Ha._fromIdTokenResponse(e,r,i),a=nb(r);return new ac({user:s,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=nb(r);return new ac({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function nb(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp extends xa{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Fp.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Fp(e,n,r,i)}}function h4(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Fp._fromErrorAndOperation(t,s,e,r):s})}async function Ok(t,e,n=!1){const r=await vu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ac._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mk(t,e,n=!1){const{auth:r}=t;if(oa(r.app))return Promise.reject(Ka(r));const i="reauthenticate";try{const s=await vu(t,h4(r,i,e,t),n);vt(s.idToken,r,"internal-error");const a=Yv(s.idToken);vt(a,r,"internal-error");const{sub:l}=a;return vt(t.uid===l,r,"user-mismatch"),ac._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Ds(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f4(t,e,n=!1){if(oa(t.app))return Promise.reject(Ka(t));const r="signIn",i=await h4(t,r,e),s=await ac._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function Fk(t,e){return f4(mc(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p4(t){const e=mc(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Em(t,e,n){if(oa(t.app))return Promise.reject(Ka(t));const r=mc(t),a=await b1(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Dk).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&p4(t),c}),l=await ac._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(l.user),l}function Vp(t,e,n){return oa(t.app)?Promise.reject(Ka(t)):Fk(Dn(t),ku.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&p4(t),r})}async function m4(t,e){const n=Dn(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:s}=await kk(n.auth,i);s!==t.email&&await t.reload()}function Vk(t,e){return Uk(Dn(t),null,e)}async function Uk(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(s.password=n);const a=await vu(t,Sk(r,s));await t._updateTokensIfNecessary(a,!0)}function Bk(t,e,n,r){return Dn(t).onIdTokenChanged(e,n,r)}function qk(t,e,n){return Dn(t).beforeAuthStateChanged(e,n)}function zk(t,e,n,r){return Dn(t).onAuthStateChanged(e,n,r)}function Wl(t){return Dn(t).signOut()}const Up="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g4{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Up,"1"),this.storage.removeItem(Up),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $k=1e3,Hk=10;class v4 extends g4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=o4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,l,c)=>{this.notifyListeners(a,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);ok()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Hk):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},$k)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}v4.type="LOCAL";const Wk=v4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4 extends g4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}y4.type="SESSION";const x4=y4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gk(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Tm(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(a).map(async u=>u(n.origin,s)),c=await Gk(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Tm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zv(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((l,c)=>{const u=Zv("",20);i.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(g){const y=g;if(y.data.eventId===u)switch(y.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(y.data.response);break;default:clearTimeout(f),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ha(){return window}function Yk(t){ha().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b4(){return typeof ha().WorkerGlobalScope<"u"&&typeof ha().importScripts=="function"}async function Qk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Xk(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Jk(){return b4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w4="firebaseLocalStorageDb",Zk=1,Bp="firebaseLocalStorage",_4="fbase_key";class Eh{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Cm(t,e){return t.transaction([Bp],e?"readwrite":"readonly").objectStore(Bp)}function eI(){const t=indexedDB.deleteDatabase(w4);return new Eh(t).toPromise()}function w1(){const t=indexedDB.open(w4,Zk);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Bp,{keyPath:_4})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Bp)?e(r):(r.close(),await eI(),e(await w1()))})})}async function rb(t,e,n){const r=Cm(t,!0).put({[_4]:e,value:n});return new Eh(r).toPromise()}async function tI(t,e){const n=Cm(t,!1).get(e),r=await new Eh(n).toPromise();return r===void 0?null:r.value}function ib(t,e){const n=Cm(t,!0).delete(e);return new Eh(n).toPromise()}const nI=800,rI=3;class N4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await w1(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>rI)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return b4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Tm._getInstance(Jk()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await Qk(),!this.activeServiceWorker)return;this.sender=new Kk(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Xk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await w1();return await rb(e,Up,"1"),await ib(e,Up),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>rb(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>tI(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>ib(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Cm(i,!1).getAll();return new Eh(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),nI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}N4.type="LOCAL";const iI=N4;new Nh(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sI(t,e){return e?Wa(e):(vt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2 extends Xv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ru(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ru(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ru(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function aI(t){return f4(t.auth,new e2(t),t.bypassAuthState)}function oI(t){const{auth:e,user:n}=t;return vt(n,e,"internal-error"),Mk(n,new e2(t),t.bypassAuthState)}async function lI(t){const{auth:e,user:n}=t;return vt(n,e,"internal-error"),Ok(n,new e2(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A4{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:a,type:l}=e;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return aI;case"linkViaPopup":case"linkViaRedirect":return lI;case"reauthViaPopup":case"reauthViaRedirect":return oI;default:Ds(this.auth,"internal-error")}}resolve(e){no(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){no(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI=new Nh(2e3,1e4);class Gc extends A4{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Gc.currentPopupAction&&Gc.currentPopupAction.cancel(),Gc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return vt(e,this.auth,"internal-error"),e}async onExecution(){no(this.filter.length===1,"Popup operations only handle one event");const e=Zv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(da(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(da(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Gc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(da(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,cI.get())};e()}}Gc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI="pendingRedirect",Yf=new Map;class dI extends A4{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Yf.get(this.auth._key());if(!e){try{const r=await hI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Yf.set(this.auth._key(),e)}return this.bypassAuthState||Yf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function hI(t,e){const n=mI(e),r=pI(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function fI(t,e){Yf.set(t._key(),e)}function pI(t){return Wa(t._redirectPersistence)}function mI(t){return Kf(uI,t.config.apiKey,t.name)}async function gI(t,e,n=!1){if(oa(t.app))return Promise.reject(Ka(t));const r=mc(t),i=sI(r,e),a=await new dI(r,i,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vI=10*60*1e3;class yI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!xI(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!S4(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(da(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=vI&&this.cachedEventUids.clear(),this.cachedEventUids.has(sb(e))}saveEventToCache(e){this.cachedEventUids.add(sb(e)),this.lastProcessedEventTime=Date.now()}}function sb(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function S4({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function xI(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return S4(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bI(t,e={}){return ba(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_I=/^https?/;async function NI(t){if(t.config.emulator)return;const{authorizedDomains:e}=await bI(t);for(const n of e)try{if(AI(n))return}catch{}Ds(t,"unauthorized-domain")}function AI(t){const e=y1(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!_I.test(n))return!1;if(wI.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SI=new Nh(3e4,6e4);function ab(){const t=ha().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function EI(t){return new Promise((e,n)=>{var r,i,s;function a(){ab(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ab(),n(da(t,"network-request-failed"))},timeout:SI.get()})}if(!((i=(r=ha().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ha().gapi)===null||s===void 0)&&s.load)a();else{const l=gk("iframefcb");return ha()[l]=()=>{gapi.load?a():n(da(t,"network-request-failed"))},c4(`${mk()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw Qf=null,e})}let Qf=null;function TI(t){return Qf=Qf||EI(t),Qf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI=new Nh(5e3,15e3),kI="__/auth/iframe",II="emulator/auth/iframe",jI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},PI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function LI(t){const e=t.config;vt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Kv(e,II):`https://${t.config.authDomain}/${kI}`,r={apiKey:e.apiKey,appName:t.name,v:pc},i=PI.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${wh(r).slice(1)}`}async function RI(t){const e=await TI(t),n=ha().gapi;return vt(n,t,"internal-error"),e.open({where:document.body,url:LI(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:jI,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=da(t,"network-request-failed"),l=ha().setTimeout(()=>{s(a)},CI.get());function c(){ha().clearTimeout(l),i(r)}r.ping(c).then(c,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},OI=500,MI=600,FI="_blank",VI="http://localhost";class ob{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function UI(t,e,n,r=OI,i=MI){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},DI),{width:r.toString(),height:i.toString(),top:s,left:a}),u=ii().toLowerCase();n&&(l=n4(u)?FI:n),e4(u)&&(e=e||VI,c.scrollbars="yes");const f=Object.entries(c).reduce((y,[p,T])=>`${y}${p}=${T},`,"");if(ak(u)&&l!=="_self")return BI(e||"",l),new ob(null);const g=window.open(e||"",l,f);vt(g,t,"popup-blocked");try{g.focus()}catch{}return new ob(g)}function BI(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qI="__/auth/handler",zI="emulator/auth/handler",$I=encodeURIComponent("fac");async function lb(t,e,n,r,i,s){vt(t.config.authDomain,t,"auth-domain-config-required"),vt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:pc,eventId:i};if(e instanceof d4){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",I6(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,g]of Object.entries({}))a[f]=g}if(e instanceof Sh){const f=e.getScopes().filter(g=>g!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const l=a;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const c=await t._getAppCheckToken(),u=c?`#${$I}=${encodeURIComponent(c)}`:"";return`${HI(t)}?${wh(l).slice(1)}${u}`}function HI({config:t}){return t.emulator?Kv(t,zI):`https://${t.authDomain}/${qI}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wg="webStorageSupport";class WI{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=x4,this._completeRedirectFn=gI,this._overrideRedirectResult=fI}async _openPopup(e,n,r,i){var s;no((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await lb(e,n,r,y1(),i);return UI(e,a,Zv())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await lb(e,n,r,y1(),i);return Yk(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(no(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await RI(e),r=new yI(e);return n.register("authEvent",i=>(vt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Wg,{type:Wg},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Wg];a!==void 0&&n(!!a),Ds(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=NI(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return o4()||t4()||Qv()}}const GI=WI;var cb="@firebase/auth",ub="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KI{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){vt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YI(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function QI(t){cl(new eo("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;vt(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:a,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:l4(t)},u=new hk(r,i,s,c);return wk(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),cl(new eo("auth-internal",e=>{const n=mc(e.getProvider("auth").getImmediate());return(r=>new KI(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),hs(cb,ub,YI(t)),hs(cb,ub,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XI=5*60,JI=FN("authIdTokenMaxAge")||XI;let db=null;const ZI=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>JI)return;const i=n==null?void 0:n.token;db!==i&&(db=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function ej(t=Am()){const e=_h(t,"auth");if(e.isInitialized())return e.getImmediate();const n=bk(t,{popupRedirectResolver:GI,persistence:[iI,Wk,x4]}),r=FN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const a=ZI(s.toString());qk(n,a,()=>a(n.currentUser)),Bk(n,l=>a(l))}}const i=ON("auth");return i&&_k(n,`http://${i}`),n}function tj(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}fk({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=da("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",tj().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});QI("Browser");var hb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ql,E4;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(B,I){function j(){}j.prototype=I.prototype,B.D=I.prototype,B.prototype=new j,B.prototype.constructor=B,B.C=function(S,N,w){for(var k=Array(arguments.length-2),H=2;H<arguments.length;H++)k[H-2]=arguments[H];return I.prototype[N].apply(S,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(B,I,j){j||(j=0);var S=Array(16);if(typeof I=="string")for(var N=0;16>N;++N)S[N]=I.charCodeAt(j++)|I.charCodeAt(j++)<<8|I.charCodeAt(j++)<<16|I.charCodeAt(j++)<<24;else for(N=0;16>N;++N)S[N]=I[j++]|I[j++]<<8|I[j++]<<16|I[j++]<<24;I=B.g[0],j=B.g[1],N=B.g[2];var w=B.g[3],k=I+(w^j&(N^w))+S[0]+3614090360&4294967295;I=j+(k<<7&4294967295|k>>>25),k=w+(N^I&(j^N))+S[1]+3905402710&4294967295,w=I+(k<<12&4294967295|k>>>20),k=N+(j^w&(I^j))+S[2]+606105819&4294967295,N=w+(k<<17&4294967295|k>>>15),k=j+(I^N&(w^I))+S[3]+3250441966&4294967295,j=N+(k<<22&4294967295|k>>>10),k=I+(w^j&(N^w))+S[4]+4118548399&4294967295,I=j+(k<<7&4294967295|k>>>25),k=w+(N^I&(j^N))+S[5]+1200080426&4294967295,w=I+(k<<12&4294967295|k>>>20),k=N+(j^w&(I^j))+S[6]+2821735955&4294967295,N=w+(k<<17&4294967295|k>>>15),k=j+(I^N&(w^I))+S[7]+4249261313&4294967295,j=N+(k<<22&4294967295|k>>>10),k=I+(w^j&(N^w))+S[8]+1770035416&4294967295,I=j+(k<<7&4294967295|k>>>25),k=w+(N^I&(j^N))+S[9]+2336552879&4294967295,w=I+(k<<12&4294967295|k>>>20),k=N+(j^w&(I^j))+S[10]+4294925233&4294967295,N=w+(k<<17&4294967295|k>>>15),k=j+(I^N&(w^I))+S[11]+2304563134&4294967295,j=N+(k<<22&4294967295|k>>>10),k=I+(w^j&(N^w))+S[12]+1804603682&4294967295,I=j+(k<<7&4294967295|k>>>25),k=w+(N^I&(j^N))+S[13]+4254626195&4294967295,w=I+(k<<12&4294967295|k>>>20),k=N+(j^w&(I^j))+S[14]+2792965006&4294967295,N=w+(k<<17&4294967295|k>>>15),k=j+(I^N&(w^I))+S[15]+1236535329&4294967295,j=N+(k<<22&4294967295|k>>>10),k=I+(N^w&(j^N))+S[1]+4129170786&4294967295,I=j+(k<<5&4294967295|k>>>27),k=w+(j^N&(I^j))+S[6]+3225465664&4294967295,w=I+(k<<9&4294967295|k>>>23),k=N+(I^j&(w^I))+S[11]+643717713&4294967295,N=w+(k<<14&4294967295|k>>>18),k=j+(w^I&(N^w))+S[0]+3921069994&4294967295,j=N+(k<<20&4294967295|k>>>12),k=I+(N^w&(j^N))+S[5]+3593408605&4294967295,I=j+(k<<5&4294967295|k>>>27),k=w+(j^N&(I^j))+S[10]+38016083&4294967295,w=I+(k<<9&4294967295|k>>>23),k=N+(I^j&(w^I))+S[15]+3634488961&4294967295,N=w+(k<<14&4294967295|k>>>18),k=j+(w^I&(N^w))+S[4]+3889429448&4294967295,j=N+(k<<20&4294967295|k>>>12),k=I+(N^w&(j^N))+S[9]+568446438&4294967295,I=j+(k<<5&4294967295|k>>>27),k=w+(j^N&(I^j))+S[14]+3275163606&4294967295,w=I+(k<<9&4294967295|k>>>23),k=N+(I^j&(w^I))+S[3]+4107603335&4294967295,N=w+(k<<14&4294967295|k>>>18),k=j+(w^I&(N^w))+S[8]+1163531501&4294967295,j=N+(k<<20&4294967295|k>>>12),k=I+(N^w&(j^N))+S[13]+2850285829&4294967295,I=j+(k<<5&4294967295|k>>>27),k=w+(j^N&(I^j))+S[2]+4243563512&4294967295,w=I+(k<<9&4294967295|k>>>23),k=N+(I^j&(w^I))+S[7]+1735328473&4294967295,N=w+(k<<14&4294967295|k>>>18),k=j+(w^I&(N^w))+S[12]+2368359562&4294967295,j=N+(k<<20&4294967295|k>>>12),k=I+(j^N^w)+S[5]+4294588738&4294967295,I=j+(k<<4&4294967295|k>>>28),k=w+(I^j^N)+S[8]+2272392833&4294967295,w=I+(k<<11&4294967295|k>>>21),k=N+(w^I^j)+S[11]+1839030562&4294967295,N=w+(k<<16&4294967295|k>>>16),k=j+(N^w^I)+S[14]+4259657740&4294967295,j=N+(k<<23&4294967295|k>>>9),k=I+(j^N^w)+S[1]+2763975236&4294967295,I=j+(k<<4&4294967295|k>>>28),k=w+(I^j^N)+S[4]+1272893353&4294967295,w=I+(k<<11&4294967295|k>>>21),k=N+(w^I^j)+S[7]+4139469664&4294967295,N=w+(k<<16&4294967295|k>>>16),k=j+(N^w^I)+S[10]+3200236656&4294967295,j=N+(k<<23&4294967295|k>>>9),k=I+(j^N^w)+S[13]+681279174&4294967295,I=j+(k<<4&4294967295|k>>>28),k=w+(I^j^N)+S[0]+3936430074&4294967295,w=I+(k<<11&4294967295|k>>>21),k=N+(w^I^j)+S[3]+3572445317&4294967295,N=w+(k<<16&4294967295|k>>>16),k=j+(N^w^I)+S[6]+76029189&4294967295,j=N+(k<<23&4294967295|k>>>9),k=I+(j^N^w)+S[9]+3654602809&4294967295,I=j+(k<<4&4294967295|k>>>28),k=w+(I^j^N)+S[12]+3873151461&4294967295,w=I+(k<<11&4294967295|k>>>21),k=N+(w^I^j)+S[15]+530742520&4294967295,N=w+(k<<16&4294967295|k>>>16),k=j+(N^w^I)+S[2]+3299628645&4294967295,j=N+(k<<23&4294967295|k>>>9),k=I+(N^(j|~w))+S[0]+4096336452&4294967295,I=j+(k<<6&4294967295|k>>>26),k=w+(j^(I|~N))+S[7]+1126891415&4294967295,w=I+(k<<10&4294967295|k>>>22),k=N+(I^(w|~j))+S[14]+2878612391&4294967295,N=w+(k<<15&4294967295|k>>>17),k=j+(w^(N|~I))+S[5]+4237533241&4294967295,j=N+(k<<21&4294967295|k>>>11),k=I+(N^(j|~w))+S[12]+1700485571&4294967295,I=j+(k<<6&4294967295|k>>>26),k=w+(j^(I|~N))+S[3]+2399980690&4294967295,w=I+(k<<10&4294967295|k>>>22),k=N+(I^(w|~j))+S[10]+4293915773&4294967295,N=w+(k<<15&4294967295|k>>>17),k=j+(w^(N|~I))+S[1]+2240044497&4294967295,j=N+(k<<21&4294967295|k>>>11),k=I+(N^(j|~w))+S[8]+1873313359&4294967295,I=j+(k<<6&4294967295|k>>>26),k=w+(j^(I|~N))+S[15]+4264355552&4294967295,w=I+(k<<10&4294967295|k>>>22),k=N+(I^(w|~j))+S[6]+2734768916&4294967295,N=w+(k<<15&4294967295|k>>>17),k=j+(w^(N|~I))+S[13]+1309151649&4294967295,j=N+(k<<21&4294967295|k>>>11),k=I+(N^(j|~w))+S[4]+4149444226&4294967295,I=j+(k<<6&4294967295|k>>>26),k=w+(j^(I|~N))+S[11]+3174756917&4294967295,w=I+(k<<10&4294967295|k>>>22),k=N+(I^(w|~j))+S[2]+718787259&4294967295,N=w+(k<<15&4294967295|k>>>17),k=j+(w^(N|~I))+S[9]+3951481745&4294967295,B.g[0]=B.g[0]+I&4294967295,B.g[1]=B.g[1]+(N+(k<<21&4294967295|k>>>11))&4294967295,B.g[2]=B.g[2]+N&4294967295,B.g[3]=B.g[3]+w&4294967295}r.prototype.u=function(B,I){I===void 0&&(I=B.length);for(var j=I-this.blockSize,S=this.B,N=this.h,w=0;w<I;){if(N==0)for(;w<=j;)i(this,B,w),w+=this.blockSize;if(typeof B=="string"){for(;w<I;)if(S[N++]=B.charCodeAt(w++),N==this.blockSize){i(this,S),N=0;break}}else for(;w<I;)if(S[N++]=B[w++],N==this.blockSize){i(this,S),N=0;break}}this.h=N,this.o+=I},r.prototype.v=function(){var B=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);B[0]=128;for(var I=1;I<B.length-8;++I)B[I]=0;var j=8*this.o;for(I=B.length-8;I<B.length;++I)B[I]=j&255,j/=256;for(this.u(B),B=Array(16),I=j=0;4>I;++I)for(var S=0;32>S;S+=8)B[j++]=this.g[I]>>>S&255;return B};function s(B,I){var j=l;return Object.prototype.hasOwnProperty.call(j,B)?j[B]:j[B]=I(B)}function a(B,I){this.h=I;for(var j=[],S=!0,N=B.length-1;0<=N;N--){var w=B[N]|0;S&&w==I||(j[N]=w,S=!1)}this.g=j}var l={};function c(B){return-128<=B&&128>B?s(B,function(I){return new a([I|0],0>I?-1:0)}):new a([B|0],0>B?-1:0)}function u(B){if(isNaN(B)||!isFinite(B))return g;if(0>B)return P(u(-B));for(var I=[],j=1,S=0;B>=j;S++)I[S]=B/j|0,j*=4294967296;return new a(I,0)}function f(B,I){if(B.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(B.charAt(0)=="-")return P(f(B.substring(1),I));if(0<=B.indexOf("-"))throw Error('number format error: interior "-" character');for(var j=u(Math.pow(I,8)),S=g,N=0;N<B.length;N+=8){var w=Math.min(8,B.length-N),k=parseInt(B.substring(N,N+w),I);8>w?(w=u(Math.pow(I,w)),S=S.j(w).add(u(k))):(S=S.j(j),S=S.add(u(k)))}return S}var g=c(0),y=c(1),p=c(16777216);t=a.prototype,t.m=function(){if(E(this))return-P(this).m();for(var B=0,I=1,j=0;j<this.g.length;j++){var S=this.i(j);B+=(0<=S?S:4294967296+S)*I,I*=4294967296}return B},t.toString=function(B){if(B=B||10,2>B||36<B)throw Error("radix out of range: "+B);if(T(this))return"0";if(E(this))return"-"+P(this).toString(B);for(var I=u(Math.pow(B,6)),j=this,S="";;){var N=F(j,I).g;j=A(j,N.j(I));var w=((0<j.g.length?j.g[0]:j.h)>>>0).toString(B);if(j=N,T(j))return w+S;for(;6>w.length;)w="0"+w;S=w+S}},t.i=function(B){return 0>B?0:B<this.g.length?this.g[B]:this.h};function T(B){if(B.h!=0)return!1;for(var I=0;I<B.g.length;I++)if(B.g[I]!=0)return!1;return!0}function E(B){return B.h==-1}t.l=function(B){return B=A(this,B),E(B)?-1:T(B)?0:1};function P(B){for(var I=B.g.length,j=[],S=0;S<I;S++)j[S]=~B.g[S];return new a(j,~B.h).add(y)}t.abs=function(){return E(this)?P(this):this},t.add=function(B){for(var I=Math.max(this.g.length,B.g.length),j=[],S=0,N=0;N<=I;N++){var w=S+(this.i(N)&65535)+(B.i(N)&65535),k=(w>>>16)+(this.i(N)>>>16)+(B.i(N)>>>16);S=k>>>16,w&=65535,k&=65535,j[N]=k<<16|w}return new a(j,j[j.length-1]&-2147483648?-1:0)};function A(B,I){return B.add(P(I))}t.j=function(B){if(T(this)||T(B))return g;if(E(this))return E(B)?P(this).j(P(B)):P(P(this).j(B));if(E(B))return P(this.j(P(B)));if(0>this.l(p)&&0>B.l(p))return u(this.m()*B.m());for(var I=this.g.length+B.g.length,j=[],S=0;S<2*I;S++)j[S]=0;for(S=0;S<this.g.length;S++)for(var N=0;N<B.g.length;N++){var w=this.i(S)>>>16,k=this.i(S)&65535,H=B.i(N)>>>16,D=B.i(N)&65535;j[2*S+2*N]+=k*D,L(j,2*S+2*N),j[2*S+2*N+1]+=w*D,L(j,2*S+2*N+1),j[2*S+2*N+1]+=k*H,L(j,2*S+2*N+1),j[2*S+2*N+2]+=w*H,L(j,2*S+2*N+2)}for(S=0;S<I;S++)j[S]=j[2*S+1]<<16|j[2*S];for(S=I;S<2*I;S++)j[S]=0;return new a(j,0)};function L(B,I){for(;(B[I]&65535)!=B[I];)B[I+1]+=B[I]>>>16,B[I]&=65535,I++}function M(B,I){this.g=B,this.h=I}function F(B,I){if(T(I))throw Error("division by zero");if(T(B))return new M(g,g);if(E(B))return I=F(P(B),I),new M(P(I.g),P(I.h));if(E(I))return I=F(B,P(I)),new M(P(I.g),I.h);if(30<B.g.length){if(E(B)||E(I))throw Error("slowDivide_ only works with positive integers.");for(var j=y,S=I;0>=S.l(B);)j=te(j),S=te(S);var N=ae(j,1),w=ae(S,1);for(S=ae(S,2),j=ae(j,2);!T(S);){var k=w.add(S);0>=k.l(B)&&(N=N.add(j),w=k),S=ae(S,1),j=ae(j,1)}return I=A(B,N.j(I)),new M(N,I)}for(N=g;0<=B.l(I);){for(j=Math.max(1,Math.floor(B.m()/I.m())),S=Math.ceil(Math.log(j)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),w=u(j),k=w.j(I);E(k)||0<k.l(B);)j-=S,w=u(j),k=w.j(I);T(w)&&(w=y),N=N.add(w),B=A(B,k)}return new M(N,B)}t.A=function(B){return F(this,B).h},t.and=function(B){for(var I=Math.max(this.g.length,B.g.length),j=[],S=0;S<I;S++)j[S]=this.i(S)&B.i(S);return new a(j,this.h&B.h)},t.or=function(B){for(var I=Math.max(this.g.length,B.g.length),j=[],S=0;S<I;S++)j[S]=this.i(S)|B.i(S);return new a(j,this.h|B.h)},t.xor=function(B){for(var I=Math.max(this.g.length,B.g.length),j=[],S=0;S<I;S++)j[S]=this.i(S)^B.i(S);return new a(j,this.h^B.h)};function te(B){for(var I=B.g.length+1,j=[],S=0;S<I;S++)j[S]=B.i(S)<<1|B.i(S-1)>>>31;return new a(j,B.h)}function ae(B,I){var j=I>>5;I%=32;for(var S=B.g.length-j,N=[],w=0;w<S;w++)N[w]=0<I?B.i(w+j)>>>I|B.i(w+j+1)<<32-I:B.i(w+j);return new a(N,B.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,E4=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=f,Ql=a}).apply(typeof hb<"u"?hb:typeof self<"u"?self:typeof window<"u"?window:{});var wf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var T4,bd,C4,Xf,_1,k4,I4,j4;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,b,R){return h==Array.prototype||h==Object.prototype||(h[b]=R.value),h};function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof wf=="object"&&wf];for(var b=0;b<h.length;++b){var R=h[b];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}var r=n(this);function i(h,b){if(b)e:{var R=r;h=h.split(".");for(var Q=0;Q<h.length-1;Q++){var ge=h[Q];if(!(ge in R))break e;R=R[ge]}h=h[h.length-1],Q=R[h],b=b(Q),b!=Q&&b!=null&&e(R,h,{configurable:!0,writable:!0,value:b})}}function s(h,b){h instanceof String&&(h+="");var R=0,Q=!1,ge={next:function(){if(!Q&&R<h.length){var _e=R++;return{value:b(_e,h[_e]),done:!1}}return Q=!0,{done:!0,value:void 0}}};return ge[Symbol.iterator]=function(){return ge},ge}i("Array.prototype.values",function(h){return h||function(){return s(this,function(b,R){return R})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function c(h){var b=typeof h;return b=b!="object"?b:h?Array.isArray(h)?"array":b:"null",b=="array"||b=="object"&&typeof h.length=="number"}function u(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function f(h,b,R){return h.call.apply(h.bind,arguments)}function g(h,b,R){if(!h)throw Error();if(2<arguments.length){var Q=Array.prototype.slice.call(arguments,2);return function(){var ge=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ge,Q),h.apply(b,ge)}}return function(){return h.apply(b,arguments)}}function y(h,b,R){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:g,y.apply(null,arguments)}function p(h,b){var R=Array.prototype.slice.call(arguments,1);return function(){var Q=R.slice();return Q.push.apply(Q,arguments),h.apply(this,Q)}}function T(h,b){function R(){}R.prototype=b.prototype,h.aa=b.prototype,h.prototype=new R,h.prototype.constructor=h,h.Qb=function(Q,ge,_e){for(var Fe=Array(arguments.length-2),qt=2;qt<arguments.length;qt++)Fe[qt-2]=arguments[qt];return b.prototype[ge].apply(Q,Fe)}}function E(h){const b=h.length;if(0<b){const R=Array(b);for(let Q=0;Q<b;Q++)R[Q]=h[Q];return R}return[]}function P(h,b){for(let R=1;R<arguments.length;R++){const Q=arguments[R];if(c(Q)){const ge=h.length||0,_e=Q.length||0;h.length=ge+_e;for(let Fe=0;Fe<_e;Fe++)h[ge+Fe]=Q[Fe]}else h.push(Q)}}class A{constructor(b,R){this.i=b,this.j=R,this.h=0,this.g=null}get(){let b;return 0<this.h?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function L(h){return/^[\s\xa0]*$/.test(h)}function M(){var h=l.navigator;return h&&(h=h.userAgent)?h:""}function F(h){return F[" "](h),h}F[" "]=function(){};var te=M().indexOf("Gecko")!=-1&&!(M().toLowerCase().indexOf("webkit")!=-1&&M().indexOf("Edge")==-1)&&!(M().indexOf("Trident")!=-1||M().indexOf("MSIE")!=-1)&&M().indexOf("Edge")==-1;function ae(h,b,R){for(const Q in h)b.call(R,h[Q],Q,h)}function B(h,b){for(const R in h)b.call(void 0,h[R],R,h)}function I(h){const b={};for(const R in h)b[R]=h[R];return b}const j="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(h,b){let R,Q;for(let ge=1;ge<arguments.length;ge++){Q=arguments[ge];for(R in Q)h[R]=Q[R];for(let _e=0;_e<j.length;_e++)R=j[_e],Object.prototype.hasOwnProperty.call(Q,R)&&(h[R]=Q[R])}}function N(h){var b=1;h=h.split(":");const R=[];for(;0<b&&h.length;)R.push(h.shift()),b--;return h.length&&R.push(h.join(":")),R}function w(h){l.setTimeout(()=>{throw h},0)}function k(){var h=ee;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class H{constructor(){this.h=this.g=null}add(b,R){const Q=D.get();Q.set(b,R),this.h?this.h.next=Q:this.g=Q,this.h=Q}}var D=new A(()=>new W,h=>h.reset());class W{constructor(){this.next=this.g=this.h=null}set(b,R){this.h=b,this.g=R,this.next=null}reset(){this.next=this.g=this.h=null}}let K,q=!1,ee=new H,ue=()=>{const h=l.Promise.resolve(void 0);K=()=>{h.then(ce)}};var ce=()=>{for(var h;h=k();){try{h.h.call(h.g)}catch(R){w(R)}var b=D;b.j(h),100>b.h&&(b.h++,h.next=b.g,b.g=h)}q=!1};function _(){this.s=this.s,this.C=this.C}_.prototype.s=!1,_.prototype.ma=function(){this.s||(this.s=!0,this.N())},_.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var O=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const R=()=>{};l.addEventListener("test",R,b),l.removeEventListener("test",R,b)}catch{}return h}();function X(h,b){if(z.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var R=this.type=h.type,Q=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget){if(te){e:{try{F(b.nodeName);var ge=!0;break e}catch{}ge=!1}ge||(b=null)}}else R=="mouseover"?b=h.fromElement:R=="mouseout"&&(b=h.toElement);this.relatedTarget=b,Q?(this.clientX=Q.clientX!==void 0?Q.clientX:Q.pageX,this.clientY=Q.clientY!==void 0?Q.clientY:Q.pageY,this.screenX=Q.screenX||0,this.screenY=Q.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Z[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&X.aa.h.call(this)}}T(X,z);var Z={2:"touch",3:"pen",4:"mouse"};X.prototype.h=function(){X.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var le="closure_listenable_"+(1e6*Math.random()|0),me=0;function ye(h,b,R,Q,ge){this.listener=h,this.proxy=null,this.src=b,this.type=R,this.capture=!!Q,this.ha=ge,this.key=++me,this.da=this.fa=!1}function xe(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function ke(h){this.src=h,this.g={},this.h=0}ke.prototype.add=function(h,b,R,Q,ge){var _e=h.toString();h=this.g[_e],h||(h=this.g[_e]=[],this.h++);var Fe=Ue(h,b,Q,ge);return-1<Fe?(b=h[Fe],R||(b.fa=!1)):(b=new ye(b,this.src,_e,!!Q,ge),b.fa=R,h.push(b)),b};function Ve(h,b){var R=b.type;if(R in h.g){var Q=h.g[R],ge=Array.prototype.indexOf.call(Q,b,void 0),_e;(_e=0<=ge)&&Array.prototype.splice.call(Q,ge,1),_e&&(xe(b),h.g[R].length==0&&(delete h.g[R],h.h--))}}function Ue(h,b,R,Q){for(var ge=0;ge<h.length;++ge){var _e=h[ge];if(!_e.da&&_e.listener==b&&_e.capture==!!R&&_e.ha==Q)return ge}return-1}var Ne="closure_lm_"+(1e6*Math.random()|0),se={};function yt(h,b,R,Q,ge){if(Array.isArray(b)){for(var _e=0;_e<b.length;_e++)yt(h,b[_e],R,Q,ge);return null}return R=Nt(R),h&&h[le]?h.K(b,R,u(Q)?!!Q.capture:!1,ge):Ye(h,b,R,!1,Q,ge)}function Ye(h,b,R,Q,ge,_e){if(!b)throw Error("Invalid event type");var Fe=u(ge)?!!ge.capture:!!ge,qt=nt(h);if(qt||(h[Ne]=qt=new ke(h)),R=qt.add(b,R,Q,Fe,_e),R.proxy)return R;if(Q=ot(),R.proxy=Q,Q.src=h,Q.listener=R,h.addEventListener)O||(ge=Fe),ge===void 0&&(ge=!1),h.addEventListener(b.toString(),Q,ge);else if(h.attachEvent)h.attachEvent(Ce(b.toString()),Q);else if(h.addListener&&h.removeListener)h.addListener(Q);else throw Error("addEventListener and attachEvent are unavailable.");return R}function ot(){function h(R){return b.call(h.src,h.listener,R)}const b=Et;return h}function De(h,b,R,Q,ge){if(Array.isArray(b))for(var _e=0;_e<b.length;_e++)De(h,b[_e],R,Q,ge);else Q=u(Q)?!!Q.capture:!!Q,R=Nt(R),h&&h[le]?(h=h.i,b=String(b).toString(),b in h.g&&(_e=h.g[b],R=Ue(_e,R,Q,ge),-1<R&&(xe(_e[R]),Array.prototype.splice.call(_e,R,1),_e.length==0&&(delete h.g[b],h.h--)))):h&&(h=nt(h))&&(b=h.g[b.toString()],h=-1,b&&(h=Ue(b,R,Q,ge)),(R=-1<h?b[h]:null)&&je(R))}function je(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[le])Ve(b.i,h);else{var R=h.type,Q=h.proxy;b.removeEventListener?b.removeEventListener(R,Q,h.capture):b.detachEvent?b.detachEvent(Ce(R),Q):b.addListener&&b.removeListener&&b.removeListener(Q),(R=nt(b))?(Ve(R,h),R.h==0&&(R.src=null,b[Ne]=null)):xe(h)}}}function Ce(h){return h in se?se[h]:se[h]="on"+h}function Et(h,b){if(h.da)h=!0;else{b=new X(b,this);var R=h.listener,Q=h.ha||h.src;h.fa&&je(h),h=R.call(Q,b)}return h}function nt(h){return h=h[Ne],h instanceof ke?h:null}var Bt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Nt(h){return typeof h=="function"?h:(h[Bt]||(h[Bt]=function(b){return h.handleEvent(b)}),h[Bt])}function tt(){_.call(this),this.i=new ke(this),this.M=this,this.F=null}T(tt,_),tt.prototype[le]=!0,tt.prototype.removeEventListener=function(h,b,R,Q){De(this,h,b,R,Q)};function Tt(h,b){var R,Q=h.F;if(Q)for(R=[];Q;Q=Q.F)R.push(Q);if(h=h.M,Q=b.type||b,typeof b=="string")b=new z(b,h);else if(b instanceof z)b.target=b.target||h;else{var ge=b;b=new z(Q,h),S(b,ge)}if(ge=!0,R)for(var _e=R.length-1;0<=_e;_e--){var Fe=b.g=R[_e];ge=xt(Fe,Q,!0,b)&&ge}if(Fe=b.g=h,ge=xt(Fe,Q,!0,b)&&ge,ge=xt(Fe,Q,!1,b)&&ge,R)for(_e=0;_e<R.length;_e++)Fe=b.g=R[_e],ge=xt(Fe,Q,!1,b)&&ge}tt.prototype.N=function(){if(tt.aa.N.call(this),this.i){var h=this.i,b;for(b in h.g){for(var R=h.g[b],Q=0;Q<R.length;Q++)xe(R[Q]);delete h.g[b],h.h--}}this.F=null},tt.prototype.K=function(h,b,R,Q){return this.i.add(String(h),b,!1,R,Q)},tt.prototype.L=function(h,b,R,Q){return this.i.add(String(h),b,!0,R,Q)};function xt(h,b,R,Q){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();for(var ge=!0,_e=0;_e<b.length;++_e){var Fe=b[_e];if(Fe&&!Fe.da&&Fe.capture==R){var qt=Fe.listener,Vn=Fe.ha||Fe.src;Fe.fa&&Ve(h.i,Fe),ge=qt.call(Vn,Q)!==!1&&ge}}return ge&&!Q.defaultPrevented}function rt(h,b,R){if(typeof h=="function")R&&(h=y(h,R));else if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:l.setTimeout(h,b||0)}function ft(h){h.g=rt(()=>{h.g=null,h.i&&(h.i=!1,ft(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class at extends _{constructor(b,R){super(),this.m=b,this.l=R,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:ft(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Jt(h){_.call(this),this.h=h,this.g={}}T(Jt,_);var Wt=[];function Je(h){ae(h.g,function(b,R){this.g.hasOwnProperty(R)&&je(b)},h),h.g={}}Jt.prototype.N=function(){Jt.aa.N.call(this),Je(this)},Jt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var bt=l.JSON.stringify,sn=l.JSON.parse,dt=class{stringify(h){return l.JSON.stringify(h,void 0)}parse(h){return l.JSON.parse(h,void 0)}};function Rt(){}Rt.prototype.h=null;function At(h){return h.h||(h.h=h.i())}function In(){}var _n={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function en(){z.call(this,"d")}T(en,z);function pt(){z.call(this,"c")}T(pt,z);var Ot={},Us=null;function Qn(){return Us=Us||new tt}Ot.La="serverreachability";function Zi(h){z.call(this,Ot.La,h)}T(Zi,z);function Br(h){const b=Qn();Tt(b,new Zi(b))}Ot.STAT_EVENT="statevent";function ut(h,b){z.call(this,Ot.STAT_EVENT,h),this.stat=b}T(ut,z);function Nn(h){const b=Qn();Tt(b,new ut(b,h))}Ot.Ma="timingevent";function es(h,b){z.call(this,Ot.Ma,h),this.size=b}T(es,z);function br(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){h()},b)}function wr(){this.g=!0}wr.prototype.xa=function(){this.g=!1};function jn(h,b,R,Q,ge,_e){h.info(function(){if(h.g)if(_e)for(var Fe="",qt=_e.split("&"),Vn=0;Vn<qt.length;Vn++){var Mt=qt[Vn].split("=");if(1<Mt.length){var Dt=Mt[0];Mt=Mt[1];var xn=Dt.split("_");Fe=2<=xn.length&&xn[1]=="type"?Fe+(Dt+"="+Mt+"&"):Fe+(Dt+"=redacted&")}}else Fe=null;else Fe=_e;return"XMLHTTP REQ ("+Q+") [attempt "+ge+"]: "+b+`
`+R+`
`+Fe})}function lr(h,b,R,Q,ge,_e,Fe){h.info(function(){return"XMLHTTP RESP ("+Q+") [ attempt "+ge+"]: "+b+`
`+R+`
`+_e+" "+Fe})}function Pn(h,b,R,Q){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+Bs(h,R)+(Q?" "+Q:"")})}function Na(h,b){h.info(function(){return"TIMEOUT: "+b})}wr.prototype.info=function(){};function Bs(h,b){if(!h.g)return b;if(!b)return null;try{var R=JSON.parse(b);if(R){for(h=0;h<R.length;h++)if(Array.isArray(R[h])){var Q=R[h];if(!(2>Q.length)){var ge=Q[1];if(Array.isArray(ge)&&!(1>ge.length)){var _e=ge[0];if(_e!="noop"&&_e!="stop"&&_e!="close")for(var Fe=1;Fe<ge.length;Fe++)ge[Fe]=""}}}}return bt(R)}catch{return b}}var qr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ki={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},si;function zr(){}T(zr,Rt),zr.prototype.g=function(){return new XMLHttpRequest},zr.prototype.i=function(){return{}},si=new zr;function Xn(h,b,R,Q){this.j=h,this.i=b,this.l=R,this.R=Q||1,this.U=new Jt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new qs}function qs(){this.i=null,this.g="",this.h=!1}var Ii={},vs={};function zs(h,b,R){h.L=1,h.v=Ta(ai(b)),h.m=R,h.P=!0,Aa(h,null)}function Aa(h,b){h.F=Date.now(),$s(h),h.A=ai(h.v);var R=h.A,Q=h.R;Array.isArray(Q)||(Q=[String(Q)]),gt(R.i,"t",Q),h.C=0,R=h.j.J,h.h=new qs,h.g=$n(h.j,R?b:null,!h.m),0<h.O&&(h.M=new at(y(h.Y,h,h.g),h.O)),b=h.U,R=h.g,Q=h.ca;var ge="readystatechange";Array.isArray(ge)||(ge&&(Wt[0]=ge.toString()),ge=Wt);for(var _e=0;_e<ge.length;_e++){var Fe=yt(R,ge[_e],Q||b.handleEvent,!1,b.h||b);if(!Fe)break;b.g[Fe.key]=Fe}b=h.H?I(h.H):{},h.m?(h.u||(h.u="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,b)):(h.u="GET",h.g.ea(h.A,h.u,null,b)),Br(),jn(h.i,h.u,h.A,h.l,h.R,h.m)}Xn.prototype.ca=function(h){h=h.target;const b=this.M;b&&yi(h)==3?b.j():this.Y(h)},Xn.prototype.Y=function(h){try{if(h==this.g)e:{const xn=yi(this.g);var b=this.g.Ba();const Ri=this.g.Z();if(!(3>xn)&&(xn!=3||this.g&&(this.h.h||this.g.oa()||Il(this.g)))){this.J||xn!=4||b==7||(b==8||0>=Ri?Br(3):Br(2)),uo(this);var R=this.g.Z();this.X=R;t:if(Sa(this)){var Q=Il(this.g);h="";var ge=Q.length,_e=yi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ji(this),_r(this);var Fe="";break t}this.h.i=new l.TextDecoder}for(b=0;b<ge;b++)this.h.h=!0,h+=this.h.i.decode(Q[b],{stream:!(_e&&b==ge-1)});Q.length=0,this.h.g+=h,this.C=0,Fe=this.h.g}else Fe=this.g.oa();if(this.o=R==200,lr(this.i,this.u,this.A,this.l,this.R,xn,R),this.o){if(this.T&&!this.K){t:{if(this.g){var qt,Vn=this.g;if((qt=Vn.g?Vn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(qt)){var Mt=qt;break t}}Mt=null}if(R=Mt)Pn(this.i,this.l,R,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ho(this,R);else{this.o=!1,this.s=3,Nn(12),ji(this),_r(this);break e}}if(this.P){R=!0;let $r;for(;!this.J&&this.C<Fe.length;)if($r=Ou(this,Fe),$r==vs){xn==4&&(this.s=4,Nn(14),R=!1),Pn(this.i,this.l,null,"[Incomplete Response]");break}else if($r==Ii){this.s=4,Nn(15),Pn(this.i,this.l,Fe,"[Invalid Chunk]"),R=!1;break}else Pn(this.i,this.l,$r,null),ho(this,$r);if(Sa(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xn!=4||Fe.length!=0||this.h.h||(this.s=1,Nn(16),R=!1),this.o=this.o&&R,!R)Pn(this.i,this.l,Fe,"[Invalid Chunked Response]"),ji(this),_r(this);else if(0<Fe.length&&!this.W){this.W=!0;var Dt=this.j;Dt.g==this&&Dt.ba&&!Dt.M&&(Dt.j.info("Great, no buffering proxy detected. Bytes received: "+Fe.length),He(Dt),Dt.M=!0,Nn(11))}}else Pn(this.i,this.l,Fe,null),ho(this,Fe);xn==4&&ji(this),this.o&&!this.J&&(xn==4?wt(this.j,this):(this.o=!1,$s(this)))}else ws(this.g),R==400&&0<Fe.indexOf("Unknown SID")?(this.s=3,Nn(12)):(this.s=0,Nn(13)),ji(this),_r(this)}}}catch{}finally{}};function Sa(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Ou(h,b){var R=h.C,Q=b.indexOf(`
`,R);return Q==-1?vs:(R=Number(b.substring(R,Q)),isNaN(R)?Ii:(Q+=1,Q+R>b.length?vs:(b=b.slice(Q,Q+R),h.C=Q+R,b)))}Xn.prototype.cancel=function(){this.J=!0,ji(this)};function $s(h){h.S=Date.now()+h.I,xl(h,h.I)}function xl(h,b){if(h.B!=null)throw Error("WatchDog timer not null");h.B=br(y(h.ba,h),b)}function uo(h){h.B&&(l.clearTimeout(h.B),h.B=null)}Xn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(Na(this.i,this.A),this.L!=2&&(Br(),Nn(17)),ji(this),this.s=2,_r(this)):xl(this,this.S-h)};function _r(h){h.j.G==0||h.J||wt(h.j,h)}function ji(h){uo(h);var b=h.M;b&&typeof b.ma=="function"&&b.ma(),h.M=null,Je(h.U),h.g&&(b=h.g,h.g=null,b.abort(),b.ma())}function ho(h,b){try{var R=h.j;if(R.G!=0&&(R.g==h||Hs(R.h,h))){if(!h.K&&Hs(R.h,h)&&R.G==3){try{var Q=R.Da.g.parse(b)}catch{Q=null}if(Array.isArray(Q)&&Q.length==3){var ge=Q;if(ge[0]==0){e:if(!R.u){if(R.g)if(R.g.F+3e3<h.F)ht(R),rs(R);else break e;Pe(R),Nn(18)}}else R.za=ge[1],0<R.za-R.T&&37500>ge[2]&&R.F&&R.v==0&&!R.C&&(R.C=br(y(R.Za,R),6e3));if(1>=Nl(R.h)&&R.ca){try{R.ca()}catch{}R.ca=void 0}}else tn(R,11)}else if((h.K||R.g==h)&&ht(R),!L(b))for(ge=R.Da.g.parse(b),b=0;b<ge.length;b++){let Mt=ge[b];if(R.T=Mt[0],Mt=Mt[1],R.G==2)if(Mt[0]=="c"){R.K=Mt[1],R.ia=Mt[2];const Dt=Mt[3];Dt!=null&&(R.la=Dt,R.j.info("VER="+R.la));const xn=Mt[4];xn!=null&&(R.Aa=xn,R.j.info("SVER="+R.Aa));const Ri=Mt[5];Ri!=null&&typeof Ri=="number"&&0<Ri&&(Q=1.5*Ri,R.L=Q,R.j.info("backChannelRequestTimeoutMs_="+Q)),Q=R;const $r=h.g;if($r){const kr=$r.g?$r.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(kr){var _e=Q.h;_e.g||kr.indexOf("spdy")==-1&&kr.indexOf("quic")==-1&&kr.indexOf("h2")==-1||(_e.j=_e.l,_e.g=new Set,_e.h&&(Al(_e,_e.h),_e.h=null))}if(Q.D){const _s=$r.g?$r.g.getResponseHeader("X-HTTP-Session-Id"):null;_s&&(Q.ya=_s,Vt(Q.I,Q.D,_s))}}R.G=3,R.l&&R.l.ua(),R.ba&&(R.R=Date.now()-h.F,R.j.info("Handshake RTT: "+R.R+"ms")),Q=R;var Fe=h;if(Q.qa=on(Q,Q.J?Q.ia:null,Q.W),Fe.K){On(Q.h,Fe);var qt=Fe,Vn=Q.L;Vn&&(qt.I=Vn),qt.B&&(uo(qt),$s(qt)),Q.g=Fe}else Se(Q);0<R.i.length&&v(R)}else Mt[0]!="stop"&&Mt[0]!="close"||tn(R,7);else R.G==3&&(Mt[0]=="stop"||Mt[0]=="close"?Mt[0]=="stop"?tn(R,7):xo(R):Mt[0]!="noop"&&R.l&&R.l.ta(Mt),R.v=0)}}Br(4)}catch{}}var bl=class{constructor(h,b){this.g=h,this.map=b}};function wl(h){this.l=h||10,l.PerformanceNavigationTiming?(h=l.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function _l(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Nl(h){return h.h?1:h.g?h.g.size:0}function Hs(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function Al(h,b){h.g?h.g.add(b):h.h=b}function On(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}wl.prototype.cancel=function(){if(this.i=Sl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Sl(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const R of h.g.values())b=b.concat(R.D);return b}return E(h.i)}function bc(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(c(h)){for(var b=[],R=h.length,Q=0;Q<R;Q++)b.push(h[Q]);return b}b=[],R=0;for(Q in h)b[R++]=h[Q];return b}function ys(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(c(h)||typeof h=="string"){var b=[];h=h.length;for(var R=0;R<h;R++)b.push(R);return b}b=[],R=0;for(const Q in h)b[R++]=Q;return b}}}function Ws(h,b){if(h.forEach&&typeof h.forEach=="function")h.forEach(b,void 0);else if(c(h)||typeof h=="string")Array.prototype.forEach.call(h,b,void 0);else for(var R=ys(h),Q=bc(h),ge=Q.length,_e=0;_e<ge;_e++)b.call(void 0,Q[_e],R&&R[_e],h)}var mi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ea(h,b){if(h){h=h.split("&");for(var R=0;R<h.length;R++){var Q=h[R].indexOf("="),ge=null;if(0<=Q){var _e=h[R].substring(0,Q);ge=h[R].substring(Q+1)}else _e=h[R];b(_e,ge?decodeURIComponent(ge.replace(/\+/g," ")):"")}}}function an(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof an){this.h=h.h,fo(this,h.j),this.o=h.o,this.g=h.g,po(this,h.s),this.l=h.l;var b=h.i,R=new vi;R.i=b.i,b.g&&(R.g=new Map(b.g),R.h=b.h),wc(this,R),this.m=h.m}else h&&(b=String(h).match(mi))?(this.h=!1,fo(this,b[1]||"",!0),this.o=Gs(b[2]||""),this.g=Gs(b[3]||"",!0),po(this,b[4]),this.l=Gs(b[5]||"",!0),wc(this,b[6]||"",!0),this.m=Gs(b[7]||"")):(this.h=!1,this.i=new vi(null,this.h))}an.prototype.toString=function(){var h=[],b=this.j;b&&h.push(gi(b,_c,!0),":");var R=this.g;return(R||b=="file")&&(h.push("//"),(b=this.o)&&h.push(gi(b,_c,!0),"@"),h.push(encodeURIComponent(String(R)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),R=this.s,R!=null&&h.push(":",String(R))),(R=this.l)&&(this.g&&R.charAt(0)!="/"&&h.push("/"),h.push(gi(R,R.charAt(0)=="/"?Fu:Mu,!0))),(R=this.i.toString())&&h.push("?",R),(R=this.m)&&h.push("#",gi(R,Ca)),h.join("")};function ai(h){return new an(h)}function fo(h,b,R){h.j=R?Gs(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function po(h,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);h.s=b}else h.s=null}function wc(h,b,R){b instanceof vi?(h.i=b,Vu(h.i,h.h)):(R||(b=gi(b,Tl)),h.i=new vi(b,h.h))}function Vt(h,b,R){h.i.set(b,R)}function Ta(h){return Vt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Gs(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function gi(h,b,R){return typeof h=="string"?(h=encodeURI(h).replace(b,El),R&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function El(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var _c=/[#\/\?@]/g,Mu=/[#\?:]/g,Fu=/[#\?]/g,Tl=/[#\?@]/g,Ca=/#/g;function vi(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function ts(h){h.g||(h.g=new Map,h.h=0,h.i&&Ea(h.i,function(b,R){h.add(decodeURIComponent(b.replace(/\+/g," ")),R)}))}t=vi.prototype,t.add=function(h,b){ts(this),this.i=null,h=Ys(this,h);var R=this.g.get(h);return R||this.g.set(h,R=[]),R.push(b),this.h+=1,this};function Ks(h,b){ts(h),b=Ys(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function mo(h,b){return ts(h),b=Ys(h,b),h.g.has(b)}t.forEach=function(h,b){ts(this),this.g.forEach(function(R,Q){R.forEach(function(ge){h.call(b,ge,Q,this)},this)},this)},t.na=function(){ts(this);const h=Array.from(this.g.values()),b=Array.from(this.g.keys()),R=[];for(let Q=0;Q<b.length;Q++){const ge=h[Q];for(let _e=0;_e<ge.length;_e++)R.push(b[Q])}return R},t.V=function(h){ts(this);let b=[];if(typeof h=="string")mo(this,h)&&(b=b.concat(this.g.get(Ys(this,h))));else{h=Array.from(this.g.values());for(let R=0;R<h.length;R++)b=b.concat(h[R])}return b},t.set=function(h,b){return ts(this),this.i=null,h=Ys(this,h),mo(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},t.get=function(h,b){return h?(h=this.V(h),0<h.length?String(h[0]):b):b};function gt(h,b,R){Ks(h,b),0<R.length&&(h.i=null,h.g.set(Ys(h,b),E(R)),h.h+=R.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(var R=0;R<b.length;R++){var Q=b[R];const _e=encodeURIComponent(String(Q)),Fe=this.V(Q);for(Q=0;Q<Fe.length;Q++){var ge=_e;Fe[Q]!==""&&(ge+="="+encodeURIComponent(String(Fe[Q]))),h.push(ge)}}return this.i=h.join("&")};function Ys(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function Vu(h,b){b&&!h.j&&(ts(h),h.i=null,h.g.forEach(function(R,Q){var ge=Q.toLowerCase();Q!=ge&&(Ks(this,Q),gt(this,ge,R))},h)),h.j=b}function Uu(h,b){const R=new wr;if(l.Image){const Q=new Image;Q.onload=p(Nr,R,"TestLoadImage: loaded",!0,b,Q),Q.onerror=p(Nr,R,"TestLoadImage: error",!1,b,Q),Q.onabort=p(Nr,R,"TestLoadImage: abort",!1,b,Q),Q.ontimeout=p(Nr,R,"TestLoadImage: timeout",!1,b,Q),l.setTimeout(function(){Q.ontimeout&&Q.ontimeout()},1e4),Q.src=h}else b(!1)}function Bu(h,b){const R=new wr,Q=new AbortController,ge=setTimeout(()=>{Q.abort(),Nr(R,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:Q.signal}).then(_e=>{clearTimeout(ge),_e.ok?Nr(R,"TestPingServer: ok",!0,b):Nr(R,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(ge),Nr(R,"TestPingServer: error",!1,b)})}function Nr(h,b,R,Q,ge){try{ge&&(ge.onload=null,ge.onerror=null,ge.onabort=null,ge.ontimeout=null),Q(R)}catch{}}function xs(){this.g=new dt}function qu(h,b,R){const Q=R||"";try{Ws(h,function(ge,_e){let Fe=ge;u(ge)&&(Fe=bt(ge)),b.push(Q+_e+"="+encodeURIComponent(Fe))})}catch(ge){throw b.push(Q+"type="+encodeURIComponent("_badmap")),ge}}function go(h){this.l=h.Ub||null,this.j=h.eb||!1}T(go,Rt),go.prototype.g=function(){return new bs(this.l,this.j)},go.prototype.i=function(h){return function(){return h}}({});function bs(h,b){tt.call(this),this.D=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(bs,tt),t=bs.prototype,t.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=b,this.readyState=1,ns(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const b={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(b.body=h),(this.D||l).fetch(new Request(this.A,b)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Pi(this)),this.readyState=0},t.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,ns(this)),this.g&&(this.readyState=3,ns(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;vo(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function vo(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}t.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.v.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?Pi(this):ns(this),this.readyState==3&&vo(this)}},t.Ra=function(h){this.g&&(this.response=this.responseText=h,Pi(this))},t.Qa=function(h){this.g&&(this.response=h,Pi(this))},t.ga=function(){this.g&&Pi(this)};function Pi(h){h.readyState=4,h.l=null,h.j=null,h.v=null,ns(h)}t.setRequestHeader=function(h,b){this.u.append(h,b)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var R=b.next();!R.done;)R=R.value,h.push(R[0]+": "+R[1]),R=b.next();return h.join(`\r
`)};function ns(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(bs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function ka(h){let b="";return ae(h,function(R,Q){b+=Q,b+=":",b+=R,b+=`\r
`}),b}function Cl(h,b,R){e:{for(Q in R){var Q=!1;break e}Q=!0}Q||(R=ka(R),typeof h=="string"?R!=null&&encodeURIComponent(String(R)):Vt(h,b,R))}function pn(h){tt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(pn,tt);var kl=/^https?$/i,Ia=["POST","PUT"];t=pn.prototype,t.Ha=function(h){this.J=h},t.ea=function(h,b,R,Q){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():si.g(),this.v=this.o?At(this.o):At(si),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(_e){Qs(this,_e);return}if(h=R||"",R=new Map(this.headers),Q)if(Object.getPrototypeOf(Q)===Object.prototype)for(var ge in Q)R.set(ge,Q[ge]);else if(typeof Q.keys=="function"&&typeof Q.get=="function")for(const _e of Q.keys())R.set(_e,Q.get(_e));else throw Error("Unknown input type for opt_headers: "+String(Q));Q=Array.from(R.keys()).find(_e=>_e.toLowerCase()=="content-type"),ge=l.FormData&&h instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Ia,b,void 0))||Q||ge||R.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[_e,Fe]of R)this.g.setRequestHeader(_e,Fe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Js(this),this.u=!0,this.g.send(h),this.u=!1}catch(_e){Qs(this,_e)}};function Qs(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.m=5,yo(h),Xs(h)}function yo(h){h.A||(h.A=!0,Tt(h,"complete"),Tt(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Tt(this,"complete"),Tt(this,"abort"),Xs(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xs(this,!0)),pn.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?ja(this):this.bb())},t.bb=function(){ja(this)};function ja(h){if(h.h&&typeof a<"u"&&(!h.v[1]||yi(h)!=4||h.Z()!=2)){if(h.u&&yi(h)==4)rt(h.Ea,0,h);else if(Tt(h,"readystatechange"),yi(h)==4){h.h=!1;try{const Fe=h.Z();e:switch(Fe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var R;if(!(R=b)){var Q;if(Q=Fe===0){var ge=String(h.D).match(mi)[1]||null;!ge&&l.self&&l.self.location&&(ge=l.self.location.protocol.slice(0,-1)),Q=!kl.test(ge?ge.toLowerCase():"")}R=Q}if(R)Tt(h,"complete"),Tt(h,"success");else{h.m=6;try{var _e=2<yi(h)?h.g.statusText:""}catch{_e=""}h.l=_e+" ["+h.Z()+"]",yo(h)}}finally{Xs(h)}}}}function Xs(h,b){if(h.g){Js(h);const R=h.g,Q=h.v[0]?()=>{}:null;h.g=null,h.v=null,b||Tt(h,"ready");try{R.onreadystatechange=Q}catch{}}}function Js(h){h.I&&(l.clearTimeout(h.I),h.I=null)}t.isActive=function(){return!!this.g};function yi(h){return h.g?h.g.readyState:0}t.Z=function(){try{return 2<yi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),sn(b)}};function Il(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function ws(h){const b={};h=(h.g&&2<=yi(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let Q=0;Q<h.length;Q++){if(L(h[Q]))continue;var R=N(h[Q]);const ge=R[0];if(R=R[1],typeof R!="string")continue;R=R.trim();const _e=b[ge]||[];b[ge]=_e,_e.push(R)}B(b,function(Q){return Q.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function oi(h,b,R){return R&&R.internalChannelParams&&R.internalChannelParams[h]||b}function jl(h){this.Aa=0,this.i=[],this.j=new wr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=oi("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=oi("baseRetryDelayMs",5e3,h),this.cb=oi("retryDelaySeedMs",1e4,h),this.Wa=oi("forwardChannelMaxRetries",2,h),this.wa=oi("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new wl(h&&h.concurrentRequestLimit),this.Da=new xs,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=jl.prototype,t.la=8,t.G=1,t.connect=function(h,b,R,Q){Nn(0),this.W=h,this.H=b||{},R&&Q!==void 0&&(this.H.OSID=R,this.H.OAID=Q),this.F=this.X,this.I=on(this,null,this.W),v(this)};function xo(h){if(Pl(h),h.G==3){var b=h.U++,R=ai(h.I);if(Vt(R,"SID",h.K),Vt(R,"RID",b),Vt(R,"TYPE","terminate"),oe(h,R),b=new Xn(h,h.j,b),b.L=2,b.v=Ta(ai(R)),R=!1,l.navigator&&l.navigator.sendBeacon)try{R=l.navigator.sendBeacon(b.v.toString(),"")}catch{}!R&&l.Image&&(new Image().src=b.v,R=!0),R||(b.g=$n(b.j,null),b.g.ea(b.v)),b.F=Date.now(),$s(b)}Mn(h)}function rs(h){h.g&&(He(h),h.g.cancel(),h.g=null)}function Pl(h){rs(h),h.u&&(l.clearTimeout(h.u),h.u=null),ht(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&l.clearTimeout(h.s),h.s=null)}function v(h){if(!_l(h.h)&&!h.s){h.s=!0;var b=h.Ga;K||ue(),q||(K(),q=!0),ee.add(b,h),h.B=0}}function V(h,b){return Nl(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=b.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=br(y(h.Ga,h,b),Gt(h,h.B)),h.B++,!0)}t.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const ge=new Xn(this,this.j,h);let _e=this.o;if(this.S&&(_e?(_e=I(_e),S(_e,this.S)):_e=this.S),this.m!==null||this.O||(ge.H=_e,_e=null),this.P)e:{for(var b=0,R=0;R<this.i.length;R++){t:{var Q=this.i[R];if("__data__"in Q.map&&(Q=Q.map.__data__,typeof Q=="string")){Q=Q.length;break t}Q=void 0}if(Q===void 0)break;if(b+=Q,4096<b){b=R;break e}if(b===4096||R===this.i.length-1){b=R+1;break e}}b=1e3}else b=1e3;b=pe(this,ge,b),R=ai(this.I),Vt(R,"RID",h),Vt(R,"CVER",22),this.D&&Vt(R,"X-HTTP-Session-Id",this.D),oe(this,R),_e&&(this.O?b="headers="+encodeURIComponent(String(ka(_e)))+"&"+b:this.m&&Cl(R,this.m,_e)),Al(this.h,ge),this.Ua&&Vt(R,"TYPE","init"),this.P?(Vt(R,"$req",b),Vt(R,"SID","null"),ge.T=!0,zs(ge,R,null)):zs(ge,R,b),this.G=2}}else this.G==3&&(h?ne(this,h):this.i.length==0||_l(this.h)||ne(this))};function ne(h,b){var R;b?R=b.l:R=h.U++;const Q=ai(h.I);Vt(Q,"SID",h.K),Vt(Q,"RID",R),Vt(Q,"AID",h.T),oe(h,Q),h.m&&h.o&&Cl(Q,h.m,h.o),R=new Xn(h,h.j,R,h.B+1),h.m===null&&(R.H=h.o),b&&(h.i=b.D.concat(h.i)),b=pe(h,R,1e3),R.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Al(h.h,R),zs(R,Q,b)}function oe(h,b){h.H&&ae(h.H,function(R,Q){Vt(b,Q,R)}),h.l&&Ws({},function(R,Q){Vt(b,Q,R)})}function pe(h,b,R){R=Math.min(h.i.length,R);var Q=h.l?y(h.l.Na,h.l,h):null;e:{var ge=h.i;let _e=-1;for(;;){const Fe=["count="+R];_e==-1?0<R?(_e=ge[0].g,Fe.push("ofs="+_e)):_e=0:Fe.push("ofs="+_e);let qt=!0;for(let Vn=0;Vn<R;Vn++){let Mt=ge[Vn].g;const Dt=ge[Vn].map;if(Mt-=_e,0>Mt)_e=Math.max(0,ge[Vn].g-100),qt=!1;else try{qu(Dt,Fe,"req"+Mt+"_")}catch{Q&&Q(Dt)}}if(qt){Q=Fe.join("&");break e}}}return h=h.i.splice(0,R),b.D=h,Q}function Se(h){if(!h.g&&!h.u){h.Y=1;var b=h.Fa;K||ue(),q||(K(),q=!0),ee.add(b,h),h.v=0}}function Pe(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=br(y(h.Fa,h),Gt(h,h.v)),h.v++,!0)}t.Fa=function(){if(this.u=null,Qe(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=br(y(this.ab,this),h)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Nn(10),rs(this),Qe(this))};function He(h){h.A!=null&&(l.clearTimeout(h.A),h.A=null)}function Qe(h){h.g=new Xn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var b=ai(h.qa);Vt(b,"RID","rpc"),Vt(b,"SID",h.K),Vt(b,"AID",h.T),Vt(b,"CI",h.F?"0":"1"),!h.F&&h.ja&&Vt(b,"TO",h.ja),Vt(b,"TYPE","xmlhttp"),oe(h,b),h.m&&h.o&&Cl(b,h.m,h.o),h.L&&(h.g.I=h.L);var R=h.g;h=h.ia,R.L=1,R.v=Ta(ai(b)),R.m=null,R.P=!0,Aa(R,h)}t.Za=function(){this.C!=null&&(this.C=null,rs(this),Pe(this),Nn(19))};function ht(h){h.C!=null&&(l.clearTimeout(h.C),h.C=null)}function wt(h,b){var R=null;if(h.g==b){ht(h),He(h),h.g=null;var Q=2}else if(Hs(h.h,b))R=b.D,On(h.h,b),Q=1;else return;if(h.G!=0){if(b.o)if(Q==1){R=b.m?b.m.length:0,b=Date.now()-b.F;var ge=h.B;Q=Qn(),Tt(Q,new es(Q,R)),v(h)}else Se(h);else if(ge=b.s,ge==3||ge==0&&0<b.X||!(Q==1&&V(h,b)||Q==2&&Pe(h)))switch(R&&0<R.length&&(b=h.h,b.i=b.i.concat(R)),ge){case 1:tn(h,5);break;case 4:tn(h,10);break;case 3:tn(h,6);break;default:tn(h,2)}}}function Gt(h,b){let R=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(R*=2),R*b}function tn(h,b){if(h.j.info("Error code "+b),b==2){var R=y(h.fb,h),Q=h.Xa;const ge=!Q;Q=new an(Q||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||fo(Q,"https"),Ta(Q),ge?Uu(Q.toString(),R):Bu(Q.toString(),R)}else Nn(2);h.G=0,h.l&&h.l.sa(b),Mn(h),Pl(h)}t.fb=function(h){h?(this.j.info("Successfully pinged google.com"),Nn(2)):(this.j.info("Failed to ping google.com"),Nn(1))};function Mn(h){if(h.G=0,h.ka=[],h.l){const b=Sl(h.h);(b.length!=0||h.i.length!=0)&&(P(h.ka,b),P(h.ka,h.i),h.h.i.length=0,E(h.i),h.i.length=0),h.l.ra()}}function on(h,b,R){var Q=R instanceof an?ai(R):new an(R);if(Q.g!="")b&&(Q.g=b+"."+Q.g),po(Q,Q.s);else{var ge=l.location;Q=ge.protocol,b=b?b+"."+ge.hostname:ge.hostname,ge=+ge.port;var _e=new an(null);Q&&fo(_e,Q),b&&(_e.g=b),ge&&po(_e,ge),R&&(_e.l=R),Q=_e}return R=h.D,b=h.ya,R&&b&&Vt(Q,R,b),Vt(Q,"VER",h.la),oe(h,Q),Q}function $n(h,b,R){if(b&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Ca&&!h.pa?new pn(new go({eb:R})):new pn(h.pa),b.Ha(h.J),b}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Fn(){}t=Fn.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Hn(){}Hn.prototype.g=function(h,b){return new yn(h,b)};function yn(h,b){tt.call(this),this.g=new jl(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.va&&(h?h["X-WebChannel-Client-Profile"]=b.va:h={"X-WebChannel-Client-Profile":b.va}),this.g.S=h,(h=b&&b.Sb)&&!L(h)&&(this.g.m=h),this.v=b&&b.supportsCrossDomainXhr||!1,this.u=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!L(b)&&(this.g.D=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new Li(this)}T(yn,tt),yn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){xo(this.g)},yn.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var R={};R.__data__=h,h=R}else this.u&&(R={},R.__data__=bt(h),h=R);b.i.push(new bl(b.Ya++,h)),b.G==3&&v(b)},yn.prototype.N=function(){this.g.l=null,delete this.j,xo(this.g),delete this.g,yn.aa.N.call(this)};function Cr(h){en.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const R in b){h=R;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}T(Cr,en);function Ll(){pt.call(this),this.status=1}T(Ll,pt);function Li(h){this.g=h}T(Li,Fn),Li.prototype.ua=function(){Tt(this.g,"a")},Li.prototype.ta=function(h){Tt(this.g,new Cr(h))},Li.prototype.sa=function(h){Tt(this.g,new Ll)},Li.prototype.ra=function(){Tt(this.g,"b")},Hn.prototype.createWebChannel=Hn.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,j4=function(){return new Hn},I4=function(){return Qn()},k4=Ot,_1={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},qr.NO_ERROR=0,qr.TIMEOUT=8,qr.HTTP_ERROR=6,Xf=qr,ki.COMPLETE="complete",C4=ki,In.EventType=_n,_n.OPEN="a",_n.CLOSE="b",_n.ERROR="c",_n.MESSAGE="d",tt.prototype.listen=tt.prototype.K,bd=In,pn.prototype.listenOnce=pn.prototype.L,pn.prototype.getLastError=pn.prototype.Ka,pn.prototype.getLastErrorCode=pn.prototype.Ba,pn.prototype.getStatus=pn.prototype.Z,pn.prototype.getResponseJson=pn.prototype.Oa,pn.prototype.getResponseText=pn.prototype.oa,pn.prototype.send=pn.prototype.ea,pn.prototype.setWithCredentials=pn.prototype.Ha,T4=pn}).apply(typeof wf<"u"?wf:typeof self<"u"?self:typeof window<"u"?window:{});const fb="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Zr.UNAUTHENTICATED=new Zr(null),Zr.GOOGLE_CREDENTIALS=new Zr("google-credentials-uid"),Zr.FIRST_PARTY=new Zr("first-party-uid"),Zr.MOCK_USER=new Zr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Iu="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oc=new $v("@firebase/firestore");function dd(){return oc.logLevel}function Xe(t,...e){if(oc.logLevel<=$t.DEBUG){const n=e.map(t2);oc.debug(`Firestore (${Iu}): ${t}`,...n)}}function ro(t,...e){if(oc.logLevel<=$t.ERROR){const n=e.map(t2);oc.error(`Firestore (${Iu}): ${t}`,...n)}}function yu(t,...e){if(oc.logLevel<=$t.WARN){const n=e.map(t2);oc.warn(`Firestore (${Iu}): ${t}`,...n)}}function t2(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function St(t="Unexpected state"){const e=`FIRESTORE (${Iu}) INTERNAL ASSERTION FAILED: `+t;throw ro(e),new Error(e)}function fn(t,e){t||St()}function It(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $e extends xa{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P4{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class nj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Zr.UNAUTHENTICATED))}shutdown(){}}class rj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class ij{constructor(e){this.t=e,this.currentUser=Zr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){fn(this.o===void 0);let r=this.i;const i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let s=new Ya;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ya,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},l=c=>{Xe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Xe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ya)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Xe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(fn(typeof r.accessToken=="string"),new P4(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return fn(e===null||typeof e=="string"),new Zr(e)}}class sj{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Zr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class aj{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new sj(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Zr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class oj{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class lj{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){fn(this.o===void 0);const r=s=>{s.error!=null&&Xe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Xe("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Xe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Xe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(fn(typeof n.token=="string"),this.R=n.token,new oj(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cj(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=cj(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function Zt(t,e){return t<e?-1:t>e?1:0}function xu(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new $e(Ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new $e(Ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new $e(Ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $e(Ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return lt.fromMillis(Date.now())}static fromDate(e){return lt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new lt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Zt(this.nanoseconds,e.nanoseconds):Zt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new kt(e)}static min(){return new kt(new lt(0,0))}static max(){return new kt(new lt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e,n,r){n===void 0?n=0:n>e.length&&St(),r===void 0?r=e.length-n:r>e.length-n&&St(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return sh.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof sh?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),a=n.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class En extends sh{construct(e,n,r){return new En(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new $e(Ie.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new En(n)}static emptyPath(){return new En([])}}const uj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Dr extends sh{construct(e,n,r){return new Dr(e,n,r)}static isValidIdentifier(e){return uj.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Dr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Dr(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new $e(Ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new $e(Ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new $e(Ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else l==="`"?(a=!a,i++):l!=="."||a?(r+=l,i++):(s(),i++)}if(s(),a)throw new $e(Ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Dr(n)}static emptyPath(){return new Dr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e){this.path=e}static fromPath(e){return new ct(En.fromString(e))}static fromName(e){return new ct(En.fromString(e).popFirst(5))}static empty(){return new ct(En.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&En.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return En.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ct(new En(e.slice()))}}function dj(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=kt.fromTimestamp(r===1e9?new lt(n+1,0):new lt(n,r));return new ul(i,ct.empty(),e)}function hj(t){return new ul(t.readTime,t.key,-1)}class ul{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new ul(kt.min(),ct.empty(),-1)}static max(){return new ul(kt.max(),ct.empty(),-1)}}function fj(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ct.comparator(t.documentKey,e.documentKey),n!==0?n:Zt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class mj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Th(t){if(t.code!==Ie.FAILED_PRECONDITION||t.message!==pj)throw t;Xe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&St(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Re((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Re?n:Re.resolve(n)}catch(n){return Re.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Re.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Re.reject(n)}static resolve(e){return new Re((n,r)=>{n(e)})}static reject(e){return new Re((n,r)=>{r(e)})}static waitFor(e){return new Re((n,r)=>{let i=0,s=0,a=!1;e.forEach(l=>{++i,l.next(()=>{++s,a&&s===i&&n()},c=>r(c))}),a=!0,s===i&&n()})}static or(e){let n=Re.resolve(!1);for(const r of e)n=n.next(i=>i?Re.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new Re((r,i)=>{const s=e.length,a=new Array(s);let l=0;for(let c=0;c<s;c++){const u=c;n(e[u]).next(f=>{a[u]=f,++l,l===s&&r(a)},f=>i(f))}})}static doWhile(e,n){return new Re((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function gj(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ch(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}n2.oe=-1;function km(t){return t==null}function qp(t){return t===0&&1/t==-1/0}function vj(t){return typeof t=="number"&&Number.isInteger(t)&&!qp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pb(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function gc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function R4(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e,n){this.comparator=e,this.root=n||Rr.EMPTY}insert(e,n){return new zn(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Rr.BLACK,null,null))}remove(e){return new zn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new _f(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new _f(this.root,e,this.comparator,!1)}getReverseIterator(){return new _f(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new _f(this.root,e,this.comparator,!0)}}class _f{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Rr{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Rr.RED,this.left=i??Rr.EMPTY,this.right=s??Rr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Rr(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Rr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Rr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Rr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Rr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw St();const e=this.left.check();if(e!==this.right.check())throw St();return e+(this.isRed()?0:1)}}Rr.EMPTY=null,Rr.RED=!0,Rr.BLACK=!1;Rr.EMPTY=new class{constructor(){this.size=0}get key(){throw St()}get value(){throw St()}get color(){throw St()}get left(){throw St()}get right(){throw St()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Rr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e){this.comparator=e,this.data=new zn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new mb(this.data.getIterator())}getIteratorFrom(e){return new mb(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Fr)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Fr(this.comparator);return n.data=e,n}}class mb{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e){this.fields=e,e.sort(Dr.comparator)}static empty(){return new Wi([])}unionWith(e){let n=new Fr(Dr.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Wi(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return xu(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D4 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new D4("Invalid base64 string: "+s):s}}(e);return new Ur(n)}static fromUint8Array(e){const n=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Ur(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Zt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ur.EMPTY_BYTE_STRING=new Ur("");const yj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function dl(t){if(fn(!!t),typeof t=="string"){let e=0;const n=yj.exec(t);if(fn(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:nr(t.seconds),nanos:nr(t.nanos)}}function nr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function lc(t){return typeof t=="string"?Ur.fromBase64String(t):Ur.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r2(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function i2(t){const e=t.mapValue.fields.__previous_value__;return r2(e)?i2(e):e}function ah(t){const e=dl(t.mapValue.fields.__local_write_time__.timestampValue);return new lt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj{constructor(e,n,r,i,s,a,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class oh{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new oh("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof oh&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nf={mapValue:{}};function cc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?r2(t)?4:wj(t)?9007199254740991:bj(t)?10:11:St()}function ma(t,e){if(t===e)return!0;const n=cc(t);if(n!==cc(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ah(t).isEqual(ah(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=dl(i.timestampValue),l=dl(s.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return lc(i.bytesValue).isEqual(lc(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return nr(i.geoPointValue.latitude)===nr(s.geoPointValue.latitude)&&nr(i.geoPointValue.longitude)===nr(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return nr(i.integerValue)===nr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=nr(i.doubleValue),l=nr(s.doubleValue);return a===l?qp(a)===qp(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return xu(t.arrayValue.values||[],e.arrayValue.values||[],ma);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},l=s.mapValue.fields||{};if(pb(a)!==pb(l))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(l[c]===void 0||!ma(a[c],l[c])))return!1;return!0}(t,e);default:return St()}}function lh(t,e){return(t.values||[]).find(n=>ma(n,e))!==void 0}function bu(t,e){if(t===e)return 0;const n=cc(t),r=cc(e);if(n!==r)return Zt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Zt(t.booleanValue,e.booleanValue);case 2:return function(s,a){const l=nr(s.integerValue||s.doubleValue),c=nr(a.integerValue||a.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return gb(t.timestampValue,e.timestampValue);case 4:return gb(ah(t),ah(e));case 5:return Zt(t.stringValue,e.stringValue);case 6:return function(s,a){const l=lc(s),c=lc(a);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const l=s.split("/"),c=a.split("/");for(let u=0;u<l.length&&u<c.length;u++){const f=Zt(l[u],c[u]);if(f!==0)return f}return Zt(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const l=Zt(nr(s.latitude),nr(a.latitude));return l!==0?l:Zt(nr(s.longitude),nr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return vb(t.arrayValue,e.arrayValue);case 10:return function(s,a){var l,c,u,f;const g=s.fields||{},y=a.fields||{},p=(l=g.value)===null||l===void 0?void 0:l.arrayValue,T=(c=y.value)===null||c===void 0?void 0:c.arrayValue,E=Zt(((u=p==null?void 0:p.values)===null||u===void 0?void 0:u.length)||0,((f=T==null?void 0:T.values)===null||f===void 0?void 0:f.length)||0);return E!==0?E:vb(p,T)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===Nf.mapValue&&a===Nf.mapValue)return 0;if(s===Nf.mapValue)return 1;if(a===Nf.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),u=a.fields||{},f=Object.keys(u);c.sort(),f.sort();for(let g=0;g<c.length&&g<f.length;++g){const y=Zt(c[g],f[g]);if(y!==0)return y;const p=bu(l[c[g]],u[f[g]]);if(p!==0)return p}return Zt(c.length,f.length)}(t.mapValue,e.mapValue);default:throw St()}}function gb(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Zt(t,e);const n=dl(t),r=dl(e),i=Zt(n.seconds,r.seconds);return i!==0?i:Zt(n.nanos,r.nanos)}function vb(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=bu(n[i],r[i]);if(s)return s}return Zt(n.length,r.length)}function wu(t){return N1(t)}function N1(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=dl(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return lc(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ct.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=N1(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${N1(n.fields[a])}`;return i+"}"}(t.mapValue):St()}function yb(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function A1(t){return!!t&&"integerValue"in t}function s2(t){return!!t&&"arrayValue"in t}function xb(t){return!!t&&"nullValue"in t}function bb(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Jf(t){return!!t&&"mapValue"in t}function bj(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Rd(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return gc(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Rd(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Rd(t.arrayValue.values[n]);return e}return Object.assign({},t)}function wj(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e){this.value=e}static empty(){return new _i({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Jf(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Rd(n)}setAll(e){let n=Dr.emptyPath(),r={},i=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=l.popLast()}a?r[l.lastSegment()]=Rd(a):i.push(l.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Jf(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ma(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Jf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){gc(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new _i(Rd(this.value))}}function O4(t){const e=[];return gc(t.fields,(n,r)=>{const i=new Dr([n]);if(Jf(r)){const s=O4(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Wi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e,n,r,i,s,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=l}static newInvalidDocument(e){return new ti(e,0,kt.min(),kt.min(),kt.min(),_i.empty(),0)}static newFoundDocument(e,n,r,i){return new ti(e,1,n,kt.min(),r,i,0)}static newNoDocument(e,n){return new ti(e,2,n,kt.min(),kt.min(),_i.empty(),0)}static newUnknownDocument(e,n){return new ti(e,3,n,kt.min(),kt.min(),_i.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(kt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_i.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_i.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=kt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ti&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ti(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp{constructor(e,n){this.position=e,this.inclusive=n}}function wb(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?r=ct.comparator(ct.fromName(a.referenceValue),n.key):r=bu(a,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function _b(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ma(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(e,n="asc"){this.field=e,this.dir=n}}function _j(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{}class dr extends M4{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Aj(e,n,r):n==="array-contains"?new Tj(e,r):n==="in"?new Cj(e,r):n==="not-in"?new kj(e,r):n==="array-contains-any"?new Ij(e,r):new dr(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Sj(e,r):new Ej(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(bu(n,this.value)):n!==null&&cc(this.value)===cc(n)&&this.matchesComparison(bu(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return St()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Os extends M4{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Os(e,n)}matches(e){return F4(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function F4(t){return t.op==="and"}function V4(t){return Nj(t)&&F4(t)}function Nj(t){for(const e of t.filters)if(e instanceof Os)return!1;return!0}function S1(t){if(t instanceof dr)return t.field.canonicalString()+t.op.toString()+wu(t.value);if(V4(t))return t.filters.map(e=>S1(e)).join(",");{const e=t.filters.map(n=>S1(n)).join(",");return`${t.op}(${e})`}}function U4(t,e){return t instanceof dr?function(r,i){return i instanceof dr&&r.op===i.op&&r.field.isEqual(i.field)&&ma(r.value,i.value)}(t,e):t instanceof Os?function(r,i){return i instanceof Os&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,l)=>s&&U4(a,i.filters[l]),!0):!1}(t,e):void St()}function B4(t){return t instanceof dr?function(n){return`${n.field.canonicalString()} ${n.op} ${wu(n.value)}`}(t):t instanceof Os?function(n){return n.op.toString()+" {"+n.getFilters().map(B4).join(" ,")+"}"}(t):"Filter"}class Aj extends dr{constructor(e,n,r){super(e,n,r),this.key=ct.fromName(r.referenceValue)}matches(e){const n=ct.comparator(e.key,this.key);return this.matchesComparison(n)}}class Sj extends dr{constructor(e,n){super(e,"in",n),this.keys=q4("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Ej extends dr{constructor(e,n){super(e,"not-in",n),this.keys=q4("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function q4(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ct.fromName(r.referenceValue))}class Tj extends dr{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return s2(n)&&lh(n.arrayValue,this.value)}}class Cj extends dr{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&lh(this.value.arrayValue,n)}}class kj extends dr{constructor(e,n){super(e,"not-in",n)}matches(e){if(lh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!lh(this.value.arrayValue,n)}}class Ij extends dr{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!s2(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>lh(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jj{constructor(e,n=null,r=[],i=[],s=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=l,this.ue=null}}function Nb(t,e=null,n=[],r=[],i=null,s=null,a=null){return new jj(t,e,n,r,i,s,a)}function a2(t){const e=It(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>S1(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),km(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>wu(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>wu(r)).join(",")),e.ue=n}return e.ue}function o2(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!_j(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!U4(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!_b(t.startAt,e.startAt)&&_b(t.endAt,e.endAt)}function E1(t){return ct.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,n=null,r=[],i=[],s=null,a="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Pj(t,e,n,r,i,s,a,l){return new ju(t,e,n,r,i,s,a,l)}function Im(t){return new ju(t)}function Ab(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function z4(t){return t.collectionGroup!==null}function Dd(t){const e=It(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new Fr(Dr.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new ch(s,r))}),n.has(Dr.keyField().canonicalString())||e.ce.push(new ch(Dr.keyField(),r))}return e.ce}function fa(t){const e=It(t);return e.le||(e.le=Lj(e,Dd(t))),e.le}function Lj(t,e){if(t.limitType==="F")return Nb(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new ch(i.field,s)});const n=t.endAt?new zp(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new zp(t.startAt.position,t.startAt.inclusive):null;return Nb(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function T1(t,e){const n=t.filters.concat([e]);return new ju(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function $p(t,e,n){return new ju(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function jm(t,e){return o2(fa(t),fa(e))&&t.limitType===e.limitType}function $4(t){return`${a2(fa(t))}|lt:${t.limitType}`}function Ic(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>B4(i)).join(", ")}]`),km(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>wu(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>wu(i)).join(",")),`Target(${r})`}(fa(t))}; limitType=${t.limitType})`}function Pm(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ct.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Dd(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(a,l,c){const u=wb(a,l,c);return a.inclusive?u<=0:u<0}(r.startAt,Dd(r),i)||r.endAt&&!function(a,l,c){const u=wb(a,l,c);return a.inclusive?u>=0:u>0}(r.endAt,Dd(r),i))}(t,e)}function Rj(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function H4(t){return(e,n)=>{let r=!1;for(const i of Dd(t)){const s=Dj(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Dj(t,e,n){const r=t.field.isKeyField()?ct.comparator(e.key,n.key):function(s,a,l){const c=a.data.field(s),u=l.data.field(s);return c!==null&&u!==null?bu(c,u):St()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return St()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){gc(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return R4(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oj=new zn(ct.comparator);function io(){return Oj}const W4=new zn(ct.comparator);function wd(...t){let e=W4;for(const n of t)e=e.insert(n.key,n);return e}function G4(t){let e=W4;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Gl(){return Od()}function K4(){return Od()}function Od(){return new Pu(t=>t.toString(),(t,e)=>t.isEqual(e))}const Mj=new zn(ct.comparator),Fj=new Fr(ct.comparator);function Ut(...t){let e=Fj;for(const n of t)e=e.add(n);return e}const Vj=new Fr(Zt);function Uj(){return Vj}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l2(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qp(e)?"-0":e}}function Y4(t){return{integerValue:""+t}}function Bj(t,e){return vj(e)?Y4(e):l2(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{constructor(){this._=void 0}}function qj(t,e,n){return t instanceof Hp?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&r2(s)&&(s=i2(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(n,e):t instanceof uh?X4(t,e):t instanceof dh?J4(t,e):function(i,s){const a=Q4(i,s),l=Sb(a)+Sb(i.Pe);return A1(a)&&A1(i.Pe)?Y4(l):l2(i.serializer,l)}(t,e)}function zj(t,e,n){return t instanceof uh?X4(t,e):t instanceof dh?J4(t,e):n}function Q4(t,e){return t instanceof Wp?function(r){return A1(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Hp extends Lm{}class uh extends Lm{constructor(e){super(),this.elements=e}}function X4(t,e){const n=Z4(e);for(const r of t.elements)n.some(i=>ma(i,r))||n.push(r);return{arrayValue:{values:n}}}class dh extends Lm{constructor(e){super(),this.elements=e}}function J4(t,e){let n=Z4(e);for(const r of t.elements)n=n.filter(i=>!ma(i,r));return{arrayValue:{values:n}}}class Wp extends Lm{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Sb(t){return nr(t.integerValue||t.doubleValue)}function Z4(t){return s2(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function $j(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof uh&&i instanceof uh||r instanceof dh&&i instanceof dh?xu(r.elements,i.elements,ma):r instanceof Wp&&i instanceof Wp?ma(r.Pe,i.Pe):r instanceof Hp&&i instanceof Hp}(t.transform,e.transform)}class Hj{constructor(e,n){this.version=e,this.transformResults=n}}class fs{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new fs}static exists(e){return new fs(void 0,e)}static updateTime(e){return new fs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Zf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Rm{}function e3(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new c2(t.key,fs.none()):new kh(t.key,t.data,fs.none());{const n=t.data,r=_i.empty();let i=new Fr(Dr.comparator);for(let s of e.fields)if(!i.has(s)){let a=n.field(s);a===null&&s.length>1&&(s=s.popLast(),a=n.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new yl(t.key,r,new Wi(i.toArray()),fs.none())}}function Wj(t,e,n){t instanceof kh?function(i,s,a){const l=i.value.clone(),c=Tb(i.fieldTransforms,s,a.transformResults);l.setAll(c),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof yl?function(i,s,a){if(!Zf(i.precondition,s))return void s.convertToUnknownDocument(a.version);const l=Tb(i.fieldTransforms,s,a.transformResults),c=s.data;c.setAll(t3(i)),c.setAll(l),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Md(t,e,n,r){return t instanceof kh?function(s,a,l,c){if(!Zf(s.precondition,a))return l;const u=s.value.clone(),f=Cb(s.fieldTransforms,c,a);return u.setAll(f),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof yl?function(s,a,l,c){if(!Zf(s.precondition,a))return l;const u=Cb(s.fieldTransforms,c,a),f=a.data;return f.setAll(t3(s)),f.setAll(u),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(s,a,l){return Zf(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function Gj(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=Q4(r.transform,i||null);s!=null&&(n===null&&(n=_i.empty()),n.set(r.field,s))}return n||null}function Eb(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&xu(r,i,(s,a)=>$j(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class kh extends Rm{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class yl extends Rm{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function t3(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Tb(t,e,n){const r=new Map;fn(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],a=s.transform,l=e.data.field(s.field);r.set(s.field,zj(a,l,n[i]))}return r}function Cb(t,e,n){const r=new Map;for(const i of t){const s=i.transform,a=n.data.field(i.field);r.set(i.field,qj(s,a,e))}return r}class c2 extends Rm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Kj extends Rm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yj{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&Wj(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Md(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Md(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=K4();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let l=this.applyToLocalView(a,s.mutatedFields);l=n.has(i.key)?null:l;const c=e3(a,l);c!==null&&r.set(i.key,c),a.isValidDocument()||a.convertToNoDocument(kt.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ut())}isEqual(e){return this.batchId===e.batchId&&xu(this.mutations,e.mutations,(n,r)=>Eb(n,r))&&xu(this.baseMutations,e.baseMutations,(n,r)=>Eb(n,r))}}class u2{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){fn(e.mutations.length===r.length);let i=function(){return Mj}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new u2(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qj{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xj{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cr,Yt;function Jj(t){switch(t){default:return St();case Ie.CANCELLED:case Ie.UNKNOWN:case Ie.DEADLINE_EXCEEDED:case Ie.RESOURCE_EXHAUSTED:case Ie.INTERNAL:case Ie.UNAVAILABLE:case Ie.UNAUTHENTICATED:return!1;case Ie.INVALID_ARGUMENT:case Ie.NOT_FOUND:case Ie.ALREADY_EXISTS:case Ie.PERMISSION_DENIED:case Ie.FAILED_PRECONDITION:case Ie.ABORTED:case Ie.OUT_OF_RANGE:case Ie.UNIMPLEMENTED:case Ie.DATA_LOSS:return!0}}function n3(t){if(t===void 0)return ro("GRPC error has no .code"),Ie.UNKNOWN;switch(t){case cr.OK:return Ie.OK;case cr.CANCELLED:return Ie.CANCELLED;case cr.UNKNOWN:return Ie.UNKNOWN;case cr.DEADLINE_EXCEEDED:return Ie.DEADLINE_EXCEEDED;case cr.RESOURCE_EXHAUSTED:return Ie.RESOURCE_EXHAUSTED;case cr.INTERNAL:return Ie.INTERNAL;case cr.UNAVAILABLE:return Ie.UNAVAILABLE;case cr.UNAUTHENTICATED:return Ie.UNAUTHENTICATED;case cr.INVALID_ARGUMENT:return Ie.INVALID_ARGUMENT;case cr.NOT_FOUND:return Ie.NOT_FOUND;case cr.ALREADY_EXISTS:return Ie.ALREADY_EXISTS;case cr.PERMISSION_DENIED:return Ie.PERMISSION_DENIED;case cr.FAILED_PRECONDITION:return Ie.FAILED_PRECONDITION;case cr.ABORTED:return Ie.ABORTED;case cr.OUT_OF_RANGE:return Ie.OUT_OF_RANGE;case cr.UNIMPLEMENTED:return Ie.UNIMPLEMENTED;case cr.DATA_LOSS:return Ie.DATA_LOSS;default:return St()}}(Yt=cr||(cr={}))[Yt.OK=0]="OK",Yt[Yt.CANCELLED=1]="CANCELLED",Yt[Yt.UNKNOWN=2]="UNKNOWN",Yt[Yt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Yt[Yt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Yt[Yt.NOT_FOUND=5]="NOT_FOUND",Yt[Yt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Yt[Yt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Yt[Yt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Yt[Yt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Yt[Yt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Yt[Yt.ABORTED=10]="ABORTED",Yt[Yt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Yt[Yt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Yt[Yt.INTERNAL=13]="INTERNAL",Yt[Yt.UNAVAILABLE=14]="UNAVAILABLE",Yt[Yt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zj(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eP=new Ql([4294967295,4294967295],0);function kb(t){const e=Zj().encode(t),n=new E4;return n.update(e),new Uint8Array(n.digest())}function Ib(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ql([n,r],0),new Ql([i,s],0)]}class d2{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new _d(`Invalid padding: ${n}`);if(r<0)throw new _d(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new _d(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new _d(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Ql.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(Ql.fromNumber(r)));return i.compare(eP)===1&&(i=new Ql([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=kb(e),[r,i]=Ib(n);for(let s=0;s<this.hashCount;s++){const a=this.Ee(r,i,s);if(!this.de(a))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new d2(s,i,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;const n=kb(e),[r,i]=Ib(n);for(let s=0;s<this.hashCount;s++){const a=this.Ee(r,i,s);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class _d extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Ih.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Dm(kt.min(),i,new zn(Zt),io(),Ut())}}class Ih{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ih(r,n,Ut(),Ut(),Ut())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class r3{constructor(e,n){this.targetId=e,this.me=n}}class i3{constructor(e,n,r=Ur.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class jb{constructor(){this.fe=0,this.ge=Lb(),this.pe=Ur.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ut(),n=Ut(),r=Ut();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:St()}}),new Ih(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Lb()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,fn(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class tP{constructor(e){this.Le=e,this.Be=new Map,this.ke=io(),this.qe=Pb(),this.Qe=new zn(Zt)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:St()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(E1(s))if(r===0){const a=new ct(s.path);this.Ue(n,a,ti.newNoDocument(a,kt.min()))}else fn(r===1);else{const a=this.Ye(n);if(a!==r){const l=this.Ze(e),c=l?this.Xe(l,e,a):1;if(c!==0){this.je(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let a,l;try{a=lc(r).toUint8Array()}catch(c){if(c instanceof D4)return yu("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new d2(a,i,s)}catch(c){return yu(c instanceof _d?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,a)=>{const l=this.Je(a);if(l){if(s.current&&E1(l.target)){const c=new ct(l.target.path);this.ke.get(c)!==null||this.it(a,c)||this.Ue(a,c,ti.newNoDocument(c,e))}s.be&&(n.set(a,s.ve()),s.Ce())}});let r=Ut();this.qe.forEach((s,a)=>{let l=!0;a.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new Dm(e,n,this.Qe,this.ke,r);return this.ke=io(),this.qe=Pb(),this.Qe=new zn(Zt),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new jb,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Fr(Zt),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||Xe("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new jb),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Pb(){return new zn(ct.comparator)}function Lb(){return new zn(ct.comparator)}const nP={asc:"ASCENDING",desc:"DESCENDING"},rP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},iP={and:"AND",or:"OR"};class sP{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function C1(t,e){return t.useProto3Json||km(e)?e:{value:e}}function Gp(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function s3(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function aP(t,e){return Gp(t,e.toTimestamp())}function pa(t){return fn(!!t),kt.fromTimestamp(function(n){const r=dl(n);return new lt(r.seconds,r.nanos)}(t))}function h2(t,e){return k1(t,e).canonicalString()}function k1(t,e){const n=function(i){return new En(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function a3(t){const e=En.fromString(t);return fn(d3(e)),e}function I1(t,e){return h2(t.databaseId,e.path)}function Gg(t,e){const n=a3(e);if(n.get(1)!==t.databaseId.projectId)throw new $e(Ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new $e(Ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ct(l3(n))}function o3(t,e){return h2(t.databaseId,e)}function oP(t){const e=a3(t);return e.length===4?En.emptyPath():l3(e)}function j1(t){return new En(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function l3(t){return fn(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Rb(t,e,n){return{name:I1(t,e),fields:n.value.mapValue.fields}}function lP(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:St()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(fn(f===void 0||typeof f=="string"),Ur.fromBase64String(f||"")):(fn(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Ur.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(u){const f=u.code===void 0?Ie.UNKNOWN:n3(u.code);return new $e(f,u.message||"")}(a);n=new i3(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Gg(t,r.document.name),s=pa(r.document.updateTime),a=r.document.createTime?pa(r.document.createTime):kt.min(),l=new _i({mapValue:{fields:r.document.fields}}),c=ti.newFoundDocument(i,s,a,l),u=r.targetIds||[],f=r.removedTargetIds||[];n=new ep(u,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Gg(t,r.document),s=r.readTime?pa(r.readTime):kt.min(),a=ti.newNoDocument(i,s),l=r.removedTargetIds||[];n=new ep([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Gg(t,r.document),s=r.removedTargetIds||[];n=new ep([],s,i,null)}else{if(!("filter"in e))return St();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new Xj(i,s),l=r.targetId;n=new r3(l,a)}}return n}function cP(t,e){let n;if(e instanceof kh)n={update:Rb(t,e.key,e.value)};else if(e instanceof c2)n={delete:I1(t,e.key)};else if(e instanceof yl)n={update:Rb(t,e.key,e.data),updateMask:yP(e.fieldMask)};else{if(!(e instanceof Kj))return St();n={verify:I1(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const l=a.transform;if(l instanceof Hp)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof uh)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof dh)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Wp)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw St()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:aP(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:St()}(t,e.precondition)),n}function uP(t,e){return t&&t.length>0?(fn(e!==void 0),t.map(n=>function(i,s){let a=i.updateTime?pa(i.updateTime):pa(s);return a.isEqual(kt.min())&&(a=pa(s)),new Hj(a,i.transformResults||[])}(n,e))):[]}function dP(t,e){return{documents:[o3(t,e.path)]}}function hP(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=o3(t,i);const s=function(u){if(u.length!==0)return u3(Os.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const a=function(u){if(u.length!==0)return u.map(f=>function(y){return{field:jc(y.field),direction:mP(y.dir)}}(f))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=C1(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:i}}function fP(t){let e=oP(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){fn(r===1);const f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(g){const y=c3(g);return y instanceof Os&&V4(y)?y.getFilters():[y]}(n.where));let a=[];n.orderBy&&(a=function(g){return g.map(y=>function(T){return new ch(Pc(T.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(y))}(n.orderBy));let l=null;n.limit&&(l=function(g){let y;return y=typeof g=="object"?g.value:g,km(y)?null:y}(n.limit));let c=null;n.startAt&&(c=function(g){const y=!!g.before,p=g.values||[];return new zp(p,y)}(n.startAt));let u=null;return n.endAt&&(u=function(g){const y=!g.before,p=g.values||[];return new zp(p,y)}(n.endAt)),Pj(e,i,a,s,l,"F",c,u)}function pP(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return St()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function c3(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Pc(n.unaryFilter.field);return dr.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Pc(n.unaryFilter.field);return dr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Pc(n.unaryFilter.field);return dr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Pc(n.unaryFilter.field);return dr.create(a,"!=",{nullValue:"NULL_VALUE"});default:return St()}}(t):t.fieldFilter!==void 0?function(n){return dr.create(Pc(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return St()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Os.create(n.compositeFilter.filters.map(r=>c3(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return St()}}(n.compositeFilter.op))}(t):St()}function mP(t){return nP[t]}function gP(t){return rP[t]}function vP(t){return iP[t]}function jc(t){return{fieldPath:t.canonicalString()}}function Pc(t){return Dr.fromServerFormat(t.fieldPath)}function u3(t){return t instanceof dr?function(n){if(n.op==="=="){if(bb(n.value))return{unaryFilter:{field:jc(n.field),op:"IS_NAN"}};if(xb(n.value))return{unaryFilter:{field:jc(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(bb(n.value))return{unaryFilter:{field:jc(n.field),op:"IS_NOT_NAN"}};if(xb(n.value))return{unaryFilter:{field:jc(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jc(n.field),op:gP(n.op),value:n.value}}}(t):t instanceof Os?function(n){const r=n.getFilters().map(i=>u3(i));return r.length===1?r[0]:{compositeFilter:{op:vP(n.op),filters:r}}}(t):St()}function yP(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function d3(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e,n,r,i,s=kt.min(),a=kt.min(),l=Ur.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Go(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Go(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Go(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Go(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(e){this.ct=e}}function bP(t){const e=fP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?$p(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(){this.un=new _P}addToCollectionParentIndex(e,n){return this.un.add(n),Re.resolve()}getCollectionParents(e,n){return Re.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return Re.resolve()}deleteFieldIndex(e,n){return Re.resolve()}deleteAllFieldIndexes(e){return Re.resolve()}createTargetIndexes(e,n){return Re.resolve()}getDocumentsMatchingTarget(e,n){return Re.resolve(null)}getIndexType(e,n){return Re.resolve(0)}getFieldIndexes(e,n){return Re.resolve([])}getNextCollectionGroupToUpdate(e){return Re.resolve(null)}getMinOffset(e,n){return Re.resolve(ul.min())}getMinOffsetFromCollectionGroup(e,n){return Re.resolve(ul.min())}updateCollectionGroup(e,n,r){return Re.resolve()}updateIndexEntries(e,n){return Re.resolve()}}class _P{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Fr(En.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Fr(En.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new _u(0)}static kn(){return new _u(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(){this.changes=new Pu(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ti.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?Re.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Md(r.mutation,i,Wi.empty(),lt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ut()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ut()){const i=Gl();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let a=wd();return s.forEach((l,c)=>{a=a.insert(l,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=Gl();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ut()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,i){let s=io();const a=Od(),l=function(){return Od()}();return n.forEach((c,u)=>{const f=r.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof yl)?s=s.insert(u.key,u):f!==void 0?(a.set(u.key,f.mutation.getFieldMask()),Md(f.mutation,u,f.mutation.getFieldMask(),lt.now())):a.set(u.key,Wi.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,f)=>a.set(u,f)),n.forEach((u,f)=>{var g;return l.set(u,new AP(f,(g=a.get(u))!==null&&g!==void 0?g:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Od();let i=new zn((a,l)=>a-l),s=Ut();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let f=r.get(c)||Wi.empty();f=l.applyToLocalView(u,f),r.set(c,f);const g=(i.get(l.batchId)||Ut()).add(c);i=i.insert(l.batchId,g)})}).next(()=>{const a=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,f=c.value,g=K4();f.forEach(y=>{if(!s.has(y)){const p=e3(n.get(y),r.get(y));p!==null&&g.set(y,p),s=s.add(y)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,g))}return Re.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(a){return ct.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):z4(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):Re.resolve(Gl());let l=-1,c=s;return a.next(u=>Re.forEach(u,(f,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),s.get(f)?Re.resolve():this.remoteDocumentCache.getEntry(e,f).next(y=>{c=c.insert(f,y)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,Ut())).next(f=>({batchId:l,changes:G4(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ct(n)).next(r=>{let i=wd();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let a=wd();return this.indexManager.getCollectionParents(e,s).next(l=>Re.forEach(l,c=>{const u=function(g,y){return new ju(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(f=>{f.forEach((g,y)=>{a=a.insert(g,y)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(a=>{s.forEach((c,u)=>{const f=u.getKey();a.get(f)===null&&(a=a.insert(f,ti.newInvalidDocument(f)))});let l=wd();return a.forEach((c,u)=>{const f=s.get(c);f!==void 0&&Md(f.mutation,u,Wi.empty(),lt.now()),Pm(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return Re.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:pa(i.createTime)}}(n)),Re.resolve()}getNamedQuery(e,n){return Re.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:bP(i.bundledQuery),readTime:pa(i.readTime)}}(n)),Re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(){this.overlays=new zn(ct.comparator),this.Ir=new Map}getOverlay(e,n){return Re.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Gl();return Re.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),Re.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),Re.resolve()}getOverlaysForCollection(e,n,r){const i=Gl(),s=n.length+1,a=new ct(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return Re.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new zn((u,f)=>u-f);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let f=s.get(u.largestBatchId);f===null&&(f=Gl(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const l=Gl(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,f)=>l.set(u,f)),!(l.size()>=i)););return Re.resolve(l)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Qj(n,r));let s=this.Ir.get(n);s===void 0&&(s=Ut(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(){this.sessionToken=Ur.EMPTY_BYTE_STRING}getSessionToken(e){return Re.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(){this.Tr=new Fr(Ar.Er),this.dr=new Fr(Ar.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Ar(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Ar(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ct(new En([])),r=new Ar(n,e),i=new Ar(n,e+1),s=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ct(new En([])),r=new Ar(n,e),i=new Ar(n,e+1);let s=Ut();return this.dr.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const n=new Ar(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ar{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ct.comparator(e.key,n.key)||Zt(e.wr,n.wr)}static Ar(e,n){return Zt(e.wr,n.wr)||ct.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Fr(Ar.Er)}checkEmpty(e){return Re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Yj(s,n,r,i);this.mutationQueue.push(a);for(const l of i)this.br=this.br.add(new Ar(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Re.resolve(a)}lookupMutationBatch(e,n){return Re.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return Re.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Re.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ar(n,0),i=new Ar(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],a=>{const l=this.Dr(a.wr);s.push(l)}),Re.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Fr(Zt);return n.forEach(i=>{const s=new Ar(i,0),a=new Ar(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],l=>{r=r.add(l.wr)})}),Re.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ct.isDocumentKey(s)||(s=s.child(""));const a=new Ar(new ct(s),0);let l=new Fr(Zt);return this.br.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(l=l.add(c.wr)),!0)},a),Re.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){fn(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return Re.forEach(n.mutations,i=>{const s=new Ar(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Ar(n,0),i=this.br.firstAfterOrEqual(r);return Re.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Re.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(e){this.Mr=e,this.docs=function(){return new zn(ct.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return Re.resolve(r?r.document.mutableCopy():ti.newInvalidDocument(n))}getEntries(e,n){let r=io();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ti.newInvalidDocument(i))}),Re.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=io();const a=n.path,l=new ct(a.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:f}}=c.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||fj(hj(f),r)<=0||(i.has(f.key)||Pm(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Re.resolve(s)}getAllFromCollectionGroup(e,n,r,i){St()}Or(e,n){return Re.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new jP(this)}getSize(e){return Re.resolve(this.size)}}class jP extends NP{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),Re.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(e){this.persistence=e,this.Nr=new Pu(n=>a2(n),o2),this.lastRemoteSnapshotVersion=kt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new f2,this.targetCount=0,this.kr=_u.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),Re.resolve()}getLastRemoteSnapshotVersion(e){return Re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Re.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Re.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),Re.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new _u(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,Re.resolve()}updateTargetData(e,n){return this.Kn(n),Re.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,Re.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),Re.waitFor(s).next(()=>i)}getTargetCount(e){return Re.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return Re.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),Re.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),Re.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),Re.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return Re.resolve(r)}containsKey(e,n){return Re.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(e,n){this.qr={},this.overlays={},this.Qr=new n2(0),this.Kr=!1,this.Kr=!0,this.$r=new CP,this.referenceDelegate=e(this),this.Ur=new PP(this),this.indexManager=new wP,this.remoteDocumentCache=function(i){return new IP(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new xP(n),this.Gr=new EP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new TP,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new kP(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){Xe("MemoryPersistence","Starting transaction:",e);const i=new RP(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return Re.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class RP extends mj{constructor(e){super(),this.currentSequenceNumber=e}}class p2{constructor(e){this.persistence=e,this.Jr=new f2,this.Yr=null}static Zr(e){return new p2(e)}get Xr(){if(this.Yr)return this.Yr;throw St()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),Re.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),Re.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),Re.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Re.forEach(this.Xr,r=>{const i=ct.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,kt.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return Re.or([()=>Re.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=Ut(),i=Ut();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new m2(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return A6()?8:gj(ii())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new DP;return this.Xi(e,n,a).next(l=>{if(s.result=l,this.zi)return this.es(e,n,a,l.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(dd()<=$t.DEBUG&&Xe("QueryEngine","SDK will not create cache indexes for query:",Ic(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Re.resolve()):(dd()<=$t.DEBUG&&Xe("QueryEngine","Query:",Ic(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(dd()<=$t.DEBUG&&Xe("QueryEngine","The SDK decides to create cache indexes for query:",Ic(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,fa(n))):Re.resolve())}Yi(e,n){if(Ab(n))return Re.resolve(null);let r=fa(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=$p(n,null,"F"),r=fa(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=Ut(...s);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ts(n,l);return this.ns(n,u,a,c.readTime)?this.Yi(e,$p(n,null,"F")):this.rs(e,u,n,c)}))})))}Zi(e,n,r,i){return Ab(n)||i.isEqual(kt.min())?Re.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const a=this.ts(n,s);return this.ns(n,a,r,i)?Re.resolve(null):(dd()<=$t.DEBUG&&Xe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ic(n)),this.rs(e,a,n,dj(i,-1)).next(l=>l))})}ts(e,n){let r=new Fr(H4(e));return n.forEach((i,s)=>{Pm(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return dd()<=$t.DEBUG&&Xe("QueryEngine","Using full collection scan to execute query:",Ic(n)),this.Ji.getDocumentsMatchingQuery(e,n,ul.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new zn(Zt),this._s=new Pu(s=>a2(s),o2),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new SP(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function FP(t,e,n,r){return new MP(t,e,n,r)}async function h3(t,e){const n=It(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],l=[];let c=Ut();for(const u of i){a.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}for(const u of s){l.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}return n.localDocuments.getDocuments(r,c).next(u=>({hs:u,removedBatchIds:a,addedBatchIds:l}))})})}function VP(t,e){const n=It(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,f){const g=u.batch,y=g.keys();let p=Re.resolve();return y.forEach(T=>{p=p.next(()=>f.getEntry(c,T)).next(E=>{const P=u.docVersions.get(T);fn(P!==null),E.version.compareTo(P)<0&&(g.applyToRemoteDocument(E,u),E.isValidDocument()&&(E.setReadTime(u.commitVersion),f.addEntry(E)))})}),p.next(()=>l.mutationQueue.removeMutationBatch(c,g))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=Ut();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function f3(t){const e=It(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function UP(t,e){const n=It(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const l=[];e.targetChanges.forEach((f,g)=>{const y=i.get(g);if(!y)return;l.push(n.Ur.removeMatchingKeys(s,f.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(s,f.addedDocuments,g)));let p=y.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?p=p.withResumeToken(Ur.EMPTY_BYTE_STRING,kt.min()).withLastLimboFreeSnapshotVersion(kt.min()):f.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(f.resumeToken,r)),i=i.insert(g,p),function(E,P,A){return E.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(y,p,f)&&l.push(n.Ur.updateTargetData(s,p))});let c=io(),u=Ut();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),l.push(BP(s,a,e.documentUpdates).next(f=>{c=f.Ps,u=f.Is})),!r.isEqual(kt.min())){const f=n.Ur.getLastRemoteSnapshotVersion(s).next(g=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(f)}return Re.waitFor(l).next(()=>a.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(n.os=i,s))}function BP(t,e,n){let r=Ut(),i=Ut();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let a=io();return n.forEach((l,c)=>{const u=s.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(kt.min())?(e.removeEntry(l,c.readTime),a=a.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),a=a.insert(l,c)):Xe("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:a,Is:i}})}function qP(t,e){const n=It(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function zP(t,e){const n=It(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,Re.resolve(i)):n.Ur.allocateTargetId(r).next(a=>(i=new Go(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function P1(t,e,n){const r=It(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Ch(a))throw a;Xe("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function Db(t,e,n){const r=It(t);let i=kt.min(),s=Ut();return r.persistence.runTransaction("Execute query","readwrite",a=>function(c,u,f){const g=It(c),y=g._s.get(f);return y!==void 0?Re.resolve(g.os.get(y)):g.Ur.getTargetData(u,f)}(r,a,fa(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,l.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?i:kt.min(),n?s:Ut())).next(l=>($P(r,Rj(e),l),{documents:l,Ts:s})))}function $P(t,e,n){let r=t.us.get(e)||kt.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}class Ob{constructor(){this.activeTargetIds=Uj()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class HP{constructor(){this.so=new Ob,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Ob,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Xe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Xe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Af=null;function Kg(){return Af===null?Af=function(){return 268435456+Math.round(2147483648*Math.random())}():Af++,"0x"+Af.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kr="WebChannelConnection";class YP extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,a){const l=Kg(),c=this.xo(n,r.toUriEncodedString());Xe("RestConnection",`Sending RPC '${n}' ${l}:`,c,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,a),this.No(n,c,u,i).then(f=>(Xe("RestConnection",`Received RPC '${n}' ${l}: `,f),f),f=>{throw yu("RestConnection",`RPC '${n}' ${l} failed with error: `,f,"url: ",c,"request:",i),f})}Lo(n,r,i,s,a,l){return this.Mo(n,r,i,s,a)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Iu}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>n[a]=s),i&&i.headers.forEach((s,a)=>n[a]=s)}xo(n,r){const i=GP[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=Kg();return new Promise((a,l)=>{const c=new T4;c.setWithCredentials(!0),c.listenOnce(C4.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Xf.NO_ERROR:const f=c.getResponseJson();Xe(Kr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case Xf.TIMEOUT:Xe(Kr,`RPC '${e}' ${s} timed out`),l(new $e(Ie.DEADLINE_EXCEEDED,"Request time out"));break;case Xf.HTTP_ERROR:const g=c.getStatus();if(Xe(Kr,`RPC '${e}' ${s} failed with status:`,g,"response text:",c.getResponseText()),g>0){let y=c.getResponseJson();Array.isArray(y)&&(y=y[0]);const p=y==null?void 0:y.error;if(p&&p.status&&p.message){const T=function(P){const A=P.toLowerCase().replace(/_/g,"-");return Object.values(Ie).indexOf(A)>=0?A:Ie.UNKNOWN}(p.status);l(new $e(T,p.message))}else l(new $e(Ie.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new $e(Ie.UNAVAILABLE,"Connection failed."));break;default:St()}}finally{Xe(Kr,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);Xe(Kr,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",u,r,15)})}Bo(e,n,r){const i=Kg(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=j4(),l=I4(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const f=s.join("");Xe(Kr,`Creating RPC '${e}' stream ${i}: ${f}`,c);const g=a.createWebChannel(f,c);let y=!1,p=!1;const T=new KP({Io:P=>{p?Xe(Kr,`Not sending because RPC '${e}' stream ${i} is closed:`,P):(y||(Xe(Kr,`Opening RPC '${e}' stream ${i} transport.`),g.open(),y=!0),Xe(Kr,`RPC '${e}' stream ${i} sending:`,P),g.send(P))},To:()=>g.close()}),E=(P,A,L)=>{P.listen(A,M=>{try{L(M)}catch(F){setTimeout(()=>{throw F},0)}})};return E(g,bd.EventType.OPEN,()=>{p||(Xe(Kr,`RPC '${e}' stream ${i} transport opened.`),T.yo())}),E(g,bd.EventType.CLOSE,()=>{p||(p=!0,Xe(Kr,`RPC '${e}' stream ${i} transport closed`),T.So())}),E(g,bd.EventType.ERROR,P=>{p||(p=!0,yu(Kr,`RPC '${e}' stream ${i} transport errored:`,P),T.So(new $e(Ie.UNAVAILABLE,"The operation could not be completed")))}),E(g,bd.EventType.MESSAGE,P=>{var A;if(!p){const L=P.data[0];fn(!!L);const M=L,F=M.error||((A=M[0])===null||A===void 0?void 0:A.error);if(F){Xe(Kr,`RPC '${e}' stream ${i} received error:`,F);const te=F.status;let ae=function(j){const S=cr[j];if(S!==void 0)return n3(S)}(te),B=F.message;ae===void 0&&(ae=Ie.INTERNAL,B="Unknown error status: "+te+" with message "+F.message),p=!0,T.So(new $e(ae,B)),g.close()}else Xe(Kr,`RPC '${e}' stream ${i} received:`,L),T.bo(L)}}),E(l,k4.STAT_EVENT,P=>{P.stat===_1.PROXY?Xe(Kr,`RPC '${e}' stream ${i} detected buffering proxy`):P.stat===_1.NOPROXY&&Xe(Kr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{T.wo()},0),T}}function Yg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Om(t){return new sP(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p3{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&Xe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m3{constructor(e,n,r,i,s,a,l,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new p3(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===Ie.RESOURCE_EXHAUSTED?(ro(n.toString()),ro("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===Ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new $e(Ie.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Xe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(Xe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class QP extends m3{constructor(e,n,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=lP(this.serializer,e),r=function(s){if(!("targetChange"in s))return kt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?kt.min():a.readTime?pa(a.readTime):kt.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=j1(this.serializer),n.addTarget=function(s,a){let l;const c=a.target;if(l=E1(c)?{documents:dP(s,c)}:{query:hP(s,c)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=s3(s,a.resumeToken);const u=C1(s,a.expectedCount);u!==null&&(l.expectedCount=u)}else if(a.snapshotVersion.compareTo(kt.min())>0){l.readTime=Gp(s,a.snapshotVersion.toTimestamp());const u=C1(s,a.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=pP(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=j1(this.serializer),n.removeTarget=e,this.a_(n)}}class XP extends m3{constructor(e,n,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return fn(!!e.streamToken),this.lastStreamToken=e.streamToken,fn(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){fn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=uP(e.writeResults,e.commitTime),r=pa(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=j1(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>cP(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new $e(Ie.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,k1(n,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new $e(Ie.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,k1(n,r),i,a,l,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new $e(Ie.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class ZP{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ro(n),this.D_=!1):Xe("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{r.enqueueAndForget(async()=>{vc(this)&&(Xe("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=It(c);u.L_.add(4),await jh(u),u.q_.set("Unknown"),u.L_.delete(4),await Mm(u)}(this))})}),this.q_=new ZP(r,i)}}async function Mm(t){if(vc(t))for(const e of t.B_)await e(!0)}async function jh(t){for(const e of t.B_)await e(!1)}function g3(t,e){const n=It(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),x2(n)?y2(n):Lu(n).r_()&&v2(n,e))}function g2(t,e){const n=It(t),r=Lu(n);n.N_.delete(e),r.r_()&&v3(n,e),n.N_.size===0&&(r.r_()?r.o_():vc(n)&&n.q_.set("Unknown"))}function v2(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(kt.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Lu(t).A_(e)}function v3(t,e){t.Q_.xe(e),Lu(t).R_(e)}function y2(t){t.Q_=new tP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Lu(t).start(),t.q_.v_()}function x2(t){return vc(t)&&!Lu(t).n_()&&t.N_.size>0}function vc(t){return It(t).L_.size===0}function y3(t){t.Q_=void 0}async function tL(t){t.q_.set("Online")}async function nL(t){t.N_.forEach((e,n)=>{v2(t,e)})}async function rL(t,e){y3(t),x2(t)?(t.q_.M_(e),y2(t)):t.q_.set("Unknown")}async function iL(t,e,n){if(t.q_.set("Online"),e instanceof i3&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const l of s.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,a),i.N_.delete(l),i.Q_.removeTarget(l))}(t,e)}catch(r){Xe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Kp(t,r)}else if(e instanceof ep?t.Q_.Ke(e):e instanceof r3?t.Q_.He(e):t.Q_.We(e),!n.isEqual(kt.min()))try{const r=await f3(t.localStore);n.compareTo(r)>=0&&await function(s,a){const l=s.Q_.rt(a);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const f=s.N_.get(u);f&&s.N_.set(u,f.withResumeToken(c.resumeToken,a))}}),l.targetMismatches.forEach((c,u)=>{const f=s.N_.get(c);if(!f)return;s.N_.set(c,f.withResumeToken(Ur.EMPTY_BYTE_STRING,f.snapshotVersion)),v3(s,c);const g=new Go(f.target,c,u,f.sequenceNumber);v2(s,g)}),s.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Xe("RemoteStore","Failed to raise snapshot:",r),await Kp(t,r)}}async function Kp(t,e,n){if(!Ch(e))throw e;t.L_.add(1),await jh(t),t.q_.set("Offline"),n||(n=()=>f3(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Xe("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Mm(t)})}function x3(t,e){return e().catch(n=>Kp(t,n,e))}async function Fm(t){const e=It(t),n=hl(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;sL(e);)try{const i=await qP(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,aL(e,i)}catch(i){await Kp(e,i)}b3(e)&&w3(e)}function sL(t){return vc(t)&&t.O_.length<10}function aL(t,e){t.O_.push(e);const n=hl(t);n.r_()&&n.V_&&n.m_(e.mutations)}function b3(t){return vc(t)&&!hl(t).n_()&&t.O_.length>0}function w3(t){hl(t).start()}async function oL(t){hl(t).p_()}async function lL(t){const e=hl(t);for(const n of t.O_)e.m_(n.mutations)}async function cL(t,e,n){const r=t.O_.shift(),i=u2.from(r,e,n);await x3(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Fm(t)}async function uL(t,e){e&&hl(t).V_&&await async function(r,i){if(function(a){return Jj(a)&&a!==Ie.ABORTED}(i.code)){const s=r.O_.shift();hl(r).s_(),await x3(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Fm(r)}}(t,e),b3(t)&&w3(t)}async function Fb(t,e){const n=It(t);n.asyncQueue.verifyOperationInProgress(),Xe("RemoteStore","RemoteStore received new credentials");const r=vc(n);n.L_.add(3),await jh(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Mm(n)}async function dL(t,e){const n=It(t);e?(n.L_.delete(2),await Mm(n)):e||(n.L_.add(2),await jh(n),n.q_.set("Unknown"))}function Lu(t){return t.K_||(t.K_=function(n,r,i){const s=It(n);return s.w_(),new QP(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:tL.bind(null,t),Ro:nL.bind(null,t),mo:rL.bind(null,t),d_:iL.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),x2(t)?y2(t):t.q_.set("Unknown")):(await t.K_.stop(),y3(t))})),t.K_}function hl(t){return t.U_||(t.U_=function(n,r,i){const s=It(n);return s.w_(),new XP(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:oL.bind(null,t),mo:uL.bind(null,t),f_:lL.bind(null,t),g_:cL.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Fm(t)):(await t.U_.stop(),t.O_.length>0&&(Xe("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b2{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Ya,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const a=Date.now()+r,l=new b2(e,n,a,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $e(Ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function w2(t,e){if(ro("AsyncQueue",`${e}: ${t}`),Ch(t))return new $e(Ie.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ct.comparator(n.key,r.key):(n,r)=>ct.comparator(n.key,r.key),this.keyedMap=wd(),this.sortedSet=new zn(this.comparator)}static emptySet(e){return new iu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof iu)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new iu;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{constructor(){this.W_=new zn(ct.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):St():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Nu{constructor(e,n,r,i,s,a,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new Nu(e,n,iu.emptySet(n),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&jm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class fL{constructor(){this.queries=Ub(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=It(n),s=i.queries;i.queries=Ub(),s.forEach((a,l)=>{for(const c of l.j_)c.onError(r)})})(this,new $e(Ie.ABORTED,"Firestore shutting down"))}}function Ub(){return new Pu(t=>$4(t),jm)}async function _2(t,e){const n=It(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new hL,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(a){const l=w2(a,`Initialization of query '${Ic(e.query)}' failed`);return void e.onError(l)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&A2(n)}async function N2(t,e){const n=It(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function pL(t,e){const n=It(t);let r=!1;for(const i of e){const s=i.query,a=n.queries.get(s);if(a){for(const l of a.j_)l.X_(i)&&(r=!0);a.z_=i}}r&&A2(n)}function mL(t,e,n){const r=It(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function A2(t){t.Y_.forEach(e=>{e.next()})}var L1,Bb;(Bb=L1||(L1={})).ea="default",Bb.Cache="cache";class S2{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Nu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Nu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==L1.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _3{constructor(e){this.key=e}}class N3{constructor(e){this.key=e}}class gL{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ut(),this.mutatedKeys=Ut(),this.Aa=H4(e),this.Ra=new iu(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Vb,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,a=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,g)=>{const y=i.get(f),p=Pm(this.query,g)?g:null,T=!!y&&this.mutatedKeys.has(y.key),E=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let P=!1;y&&p?y.data.isEqual(p.data)?T!==E&&(r.track({type:3,doc:p}),P=!0):this.ga(y,p)||(r.track({type:2,doc:p}),P=!0,(c&&this.Aa(p,c)>0||u&&this.Aa(p,u)<0)&&(l=!0)):!y&&p?(r.track({type:0,doc:p}),P=!0):y&&!p&&(r.track({type:1,doc:y}),P=!0,(c||u)&&(l=!0)),P&&(p?(a=a.add(p),s=E?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{Ra:a,fa:r,ns:l,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((f,g)=>function(p,T){const E=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return St()}};return E(p)-E(T)}(f.type,g.type)||this.Aa(f.doc,g.doc)),this.pa(r),i=i!=null&&i;const l=n&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,u=c!==this.Ea;return this.Ea=c,a.length!==0||u?{snapshot:new Nu(this.query,e.Ra,s,a,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Vb,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ut(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new N3(r))}),this.da.forEach(r=>{e.has(r)||n.push(new _3(r))}),n}ba(e){this.Ta=e.Ts,this.da=Ut();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Nu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class vL{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class yL{constructor(e){this.key=e,this.va=!1}}class xL{constructor(e,n,r,i,s,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Pu(l=>$4(l),jm),this.Ma=new Map,this.xa=new Set,this.Oa=new zn(ct.comparator),this.Na=new Map,this.La=new f2,this.Ba={},this.ka=new Map,this.qa=_u.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function bL(t,e,n=!0){const r=k3(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await A3(r,e,n,!0),i}async function wL(t,e){const n=k3(t);await A3(n,e,!0,!1)}async function A3(t,e,n,r){const i=await zP(t.localStore,fa(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,n);let l;return r&&(l=await _L(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&n&&g3(t.remoteStore,i),l}async function _L(t,e,n,r,i){t.Ka=(g,y,p)=>async function(E,P,A,L){let M=P.view.ma(A);M.ns&&(M=await Db(E.localStore,P.query,!1).then(({documents:B})=>P.view.ma(B,M)));const F=L&&L.targetChanges.get(P.targetId),te=L&&L.targetMismatches.get(P.targetId)!=null,ae=P.view.applyChanges(M,E.isPrimaryClient,F,te);return zb(E,P.targetId,ae.wa),ae.snapshot}(t,g,y,p);const s=await Db(t.localStore,e,!0),a=new gL(e,s.Ts),l=a.ma(s.documents),c=Ih.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=a.applyChanges(l,t.isPrimaryClient,c);zb(t,n,u.wa);const f=new vL(e,n,a);return t.Fa.set(e,f),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),u.snapshot}async function NL(t,e,n){const r=It(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(a=>!jm(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await P1(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&g2(r.remoteStore,i.targetId),R1(r,i.targetId)}).catch(Th)):(R1(r,i.targetId),await P1(r.localStore,i.targetId,!0))}async function AL(t,e){const n=It(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),g2(n.remoteStore,r.targetId))}async function SL(t,e,n){const r=PL(t);try{const i=await function(a,l){const c=It(a),u=lt.now(),f=l.reduce((p,T)=>p.add(T.key),Ut());let g,y;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let T=io(),E=Ut();return c.cs.getEntries(p,f).next(P=>{T=P,T.forEach((A,L)=>{L.isValidDocument()||(E=E.add(A))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,T)).next(P=>{g=P;const A=[];for(const L of l){const M=Gj(L,g.get(L.key).overlayedDocument);M!=null&&A.push(new yl(L.key,M,O4(M.value.mapValue),fs.exists(!0)))}return c.mutationQueue.addMutationBatch(p,u,A,l)}).next(P=>{y=P;const A=P.applyToLocalDocumentSet(g,E);return c.documentOverlayCache.saveOverlays(p,P.batchId,A)})}).then(()=>({batchId:y.batchId,changes:G4(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,c){let u=a.Ba[a.currentUser.toKey()];u||(u=new zn(Zt)),u=u.insert(l,c),a.Ba[a.currentUser.toKey()]=u}(r,i.batchId,n),await Ph(r,i.changes),await Fm(r.remoteStore)}catch(i){const s=w2(i,"Failed to persist write");n.reject(s)}}async function S3(t,e){const n=It(t);try{const r=await UP(n.localStore,e);e.targetChanges.forEach((i,s)=>{const a=n.Na.get(s);a&&(fn(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?fn(a.va):i.removedDocuments.size>0&&(fn(a.va),a.va=!1))}),await Ph(n,r,e)}catch(r){await Th(r)}}function qb(t,e,n){const r=It(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,a)=>{const l=a.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(a,l){const c=It(a);c.onlineState=l;let u=!1;c.queries.forEach((f,g)=>{for(const y of g.j_)y.Z_(l)&&(u=!0)}),u&&A2(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function EL(t,e,n){const r=It(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let a=new zn(ct.comparator);a=a.insert(s,ti.newNoDocument(s,kt.min()));const l=Ut().add(s),c=new Dm(kt.min(),new Map,new zn(Zt),a,l);await S3(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),E2(r)}else await P1(r.localStore,e,!1).then(()=>R1(r,e,n)).catch(Th)}async function TL(t,e){const n=It(t),r=e.batch.batchId;try{const i=await VP(n.localStore,e);T3(n,r,null),E3(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ph(n,i)}catch(i){await Th(i)}}async function CL(t,e,n){const r=It(t);try{const i=await function(a,l){const c=It(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return c.mutationQueue.lookupMutationBatch(u,l).next(g=>(fn(g!==null),f=g.keys(),c.mutationQueue.removeMutationBatch(u,g))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,f,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>c.localDocuments.getDocuments(u,f))})}(r.localStore,e);T3(r,e,n),E3(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ph(r,i)}catch(i){await Th(i)}}function E3(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function T3(t,e,n){const r=It(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function R1(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||C3(t,r)})}function C3(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(g2(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),E2(t))}function zb(t,e,n){for(const r of n)r instanceof _3?(t.La.addReference(r.key,e),kL(t,r)):r instanceof N3?(Xe("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||C3(t,r.key)):St()}function kL(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(Xe("SyncEngine","New document in limbo: "+n),t.xa.add(r),E2(t))}function E2(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ct(En.fromString(e)),r=t.qa.next();t.Na.set(r,new yL(n)),t.Oa=t.Oa.insert(n,r),g3(t.remoteStore,new Go(fa(Im(n.path)),r,"TargetPurposeLimboResolution",n2.oe))}}async function Ph(t,e,n){const r=It(t),i=[],s=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{a.push(r.Ka(c,e,n).then(u=>{var f;if((u||n)&&r.isPrimaryClient){const g=u?!u.fromCache:(f=n==null?void 0:n.targetChanges.get(c.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(c.targetId,g?"current":"not-current")}if(u){i.push(u);const g=m2.Wi(c.targetId,u);s.push(g)}}))}),await Promise.all(a),r.Ca.d_(i),await async function(c,u){const f=It(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>Re.forEach(u,y=>Re.forEach(y.$i,p=>f.persistence.referenceDelegate.addReference(g,y.targetId,p)).next(()=>Re.forEach(y.Ui,p=>f.persistence.referenceDelegate.removeReference(g,y.targetId,p)))))}catch(g){if(!Ch(g))throw g;Xe("LocalStore","Failed to update sequence numbers: "+g)}for(const g of u){const y=g.targetId;if(!g.fromCache){const p=f.os.get(y),T=p.snapshotVersion,E=p.withLastLimboFreeSnapshotVersion(T);f.os=f.os.insert(y,E)}}}(r.localStore,s))}async function IL(t,e){const n=It(t);if(!n.currentUser.isEqual(e)){Xe("SyncEngine","User change. New user:",e.toKey());const r=await h3(n.localStore,e);n.currentUser=e,function(s,a){s.ka.forEach(l=>{l.forEach(c=>{c.reject(new $e(Ie.CANCELLED,a))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ph(n,r.hs)}}function jL(t,e){const n=It(t),r=n.Na.get(e);if(r&&r.va)return Ut().add(r.key);{let i=Ut();const s=n.Ma.get(e);if(!s)return i;for(const a of s){const l=n.Fa.get(a);i=i.unionWith(l.view.Va)}return i}}function k3(t){const e=It(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=S3.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=jL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=EL.bind(null,e),e.Ca.d_=pL.bind(null,e.eventManager),e.Ca.$a=mL.bind(null,e.eventManager),e}function PL(t){const e=It(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=TL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=CL.bind(null,e),e}class Yp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Om(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return FP(this.persistence,new OP,e.initialUser,this.serializer)}Ga(e){return new LP(p2.Zr,this.serializer)}Wa(e){return new HP}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Yp.provider={build:()=>new Yp};class D1{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>qb(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=IL.bind(null,this.syncEngine),await dL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new fL}()}createDatastore(e){const n=Om(e.databaseInfo.databaseId),r=function(s){return new YP(s)}(e.databaseInfo);return function(s,a,l,c){return new JP(s,a,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,a,l){return new eL(r,i,s,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>qb(this.syncEngine,n,0),function(){return Mb.D()?new Mb:new WP}())}createSyncEngine(e,n){return function(i,s,a,l,c,u,f){const g=new xL(i,s,a,l,c,u);return f&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=It(i);Xe("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await jh(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}D1.provider={build:()=>new D1};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T2{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ro("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Zr.UNAUTHENTICATED,this.clientId=L4.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async a=>{Xe("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(Xe("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ya;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=w2(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Qg(t,e){t.asyncQueue.verifyOperationInProgress(),Xe("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await h3(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function $b(t,e){t.asyncQueue.verifyOperationInProgress();const n=await RL(t);Xe("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Fb(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Fb(e.remoteStore,i)),t._onlineComponents=e}async function RL(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Xe("FirestoreClient","Using user provided OfflineComponentProvider");try{await Qg(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===Ie.FAILED_PRECONDITION||i.code===Ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;yu("Error using user provided cache. Falling back to memory cache: "+n),await Qg(t,new Yp)}}else Xe("FirestoreClient","Using default OfflineComponentProvider"),await Qg(t,new Yp);return t._offlineComponents}async function I3(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Xe("FirestoreClient","Using user provided OnlineComponentProvider"),await $b(t,t._uninitializedComponentsProvider._online)):(Xe("FirestoreClient","Using default OnlineComponentProvider"),await $b(t,new D1))),t._onlineComponents}function DL(t){return I3(t).then(e=>e.syncEngine)}async function Qp(t){const e=await I3(t),n=e.eventManager;return n.onListen=bL.bind(null,e.syncEngine),n.onUnlisten=NL.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=wL.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=AL.bind(null,e.syncEngine),n}function OL(t,e,n={}){const r=new Ya;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,l,c,u){const f=new T2({next:y=>{f.Za(),a.enqueueAndForget(()=>N2(s,g));const p=y.docs.has(l);!p&&y.fromCache?u.reject(new $e(Ie.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&y.fromCache&&c&&c.source==="server"?u.reject(new $e(Ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(y)},error:y=>u.reject(y)}),g=new S2(Im(l.path),f,{includeMetadataChanges:!0,_a:!0});return _2(s,g)}(await Qp(t),t.asyncQueue,e,n,r)),r.promise}function ML(t,e,n={}){const r=new Ya;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,l,c,u){const f=new T2({next:y=>{f.Za(),a.enqueueAndForget(()=>N2(s,g)),y.fromCache&&c.source==="server"?u.reject(new $e(Ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(y)},error:y=>u.reject(y)}),g=new S2(l,f,{includeMetadataChanges:!0,_a:!0});return _2(s,g)}(await Qp(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j3(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P3(t,e,n){if(!n)throw new $e(Ie.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function FL(t,e,n,r){if(e===!0&&r===!0)throw new $e(Ie.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Wb(t){if(!ct.isDocumentKey(t))throw new $e(Ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Gb(t){if(ct.isDocumentKey(t))throw new $e(Ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Vm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":St()}function Ti(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new $e(Ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Vm(t);throw new $e(Ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new $e(Ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new $e(Ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}FL("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=j3((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new $e(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new $e(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new $e(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Um{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Kb({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $e(Ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $e(Ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Kb(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new nj;switch(r.type){case"firstParty":return new aj(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new $e(Ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Hb.get(n);r&&(Xe("ComponentProvider","Removing Datastore"),Hb.delete(n),r.terminate())}(this),Promise.resolve()}}function VL(t,e,n,r={}){var i;const s=(t=Ti(t,Um))._getSettings(),a=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&yu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=Zr.MOCK_USER;else{l=VN(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new $e(Ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Zr(u)}t._authCredentials=new rj(new P4(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new co(this.firestore,e,this._query)}}class ni{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new sl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ni(this.firestore,e,this._key)}}class sl extends co{constructor(e,n,r){super(e,n,Im(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ni(this.firestore,null,new ct(e))}withConverter(e){return new sl(this.firestore,e,this._path)}}function Ht(t,e,...n){if(t=Dn(t),P3("collection","path",e),t instanceof Um){const r=En.fromString(e,...n);return Gb(r),new sl(t,null,r)}{if(!(t instanceof ni||t instanceof sl))throw new $e(Ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(En.fromString(e,...n));return Gb(r),new sl(t.firestore,null,r)}}function mt(t,e,...n){if(t=Dn(t),arguments.length===1&&(e=L4.newId()),P3("doc","path",e),t instanceof Um){const r=En.fromString(e,...n);return Wb(r),new ni(t,null,new ct(r))}{if(!(t instanceof ni||t instanceof sl))throw new $e(Ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(En.fromString(e,...n));return Wb(r),new ni(t.firestore,t instanceof sl?t.converter:null,new ct(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new p3(this,"async_queue_retry"),this.Vu=()=>{const r=Yg();r&&Xe("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Yg();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Yg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Ya;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ch(e))throw e;Xe("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw ro("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=b2.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&St()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function Qb(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class so extends Um{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Yb,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Yb(e),this._firestoreClient=void 0,await e}}}function UL(t,e){const n=typeof t=="object"?t:Am(),r=typeof t=="string"?t:"(default)",i=_h(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=zv("firestore");s&&VL(i,...s)}return i}function Bm(t){if(t._terminated)throw new $e(Ie.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||BL(t),t._firestoreClient}function BL(t){var e,n,r;const i=t._freezeSettings(),s=function(l,c,u,f){return new xj(l,c,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,j3(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new LL(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Au(Ur.fromBase64String(e))}catch(n){throw new $e(Ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Au(Ur.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qm{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new $e(Ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Dr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C2{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k2{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new $e(Ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new $e(Ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Zt(this._lat,e._lat)||Zt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL=/^__.*__$/;class zL{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new yl(e,this.data,this.fieldMask,n,this.fieldTransforms):new kh(e,this.data,n,this.fieldTransforms)}}class L3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new yl(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function R3(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw St()}}class j2{constructor(e,n,r,i,s,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new j2(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Xp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(R3(this.Cu)&&qL.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class $L{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Om(e)}Qu(e,n,r,i=!1){return new j2({Cu:e,methodName:n,qu:r,path:Dr.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zm(t){const e=t._freezeSettings(),n=Om(t._databaseId);return new $L(t._databaseId,!!e.ignoreUndefinedProperties,n)}function D3(t,e,n,r,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);P2("Data must be an object, but it was:",a,r);const l=O3(r,a);let c,u;if(s.merge)c=new Wi(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const g of s.mergeFields){const y=O1(e,g,n);if(!a.contains(y))throw new $e(Ie.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);F3(f,y)||f.push(y)}c=new Wi(f),u=a.fieldTransforms.filter(g=>c.covers(g.field))}else c=null,u=a.fieldTransforms;return new zL(new _i(l),c,u)}class $m extends C2{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof $m}}function HL(t,e,n,r){const i=t.Qu(1,e,n);P2("Data must be an object, but it was:",i,r);const s=[],a=_i.empty();gc(r,(c,u)=>{const f=L2(e,c,n);u=Dn(u);const g=i.Nu(f);if(u instanceof $m)s.push(f);else{const y=Lh(u,g);y!=null&&(s.push(f),a.set(f,y))}});const l=new Wi(s);return new L3(a,l,i.fieldTransforms)}function WL(t,e,n,r,i,s){const a=t.Qu(1,e,n),l=[O1(e,r,n)],c=[i];if(s.length%2!=0)throw new $e(Ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<s.length;y+=2)l.push(O1(e,s[y])),c.push(s[y+1]);const u=[],f=_i.empty();for(let y=l.length-1;y>=0;--y)if(!F3(u,l[y])){const p=l[y];let T=c[y];T=Dn(T);const E=a.Nu(p);if(T instanceof $m)u.push(p);else{const P=Lh(T,E);P!=null&&(u.push(p),f.set(p,P))}}const g=new Wi(u);return new L3(f,g,a.fieldTransforms)}function GL(t,e,n,r=!1){return Lh(n,t.Qu(r?4:3,e))}function Lh(t,e){if(M3(t=Dn(t)))return P2("Unsupported field value:",e,t),O3(t,e);if(t instanceof C2)return function(r,i){if(!R3(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const l of r){let c=Lh(l,i.Lu(a));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),a++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Dn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Bj(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=lt.fromDate(r);return{timestampValue:Gp(i.serializer,s)}}if(r instanceof lt){const s=new lt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Gp(i.serializer,s)}}if(r instanceof k2)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Au)return{bytesValue:s3(i.serializer,r._byteString)};if(r instanceof ni){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:h2(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof I2)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return l2(l.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Vm(r)}`)}(t,e)}function O3(t,e){const n={};return R4(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):gc(t,(r,i)=>{const s=Lh(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function M3(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof lt||t instanceof k2||t instanceof Au||t instanceof ni||t instanceof C2||t instanceof I2)}function P2(t,e,n){if(!M3(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Vm(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function O1(t,e,n){if((e=Dn(e))instanceof qm)return e._internalPath;if(typeof e=="string")return L2(t,e);throw Xp("Field path arguments must be of type string or ",t,!1,void 0,n)}const KL=new RegExp("[~\\*/\\[\\]]");function L2(t,e,n){if(e.search(KL)>=0)throw Xp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new qm(...e.split("."))._internalPath}catch{throw Xp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Xp(t,e,n,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(s||a)&&(c+=" (found",s&&(c+=` in field ${r}`),a&&(c+=` in document ${i}`),c+=")"),new $e(Ie.INVALID_ARGUMENT,l+t+c)}function F3(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V3{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ni(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new YL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Hm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class YL extends V3{data(){return super.data()}}function Hm(t,e){return typeof e=="string"?L2(t,e):e instanceof qm?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U3(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new $e(Ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class R2{}class D2 extends R2{}function or(t,e,...n){let r=[];e instanceof R2&&r.push(e),r=r.concat(n),function(s){const a=s.filter(c=>c instanceof O2).length,l=s.filter(c=>c instanceof Wm).length;if(a>1||a>0&&l>0)throw new $e(Ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Wm extends D2{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Wm(e,n,r)}_apply(e){const n=this._parse(e);return q3(e._query,n),new co(e.firestore,e.converter,T1(e._query,n))}_parse(e){const n=zm(e.firestore);return function(s,a,l,c,u,f,g){let y;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new $e(Ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Jb(g,f);const p=[];for(const T of g)p.push(Xb(c,s,T));y={arrayValue:{values:p}}}else y=Xb(c,s,g)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Jb(g,f),y=GL(l,a,g,f==="in"||f==="not-in");return dr.create(u,f,y)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Or(t,e,n){const r=e,i=Hm("where",t);return Wm._create(i,r,n)}class O2 extends R2{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new O2(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Os.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let a=i;const l=s.getFlattenedFilters();for(const c of l)q3(a,c),a=T1(a,c)}(e._query,n),new co(e.firestore,e.converter,T1(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class M2 extends D2{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new M2(e,n)}_apply(e){const n=function(i,s,a){if(i.startAt!==null)throw new $e(Ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new $e(Ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ch(s,a)}(e._query,this._field,this._direction);return new co(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new ju(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function Rh(t,e="asc"){const n=e,r=Hm("orderBy",t);return M2._create(r,n)}class F2 extends D2{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new F2(e,n,r)}_apply(e){return new co(e.firestore,e.converter,$p(e._query,this._limit,this._limitType))}}function B3(t){return F2._create("limit",t,"F")}function Xb(t,e,n){if(typeof(n=Dn(n))=="string"){if(n==="")throw new $e(Ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!z4(e)&&n.indexOf("/")!==-1)throw new $e(Ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(En.fromString(n));if(!ct.isDocumentKey(r))throw new $e(Ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return yb(t,new ct(r))}if(n instanceof ni)return yb(t,n._key);throw new $e(Ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vm(n)}.`)}function Jb(t,e){if(!Array.isArray(t)||t.length===0)throw new $e(Ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function q3(t,e){const n=function(i,s){for(const a of i)for(const l of a.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new $e(Ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new $e(Ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class QL{convertValue(e,n="none"){switch(cc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(lc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw St()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return gc(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>nr(a.doubleValue));return new I2(s)}convertGeoPoint(e){return new k2(nr(e.latitude),nr(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=i2(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ah(e));default:return null}}convertTimestamp(e){const n=dl(e);return new lt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=En.fromString(e);fn(d3(r));const i=new oh(r.get(1),r.get(3)),s=new ct(r.popFirst(5));return i.isEqual(n)||ro(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z3(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $3 extends V3{constructor(e,n,r,i,s,a){super(e,n,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new tp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Hm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class tp extends $3{data(e={}){return super.data(e)}}class H3{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Nd(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new tp(this._firestore,this._userDataWriter,r.key,r,new Nd(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new $e(Ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(l=>{const c=new tp(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Nd(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const c=new tp(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Nd(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return l.type!==0&&(u=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),f=a.indexOf(l.doc.key)),{type:XL(l.type),doc:c,oldIndex:u,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function XL(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return St()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xl(t){t=Ti(t,ni);const e=Ti(t.firestore,so);return OL(Bm(e),t._key).then(n=>W3(e,t,n))}class V2 extends QL{constructor(e){super(),this.firestore=e}convertBytes(e){return new Au(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ni(this.firestore,null,n)}}function ga(t){t=Ti(t,co);const e=Ti(t.firestore,so),n=Bm(e),r=new V2(e);return U3(t._query),ML(n,t._query).then(i=>new H3(e,r,t,i))}function va(t,e,n){t=Ti(t,ni);const r=Ti(t.firestore,so),i=z3(t.converter,e,n);return Gm(r,[D3(zm(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,fs.none())])}function hr(t,e,n,...r){t=Ti(t,ni);const i=Ti(t.firestore,so),s=zm(i);let a;return a=typeof(e=Dn(e))=="string"||e instanceof qm?WL(s,"updateDoc",t._key,e,n,r):HL(s,"updateDoc",t._key,e),Gm(i,[a.toMutation(t._key,fs.exists(!0))])}function Su(t){return Gm(Ti(t.firestore,so),[new c2(t._key,fs.none())])}function ao(t,e){const n=Ti(t.firestore,so),r=mt(t),i=z3(t.converter,e);return Gm(n,[D3(zm(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,fs.exists(!1))]).then(()=>r)}function nn(t,...e){var n,r,i;t=Dn(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||Qb(e[a])||(s=e[a],a++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Qb(e[a])){const g=e[a];e[a]=(n=g.next)===null||n===void 0?void 0:n.bind(g),e[a+1]=(r=g.error)===null||r===void 0?void 0:r.bind(g),e[a+2]=(i=g.complete)===null||i===void 0?void 0:i.bind(g)}let c,u,f;if(t instanceof ni)u=Ti(t.firestore,so),f=Im(t._key.path),c={next:g=>{e[a]&&e[a](W3(u,t,g))},error:e[a+1],complete:e[a+2]};else{const g=Ti(t,co);u=Ti(g.firestore,so),f=g._query;const y=new V2(u);c={next:p=>{e[a]&&e[a](new H3(u,y,g,p))},error:e[a+1],complete:e[a+2]},U3(t._query)}return function(y,p,T,E){const P=new T2(E),A=new S2(p,P,T);return y.asyncQueue.enqueueAndForget(async()=>_2(await Qp(y),A)),()=>{P.Za(),y.asyncQueue.enqueueAndForget(async()=>N2(await Qp(y),A))}}(Bm(u),f,l,c)}function Gm(t,e){return function(r,i){const s=new Ya;return r.asyncQueue.enqueueAndForget(async()=>SL(await DL(r),i,s)),s.promise}(Bm(t),e)}function W3(t,e,n){const r=n.docs.get(e._key),i=new V2(t);return new $3(t,i,e._key,r,new Nd(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(i){Iu=i})(pc),cl(new eo("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),l=new so(new ij(r.getProvider("auth-internal")),new lj(r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new $e(Ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new oh(u.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:n},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),hs(fb,"4.7.3",e),hs(fb,"4.7.3","esm2017")})();var JL="firebase",ZL="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hs(JL,ZL,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G3="firebasestorage.googleapis.com",eR="storageBucket",tR=2*60*1e3,nR=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa extends xa{constructor(e,n,r=0){super(Xg(e),`Firebase Storage: ${n} (${Xg(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,wa.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Xg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ya;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ya||(ya={}));function Xg(t){return"storage/"+t}function rR(){const t="An unknown error occurred, please check the error payload for server response.";return new wa(ya.UNKNOWN,t)}function iR(){return new wa(ya.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function sR(){return new wa(ya.CANCELED,"User canceled the upload/download.")}function aR(t){return new wa(ya.INVALID_URL,"Invalid URL '"+t+"'.")}function oR(t){return new wa(ya.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Zb(t){return new wa(ya.INVALID_ARGUMENT,t)}function K3(){return new wa(ya.APP_DELETED,"The Firebase app was deleted.")}function lR(t){return new wa(ya.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=js.makeFromUrl(e,n)}catch{return new js(e,"")}if(r.path==="")return r;throw oR(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(F){F.path.charAt(F.path.length-1)==="/"&&(F.path_=F.path_.slice(0,-1))}const a="(/(.*))?$",l=new RegExp("^gs://"+i+a,"i"),c={bucket:1,path:3};function u(F){F.path_=decodeURIComponent(F.path)}const f="v[A-Za-z0-9_]+",g=n.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",p=new RegExp(`^https?://${g}/${f}/b/${i}/o${y}`,"i"),T={bucket:1,path:3},E=n===G3?"(?:storage.googleapis.com|storage.cloud.google.com)":n,P="([^?#]*)",A=new RegExp(`^https?://${E}/${i}/${P}`,"i"),M=[{regex:l,indices:c,postModify:s},{regex:p,indices:T,postModify:u},{regex:A,indices:{bucket:1,path:2},postModify:u}];for(let F=0;F<M.length;F++){const te=M[F],ae=te.regex.exec(e);if(ae){const B=ae[te.indices.bucket];let I=ae[te.indices.path];I||(I=""),r=new js(B,I),te.postModify(r);break}}if(r==null)throw aR(e);return r}}class cR{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uR(t,e,n){let r=1,i=null,s=null,a=!1,l=0;function c(){return l===2}let u=!1;function f(...P){u||(u=!0,e.apply(null,P))}function g(P){i=setTimeout(()=>{i=null,t(p,c())},P)}function y(){s&&clearTimeout(s)}function p(P,...A){if(u){y();return}if(P){y(),f.call(null,P,...A);return}if(c()||a){y(),f.call(null,P,...A);return}r<64&&(r*=2);let M;l===1?(l=2,M=0):M=(r+Math.random())*1e3,g(M)}let T=!1;function E(P){T||(T=!0,y(),!u&&(i!==null?(P||(l=2),clearTimeout(i),g(0)):P||(l=1)))}return g(0),s=setTimeout(()=>{a=!0,E(!0)},n),E}function dR(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hR(t){return t!==void 0}function e5(t,e,n,r){if(r<e)throw Zb(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Zb(`Invalid value for '${t}'. Expected ${n} or less.`)}function fR(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var Jp;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Jp||(Jp={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pR(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{constructor(e,n,r,i,s,a,l,c,u,f,g,y=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=f,this.connectionFactory_=g,this.retry=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,T)=>{this.resolve_=p,this.reject_=T,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Sf(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const l=s.getErrorCode()===Jp.NO_ERROR,c=s.getStatus();if(!l||pR(c,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===Jp.ABORT;r(!1,new Sf(!1,null,f));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new Sf(u,s))})},n=(r,i)=>{const s=this.resolve_,a=this.reject_,l=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());hR(c)?s(c):s()}catch(c){a(c)}else if(l!==null){const c=rR();c.serverResponse=l.getErrorText(),this.errorCallback_?a(this.errorCallback_(l,c)):a(c)}else if(i.canceled){const c=this.appDelete_?K3():sR();a(c)}else{const c=iR();a(c)}};this.canceled_?n(!1,new Sf(!1,null,!0)):this.backoffId_=uR(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&dR(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Sf{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function gR(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function vR(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function yR(t,e){e&&(t["X-Firebase-GMPID"]=e)}function xR(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function bR(t,e,n,r,i,s,a=!0){const l=fR(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return yR(u,e),gR(u,n),vR(u,s),xR(u,r),new mR(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wR(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function _R(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp{constructor(e,n){this._service=e,n instanceof js?this._location=n:this._location=js.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Zp(e,n)}get root(){const e=new js(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return _R(this._location.path)}get storage(){return this._service}get parent(){const e=wR(this._location.path);if(e===null)return null;const n=new js(this._location.bucket,e);return new Zp(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw lR(e)}}function t5(t,e){const n=e==null?void 0:e[eR];return n==null?null:js.makeFromBucketSpec(n,t)}function NR(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:VN(i,t.app.options.projectId))}class AR{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=G3,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=tR,this._maxUploadRetryTime=nR,this._requests=new Set,i!=null?this._bucket=js.makeFromBucketSpec(i,this._host):this._bucket=t5(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=js.makeFromBucketSpec(this._url,e):this._bucket=t5(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){e5("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){e5("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Zp(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new cR(K3());{const a=bR(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const n5="@firebase/storage",r5="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y3="storage";function SR(t=Am(),e){t=Dn(t);const r=_h(t,Y3).getImmediate({identifier:e}),i=zv("storage");return i&&ER(r,...i),r}function ER(t,e,n,r={}){NR(t,e,n,r)}function TR(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new AR(n,r,i,e,pc)}function CR(){cl(new eo(Y3,TR,"PUBLIC").setMultipleInstances(!0)),hs(n5,r5,""),hs(n5,r5,"esm2017")}CR();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q3="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||n.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1="us-central1";class IR{constructor(e,n,r,i,s=M1,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new kR(n,r,i),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(s);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=M1}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function jR(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const i5="@firebase/functions",s5="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PR="auth-internal",LR="app-check-internal",RR="messaging-internal";function DR(t,e){const n=(r,{instanceIdentifier:i})=>{const s=r.getProvider("app").getImmediate(),a=r.getProvider(PR),l=r.getProvider(RR),c=r.getProvider(LR);return new IR(s,a,l,c,i,t)};cl(new eo(Q3,n,"PUBLIC").setMultipleInstances(!0)),hs(i5,s5,e),hs(i5,s5,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OR(t=Am(),e=M1){const r=_h(Dn(t),Q3).getImmediate({identifier:e}),i=zv("functions");return i&&MR(r,...i),r}function MR(t,e,n){jR(Dn(t),e,n)}DR(fetch.bind(self));const FR={apiKey:"AIzaSyB1ddVOczgt5n2NkoIq3H_5x_eB0Aqw2HI",authDomain:"alojamientos-3c46b.firebaseapp.com",projectId:"alojamientos-3c46b",storageBucket:"alojamientos-3c46b.appspot.com",messagingSenderId:"858434059981",appId:"1:858434059981:web:f235cea133b874f985b384"},Be="alojamientos-3c46b",Km=qN(FR),yr=ej(Km),qe=UL(Km);SR(Km);OR(Km);const X3=async()=>{console.log("🔍 DIAGNÓSTICO COMPLETO DE FIREBASE"),console.log("=====================================");try{console.log("📱 App ID:",Be),console.log(`
📁 Verificando estructura de base de datos...`);const t=Ht(qe,"artifacts",Be,"public","data","users");console.log("👥 Ruta de usuarios:",`artifacts/${Be}/public/data/users`);try{const e=await ga(t);if(console.log("👥 Total de usuarios encontrados:",e.size),e.empty)return console.log("❌ No hay usuarios en la colección"),{hasUsers:!1,users:[]};const n=[];e.docs.forEach((s,a)=>{const l=s.data(),c={id:s.id,email:l.email||"Sin email",role:l.role||"Sin rol",status:l.status||"Sin estado",createdAt:l.createdAt||"Sin fecha",fullName:l.fullName||"Sin nombre"};n.push(c),console.log(`👤 Usuario ${a+1}:`,c)}),console.log(`
🏢 Verificando configuración de empresa...`);const r=mt(qe,"artifacts",Be,"public","data","settings","company_info"),i=await Xl(r);i.exists()?(console.log("✅ Configuración de empresa encontrada"),console.log("📋 Configuración:",i.data())):console.log("❌ No hay configuración de empresa"),console.log(`
🔐 Verificando permisos...`);try{const s=or(t,B3(1));await ga(s),console.log("✅ Permisos de lectura OK")}catch(s){console.error("❌ Error de permisos:",s)}return{hasUsers:!0,users:n,hasSettings:i.exists(),settings:i.exists()?i.data():null}}catch(e){return console.error("❌ Error accediendo a usuarios:",e),{hasUsers:!1,error:e.message}}}catch(t){return console.error("❌ Error en diagnóstico:",t),{hasUsers:!1,error:t.message}}},VR=async()=>{try{console.log("🔍 Buscando usuario más antiguo...");const t=Ht(qe,"artifacts",Be,"public","data","users");try{const i=or(t,Rh("createdAt","asc"),B3(1)),s=await ga(i);if(!s.empty){const a=s.docs[0],l=a.data();return console.log("👑 Usuario más antiguo (con ordenamiento):",{id:a.id,email:l.email,role:l.role,createdAt:l.createdAt}),{user:a,data:l}}}catch(i){console.warn("⚠️ Error con ordenamiento, usando método alternativo:",i)}const e=await ga(t);if(e.empty)return console.log("❌ No hay usuarios"),null;let n=null,r=null;return e.docs.forEach(i=>{const s=i.data(),a=s.createdAt;a&&(!r||a<r)&&(r=a,n={user:i,data:s})}),n?console.log("👑 Usuario más antiguo (método alternativo):",{id:n.user.id,email:n.data.email,role:n.data.role,createdAt:n.data.createdAt}):console.log("❌ No se pudo determinar el usuario más antiguo"),n}catch(t){return console.error("❌ Error buscando usuario más antiguo:",t),null}},UR=async()=>{try{console.log("🔐 Verificando usuarios en Authentication...");const t=yr.currentUser;return t?(console.log("✅ Usuario autenticado encontrado:",t.email),!0):(console.log("⚠️ No hay usuario autenticado, pero asumiendo que hay usuarios en el sistema"),!0)}catch(t){return console.error("❌ Error verificando Authentication:",t),!1}},J3=fe.createContext();function BR({message:t,type:e,onClose:n}){const r=e==="success"?"bg-green-500":"bg-red-500";return fe.useEffect(()=>{const i=setTimeout(n,4e3);return()=>clearTimeout(i)},[n]),o.jsx("div",{className:`fixed top-5 right-5 ${r} text-white py-2 px-4 rounded-lg shadow-lg animate-fade-in-down`,children:t})}function qR({children:t}){const[e,n]=fe.useState([]),r=(s,a="success")=>{const l=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;n(c=>[...c,{id:l,message:s,type:a}])},i=s=>{n(a=>a.filter(l=>l.id!==s))};return o.jsxs(J3.Provider,{value:{addNotification:r},children:[t,o.jsx("div",{className:"fixed top-5 right-5 z-50 space-y-2",children:e.map(s=>o.jsx(BR,{message:s.message,type:s.type,onClose:()=>i(s.id)},s.id))})]})}const kn=()=>fe.useContext(J3),Dh=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),Z3=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),zR=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),$R=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M15 21a6 6 0 00-9-5.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-3-5.197m0 0A4 4 0 0112 4.354a4 4 0 013 3.249m-3 7.586a4 4 0 01-3-3.25"})}),em=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),np=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),eA=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h7"})}),Ym=()=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),Jl=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),HR=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),WR=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})}),Ru=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})}),GR=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),KR=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-5 5v-5zM4.828 7l2.586 2.586a2 2 0 002.828 0L12 7H4.828zM4.828 17h5l-5-5v5zM12 7l2.586 2.586a2 2 0 002.828 0L20 7h-8z"})}),Yi=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),su=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"})}),tA=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),tm=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),al=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),nA=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),cs=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),fl=()=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),hh=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),nm=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),YR=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),QR=()=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})});function Oh({children:t}){const[e,n]=fe.useState(!1),[r,i]=fe.useState({top:0,left:0,position:"bottom-right"}),s=fe.useRef(null),a=fe.useRef(null);fe.useEffect(()=>{const c=u=>{s.current&&!s.current.contains(u.target)&&n(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[s]),fe.useEffect(()=>{if(e&&a.current){const c=a.current.getBoundingClientRect(),u=window.innerHeight,f=window.innerWidth,g=u-c.bottom,y=c.top,p=f-c.right,T=c.left;let E=c.bottom+8,P=c.right-224,A="bottom-right";g<200&&y>g&&(E=c.top-8,A=p>224?"top-right":"top-left"),p<224&&T>224&&(P=c.left-224,A=g>200?"bottom-left":"top-left"),P<8&&(P=8),P+224>f-8&&(P=f-232),E<8&&(E=8),E+200>u-8&&(E=u-208),i({top:E,left:P,position:A})}},[e]);const l=()=>"fixed w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50";return o.jsxs("div",{className:"relative inline-block text-left",ref:s,children:[o.jsxs("button",{ref:a,onClick:()=>n(!e),className:"inline-flex justify-center w-full rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:["Acciones ",o.jsx(WR,{className:"-mr-1 ml-2 h-5 w-5"})]}),e&&o.jsx("div",{className:l(),style:{top:`${r.top}px`,left:`${r.left}px`},children:o.jsx("div",{className:"py-1",role:"menu","aria-orientation":"vertical",onClick:()=>n(!1),children:t})})]})}function XR({isOpen:t,onClose:e,onSave:n,service:r,clients:i,isDemo:s}){var H;const{addNotification:a}=kn(),[l,c]=fe.useState({}),[u,f]=fe.useState(""),[g,y]=fe.useState(""),[p,T]=fe.useState(""),[E,P]=fe.useState(!1),[A,L]=fe.useState(""),[M,F]=fe.useState(!1),te=["Activo","Periodo de Gracia Vencido","Pendiente Pago","Pago","Cancelado"],ae=()=>{const D=new Date,W=D.getFullYear().toString().slice(-2),K=(D.getMonth()+1).toString().padStart(2,"0"),q=D.getDate().toString().padStart(2,"0"),ee=D.getTime().toString().slice(-6);return`SRV-${W}${K}${q}-${ee}`},B=(D,W)=>{if(!D||D==="One-Time"||!W)return{startDate:"",endDate:""};const K=new Date(W);let q=new Date(K);switch(D){case"Monthly":q.setMonth(q.getMonth()+1);break;case"Semiannually":q.setMonth(q.getMonth()+6);break;case"Annually":q.setFullYear(q.getFullYear()+1);break;case"Biennially":q.setFullYear(q.getFullYear()+2);break;case"Triennially":q.setFullYear(q.getFullYear()+3);break;case"Custom":return{startDate:K.toISOString().split("T")[0],endDate:""};default:if(D&&D!=="Custom"&&D!=="One-Time"){const ee=D.match(/(\d+)\s*mes/i),ue=D.match(/(\d+)\s*año/i);if(ee){const ce=parseInt(ee[1]);q.setMonth(q.getMonth()+ce)}else if(ue){const ce=parseInt(ue[1]);q.setFullYear(q.getFullYear()+ce)}else return{startDate:K.toISOString().split("T")[0],endDate:""}}else return{startDate:"",endDate:""};break}return{startDate:K.toISOString().split("T")[0],endDate:q.toISOString().split("T")[0]}},I=()=>[{value:"One-Time",label:"Pago único"},{value:"Monthly",label:"Mensual"},{value:"Semiannually",label:"Semestral"},{value:"Annually",label:"Anual"},{value:"Biennially",label:"Bianual (2 años)"},{value:"Triennially",label:"Trienal (3 años)"},{value:"Custom",label:"Otros"}];fe.useEffect(()=>{const D={clientName:"",clientEmail:"",serviceType:"Hosting",description:"",amount:"",currency:"USD",dueDate:"",billingCycle:"One-Time",status:"Activo",clientNotes:"",adminNotes:"",assignedUserId:""};if(r){c({...r,dueDate:r.dueDate?new Date(r.dueDate.seconds*1e3).toISOString().split("T")[0]:"",assignedUserId:r.assignedUserId||""}),y(r.serviceNumber||"");const W=["Hosting","Dominio","Dominio + Hosting"];r.serviceType&&!W.includes(r.serviceType)?(L(r.serviceType),F(!0)):(L(""),F(!1));const K=["One-Time","Monthly","Semiannually","Annually","Biennially","Triennially"];if(r.billingCycle&&!K.includes(r.billingCycle)?(T(r.billingCycle),P(!0)):(T(""),P(!1)),r.assignedUserId){const q=i.find(ee=>ee.id===r.assignedUserId);q&&f(q.email)}}else{const W=ae();c(D),f(""),y(W),L(""),F(!1),T(""),P(!1)}},[r,i]);const j=D=>{const{name:W,value:K}=D.target;c(q=>({...q,[W]:K})),W==="billingCycle"&&(K==="Custom"?P(!0):(P(!1),T(""))),W==="serviceType"&&(K==="Otro"?F(!0):(F(!1),L("")))},S=D=>{const W=D.target.value;T(W),c(K=>({...K,billingCycle:W||"Custom"}))},N=D=>{const W=D.target.value;L(W),c(K=>({...K,serviceType:W||"Otro"}))},w=D=>{f(D);const W=i.find(K=>K.email===D);c(W?K=>({...K,clientEmail:W.email,clientName:W.fullName||W.email.split("@")[0],assignedUserId:W.id}):K=>({...K,assignedUserId:""}))},k=async D=>{if(D.preventDefault(),s){a("Función no disponible en modo demo.","error");return}try{const W={...l,amount:parseFloat(l.amount),dueDate:lt.fromDate(new Date(l.dueDate)),serviceNumber:g};await n(W),a(`Servicio ${r?"actualizado":"creado"} exitosamente.`,"success"),e()}catch(W){a("Error al guardar el servicio.","error"),console.error(W)}};return t?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:r?"Editar Servicio":"Añadir Nuevo Servicio"}),o.jsxs("form",{onSubmit:k,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Número de Servicio"}),o.jsx("input",{type:"text",value:g,onChange:D=>y(D.target.value),className:"w-full p-2 border rounded-md bg-gray-50 font-mono",placeholder:"SRV-YYMMDD-XXXXXX",required:!0}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Identificador único del servicio"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asignar a Cliente Existente"}),o.jsxs("select",{value:u,onChange:D=>w(D.target.value),className:"w-full p-2 border rounded-md bg-gray-50",children:[o.jsx("option",{value:"",children:"-- Opcional --"}),i.map(D=>o.jsx("option",{value:D.email,children:D.fullName||D.email},D.id))]}),u&&o.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["✓ Servicio asignado a: ",((H=i.find(D=>D.email===u))==null?void 0:H.fullName)||u]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx("input",{name:"clientName",value:l.clientName||"",onChange:j,placeholder:"Nombre del Cliente",className:"w-full p-2 border rounded-md",required:!0}),o.jsx("input",{name:"clientEmail",type:"email",value:l.clientEmail||"",onChange:j,placeholder:"Email del Cliente",className:"w-full p-2 border rounded-md",required:!0})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Servicio"}),o.jsxs("select",{name:"serviceType",value:l.serviceType||"Hosting",onChange:j,className:"w-full p-2 border rounded-md",children:[o.jsx("option",{children:"Hosting"}),o.jsx("option",{children:"Dominio"}),o.jsx("option",{children:"Dominio + Hosting"}),o.jsx("option",{children:"Otro"})]}),M&&o.jsxs("div",{className:"mt-2",children:[o.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Especificar tipo de servicio personalizado"}),o.jsx("input",{type:"text",value:A,onChange:N,placeholder:"Ej: VPS, Cloud Storage, SSL, etc.",className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Escribe el tipo de servicio específico que ofreces"})]})]}),o.jsx("input",{name:"description",value:l.description||"",onChange:j,placeholder:"Descripción (ej: plan, dominio.com)",className:"w-full p-2 border rounded-md"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("input",{name:"amount",type:"number",step:"0.01",value:l.amount||"",onChange:j,placeholder:"Monto",className:"w-full p-2 border rounded-md",required:!0}),o.jsxs("select",{name:"currency",value:l.currency||"USD",onChange:j,className:"w-full p-2 border rounded-md",children:[o.jsx("option",{children:"USD"}),o.jsx("option",{children:"COP"})]}),o.jsx("input",{name:"dueDate",type:"date",value:l.dueDate||"",onChange:j,className:"w-full p-2 border rounded-md",required:!0})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ciclo de Facturación"}),o.jsx("select",{name:"billingCycle",value:l.billingCycle||"One-Time",onChange:j,className:"w-full p-2 border rounded-md",children:I().map(D=>o.jsx("option",{value:D.value,children:D.label},D.value))}),E&&o.jsxs("div",{className:"mt-2",children:[o.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Especificar ciclo personalizado"}),o.jsx("input",{type:"text",value:p,onChange:S,placeholder:"Ej: 6 meses, 18 meses, 2 años, etc.",className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Puedes escribir el período en meses o años (ej: "6 meses", "2 años")'})]})]}),o.jsx("select",{name:"status",value:l.status||"Activo",onChange:j,className:"w-full p-2 border rounded-md",children:te.map(D=>o.jsx("option",{value:D,children:D},D))})]}),l.billingCycle&&l.billingCycle!=="One-Time"&&l.dueDate&&o.jsxs("div",{className:"bg-blue-50 p-4 rounded-md",children:[o.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Período del Servicio"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-blue-700 mb-1",children:"Fecha de Inicio"}),o.jsx("input",{type:"date",value:B(l.billingCycle,l.dueDate).startDate,readOnly:!0,className:"w-full p-2 border border-blue-200 rounded-md bg-blue-50 text-blue-800"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-blue-700 mb-1",children:"Fecha de Vencimiento"}),o.jsx("input",{type:"date",value:B(l.billingCycle,l.dueDate).endDate,readOnly:!0,className:"w-full p-2 border border-blue-200 rounded-md bg-blue-50 text-blue-800"})]})]})]}),l.billingCycle==="One-Time"&&o.jsxs("div",{className:"bg-yellow-50 p-4 rounded-md",children:[o.jsx("h4",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Pago Único"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"radio",id:"activation-only",name:"oneTimeType",value:"activation-only",className:"text-yellow-600"}),o.jsx("label",{htmlFor:"activation-only",className:"text-sm text-yellow-700",children:"Solo fecha de activación (sin expiración)"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"radio",id:"with-expiration",name:"oneTimeType",value:"with-expiration",className:"text-yellow-600"}),o.jsx("label",{htmlFor:"with-expiration",className:"text-sm text-yellow-700",children:"Con fecha de expiración"})]}),o.jsxs("div",{className:"ml-6",children:[o.jsx("label",{className:"block text-xs font-medium text-yellow-700 mb-1",children:"Hasta qué fecha expira"}),o.jsx("input",{type:"date",name:"expirationDate",value:l.expirationDate||"",onChange:j,className:"w-full p-2 border border-yellow-200 rounded-md"})]})]})]}),o.jsx("textarea",{name:"clientNotes",value:l.clientNotes||"",onChange:j,placeholder:"Notas para el cliente (visible en su portal)",rows:"3",className:"w-full p-2 border rounded-md"}),o.jsx("textarea",{name:"adminNotes",value:l.adminNotes||"",onChange:j,placeholder:"Notas internas (solo para administrador)",rows:"3",className:"w-full p-2 border rounded-md"}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[o.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Guardar Servicio"})]})]})]})}):null}function JR({isOpen:t,onClose:e,onSend:n,service:r,templates:i,companySettings:s,isDemo:a}){const{addNotification:l}=kn(),[c,u]=fe.useState(""),[f,g]=fe.useState(""),[y,p]=fe.useState("");if(fe.useEffect(()=>{var E;i.length>0&&t&&u(((E=i[0])==null?void 0:E.id)||"")},[i,t]),fe.useEffect(()=>{var E;if(c&&r){const P=i.find(A=>A.id===c);if(P){const A=r.dueDate?new Date(r.dueDate.seconds*1e3).toLocaleDateString():"N/A",L={"{clientName}":r.clientName||"","{serviceType}":r.serviceType||"","{description}":r.description||"","{amount}":`$${(E=r.amount)==null?void 0:E.toFixed(2)} ${r.currency}`||"","{dueDate}":A,"{companyName}":s.companyName||"Tu Empresa"};let M=P.subject,F=P.body;for(const te in L){const ae=new RegExp(te.replace(/[-\\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g");M=M.replace(ae,L[te]),F=F.replace(ae,L[te])}g(M),p(F)}}},[c,r,i,s]),!t)return null;const T=()=>{var E;n({to:r.clientEmail,subject:f,body:y,reason:`Notificación Manual: ${((E=i.find(P=>P.id===c))==null?void 0:E.name)||"Mensaje Personalizado"}`}),e()};return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full",children:[o.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Enviar Notificación a ",r.clientName]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Seleccionar Plantilla"}),o.jsx("select",{value:c,onChange:E=>u(E.target.value),className:"mt-1 w-full p-2 border rounded-md",children:i.map(E=>o.jsx("option",{value:E.id,children:E.name},E.id))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Asunto"}),o.jsx("input",{type:"text",value:f,onChange:E=>g(E.target.value),className:"mt-1 w-full p-2 border rounded-md"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cuerpo del Mensaje (Editable)"}),o.jsx("textarea",{value:y,onChange:E=>p(E.target.value),rows:"10",className:"mt-1 w-full p-2 border rounded-md font-mono text-sm"})]})]}),o.jsxs("div",{className:"flex justify-end gap-4 mt-8",children:[o.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),o.jsx("button",{onClick:T,className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Enviar"})]})]})})}function ZR({isDemo:t,userRole:e}){const{addNotification:n}=kn(),[r,i]=fe.useState([]),[s,a]=fe.useState([]),[l,c]=fe.useState(!1),[u,f]=fe.useState(null),[g,y]=fe.useState("Todos"),[p,T]=fe.useState(""),[E,P]=fe.useState(!1),[A,L]=fe.useState([]),[M,F]=fe.useState({}),te=["Activo","Periodo de Gracia Vencido","Pendiente Pago","Pago","Cancelado"];fe.useEffect(()=>{if(t){const Z=lt.fromDate(new Date);i([{id:"s1",clientName:"Juan Perez (Demo)",clientEmail:"juan@demo.com",serviceType:"Hosting",description:"Plan Pro",amount:25,currency:"USD",dueDate:Z,billingCycle:"Monthly",status:"Pendiente Pago",clientNotes:"A la espera del pago.",adminNotes:"Contactado por teléfono."},{id:"s2",clientName:"Maria Garcia (Demo)",clientEmail:"maria@demo.com",serviceType:"Dominio",description:"nuevositio.co",amount:5e4,currency:"COP",dueDate:Z,billingCycle:"Annually",status:"Pago",clientNotes:"",adminNotes:""},{id:"s3",clientName:"Carlos Lopez (Demo)",clientEmail:"carlos@demo.com",serviceType:"Mantenimiento",description:"Sitio Web",amount:150,currency:"USD",dueDate:Z,billingCycle:"Monthly",status:"Activo",clientNotes:"Servicio funcionando correctamente.",adminNotes:"Cliente satisfecho."},{id:"s4",clientName:"Ana Rodriguez (Demo)",clientEmail:"ana@demo.com",serviceType:"Hosting",description:"Plan Básico",amount:15,currency:"USD",dueDate:Z,billingCycle:"Monthly",status:"Periodo de Gracia Vencido",clientNotes:"Necesita renovar pronto.",adminNotes:"Enviar recordatorio urgente."},{id:"s5",clientName:"Pedro Martinez (Demo)",clientEmail:"pedro@demo.com",serviceType:"Dominio",description:"tiendaonline.com",amount:12e4,currency:"COP",dueDate:Z,billingCycle:"Annually",status:"Cancelado",clientNotes:"Cliente canceló el servicio.",adminNotes:"Cancelación por solicitud del cliente."}]),a([{id:"c1",email:"juan@demo.com",fullName:"Juan Perez (Demo)"},{id:"c2",email:"maria@demo.com",fullName:"Maria Garcia (Demo)"}]),L([{id:"t1",name:"Recordatorio General (Demo)",subject:"Recordatorio de pago",body:"Hola {clientName}, recuerda pagar..."}]),F({companyName:"Tu Empresa (Demo)"});return}const W=Ht(qe,"artifacts",Be,"public","data","services"),K=or(W,Rh("dueDate","desc")),q=nn(K,Z=>{i(Z.docs.map(le=>({id:le.id,...le.data()})))}),ee=Ht(qe,"artifacts",Be,"public","data","users"),ue=or(ee,Or("role","==","client")),ce=nn(ue,Z=>{a(Z.docs.map(le=>({id:le.id,...le.data()})))}),_=Ht(qe,"artifacts",Be,"public","data","messageTemplates"),z=nn(_,Z=>{L(Z.docs.map(le=>({id:le.id,...le.data()})))}),O=mt(qe,"artifacts",Be,"public","data","settings","company"),X=nn(O,Z=>{Z.exists()&&F(Z.data())});return()=>{q(),ce(),z(),X()}},[t]);const ae=async W=>{if(t){n("Función no disponible en modo demo.","error");return}const K=Ht(qe,"artifacts",Be,"public","data","services");try{if(W.id){const{id:q,...ee}=W;await hr(mt(K,q),ee)}else await ao(K,{...W,createdAt:lt.now()})}catch(q){throw q}},B=async W=>{if(t){n("Función no disponible en modo demo.","error");return}if(window.confirm("¿Seguro que quieres eliminar este servicio?"))try{await Su(mt(qe,"artifacts",Be,"public","data","services",W)),n("Servicio eliminado.","success")}catch{n("Error al eliminar el servicio.","error")}},I=async W=>{if(t){n(`Simulación: Enviando correo a ${W.to}.`,"success");return}try{await ao(Ht(qe,"artifacts",Be,"public","data","messageHistory"),{...W,sentAt:lt.now()}),n("Notificación registrada en el historial.","success")}catch{n("Error al registrar la notificación.","error")}},j=async(W,K)=>{if(t){n("Función no disponible en modo demo.","error");return}try{await hr(mt(qe,"artifacts",Be,"public","data","services",W),{status:K}),n("Estado actualizado.","success")}catch{n("Error al actualizar estado.","error")}},S=W=>W.status==="Pendiente Pago"&&W.dueDate&&W.dueDate.toDate()<new Date?"Periodo de Gracia Vencido":W.status,N=(W,K)=>{if(!K)return"text-gray-500";const q=new Date,ue=(K.toDate()-q)/(1e3*60*60*24);return W==="Pago"?"text-green-600":W==="Cancelado"?"text-gray-500":W==="Periodo de Gracia Vencido"||ue<0?"text-red-600 font-bold":W==="Pendiente Pago"&&ue<7?"text-yellow-600 font-semibold":W==="Activo"?"text-blue-600":"text-gray-700"},w=W=>{if(!W.dueDate||!W.billingCycle||W.billingCycle==="One-Time")return W.expirationDate?W.expirationDate.toDate().toLocaleDateString():"N/A";const K=W.dueDate.toDate();let q=new Date(K);switch(W.billingCycle){case"Monthly":q.setMonth(q.getMonth()+1);break;case"Semiannually":q.setMonth(q.getMonth()+6);break;case"Annually":q.setFullYear(q.getFullYear()+1);break;case"Biennially":q.setFullYear(q.getFullYear()+2);break;case"Triennially":q.setFullYear(q.getFullYear()+3);break;default:return"N/A"}return q.toLocaleDateString()},k=W=>({"One-Time":"Pago único",Monthly:"Mensual",Semiannually:"Semestral",Annually:"Anual",Biennially:"Bianual",Triennially:"Trienal",Custom:"Personalizado"})[W]||W,H=W=>{f(W),P(!0)},D=r.filter(W=>g==="Todos"||S(W)===g).filter(W=>{var ee,ue,ce,_,z,O,X,Z,le,me;if(!p)return!0;const K=p.toLowerCase(),q=S(W);return((ee=W.clientName)==null?void 0:ee.toLowerCase().includes(K))||((ue=W.clientEmail)==null?void 0:ue.toLowerCase().includes(K))||((ce=W.serviceType)==null?void 0:ce.toLowerCase().includes(K))||((_=W.description)==null?void 0:_.toLowerCase().includes(K))||((z=W.amount)==null?void 0:z.toString().includes(K))||((O=W.currency)==null?void 0:O.toLowerCase().includes(K))||((X=W.billingCycle)==null?void 0:X.toLowerCase().includes(K))||(q==null?void 0:q.toLowerCase().includes(K))||((Z=W.clientNotes)==null?void 0:Z.toLowerCase().includes(K))||((le=W.adminNotes)==null?void 0:le.toLowerCase().includes(K))||W.dueDate&&new Date(W.dueDate.seconds*1e3).toLocaleDateString().includes(K)||W.dueDate&&((me=W.dueDate.seconds)==null?void 0:me.toString().includes(K))});return o.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[o.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[["Todos",...te].map(W=>o.jsx("button",{onClick:()=>y(W),className:`px-4 py-2 rounded-full text-sm font-semibold transition-colors ${g===W?"bg-blue-600 text-white shadow-lg":"bg-white hover:bg-gray-100"}`,children:W},W)),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",placeholder:"Buscar en toda la tabla...",value:p,onChange:W=>T(W.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full sm:w-64"}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Ru,{})})]})]}),o.jsxs("button",{onClick:()=>{f(null),c(!0)},className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700",children:[o.jsx(Dh,{})," ",o.jsx("span",{className:"hidden sm:inline",children:"Nuevo Servicio"})]})]}),o.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:o.jsxs("table",{className:"w-full text-left",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsx("tr",{children:["Número","Cliente","Servicio","Monto","Ciclo","Fecha de Inicio","Fecha de Vencimiento","Notas","Estado","Acciones"].map(W=>o.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:W},W))})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:D.map(W=>{var q;const K=S(W);return o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4",children:o.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:W.serviceNumber||"N/A"})}),o.jsxs("td",{className:"px-6 py-4",children:[o.jsx("div",{className:"font-medium",children:W.clientName}),o.jsx("div",{className:"text-sm text-gray-500",children:W.clientEmail})]}),o.jsxs("td",{className:"px-6 py-4",children:[o.jsx("div",{className:"font-semibold",children:W.serviceType}),o.jsx("div",{className:"text-sm text-gray-600",children:W.description})]}),o.jsxs("td",{className:"px-6 py-4 font-semibold",children:[(q=W.amount)==null?void 0:q.toFixed(2)," ",W.currency]}),o.jsxs("td",{className:"px-6 py-4",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:k(W.billingCycle)}),W.billingCycle==="Custom"&&W.customBillingCycle&&o.jsxs("div",{className:"text-xs text-gray-500",children:["(",W.customBillingCycle,")"]})]}),o.jsxs("td",{className:`px-6 py-4 ${N(K,W.dueDate)}`,children:[o.jsx("div",{className:"text-sm",children:W.dueDate?W.dueDate.toDate().toLocaleDateString():"N/A"}),o.jsx("div",{className:"text-xs text-gray-500",children:"Inicio"})]}),o.jsxs("td",{className:"px-6 py-4",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:w(W)}),o.jsx("div",{className:"text-xs text-gray-500",children:"Vencimiento"})]}),o.jsxs("td",{className:"px-6 py-4 text-xs max-w-xs",children:[W.clientNotes&&o.jsxs("div",{className:"truncate",title:W.clientNotes,children:[o.jsx("strong",{children:"Cliente:"})," ",W.clientNotes]}),W.adminNotes&&o.jsxs("div",{className:"truncate text-purple-600 mt-1",title:W.adminNotes,children:[o.jsx("strong",{children:"Admin:"})," ",W.adminNotes]})]}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("select",{value:W.status,onChange:ee=>j(W.id,ee.target.value),className:"p-1 text-xs rounded-md border-gray-300 bg-white shadow-sm w-full",children:te.map(ee=>o.jsx("option",{value:ee,children:ee},ee))})}),o.jsx("td",{className:"px-6 py-4 text-center",children:o.jsxs(Oh,{children:[o.jsx("button",{onClick:()=>{f(W),c(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Editar"}),o.jsx("button",{onClick:()=>H(W),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Enviar Notificación"}),o.jsx("button",{onClick:()=>B(W.id),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"Eliminar"})]})})]},W.id)})})]})}),o.jsx(XR,{isOpen:l,onClose:()=>c(!1),onSave:ae,service:u,clients:s,isDemo:t}),o.jsx(JR,{isOpen:E,onClose:()=>P(!1),onSend:I,service:u,templates:A,companySettings:M,isDemo:t})]})}function e8({isOpen:t,onClose:e,onSave:n,user:r,isDemo:i}){const{addNotification:s}=kn(),[a,l]=fe.useState({});fe.useEffect(()=>{r&&l(r)},[r]);const c=f=>{const{name:g,value:y}=f.target;l(p=>({...p,[g]:y}))},u=async f=>{f.preventDefault();try{await n(a),s("Usuario actualizado.","success"),e()}catch{s("Error al actualizar usuario.","error")}};return t?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-lg w-full",children:[o.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Editar Usuario"}),o.jsxs("form",{onSubmit:u,className:"space-y-4",children:[o.jsx("input",{name:"fullName",value:a.fullName||"",onChange:c,placeholder:"Nombre Completo",className:"w-full p-2 border rounded-md"}),o.jsx("input",{name:"identification",value:a.identification||"",onChange:c,placeholder:"Identificación",className:"w-full p-2 border rounded-md"}),o.jsx("input",{type:"email",value:a.email||"",readOnly:!0,disabled:!0,className:"w-full p-2 border rounded-md bg-gray-100"}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[o.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Guardar Cambios"})]})]})]})}):null}function t8({isOpen:t,onClose:e,onSave:n,isDemo:r}){const{addNotification:i}=kn(),[s,a]=fe.useState(""),[l,c]=fe.useState(""),[u,f]=fe.useState(""),[g,y]=fe.useState(""),[p,T]=fe.useState("client"),[E,P]=fe.useState("active"),[A,L]=fe.useState(!1),[M,F]=fe.useState(""),te=[{value:"client",label:"Cliente"},{value:"admin",label:"Administrador"},{value:"superadmin",label:"Super Administrador"}],ae=[{value:"active",label:"Activo"},{value:"inactive",label:"Inactivo"},{value:"pending",label:"Pendiente"}],B=()=>{a(""),c(""),f(""),y(""),T("client"),P("active"),L(!1),F("")},I=()=>{B(),e()},j=async S=>{if(S.preventDefault(),l.length<6){F("La contraseña debe tener al menos 6 caracteres.");return}F("");try{await n({email:s,password:l,notify:A,fullName:u,identification:g,role:p,status:E}),e()}catch{i("Error al crear usuario.","error")}};return t?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-md w-full",children:[o.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Crear Nuevo Usuario"}),o.jsxs("form",{onSubmit:j,className:"space-y-4",children:[o.jsx("input",{type:"email",value:s,onChange:S=>a(S.target.value),placeholder:"Email del nuevo usuario",className:"w-full p-2 border rounded-md",required:!0}),o.jsx("input",{type:"password",value:l,onChange:S=>c(S.target.value),placeholder:"Contraseña temporal",className:"w-full p-2 border rounded-md",required:!0}),o.jsx("input",{value:u,onChange:S=>f(S.target.value),placeholder:"Nombre Completo",className:"w-full p-2 border rounded-md"}),o.jsx("input",{value:g,onChange:S=>y(S.target.value),placeholder:"Identificación",className:"w-full p-2 border rounded-md"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),o.jsx("select",{value:p,onChange:S=>T(S.target.value),className:"w-full p-2 border rounded-md",required:!0,children:te.map(S=>o.jsx("option",{value:S.value,children:S.label},S.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),o.jsx("select",{value:E,onChange:S=>P(S.target.value),className:"w-full p-2 border rounded-md",required:!0,children:ae.map(S=>o.jsx("option",{value:S.value,children:S.label},S.value))})]})]}),M&&o.jsx("p",{className:"text-red-500 text-sm",children:M}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("input",{id:"notify",type:"checkbox",checked:A,onChange:S=>L(S.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),o.jsx("label",{htmlFor:"notify",className:"ml-2 block text-sm text-gray-900",children:"Notificar al usuario por correo"})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[o.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Crear Usuario"})]})]})]})}):null}function n8({isOpen:t,onClose:e,user:n,onActivate:r}){const{addNotification:i}=kn(),[s,a]=fe.useState(""),[l,c]=fe.useState(!1),u=`Hola ${(n==null?void 0:n.fullName)||(n==null?void 0:n.email)},

Tu cuenta ha sido activada exitosamente en nuestro sistema de gestión de cobros.

Ahora puedes:
• Ver tus servicios contratados
• Crear tickets de soporte
• Gestionar tu perfil

Para acceder, simplemente inicia sesión con tu email y contraseña.

¡Bienvenido!

Equipo de Soporte`,f=async()=>{c(!0);try{await r(),await ao(Ht(qe,"artifacts",Be,"public","data","messageHistory"),{to:n.email,subject:"Cuenta Activada - Sistema de Gestión de Cobros",body:s||u,reason:"Activación de Usuario",sentAt:lt.now(),type:"activation"}),i(`Usuario ${n.email} activado y notificado exitosamente`,"success"),e()}catch(g){i("Error al activar usuario","error"),console.error("Error activating user:",g)}finally{c(!1)}};return t?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Activar Usuario"}),o.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[o.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"Usuario a Activar:"}),o.jsxs("p",{className:"text-blue-700",children:[o.jsx("strong",{children:"Email:"})," ",n==null?void 0:n.email,o.jsx("br",{}),o.jsx("strong",{children:"Nombre:"})," ",(n==null?void 0:n.fullName)||"Sin especificar",o.jsx("br",{}),o.jsx("strong",{children:"Rol:"})," ",(n==null?void 0:n.role)||"Cliente"]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje de Notificación (Opcional)"}),o.jsx("textarea",{value:s,onChange:g=>a(g.target.value),rows:"8",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",placeholder:u}),o.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Si no escribes un mensaje personalizado, se enviará el mensaje por defecto."})]}),o.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:[o.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"¿Qué sucederá?"}),o.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[o.jsx("li",{children:"• El usuario será activado inmediatamente"}),o.jsx("li",{children:"• Se enviará una notificación por email"}),o.jsx("li",{children:"• El usuario podrá iniciar sesión"}),o.jsx("li",{children:"• Si es cliente, deberá completar su perfil"})]})]}),o.jsxs("div",{className:"flex justify-end space-x-4",children:[o.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),o.jsx("button",{onClick:f,disabled:l,className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 flex items-center gap-2",children:l?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Activando..."]}):"Activar y Notificar"})]})]})}):null}function r8({isDemo:t,userRole:e}){const{addNotification:n}=kn(),[r,i]=fe.useState([]),[s,a]=fe.useState(""),[l,c]=fe.useState(!1),[u,f]=fe.useState(!1),[g,y]=fe.useState(!1),[p,T]=fe.useState(null),[E,P]=fe.useState(null);fe.useEffect(()=>{if(t){i([{id:"u1",email:"superadmin@demo.com",role:"superadmin",status:"active",fullName:"Super Admin",identification:"123"},{id:"u2",email:"admin@demo.com",role:"admin",status:"active",fullName:"Admin User",identification:"456"},{id:"u3",email:"cliente1@demo.com",role:"client",status:"pending",fullName:"Cliente Pendiente",identification:"789"},{id:"u4",email:"cliente2@demo.com",role:"client",status:"disabled",fullName:"Cliente Deshabilitado",identification:"101"}]);return}const S=Ht(qe,"artifacts",Be,"public","data","users");return nn(or(S,Rh("email")),w=>{i(w.docs.map(k=>({id:k.id,...k.data()})))})},[t]);const A=async S=>{if(t){n("Función no disponible en modo demo.","error");return}const{id:N,...w}=S,k=mt(qe,"artifacts",Be,"public","data","users",N);await hr(k,w)},L=async S=>{if(t){n(`Simulación: Creando usuario ${S.email} con rol ${S.role}.`,"success");return}try{const N=or(Ht(qe,"artifacts",Be,"public","data","users"),Or("email","==",S.email));if(!(await ga(N)).empty){n("El email ya está registrado en el sistema","error");return}const H=(await Em(yr,S.email,S.password)).user,D={email:S.email,fullName:S.fullName||"",identification:S.identification||"",role:S.role||"client",status:S.status||"active",isProfileComplete:!0,createdAt:lt.now(),requiresPasswordChange:!0},W=mt(qe,"artifacts",Be,"public","data","users",H.uid);if(await va(W,D),S.notify)try{await m4(H),n(`Usuario ${S.email} creado exitosamente. Email de verificación enviado.`,"success")}catch{n(`Usuario ${S.email} creado exitosamente, pero no se pudo enviar el email de verificación.`,"warning")}else n(`Usuario ${S.email} creado exitosamente.`,"success")}catch(N){console.error("Error creating user:",N);let w="Error al crear usuario";throw N.code==="auth/email-already-in-use"?w="El email ya está registrado en el sistema":N.code==="auth/invalid-email"?w="El email no es válido":N.code==="auth/weak-password"?w="La contraseña es muy débil":w=`Error al crear usuario: ${N.message}`,n(w,"error"),N}},M=async()=>{if(E)try{const S=mt(qe,"artifacts",Be,"public","data","users",E.id);await hr(S,{status:"active"}),n(`Usuario ${E.email} activado exitosamente.`,"success")}catch(S){n("Error al activar usuario","error"),console.error("Error activating user:",S)}},F=async(S,N)=>{if(t||e!=="superadmin"){n("Acción no permitida.","error");return}const w=mt(qe,"artifacts",Be,"public","data","users",S.id);try{switch(N){case"activate":P(S),y(!0);break;case"notify":const k=`${window.location.origin}?uid=${S.id}&email=${encodeURIComponent(S.email)}&name=${encodeURIComponent(S.fullName||"")}&id=${encodeURIComponent(S.identification||"")}`;console.log("Link de activación:",k),n(`Link de activación generado para ${S.email}. Copia el link desde la consola.`,"success"),navigator.clipboard.writeText(k),n("Link copiado al portapapeles","info");break;case"disable":window.confirm(`¿Deshabilitar a ${S.email}?`)&&(await hr(w,{status:"disabled"}),n(`Usuario ${S.email} deshabilitado.`,"success"));break;case"makeAdmin":window.confirm(`¿Convertir a ${S.email} en administrador?`)&&(await hr(w,{role:"admin"}),n(`${S.email} ahora es administrador.`,"success"));break;case"makeClient":window.confirm(`¿Convertir a ${S.email} en cliente?`)&&(await hr(w,{role:"client"}),n(`${S.email} ahora es cliente.`,"success"));break;case"delete":if(window.confirm(`¿Eliminar permanentemente a ${S.email}? Esta acción no se puede deshacer.`))try{await Su(w),n(`Usuario ${S.email} eliminado de la base de datos.`,"success"),n("Nota: El usuario permanece en Authentication. Contacta al administrador para eliminación completa.","info")}catch(H){console.error("Error deleting user:",H),n("Error al eliminar el usuario: "+H.message,"error")}break;default:n("Acción no reconocida.","error")}}catch(k){n("Ocurrió un error al realizar la acción.","error"),console.error("Error in user action:",k)}},te=r.filter(S=>{const N=s.toLowerCase();return!N||S.email.toLowerCase().includes(N)||S.fullName&&S.fullName.toLowerCase().includes(N)||S.identification&&S.identification.includes(N)}),ae=S=>({active:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",disabled:"bg-red-100 text-red-800"})[S]||"bg-gray-100 text-gray-800",B=S=>({superadmin:"bg-red-100 text-red-800 font-bold",admin:"bg-blue-100 text-blue-800 font-semibold",client:"bg-gray-100 text-gray-800"})[S]||"bg-gray-100 text-gray-800",I=S=>({active:"Activo",pending:"Pendiente",disabled:"Deshabilitado"})[S]||S,j=S=>({superadmin:"Super Admin",admin:"Administrador",client:"Cliente"})[S]||S;return o.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[o.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",placeholder:"Buscar por email, nombre, ID...",value:s,onChange:S=>a(S.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full sm:w-64"}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Ru,{})})]}),e==="superadmin"&&o.jsxs("button",{onClick:()=>c(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700",children:[o.jsx(Dh,{})," ",o.jsx("span",{className:"hidden sm:inline",children:"Crear Usuario"})]})]}),o.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:o.jsxs("table",{className:"w-full text-left",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsx("tr",{children:["Nombre","Email","Identificación","Rol","Estado","Fecha Creación","Acciones"].map(S=>o.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:S},S))})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:te.map(S=>o.jsxs("tr",{children:[o.jsxs("td",{className:"px-6 py-4",children:[o.jsx("div",{className:"font-medium text-gray-900",children:S.fullName||"Sin nombre"}),S.fullName&&o.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",S.id.slice(0,8),"..."]})]}),o.jsxs("td",{className:"px-6 py-4",children:[o.jsx("div",{className:"text-sm text-gray-900",children:S.email}),S.requiresPasswordChange&&o.jsx("div",{className:"text-xs text-orange-600",children:"Requiere cambio de contraseña"})]}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:S.identification||"--"}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${B(S.role)}`,children:j(S.role)})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${ae(S.status)}`,children:I(S.status)})}),o.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:S.createdAt?new Date(S.createdAt.seconds*1e3).toLocaleDateString():"--"}),o.jsx("td",{className:"px-6 py-4",children:e==="superadmin"&&S.role!=="superadmin"&&o.jsxs(Oh,{children:[o.jsx("button",{onClick:()=>{T(S),f(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"✏️ Editar Datos"}),o.jsx("button",{onClick:()=>F(S,"notify"),className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:"📧 Notificar Activación"}),S.status==="pending"&&o.jsx("button",{onClick:()=>F(S,"activate"),className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:"✅ Activar Usuario"}),S.status==="active"&&o.jsx("button",{onClick:()=>F(S,"disable"),className:"block w-full text-left px-4 py-2 text-sm text-yellow-700 hover:bg-yellow-50",children:"⏸️ Deshabilitar"}),S.status==="disabled"&&o.jsx("button",{onClick:()=>F(S,"activate"),className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:"🔄 Re-Activar"}),S.role==="client"?o.jsx("button",{onClick:()=>F(S,"makeAdmin"),className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:"👨‍💼 Hacer Administrador"}):o.jsx("button",{onClick:()=>F(S,"makeClient"),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:"👤 Hacer Cliente"}),o.jsx("button",{onClick:()=>F(S,"delete"),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"🗑️ Eliminar Permanentemente"})]})})]},S.id))})]})}),o.jsx(t8,{isOpen:l,onClose:()=>c(!1),onSave:L,isDemo:t}),o.jsx(e8,{isOpen:u,onClose:()=>f(!1),onSave:A,user:p,isDemo:t}),o.jsx(n8,{isOpen:g,onClose:()=>{y(!1),P(null)},onActivate:M,user:E})]})}function i8({isDemo:t}){const{addNotification:e}=kn(),[n,r]=fe.useState([]),[i,s]=fe.useState(null),[a,l]=fe.useState(""),[c,u]=fe.useState(""),[f,g]=fe.useState(""),[y,p]=fe.useState(!1),[T,E]=fe.useState([]),[P,A]=fe.useState({preVencimiento:{enabled:!1,days:7,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]},periodoGracia:{enabled:!1,days:3,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]},vencido:{enabled:!1,days:0,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]},suspendido:{enabled:!1,days:0,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]}}),[L,M]=fe.useState("templates"),F={preVencimiento:{name:"Aviso de Próximo Vencimiento",subject:"Recordatorio de Renovación de Servicio: {description}",body:`Estimado/a {clientName},

Le escribimos para recordarle que su servicio '{description}' está programado para vencer el próximo {dueDate}.

El monto correspondiente a la renovación es de {amount} {currency}.

Para garantizar la continuidad de su servicio, le recomendamos realizar el pago antes de la fecha de vencimiento. Puede gestionarlo a través de nuestro portal de clientes.

Si tiene alguna consulta, no dude en contactarnos.

Atentamente,
{companyName}`},vencido:{name:"Notificación de Servicio Vencido",subject:"Importante: Su servicio {description} ha vencido",body:`Estimado/a {clientName},

Le informamos que la factura correspondiente a su servicio '{description}', con fecha de vencimiento {dueDate}, se encuentra pendiente de pago.

Su servicio ha entrado en un período de gracia. Para evitar la suspensión del mismo, le solicitamos regularizar su situación a la brevedad posible. El monto pendiente es de {amount} {currency}.

Si usted ya ha realizado el pago, por favor, omita esta notificación.

Cordialmente,
{companyName}`},suspendido:{name:"Aviso de Suspensión de Servicio",subject:"Acción Requerida: Suspensión del servicio {description}",body:`Estimado/a {clientName},

Lamentamos informarle que, debido a la falta de pago, su servicio '{description}' ha sido suspendido.

Para proceder con la reactivación y recuperar el acceso, es necesario saldar el monto pendiente de {amount} {currency}. Por favor, contáctenos para coordinar el pago y la restauración del servicio.

Quedamos a su disposición.

Atentamente,
{companyName}`},pagoRecibido:{name:"Confirmación de Pago Recibido",subject:"Confirmación: Pago recibido para {description}",body:`Estimado/a {clientName},

Hemos recibido y procesado exitosamente su pago por {amount} {currency} correspondiente al servicio '{description}'.

Su servicio está activo y funcionando correctamente. La próxima fecha de vencimiento será {dueDate}.

Gracias por su confianza y por mantener sus pagos al día.

Atentamente,
{companyName}`},bienvenida:{name:"Bienvenida a Nuevo Cliente",subject:"Bienvenido a {companyName} - Servicio {description}",body:`Estimado/a {clientName},

¡Bienvenido a {companyName}!

Nos complace confirmar que su servicio '{description}' ha sido activado exitosamente.

Detalles del servicio:
- Descripción: {description}
- Monto: {amount} {currency}
- Próximo vencimiento: {dueDate}

Puede acceder a su portal de cliente en cualquier momento para gestionar su cuenta y realizar pagos.

Si tiene alguna pregunta, no dude en contactarnos.

¡Gracias por elegirnos!

Atentamente,
{companyName}`},adminPreVencimiento:{name:"Alerta Admin: Próximo Vencimiento",subject:"ALERTA: Servicio próximo a vencer - {clientName}",body:`Estimado/a Administrador,

Se ha generado una alerta automática para el siguiente servicio:

📋 INFORMACIÓN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto: {amount} {currency}
- Fecha de vencimiento: {dueDate}
- Ciclo de facturación: {billingCycle}
- Días restantes: {daysRemaining}

📊 ESTADO ACTUAL:
- Estado: Próximo a vencer
- Notificación enviada al cliente: ✅
- Plantilla utilizada: Aviso de Próximo Vencimiento

🔔 ACCIONES RECOMENDADAS:
1. Verificar que el cliente haya recibido la notificación
2. Contactar al cliente si es necesario
3. Preparar seguimiento post-vencimiento

📈 ESTADÍSTICAS:
- Total de servicios próximos a vencer: {totalPending}
- Ingresos potenciales: {potentialRevenue}

Este es un mensaje automático del sistema de gestión de cobros.

Sistema de Gestión - {companyName}`},adminPeriodoGracia:{name:"Alerta Admin: Período de Gracia",subject:"URGENTE: Servicio en período de gracia - {clientName}",body:`Estimado/a Administrador,

⚠️ ALERTA URGENTE - Servicio en período de gracia:

📋 INFORMACIÓN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto pendiente: {amount} {currency}
- Fecha de vencimiento original: {dueDate}
- Días en período de gracia: {graceDays}
- Días restantes de gracia: {remainingGraceDays}

📊 ESTADO ACTUAL:
- Estado: Período de Gracia Vencido
- Notificación enviada al cliente: ✅
- Plantilla utilizada: Notificación de Servicio Vencido
- Riesgo de suspensión: ALTO

🚨 ACCIONES INMEDIATAS:
1. Contactar al cliente por teléfono
2. Enviar recordatorio personalizado
3. Evaluar opciones de pago flexibles
4. Preparar suspensión si no hay respuesta

📈 IMPACTO:
- Ingresos en riesgo: {amount} {currency}
- Tiempo de mora: {daysOverdue} días
- Historial de pagos: {paymentHistory}

⏰ PRÓXIMOS PASOS:
- Si no se paga en {remainingGraceDays} días: Suspender servicio
- Seguimiento diario hasta resolución
- Documentar todas las comunicaciones

Este es un mensaje automático del sistema de gestión de cobros.

Sistema de Gestión - {companyName}`},adminVencido:{name:"Alerta Admin: Servicio Vencido",subject:"INMEDIATO: Servicio vencido - {clientName}",body:`Estimado/a Administrador,

🔴 ALERTA INMEDIATA - Servicio vencido:

📋 INFORMACIÓN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto vencido: {amount} {currency}
- Fecha de vencimiento: {dueDate}
- Días de atraso: {daysOverdue}
- Ciclo de facturación: {billingCycle}

📊 ESTADO ACTUAL:
- Estado: Vencido
- Notificación enviada al cliente: ✅
- Plantilla utilizada: Notificación de Servicio Vencido
- Próximo paso: Período de gracia

🎯 ACCIONES REQUERIDAS:
1. Verificar recepción de notificación por cliente
2. Iniciar período de gracia ({gracePeriod} días)
3. Contacto directo con el cliente
4. Evaluar historial de pagos del cliente
5. Preparar estrategia de cobro

📈 ANÁLISIS:
- Cliente desde: {clientSince}
- Pagos anteriores: {previousPayments}
- Patrón de pago: {paymentPattern}
- Riesgo de pérdida: {riskLevel}

📞 CONTACTOS:
- Teléfono: {clientPhone}
- Email: {clientEmail}
- Última comunicación: {lastContact}

Este es un mensaje automático del sistema de gestión de cobros.

Sistema de Gestión - {companyName}`},adminSuspendido:{name:"Alerta Admin: Servicio Suspendido",subject:"SUSPENDIDO: Servicio cancelado por falta de pago - {clientName}",body:`Estimado/a Administrador,

❌ SERVICIO SUSPENDIDO - Acción requerida:

📋 INFORMACIÓN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto pendiente: {amount} {currency}
- Fecha de vencimiento: {dueDate}
- Días de atraso: {daysOverdue}
- Período de gracia agotado: {gracePeriod} días

📊 ESTADO ACTUAL:
- Estado: Cancelado
- Motivo: Falta de pago
- Notificación enviada al cliente: ✅
- Plantilla utilizada: Aviso de Suspensión de Servicio
- Fecha de suspensión: {suspensionDate}

🔧 ACCIONES INMEDIATAS:
1. Suspender acceso del cliente al servicio
2. Documentar suspensión en el sistema
3. Enviar notificación de suspensión
4. Iniciar proceso de recuperación de cobros
5. Evaluar reactivación futura

📈 ANÁLISIS FINANCIERO:
- Pérdida de ingresos: {amount} {currency}
- Costo de reactivación: {reactivationCost}
- Valor del cliente: {clientValue}
- Probabilidad de recuperación: {recoveryProbability}%

📞 SEGUIMIENTO:
- Contactar para negociación de pago
- Ofrecer planes de pago flexibles
- Documentar todas las comunicaciones
- Evaluar cancelación definitiva

📋 DOCUMENTACIÓN:
- Historial de pagos: {paymentHistory}
- Comunicaciones previas: {communicationHistory}
- Términos del servicio: {serviceTerms}
- Política de suspensión: {suspensionPolicy}

Este es un mensaje automático del sistema de gestión de cobros.

Sistema de Gestión - {companyName}`},adminPagoRecibido:{name:"Notificación Admin: Pago Recibido",subject:"CONFIRMADO: Pago recibido - {clientName}",body:`Estimado/a Administrador,

✅ PAGO CONFIRMADO - Servicio reactivado:

📋 INFORMACIÓN DEL PAGO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Monto recibido: {amount} {currency}
- Fecha de pago: {paymentDate}
- Método de pago: {paymentMethod}
- Referencia: {paymentReference}

📊 ESTADO ACTUAL:
- Estado: Activo
- Servicio reactivado: ✅
- Notificación enviada al cliente: ✅
- Plantilla utilizada: Confirmación de Pago Recibido
- Próximo vencimiento: {nextDueDate}

🎯 ACCIONES COMPLETADAS:
1. Pago procesado y verificado
2. Servicio reactivado automáticamente
3. Cliente notificado del pago
4. Próxima fecha de vencimiento actualizada
5. Historial de pagos actualizado

📈 IMPACTO POSITIVO:
- Ingresos recuperados: {amount} {currency}
- Cliente retenido: ✅
- Servicio activo: ✅
- Próximo ciclo iniciado

📊 ESTADÍSTICAS:
- Tiempo de pago: {paymentTime} días
- Eficiencia de cobro: {collectionEfficiency}%
- Satisfacción del cliente: {clientSatisfaction}
- Ingresos mensuales: {monthlyRevenue}

📋 SEGUIMIENTO:
- Monitorear estabilidad del servicio
- Preparar próximo recordatorio
- Actualizar perfil del cliente
- Documentar éxito de cobro

Este es un mensaje automático del sistema de gestión de cobros.

Sistema de Gestión - {companyName}`},adminNuevoCliente:{name:"Notificación Admin: Nuevo Cliente",subject:"NUEVO CLIENTE: {clientName} - Servicio {description}",body:`Estimado/a Administrador,

🎉 NUEVO CLIENTE REGISTRADO:

📋 INFORMACIÓN DEL CLIENTE:
- Nombre: {clientName}
- Email: {clientEmail}
- Identificación: {clientId}
- Teléfono: {clientPhone}
- Fecha de registro: {registrationDate}

📋 INFORMACIÓN DEL SERVICIO:
- Descripción: {description}
- Tipo: {serviceType}
- Monto: {amount} {currency}
- Ciclo de facturación: {billingCycle}
- Fecha de vencimiento: {dueDate}
- Estado: Activo

📊 CONFIGURACIÓN:
- Servicio activado: ✅
- Notificación de bienvenida enviada: ✅
- Plantilla utilizada: Bienvenida a Nuevo Cliente
- Portal de cliente habilitado: ✅
- Método de pago configurado: {paymentMethod}

🎯 ACCIONES INICIALES:
1. Verificar activación del servicio
2. Confirmar recepción de bienvenida
3. Programar seguimiento inicial
4. Configurar recordatorios automáticos
5. Documentar preferencias del cliente

📈 ANÁLISIS:
- Valor del cliente: {clientValue}
- Potencial de crecimiento: {growthPotential}
- Segmento: {clientSegment}
- Fuente de adquisición: {acquisitionSource}

📋 PRÓXIMOS PASOS:
- Seguimiento en 7 días
- Verificar satisfacción inicial
- Preparar próximo recordatorio
- Monitorear uso del servicio

Este es un mensaje automático del sistema de gestión de cobros.

Sistema de Gestión - {companyName}`}},te=D=>{s(null),p(!1),l(D.name),u(D.subject),g(D.body),e("Sugerencia cargada en el editor.","success")};fe.useEffect(()=>{if(t){E([{id:"admin1",email:"admin@demo.com",fullName:"Admin Demo",role:"admin"},{id:"super1",email:"super@demo.com",fullName:"Super Admin Demo",role:"superadmin"}]);return}const D=Ht(qe,"artifacts",Be,"public","data","users");return nn(or(D,Or("role","in",["admin","superadmin"])),K=>{E(K.docs.map(q=>({id:q.id,...q.data()})))})},[t]),fe.useEffect(()=>{if(t){A({preVencimiento:{enabled:!0,days:7,clientTemplate:"t1",adminTemplate:"t1",notifyAdmins:!0,selectedAdmins:["admin1"]},periodoGracia:{enabled:!0,days:3,clientTemplate:"t2",adminTemplate:"t2",notifyAdmins:!0,selectedAdmins:["admin1"]},vencido:{enabled:!0,days:0,clientTemplate:"t2",adminTemplate:"t2",notifyAdmins:!0,selectedAdmins:["admin1"]},suspendido:{enabled:!1,days:0,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]}});return}const D=mt(qe,"artifacts",Be,"public","data","settings","alertSettings");return nn(D,K=>{K.exists()&&A(K.data())})},[t]),fe.useEffect(()=>{if(t){r([{id:"t1",name:"Recordatorio General (Demo)",subject:"Recordatorio de pago",body:"Hola {clientName}, recuerda pagar tu servicio {description} por {amount} {currency} antes del {dueDate}. Gracias, {companyName}",createdAt:new Date},{id:"t2",name:"Servicio Vencido (Demo)",subject:"Servicio vencido: {description}",body:"Estimado {clientName}, su servicio {description} ha vencido. Por favor regularice su pago de {amount} {currency}. Atentamente, {companyName}",createdAt:new Date}]);return}const D=Ht(qe,"artifacts",Be,"public","data","messageTemplates");return nn(or(D,Rh("name")),K=>{r(K.docs.map(q=>({id:q.id,...q.data()})))})},[t]),fe.useEffect(()=>{i?(l(i.name),u(i.subject),g(i.body),p(!0)):(l(""),u(""),g(""),p(!1))},[i]);const ae=async()=>{if(t){e("Función no disponible en modo demo.","error");return}if(!a.trim()||!c.trim()||!f.trim()){e("Por favor, complete todos los campos de la plantilla.","error");return}const D={name:a.trim(),subject:c.trim(),body:f.trim(),updatedAt:new Date},W=Ht(qe,"artifacts",Be,"public","data","messageTemplates");try{i?(await hr(mt(W,i.id),D),e("Plantilla actualizada exitosamente.","success")):(await ao(W,{...D,createdAt:new Date}),e("Plantilla creada exitosamente.","success")),s(null)}catch(K){console.error("Error saving template:",K),e("Error al guardar la plantilla.","error")}},B=async D=>{if(t){e("Función no disponible en modo demo.","error");return}if(window.confirm("¿Seguro que quieres eliminar esta plantilla?"))try{await Su(mt(qe,"artifacts",Be,"public","data","messageTemplates",D)),e("Plantilla eliminada.","success"),s(null)}catch(W){console.error("Error deleting template:",W),e("Error al eliminar la plantilla.","error")}},I=()=>{s(null),p(!1),l(""),u(""),g("")},j=D=>{s(D),p(!0)},S=(D,W,K)=>{A(q=>({...q,[D]:{...q[D],[W]:K}}))},N=(D,W,K)=>{A(q=>({...q,[D]:{...q[D],selectedAdmins:K?[...q[D].selectedAdmins,W]:q[D].selectedAdmins.filter(ee=>ee!==W)}}))},w=async()=>{if(t){e("Configuración de alertas guardada (modo demo).","success");return}try{const D=mt(qe,"artifacts",Be,"public","data","settings","alertSettings");await va(D,P,{merge:!0}),e("Configuración de alertas guardada exitosamente.","success")}catch(D){console.error("Error saving alert settings:",D),e("Error al guardar la configuración de alertas.","error")}},k=["{clientName}","{serviceType}","{description}","{amount}","{currency}","{dueDate}","{companyName}","{billingCycle}","{clientEmail}"],H=["{clientName}","{clientEmail}","{clientPhone}","{clientId}","{serviceType}","{description}","{amount}","{currency}","{dueDate}","{billingCycle}","{companyName}","{daysRemaining}","{daysOverdue}","{graceDays}","{remainingGraceDays}","{totalPending}","{potentialRevenue}","{paymentHistory}","{clientSince}","{previousPayments}","{paymentPattern}","{riskLevel}","{lastContact}","{suspensionDate}","{reactivationCost}","{clientValue}","{recoveryProbability}","{paymentDate}","{paymentMethod}","{paymentReference}","{nextDueDate}","{paymentTime}","{collectionEfficiency}","{clientSatisfaction}","{monthlyRevenue}","{registrationDate}","{growthPotential}","{clientSegment}","{acquisitionSource}","{gracePeriod}","{communicationHistory}","{serviceTerms}","{suspensionPolicy}"];return o.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Plantillas y Alertas"}),o.jsx("p",{className:"text-gray-600 mt-2",children:"Gestiona las plantillas de correo y configura alertas automáticas"})]}),o.jsx("div",{className:"mb-6",children:o.jsx("div",{className:"border-b border-gray-200",children:o.jsxs("nav",{className:"-mb-px flex space-x-8",children:[o.jsxs("button",{onClick:()=>M("templates"),className:`py-2 px-1 border-b-2 font-medium text-sm ${L==="templates"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[o.jsx(eA,{}),o.jsx("span",{className:"ml-2",children:"Plantillas"})]}),o.jsxs("button",{onClick:()=>M("alerts"),className:`py-2 px-1 border-b-2 font-medium text-sm ${L==="alerts"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[o.jsx(KR,{}),o.jsx("span",{className:"ml-2",children:"Alertas Automáticas"})]})]})})}),L==="templates"&&o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[o.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[o.jsxs("div",{className:"p-4 border-b",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Plantillas Guardadas"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Haz clic para editar una plantilla"})]}),o.jsx("div",{className:"max-h-80 overflow-y-auto",children:n.length===0?o.jsxs("div",{className:"p-4 text-center text-gray-500",children:[o.jsx("p",{children:"No hay plantillas guardadas"}),o.jsx("p",{className:"text-sm",children:"Crea tu primera plantilla"})]}):n.map(D=>o.jsx("div",{className:"p-4 border-b hover:bg-gray-50 transition-colors",children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:"font-medium text-gray-900 truncate",children:D.name}),o.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:D.subject}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:D.createdAt?new Date(D.createdAt.seconds*1e3).toLocaleDateString():"Sin fecha"})]}),o.jsxs("div",{className:"flex space-x-2 ml-2",children:[o.jsx("button",{onClick:()=>j(D),className:"text-blue-600 hover:text-blue-800 p-1",title:"Editar plantilla",children:o.jsx(GR,{})}),o.jsx("button",{onClick:()=>B(D.id),className:"text-red-600 hover:text-red-800 p-1",title:"Eliminar plantilla",children:o.jsx(Z3,{})})]})]})},D.id))}),o.jsx("div",{className:"p-4",children:o.jsxs("button",{onClick:I,className:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[o.jsx(Dh,{}),o.jsx("span",{className:"ml-2",children:"Nueva Plantilla"})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[o.jsxs("div",{className:"p-4 border-b",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Plantillas para Clientes"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Mensajes dirigidos a los clientes"})]}),o.jsxs("div",{className:"p-4 space-y-2",children:[o.jsxs("button",{onClick:()=>te(F.preVencimiento),className:"w-full text-left p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[o.jsx("div",{className:"font-medium text-blue-900",children:"Aviso de Próximo Vencimiento"}),o.jsx("div",{className:"text-sm text-blue-700",children:"Recordatorio antes del vencimiento"})]}),o.jsxs("button",{onClick:()=>te(F.vencido),className:"w-full text-left p-3 bg-yellow-50 hover:bg-yellow-100 rounded-lg transition-colors",children:[o.jsx("div",{className:"font-medium text-yellow-900",children:"Servicio Vencido"}),o.jsx("div",{className:"text-sm text-yellow-700",children:"Notificación de período de gracia"})]}),o.jsxs("button",{onClick:()=>te(F.suspendido),className:"w-full text-left p-3 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",children:[o.jsx("div",{className:"font-medium text-red-900",children:"Aviso de Suspensión"}),o.jsx("div",{className:"text-sm text-red-700",children:"Servicio suspendido por falta de pago"})]}),o.jsxs("button",{onClick:()=>te(F.pagoRecibido),className:"w-full text-left p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[o.jsx("div",{className:"font-medium text-green-900",children:"Confirmación de Pago"}),o.jsx("div",{className:"text-sm text-green-700",children:"Confirmación de pago recibido"})]}),o.jsxs("button",{onClick:()=>te(F.bienvenida),className:"w-full text-left p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[o.jsx("div",{className:"font-medium text-purple-900",children:"Bienvenida"}),o.jsx("div",{className:"text-sm text-purple-700",children:"Mensaje de bienvenida a nuevos clientes"})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[o.jsxs("div",{className:"p-4 border-b",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Plantillas para Administradores"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Alertas y notificaciones internas"})]}),o.jsxs("div",{className:"p-4 space-y-2",children:[o.jsxs("button",{onClick:()=>te(F.adminPreVencimiento),className:"w-full text-left p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[o.jsx("div",{className:"font-medium text-blue-900",children:"🔔 Alerta: Próximo Vencimiento"}),o.jsx("div",{className:"text-sm text-blue-700",children:"Notificación interna de servicios próximos a vencer"})]}),o.jsxs("button",{onClick:()=>te(F.adminPeriodoGracia),className:"w-full text-left p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition-colors",children:[o.jsx("div",{className:"font-medium text-orange-900",children:"⚠️ Alerta: Período de Gracia"}),o.jsx("div",{className:"text-sm text-orange-700",children:"Alerta urgente de servicios en período de gracia"})]}),o.jsxs("button",{onClick:()=>te(F.adminVencido),className:"w-full text-left p-3 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",children:[o.jsx("div",{className:"font-medium text-red-900",children:"🔴 Alerta: Servicio Vencido"}),o.jsx("div",{className:"text-sm text-red-700",children:"Notificación inmediata de servicios vencidos"})]}),o.jsxs("button",{onClick:()=>te(F.adminSuspendido),className:"w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:[o.jsx("div",{className:"font-medium text-gray-900",children:"❌ Alerta: Servicio Suspendido"}),o.jsx("div",{className:"text-sm text-gray-700",children:"Notificación de servicios cancelados por falta de pago"})]}),o.jsxs("button",{onClick:()=>te(F.adminPagoRecibido),className:"w-full text-left p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[o.jsx("div",{className:"font-medium text-green-900",children:"✅ Notificación: Pago Recibido"}),o.jsx("div",{className:"text-sm text-green-700",children:"Confirmación interna de pagos procesados"})]}),o.jsxs("button",{onClick:()=>te(F.adminNuevoCliente),className:"w-full text-left p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[o.jsx("div",{className:"font-medium text-purple-900",children:"🎉 Notificación: Nuevo Cliente"}),o.jsx("div",{className:"text-sm text-purple-700",children:"Alerta de nuevos clientes registrados"})]})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Variables para Clientes"}),o.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[o.jsx("p",{className:"font-medium",children:"Información básica:"}),o.jsx("p",{children:k.slice(0,3).join(", ")}),o.jsx("p",{className:"font-medium mt-2",children:"Información del servicio:"}),o.jsx("p",{children:k.slice(3,6).join(", ")}),o.jsx("p",{className:"font-medium mt-2",children:"Información adicional:"}),o.jsx("p",{children:k.slice(6).join(", ")})]})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[o.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Variables para Administradores"}),o.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[o.jsx("p",{className:"font-medium",children:"Información del cliente:"}),o.jsx("p",{children:H.slice(0,4).join(", ")}),o.jsx("p",{className:"font-medium mt-2",children:"Información del servicio:"}),o.jsx("p",{children:H.slice(4,11).join(", ")}),o.jsx("p",{className:"font-medium mt-2",children:"Fechas y tiempos:"}),o.jsx("p",{children:H.slice(11,15).join(", ")}),o.jsx("p",{className:"font-medium mt-2",children:"Estadísticas:"}),o.jsx("p",{children:H.slice(15,19).join(", ")}),o.jsx("p",{className:"font-medium mt-2",children:"Análisis de riesgo:"}),o.jsx("p",{children:H.slice(19,23).join(", ")}),o.jsx("p",{className:"font-medium mt-2",children:"Información de pago:"}),o.jsx("p",{children:H.slice(23,27).join(", ")}),o.jsx("p",{className:"font-medium mt-2",children:"Métricas de rendimiento:"}),o.jsx("p",{children:H.slice(27,31).join(", ")}),o.jsx("p",{className:"font-medium mt-2",children:"Información de registro:"}),o.jsx("p",{children:H.slice(31,35).join(", ")}),o.jsx("p",{className:"font-medium mt-2",children:"Configuración:"}),o.jsx("p",{children:H.slice(35).join(", ")})]})]})]}),o.jsx("div",{className:"lg:col-span-2",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[o.jsxs("div",{className:"p-6 border-b",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:y?"Editando Plantilla":"Nueva Plantilla"}),o.jsx("p",{className:"text-sm text-gray-500 mt-1",children:y?"Modifica los campos de la plantilla":"Completa los campos para crear una nueva plantilla"})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de la Plantilla"}),o.jsx("input",{type:"text",value:a,onChange:D=>l(D.target.value),placeholder:"Ej: Primer Recordatorio de Pago",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Asunto del Correo"}),o.jsx("input",{type:"text",value:c,onChange:D=>u(D.target.value),placeholder:"Ej: Recordatorio de Renovación: {description}",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cuerpo del Mensaje"}),o.jsx("textarea",{value:f,onChange:D=>g(D.target.value),placeholder:"Escribe el contenido del mensaje aquí...",rows:"12",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm"})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[o.jsx("button",{onClick:I,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Limpiar"}),o.jsx("button",{onClick:ae,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:y?"Guardar Cambios":"Crear Plantilla"})]})]})]})})]}),L==="alerts"&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[o.jsxs("div",{className:"p-6 border-b",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[o.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-3"}),"Alerta de Próximo Vencimiento"]}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Notificaciones antes del vencimiento del servicio"})]}),o.jsxs("div",{className:"p-6 space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Activar alerta"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Enviar notificaciones antes del vencimiento"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:P.preVencimiento.enabled,onChange:D=>S("preVencimiento","enabled",D.target.checked),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),P.preVencimiento.enabled&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Días antes del vencimiento"}),o.jsx("input",{type:"number",min:"1",max:"30",value:P.preVencimiento.days,onChange:D=>S("preVencimiento","days",parseInt(D.target.value)),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para cliente"}),o.jsxs("select",{value:P.preVencimiento.clientTemplate,onChange:D=>S("preVencimiento","clientTemplate",D.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(D=>o.jsx("option",{value:D.id,children:D.name},D.id))]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notificar administradores"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Enviar copia a administradores seleccionados"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:P.preVencimiento.notifyAdmins,onChange:D=>S("preVencimiento","notifyAdmins",D.target.checked),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),P.preVencimiento.notifyAdmins&&o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para administradores"}),o.jsxs("select",{value:P.preVencimiento.adminTemplate,onChange:D=>S("preVencimiento","adminTemplate",D.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(D=>o.jsx("option",{value:D.id,children:D.name},D.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Administradores a notificar"}),o.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-3",children:T.map(D=>o.jsxs("label",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",checked:P.preVencimiento.selectedAdmins.includes(D.id),onChange:W=>N("preVencimiento",D.id,W.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsxs("span",{className:"text-sm text-gray-700",children:[D.fullName," (",D.email,")"]})]},D.id))})]})]})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[o.jsxs("div",{className:"p-6 border-b",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[o.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full mr-3"}),"Período de Gracia"]}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Notificaciones durante el período de gracia después del vencimiento"})]}),o.jsxs("div",{className:"p-6 space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Activar período de gracia"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Tiempo adicional para pagar antes de suspender"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:P.periodoGracia.enabled,onChange:D=>S("periodoGracia","enabled",D.target.checked),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),P.periodoGracia.enabled&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Días de gracia"}),o.jsx("input",{type:"number",min:"1",max:"30",value:P.periodoGracia.days,onChange:D=>S("periodoGracia","days",parseInt(D.target.value)),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para cliente"}),o.jsxs("select",{value:P.periodoGracia.clientTemplate,onChange:D=>S("periodoGracia","clientTemplate",D.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(D=>o.jsx("option",{value:D.id,children:D.name},D.id))]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notificar administradores"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Enviar copia a administradores seleccionados"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:P.periodoGracia.notifyAdmins,onChange:D=>S("periodoGracia","notifyAdmins",D.target.checked),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),P.periodoGracia.notifyAdmins&&o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para administradores"}),o.jsxs("select",{value:P.periodoGracia.adminTemplate,onChange:D=>S("periodoGracia","adminTemplate",D.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(D=>o.jsx("option",{value:D.id,children:D.name},D.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Administradores a notificar"}),o.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-3",children:T.map(D=>o.jsxs("label",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",checked:P.periodoGracia.selectedAdmins.includes(D.id),onChange:W=>N("periodoGracia",D.id,W.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsxs("span",{className:"text-sm text-gray-700",children:[D.fullName," (",D.email,")"]})]},D.id))})]})]})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[o.jsxs("div",{className:"p-6 border-b",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[o.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-3"}),"Servicio Vencido"]}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Notificaciones cuando el servicio ha vencido"})]}),o.jsxs("div",{className:"p-6 space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Activar alerta"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Enviar notificaciones cuando el servicio vence"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:P.vencido.enabled,onChange:D=>S("vencido","enabled",D.target.checked),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),P.vencido.enabled&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para cliente"}),o.jsxs("select",{value:P.vencido.clientTemplate,onChange:D=>S("vencido","clientTemplate",D.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(D=>o.jsx("option",{value:D.id,children:D.name},D.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para administradores"}),o.jsxs("select",{value:P.vencido.adminTemplate,onChange:D=>S("vencido","adminTemplate",D.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(D=>o.jsx("option",{value:D.id,children:D.name},D.id))]})]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notificar administradores"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Enviar copia a administradores seleccionados"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:P.vencido.notifyAdmins,onChange:D=>S("vencido","notifyAdmins",D.target.checked),className:"sr-only peer"}),o.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),P.vencido.notifyAdmins&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Administradores a notificar"}),o.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-3",children:T.map(D=>o.jsxs("label",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",checked:P.vencido.selectedAdmins.includes(D.id),onChange:W=>N("vencido",D.id,W.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsxs("span",{className:"text-sm text-gray-700",children:[D.fullName," (",D.email,")"]})]},D.id))})]})]})]})]}),o.jsx("div",{className:"flex justify-end",children:o.jsxs("button",{onClick:w,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center",children:[o.jsx(Ym,{}),o.jsx("span",{className:"ml-2",children:"Guardar Configuración de Alertas"})]})})]})]})}function rA({isDemo:t}){const{addNotification:e}=kn(),[n,r]=fe.useState({bold:{enabled:!1,apiKey:"",environment:"sandbox",webhookSecret:"",autoApprove:!1},paypal:{enabled:!1,clientId:"",clientSecret:"",environment:"sandbox",autoApprove:!1},payu:{enabled:!1,merchantId:"",apiKey:"",apiLogin:"",environment:"sandbox",autoApprove:!1},bankTransfer:{enabled:!1,accounts:[],autoApprove:!1,requireConfirmation:!0},general:{currency:"USD",defaultGateway:"bold"}}),[i,s]=fe.useState(!1);fe.useEffect(()=>{if(t){r({bold:{enabled:!0,apiKey:"demo_key",environment:"sandbox",webhookSecret:"demo_secret",autoApprove:!1},paypal:{enabled:!1,clientId:"",clientSecret:"",environment:"sandbox",autoApprove:!1},payu:{enabled:!1,merchantId:"",apiKey:"",apiLogin:"",environment:"sandbox",autoApprove:!1},bankTransfer:{enabled:!0,accounts:[{id:"1",bankName:"Banco Nacional",accountNumber:"1234567890",accountHolder:"Empresa Demo",accountType:"Ahorros"},{id:"2",bankName:"Banco Popular",accountNumber:"0987654321",accountHolder:"Empresa Demo",accountType:"Corriente"}],autoApprove:!1,requireConfirmation:!0},general:{currency:"USD",defaultGateway:"bold"}});return}const p=mt(qe,"artifacts",Be,"public","data","settings","paymentConfig"),T=nn(p,E=>{E.exists()&&r(E.data())});return()=>T()},[t]);const a=(p,T,E)=>{r(P=>({...P,[p]:{...P[p],[T]:E}}))},l=(p,T)=>{r(E=>({...E,general:{...E.general,[p]:T}}))},c=()=>{const p={id:Date.now().toString(),bankName:"",accountNumber:"",accountHolder:"",accountType:"Ahorros"};r(T=>({...T,bankTransfer:{...T.bankTransfer,accounts:[...T.bankTransfer.accounts,p]}}))},u=(p,T,E)=>{r(P=>({...P,bankTransfer:{...P.bankTransfer,accounts:P.bankTransfer.accounts.map(A=>A.id===p?{...A,[T]:E}:A)}}))},f=p=>{r(T=>({...T,bankTransfer:{...T.bankTransfer,accounts:T.bankTransfer.accounts.filter(E=>E.id!==p)}}))},g=async()=>{if(t){e("Configuración guardada (modo demo)","success");return}s(!0);try{const p=mt(qe,"artifacts",Be,"public","data","settings","paymentConfig");await va(p,n),e("Configuración de pagos guardada exitosamente","success")}catch(p){console.error("Error saving payment config:",p),e("Error al guardar la configuración","error")}s(!1)},y=(p,T,E)=>o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[o.jsx(Yi,{}),T]}),o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",checked:n[p].enabled,onChange:P=>a(p,"enabled",P.target.checked),className:"mr-2"}),o.jsx("span",{className:"text-sm text-gray-600",children:"Habilitado"})]})]}),n[p].enabled&&o.jsxs("div",{className:"space-y-4",children:[E.map(P=>o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:P.label}),P.type==="select"?o.jsx("select",{value:n[p][P.name],onChange:A=>a(p,P.name,A.target.value),className:"w-full p-2 border rounded-md",children:P.options.map(A=>o.jsx("option",{value:A.value,children:A.label},A.value))}):o.jsx("input",{type:P.type,value:n[p][P.name],onChange:A=>a(p,P.name,A.target.value),placeholder:P.placeholder,className:"w-full p-2 border rounded-md"}),P.help&&o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:P.help})]},P.name)),o.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-md",children:[o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",checked:n[p].autoApprove,onChange:P=>a(p,"autoApprove",P.target.checked),className:"mr-2"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Aprobar pagos automáticamente"})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Los pagos de esta pasarela se marcarán como "Completado" automáticamente'})]})]})]});return o.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[o.jsx(Ym,{}),"Configuración de Pagos"]}),o.jsx("button",{onClick:g,disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:i?"Guardando...":"Guardar Configuración"})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuración General"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Moneda por Defecto"}),o.jsxs("select",{value:n.general.currency,onChange:p=>l("currency",p.target.value),className:"w-full p-2 border rounded-md",children:[o.jsx("option",{value:"USD",children:"USD - Dólar Americano"}),o.jsx("option",{value:"COP",children:"COP - Peso Colombiano"}),o.jsx("option",{value:"EUR",children:"EUR - Euro"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pasarela por Defecto"}),o.jsxs("select",{value:n.general.defaultGateway,onChange:p=>l("defaultGateway",p.target.value),className:"w-full p-2 border rounded-md",children:[o.jsx("option",{value:"bold",children:"Bold"}),o.jsx("option",{value:"paypal",children:"PayPal"}),o.jsx("option",{value:"payu",children:"PayU"}),o.jsx("option",{value:"bankTransfer",children:"Transferencia Bancaria"})]})]})]}),o.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Cada pasarela tiene su propia configuración de auto-aprobación independiente."})]}),y("bold","Bold",[{name:"apiKey",label:"API Key",type:"password",placeholder:"Ingresa tu API Key de Bold"},{name:"environment",label:"Ambiente",type:"select",options:[{value:"sandbox",label:"Sandbox (Pruebas)"},{value:"production",label:"Producción"}]},{name:"webhookSecret",label:"Webhook Secret",type:"password",placeholder:"Secreto para webhooks"}]),y("paypal","PayPal",[{name:"clientId",label:"Client ID",type:"text",placeholder:"Ingresa tu Client ID de PayPal"},{name:"clientSecret",label:"Client Secret",type:"password",placeholder:"Ingresa tu Client Secret"},{name:"environment",label:"Ambiente",type:"select",options:[{value:"sandbox",label:"Sandbox (Pruebas)"},{value:"live",label:"Live (Producción)"}]}]),y("payu","PayU",[{name:"merchantId",label:"Merchant ID",type:"text",placeholder:"ID del comerciante"},{name:"apiKey",label:"API Key",type:"password",placeholder:"API Key de PayU"},{name:"apiLogin",label:"API Login",type:"text",placeholder:"API Login de PayU"},{name:"environment",label:"Ambiente",type:"select",options:[{value:"sandbox",label:"Sandbox (Pruebas)"},{value:"production",label:"Producción"}]}]),o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[o.jsx(Yi,{}),"Transferencias Bancarias"]}),o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",checked:n.bankTransfer.enabled,onChange:p=>a("bankTransfer","enabled",p.target.checked),className:"mr-2"}),o.jsx("span",{className:"text-sm text-gray-600",children:"Habilitado"})]})]}),n.bankTransfer.enabled&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"p-3 bg-gray-50 rounded-md",children:[o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",checked:n.bankTransfer.autoApprove,onChange:p=>a("bankTransfer","autoApprove",p.target.checked),className:"mr-2"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Aprobar transferencias automáticamente"})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Las transferencias se marcarán como "Completado" automáticamente'})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h4",{className:"text-md font-medium text-gray-800",children:"Cuentas Bancarias"}),o.jsx("button",{onClick:c,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700",children:"+ Agregar Cuenta"})]}),o.jsx("div",{className:"space-y-4",children:n.bankTransfer.accounts.map((p,T)=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h5",{className:"font-medium text-gray-700",children:["Cuenta ",T+1]}),o.jsx("button",{onClick:()=>f(p.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Eliminar"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Banco"}),o.jsx("input",{type:"text",value:p.bankName,onChange:E=>u(p.id,"bankName",E.target.value),placeholder:"Ej: Banco Nacional",className:"w-full p-2 border rounded-md"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Número de Cuenta"}),o.jsx("input",{type:"text",value:p.accountNumber,onChange:E=>u(p.id,"accountNumber",E.target.value),placeholder:"1234567890",className:"w-full p-2 border rounded-md"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titular de la Cuenta"}),o.jsx("input",{type:"text",value:p.accountHolder,onChange:E=>u(p.id,"accountHolder",E.target.value),placeholder:"Nombre del titular",className:"w-full p-2 border rounded-md"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Cuenta"}),o.jsxs("select",{value:p.accountType,onChange:E=>u(p.id,"accountType",E.target.value),className:"w-full p-2 border rounded-md",children:[o.jsx("option",{value:"Ahorros",children:"Ahorros"}),o.jsx("option",{value:"Corriente",children:"Corriente"})]})]})]})]},p.id))}),n.bankTransfer.accounts.length===0&&o.jsxs("div",{className:"text-center py-8 text-gray-500",children:[o.jsx("p",{children:"No hay cuentas bancarias configuradas"}),o.jsx("p",{className:"text-sm",children:'Haz clic en "Agregar Cuenta" para comenzar'})]})]})]})]}),o.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[o.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"⚠️ Información Importante"}),o.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[o.jsx("li",{children:"• Las credenciales se almacenan de forma segura en Firestore"}),o.jsx("li",{children:"• Siempre prueba en modo sandbox antes de usar en producción"}),o.jsx("li",{children:"• Mantén tus claves API seguras y no las compartas"}),o.jsx("li",{children:"• Los webhooks deben configurarse en cada pasarela de pago"})]})]})]})}function s8({isDemo:t}){const{addNotification:e}=kn(),[n,r]=fe.useState({renewalSettings:{enabled:!0,maxRenewalYears:3,autoRenewal:!0,gracePeriodDays:7,reminderDays:3},discounts:{monthly:{enabled:!1,discount:0,description:"Descuento por pago mensual"},quarterly:{enabled:!1,discount:5,description:"Descuento por pago trimestral"},semiAnnual:{enabled:!1,discount:10,description:"Descuento por pago semestral"},annual:{enabled:!1,discount:15,description:"Descuento por pago anual"},biennial:{enabled:!1,discount:25,description:"Descuento por pago bienal (2 años)"},triennial:{enabled:!1,discount:35,description:"Descuento por pago trienal (3 años)"}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"},documentSettings:{invoiceName:"Factura",receiptName:"Remisión",invoicePrefix:"FAC",receiptPrefix:"REM",invoiceNumberFormat:"FAC-{year}-{month}-{number}",receiptNumberFormat:"REM-{year}-{month}-{number}"},pricingSettings:{roundToNearest:100,minimumAmount:1e3,maximumAmount:1e7}}),[i,s]=fe.useState(!1);fe.useEffect(()=>{if(t){r({renewalSettings:{enabled:!0,maxRenewalYears:3,autoRenewal:!0,gracePeriodDays:7,reminderDays:3},discounts:{monthly:{enabled:!1,discount:0,description:"Descuento por pago mensual"},quarterly:{enabled:!0,discount:5,description:"Descuento por pago trimestral"},semiAnnual:{enabled:!0,discount:10,description:"Descuento por pago semestral"},annual:{enabled:!0,discount:15,description:"Descuento por pago anual"},biennial:{enabled:!0,discount:25,description:"Descuento por pago bienal (2 años)"},triennial:{enabled:!0,discount:35,description:"Descuento por pago trienal (3 años)"}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"},documentSettings:{invoiceName:"Factura",receiptName:"Remisión",invoicePrefix:"FAC",receiptPrefix:"REM",invoiceNumberFormat:"FAC-{year}-{month}-{number}",receiptNumberFormat:"REM-{year}-{month}-{number}"},pricingSettings:{roundToNearest:100,minimumAmount:1e3,maximumAmount:1e7}});return}const p=mt(qe,"artifacts",Be,"public","data","settings","renewalConfig"),T=nn(p,E=>{E.exists()&&r(E.data())});return()=>T()},[t]);const a=(p,T,E)=>{r(P=>({...P,[p]:{...P[p],[T]:E}}))},l=(p,T,E)=>{r(P=>({...P,discounts:{...P.discounts,[p]:{...P.discounts[p],[T]:E}}}))},c=async()=>{if(t){e("Configuración guardada (modo demo)","success");return}s(!0);try{const p=mt(qe,"artifacts",Be,"public","data","settings","renewalConfig");await va(p,n),e("Configuración de renovaciones guardada exitosamente","success")}catch(p){console.error("Error saving renewal config:",p),e("Error al guardar la configuración","error")}s(!1)},u=(p,T)=>{const E=n.discounts[T];if(!E.enabled)return p;const P=p*E.discount/100,A=p-P,L=Math.round(A/n.pricingSettings.roundToNearest)*n.pricingSettings.roundToNearest;return Math.max(L,n.pricingSettings.minimumAmount)},f=p=>{if(!n.taxSettings.ivaEnabled||n.taxSettings.ivaIncluded)return p;{const T=p*n.taxSettings.ivaPercentage/100;return p+T}},g=p=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(p),y=[{key:"monthly",label:"Mensual",months:1},{key:"quarterly",label:"Trimestral",months:3},{key:"semiAnnual",label:"Semestral",months:6},{key:"annual",label:"Anual",months:12},{key:"biennial",label:"Bienal (2 años)",months:24},{key:"triennial",label:"Trienal (3 años)",months:36}];return o.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[o.jsx(al,{}),"Configuración de Renovaciones"]}),o.jsx("button",{onClick:c,disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:i?"Guardando...":"Guardar Configuración"})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[o.jsx(Ym,{}),"Configuración General"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsx("div",{children:o.jsxs("label",{className:"flex items-center mb-2",children:[o.jsx("input",{type:"checkbox",checked:n.renewalSettings.enabled,onChange:p=>a("renewalSettings","enabled",p.target.checked),className:"mr-2"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Habilitar renovaciones automáticas"})]})}),o.jsx("div",{children:o.jsxs("label",{className:"flex items-center mb-2",children:[o.jsx("input",{type:"checkbox",checked:n.renewalSettings.autoRenewal,onChange:p=>a("renewalSettings","autoRenewal",p.target.checked),className:"mr-2"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Renovación automática"})]})}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Máximo de años para renovación"}),o.jsxs("select",{value:n.renewalSettings.maxRenewalYears,onChange:p=>a("renewalSettings","maxRenewalYears",parseInt(p.target.value)),className:"w-full p-2 border rounded-md",children:[o.jsx("option",{value:1,children:"1 año"}),o.jsx("option",{value:2,children:"2 años"}),o.jsx("option",{value:3,children:"3 años"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Días de gracia"}),o.jsx("input",{type:"number",value:n.renewalSettings.gracePeriodDays,onChange:p=>a("renewalSettings","gracePeriodDays",parseInt(p.target.value)),className:"w-full p-2 border rounded-md",min:"0",max:"30"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Días de recordatorio"}),o.jsx("input",{type:"number",value:n.renewalSettings.reminderDays,onChange:p=>a("renewalSettings","reminderDays",parseInt(p.target.value)),className:"w-full p-2 border rounded-md",min:"1",max:"30"})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[o.jsx(nA,{}),"Descuentos por Período de Renovación"]}),o.jsx("div",{className:"space-y-4",children:y.map(p=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h4",{className:"font-medium text-gray-800",children:p.label}),o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",checked:n.discounts[p.key].enabled,onChange:T=>l(p.key,"enabled",T.target.checked),className:"mr-2"}),o.jsx("span",{className:"text-sm text-gray-600",children:"Habilitado"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descuento (%)"}),o.jsx("input",{type:"number",value:n.discounts[p.key].discount,onChange:T=>l(p.key,"discount",parseFloat(T.target.value)),className:"w-full p-2 border rounded-md",min:"0",max:"100",step:"0.1",disabled:!n.discounts[p.key].enabled})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción"}),o.jsx("input",{type:"text",value:n.discounts[p.key].description,onChange:T=>l(p.key,"description",T.target.value),className:"w-full p-2 border rounded-md",disabled:!n.discounts[p.key].enabled})]})]}),n.discounts[p.key].enabled&&o.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-md",children:[o.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Simulación de Precio"}),o.jsxs("div",{className:"text-sm text-gray-600",children:[o.jsxs("div",{children:["Precio original: ",g(1e5)]}),o.jsxs("div",{children:["Descuento (",n.discounts[p.key].discount,"%): ",g(1e5-u(1e5,p.key))]}),o.jsxs("div",{className:"font-semibold text-green-600",children:["Precio final: ",g(u(1e5,p.key))]})]})]})]},p.key))})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[o.jsx(Yi,{}),"Configuración de Impuestos"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsx("div",{children:o.jsxs("label",{className:"flex items-center mb-2",children:[o.jsx("input",{type:"checkbox",checked:n.taxSettings.ivaEnabled,onChange:p=>a("taxSettings","ivaEnabled",p.target.checked),className:"mr-2"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Habilitar IVA"})]})}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Porcentaje de IVA (%)"}),o.jsx("input",{type:"number",value:n.taxSettings.ivaPercentage,onChange:p=>a("taxSettings","ivaPercentage",parseFloat(p.target.value)),className:"w-full p-2 border rounded-md",min:"0",max:"100",step:"0.1",disabled:!n.taxSettings.ivaEnabled})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de IVA"}),o.jsxs("select",{value:n.taxSettings.ivaIncluded?"included":"excluded",onChange:p=>a("taxSettings","ivaIncluded",p.target.value==="included"),className:"w-full p-2 border rounded-md",disabled:!n.taxSettings.ivaEnabled,children:[o.jsx("option",{value:"excluded",children:"IVA se suma al precio"}),o.jsx("option",{value:"included",children:"IVA incluido en el precio"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del impuesto"}),o.jsx("input",{type:"text",value:n.taxSettings.taxName,onChange:p=>a("taxSettings","taxName",p.target.value),className:"w-full p-2 border rounded-md",disabled:!n.taxSettings.ivaEnabled})]})]}),n.taxSettings.ivaEnabled&&o.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[o.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Simulación de Impuestos"}),o.jsxs("div",{className:"text-sm text-gray-600",children:[o.jsxs("div",{children:["Precio base: ",g(1e5)]}),!n.taxSettings.ivaIncluded&&o.jsxs("div",{children:["IVA (",n.taxSettings.ivaPercentage,"%): ",g(1e5*n.taxSettings.ivaPercentage/100)]}),o.jsxs("div",{className:"font-semibold text-blue-600",children:["Precio final: ",g(f(1e5))]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuración de Documentos"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de Factura"}),o.jsx("input",{type:"text",value:n.documentSettings.invoiceName,onChange:p=>a("documentSettings","invoiceName",p.target.value),className:"w-full p-2 border rounded-md"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de Remisión"}),o.jsx("input",{type:"text",value:n.documentSettings.receiptName,onChange:p=>a("documentSettings","receiptName",p.target.value),className:"w-full p-2 border rounded-md"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prefijo de Factura"}),o.jsx("input",{type:"text",value:n.documentSettings.invoicePrefix,onChange:p=>a("documentSettings","invoicePrefix",p.target.value),className:"w-full p-2 border rounded-md"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prefijo de Remisión"}),o.jsx("input",{type:"text",value:n.documentSettings.receiptPrefix,onChange:p=>a("documentSettings","receiptPrefix",p.target.value),className:"w-full p-2 border rounded-md"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Formato de Número de Factura"}),o.jsx("input",{type:"text",value:n.documentSettings.invoiceNumberFormat,onChange:p=>a("documentSettings","invoiceNumberFormat",p.target.value),className:"w-full p-2 border rounded-md",placeholder:"FAC-{year}-{month}-{number}"}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables disponibles: ","{year}",", ","{month}",", ","{number}"]})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Formato de Número de Remisión"}),o.jsx("input",{type:"text",value:n.documentSettings.receiptNumberFormat,onChange:p=>a("documentSettings","receiptNumberFormat",p.target.value),className:"w-full p-2 border rounded-md",placeholder:"REM-{year}-{month}-{number}"}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables disponibles: ","{year}",", ","{month}",", ","{number}"]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuración de Precios"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Redondear al múltiplo más cercano"}),o.jsx("input",{type:"number",value:n.pricingSettings.roundToNearest,onChange:p=>a("pricingSettings","roundToNearest",parseInt(p.target.value)),className:"w-full p-2 border rounded-md",min:"1"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ej: 100 para redondear a centenas"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto mínimo"}),o.jsx("input",{type:"number",value:n.pricingSettings.minimumAmount,onChange:p=>a("pricingSettings","minimumAmount",parseInt(p.target.value)),className:"w-full p-2 border rounded-md",min:"0"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto máximo"}),o.jsx("input",{type:"number",value:n.pricingSettings.maximumAmount,onChange:p=>a("pricingSettings","maximumAmount",parseInt(p.target.value)),className:"w-full p-2 border rounded-md",min:"0"})]})]})]}),o.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[o.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"⚠️ Información Importante"}),o.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[o.jsx("li",{children:"• Los descuentos se aplican automáticamente según el período de renovación seleccionado"}),o.jsx("li",{children:"• Los precios se redondean automáticamente para evitar decimales"}),o.jsx("li",{children:"• El IVA se calcula según la configuración establecida"}),o.jsx("li",{children:"• Los nombres de documentos se pueden personalizar según las necesidades"})]})]})]})}const a8="modulepreload",o8=function(t){return"/"+t},a5={},Jg=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(n.map(c=>{if(c=o8(c),c in a5)return;a5[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":a8,u||(g.as="script"),g.crossOrigin="",g.href=c,l&&g.setAttribute("nonce",l),document.head.appendChild(g),u)return new Promise((y,p)=>{g.addEventListener("load",y),g.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return i.then(a=>{for(const l of a||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};function dn(t){"@babel/helpers - typeof";return dn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dn(t)}var Ms=Uint8Array,Gi=Uint16Array,U2=Int32Array,B2=new Ms([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),q2=new Ms([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o5=new Ms([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),iA=function(t,e){for(var n=new Gi(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var i=new U2(n[30]),r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return{b:n,r:i}},sA=iA(B2,2),l8=sA.b,F1=sA.r;l8[28]=258,F1[258]=28;var c8=iA(q2,0),l5=c8.r,V1=new Gi(32768);for(var Tn=0;Tn<32768;++Tn){var Do=(Tn&43690)>>1|(Tn&21845)<<1;Do=(Do&52428)>>2|(Do&13107)<<2,Do=(Do&61680)>>4|(Do&3855)<<4,V1[Tn]=((Do&65280)>>8|(Do&255)<<8)>>1}var Fd=function(t,e,n){for(var r=t.length,i=0,s=new Gi(e);i<r;++i)t[i]&&++s[t[i]-1];var a=new Gi(e);for(i=1;i<e;++i)a[i]=a[i-1]+s[i-1]<<1;var l;if(n){l=new Gi(1<<e);var c=15-e;for(i=0;i<r;++i)if(t[i])for(var u=i<<4|t[i],f=e-t[i],g=a[t[i]-1]++<<f,y=g|(1<<f)-1;g<=y;++g)l[V1[g]>>c]=u}else for(l=new Gi(r),i=0;i<r;++i)t[i]&&(l[i]=V1[a[t[i]-1]++]>>15-t[i]);return l},uc=new Ms(288);for(var Tn=0;Tn<144;++Tn)uc[Tn]=8;for(var Tn=144;Tn<256;++Tn)uc[Tn]=9;for(var Tn=256;Tn<280;++Tn)uc[Tn]=7;for(var Tn=280;Tn<288;++Tn)uc[Tn]=8;var rm=new Ms(32);for(var Tn=0;Tn<32;++Tn)rm[Tn]=5;var u8=Fd(uc,9,0),d8=Fd(rm,5,0),aA=function(t){return(t+7)/8|0},h8=function(t,e,n){return(n==null||n>t.length)&&(n=t.length),new Ms(t.subarray(e,n))},Ma=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8},hd=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8,t[r+2]|=n>>16},Zg=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var i=n.length,s=n.slice();if(!i)return{t:lA,l:0};if(i==1){var a=new Ms(n[0].s+1);return a[n[0].s]=1,{t:a,l:1}}n.sort(function(te,ae){return te.f-ae.f}),n.push({s:-1,f:25001});var l=n[0],c=n[1],u=0,f=1,g=2;for(n[0]={s:-1,f:l.f+c.f,l,r:c};f!=i-1;)l=n[n[u].f<n[g].f?u++:g++],c=n[u!=f&&n[u].f<n[g].f?u++:g++],n[f++]={s:-1,f:l.f+c.f,l,r:c};for(var y=s[0].s,r=1;r<i;++r)s[r].s>y&&(y=s[r].s);var p=new Gi(y+1),T=U1(n[f-1],p,0);if(T>e){var r=0,E=0,P=T-e,A=1<<P;for(s.sort(function(ae,B){return p[B.s]-p[ae.s]||ae.f-B.f});r<i;++r){var L=s[r].s;if(p[L]>e)E+=A-(1<<T-p[L]),p[L]=e;else break}for(E>>=P;E>0;){var M=s[r].s;p[M]<e?E-=1<<e-p[M]++-1:++r}for(;r>=0&&E;--r){var F=s[r].s;p[F]==e&&(--p[F],++E)}T=e}return{t:new Ms(p),l:T}},U1=function(t,e,n){return t.s==-1?Math.max(U1(t.l,e,n+1),U1(t.r,e,n+1)):e[t.s]=n},c5=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new Gi(++e),r=0,i=t[0],s=1,a=function(c){n[r++]=c},l=1;l<=e;++l)if(t[l]==i&&l!=e)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=t[l]}return{c:n.subarray(0,r),n:e}},fd=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},oA=function(t,e,n){var r=n.length,i=aA(e+2);t[i]=r&255,t[i+1]=r>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var s=0;s<r;++s)t[i+s+4]=n[s];return(i+4+r)*8},u5=function(t,e,n,r,i,s,a,l,c,u,f){Ma(e,f++,n),++i[256];for(var g=Zg(i,15),y=g.t,p=g.l,T=Zg(s,15),E=T.t,P=T.l,A=c5(y),L=A.c,M=A.n,F=c5(E),te=F.c,ae=F.n,B=new Gi(19),I=0;I<L.length;++I)++B[L[I]&31];for(var I=0;I<te.length;++I)++B[te[I]&31];for(var j=Zg(B,7),S=j.t,N=j.l,w=19;w>4&&!S[o5[w-1]];--w);var k=u+5<<3,H=fd(i,uc)+fd(s,rm)+a,D=fd(i,y)+fd(s,E)+a+14+3*w+fd(B,S)+2*B[16]+3*B[17]+7*B[18];if(c>=0&&k<=H&&k<=D)return oA(e,f,t.subarray(c,c+u));var W,K,q,ee;if(Ma(e,f,1+(D<H)),f+=2,D<H){W=Fd(y,p,0),K=y,q=Fd(E,P,0),ee=E;var ue=Fd(S,N,0);Ma(e,f,M-257),Ma(e,f+5,ae-1),Ma(e,f+10,w-4),f+=14;for(var I=0;I<w;++I)Ma(e,f+3*I,S[o5[I]]);f+=3*w;for(var ce=[L,te],_=0;_<2;++_)for(var z=ce[_],I=0;I<z.length;++I){var O=z[I]&31;Ma(e,f,ue[O]),f+=S[O],O>15&&(Ma(e,f,z[I]>>5&127),f+=z[I]>>12)}}else W=u8,K=uc,q=d8,ee=rm;for(var I=0;I<l;++I){var X=r[I];if(X>255){var O=X>>18&31;hd(e,f,W[O+257]),f+=K[O+257],O>7&&(Ma(e,f,X>>23&31),f+=B2[O]);var Z=X&31;hd(e,f,q[Z]),f+=ee[Z],Z>3&&(hd(e,f,X>>5&8191),f+=q2[Z])}else hd(e,f,W[X]),f+=K[X]}return hd(e,f,W[256]),f+K[256]},f8=new U2([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),lA=new Ms(0),p8=function(t,e,n,r,i,s){var a=s.z||t.length,l=new Ms(r+a+5*(1+Math.ceil(a/7e3))+i),c=l.subarray(r,l.length-i),u=s.l,f=(s.r||0)&7;if(e){f&&(c[0]=s.r>>3);for(var g=f8[e-1],y=g>>13,p=g&8191,T=(1<<n)-1,E=s.p||new Gi(32768),P=s.h||new Gi(T+1),A=Math.ceil(n/3),L=2*A,M=function(Ne){return(t[Ne]^t[Ne+1]<<A^t[Ne+2]<<L)&T},F=new U2(25e3),te=new Gi(288),ae=new Gi(32),B=0,I=0,j=s.i||0,S=0,N=s.w||0,w=0;j+2<a;++j){var k=M(j),H=j&32767,D=P[k];if(E[H]=D,P[k]=H,N<=j){var W=a-j;if((B>7e3||S>24576)&&(W>423||!u)){f=u5(t,c,0,F,te,ae,I,S,w,j-w,f),S=B=I=0,w=j;for(var K=0;K<286;++K)te[K]=0;for(var K=0;K<30;++K)ae[K]=0}var q=2,ee=0,ue=p,ce=H-D&32767;if(W>2&&k==M(j-ce))for(var _=Math.min(y,W)-1,z=Math.min(32767,j),O=Math.min(258,W);ce<=z&&--ue&&H!=D;){if(t[j+q]==t[j+q-ce]){for(var X=0;X<O&&t[j+X]==t[j+X-ce];++X);if(X>q){if(q=X,ee=ce,X>_)break;for(var Z=Math.min(ce,X-2),le=0,K=0;K<Z;++K){var me=j-ce+K&32767,ye=E[me],xe=me-ye&32767;xe>le&&(le=xe,D=me)}}}H=D,D=E[H],ce+=H-D&32767}if(ee){F[S++]=268435456|F1[q]<<18|l5[ee];var ke=F1[q]&31,Ve=l5[ee]&31;I+=B2[ke]+q2[Ve],++te[257+ke],++ae[Ve],N=j+q,++B}else F[S++]=t[j],++te[t[j]]}}for(j=Math.max(j,N);j<a;++j)F[S++]=t[j],++te[t[j]];f=u5(t,c,u,F,te,ae,I,S,w,j-w,f),u||(s.r=f&7|c[f/8|0]<<3,f-=7,s.h=P,s.p=E,s.i=j,s.w=N)}else{for(var j=s.w||0;j<a+u;j+=65535){var Ue=j+65535;Ue>=a&&(c[f/8|0]=u,Ue=a),f=oA(c,f+1,t.subarray(j,Ue))}s.i=a}return h8(l,0,r+aA(f)+i)},cA=function(){var t=1,e=0;return{p:function(n){for(var r=t,i=e,s=n.length|0,a=0;a!=s;){for(var l=Math.min(a+2655,s);a<l;++a)i+=r+=n[a];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}t=r,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},m8=function(t,e,n,r,i){if(!i&&(i={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),a=new Ms(s.length+t.length);a.set(s),a.set(t,s.length),t=a,i.w=s.length}return p8(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,r,i)},uA=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},g8=function(t,e){var n=e.level,r=n==0?0:n<6?1:n==9?3:2;if(t[0]=120,t[1]=r<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=cA();i.p(e.dictionary),uA(t,2,i.d())}};function B1(t,e){e||(e={});var n=cA();n.p(t);var r=m8(t,e,e.dictionary?6:2,4);return g8(r,e),uA(r,r.length-4,n.d()),r}var v8=typeof TextDecoder<"u"&&new TextDecoder,y8=0;try{v8.decode(lA,{stream:!0}),y8=1}catch{}function x8(t){if(Array.isArray(t))return t}function b8(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,l=[],c=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(c=(r=s.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(f){u=!0,i=f}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}function d5(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function w8(t,e){if(t){if(typeof t=="string")return d5(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d5(t,e):void 0}}function _8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h5(t,e){return x8(t)||b8(t,e)||w8(t,e)||_8()}function f5(t,e="utf8"){return new TextDecoder(e).decode(t)}const N8=new TextEncoder;function A8(t){return N8.encode(t)}const S8=1024*8,E8=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),e0={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class z2{constructor(e=S8,n={}){un(this,"buffer");un(this,"byteLength");un(this,"byteOffset");un(this,"length");un(this,"offset");un(this,"lastWrittenByte");un(this,"littleEndian");un(this,"_data");un(this,"_mark");un(this,"_marks");let r=!1;typeof e=="number"?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);const i=n.offset?n.offset>>>0:0,s=e.byteLength-i;let a=i;(ArrayBuffer.isView(e)||e instanceof z2)&&(e.byteLength!==e.buffer.byteLength&&(a=e.byteOffset+i),e=e.buffer),r?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=a,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,a,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const r=(this.offset+e)*2,i=new Uint8Array(r);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,n){const r=e0[n].BYTES_PER_ELEMENT*e,i=this.byteOffset+this.offset,s=this.buffer.slice(i,i+r);if(this.littleEndian===E8&&n!=="uint8"&&n!=="int8"){const l=new Uint8Array(this.buffer.slice(i,i+r));l.reverse();const c=new e0[n](l.buffer);return this.offset+=r,c.reverse(),c}const a=new e0[n](s);return this.offset+=r,a}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let n="";for(let r=0;r<e;r++)n+=this.readChar();return n}readUtf8(e=1){return f5(this.readBytes(e))}decodeText(e=1,n="utf8"){return f5(this.readBytes(e),n)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let n=0;n<e.length;n++)this._data.setUint8(this.offset++,e[n]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let n=0;n<e.length;n++)this.writeUint8(e.charCodeAt(n));return this}writeUtf8(e){return this.writeBytes(A8(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Du(t){let e=t.length;for(;--e>=0;)t[e]=0}const T8=3,C8=258,dA=29,k8=256,I8=k8+1+dA,hA=30,j8=512,P8=new Array((I8+2)*2);Du(P8);const L8=new Array(hA*2);Du(L8);const R8=new Array(j8);Du(R8);const D8=new Array(C8-T8+1);Du(D8);const O8=new Array(dA);Du(O8);const M8=new Array(hA);Du(M8);const F8=(t,e,n,r)=>{let i=t&65535|0,s=t>>>16&65535|0,a=0;for(;n!==0;){a=n>2e3?2e3:n,n-=a;do i=i+e[r++]|0,s=s+i|0;while(--a);i%=65521,s%=65521}return i|s<<16|0};var q1=F8;const V8=()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e},U8=new Uint32Array(V8()),B8=(t,e,n,r)=>{const i=U8,s=r+n;t^=-1;for(let a=r;a<s;a++)t=t>>>8^i[(t^e[a])&255];return t^-1};var ra=B8,z1={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},fA={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const q8=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var z8=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)q8(n,r)&&(t[r]=n[r])}}return t},$8=t=>{let e=0;for(let r=0,i=t.length;r<i;r++)e+=t[r].length;const n=new Uint8Array(e);for(let r=0,i=0,s=t.length;r<s;r++){let a=t[r];n.set(a,i),i+=a.length}return n},pA={assign:z8,flattenChunks:$8};let mA=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{mA=!1}const fh=new Uint8Array(256);for(let t=0;t<256;t++)fh[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;fh[254]=fh[254]=1;var H8=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,n,r,i,s,a=t.length,l=0;for(i=0;i<a;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<a&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(l),s=0,i=0;s<l;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<a&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|n&63):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|n&63):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|n&63);return e};const W8=(t,e)=>{if(e<65534&&t.subarray&&mA)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n};var G8=(t,e)=>{const n=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let r,i;const s=new Array(n*2);for(i=0,r=0;r<n;){let a=t[r++];if(a<128){s[i++]=a;continue}let l=fh[a];if(l>4){s[i++]=65533,r+=l-1;continue}for(a&=l===2?31:l===3?15:7;l>1&&r<n;)a=a<<6|t[r++]&63,l--;if(l>1){s[i++]=65533;continue}a<65536?s[i++]=a:(a-=65536,s[i++]=55296|a>>10&1023,s[i++]=56320|a&1023)}return W8(s,i)},K8=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let n=e-1;for(;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?e:n+fh[t[n]]>e?n:e},$1={string2buf:H8,buf2string:G8,utf8border:K8};function Y8(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Q8=Y8;const Ef=16209,X8=16191;var J8=function(e,n){let r,i,s,a,l,c,u,f,g,y,p,T,E,P,A,L,M,F,te,ae,B,I,j,S;const N=e.state;r=e.next_in,j=e.input,i=r+(e.avail_in-5),s=e.next_out,S=e.output,a=s-(n-e.avail_out),l=s+(e.avail_out-257),c=N.dmax,u=N.wsize,f=N.whave,g=N.wnext,y=N.window,p=N.hold,T=N.bits,E=N.lencode,P=N.distcode,A=(1<<N.lenbits)-1,L=(1<<N.distbits)-1;e:do{T<15&&(p+=j[r++]<<T,T+=8,p+=j[r++]<<T,T+=8),M=E[p&A];t:for(;;){if(F=M>>>24,p>>>=F,T-=F,F=M>>>16&255,F===0)S[s++]=M&65535;else if(F&16){te=M&65535,F&=15,F&&(T<F&&(p+=j[r++]<<T,T+=8),te+=p&(1<<F)-1,p>>>=F,T-=F),T<15&&(p+=j[r++]<<T,T+=8,p+=j[r++]<<T,T+=8),M=P[p&L];n:for(;;){if(F=M>>>24,p>>>=F,T-=F,F=M>>>16&255,F&16){if(ae=M&65535,F&=15,T<F&&(p+=j[r++]<<T,T+=8,T<F&&(p+=j[r++]<<T,T+=8)),ae+=p&(1<<F)-1,ae>c){e.msg="invalid distance too far back",N.mode=Ef;break e}if(p>>>=F,T-=F,F=s-a,ae>F){if(F=ae-F,F>f&&N.sane){e.msg="invalid distance too far back",N.mode=Ef;break e}if(B=0,I=y,g===0){if(B+=u-F,F<te){te-=F;do S[s++]=y[B++];while(--F);B=s-ae,I=S}}else if(g<F){if(B+=u+g-F,F-=g,F<te){te-=F;do S[s++]=y[B++];while(--F);if(B=0,g<te){F=g,te-=F;do S[s++]=y[B++];while(--F);B=s-ae,I=S}}}else if(B+=g-F,F<te){te-=F;do S[s++]=y[B++];while(--F);B=s-ae,I=S}for(;te>2;)S[s++]=I[B++],S[s++]=I[B++],S[s++]=I[B++],te-=3;te&&(S[s++]=I[B++],te>1&&(S[s++]=I[B++]))}else{B=s-ae;do S[s++]=S[B++],S[s++]=S[B++],S[s++]=S[B++],te-=3;while(te>2);te&&(S[s++]=S[B++],te>1&&(S[s++]=S[B++]))}}else if(F&64){e.msg="invalid distance code",N.mode=Ef;break e}else{M=P[(M&65535)+(p&(1<<F)-1)];continue n}break}}else if(F&64)if(F&32){N.mode=X8;break e}else{e.msg="invalid literal/length code",N.mode=Ef;break e}else{M=E[(M&65535)+(p&(1<<F)-1)];continue t}break}}while(r<i&&s<l);te=T>>3,r-=te,T-=te<<3,p&=(1<<T)-1,e.next_in=r,e.next_out=s,e.avail_in=r<i?5+(i-r):5-(r-i),e.avail_out=s<l?257+(l-s):257-(s-l),N.hold=p,N.bits=T};const Tc=15,p5=852,m5=592,g5=0,t0=1,v5=2,Z8=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),e7=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),t7=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),n7=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),r7=(t,e,n,r,i,s,a,l)=>{const c=l.bits;let u=0,f=0,g=0,y=0,p=0,T=0,E=0,P=0,A=0,L=0,M,F,te,ae,B,I=null,j;const S=new Uint16Array(Tc+1),N=new Uint16Array(Tc+1);let w=null,k,H,D;for(u=0;u<=Tc;u++)S[u]=0;for(f=0;f<r;f++)S[e[n+f]]++;for(p=c,y=Tc;y>=1&&S[y]===0;y--);if(p>y&&(p=y),y===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,l.bits=1,0;for(g=1;g<y&&S[g]===0;g++);for(p<g&&(p=g),P=1,u=1;u<=Tc;u++)if(P<<=1,P-=S[u],P<0)return-1;if(P>0&&(t===g5||y!==1))return-1;for(N[1]=0,u=1;u<Tc;u++)N[u+1]=N[u]+S[u];for(f=0;f<r;f++)e[n+f]!==0&&(a[N[e[n+f]]++]=f);if(t===g5?(I=w=a,j=20):t===t0?(I=Z8,w=e7,j=257):(I=t7,w=n7,j=0),L=0,f=0,u=g,B=s,T=p,E=0,te=-1,A=1<<p,ae=A-1,t===t0&&A>p5||t===v5&&A>m5)return 1;for(;;){k=u-E,a[f]+1<j?(H=0,D=a[f]):a[f]>=j?(H=w[a[f]-j],D=I[a[f]-j]):(H=96,D=0),M=1<<u-E,F=1<<T,g=F;do F-=M,i[B+(L>>E)+F]=k<<24|H<<16|D|0;while(F!==0);for(M=1<<u-1;L&M;)M>>=1;if(M!==0?(L&=M-1,L+=M):L=0,f++,--S[u]===0){if(u===y)break;u=e[n+a[f]]}if(u>p&&(L&ae)!==te){for(E===0&&(E=p),B+=g,T=u-E,P=1<<T;T+E<y&&(P-=S[T+E],!(P<=0));)T++,P<<=1;if(A+=1<<T,t===t0&&A>p5||t===v5&&A>m5)return 1;te=L&ae,i[te]=p<<24|T<<16|B-s|0}}return L!==0&&(i[B+L]=u-E<<24|64<<16|0),l.bits=p,0};var Vd=r7;const i7=0,gA=1,vA=2,{Z_FINISH:y5,Z_BLOCK:s7,Z_TREES:Tf,Z_OK:dc,Z_STREAM_END:a7,Z_NEED_DICT:o7,Z_STREAM_ERROR:gs,Z_DATA_ERROR:yA,Z_MEM_ERROR:xA,Z_BUF_ERROR:l7,Z_DEFLATED:x5}=fA,Qm=16180,b5=16181,w5=16182,_5=16183,N5=16184,A5=16185,S5=16186,E5=16187,T5=16188,C5=16189,im=16190,Fa=16191,n0=16192,k5=16193,r0=16194,I5=16195,j5=16196,P5=16197,L5=16198,Cf=16199,kf=16200,R5=16201,D5=16202,O5=16203,M5=16204,F5=16205,i0=16206,V5=16207,U5=16208,Ln=16209,bA=16210,wA=16211,c7=852,u7=592,d7=15,h7=d7,B5=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function f7(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const yc=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Qm||e.mode>wA?1:0},_A=t=>{if(yc(t))return gs;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=Qm,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(c7),e.distcode=e.distdyn=new Int32Array(u7),e.sane=1,e.back=-1,dc},NA=t=>{if(yc(t))return gs;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,_A(t)},AA=(t,e)=>{let n;if(yc(t))return gs;const r=t.state;return e<0?(n=0,e=-e):(n=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?gs:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,NA(t))},SA=(t,e)=>{if(!t)return gs;const n=new f7;t.state=n,n.strm=t,n.window=null,n.mode=Qm;const r=AA(t,e);return r!==dc&&(t.state=null),r},p7=t=>SA(t,h7);let q5=!0,s0,a0;const m7=t=>{if(q5){s0=new Int32Array(512),a0=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Vd(gA,t.lens,0,288,s0,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Vd(vA,t.lens,0,32,a0,0,t.work,{bits:5}),q5=!1}t.lencode=s0,t.lenbits=9,t.distcode=a0,t.distbits=5},EA=(t,e,n,r)=>{let i;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(e.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(e.subarray(n-r,n-r+i),s.wnext),r-=i,r?(s.window.set(e.subarray(n-r,n),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},g7=(t,e)=>{let n,r,i,s,a,l,c,u,f,g,y,p,T,E,P=0,A,L,M,F,te,ae,B,I;const j=new Uint8Array(4);let S,N;const w=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(yc(t)||!t.output||!t.input&&t.avail_in!==0)return gs;n=t.state,n.mode===Fa&&(n.mode=n0),a=t.next_out,i=t.output,c=t.avail_out,s=t.next_in,r=t.input,l=t.avail_in,u=n.hold,f=n.bits,g=l,y=c,I=dc;e:for(;;)switch(n.mode){case Qm:if(n.wrap===0){n.mode=n0;break}for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.wrap&2&&u===35615){n.wbits===0&&(n.wbits=15),n.check=0,j[0]=u&255,j[1]=u>>>8&255,n.check=ra(n.check,j,2,0),u=0,f=0,n.mode=b5;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",n.mode=Ln;break}if((u&15)!==x5){t.msg="unknown compression method",n.mode=Ln;break}if(u>>>=4,f-=4,B=(u&15)+8,n.wbits===0&&(n.wbits=B),B>15||B>n.wbits){t.msg="invalid window size",n.mode=Ln;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=u&512?C5:Fa,u=0,f=0;break;case b5:for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.flags=u,(n.flags&255)!==x5){t.msg="unknown compression method",n.mode=Ln;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=Ln;break}n.head&&(n.head.text=u>>8&1),n.flags&512&&n.wrap&4&&(j[0]=u&255,j[1]=u>>>8&255,n.check=ra(n.check,j,2,0)),u=0,f=0,n.mode=w5;case w5:for(;f<32;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.head&&(n.head.time=u),n.flags&512&&n.wrap&4&&(j[0]=u&255,j[1]=u>>>8&255,j[2]=u>>>16&255,j[3]=u>>>24&255,n.check=ra(n.check,j,4,0)),u=0,f=0,n.mode=_5;case _5:for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.head&&(n.head.xflags=u&255,n.head.os=u>>8),n.flags&512&&n.wrap&4&&(j[0]=u&255,j[1]=u>>>8&255,n.check=ra(n.check,j,2,0)),u=0,f=0,n.mode=N5;case N5:if(n.flags&1024){for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.length=u,n.head&&(n.head.extra_len=u),n.flags&512&&n.wrap&4&&(j[0]=u&255,j[1]=u>>>8&255,n.check=ra(n.check,j,2,0)),u=0,f=0}else n.head&&(n.head.extra=null);n.mode=A5;case A5:if(n.flags&1024&&(p=n.length,p>l&&(p=l),p&&(n.head&&(B=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(s,s+p),B)),n.flags&512&&n.wrap&4&&(n.check=ra(n.check,r,p,s)),l-=p,s+=p,n.length-=p),n.length))break e;n.length=0,n.mode=S5;case S5:if(n.flags&2048){if(l===0)break e;p=0;do B=r[s+p++],n.head&&B&&n.length<65536&&(n.head.name+=String.fromCharCode(B));while(B&&p<l);if(n.flags&512&&n.wrap&4&&(n.check=ra(n.check,r,p,s)),l-=p,s+=p,B)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=E5;case E5:if(n.flags&4096){if(l===0)break e;p=0;do B=r[s+p++],n.head&&B&&n.length<65536&&(n.head.comment+=String.fromCharCode(B));while(B&&p<l);if(n.flags&512&&n.wrap&4&&(n.check=ra(n.check,r,p,s)),l-=p,s+=p,B)break e}else n.head&&(n.head.comment=null);n.mode=T5;case T5:if(n.flags&512){for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.wrap&4&&u!==(n.check&65535)){t.msg="header crc mismatch",n.mode=Ln;break}u=0,f=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=Fa;break;case C5:for(;f<32;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}t.adler=n.check=B5(u),u=0,f=0,n.mode=im;case im:if(n.havedict===0)return t.next_out=a,t.avail_out=c,t.next_in=s,t.avail_in=l,n.hold=u,n.bits=f,o7;t.adler=n.check=1,n.mode=Fa;case Fa:if(e===s7||e===Tf)break e;case n0:if(n.last){u>>>=f&7,f-=f&7,n.mode=i0;break}for(;f<3;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}switch(n.last=u&1,u>>>=1,f-=1,u&3){case 0:n.mode=k5;break;case 1:if(m7(n),n.mode=Cf,e===Tf){u>>>=2,f-=2;break e}break;case 2:n.mode=j5;break;case 3:t.msg="invalid block type",n.mode=Ln}u>>>=2,f-=2;break;case k5:for(u>>>=f&7,f-=f&7;f<32;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if((u&65535)!==(u>>>16^65535)){t.msg="invalid stored block lengths",n.mode=Ln;break}if(n.length=u&65535,u=0,f=0,n.mode=r0,e===Tf)break e;case r0:n.mode=I5;case I5:if(p=n.length,p){if(p>l&&(p=l),p>c&&(p=c),p===0)break e;i.set(r.subarray(s,s+p),a),l-=p,s+=p,c-=p,a+=p,n.length-=p;break}n.mode=Fa;break;case j5:for(;f<14;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.nlen=(u&31)+257,u>>>=5,f-=5,n.ndist=(u&31)+1,u>>>=5,f-=5,n.ncode=(u&15)+4,u>>>=4,f-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=Ln;break}n.have=0,n.mode=P5;case P5:for(;n.have<n.ncode;){for(;f<3;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.lens[w[n.have++]]=u&7,u>>>=3,f-=3}for(;n.have<19;)n.lens[w[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,S={bits:n.lenbits},I=Vd(i7,n.lens,0,19,n.lencode,0,n.work,S),n.lenbits=S.bits,I){t.msg="invalid code lengths set",n.mode=Ln;break}n.have=0,n.mode=L5;case L5:for(;n.have<n.nlen+n.ndist;){for(;P=n.lencode[u&(1<<n.lenbits)-1],A=P>>>24,L=P>>>16&255,M=P&65535,!(A<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(M<16)u>>>=A,f-=A,n.lens[n.have++]=M;else{if(M===16){for(N=A+2;f<N;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(u>>>=A,f-=A,n.have===0){t.msg="invalid bit length repeat",n.mode=Ln;break}B=n.lens[n.have-1],p=3+(u&3),u>>>=2,f-=2}else if(M===17){for(N=A+3;f<N;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}u>>>=A,f-=A,B=0,p=3+(u&7),u>>>=3,f-=3}else{for(N=A+7;f<N;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}u>>>=A,f-=A,B=0,p=11+(u&127),u>>>=7,f-=7}if(n.have+p>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=Ln;break}for(;p--;)n.lens[n.have++]=B}}if(n.mode===Ln)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=Ln;break}if(n.lenbits=9,S={bits:n.lenbits},I=Vd(gA,n.lens,0,n.nlen,n.lencode,0,n.work,S),n.lenbits=S.bits,I){t.msg="invalid literal/lengths set",n.mode=Ln;break}if(n.distbits=6,n.distcode=n.distdyn,S={bits:n.distbits},I=Vd(vA,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,S),n.distbits=S.bits,I){t.msg="invalid distances set",n.mode=Ln;break}if(n.mode=Cf,e===Tf)break e;case Cf:n.mode=kf;case kf:if(l>=6&&c>=258){t.next_out=a,t.avail_out=c,t.next_in=s,t.avail_in=l,n.hold=u,n.bits=f,J8(t,y),a=t.next_out,i=t.output,c=t.avail_out,s=t.next_in,r=t.input,l=t.avail_in,u=n.hold,f=n.bits,n.mode===Fa&&(n.back=-1);break}for(n.back=0;P=n.lencode[u&(1<<n.lenbits)-1],A=P>>>24,L=P>>>16&255,M=P&65535,!(A<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(L&&!(L&240)){for(F=A,te=L,ae=M;P=n.lencode[ae+((u&(1<<F+te)-1)>>F)],A=P>>>24,L=P>>>16&255,M=P&65535,!(F+A<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}u>>>=F,f-=F,n.back+=F}if(u>>>=A,f-=A,n.back+=A,n.length=M,L===0){n.mode=F5;break}if(L&32){n.back=-1,n.mode=Fa;break}if(L&64){t.msg="invalid literal/length code",n.mode=Ln;break}n.extra=L&15,n.mode=R5;case R5:if(n.extra){for(N=n.extra;f<N;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,f-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=D5;case D5:for(;P=n.distcode[u&(1<<n.distbits)-1],A=P>>>24,L=P>>>16&255,M=P&65535,!(A<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(!(L&240)){for(F=A,te=L,ae=M;P=n.distcode[ae+((u&(1<<F+te)-1)>>F)],A=P>>>24,L=P>>>16&255,M=P&65535,!(F+A<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}u>>>=F,f-=F,n.back+=F}if(u>>>=A,f-=A,n.back+=A,L&64){t.msg="invalid distance code",n.mode=Ln;break}n.offset=M,n.extra=L&15,n.mode=O5;case O5:if(n.extra){for(N=n.extra;f<N;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,f-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=Ln;break}n.mode=M5;case M5:if(c===0)break e;if(p=y-c,n.offset>p){if(p=n.offset-p,p>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=Ln;break}p>n.wnext?(p-=n.wnext,T=n.wsize-p):T=n.wnext-p,p>n.length&&(p=n.length),E=n.window}else E=i,T=a-n.offset,p=n.length;p>c&&(p=c),c-=p,n.length-=p;do i[a++]=E[T++];while(--p);n.length===0&&(n.mode=kf);break;case F5:if(c===0)break e;i[a++]=n.length,c--,n.mode=kf;break;case i0:if(n.wrap){for(;f<32;){if(l===0)break e;l--,u|=r[s++]<<f,f+=8}if(y-=c,t.total_out+=y,n.total+=y,n.wrap&4&&y&&(t.adler=n.check=n.flags?ra(n.check,i,y,a-y):q1(n.check,i,y,a-y)),y=c,n.wrap&4&&(n.flags?u:B5(u))!==n.check){t.msg="incorrect data check",n.mode=Ln;break}u=0,f=0}n.mode=V5;case V5:if(n.wrap&&n.flags){for(;f<32;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.wrap&4&&u!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=Ln;break}u=0,f=0}n.mode=U5;case U5:I=a7;break e;case Ln:I=yA;break e;case bA:return xA;case wA:default:return gs}return t.next_out=a,t.avail_out=c,t.next_in=s,t.avail_in=l,n.hold=u,n.bits=f,(n.wsize||y!==t.avail_out&&n.mode<Ln&&(n.mode<i0||e!==y5))&&EA(t,t.output,t.next_out,y-t.avail_out),g-=t.avail_in,y-=t.avail_out,t.total_in+=g,t.total_out+=y,n.total+=y,n.wrap&4&&y&&(t.adler=n.check=n.flags?ra(n.check,i,y,t.next_out-y):q1(n.check,i,y,t.next_out-y)),t.data_type=n.bits+(n.last?64:0)+(n.mode===Fa?128:0)+(n.mode===Cf||n.mode===r0?256:0),(g===0&&y===0||e===y5)&&I===dc&&(I=l7),I},v7=t=>{if(yc(t))return gs;let e=t.state;return e.window&&(e.window=null),t.state=null,dc},y7=(t,e)=>{if(yc(t))return gs;const n=t.state;return n.wrap&2?(n.head=e,e.done=!1,dc):gs},x7=(t,e)=>{const n=e.length;let r,i,s;return yc(t)||(r=t.state,r.wrap!==0&&r.mode!==im)?gs:r.mode===im&&(i=1,i=q1(i,e,n,0),i!==r.check)?yA:(s=EA(t,e,n,n),s?(r.mode=bA,xA):(r.havedict=1,dc))};var b7=NA,w7=AA,_7=_A,N7=p7,A7=SA,S7=g7,E7=v7,T7=y7,C7=x7,k7="pako inflate (from Nodeca project)",Ba={inflateReset:b7,inflateReset2:w7,inflateResetKeep:_7,inflateInit:N7,inflateInit2:A7,inflate:S7,inflateEnd:E7,inflateGetHeader:T7,inflateSetDictionary:C7,inflateInfo:k7};function I7(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var j7=I7;const TA=Object.prototype.toString,{Z_NO_FLUSH:P7,Z_FINISH:L7,Z_OK:ph,Z_STREAM_END:o0,Z_NEED_DICT:l0,Z_STREAM_ERROR:R7,Z_DATA_ERROR:z5,Z_MEM_ERROR:D7}=fA;function Mh(t){this.options=pA.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Q8,this.strm.avail_out=0;let n=Ba.inflateInit2(this.strm,e.windowBits);if(n!==ph)throw new Error(z1[n]);if(this.header=new j7,Ba.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=$1.string2buf(e.dictionary):TA.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=Ba.inflateSetDictionary(this.strm,e.dictionary),n!==ph)))throw new Error(z1[n])}Mh.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let s,a,l;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?L7:P7,TA.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),s=Ba.inflate(n,a),s===l0&&i&&(s=Ba.inflateSetDictionary(n,i),s===ph?s=Ba.inflate(n,a):s===z5&&(s=l0));n.avail_in>0&&s===o0&&n.state.wrap>0&&t[n.next_in]!==0;)Ba.inflateReset(n),s=Ba.inflate(n,a);switch(s){case R7:case z5:case l0:case D7:return this.onEnd(s),this.ended=!0,!1}if(l=n.avail_out,n.next_out&&(n.avail_out===0||s===o0))if(this.options.to==="string"){let c=$1.utf8border(n.output,n.next_out),u=n.next_out-c,f=$1.buf2string(n.output,c);n.next_out=u,n.avail_out=r-u,u&&n.output.set(n.output.subarray(c,c+u),0),this.onData(f)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(s===ph&&l===0)){if(s===o0)return s=Ba.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};Mh.prototype.onData=function(t){this.chunks.push(t)};Mh.prototype.onEnd=function(t){t===ph&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=pA.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function O7(t,e){const n=new Mh(e);if(n.push(t),n.err)throw n.msg||z1[n.err];return n.result}var M7=Mh,F7=O7,V7={Inflate:M7,inflate:F7};const{Inflate:U7,inflate:B7}=V7;var $5=U7,q7=B7;const CA=[];for(let t=0;t<256;t++){let e=t;for(let n=0;n<8;n++)e&1?e=3988292384^e>>>1:e=e>>>1;CA[t]=e}const H5=4294967295;function z7(t,e,n){let r=t;for(let i=0;i<n;i++)r=CA[(r^e[i])&255]^r>>>8;return r}function $7(t,e){return(z7(H5,t,e)^H5)>>>0}function W5(t,e,n){const r=t.readUint32(),i=$7(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(i!==r)throw new Error(`CRC mismatch for chunk ${n}. Expected ${r}, found ${i}`)}function kA(t,e,n){for(let r=0;r<n;r++)e[r]=t[r]}function IA(t,e,n,r){let i=0;for(;i<r;i++)e[i]=t[i];for(;i<n;i++)e[i]=t[i]+e[i-r]&255}function jA(t,e,n,r){let i=0;if(n.length===0)for(;i<r;i++)e[i]=t[i];else for(;i<r;i++)e[i]=t[i]+n[i]&255}function PA(t,e,n,r,i){let s=0;if(n.length===0){for(;s<i;s++)e[s]=t[s];for(;s<r;s++)e[s]=t[s]+(e[s-i]>>1)&255}else{for(;s<i;s++)e[s]=t[s]+(n[s]>>1)&255;for(;s<r;s++)e[s]=t[s]+(e[s-i]+n[s]>>1)&255}}function LA(t,e,n,r,i){let s=0;if(n.length===0){for(;s<i;s++)e[s]=t[s];for(;s<r;s++)e[s]=t[s]+e[s-i]&255}else{for(;s<i;s++)e[s]=t[s]+n[s]&255;for(;s<r;s++)e[s]=t[s]+H7(e[s-i],n[s],n[s-i])&255}}function H7(t,e,n){const r=t+e-n,i=Math.abs(r-t),s=Math.abs(r-e),a=Math.abs(r-n);return i<=s&&i<=a?t:s<=a?e:n}function W7(t,e,n,r,i,s){switch(t){case 0:kA(e,n,i);break;case 1:IA(e,n,i,s);break;case 2:jA(e,n,r,i);break;case 3:PA(e,n,r,i,s);break;case 4:LA(e,n,r,i,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const G7=new Uint16Array([255]),K7=new Uint8Array(G7.buffer),Y7=K7[0]===255;function Q7(t){const{data:e,width:n,height:r,channels:i,depth:s}=t,a=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*i,c=new Uint8Array(r*n*l);let u=0;for(let f=0;f<7;f++){const g=a[f],y=Math.ceil((n-g.x)/g.xStep),p=Math.ceil((r-g.y)/g.yStep);if(y<=0||p<=0)continue;const T=y*l,E=new Uint8Array(T);for(let P=0;P<p;P++){const A=e[u++],L=e.subarray(u,u+T);u+=T;const M=new Uint8Array(T);W7(A,L,M,E,T,l),E.set(M);for(let F=0;F<y;F++){const te=g.x+F*g.xStep,ae=g.y+P*g.yStep;if(!(te>=n||ae>=r))for(let B=0;B<l;B++)c[(ae*n+te)*l+B]=M[F*l+B]}}}if(s===16){const f=new Uint16Array(c.buffer);if(Y7)for(let g=0;g<f.length;g++)f[g]=X7(f[g]);return f}else return c}function X7(t){return(t&255)<<8|t>>8&255}const J7=new Uint16Array([255]),Z7=new Uint8Array(J7.buffer),eD=Z7[0]===255,tD=new Uint8Array(0);function G5(t){const{data:e,width:n,height:r,channels:i,depth:s}=t,a=Math.ceil(s/8)*i,l=Math.ceil(s/8*i*n),c=new Uint8Array(r*l);let u=tD,f=0,g,y;for(let p=0;p<r;p++){switch(g=e.subarray(f+1,f+1+l),y=c.subarray(p*l,(p+1)*l),e[f]){case 0:kA(g,y,l);break;case 1:IA(g,y,l,a);break;case 2:jA(g,y,u,l);break;case 3:PA(g,y,u,l,a);break;case 4:LA(g,y,u,l,a);break;default:throw new Error(`Unsupported filter: ${e[f]}`)}u=y,f+=l+1}if(s===16){const p=new Uint16Array(c.buffer);if(eD)for(let T=0;T<p.length;T++)p[T]=nD(p[T]);return p}else return c}function nD(t){return(t&255)<<8|t>>8&255}const rp=Uint8Array.of(137,80,78,71,13,10,26,10);function K5(t){if(!rD(t.readBytes(rp.length)))throw new Error("wrong PNG signature")}function rD(t){if(t.length<rp.length)return!1;for(let e=0;e<rp.length;e++)if(t[e]!==rp[e])return!1;return!0}const iD="tEXt",sD=0,RA=new TextDecoder("latin1");function aD(t){if(lD(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const oD=/^[\u0000-\u00FF]*$/;function lD(t){if(!oD.test(t))throw new Error("invalid latin1 text")}function cD(t,e,n){const r=DA(e);t[r]=uD(e,n-r.length-1)}function DA(t){for(t.mark();t.readByte()!==sD;);const e=t.offset;t.reset();const n=RA.decode(t.readBytes(e-t.offset-1));return t.skip(1),aD(n),n}function uD(t,e){return RA.decode(t.readBytes(e))}const zi={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},c0={UNKNOWN:-1,DEFLATE:0},Y5={UNKNOWN:-1,ADAPTIVE:0},u0={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},If={NONE:0,BACKGROUND:1,PREVIOUS:2},d0={SOURCE:0,OVER:1};class dD extends z2{constructor(n,r={}){super(n);un(this,"_checkCrc");un(this,"_inflator");un(this,"_png");un(this,"_apng");un(this,"_end");un(this,"_hasPalette");un(this,"_palette");un(this,"_hasTransparency");un(this,"_transparency");un(this,"_compressionMethod");un(this,"_filterMethod");un(this,"_interlaceMethod");un(this,"_colorType");un(this,"_isAnimated");un(this,"_numberOfFrames");un(this,"_numberOfPlays");un(this,"_frames");un(this,"_writingDataChunks");const{checkCrc:i=!1}=r;this._checkCrc=i,this._inflator=new $5,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=c0.UNKNOWN,this._filterMethod=Y5.UNKNOWN,this._interlaceMethod=u0.UNKNOWN,this._colorType=zi.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(K5(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeChunk(n,r)}return this.decodeImage(),this._png}decodeApng(){for(K5(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(n,r)}return this.decodeApngImage(),this._apng}decodeChunk(n,r){const i=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(n);break;case"IDAT":this.decodeIDAT(n);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(n);break;case"iCCP":this.decodeiCCP(n);break;case iD:cD(this._png.text,this,n);break;case"pHYs":this.decodepHYs();break;default:this.skip(n);break}if(this.offset-i!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?W5(this,n+4,r):this.skip(4)}decodeApngChunk(n,r){const i=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(n);break;default:this.decodeChunk(n,r),this.offset=i+n;break}if(this.offset-i!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?W5(this,n+4,r):this.skip(4)}decodeIHDR(){const n=this._png;n.width=this.readUint32(),n.height=this.readUint32(),n.depth=hD(this.readUint8());const r=this.readUint8();this._colorType=r;let i;switch(r){case zi.GREYSCALE:i=1;break;case zi.TRUECOLOUR:i=3;break;case zi.INDEXED_COLOUR:i=1;break;case zi.GREYSCALE_ALPHA:i=2;break;case zi.TRUECOLOUR_ALPHA:i=4;break;case zi.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==c0.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const n={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(n)}decodePLTE(n){if(n%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${n}`);const r=n/3;this._hasPalette=!0;const i=[];this._palette=i;for(let s=0;s<r;s++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(n){this._writingDataChunks=!0;const r=n,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodeFDAT(n){this._writingDataChunks=!0;let r=n,i=this.offset+this.byteOffset;if(i+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,i,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodetRNS(n){switch(this._colorType){case zi.GREYSCALE:case zi.TRUECOLOUR:{if(n%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${n}`);if(n/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${n/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(n/2);for(let r=0;r<n/2;r++)this._transparency[r]=this.readUint16();break}case zi.INDEXED_COLOUR:{if(n>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${n} vs ${this._palette.length})`);let r=0;for(;r<n;r++){const i=this.readByte();this._palette[r].push(i)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case zi.UNKNOWN:case zi.GREYSCALE_ALPHA:case zi.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(n){const r=DA(this),i=this.readUint8();if(i!==c0.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const s=this.readBytes(n-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:q7(s)}}decodepHYs(){const n=this.readUint32(),r=this.readUint32(),i=this.readByte();this._png.resolution={x:n,y:r,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let n=0;n<this._numberOfFrames;n++){const r={sequenceNumber:this._frames[n].sequenceNumber,delayNumber:this._frames[n].delayNumber,delayDenominator:this._frames[n].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(n);if(i){if(i.data=G5({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),n===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)r.data=i.data;else{const s=this._apng.frames.at(n-1);this.disposeFrame(i,s,r),this.addFrameDataToCanvas(r,i)}this._apng.frames.push(r)}}return this._apng}disposeFrame(n,r,i){switch(n.disposeOp){case If.NONE:break;case If.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let a=0;a<this._png.width;a++){const l=(s*n.width+a)*this._png.channels;for(let c=0;c<this._png.channels;c++)i.data[l+c]=0}break;case If.PREVIOUS:i.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(n,r){const i=1<<this._png.depth,s=(a,l)=>{const c=((a+r.yOffset)*this._png.width+r.xOffset+l)*this._png.channels,u=(a*r.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(r.blendOp){case d0.SOURCE:for(let a=0;a<r.height;a++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:u}=s(a,l);for(let f=0;f<this._png.channels;f++)n.data[c+f]=r.data[u+f]}break;case d0.OVER:for(let a=0;a<r.height;a++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:u}=s(a,l);for(let f=0;f<this._png.channels;f++){const g=r.data[u+this._png.channels-1]/i,y=f%(this._png.channels-1)===0?1:r.data[u+f],p=Math.floor(g*y+(1-g)*n.data[c+f]);n.data[c+f]+=p}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var r;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const n=this._isAnimated?((r=this._frames)==null?void 0:r.at(0)).data:this._inflator.result;if(this._filterMethod!==Y5.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===u0.NO_INTERLACE)this._png.data=G5({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===u0.ADAM7)this._png.data=Q7({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const n=this._inflator.result,r=this._frames.at(-1);r?r.data=n:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:If.NONE,blendOp:d0.SOURCE,data:n}),this._inflator=new $5,this._writingDataChunks=!1}}function hD(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var Q5;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(Q5||(Q5={}));function fD(t,e){return new dD(t,e).decode()}var _t=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function h0(){_t.console&&typeof _t.console.log=="function"&&_t.console.log.apply(_t.console,arguments)}var vn={log:h0,warn:function(t){_t.console&&(typeof _t.console.warn=="function"?_t.console.warn.apply(_t.console,arguments):h0.call(null,arguments))},error:function(t){_t.console&&(typeof _t.console.error=="function"?_t.console.error.apply(_t.console,arguments):h0(t))}};function f0(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){Bl(r.response,e,n)},r.onerror=function(){vn.error("could not download file")},r.send()}function X5(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function jf(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Bl=_t.saveAs||((typeof window>"u"?"undefined":dn(window))!=="object"||window!==_t?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var r=_t.URL||_t.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?X5(i.href)?f0(t,e,n):jf(i,i.target="_blank"):jf(i)):(i.href=r.createObjectURL(t),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){jf(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t=="string")if(X5(t))f0(t,e,n);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout(function(){jf(r)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:dn(s)!=="object"&&(vn.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(t,n),e)}:function(t,e,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof t=="string")return f0(t,e,n);var i=t.type==="application/octet-stream",s=/constructor/i.test(_t.HTMLElement)||_t.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||i&&s)&&(typeof FileReader>"u"?"undefined":dn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var f=l.result;f=a?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=f:location=f,r=null},l.readAsDataURL(t)}else{var c=_t.URL||_t.webkitURL,u=c.createObjectURL(t);r?r.location=u:location.href=u,r=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function OA(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],r=0;r<n.length;r++){var i=n[r].re,s=n[r].process,a=i.exec(t);a&&(e=s(a),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var ip=_t.atob.bind(_t),J5=_t.btoa.bind(_t);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function p0(t,e){var n=t[0],r=t[1],i=t[2],s=t[3];n=Yr(n,r,i,s,e[0],7,-680876936),s=Yr(s,n,r,i,e[1],12,-389564586),i=Yr(i,s,n,r,e[2],17,606105819),r=Yr(r,i,s,n,e[3],22,-1044525330),n=Yr(n,r,i,s,e[4],7,-176418897),s=Yr(s,n,r,i,e[5],12,1200080426),i=Yr(i,s,n,r,e[6],17,-1473231341),r=Yr(r,i,s,n,e[7],22,-45705983),n=Yr(n,r,i,s,e[8],7,1770035416),s=Yr(s,n,r,i,e[9],12,-1958414417),i=Yr(i,s,n,r,e[10],17,-42063),r=Yr(r,i,s,n,e[11],22,-1990404162),n=Yr(n,r,i,s,e[12],7,1804603682),s=Yr(s,n,r,i,e[13],12,-40341101),i=Yr(i,s,n,r,e[14],17,-1502002290),n=Qr(n,r=Yr(r,i,s,n,e[15],22,1236535329),i,s,e[1],5,-165796510),s=Qr(s,n,r,i,e[6],9,-1069501632),i=Qr(i,s,n,r,e[11],14,643717713),r=Qr(r,i,s,n,e[0],20,-373897302),n=Qr(n,r,i,s,e[5],5,-701558691),s=Qr(s,n,r,i,e[10],9,38016083),i=Qr(i,s,n,r,e[15],14,-660478335),r=Qr(r,i,s,n,e[4],20,-405537848),n=Qr(n,r,i,s,e[9],5,568446438),s=Qr(s,n,r,i,e[14],9,-1019803690),i=Qr(i,s,n,r,e[3],14,-187363961),r=Qr(r,i,s,n,e[8],20,1163531501),n=Qr(n,r,i,s,e[13],5,-1444681467),s=Qr(s,n,r,i,e[2],9,-51403784),i=Qr(i,s,n,r,e[7],14,1735328473),n=Xr(n,r=Qr(r,i,s,n,e[12],20,-1926607734),i,s,e[5],4,-378558),s=Xr(s,n,r,i,e[8],11,-2022574463),i=Xr(i,s,n,r,e[11],16,1839030562),r=Xr(r,i,s,n,e[14],23,-35309556),n=Xr(n,r,i,s,e[1],4,-1530992060),s=Xr(s,n,r,i,e[4],11,1272893353),i=Xr(i,s,n,r,e[7],16,-155497632),r=Xr(r,i,s,n,e[10],23,-1094730640),n=Xr(n,r,i,s,e[13],4,681279174),s=Xr(s,n,r,i,e[0],11,-358537222),i=Xr(i,s,n,r,e[3],16,-722521979),r=Xr(r,i,s,n,e[6],23,76029189),n=Xr(n,r,i,s,e[9],4,-640364487),s=Xr(s,n,r,i,e[12],11,-421815835),i=Xr(i,s,n,r,e[15],16,530742520),n=Jr(n,r=Xr(r,i,s,n,e[2],23,-995338651),i,s,e[0],6,-198630844),s=Jr(s,n,r,i,e[7],10,1126891415),i=Jr(i,s,n,r,e[14],15,-1416354905),r=Jr(r,i,s,n,e[5],21,-57434055),n=Jr(n,r,i,s,e[12],6,1700485571),s=Jr(s,n,r,i,e[3],10,-1894986606),i=Jr(i,s,n,r,e[10],15,-1051523),r=Jr(r,i,s,n,e[1],21,-2054922799),n=Jr(n,r,i,s,e[8],6,1873313359),s=Jr(s,n,r,i,e[15],10,-30611744),i=Jr(i,s,n,r,e[6],15,-1560198380),r=Jr(r,i,s,n,e[13],21,1309151649),n=Jr(n,r,i,s,e[4],6,-145523070),s=Jr(s,n,r,i,e[11],10,-1120210379),i=Jr(i,s,n,r,e[2],15,718787259),r=Jr(r,i,s,n,e[9],21,-343485551),t[0]=Ko(n,t[0]),t[1]=Ko(r,t[1]),t[2]=Ko(i,t[2]),t[3]=Ko(s,t[3])}function Xm(t,e,n,r,i,s){return e=Ko(Ko(e,t),Ko(r,s)),Ko(e<<i|e>>>32-i,n)}function Yr(t,e,n,r,i,s,a){return Xm(e&n|~e&r,t,e,i,s,a)}function Qr(t,e,n,r,i,s,a){return Xm(e&r|n&~r,t,e,i,s,a)}function Xr(t,e,n,r,i,s,a){return Xm(e^n^r,t,e,i,s,a)}function Jr(t,e,n,r,i,s,a){return Xm(n^(e|~r),t,e,i,s,a)}function MA(t){var e,n=t.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)p0(r,pD(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(p0(r,i),e=0;e<16;e++)i[e]=0;return i[14]=8*n,p0(r,i),r}function pD(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}var Z5="0123456789abcdef".split("");function mD(t){for(var e="",n=0;n<4;n++)e+=Z5[t>>8*n+4&15]+Z5[t>>8*n&15];return e}function gD(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function H1(t){return MA(t).map(gD).join("")}var vD=function(t){for(var e=0;e<t.length;e++)t[e]=mD(t[e]);return t.join("")}(MA("hello"))!="5d41402abc4b2a76b9719d911017c592";function Ko(t,e){if(vD){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function W1(t,e){var n,r,i,s;if(t!==n){for(var a=(i=t,s=1+(256/t.length|0),new Array(s+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var f=l[c];u=(u+f+a.charCodeAt(c))%256,l[c]=l[u],l[u]=f}n=t,r=l}else l=r;var g=e.length,y=0,p=0,T="";for(c=0;c<g;c++)p=(p+(f=l[y=(y+1)%256]))%256,l[y]=l[p],l[p]=f,a=l[(l[y]+l[p])%256],T+=String.fromCharCode(e.charCodeAt(c)^a);return T}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var ew={print:4,modify:8,copy:16,"annot-forms":32};function Lc(t,e,n,r){this.v=1,this.r=2;var i=192;t.forEach(function(l){if(ew.perm!==void 0)throw new Error("Invalid permission: "+l);i+=ew[l]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var s=(e+this.padding).substr(0,32),a=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,a),this.P=-(1+(255^i)),this.encryptionKey=H1(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=W1(this.encryptionKey,this.padding)}function Rc(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,r=0;r<n;r++){var i=t.charCodeAt(r);e+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):t[r]}return e}function tw(t){if(dn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(n,r,i){if(i=i||!1,typeof n!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(n)||(e[n]={});var s=Math.random().toString(35);return e[n][s]=[r,!!i],s},this.unsubscribe=function(n){for(var r in e)if(e[r][n])return delete e[r][n],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var s in e[n]){var a=e[n][s];try{a[0].apply(t,r)}catch(l){_t.console&&vn.error("jsPDF PubSub Error",l.message,l)}a[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function sm(t){if(!(this instanceof sm))return new sm(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function FA(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function ql(t,e,n,r,i){if(!(this instanceof ql))return new ql(t,e,n,r,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=n,FA.call(this,r,i)}function Kc(t,e,n,r,i){if(!(this instanceof Kc))return new Kc(t,e,n,r,i);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,FA.call(this,r,i)}function st(t){var e,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],s=arguments[3],a=[],l=1,c=16,u="S",f=null;dn(t=t||{})==="object"&&(n=t.orientation,r=t.unit||r,i=t.format||i,s=t.compress||t.compressPdf||s,(f=t.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),a=t.filters||(s===!0?["FlateEncode"]:a),r=r||"mm",n=(""+(n||"P")).toLowerCase();var g=t.putOnlyUsedFonts||!1,y={},p={internal:{},__private__:{}};p.__private__.PubSub=tw;var T="1.3",E=p.__private__.getPdfVersion=function(){return T};p.__private__.setPdfVersion=function(v){T=v};var P={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return P};var A=p.__private__.getPageFormat=function(v){return P[v]};i=i||"a4";var L="compat",M="advanced",F=L;function te(){this.saveGraphicsState(),se(new ut(ft,0,0,-ft,0,rs()*ft).toString()+" cm"),this.setFontSize(this.getFontSize()/ft),u="n",F=M}function ae(){this.restoreGraphicsState(),u="S",F=L}var B=p.__private__.combineFontStyleAndFontWeight=function(v,V){if(v=="bold"&&V=="normal"||v=="bold"&&V==400||v=="normal"&&V=="italic"||v=="bold"&&V=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return V&&(v=V==400||V==="normal"?v==="italic"?"italic":"normal":V!=700&&V!=="bold"||v!=="normal"?(V==700?"bold":V)+""+v:"bold"),v};p.advancedAPI=function(v){var V=F===L;return V&&te.call(this),typeof v!="function"||(v(this),V&&ae.call(this)),this},p.compatAPI=function(v){var V=F===M;return V&&ae.call(this),typeof v!="function"||(v(this),V&&te.call(this)),this},p.isAdvancedAPI=function(){return F===M};var I,j=function(v){if(F!==M)throw new Error(v+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},S=p.roundToPrecision=p.__private__.roundToPrecision=function(v,V){var ne=e||V;if(isNaN(v)||isNaN(ne))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return v.toFixed(ne).replace(/0+$/,"")};I=p.hpf=p.__private__.hpf=typeof c=="number"?function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.hpf");return S(v,c)}:c==="smart"?function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.hpf");return S(v,v>-1&&v<1?16:5)}:function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.hpf");return S(v,16)};var N=p.f2=p.__private__.f2=function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.f2");return S(v,2)},w=p.__private__.f3=function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.f3");return S(v,3)},k=p.scale=p.__private__.scale=function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.scale");return F===L?v*ft:F===M?v:void 0},H=function(v){return k(function(V){return F===L?rs()-V:F===M?V:void 0}(v))};p.__private__.setPrecision=p.setPrecision=function(v){typeof parseInt(v,10)=="number"&&(e=parseInt(v,10))};var D,W="00000000000000000000000000000000",K=p.__private__.getFileId=function(){return W},q=p.__private__.setFileId=function(v){return W=v!==void 0&&/^[a-fA-F0-9]{32}$/.test(v)?v.toUpperCase():W.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(an=new Lc(f.userPermissions,f.userPassword,f.ownerPassword,W)),W};p.setFileId=function(v){return q(v),this},p.getFileId=function(){return K()};var ee=p.__private__.convertDateToPDFDate=function(v){var V=v.getTimezoneOffset(),ne=V<0?"+":"-",oe=Math.floor(Math.abs(V/60)),pe=Math.abs(V%60),Se=[ne,O(oe),"'",O(pe),"'"].join("");return["D:",v.getFullYear(),O(v.getMonth()+1),O(v.getDate()),O(v.getHours()),O(v.getMinutes()),O(v.getSeconds()),Se].join("")},ue=p.__private__.convertPDFDateToDate=function(v){var V=parseInt(v.substr(2,4),10),ne=parseInt(v.substr(6,2),10)-1,oe=parseInt(v.substr(8,2),10),pe=parseInt(v.substr(10,2),10),Se=parseInt(v.substr(12,2),10),Pe=parseInt(v.substr(14,2),10);return new Date(V,ne,oe,pe,Se,Pe,0)},ce=p.__private__.setCreationDate=function(v){var V;if(v===void 0&&(v=new Date),v instanceof Date)V=ee(v);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(v))throw new Error("Invalid argument passed to jsPDF.setCreationDate");V=v}return D=V},_=p.__private__.getCreationDate=function(v){var V=D;return v==="jsDate"&&(V=ue(D)),V};p.setCreationDate=function(v){return ce(v),this},p.getCreationDate=function(v){return _(v)};var z,O=p.__private__.padd2=function(v){return("0"+parseInt(v)).slice(-2)},X=p.__private__.padd2Hex=function(v){return("00"+(v=v.toString())).substr(v.length)},Z=0,le=[],me=[],ye=0,xe=[],ke=[],Ve=!1,Ue=me;p.__private__.setCustomOutputDestination=function(v){Ve=!0,Ue=v};var Ne=function(v){Ve||(Ue=v)};p.__private__.resetCustomOutputDestination=function(){Ve=!1,Ue=me};var se=p.__private__.out=function(v){return v=v.toString(),ye+=v.length+1,Ue.push(v),Ue},yt=p.__private__.write=function(v){return se(arguments.length===1?v.toString():Array.prototype.join.call(arguments," "))},Ye=p.__private__.getArrayBuffer=function(v){for(var V=v.length,ne=new ArrayBuffer(V),oe=new Uint8Array(ne);V--;)oe[V]=v.charCodeAt(V);return ne},ot=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return ot};var De=t.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(v){return De=F===M?v/ft:v,this};var je,Ce=p.__private__.getFontSize=p.getFontSize=function(){return F===L?De:De*ft},Et=t.R2L||!1;p.__private__.setR2L=p.setR2L=function(v){return Et=v,this},p.__private__.getR2L=p.getR2L=function(){return Et};var nt,Bt=p.__private__.setZoomMode=function(v){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(v))je=v;else if(isNaN(v)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(v)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+v+'" is not recognized.');je=v}else je=parseInt(v,10)};p.__private__.getZoomMode=function(){return je};var Nt,tt=p.__private__.setPageMode=function(v){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(v)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+v+'" is not recognized.');nt=v};p.__private__.getPageMode=function(){return nt};var Tt=p.__private__.setLayoutMode=function(v){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(v)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+v+'" is not recognized.');Nt=v};p.__private__.getLayoutMode=function(){return Nt},p.__private__.setDisplayMode=p.setDisplayMode=function(v,V,ne){return Bt(v),Tt(V),tt(ne),this};var xt={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(v){if(Object.keys(xt).indexOf(v)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return xt[v]},p.__private__.getDocumentProperties=function(){return xt},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(v){for(var V in xt)xt.hasOwnProperty(V)&&v[V]&&(xt[V]=v[V]);return this},p.__private__.setDocumentProperty=function(v,V){if(Object.keys(xt).indexOf(v)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return xt[v]=V};var rt,ft,at,Jt,Wt,Je={},bt={},sn=[],dt={},Rt={},At={},In={},_n=null,en=0,pt=[],Ot=new tw(p),Us=t.hotfixes||[],Qn={},Zi={},Br=[],ut=function v(V,ne,oe,pe,Se,Pe){if(!(this instanceof v))return new v(V,ne,oe,pe,Se,Pe);isNaN(V)&&(V=1),isNaN(ne)&&(ne=0),isNaN(oe)&&(oe=0),isNaN(pe)&&(pe=1),isNaN(Se)&&(Se=0),isNaN(Pe)&&(Pe=0),this._matrix=[V,ne,oe,pe,Se,Pe]};Object.defineProperty(ut.prototype,"sx",{get:function(){return this._matrix[0]},set:function(v){this._matrix[0]=v}}),Object.defineProperty(ut.prototype,"shy",{get:function(){return this._matrix[1]},set:function(v){this._matrix[1]=v}}),Object.defineProperty(ut.prototype,"shx",{get:function(){return this._matrix[2]},set:function(v){this._matrix[2]=v}}),Object.defineProperty(ut.prototype,"sy",{get:function(){return this._matrix[3]},set:function(v){this._matrix[3]=v}}),Object.defineProperty(ut.prototype,"tx",{get:function(){return this._matrix[4]},set:function(v){this._matrix[4]=v}}),Object.defineProperty(ut.prototype,"ty",{get:function(){return this._matrix[5]},set:function(v){this._matrix[5]=v}}),Object.defineProperty(ut.prototype,"a",{get:function(){return this._matrix[0]},set:function(v){this._matrix[0]=v}}),Object.defineProperty(ut.prototype,"b",{get:function(){return this._matrix[1]},set:function(v){this._matrix[1]=v}}),Object.defineProperty(ut.prototype,"c",{get:function(){return this._matrix[2]},set:function(v){this._matrix[2]=v}}),Object.defineProperty(ut.prototype,"d",{get:function(){return this._matrix[3]},set:function(v){this._matrix[3]=v}}),Object.defineProperty(ut.prototype,"e",{get:function(){return this._matrix[4]},set:function(v){this._matrix[4]=v}}),Object.defineProperty(ut.prototype,"f",{get:function(){return this._matrix[5]},set:function(v){this._matrix[5]=v}}),Object.defineProperty(ut.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ut.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ut.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ut.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ut.prototype.join=function(v){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(v)},ut.prototype.multiply=function(v){var V=v.sx*this.sx+v.shy*this.shx,ne=v.sx*this.shy+v.shy*this.sy,oe=v.shx*this.sx+v.sy*this.shx,pe=v.shx*this.shy+v.sy*this.sy,Se=v.tx*this.sx+v.ty*this.shx+this.tx,Pe=v.tx*this.shy+v.ty*this.sy+this.ty;return new ut(V,ne,oe,pe,Se,Pe)},ut.prototype.decompose=function(){var v=this.sx,V=this.shy,ne=this.shx,oe=this.sy,pe=this.tx,Se=this.ty,Pe=Math.sqrt(v*v+V*V),He=(v/=Pe)*ne+(V/=Pe)*oe;ne-=v*He,oe-=V*He;var Qe=Math.sqrt(ne*ne+oe*oe);return He/=Qe,v*(oe/=Qe)<V*(ne/=Qe)&&(v=-v,V=-V,He=-He,Pe=-Pe),{scale:new ut(Pe,0,0,Qe,0,0),translate:new ut(1,0,0,1,pe,Se),rotate:new ut(v,V,-V,v,0,0),skew:new ut(1,0,He,1,0,0)}},ut.prototype.toString=function(v){return this.join(" ")},ut.prototype.inversed=function(){var v=this.sx,V=this.shy,ne=this.shx,oe=this.sy,pe=this.tx,Se=this.ty,Pe=1/(v*oe-V*ne),He=oe*Pe,Qe=-V*Pe,ht=-ne*Pe,wt=v*Pe;return new ut(He,Qe,ht,wt,-He*pe-ht*Se,-Qe*pe-wt*Se)},ut.prototype.applyToPoint=function(v){var V=v.x*this.sx+v.y*this.shx+this.tx,ne=v.x*this.shy+v.y*this.sy+this.ty;return new Qs(V,ne)},ut.prototype.applyToRectangle=function(v){var V=this.applyToPoint(v),ne=this.applyToPoint(new Qs(v.x+v.w,v.y+v.h));return new yo(V.x,V.y,ne.x-V.x,ne.y-V.y)},ut.prototype.clone=function(){var v=this.sx,V=this.shy,ne=this.shx,oe=this.sy,pe=this.tx,Se=this.ty;return new ut(v,V,ne,oe,pe,Se)},p.Matrix=ut;var Nn=p.matrixMult=function(v,V){return V.multiply(v)},es=new ut(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=es;var br=function(v,V){if(!Rt[v]){var ne=(V instanceof ql?"Sh":"P")+(Object.keys(dt).length+1).toString(10);V.id=ne,Rt[v]=ne,dt[ne]=V,Ot.publish("addPattern",V)}};p.ShadingPattern=ql,p.TilingPattern=Kc,p.addShadingPattern=function(v,V){return j("addShadingPattern()"),br(v,V),this},p.beginTilingPattern=function(v){j("beginTilingPattern()"),Xs(v.boundingBox[0],v.boundingBox[1],v.boundingBox[2]-v.boundingBox[0],v.boundingBox[3]-v.boundingBox[1],v.matrix)},p.endTilingPattern=function(v,V){j("endTilingPattern()"),V.stream=ke[z].join(`
`),br(v,V),Ot.publish("endTilingPattern",V),Br.pop().restore()};var wr,jn=p.__private__.newObject=function(){var v=lr();return Pn(v,!0),v},lr=p.__private__.newObjectDeferred=function(){return Z++,le[Z]=function(){return ye},Z},Pn=function(v,V){return V=typeof V=="boolean"&&V,le[v]=ye,V&&se(v+" 0 obj"),v},Na=p.__private__.newAdditionalObject=function(){var v={objId:lr(),content:""};return xe.push(v),v},Bs=lr(),qr=lr(),ki=p.__private__.decodeColorString=function(v){var V=v.split(" ");if(V.length!==2||V[1]!=="g"&&V[1]!=="G")V.length!==5||V[4]!=="k"&&V[4]!=="K"||(V=[(1-V[0])*(1-V[3]),(1-V[1])*(1-V[3]),(1-V[2])*(1-V[3]),"r"]);else{var ne=parseFloat(V[0]);V=[ne,ne,ne,"r"]}for(var oe="#",pe=0;pe<3;pe++)oe+=("0"+Math.floor(255*parseFloat(V[pe])).toString(16)).slice(-2);return oe},si=p.__private__.encodeColorString=function(v){var V;typeof v=="string"&&(v={ch1:v});var ne=v.ch1,oe=v.ch2,pe=v.ch3,Se=v.ch4,Pe=v.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ne=="string"&&ne.charAt(0)!=="#"){var He=new OA(ne);if(He.ok)ne=He.toHex();else if(!/^\d*\.?\d*$/.test(ne))throw new Error('Invalid color "'+ne+'" passed to jsPDF.encodeColorString.')}if(typeof ne=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ne)&&(ne="#"+ne[1]+ne[1]+ne[2]+ne[2]+ne[3]+ne[3]),typeof ne=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ne)){var Qe=parseInt(ne.substr(1),16);ne=Qe>>16&255,oe=Qe>>8&255,pe=255&Qe}if(oe===void 0||Se===void 0&&ne===oe&&oe===pe)V=typeof ne=="string"?ne+" "+Pe[0]:v.precision===2?N(ne/255)+" "+Pe[0]:w(ne/255)+" "+Pe[0];else if(Se===void 0||dn(Se)==="object"){if(Se&&!isNaN(Se.a)&&Se.a===0)return["1.","1.","1.",Pe[1]].join(" ");V=typeof ne=="string"?[ne,oe,pe,Pe[1]].join(" "):v.precision===2?[N(ne/255),N(oe/255),N(pe/255),Pe[1]].join(" "):[w(ne/255),w(oe/255),w(pe/255),Pe[1]].join(" ")}else V=typeof ne=="string"?[ne,oe,pe,Se,Pe[2]].join(" "):v.precision===2?[N(ne),N(oe),N(pe),N(Se),Pe[2]].join(" "):[w(ne),w(oe),w(pe),w(Se),Pe[2]].join(" ");return V},zr=p.__private__.getFilters=function(){return a},Xn=p.__private__.putStream=function(v){var V=(v=v||{}).data||"",ne=v.filters||zr(),oe=v.alreadyAppliedFilters||[],pe=v.addLength1||!1,Se=V.length,Pe=v.objectId,He=function($n){return $n};if(f!==null&&Pe===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(He=an.encryptor(Pe,0));var Qe={};ne===!0&&(ne=["FlateEncode"]);var ht=v.additionalKeyValues||[],wt=(Qe=st.API.processDataByFilters!==void 0?st.API.processDataByFilters(V,ne):{data:V,reverseChain:[]}).reverseChain+(Array.isArray(oe)?oe.join(" "):oe.toString());if(Qe.data.length!==0&&(ht.push({key:"Length",value:Qe.data.length}),pe===!0&&ht.push({key:"Length1",value:Se})),wt.length!=0)if(wt.split("/").length-1==1)ht.push({key:"Filter",value:wt});else{ht.push({key:"Filter",value:"["+wt+"]"});for(var Gt=0;Gt<ht.length;Gt+=1)if(ht[Gt].key==="DecodeParms"){for(var tn=[],Mn=0;Mn<Qe.reverseChain.split("/").length-1;Mn+=1)tn.push("null");tn.push(ht[Gt].value),ht[Gt].value="["+tn.join(" ")+"]"}}se("<<");for(var on=0;on<ht.length;on++)se("/"+ht[on].key+" "+ht[on].value);se(">>"),Qe.data.length!==0&&(se("stream"),se(He(Qe.data)),se("endstream"))},qs=p.__private__.putPage=function(v){var V=v.number,ne=v.data,oe=v.objId,pe=v.contentsObjId;Pn(oe,!0),se("<</Type /Page"),se("/Parent "+v.rootDictionaryObjId+" 0 R"),se("/Resources "+v.resourceDictionaryObjId+" 0 R"),se("/MediaBox ["+parseFloat(I(v.mediaBox.bottomLeftX))+" "+parseFloat(I(v.mediaBox.bottomLeftY))+" "+I(v.mediaBox.topRightX)+" "+I(v.mediaBox.topRightY)+"]"),v.cropBox!==null&&se("/CropBox ["+I(v.cropBox.bottomLeftX)+" "+I(v.cropBox.bottomLeftY)+" "+I(v.cropBox.topRightX)+" "+I(v.cropBox.topRightY)+"]"),v.bleedBox!==null&&se("/BleedBox ["+I(v.bleedBox.bottomLeftX)+" "+I(v.bleedBox.bottomLeftY)+" "+I(v.bleedBox.topRightX)+" "+I(v.bleedBox.topRightY)+"]"),v.trimBox!==null&&se("/TrimBox ["+I(v.trimBox.bottomLeftX)+" "+I(v.trimBox.bottomLeftY)+" "+I(v.trimBox.topRightX)+" "+I(v.trimBox.topRightY)+"]"),v.artBox!==null&&se("/ArtBox ["+I(v.artBox.bottomLeftX)+" "+I(v.artBox.bottomLeftY)+" "+I(v.artBox.topRightX)+" "+I(v.artBox.topRightY)+"]"),typeof v.userUnit=="number"&&v.userUnit!==1&&se("/UserUnit "+v.userUnit),Ot.publish("putPage",{objId:oe,pageContext:pt[V],pageNumber:V,page:ne}),se("/Contents "+pe+" 0 R"),se(">>"),se("endobj");var Se=ne.join(`
`);return F===M&&(Se+=`
Q`),Pn(pe,!0),Xn({data:Se,filters:zr(),objectId:pe}),se("endobj"),oe},Ii=p.__private__.putPages=function(){var v,V,ne=[];for(v=1;v<=en;v++)pt[v].objId=lr(),pt[v].contentsObjId=lr();for(v=1;v<=en;v++)ne.push(qs({number:v,data:ke[v],objId:pt[v].objId,contentsObjId:pt[v].contentsObjId,mediaBox:pt[v].mediaBox,cropBox:pt[v].cropBox,bleedBox:pt[v].bleedBox,trimBox:pt[v].trimBox,artBox:pt[v].artBox,userUnit:pt[v].userUnit,rootDictionaryObjId:Bs,resourceDictionaryObjId:qr}));Pn(Bs,!0),se("<</Type /Pages");var oe="/Kids [";for(V=0;V<en;V++)oe+=ne[V]+" 0 R ";se(oe+"]"),se("/Count "+en),se(">>"),se("endobj"),Ot.publish("postPutPages")},vs=function(v){Ot.publish("putFont",{font:v,out:se,newObject:jn,putStream:Xn}),v.isAlreadyPutted!==!0&&(v.objectNumber=jn(),se("<<"),se("/Type /Font"),se("/BaseFont /"+Rc(v.postScriptName)),se("/Subtype /Type1"),typeof v.encoding=="string"&&se("/Encoding /"+v.encoding),se("/FirstChar 32"),se("/LastChar 255"),se(">>"),se("endobj"))},zs=function(v){v.objectNumber=jn();var V=[];V.push({key:"Type",value:"/XObject"}),V.push({key:"Subtype",value:"/Form"}),V.push({key:"BBox",value:"["+[I(v.x),I(v.y),I(v.x+v.width),I(v.y+v.height)].join(" ")+"]"}),V.push({key:"Matrix",value:"["+v.matrix.toString()+"]"});var ne=v.pages[1].join(`
`);Xn({data:ne,additionalKeyValues:V,objectId:v.objectNumber}),se("endobj")},Aa=function(v,V){V||(V=21);var ne=jn(),oe=function(Pe,He){var Qe,ht=[],wt=1/(He-1);for(Qe=0;Qe<1;Qe+=wt)ht.push(Qe);if(ht.push(1),Pe[0].offset!=0){var Gt={offset:0,color:Pe[0].color};Pe.unshift(Gt)}if(Pe[Pe.length-1].offset!=1){var tn={offset:1,color:Pe[Pe.length-1].color};Pe.push(tn)}for(var Mn="",on=0,$n=0;$n<ht.length;$n++){for(Qe=ht[$n];Qe>Pe[on+1].offset;)on++;var Fn=Pe[on].offset,Hn=(Qe-Fn)/(Pe[on+1].offset-Fn),yn=Pe[on].color,Cr=Pe[on+1].color;Mn+=X(Math.round((1-Hn)*yn[0]+Hn*Cr[0]).toString(16))+X(Math.round((1-Hn)*yn[1]+Hn*Cr[1]).toString(16))+X(Math.round((1-Hn)*yn[2]+Hn*Cr[2]).toString(16))}return Mn.trim()}(v.colors,V),pe=[];pe.push({key:"FunctionType",value:"0"}),pe.push({key:"Domain",value:"[0.0 1.0]"}),pe.push({key:"Size",value:"["+V+"]"}),pe.push({key:"BitsPerSample",value:"8"}),pe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),pe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Xn({data:oe,additionalKeyValues:pe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ne}),se("endobj"),v.objectNumber=jn(),se("<< /ShadingType "+v.type),se("/ColorSpace /DeviceRGB");var Se="/Coords ["+I(parseFloat(v.coords[0]))+" "+I(parseFloat(v.coords[1]))+" ";v.type===2?Se+=I(parseFloat(v.coords[2]))+" "+I(parseFloat(v.coords[3])):Se+=I(parseFloat(v.coords[2]))+" "+I(parseFloat(v.coords[3]))+" "+I(parseFloat(v.coords[4]))+" "+I(parseFloat(v.coords[5])),se(Se+="]"),v.matrix&&se("/Matrix ["+v.matrix.toString()+"]"),se("/Function "+ne+" 0 R"),se("/Extend [true true]"),se(">>"),se("endobj")},Sa=function(v,V){var ne=lr(),oe=jn();V.push({resourcesOid:ne,objectOid:oe}),v.objectNumber=oe;var pe=[];pe.push({key:"Type",value:"/Pattern"}),pe.push({key:"PatternType",value:"1"}),pe.push({key:"PaintType",value:"1"}),pe.push({key:"TilingType",value:"1"}),pe.push({key:"BBox",value:"["+v.boundingBox.map(I).join(" ")+"]"}),pe.push({key:"XStep",value:I(v.xStep)}),pe.push({key:"YStep",value:I(v.yStep)}),pe.push({key:"Resources",value:ne+" 0 R"}),v.matrix&&pe.push({key:"Matrix",value:"["+v.matrix.toString()+"]"}),Xn({data:v.stream,additionalKeyValues:pe,objectId:v.objectNumber}),se("endobj")},Ou=function(v){for(var V in v.objectNumber=jn(),se("<<"),v)switch(V){case"opacity":se("/ca "+N(v[V]));break;case"stroke-opacity":se("/CA "+N(v[V]))}se(">>"),se("endobj")},$s=function(v){Pn(v.resourcesOid,!0),se("<<"),se("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var V in se("/Font <<"),Je)Je.hasOwnProperty(V)&&(g===!1||g===!0&&y.hasOwnProperty(V))&&se("/"+V+" "+Je[V].objectNumber+" 0 R");se(">>")}(),function(){if(Object.keys(dt).length>0){for(var V in se("/Shading <<"),dt)dt.hasOwnProperty(V)&&dt[V]instanceof ql&&dt[V].objectNumber>=0&&se("/"+V+" "+dt[V].objectNumber+" 0 R");Ot.publish("putShadingPatternDict"),se(">>")}}(),function(V){if(Object.keys(dt).length>0){for(var ne in se("/Pattern <<"),dt)dt.hasOwnProperty(ne)&&dt[ne]instanceof p.TilingPattern&&dt[ne].objectNumber>=0&&dt[ne].objectNumber<V&&se("/"+ne+" "+dt[ne].objectNumber+" 0 R");Ot.publish("putTilingPatternDict"),se(">>")}}(v.objectOid),function(){if(Object.keys(At).length>0){var V;for(V in se("/ExtGState <<"),At)At.hasOwnProperty(V)&&At[V].objectNumber>=0&&se("/"+V+" "+At[V].objectNumber+" 0 R");Ot.publish("putGStateDict"),se(">>")}}(),function(){for(var V in se("/XObject <<"),Qn)Qn.hasOwnProperty(V)&&Qn[V].objectNumber>=0&&se("/"+V+" "+Qn[V].objectNumber+" 0 R");Ot.publish("putXobjectDict"),se(">>")}(),se(">>"),se("endobj")},xl=function(v){bt[v.fontName]=bt[v.fontName]||{},bt[v.fontName][v.fontStyle]=v.id},uo=function(v,V,ne,oe,pe){var Se={id:"F"+(Object.keys(Je).length+1).toString(10),postScriptName:v,fontName:V,fontStyle:ne,encoding:oe,isStandardFont:pe||!1,metadata:{}};return Ot.publish("addFont",{font:Se,instance:this}),Je[Se.id]=Se,xl(Se),Se.id},_r=p.__private__.pdfEscape=p.pdfEscape=function(v,V){return function(ne,oe){var pe,Se,Pe,He,Qe,ht,wt,Gt,tn;if(Pe=(oe=oe||{}).sourceEncoding||"Unicode",Qe=oe.outputEncoding,(oe.autoencode||Qe)&&Je[rt].metadata&&Je[rt].metadata[Pe]&&Je[rt].metadata[Pe].encoding&&(He=Je[rt].metadata[Pe].encoding,!Qe&&Je[rt].encoding&&(Qe=Je[rt].encoding),!Qe&&He.codePages&&(Qe=He.codePages[0]),typeof Qe=="string"&&(Qe=He[Qe]),Qe)){for(wt=!1,ht=[],pe=0,Se=ne.length;pe<Se;pe++)(Gt=Qe[ne.charCodeAt(pe)])?ht.push(String.fromCharCode(Gt)):ht.push(ne[pe]),ht[pe].charCodeAt(0)>>8&&(wt=!0);ne=ht.join("")}for(pe=ne.length;wt===void 0&&pe!==0;)ne.charCodeAt(pe-1)>>8&&(wt=!0),pe--;if(!wt)return ne;for(ht=oe.noBOM?[]:[254,255],pe=0,Se=ne.length;pe<Se;pe++){if((tn=(Gt=ne.charCodeAt(pe))>>8)>>8)throw new Error("Character at position "+pe+" of string '"+ne+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ht.push(tn),ht.push(Gt-(tn<<8))}return String.fromCharCode.apply(void 0,ht)}(v,V).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ji=p.__private__.beginPage=function(v){ke[++en]=[],pt[en]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(v[0]),topRightY:Number(v[1])}},wl(en),Ne(ke[z])},ho=function(v,V){var ne,oe,pe;switch(n=V||n,typeof v=="string"&&(ne=A(v.toLowerCase()),Array.isArray(ne)&&(oe=ne[0],pe=ne[1])),Array.isArray(v)&&(oe=v[0]*ft,pe=v[1]*ft),isNaN(oe)&&(oe=i[0],pe=i[1]),(oe>14400||pe>14400)&&(vn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),oe=Math.min(14400,oe),pe=Math.min(14400,pe)),i=[oe,pe],n.substr(0,1)){case"l":pe>oe&&(i=[pe,oe]);break;case"p":oe>pe&&(i=[pe,oe])}ji(i),Ys(mo),se(bs),pn!==0&&se(pn+" J"),kl!==0&&se(kl+" j"),Ot.publish("addPage",{pageNumber:en})},bl=function(v){v>0&&v<=en&&(ke.splice(v,1),pt.splice(v,1),en--,z>en&&(z=en),this.setPage(z))},wl=function(v){v>0&&v<=en&&(z=v)},_l=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return ke.length-1},Nl=function(v,V,ne){var oe,pe=void 0;return ne=ne||{},v=v!==void 0?v:Je[rt].fontName,V=V!==void 0?V:Je[rt].fontStyle,oe=v.toLowerCase(),bt[oe]!==void 0&&bt[oe][V]!==void 0?pe=bt[oe][V]:bt[v]!==void 0&&bt[v][V]!==void 0?pe=bt[v][V]:ne.disableWarning===!1&&vn.warn("Unable to look up font label for font '"+v+"', '"+V+"'. Refer to getFontList() for available fonts."),pe||ne.noFallback||(pe=bt.times[V])==null&&(pe=bt.times.normal),pe},Hs=p.__private__.putInfo=function(){var v=jn(),V=function(oe){return oe};for(var ne in f!==null&&(V=an.encryptor(v,0)),se("<<"),se("/Producer ("+_r(V("jsPDF "+st.version))+")"),xt)xt.hasOwnProperty(ne)&&xt[ne]&&se("/"+ne.substr(0,1).toUpperCase()+ne.substr(1)+" ("+_r(V(xt[ne]))+")");se("/CreationDate ("+_r(V(D))+")"),se(">>"),se("endobj")},Al=p.__private__.putCatalog=function(v){var V=(v=v||{}).rootDictionaryObjId||Bs;switch(jn(),se("<<"),se("/Type /Catalog"),se("/Pages "+V+" 0 R"),je||(je="fullwidth"),je){case"fullwidth":se("/OpenAction [3 0 R /FitH null]");break;case"fullheight":se("/OpenAction [3 0 R /FitV null]");break;case"fullpage":se("/OpenAction [3 0 R /Fit]");break;case"original":se("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ne=""+je;ne.substr(ne.length-1)==="%"&&(je=parseInt(je)/100),typeof je=="number"&&se("/OpenAction [3 0 R /XYZ null null "+N(je)+"]")}switch(Nt||(Nt="continuous"),Nt){case"continuous":se("/PageLayout /OneColumn");break;case"single":se("/PageLayout /SinglePage");break;case"two":case"twoleft":se("/PageLayout /TwoColumnLeft");break;case"tworight":se("/PageLayout /TwoColumnRight")}nt&&se("/PageMode /"+nt),Ot.publish("putCatalog"),se(">>"),se("endobj")},On=p.__private__.putTrailer=function(){se("trailer"),se("<<"),se("/Size "+(Z+1)),se("/Root "+Z+" 0 R"),se("/Info "+(Z-1)+" 0 R"),f!==null&&se("/Encrypt "+an.oid+" 0 R"),se("/ID [ <"+W+"> <"+W+"> ]"),se(">>")},Sl=p.__private__.putHeader=function(){se("%PDF-"+T),se("%ºß¬à")},bc=p.__private__.putXRef=function(){var v="0000000000";se("xref"),se("0 "+(Z+1)),se("0000000000 65535 f ");for(var V=1;V<=Z;V++)typeof le[V]=="function"?se((v+le[V]()).slice(-10)+" 00000 n "):le[V]!==void 0?se((v+le[V]).slice(-10)+" 00000 n "):se("0000000000 00000 n ")},ys=p.__private__.buildDocument=function(){var v;Z=0,ye=0,me=[],le=[],xe=[],Bs=lr(),qr=lr(),Ne(me),Ot.publish("buildDocument"),Sl(),Ii(),function(){Ot.publish("putAdditionalObjects");for(var ne=0;ne<xe.length;ne++){var oe=xe[ne];Pn(oe.objId,!0),se(oe.content),se("endobj")}Ot.publish("postPutAdditionalObjects")}(),v=[],function(){for(var ne in Je)Je.hasOwnProperty(ne)&&(g===!1||g===!0&&y.hasOwnProperty(ne))&&vs(Je[ne])}(),function(){var ne;for(ne in At)At.hasOwnProperty(ne)&&Ou(At[ne])}(),function(){for(var ne in Qn)Qn.hasOwnProperty(ne)&&zs(Qn[ne])}(),function(ne){var oe;for(oe in dt)dt.hasOwnProperty(oe)&&(dt[oe]instanceof ql?Aa(dt[oe]):dt[oe]instanceof Kc&&Sa(dt[oe],ne))}(v),Ot.publish("putResources"),v.forEach($s),$s({resourcesOid:qr,objectOid:Number.MAX_SAFE_INTEGER}),Ot.publish("postPutResources"),f!==null&&(an.oid=jn(),se("<<"),se("/Filter /Standard"),se("/V "+an.v),se("/R "+an.r),se("/U <"+an.toHexString(an.U)+">"),se("/O <"+an.toHexString(an.O)+">"),se("/P "+an.P),se(">>"),se("endobj")),Hs(),Al();var V=ye;return bc(),On(),se("startxref"),se(""+V),se("%%EOF"),Ne(ke[z]),me.join(`
`)},Ws=p.__private__.getBlob=function(v){return new Blob([Ye(v)],{type:"application/pdf"})},mi=p.output=p.__private__.output=(wr=function(v,V){switch(typeof(V=V||{})=="string"?V={filename:V}:V.filename=V.filename||"generated.pdf",v){case void 0:return ys();case"save":p.save(V.filename);break;case"arraybuffer":return Ye(ys());case"blob":return Ws(ys());case"bloburi":case"bloburl":if(_t.URL!==void 0&&typeof _t.URL.createObjectURL=="function")return _t.URL&&_t.URL.createObjectURL(Ws(ys()))||void 0;vn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ne="",oe=ys();try{ne=J5(oe)}catch{ne=J5(unescape(encodeURIComponent(oe)))}return"data:application/pdf;filename="+V.filename+";base64,"+ne;case"pdfobjectnewwindow":if(Object.prototype.toString.call(_t)==="[object Window]"){var pe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Se=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';V.pdfObjectUrl&&(pe=V.pdfObjectUrl,Se="");var Pe='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+pe+'"'+Se+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(V)+");<\/script></body></html>",He=_t.open();return He!==null&&He.document.write(Pe),He}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(_t)==="[object Window]"){var Qe='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(V.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+V.filename+'" width="500px" height="400px" /></body></html>',ht=_t.open();if(ht!==null){ht.document.write(Qe);var wt=this;ht.document.documentElement.querySelector("#pdfViewer").onload=function(){ht.document.title=V.filename,ht.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(wt.output("bloburl"))}}return ht}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(_t)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Gt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",V)+'"></iframe></body></html>',tn=_t.open();if(tn!==null&&(tn.document.write(Gt),tn.document.title=V.filename),tn||typeof safari>"u")return tn;break;case"datauri":case"dataurl":return _t.document.location.href=this.output("datauristring",V);default:return null}},wr.foo=function(){try{return wr.apply(this,arguments)}catch(ne){var v=ne.stack||"";~v.indexOf(" at ")&&(v=v.split(" at ")[1]);var V="Error in function "+v.split(`
`)[0].split("<")[0]+": "+ne.message;if(!_t.console)throw new Error(V);_t.console.error(V,ne),_t.alert&&alert(V)}},wr.foo.bar=wr,wr.foo),Ea=function(v){return Array.isArray(Us)===!0&&Us.indexOf(v)>-1};switch(r){case"pt":ft=1;break;case"mm":ft=72/25.4;break;case"cm":ft=72/2.54;break;case"in":ft=72;break;case"px":ft=Ea("px_scaling")==1?.75:96/72;break;case"pc":case"em":ft=12;break;case"ex":ft=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);ft=r}var an=null;ce(),q();var ai=p.__private__.getPageInfo=p.getPageInfo=function(v){if(isNaN(v)||v%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:pt[v].objId,pageNumber:v,pageContext:pt[v]}},fo=p.__private__.getPageInfoByObjId=function(v){if(isNaN(v)||v%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var V in pt)if(pt[V].objId===v)break;return ai(V)},po=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:pt[z].objId,pageNumber:z,pageContext:pt[z]}};p.addPage=function(){return ho.apply(this,arguments),this},p.setPage=function(){return wl.apply(this,arguments),Ne.call(this,ke[z]),this},p.insertPage=function(v){return this.addPage(),this.movePage(z,v),this},p.movePage=function(v,V){var ne,oe;if(v>V){ne=ke[v],oe=pt[v];for(var pe=v;pe>V;pe--)ke[pe]=ke[pe-1],pt[pe]=pt[pe-1];ke[V]=ne,pt[V]=oe,this.setPage(V)}else if(v<V){ne=ke[v],oe=pt[v];for(var Se=v;Se<V;Se++)ke[Se]=ke[Se+1],pt[Se]=pt[Se+1];ke[V]=ne,pt[V]=oe,this.setPage(V)}return this},p.deletePage=function(){return bl.apply(this,arguments),this},p.__private__.text=p.text=function(v,V,ne,oe,pe){var Se,Pe,He,Qe,ht,wt,Gt,tn,Mn,on=(oe=oe||{}).scope||this;if(typeof v=="number"&&typeof V=="number"&&(typeof ne=="string"||Array.isArray(ne))){var $n=ne;ne=V,V=v,v=$n}if(arguments[3]instanceof ut==0?(He=arguments[4],Qe=arguments[5],dn(Gt=arguments[3])==="object"&&Gt!==null||(typeof He=="string"&&(Qe=He,He=null),typeof Gt=="string"&&(Qe=Gt,Gt=null),typeof Gt=="number"&&(He=Gt,Gt=null),oe={flags:Gt,angle:He,align:Qe})):(j("The transform parameter of text() with a Matrix value"),Mn=pe),isNaN(V)||isNaN(ne)||v==null)throw new Error("Invalid arguments passed to jsPDF.text");if(v.length===0)return on;var Fn,Hn="",yn=typeof oe.lineHeightFactor=="number"?oe.lineHeightFactor:Ks,Cr=on.internal.scaleFactor;function Ll(rn){return rn=rn.split("	").join(Array(oe.TabLen||9).join(" ")),_r(rn,Gt)}function Li(rn){for(var mn,Zn=rn.concat(),fr=[],La=Zn.length;La--;)typeof(mn=Zn.shift())=="string"?fr.push(mn):Array.isArray(rn)&&(mn.length===1||mn[1]===void 0&&mn[2]===void 0)?fr.push(mn[0]):fr.push([mn[0],mn[1],mn[2]]);return fr}function h(rn,mn){var Zn;if(typeof rn=="string")Zn=mn(rn)[0];else if(Array.isArray(rn)){for(var fr,La,Qu=rn.concat(),Ac=[],Vh=Qu.length;Vh--;)typeof(fr=Qu.shift())=="string"?Ac.push(mn(fr)[0]):Array.isArray(fr)&&typeof fr[0]=="string"&&(La=mn(fr[0],fr[1],fr[2]),Ac.push([La[0],La[1],La[2]]));Zn=Ac}return Zn}var b=!1,R=!0;if(typeof v=="string")b=!0;else if(Array.isArray(v)){var Q=v.concat();Pe=[];for(var ge,_e=Q.length;_e--;)(typeof(ge=Q.shift())!="string"||Array.isArray(ge)&&typeof ge[0]!="string")&&(R=!1);b=R}if(b===!1)throw new Error('Type of text must be string or Array. "'+v+'" is not recognized.');typeof v=="string"&&(v=v.match(/[\r?\n]/)?v.split(/\r\n|\r|\n/g):[v]);var Fe=De/on.internal.scaleFactor,qt=Fe*(yn-1);switch(oe.baseline){case"bottom":ne-=qt;break;case"top":ne+=Fe-qt;break;case"hanging":ne+=Fe-2*qt;break;case"middle":ne+=Fe/2-qt}if((wt=oe.maxWidth||0)>0&&(typeof v=="string"?v=on.splitTextToSize(v,wt):Object.prototype.toString.call(v)==="[object Array]"&&(v=v.reduce(function(rn,mn){return rn.concat(on.splitTextToSize(mn,wt))},[]))),Se={text:v,x:V,y:ne,options:oe,mutex:{pdfEscape:_r,activeFontKey:rt,fonts:Je,activeFontSize:De}},Ot.publish("preProcessText",Se),v=Se.text,He=(oe=Se.options).angle,Mn instanceof ut==0&&He&&typeof He=="number"){He*=Math.PI/180,oe.rotationDirection===0&&(He=-He),F===M&&(He=-He);var Vn=Math.cos(He),Mt=Math.sin(He);Mn=new ut(Vn,Mt,-Mt,Vn,0,0)}else He&&He instanceof ut&&(Mn=He);F!==M||Mn||(Mn=es),(ht=oe.charSpace||ka)!==void 0&&(Hn+=I(k(ht))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(tn=oe.horizontalScale)!==void 0&&(Hn+=I(100*tn)+` Tz
`),oe.lang;var Dt=-1,xn=oe.renderingMode!==void 0?oe.renderingMode:oe.stroke,Ri=on.internal.getCurrentPageInfo().pageContext;switch(xn){case 0:case!1:case"fill":Dt=0;break;case 1:case!0:case"stroke":Dt=1;break;case 2:case"fillThenStroke":Dt=2;break;case 3:case"invisible":Dt=3;break;case 4:case"fillAndAddForClipping":Dt=4;break;case 5:case"strokeAndAddPathForClipping":Dt=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Dt=6;break;case 7:case"addToPathForClipping":Dt=7}var $r=Ri.usedRenderingMode!==void 0?Ri.usedRenderingMode:-1;Dt!==-1?Hn+=Dt+` Tr
`:$r!==-1&&(Hn+=`0 Tr
`),Dt!==-1&&(Ri.usedRenderingMode=Dt),Qe=oe.align||"left";var kr,_s=De*yn,zu=on.internal.pageSize.getWidth(),$u=Je[rt];ht=oe.charSpace||ka,wt=oe.maxWidth||0,Gt=Object.assign({autoencode:!0,noBOM:!0},oe.flags);var bo=[],Rl=function(rn){return on.getStringUnitWidth(rn,{font:$u,charSpace:ht,fontSize:De,doKerning:!1})*De/Cr};if(Object.prototype.toString.call(v)==="[object Array]"){var Di;Pe=Li(v),Qe!=="left"&&(kr=Pe.map(Rl));var Oi,wo=0;if(Qe==="right"){V-=kr[0],v=[],_e=Pe.length;for(var Pa=0;Pa<_e;Pa++)Pa===0?(Oi=Nr(V),Di=xs(ne)):(Oi=k(wo-kr[Pa]),Di=-_s),v.push([Pe[Pa],Oi,Di]),wo=kr[Pa]}else if(Qe==="center"){V-=kr[0]/2,v=[],_e=Pe.length;for(var _o=0;_o<_e;_o++)_o===0?(Oi=Nr(V),Di=xs(ne)):(Oi=k((wo-kr[_o])/2),Di=-_s),v.push([Pe[_o],Oi,Di]),wo=kr[_o]}else if(Qe==="left"){v=[],_e=Pe.length;for(var Hu=0;Hu<_e;Hu++)v.push(Pe[Hu])}else if(Qe==="justify"&&$u.encoding==="Identity-H"){v=[],_e=Pe.length,wt=wt!==0?wt:zu;for(var Nc=0,Jn=0;Jn<_e;Jn++)if(Di=Jn===0?xs(ne):-_s,Oi=Jn===0?Nr(V):Nc,Jn<_e-1){var Fh=k((wt-kr[Jn])/(Pe[Jn].split(" ").length-1)),Zs=Pe[Jn].split(" ");v.push([Zs[0]+" ",Oi,Di]),Nc=0;for(var ea=1;ea<Zs.length;ea++){var Wu=(Rl(Zs[ea-1]+" "+Zs[ea])-Rl(Zs[ea]))*Cr+Fh;ea==Zs.length-1?v.push([Zs[ea],Wu,0]):v.push([Zs[ea]+" ",Wu,0]),Nc-=Wu}}else v.push([Pe[Jn],Oi,Di]);v.push(["",Nc,0])}else{if(Qe!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(v=[],_e=Pe.length,wt=wt!==0?wt:zu,Jn=0;Jn<_e;Jn++){Di=Jn===0?xs(ne):-_s,Oi=Jn===0?Nr(V):0;var Gu=Pe[Jn].split(" ").length-1,Ku=Gu>0?(wt-kr[Jn])/Gu:0;Jn<_e-1?bo.push(I(k(Ku))):bo.push(0),v.push([Pe[Jn],Oi,Di])}}}(typeof oe.R2L=="boolean"?oe.R2L:Et)===!0&&(v=h(v,function(rn,mn,Zn){return[rn.split("").reverse().join(""),mn,Zn]})),Se={text:v,x:V,y:ne,options:oe,mutex:{pdfEscape:_r,activeFontKey:rt,fonts:Je,activeFontSize:De}},Ot.publish("postProcessText",Se),v=Se.text,Fn=Se.mutex.isHex||!1;var Yu=Je[rt].encoding;Yu!=="WinAnsiEncoding"&&Yu!=="StandardEncoding"||(v=h(v,function(rn,mn,Zn){return[Ll(rn),mn,Zn]})),Pe=Li(v),v=[];for(var No,Ao,So,Dl=Array.isArray(Pe[0])?1:0,Eo="",Ol=function(rn,mn,Zn){var fr="";return Zn instanceof ut?(Zn=typeof oe.angle=="number"?Nn(Zn,new ut(1,0,0,1,rn,mn)):Nn(new ut(1,0,0,1,rn,mn),Zn),F===M&&(Zn=Nn(new ut(1,0,0,-1,0,0),Zn)),fr=Zn.join(" ")+` Tm
`):fr=I(rn)+" "+I(mn)+` Td
`,fr},is=0;is<Pe.length;is++){switch(Eo="",Dl){case 1:So=(Fn?"<":"(")+Pe[is][0]+(Fn?">":")"),No=parseFloat(Pe[is][1]),Ao=parseFloat(Pe[is][2]);break;case 0:So=(Fn?"<":"(")+Pe[is]+(Fn?">":")"),No=Nr(V),Ao=xs(ne)}bo!==void 0&&bo[is]!==void 0&&(Eo=bo[is]+` Tw
`),is===0?v.push(Eo+Ol(No,Ao,Mn)+So):Dl===0?v.push(Eo+So):Dl===1&&v.push(Eo+Ol(No,Ao,Mn)+So)}v=Dl===0?v.join(` Tj
T* `):v.join(` Tj
`),v+=` Tj
`;var ta=`BT
/`;return ta+=rt+" "+De+` Tf
`,ta+=I(De*yn)+` TL
`,ta+=Pi+`
`,ta+=Hn,ta+=v,se(ta+="ET"),y[rt]=!0,on};var wc=p.__private__.clip=p.clip=function(v){return se(v==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return wc("evenodd")},p.__private__.discardPath=p.discardPath=function(){return se("n"),this};var Vt=p.__private__.isValidStyle=function(v){var V=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(v)!==-1&&(V=!0),V};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(v){return Vt(v)&&(u=v),this};var Ta=p.__private__.getStyle=p.getStyle=function(v){var V=u;switch(v){case"D":case"S":V="S";break;case"F":V="f";break;case"FD":case"DF":V="B";break;case"f":case"f*":case"B":case"B*":V=v}return V},Gs=p.close=function(){return se("h"),this};p.stroke=function(){return se("S"),this},p.fill=function(v){return gi("f",v),this},p.fillEvenOdd=function(v){return gi("f*",v),this},p.fillStroke=function(v){return gi("B",v),this},p.fillStrokeEvenOdd=function(v){return gi("B*",v),this};var gi=function(v,V){dn(V)==="object"?Mu(V,v):se(v)},El=function(v){v===null||F===M&&v===void 0||(v=Ta(v),se(v))};function _c(v,V,ne,oe,pe){var Se=new Kc(V||this.boundingBox,ne||this.xStep,oe||this.yStep,this.gState,pe||this.matrix);Se.stream=this.stream;var Pe=v+"$$"+this.cloneIndex+++"$$";return br(Pe,Se),Se}var Mu=function(v,V){var ne=Rt[v.key],oe=dt[ne];if(oe instanceof ql)se("q"),se(Fu(V)),oe.gState&&p.setGState(oe.gState),se(v.matrix.toString()+" cm"),se("/"+ne+" sh"),se("Q");else if(oe instanceof Kc){var pe=new ut(1,0,0,-1,0,rs());v.matrix&&(pe=pe.multiply(v.matrix||es),ne=_c.call(oe,v.key,v.boundingBox,v.xStep,v.yStep,pe).id),se("q"),se("/Pattern cs"),se("/"+ne+" scn"),oe.gState&&p.setGState(oe.gState),se(V),se("Q")}},Fu=function(v){switch(v){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Tl=p.moveTo=function(v,V){return se(I(k(v))+" "+I(H(V))+" m"),this},Ca=p.lineTo=function(v,V){return se(I(k(v))+" "+I(H(V))+" l"),this},vi=p.curveTo=function(v,V,ne,oe,pe,Se){return se([I(k(v)),I(H(V)),I(k(ne)),I(H(oe)),I(k(pe)),I(H(Se)),"c"].join(" ")),this};p.__private__.line=p.line=function(v,V,ne,oe,pe){if(isNaN(v)||isNaN(V)||isNaN(ne)||isNaN(oe)||!Vt(pe))throw new Error("Invalid arguments passed to jsPDF.line");return F===L?this.lines([[ne-v,oe-V]],v,V,[1,1],pe||"S"):this.lines([[ne-v,oe-V]],v,V,[1,1]).stroke()},p.__private__.lines=p.lines=function(v,V,ne,oe,pe,Se){var Pe,He,Qe,ht,wt,Gt,tn,Mn,on,$n,Fn,Hn;if(typeof v=="number"&&(Hn=ne,ne=V,V=v,v=Hn),oe=oe||[1,1],Se=Se||!1,isNaN(V)||isNaN(ne)||!Array.isArray(v)||!Array.isArray(oe)||!Vt(pe)||typeof Se!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Tl(V,ne),Pe=oe[0],He=oe[1],ht=v.length,$n=V,Fn=ne,Qe=0;Qe<ht;Qe++)(wt=v[Qe]).length===2?($n=wt[0]*Pe+$n,Fn=wt[1]*He+Fn,Ca($n,Fn)):(Gt=wt[0]*Pe+$n,tn=wt[1]*He+Fn,Mn=wt[2]*Pe+$n,on=wt[3]*He+Fn,$n=wt[4]*Pe+$n,Fn=wt[5]*He+Fn,vi(Gt,tn,Mn,on,$n,Fn));return Se&&Gs(),El(pe),this},p.path=function(v){for(var V=0;V<v.length;V++){var ne=v[V],oe=ne.c;switch(ne.op){case"m":Tl(oe[0],oe[1]);break;case"l":Ca(oe[0],oe[1]);break;case"c":vi.apply(this,oe);break;case"h":Gs()}}return this},p.__private__.rect=p.rect=function(v,V,ne,oe,pe){if(isNaN(v)||isNaN(V)||isNaN(ne)||isNaN(oe)||!Vt(pe))throw new Error("Invalid arguments passed to jsPDF.rect");return F===L&&(oe=-oe),se([I(k(v)),I(H(V)),I(k(ne)),I(k(oe)),"re"].join(" ")),El(pe),this},p.__private__.triangle=p.triangle=function(v,V,ne,oe,pe,Se,Pe){if(isNaN(v)||isNaN(V)||isNaN(ne)||isNaN(oe)||isNaN(pe)||isNaN(Se)||!Vt(Pe))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ne-v,oe-V],[pe-ne,Se-oe],[v-pe,V-Se]],v,V,[1,1],Pe,!0),this},p.__private__.roundedRect=p.roundedRect=function(v,V,ne,oe,pe,Se,Pe){if(isNaN(v)||isNaN(V)||isNaN(ne)||isNaN(oe)||isNaN(pe)||isNaN(Se)||!Vt(Pe))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var He=4/3*(Math.SQRT2-1);return pe=Math.min(pe,.5*ne),Se=Math.min(Se,.5*oe),this.lines([[ne-2*pe,0],[pe*He,0,pe,Se-Se*He,pe,Se],[0,oe-2*Se],[0,Se*He,-pe*He,Se,-pe,Se],[2*pe-ne,0],[-pe*He,0,-pe,-Se*He,-pe,-Se],[0,2*Se-oe],[0,-Se*He,pe*He,-Se,pe,-Se]],v+pe,V,[1,1],Pe,!0),this},p.__private__.ellipse=p.ellipse=function(v,V,ne,oe,pe){if(isNaN(v)||isNaN(V)||isNaN(ne)||isNaN(oe)||!Vt(pe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Se=4/3*(Math.SQRT2-1)*ne,Pe=4/3*(Math.SQRT2-1)*oe;return Tl(v+ne,V),vi(v+ne,V-Pe,v+Se,V-oe,v,V-oe),vi(v-Se,V-oe,v-ne,V-Pe,v-ne,V),vi(v-ne,V+Pe,v-Se,V+oe,v,V+oe),vi(v+Se,V+oe,v+ne,V+Pe,v+ne,V),El(pe),this},p.__private__.circle=p.circle=function(v,V,ne,oe){if(isNaN(v)||isNaN(V)||isNaN(ne)||!Vt(oe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(v,V,ne,ne,oe)},p.setFont=function(v,V,ne){return ne&&(V=B(V,ne)),rt=Nl(v,V,{disableWarning:!1}),this};var ts=p.__private__.getFont=p.getFont=function(){return Je[Nl.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var v,V,ne={};for(v in bt)if(bt.hasOwnProperty(v))for(V in ne[v]=[],bt[v])bt[v].hasOwnProperty(V)&&ne[v].push(V);return ne},p.addFont=function(v,V,ne,oe,pe){var Se=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Se.indexOf(arguments[3])!==-1?pe=arguments[3]:arguments[3]&&Se.indexOf(arguments[3])==-1&&(ne=B(ne,oe)),uo.call(this,v,V,ne,pe=pe||"Identity-H")};var Ks,mo=t.lineWidth||.200025,gt=p.__private__.getLineWidth=p.getLineWidth=function(){return mo},Ys=p.__private__.setLineWidth=p.setLineWidth=function(v){return mo=v,se(I(k(v))+" w"),this};p.__private__.setLineDash=st.API.setLineDash=st.API.setLineDashPattern=function(v,V){if(v=v||[],V=V||0,isNaN(V)||!Array.isArray(v))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return v=v.map(function(ne){return I(k(ne))}).join(" "),V=I(k(V)),se("["+v+"] "+V+" d"),this};var Vu=p.__private__.getLineHeight=p.getLineHeight=function(){return De*Ks};p.__private__.getLineHeight=p.getLineHeight=function(){return De*Ks};var Uu=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(v){return typeof(v=v||1.15)=="number"&&(Ks=v),this},Bu=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return Ks};Uu(t.lineHeight);var Nr=p.__private__.getHorizontalCoordinate=function(v){return k(v)},xs=p.__private__.getVerticalCoordinate=function(v){return F===M?v:pt[z].mediaBox.topRightY-pt[z].mediaBox.bottomLeftY-k(v)},qu=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(v){return I(Nr(v))},go=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(v){return I(xs(v))},bs=t.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return ki(bs)},p.__private__.setStrokeColor=p.setDrawColor=function(v,V,ne,oe){return bs=si({ch1:v,ch2:V,ch3:ne,ch4:oe,pdfColorType:"draw",precision:2}),se(bs),this};var vo=t.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return ki(vo)},p.__private__.setFillColor=p.setFillColor=function(v,V,ne,oe){return vo=si({ch1:v,ch2:V,ch3:ne,ch4:oe,pdfColorType:"fill",precision:2}),se(vo),this};var Pi=t.textColor||"0 g",ns=p.__private__.getTextColor=p.getTextColor=function(){return ki(Pi)};p.__private__.setTextColor=p.setTextColor=function(v,V,ne,oe){return Pi=si({ch1:v,ch2:V,ch3:ne,ch4:oe,pdfColorType:"text",precision:3}),this};var ka=t.charSpace,Cl=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(ka||0)};p.__private__.setCharSpace=p.setCharSpace=function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ka=v,this};var pn=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(v){var V=p.CapJoinStyles[v];if(V===void 0)throw new Error("Line cap style of '"+v+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return pn=V,se(V+" J"),this};var kl=0;p.__private__.setLineJoin=p.setLineJoin=function(v){var V=p.CapJoinStyles[v];if(V===void 0)throw new Error("Line join style of '"+v+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return kl=V,se(V+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(v){if(v=v||0,isNaN(v))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return se(I(k(v))+" M"),this},p.GState=sm,p.setGState=function(v){(v=typeof v=="string"?At[In[v]]:Ia(null,v)).equals(_n)||(se("/"+v.id+" gs"),_n=v)};var Ia=function(v,V){if(!v||!In[v]){var ne=!1;for(var oe in At)if(At.hasOwnProperty(oe)&&At[oe].equals(V)){ne=!0;break}if(ne)V=At[oe];else{var pe="GS"+(Object.keys(At).length+1).toString(10);At[pe]=V,V.id=pe}return v&&(In[v]=V.id),Ot.publish("addGState",V),V}};p.addGState=function(v,V){return Ia(v,V),this},p.saveGraphicsState=function(){return se("q"),sn.push({key:rt,size:De,color:Pi}),this},p.restoreGraphicsState=function(){se("Q");var v=sn.pop();return rt=v.key,De=v.size,Pi=v.color,_n=null,this},p.setCurrentTransformationMatrix=function(v){return se(v.toString()+" cm"),this},p.comment=function(v){return se("#"+v),this};var Qs=function(v,V){var ne=v||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ne},set:function(Se){isNaN(Se)||(ne=parseFloat(Se))}});var oe=V||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return oe},set:function(Se){isNaN(Se)||(oe=parseFloat(Se))}});var pe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return pe},set:function(Se){pe=Se.toString()}}),this},yo=function(v,V,ne,oe){Qs.call(this,v,V),this.type="rect";var pe=ne||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return pe},set:function(Pe){isNaN(Pe)||(pe=parseFloat(Pe))}});var Se=oe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Se},set:function(Pe){isNaN(Pe)||(Se=parseFloat(Pe))}}),this},ja=function(){this.page=en,this.currentPage=z,this.pages=ke.slice(0),this.pagesContext=pt.slice(0),this.x=at,this.y=Jt,this.matrix=Wt,this.width=yi(z),this.height=ws(z),this.outputDestination=Ue,this.id="",this.objectNumber=-1};ja.prototype.restore=function(){en=this.page,z=this.currentPage,pt=this.pagesContext,ke=this.pages,at=this.x,Jt=this.y,Wt=this.matrix,Il(z,this.width),oi(z,this.height),Ue=this.outputDestination};var Xs=function(v,V,ne,oe,pe){Br.push(new ja),en=z=0,ke=[],at=v,Jt=V,Wt=pe,ji([ne,oe])};for(var Js in p.beginFormObject=function(v,V,ne,oe,pe){return Xs(v,V,ne,oe,pe),this},p.endFormObject=function(v){return function(V){if(Zi[V])Br.pop().restore();else{var ne=new ja,oe="Xo"+(Object.keys(Qn).length+1).toString(10);ne.id=oe,Zi[V]=oe,Qn[oe]=ne,Ot.publish("addFormObject",ne),Br.pop().restore()}}(v),this},p.doFormObject=function(v,V){var ne=Qn[Zi[v]];return se("q"),se(V.toString()+" cm"),se("/"+ne.id+" Do"),se("Q"),this},p.getFormObject=function(v){var V=Qn[Zi[v]];return{x:V.x,y:V.y,width:V.width,height:V.height,matrix:V.matrix}},p.save=function(v,V){return v=v||"generated.pdf",(V=V||{}).returnPromise=V.returnPromise||!1,V.returnPromise===!1?(Bl(Ws(ys()),v),typeof Bl.unload=="function"&&_t.setTimeout&&setTimeout(Bl.unload,911),this):new Promise(function(ne,oe){try{var pe=Bl(Ws(ys()),v);typeof Bl.unload=="function"&&_t.setTimeout&&setTimeout(Bl.unload,911),ne(pe)}catch(Se){oe(Se.message)}})},st.API)st.API.hasOwnProperty(Js)&&(Js==="events"&&st.API.events.length?function(v,V){var ne,oe,pe;for(pe=V.length-1;pe!==-1;pe--)ne=V[pe][0],oe=V[pe][1],v.subscribe.apply(v,[ne].concat(typeof oe=="function"?[oe]:oe))}(Ot,st.API.events):p[Js]=st.API[Js]);function yi(v){return pt[v].mediaBox.topRightX-pt[v].mediaBox.bottomLeftX}function Il(v,V){pt[v].mediaBox.topRightX=V+pt[v].mediaBox.bottomLeftX}function ws(v){return pt[v].mediaBox.topRightY-pt[v].mediaBox.bottomLeftY}function oi(v,V){pt[v].mediaBox.topRightY=V+pt[v].mediaBox.bottomLeftY}var jl=p.getPageWidth=function(v){return yi(v=v||z)/ft},xo=p.setPageWidth=function(v,V){Il(v,V*ft)},rs=p.getPageHeight=function(v){return ws(v=v||z)/ft},Pl=p.setPageHeight=function(v,V){oi(v,V*ft)};return p.internal={pdfEscape:_r,getStyle:Ta,getFont:ts,getFontSize:Ce,getCharSpace:Cl,getTextColor:ns,getLineHeight:Vu,getLineHeightFactor:Bu,getLineWidth:gt,write:yt,getHorizontalCoordinate:Nr,getVerticalCoordinate:xs,getCoordinateString:qu,getVerticalCoordinateString:go,collections:{},newObject:jn,newAdditionalObject:Na,newObjectDeferred:lr,newObjectDeferredBegin:Pn,getFilters:zr,putStream:Xn,events:Ot,scaleFactor:ft,pageSize:{getWidth:function(){return jl(z)},setWidth:function(v){xo(z,v)},getHeight:function(){return rs(z)},setHeight:function(v){Pl(z,v)}},encryptionOptions:f,encryption:an,getEncryptor:function(v){return f!==null?an.encryptor(v,0):function(V){return V}},output:mi,getNumberOfPages:_l,pages:ke,out:se,f2:N,f3:w,getPageInfo:ai,getPageInfoByObjId:fo,getCurrentPageInfo:po,getPDFVersion:E,Point:Qs,Rectangle:yo,Matrix:ut,hasHotfix:Ea},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return jl(z)},set:function(v){xo(z,v)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return rs(z)},set:function(v){Pl(z,v)},enumerable:!0,configurable:!0}),(function(v){for(var V=0,ne=ot.length;V<ne;V++){var oe=uo.call(this,v[V][0],v[V][1],v[V][2],ot[V][3],!0);g===!1&&(y[oe]=!0);var pe=v[V][0].split("-");xl({id:oe,fontName:pe[0],fontStyle:pe[1]||""})}Ot.publish("addFonts",{fonts:Je,dictionary:bt})}).call(p,ot),rt="F1",ho(i,n),Ot.publish("initialized"),p}Lc.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Lc.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Lc.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},Lc.prototype.processOwnerPassword=function(t,e){return W1(H1(e).substr(0,5),t)},Lc.prototype.encryptor=function(t,e){var n=H1(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return W1(n,r)}},sm.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||dn(t)!==dn(this))return!1;var r=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;r++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&r--;return r===0},st.API={events:[]},st.version="3.0.3";var Kn=st.API,$2=1,xc=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Cc=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ct=function(t){return t.toFixed(2)},Oo=function(t){return t.toFixed(5)};Kn.__acroform__={};var Ci=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},nw=function(t){return t*$2},ia=function(t){var e=new UA,n=Ke.internal.getHeight(t)||0,r=Ke.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Ct(r)),Number(Ct(n))],e},yD=Kn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},xD=Kn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},bD=Kn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},ir=Kn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return bD(t,e-1)},sr=Kn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return yD(t,e-1)},ar=Kn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return xD(t,e-1)},wD=Kn.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,i=t[0],s=t[1],a=t[2],l=t[3],c={};return c.lowerLeft_X=n(i)||0,c.lowerLeft_Y=r(s+l)||0,c.upperRight_X=n(i+a)||0,c.upperRight_Y=r(s)||0,[Number(Ct(c.lowerLeft_X)),Number(Ct(c.lowerLeft_Y)),Number(Ct(c.upperRight_X)),Number(Ct(c.upperRight_Y))]},_D=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,r=G1(t,n),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+Ct(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=ia(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},G1=function(t,e){var n=t.fontSize===0?t.maxFontSize:t.fontSize,r={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(N){return N.split(`
`)}):i.map(function(N){return[N]});var s=n,a=Ke.internal.getHeight(t)||0;a=a<0?-a:a;var l=Ke.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(N,w,k){if(N+1<i.length){var H=w+" "+i[N+1][0];return Pf(H,t,k).width<=l-4}return!1};s++;e:for(;s>0;){e="",s--;var u,f,g=Pf("3",t,s).height,y=t.multiline?a-s:(a-g)/2,p=y+=2,T=0,E=0,P=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+Pf(e,t,s=12).width+", FieldWidth:"+l+`
`;break}for(var A="",L=0,M=0;M<i.length;M++)if(i.hasOwnProperty(M)){var F=!1;if(i[M].length!==1&&P!==i[M].length-1){if((g+2)*(L+2)+2>a)continue e;A+=i[M][P],F=!0,E=M,M--}else{A=(A+=i[M][P]+" ").substr(A.length-1)==" "?A.substr(0,A.length-1):A;var te=parseInt(M),ae=c(te,A,s),B=M>=i.length-1;if(ae&&!B){A+=" ",P=0;continue}if(ae||B){if(B)E=te;else if(t.multiline&&(g+2)*(L+2)+2>a)continue e}else{if(!t.multiline||(g+2)*(L+2)+2>a)continue e;E=te}}for(var I="",j=T;j<=E;j++){var S=i[j];if(t.multiline){if(j===E){I+=S[P]+" ",P=(P+1)%S.length;continue}if(j===T){I+=S[S.length-1]+" ";continue}}I+=S[0]+" "}switch(I=I.substr(I.length-1)==" "?I.substr(0,I.length-1):I,f=Pf(I,t,s).width,t.textAlign){case"right":u=l-f-2;break;case"center":u=(l-f)/2;break;default:u=2}e+=Ct(u)+" "+Ct(p)+` Td
`,e+="("+xc(I)+`) Tj
`,e+=-Ct(u)+` 0 Td
`,p=-(s+2),f=0,T=F?E:E+1,L++,A=""}break}return r.text=e,r.fontSize=s,r},Pf=function(t,e,n){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:i}},ND={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},AD=function(t,e){var n={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},SD=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Fs.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(ND)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");$2=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new BA,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var s=r[i];s.objId=void 0,s.hasAnnotation&&AD(s,n)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(n){(function(r,i){var s=!r;for(var a in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(a)){var l=r[a],c=[],u=l.Rect;if(l.Rect&&(l.Rect=wD(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Ke.createDefaultAppearanceStream(l),dn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var f=_D(l);c.push({key:"AP",value:"<</N "+f+">>"}),i.internal.acroformPlugin.xForms.push(f)}if(l.appearanceStreamContent){var g="";for(var y in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(y)){var p=l.appearanceStreamContent[y];if(g+="/"+y+" ",g+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var a in p)if(p.hasOwnProperty(a)){var T=p[a];typeof T=="function"&&(T=T.call(i,l)),g+="/"+a+" "+T+" ",i.internal.acroformPlugin.xForms.indexOf(T)>=0||i.internal.acroformPlugin.xForms.push(T)}}else typeof(T=p)=="function"&&(T=T.call(i,l)),g+="/"+a+" "+T,i.internal.acroformPlugin.xForms.indexOf(T)>=0||i.internal.acroformPlugin.xForms.push(T);g+=">>"}c.push({key:"AP",value:`<<
`+g+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}s&&function(E,P){for(var A in E)if(E.hasOwnProperty(A)){var L=A,M=E[A];P.internal.newObjectDeferredBegin(M.objId,!0),dn(M)==="object"&&typeof M.putStream=="function"&&M.putStream(),delete E[L]}}(i.internal.acroformPlugin.xForms,i)})(n,t)}),t.internal.acroformPlugin.isInitialized=!0}},VA=Kn.__acroform__.arrayToPdfArray=function(t,e,n){var r=function(a){return a};if(Array.isArray(t)){for(var i="[",s=0;s<t.length;s++)switch(s!==0&&(i+=" "),dn(t[s])){case"boolean":case"number":case"object":i+=t[s].toString();break;case"string":t[s].substr(0,1)!=="/"?(e!==void 0&&n&&(r=n.internal.getEncryptor(e)),i+="("+xc(r(t[s].toString()))+")"):i+=t[s].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},m0=function(t,e,n){var r=function(i){return i};return e!==void 0&&n&&(r=n.internal.getEncryptor(e)),(t=t||"").toString(),"("+xc(r(t))+")"},la=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};la.prototype.toString=function(){return this.objId+" 0 R"},la.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},la.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var r=e[n],i=this[r];i&&(Array.isArray(i)?t.push({key:r,value:VA(i,this.objId,this.scope)}):i instanceof la?(i.scope=this.scope,t.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:r,value:i}))}return t};var UA=function(){la.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){t=n.trim()},get:function(){return t||null}})};Ci(UA,la);var BA=function(){la.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+xc(n(t))+")"}},set:function(n){t=n}})};Ci(BA,la);var Fs=function t(){la.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(A){if(isNaN(A))throw new Error('Invalid value "'+A+'" for attribute F supplied.');e=A}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!ir(e,3)},set:function(A){A?this.F=sr(e,3):this.F=ar(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(A){if(isNaN(A))throw new Error('Invalid value "'+A+'" for attribute Ff supplied.');n=A}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(A){r=A!==void 0?A:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(A){r[0]=A}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(A){r[1]=A}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(A){r[2]=A}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(A){r[3]=A}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(A){switch(A){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=A;break;default:throw new Error('Invalid value "'+A+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof am)return;s="FieldObject"+t.FieldNum++}var A=function(L){return L};return this.scope&&(A=this.scope.internal.getEncryptor(this.objId)),"("+xc(A(s))+")"},set:function(A){s=A.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(A){s=A}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(A){a=A}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(A){l=A}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(A){c=A}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/$2:u},set:function(A){u=A}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(A){f=A}});var g="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!g||this instanceof am||this instanceof Zl))return m0(g,this.objId,this.scope)},set:function(A){A=A.toString(),g=A}});var y=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(y)return this instanceof Er==0?m0(y,this.objId,this.scope):y},set:function(A){A=A.toString(),y=this instanceof Er==0?A.substr(0,1)==="("?Cc(A.substr(1,A.length-2)):Cc(A):A}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Er==1?Cc(y.substr(1,y.length-1)):y},set:function(A){A=A.toString(),y=this instanceof Er==1?"/"+A:A}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(A){this.V=A}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Er==0?m0(p,this.objId,this.scope):p},set:function(A){A=A.toString(),p=this instanceof Er==0?A.substr(0,1)==="("?Cc(A.substr(1,A.length-2)):Cc(A):A}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Er==1?Cc(p.substr(1,p.length-1)):p},set:function(A){A=A.toString(),p=this instanceof Er==1?"/"+A:A}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var T,E=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return E},set:function(A){A=!!A,E=A}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(T)return T},set:function(A){T=A}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,1)},set:function(A){A?this.Ff=sr(this.Ff,1):this.Ff=ar(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,2)},set:function(A){A?this.Ff=sr(this.Ff,2):this.Ff=ar(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,3)},set:function(A){A?this.Ff=sr(this.Ff,3):this.Ff=ar(this.Ff,3)}});var P=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(P!==null)return P},set:function(A){if([0,1,2].indexOf(A)===-1)throw new Error('Invalid value "'+A+'" for attribute Q supplied.');P=A}}),Object.defineProperty(this,"textAlign",{get:function(){var A;switch(P){case 0:default:A="left";break;case 1:A="center";break;case 2:A="right"}return A},configurable:!0,enumerable:!0,set:function(A){switch(A){case"right":case 2:P=2;break;case"center":case 1:P=1;break;default:P=0}}})};Ci(Fs,la);var au=function(){Fs.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){t=n}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return VA(e,this.objId,this.scope)},set:function(n){var r,i;i=[],typeof(r=n)=="string"&&(i=function(s,a,l){l||(l=1);for(var c,u=[];c=a.exec(s);)u.push(c[l]);return u}(r,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(n){e=n,this.sort&&e.sort()},this.addOption=function(n){n=(n=n||"").toString(),e.push(n),this.sort&&e.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();e.indexOf(n)!==-1&&(e.splice(e.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,18)},set:function(n){n?this.Ff=sr(this.Ff,18):this.Ff=ar(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=sr(this.Ff,19):this.Ff=ar(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,20)},set:function(n){n?(this.Ff=sr(this.Ff,20),e.sort()):this.Ff=ar(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,22)},set:function(n){n?this.Ff=sr(this.Ff,22):this.Ff=ar(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,23)},set:function(n){n?this.Ff=sr(this.Ff,23):this.Ff=ar(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,27)},set:function(n){n?this.Ff=sr(this.Ff,27):this.Ff=ar(this.Ff,27)}}),this.hasAppearanceStream=!1};Ci(au,Fs);var ou=function(){au.call(this),this.fontName="helvetica",this.combo=!1};Ci(ou,au);var lu=function(){ou.call(this),this.combo=!0};Ci(lu,ou);var sp=function(){lu.call(this),this.edit=!0};Ci(sp,lu);var Er=function(){Fs.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,15)},set:function(n){n?this.Ff=sr(this.Ff,15):this.Ff=ar(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,16)},set:function(n){n?this.Ff=sr(this.Ff,16):this.Ff=ar(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,17)},set:function(n){n?this.Ff=sr(this.Ff,17):this.Ff=ar(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,26)},set:function(n){n?this.Ff=sr(this.Ff,26):this.Ff=ar(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(s){return s};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,i=[];for(r in i.push("<<"),e)i.push("/"+r+" ("+xc(n(e[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(n){dn(n)==="object"&&(e=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(n){typeof n=="string"&&(e.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+n}})};Ci(Er,Fs);var ap=function(){Er.call(this),this.pushButton=!0};Ci(ap,Er);var cu=function(){Er.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Ci(cu,Er);var am=function(){var t,e;Fs.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,a=[];for(s in a.push("<<"),r)a.push("/"+s+" ("+xc(i(r[s]))+")");return a.push(">>"),a.join(`
`)},set:function(i){dn(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(i){n=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(i){n="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Ke.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ci(am,Fs),cu.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},cu.prototype.createOption=function(t){var e=new am;return e.Parent=this,e.optionName=t,this.Kids.push(e),ED.call(this.scope,e),e};var op=function(){Er.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Ke.CheckBox.createAppearanceStream()};Ci(op,Er);var Zl=function(){Fs.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,13)},set:function(e){e?this.Ff=sr(this.Ff,13):this.Ff=ar(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,21)},set:function(e){e?this.Ff=sr(this.Ff,21):this.Ff=ar(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,23)},set:function(e){e?this.Ff=sr(this.Ff,23):this.Ff=ar(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,24)},set:function(e){e?this.Ff=sr(this.Ff,24):this.Ff=ar(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,25)},set:function(e){e?this.Ff=sr(this.Ff,25):this.Ff=ar(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,26)},set:function(e){e?this.Ff=sr(this.Ff,26):this.Ff=ar(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ci(Zl,Fs);var lp=function(){Zl.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!ir(this.Ff,14)},set:function(t){t?this.Ff=sr(this.Ff,14):this.Ff=ar(this.Ff,14)}}),this.password=!0};Ci(lp,Zl);var Ke={CheckBox:{createAppearanceStream:function(){return{N:{On:Ke.CheckBox.YesNormal},D:{On:Ke.CheckBox.YesPushDown,Off:Ke.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=ia(t);e.scope=t.scope;var n=[],r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),s=G1(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+Ct(Ke.internal.getWidth(t))+" "+Ct(Ke.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+Ct(s.fontSize)+" Tf "+i),n.push("BT"),n.push(s.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(t){var e=ia(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),i=[],s=Ke.internal.getHeight(t),a=Ke.internal.getWidth(t),l=G1(t,t.caption);return i.push("1 g"),i.push("0 0 "+Ct(a)+" "+Ct(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Ct(a-1)+" "+Ct(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+n+" "+Ct(l.fontSize)+" Tf "+r),i.push(l.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=ia(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Ct(Ke.internal.getWidth(t))+" "+Ct(Ke.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Ke.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Ke.RadioButton.Circle.YesNormal,e.D[t]=Ke.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=ia(t);e.scope=t.scope;var n=[],r=Ke.internal.getWidth(t)<=Ke.internal.getHeight(t)?Ke.internal.getWidth(t)/4:Ke.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Ke.internal.Bezier_C,s=Number((r*i).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Oo(Ke.internal.getWidth(t)/2)+" "+Oo(Ke.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),n.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),n.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),n.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=ia(t);e.scope=t.scope;var n=[],r=Ke.internal.getWidth(t)<=Ke.internal.getHeight(t)?Ke.internal.getWidth(t)/4:Ke.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Ke.internal.Bezier_C).toFixed(5)),a=Number((r*Ke.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Oo(Ke.internal.getWidth(t)/2)+" "+Oo(Ke.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Oo(Ke.internal.getWidth(t)/2)+" "+Oo(Ke.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),n.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),n.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),n.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=ia(t);e.scope=t.scope;var n=[],r=Ke.internal.getWidth(t)<=Ke.internal.getHeight(t)?Ke.internal.getWidth(t)/4:Ke.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Ke.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Oo(Ke.internal.getWidth(t)/2)+" "+Oo(Ke.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Ke.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Ke.RadioButton.Cross.YesNormal,e.D[t]=Ke.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=ia(t);e.scope=t.scope;var n=[],r=Ke.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+Ct(Ke.internal.getWidth(t)-2)+" "+Ct(Ke.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(Ct(r.x1.x)+" "+Ct(r.x1.y)+" m"),n.push(Ct(r.x2.x)+" "+Ct(r.x2.y)+" l"),n.push(Ct(r.x4.x)+" "+Ct(r.x4.y)+" m"),n.push(Ct(r.x3.x)+" "+Ct(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=ia(t);e.scope=t.scope;var n=Ke.internal.calculateCross(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+Ct(Ke.internal.getWidth(t))+" "+Ct(Ke.internal.getHeight(t))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+Ct(Ke.internal.getWidth(t)-2)+" "+Ct(Ke.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Ct(n.x1.x)+" "+Ct(n.x1.y)+" m"),r.push(Ct(n.x2.x)+" "+Ct(n.x2.y)+" l"),r.push(Ct(n.x4.x)+" "+Ct(n.x4.y)+" m"),r.push(Ct(n.x3.x)+" "+Ct(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=ia(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Ct(Ke.internal.getWidth(t))+" "+Ct(Ke.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};Ke.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Ke.internal.getWidth(t),n=Ke.internal.getHeight(t),r=Math.min(e,n);return{x1:{x:(e-r)/2,y:(n-r)/2+r},x2:{x:(e-r)/2+r,y:(n-r)/2},x3:{x:(e-r)/2,y:(n-r)/2},x4:{x:(e-r)/2+r,y:(n-r)/2+r}}}},Ke.internal.getWidth=function(t){var e=0;return dn(t)==="object"&&(e=nw(t.Rect[2])),e},Ke.internal.getHeight=function(t){var e=0;return dn(t)==="object"&&(e=nw(t.Rect[3])),e};var ED=Kn.addField=function(t){if(SD(this,t),!(t instanceof Fs))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Kn.AcroFormChoiceField=au,Kn.AcroFormListBox=ou,Kn.AcroFormComboBox=lu,Kn.AcroFormEditBox=sp,Kn.AcroFormButton=Er,Kn.AcroFormPushButton=ap,Kn.AcroFormRadioButton=cu,Kn.AcroFormCheckBox=op,Kn.AcroFormTextField=Zl,Kn.AcroFormPasswordField=lp,Kn.AcroFormAppearance=Ke,Kn.AcroForm={ChoiceField:au,ListBox:ou,ComboBox:lu,EditBox:sp,Button:Er,PushButton:ap,RadioButton:cu,CheckBox:op,TextField:Zl,PasswordField:lp,Appearance:Ke},st.AcroForm={ChoiceField:au,ListBox:ou,ComboBox:lu,EditBox:sp,Button:Er,PushButton:ap,RadioButton:cu,CheckBox:op,TextField:Zl,PasswordField:lp,Appearance:Ke};st.AcroForm;function qA(t){return t.reduce(function(e,n,r){return e[n]=r,e},{})}(function(t){var e="addImage_";t.__addimage__={};var n="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=t.__addimage__.getImageFileTypeByImageData=function(N,w){var k,H,D,W,K,q=n;if((w=w||n)==="RGBA"||N.data!==void 0&&N.data instanceof Uint8ClampedArray&&"height"in N&&"width"in N)return"RGBA";if(ae(N))for(K in r)for(D=r[K],k=0;k<D.length;k+=1){for(W=!0,H=0;H<D[k].length;H+=1)if(D[k][H]!==void 0&&D[k][H]!==N[H]){W=!1;break}if(W===!0){q=K;break}}else for(K in r)for(D=r[K],k=0;k<D.length;k+=1){for(W=!0,H=0;H<D[k].length;H+=1)if(D[k][H]!==void 0&&D[k][H]!==N.charCodeAt(H)){W=!1;break}if(W===!0){q=K;break}}return q===n&&w!==n&&(q=w),q},s=function N(w){for(var k=this.internal.write,H=this.internal.putStream,D=(0,this.internal.getFilters)();D.indexOf("FlateEncode")!==-1;)D.splice(D.indexOf("FlateEncode"),1);w.objectId=this.internal.newObject();var W=[];if(W.push({key:"Type",value:"/XObject"}),W.push({key:"Subtype",value:"/Image"}),W.push({key:"Width",value:w.width}),W.push({key:"Height",value:w.height}),w.colorSpace===A.INDEXED?W.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(w.palette.length/3-1)+" "+("sMask"in w&&w.sMask!==void 0?w.objectId+2:w.objectId+1)+" 0 R]"}):(W.push({key:"ColorSpace",value:"/"+w.colorSpace}),w.colorSpace===A.DEVICE_CMYK&&W.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),W.push({key:"BitsPerComponent",value:w.bitsPerComponent}),"decodeParameters"in w&&w.decodeParameters!==void 0&&W.push({key:"DecodeParms",value:"<<"+w.decodeParameters+">>"}),"transparency"in w&&Array.isArray(w.transparency)&&w.transparency.length>0){for(var K="",q=0,ee=w.transparency.length;q<ee;q++)K+=w.transparency[q]+" "+w.transparency[q]+" ";W.push({key:"Mask",value:"["+K+"]"})}w.sMask!==void 0&&W.push({key:"SMask",value:w.objectId+1+" 0 R"});var ue=w.filter!==void 0?["/"+w.filter]:void 0;if(H({data:w.data,additionalKeyValues:W,alreadyAppliedFilters:ue,objectId:w.objectId}),k("endobj"),"sMask"in w&&w.sMask!==void 0){var ce,_=(ce=w.sMaskBitsPerComponent)!==null&&ce!==void 0?ce:w.bitsPerComponent,z={width:w.width,height:w.height,colorSpace:"DeviceGray",bitsPerComponent:_,data:w.sMask};"filter"in w&&(z.decodeParameters="/Predictor ".concat(w.predictor," /Colors 1 /BitsPerComponent ").concat(_," /Columns ").concat(w.width),z.filter=w.filter),N.call(this,z)}if(w.colorSpace===A.INDEXED){var O=this.internal.newObject();H({data:I(new Uint8Array(w.palette)),objectId:O}),k("endobj")}},a=function(){var N=this.internal.collections[e+"images"];for(var w in N)s.call(this,N[w])},l=function(){var N,w=this.internal.collections[e+"images"],k=this.internal.write;for(var H in w)k("/I"+(N=w[H]).index,N.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var N=this.internal.collections[e+"images"];return c.call(this),N},f=function(){return Object.keys(this.internal.collections[e+"images"]).length},g=function(N){return typeof t["process"+N.toUpperCase()]=="function"},y=function(N){return dn(N)==="object"&&N.nodeType===1},p=function(N,w){if(N.nodeName==="IMG"&&N.hasAttribute("src")){var k=""+N.getAttribute("src");if(k.indexOf("data:image/")===0)return ip(unescape(k).split("base64,").pop());var H=t.loadFile(k,!0);if(H!==void 0)return H}if(N.nodeName==="CANVAS"){if(N.width===0||N.height===0)throw new Error("Given canvas must have data. Canvas width: "+N.width+", height: "+N.height);var D;switch(w){case"PNG":D="image/png";break;case"WEBP":D="image/webp";break;default:D="image/jpeg"}return ip(N.toDataURL(D,1).split("base64,").pop())}},T=function(N){var w=this.internal.collections[e+"images"];if(w){for(var k in w)if(N===w[k].alias)return w[k]}},E=function(N,w,k){return N||w||(N=-96,w=-96),N<0&&(N=-1*k.width*72/N/this.internal.scaleFactor),w<0&&(w=-1*k.height*72/w/this.internal.scaleFactor),N===0&&(N=w*k.width/k.height),w===0&&(w=N*k.height/k.width),[N,w]},P=function(N,w,k,H,D,W){var K=E.call(this,k,H,D),q=this.internal.getCoordinateString,ee=this.internal.getVerticalCoordinateString,ue=u.call(this);if(k=K[0],H=K[1],ue[D.index]=D,W){W*=Math.PI/180;var ce=Math.cos(W),_=Math.sin(W),z=function(X){return X.toFixed(4)},O=[z(ce),z(_),z(-1*_),z(ce),0,0,"cm"]}this.internal.write("q"),W?(this.internal.write([1,"0","0",1,q(N),ee(w+H),"cm"].join(" ")),this.internal.write(O.join(" ")),this.internal.write([q(k),"0","0",q(H),"0","0","cm"].join(" "))):this.internal.write([q(k),"0","0",q(H),q(N),ee(w+H),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+D.index+" Do"),this.internal.write("Q")},A=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var L=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},M=t.__addimage__.sHashCode=function(N){var w,k,H=0;if(typeof N=="string")for(k=N.length,w=0;w<k;w++)H=(H<<5)-H+N.charCodeAt(w),H|=0;else if(ae(N))for(k=N.byteLength/2,w=0;w<k;w++)H=(H<<5)-H+N[w],H|=0;return H},F=t.__addimage__.validateStringAsBase64=function(N){(N=N||"").toString().trim();var w=!0;return N.length===0&&(w=!1),N.length%4!=0&&(w=!1),/^[A-Za-z0-9+/]+$/.test(N.substr(0,N.length-2))===!1&&(w=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(N.substr(-2))===!1&&(w=!1),w},te=t.__addimage__.extractImageFromDataUrl=function(N){if(N==null||!(N=N.trim()).startsWith("data:"))return null;var w=N.indexOf(",");return w<0?null:N.substring(0,w).trim().endsWith("base64")?N.substring(w+1):null};t.__addimage__.isArrayBuffer=function(N){return N instanceof ArrayBuffer};var ae=t.__addimage__.isArrayBufferView=function(N){return N instanceof Int8Array||N instanceof Uint8Array||N instanceof Uint8ClampedArray||N instanceof Int16Array||N instanceof Uint16Array||N instanceof Int32Array||N instanceof Uint32Array||N instanceof Float32Array||N instanceof Float64Array},B=t.__addimage__.binaryStringToUint8Array=function(N){for(var w=N.length,k=new Uint8Array(w),H=0;H<w;H++)k[H]=N.charCodeAt(H);return k},I=t.__addimage__.arrayBufferToBinaryString=function(N){for(var w="",k=ae(N)?N:new Uint8Array(N),H=0;H<k.length;H+=8192)w+=String.fromCharCode.apply(null,k.subarray(H,H+8192));return w};t.addImage=function(){var N,w,k,H,D,W,K,q,ee;if(typeof arguments[1]=="number"?(w=n,k=arguments[1],H=arguments[2],D=arguments[3],W=arguments[4],K=arguments[5],q=arguments[6],ee=arguments[7]):(w=arguments[1],k=arguments[2],H=arguments[3],D=arguments[4],W=arguments[5],K=arguments[6],q=arguments[7],ee=arguments[8]),dn(N=arguments[0])==="object"&&!y(N)&&"imageData"in N){var ue=N;N=ue.imageData,w=ue.format||w||n,k=ue.x||k||0,H=ue.y||H||0,D=ue.w||ue.width||D,W=ue.h||ue.height||W,K=ue.alias||K,q=ue.compression||q,ee=ue.rotation||ue.angle||ee}var ce=this.internal.getFilters();if(q===void 0&&ce.indexOf("FlateEncode")!==-1&&(q="SLOW"),isNaN(k)||isNaN(H))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var _=j.call(this,N,w,K,q);return P.call(this,k,H,D,W,_,ee),this};var j=function(N,w,k,H){var D,W,K;if(typeof N=="string"&&i(N)===n){N=unescape(N);var q=S(N,!1);(q!==""||(q=t.loadFile(N,!0))!==void 0)&&(N=q)}if(y(N)&&(N=p(N,w)),w=i(N,w),!g(w))throw new Error("addImage does not support files of type '"+w+"', please ensure that a plugin for '"+w+"' support is added.");if(((K=k)==null||K.length===0)&&(k=function(ee){return typeof ee=="string"||ae(ee)?M(ee):ae(ee.data)?M(ee.data):null}(N)),(D=T.call(this,k))||(N instanceof Uint8Array||w==="RGBA"||(W=N,N=B(N)),D=this["process"+w.toUpperCase()](N,f.call(this),k,function(ee){return ee&&typeof ee=="string"&&(ee=ee.toUpperCase()),ee in t.image_compression?ee:L.NONE}(H),W)),!D)throw new Error("An unknown error occurred whilst processing the image.");return D},S=t.__addimage__.convertBase64ToBinaryString=function(N,w){w=typeof w!="boolean"||w;var k,H="";if(typeof N=="string"){var D;k=(D=te(N))!==null&&D!==void 0?D:N;try{H=ip(k)}catch(W){if(w)throw F(k)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+W.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return H};t.getImageProperties=function(N){var w,k,H="";if(y(N)&&(N=p(N)),typeof N=="string"&&i(N)===n&&((H=S(N,!1))===""&&(H=t.loadFile(N)||""),N=H),k=i(N),!g(k))throw new Error("addImage does not support files of type '"+k+"', please ensure that a plugin for '"+k+"' support is added.");if(N instanceof Uint8Array||(N=B(N)),!(w=this["process"+k.toUpperCase()](N)))throw new Error("An unknown error occurred whilst processing the image");return w.fileType=k,w}})(st.API),function(t){var e=function(n){if(n!==void 0&&n!="")return!0};st.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(n){for(var r,i,s,a=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(n.objId),u=n.pageContext.annotations,f=!1,g=0;g<u.length&&!f;g++)switch((r=u[g]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var y=0;y<u.length;y++){r=u[y];var p=this.internal.pdfEscape,T=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var E=this.internal.newAdditionalObject(),P=this.internal.newAdditionalObject(),A=this.internal.getEncryptor(E.objId),L=r.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+a(r.bounds.x)+" "+l(r.bounds.y+r.bounds.h)+" "+a(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y)+"] ")+"/Contents ("+p(A(r.contents))+")",s+=" /Popup "+P.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+p(A(L))+") >>",E.content=s;var M=E.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+a(r.bounds.x+30)+" "+l(r.bounds.y+r.bounds.h)+" "+a(r.bounds.x+r.bounds.w+30)+" "+l(r.bounds.y)+"] ")+" /Parent "+M,r.open&&(s+=" /Open true"),s+=" >>",P.content=s,this.internal.write(E.objId,"0 R",P.objId,"0 R");break;case"freetext":i="/Rect ["+a(r.bounds.x)+" "+l(r.bounds.y)+" "+a(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y+r.bounds.h)+"] ";var F=r.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+p(T(r.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+F+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(r.options.name){var te=this.annotations._nameMap[r.options.name];r.options.pageNumber=te.page,r.options.top=te.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",s="",r.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+p(T(r.options.url))+") >>";else if(r.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,s+=" /FitV "+r.options.left+"]";break;default:var ae=l(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),s+=" /XYZ "+r.options.left+" "+ae+" "+r.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},t.link=function(n,r,i,s,a){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(n),y:u(r),w:c(n+i),h:u(r+s)},options:a,type:"link"})},t.textWithLink=function(n,r,i,s){var a,l,c=this.getTextWidth(n),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var f=this.splitTextToSize(n,l).length;a=Math.ceil(u*f)}else l=c,a=u;return this.text(n,r,i,s),i+=.2*u,s.align==="center"&&(r-=c/2),s.align==="right"&&(r-=c),this.link(r,i-u,l,a,s),c},t.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}}(st.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(E){return e[E.charCodeAt(0)]!==void 0},a=t.__arabicParser__.isArabicLetter=function(E){return typeof E=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(E)},l=t.__arabicParser__.isArabicEndLetter=function(E){return a(E)&&s(E)&&e[E.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(E){return a(E)&&i.indexOf(E.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(E){return a(E)&&s(E)&&e[E.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(E){return a(E)&&s(E)&&e[E.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(E){return a(E)&&s(E)&&e[E.charCodeAt(0)].length>=3};var f=t.__arabicParser__.arabicLetterHasMedialForm=function(E){return a(E)&&s(E)&&e[E.charCodeAt(0)].length==4},g=t.__arabicParser__.resolveLigatures=function(E){var P=0,A=n,L="",M=0;for(P=0;P<E.length;P+=1)A[E.charCodeAt(P)]!==void 0?(M++,typeof(A=A[E.charCodeAt(P)])=="number"&&(L+=String.fromCharCode(A),A=n,M=0),P===E.length-1&&(A=n,L+=E.charAt(P-(M-1)),P-=M-1,M=0)):(A=n,L+=E.charAt(P-M),P-=M,M=0);return L};t.__arabicParser__.isArabicDiacritic=function(E){return E!==void 0&&r[E.charCodeAt(0)]!==void 0};var y=t.__arabicParser__.getCorrectForm=function(E,P,A){return a(E)?s(E)===!1?-1:!u(E)||!a(P)&&!a(A)||!a(A)&&l(P)||l(E)&&!a(P)||l(E)&&c(P)||l(E)&&l(P)?0:f(E)&&a(P)&&!l(P)&&a(A)&&u(A)?3:l(E)||!a(A)?1:2:-1},p=function(E){var P=0,A=0,L=0,M="",F="",te="",ae=(E=E||"").split("\\s+"),B=[];for(P=0;P<ae.length;P+=1){for(B.push(""),A=0;A<ae[P].length;A+=1)M=ae[P][A],F=ae[P][A-1],te=ae[P][A+1],a(M)?(L=y(M,F,te),B[P]+=L!==-1?String.fromCharCode(e[M.charCodeAt(0)][L]):M):B[P]+=M;B[P]=g(B[P])}return B.join(" ")},T=t.__arabicParser__.processArabic=t.processArabic=function(){var E,P=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,A=[];if(Array.isArray(P)){var L=0;for(A=[],L=0;L<P.length;L+=1)Array.isArray(P[L])?A.push([p(P[L][0]),P[L][1],P[L][2]]):A.push([p(P[L])]);E=A}else E=p(P);return typeof arguments[0]=="string"?E:(arguments[0].text=E,arguments[0])};t.events.push(["preProcessText",T])}(st.API),st.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(t){var e=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(l){n=l}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(l){r=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(l){a=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(n,r){var i;if((n=n||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(st.API),function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(E){c=E}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(E){u=E}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(E){f=E}});var g=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return g},set:function(E){g=E}});var y=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return y},set:function(E){y=E}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(E){p=E}});var T=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return T},set:function(E){T=E}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return r.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){r.call(this);var f=(u=u||{}).fontSize||this.getFontSize(),g=u.font||this.getFont(),y=u.scaleFactor||this.internal.scaleFactor,p=0,T=0,E=0,P=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var A=u.maxWidth;A>0?typeof c=="string"?c=this.splitTextToSize(c,A):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(M,F){return M.concat(P.splitTextToSize(F,A))},[])):c=Array.isArray(c)?c:[c];for(var L=0;L<c.length;L++)p<(E=this.getStringUnitWidth(c[L],{font:g})*f)&&(p=E);return p!==0&&(T=c.length),{w:p/=y,h:Math.max((T*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/y,0)}},t.cellAddPage=function(){r.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=t.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var u=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,g=this.internal.__cell__.margins||e,y=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+g.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=g.top,p&&y&&(this.printHeaderRow(c.lineNumber,!0),c.y+=y[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,n===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-f,c.y+f,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+f,{align:"center",baseline:"top",maxWidth:c.width-f-f}):this.text(c.text,c.x+f,c.y+f,{align:"left",baseline:"top",maxWidth:c.width-f-f})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,f,g,y){if(r.call(this),!f)throw new Error("No data for PDF table.");var p,T,E,P,A=[],L=[],M=[],F={},te={},ae=[],B=[],I=(y=y||{}).autoSize||!1,j=y.printHeaders!==!1,S=y.css&&y.css["font-size"]!==void 0?16*y.css["font-size"]:y.fontSize||12,N=y.margins||Object.assign({width:this.getPageWidth()},e),w=typeof y.padding=="number"?y.padding:3,k=y.headerBackgroundColor||"#c8c8c8",H=y.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=j,this.internal.__cell__.margins=N,this.internal.__cell__.table_font_size=S,this.internal.__cell__.padding=w,this.internal.__cell__.headerBackgroundColor=k,this.internal.__cell__.headerTextColor=H,this.setFontSize(S),g==null)L=A=Object.keys(f[0]),M=A.map(function(){return"left"});else if(Array.isArray(g)&&dn(g[0])==="object")for(A=g.map(function(ue){return ue.name}),L=g.map(function(ue){return ue.prompt||ue.name||""}),M=g.map(function(ue){return ue.align||"left"}),p=0;p<g.length;p+=1)te[g[p].name]=.7499990551181103*g[p].width;else Array.isArray(g)&&typeof g[0]=="string"&&(L=A=g,M=A.map(function(){return"left"}));if(I||Array.isArray(g)&&typeof g[0]=="string")for(p=0;p<A.length;p+=1){for(F[P=A[p]]=f.map(function(ue){return ue[P]}),this.setFont(void 0,"bold"),ae.push(this.getTextDimensions(L[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),T=F[P],this.setFont(void 0,"normal"),E=0;E<T.length;E+=1)ae.push(this.getTextDimensions(T[E],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);te[P]=Math.max.apply(null,ae)+w+w,ae=[]}if(j){var D={};for(p=0;p<A.length;p+=1)D[A[p]]={},D[A[p]].text=L[p],D[A[p]].align=M[p];var W=l.call(this,D,te);B=A.map(function(ue){return new s(c,u,te[ue],W,D[ue].text,void 0,D[ue].align)}),this.setTableHeaderRow(B),this.printHeaderRow(1,!1)}var K=g.reduce(function(ue,ce){return ue[ce.name]=ce.align,ue},{});for(p=0;p<f.length;p+=1){"rowStart"in y&&y.rowStart instanceof Function&&y.rowStart({row:p,data:f[p]},this);var q=l.call(this,f[p],te);for(E=0;E<A.length;E+=1){var ee=f[p][A[E]];"cellStart"in y&&y.cellStart instanceof Function&&y.cellStart({row:p,col:E,data:ee},this),a.call(this,new s(c,u,te[A[E]],q,ee,p+2,K[A[E]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var f=this.internal.__cell__.padding,g=this.internal.__cell__.table_font_size,y=this.internal.scaleFactor;return Object.keys(c).map(function(p){var T=c[p];return this.splitTextToSize(T.hasOwnProperty("text")?T.text:T,u[p]-f-f)},this).map(function(p){return this.getLineHeightFactor()*p.length*g/y+f+f},this).reduce(function(p,T){return Math.max(p,T)},0)};t.setTableHeaderRow=function(c){r.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var g=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(g[0],g[1],g[2],g[3],void 0,-1)}this.setFont(void 0,"bold");for(var y=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){f=this.internal.__cell__.tableHeaderRow[p].clone(),u&&(f.y=this.internal.__cell__.margins.top||0,y.push(f)),f.lineNumber=c;var T=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,f),this.setTextColor(T)}y.length>0&&this.setTableHeaderRow(y),this.setFont(void 0,"normal"),n=!1}}(st.API);var zA={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},$A=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],K1=qA($A),HA=[100,200,300,400,500,600,700,800,900],TD=qA(HA);function g0(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=function(s){return zA[s=s||"normal"]?s:"normal"}(t.style),r=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(t.weight),i=function(s){return typeof K1[s=s||"normal"]=="number"?s:"normal"}(t.stretch);return{family:e,style:n,weight:r,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,n,r].join(" ")}}}function rw(t,e,n,r){var i;for(i=n;i>=0&&i<e.length;i+=r)if(t[e[i]])return t[e[i]];for(i=n;i>=0&&i<e.length;i-=r)if(t[e[i]])return t[e[i]]}var CD={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},iw={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function sw(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function aw(t){return t.trimLeft()}function kD(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function ID(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Lf,ow,lw,kc,Rf,cw,uw,dw,v0=["times"];function hw(t,e,n,r,i){var s=4,a=pw;switch(i){case st.API.image_compression.FAST:s=1,a=fw;break;case st.API.image_compression.MEDIUM:s=6,a=mw;break;case st.API.image_compression.SLOW:s=9,a=gw}t=function(c,u,f,g){for(var y,p=c.length/u,T=new Uint8Array(c.length+p),E=[jD,fw,pw,mw,gw],P=0;P<p;P+=1){var A=P*u,L=c.subarray(A,A+u);if(g)T.set(g(L,f,y),A+P);else{for(var M=E.length,F=[],te=0;te<M;te+=1)F[te]=E[te](L,f,y);var ae=LD(F.concat());T.set(F[ae],A+P)}y=L}return T}(t,e,Math.ceil(n*r/8),a);var l=B1(t,{level:s});return st.API.__addimage__.arrayBufferToBinaryString(l)}function jD(t){var e=Array.apply([],t);return e.unshift(0),e}function fw(t,e){var n=t.length,r=[];r[0]=1;for(var i=0;i<n;i+=1){var s=t[i-e]||0;r[i+1]=t[i]-s+256&255}return r}function pw(t,e,n){var r=t.length,i=[];i[0]=2;for(var s=0;s<r;s+=1){var a=n&&n[s]||0;i[s+1]=t[s]-a+256&255}return i}function mw(t,e,n){var r=t.length,i=[];i[0]=3;for(var s=0;s<r;s+=1){var a=t[s-e]||0,l=n&&n[s]||0;i[s+1]=t[s]+256-(a+l>>>1)&255}return i}function gw(t,e,n){var r=t.length,i=[];i[0]=4;for(var s=0;s<r;s+=1){var a=PD(t[s-e]||0,n&&n[s]||0,n&&n[s-e]||0);i[s+1]=t[s]-a+256&255}return i}function PD(t,e,n){if(t===e&&e===n)return t;var r=Math.abs(e-n),i=Math.abs(t-n),s=Math.abs(t+e-n-n);return r<=i&&r<=s?t:i<=s?e:n}function LD(t){var e=t.map(function(n){return n.reduce(function(r,i){return r+Math.abs(i)},0)});return e.indexOf(Math.min.apply(null,e))}function y0(t,e,n){var r=e*n,i=Math.floor(r/8),s=16-(r-8*i+n),a=(1<<n)-1;return WA(t,i)>>s&a}function vw(t,e,n,r){var i=n*r,s=Math.floor(i/8),a=16-(i-8*s+r),l=(1<<r)-1,c=(e&l)<<a;(function(u,f,g){if(f+1<u.byteLength)u.setUint16(f,g,!1);else{var y=g>>8&255;u.setUint8(f,y)}})(t,s,WA(t,s)&~(l<<a)&65535|c)}function WA(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function RD(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,r=t[e++]|t[e++]<<8,i=t[e++],s=i>>7,a=1<<1+(7&i);t[e++],t[e++];var l=null,c=null;s&&(l=e,c=a,e+=3*a);var u=!0,f=[],g=0,y=null,p=0,T=null;for(this.width=n,this.height=r;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,T=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((N=t[e++])>=0))throw Error("Invalid block size");if(N===0)break;e+=N}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var E=t[e++];g=t[e++]|t[e++]<<8,y=t[e++],1&E||(y=null),p=E>>2&7,e++;break;case 254:for(;;){if(!((N=t[e++])>=0))throw Error("Invalid block size");if(N===0)break;e+=N}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var P=t[e++]|t[e++]<<8,A=t[e++]|t[e++]<<8,L=t[e++]|t[e++]<<8,M=t[e++]|t[e++]<<8,F=t[e++],te=F>>6&1,ae=1<<1+(7&F),B=l,I=c,j=!1;F>>7&&(j=!0,B=e,I=ae,e+=3*ae);var S=e;for(e++;;){var N;if(!((N=t[e++])>=0))throw Error("Invalid block size");if(N===0)break;e+=N}f.push({x:P,y:A,width:L,height:M,has_local_palette:j,palette_offset:B,palette_size:I,data_offset:S,data_length:e-S,transparent_index:y,interlaced:!!te,delay:g,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return T},this.frameInfo=function(w){if(w<0||w>=f.length)throw new Error("Frame index out of range.");return f[w]},this.decodeAndBlitFrameBGRA=function(w,k){var H=this.frameInfo(w),D=H.width*H.height,W=new Uint8Array(D);yw(t,H.data_offset,W,D);var K=H.palette_offset,q=H.transparent_index;q===null&&(q=256);var ee=H.width,ue=n-ee,ce=ee,_=4*(H.y*n+H.x),z=4*((H.y+H.height)*n+H.x),O=_,X=4*ue;H.interlaced===!0&&(X+=4*n*7);for(var Z=8,le=0,me=W.length;le<me;++le){var ye=W[le];if(ce===0&&(ce=ee,(O+=X)>=z&&(X=4*ue+4*n*(Z-1),O=_+(ee+ue)*(Z<<1),Z>>=1)),ye===q)O+=4;else{var xe=t[K+3*ye],ke=t[K+3*ye+1],Ve=t[K+3*ye+2];k[O++]=Ve,k[O++]=ke,k[O++]=xe,k[O++]=255}--ce}},this.decodeAndBlitFrameRGBA=function(w,k){var H=this.frameInfo(w),D=H.width*H.height,W=new Uint8Array(D);yw(t,H.data_offset,W,D);var K=H.palette_offset,q=H.transparent_index;q===null&&(q=256);var ee=H.width,ue=n-ee,ce=ee,_=4*(H.y*n+H.x),z=4*((H.y+H.height)*n+H.x),O=_,X=4*ue;H.interlaced===!0&&(X+=4*n*7);for(var Z=8,le=0,me=W.length;le<me;++le){var ye=W[le];if(ce===0&&(ce=ee,(O+=X)>=z&&(X=4*ue+4*n*(Z-1),O=_+(ee+ue)*(Z<<1),Z>>=1)),ye===q)O+=4;else{var xe=t[K+3*ye],ke=t[K+3*ye+1],Ve=t[K+3*ye+2];k[O++]=xe,k[O++]=ke,k[O++]=Ve,k[O++]=255}--ce}}}function yw(t,e,n,r){for(var i=t[e++],s=1<<i,a=s+1,l=a+1,c=i+1,u=(1<<c)-1,f=0,g=0,y=0,p=t[e++],T=new Int32Array(4096),E=null;;){for(;f<16&&p!==0;)g|=t[e++]<<f,f+=8,p===1?p=t[e++]:--p;if(f<c)break;var P=g&u;if(g>>=c,f-=c,P!==s){if(P===a)break;for(var A=P<l?P:E,L=0,M=A;M>s;)M=T[M]>>8,++L;var F=M;if(y+L+(A!==P?1:0)>r)return void vn.log("Warning, gif stream longer than expected.");n[y++]=F;var te=y+=L;for(A!==P&&(n[y++]=F),M=A;L--;)M=T[M],n[--te]=255&M,M>>=8;E!==null&&l<4096&&(T[l++]=E<<8|F,l>=u+1&&c<12&&(++c,u=u<<1|1)),E=P}else l=a+1,u=(1<<(c=i+1))-1,E=null}return y!==r&&vn.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function x0(t){var e,n,r,i,s,a=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),f=new Array(64),g=new Array(65535),y=new Array(65535),p=new Array(64),T=new Array(64),E=[],P=0,A=7,L=new Array(64),M=new Array(64),F=new Array(64),te=new Array(256),ae=new Array(2048),B=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],I=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],j=[0,1,2,3,4,5,6,7,8,9,10,11],S=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],N=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],w=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],k=[0,1,2,3,4,5,6,7,8,9,10,11],H=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],D=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function W(_,z){for(var O=0,X=0,Z=new Array,le=1;le<=16;le++){for(var me=1;me<=_[le];me++)Z[z[X]]=[],Z[z[X]][0]=O,Z[z[X]][1]=le,X++,O++;O*=2}return Z}function K(_){for(var z=_[0],O=_[1]-1;O>=0;)z&1<<O&&(P|=1<<A),O--,--A<0&&(P==255?(q(255),q(0)):q(P),A=7,P=0)}function q(_){E.push(_)}function ee(_){q(_>>8&255),q(255&_)}function ue(_,z,O,X,Z){for(var le,me=Z[0],ye=Z[240],xe=function(De,je){var Ce,Et,nt,Bt,Nt,tt,Tt,xt,rt,ft,at=0;for(rt=0;rt<8;++rt){Ce=De[at],Et=De[at+1],nt=De[at+2],Bt=De[at+3],Nt=De[at+4],tt=De[at+5],Tt=De[at+6];var Jt=Ce+(xt=De[at+7]),Wt=Ce-xt,Je=Et+Tt,bt=Et-Tt,sn=nt+tt,dt=nt-tt,Rt=Bt+Nt,At=Bt-Nt,In=Jt+Rt,_n=Jt-Rt,en=Je+sn,pt=Je-sn;De[at]=In+en,De[at+4]=In-en;var Ot=.707106781*(pt+_n);De[at+2]=_n+Ot,De[at+6]=_n-Ot;var Us=.382683433*((In=At+dt)-(pt=bt+Wt)),Qn=.5411961*In+Us,Zi=1.306562965*pt+Us,Br=.707106781*(en=dt+bt),ut=Wt+Br,Nn=Wt-Br;De[at+5]=Nn+Qn,De[at+3]=Nn-Qn,De[at+1]=ut+Zi,De[at+7]=ut-Zi,at+=8}for(at=0,rt=0;rt<8;++rt){Ce=De[at],Et=De[at+8],nt=De[at+16],Bt=De[at+24],Nt=De[at+32],tt=De[at+40],Tt=De[at+48];var es=Ce+(xt=De[at+56]),br=Ce-xt,wr=Et+Tt,jn=Et-Tt,lr=nt+tt,Pn=nt-tt,Na=Bt+Nt,Bs=Bt-Nt,qr=es+Na,ki=es-Na,si=wr+lr,zr=wr-lr;De[at]=qr+si,De[at+32]=qr-si;var Xn=.707106781*(zr+ki);De[at+16]=ki+Xn,De[at+48]=ki-Xn;var qs=.382683433*((qr=Bs+Pn)-(zr=jn+br)),Ii=.5411961*qr+qs,vs=1.306562965*zr+qs,zs=.707106781*(si=Pn+jn),Aa=br+zs,Sa=br-zs;De[at+40]=Sa+Ii,De[at+24]=Sa-Ii,De[at+8]=Aa+vs,De[at+56]=Aa-vs,at++}for(rt=0;rt<64;++rt)ft=De[rt]*je[rt],p[rt]=ft>0?ft+.5|0:ft-.5|0;return p}(_,z),ke=0;ke<64;++ke)T[B[ke]]=xe[ke];var Ve=T[0]-O;O=T[0],Ve==0?K(X[0]):(K(X[y[le=32767+Ve]]),K(g[le]));for(var Ue=63;Ue>0&&T[Ue]==0;)Ue--;if(Ue==0)return K(me),O;for(var Ne,se=1;se<=Ue;){for(var yt=se;T[se]==0&&se<=Ue;)++se;var Ye=se-yt;if(Ye>=16){Ne=Ye>>4;for(var ot=1;ot<=Ne;++ot)K(ye);Ye&=15}le=32767+T[se],K(Z[(Ye<<4)+y[le]]),K(g[le]),se++}return Ue!=63&&K(me),O}function ce(_){_=Math.min(Math.max(_,1),100),s!=_&&(function(z){for(var O=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],X=0;X<64;X++){var Z=a((O[X]*z+50)/100);Z=Math.min(Math.max(Z,1),255),l[B[X]]=Z}for(var le=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],me=0;me<64;me++){var ye=a((le[me]*z+50)/100);ye=Math.min(Math.max(ye,1),255),c[B[me]]=ye}for(var xe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ke=0,Ve=0;Ve<8;Ve++)for(var Ue=0;Ue<8;Ue++)u[ke]=1/(l[B[ke]]*xe[Ve]*xe[Ue]*8),f[ke]=1/(c[B[ke]]*xe[Ve]*xe[Ue]*8),ke++}(_<50?Math.floor(5e3/_):Math.floor(200-2*_)),s=_)}this.encode=function(_,z){z&&ce(z),E=new Array,P=0,A=7,ee(65496),ee(65504),ee(16),q(74),q(70),q(73),q(70),q(0),q(1),q(1),q(0),ee(1),ee(1),q(0),q(0),function(){ee(65499),ee(132),q(0);for(var Et=0;Et<64;Et++)q(l[Et]);q(1);for(var nt=0;nt<64;nt++)q(c[nt])}(),function(Et,nt){ee(65472),ee(17),q(8),ee(nt),ee(Et),q(3),q(1),q(17),q(0),q(2),q(17),q(1),q(3),q(17),q(1)}(_.width,_.height),function(){ee(65476),ee(418),q(0);for(var Et=0;Et<16;Et++)q(I[Et+1]);for(var nt=0;nt<=11;nt++)q(j[nt]);q(16);for(var Bt=0;Bt<16;Bt++)q(S[Bt+1]);for(var Nt=0;Nt<=161;Nt++)q(N[Nt]);q(1);for(var tt=0;tt<16;tt++)q(w[tt+1]);for(var Tt=0;Tt<=11;Tt++)q(k[Tt]);q(17);for(var xt=0;xt<16;xt++)q(H[xt+1]);for(var rt=0;rt<=161;rt++)q(D[rt])}(),ee(65498),ee(12),q(3),q(1),q(0),q(2),q(17),q(3),q(17),q(0),q(63),q(0);var O=0,X=0,Z=0;P=0,A=7,this.encode.displayName="_encode_";for(var le,me,ye,xe,ke,Ve,Ue,Ne,se,yt=_.data,Ye=_.width,ot=_.height,De=4*Ye,je=0;je<ot;){for(le=0;le<De;){for(ke=De*je+le,Ue=-1,Ne=0,se=0;se<64;se++)Ve=ke+(Ne=se>>3)*De+(Ue=4*(7&se)),je+Ne>=ot&&(Ve-=De*(je+1+Ne-ot)),le+Ue>=De&&(Ve-=le+Ue-De+4),me=yt[Ve++],ye=yt[Ve++],xe=yt[Ve++],L[se]=(ae[me]+ae[ye+256|0]+ae[xe+512|0]>>16)-128,M[se]=(ae[me+768|0]+ae[ye+1024|0]+ae[xe+1280|0]>>16)-128,F[se]=(ae[me+1280|0]+ae[ye+1536|0]+ae[xe+1792|0]>>16)-128;O=ue(L,u,O,e,r),X=ue(M,f,X,n,i),Z=ue(F,f,Z,n,i),le+=32}je+=8}if(A>=0){var Ce=[];Ce[1]=A+1,Ce[0]=(1<<A+1)-1,K(Ce)}return ee(65497),new Uint8Array(E)},t=t||50,function(){for(var _=String.fromCharCode,z=0;z<256;z++)te[z]=_(z)}(),e=W(I,j),n=W(w,k),r=W(S,N),i=W(H,D),function(){for(var _=1,z=2,O=1;O<=15;O++){for(var X=_;X<z;X++)y[32767+X]=O,g[32767+X]=[],g[32767+X][1]=O,g[32767+X][0]=X;for(var Z=-(z-1);Z<=-_;Z++)y[32767+Z]=O,g[32767+Z]=[],g[32767+Z][1]=O,g[32767+Z][0]=z-1+Z;_<<=1,z<<=1}}(),function(){for(var _=0;_<256;_++)ae[_]=19595*_,ae[_+256|0]=38470*_,ae[_+512|0]=7471*_+32768,ae[_+768|0]=-11059*_,ae[_+1024|0]=-21709*_,ae[_+1280|0]=32768*_+8421375,ae[_+1536|0]=-27439*_,ae[_+1792|0]=-5329*_}(),ce(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ts(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function xw(t){function e(j){if(!j)throw Error("assert :P")}function n(j,S,N){for(var w=0;4>w;w++)if(j[S+w]!=N.charCodeAt(w))return!0;return!1}function r(j,S,N,w,k){for(var H=0;H<k;H++)j[S+H]=N[w+H]}function i(j,S,N,w){for(var k=0;k<w;k++)j[S+k]=N}function s(j){return new Int32Array(j)}function a(j,S){for(var N=[],w=0;w<j;w++)N.push(new S);return N}function l(j,S){var N=[];return function w(k,H,D){for(var W=D[H],K=0;K<W&&(k.push(D.length>H+1?[]:new S),!(D.length<H+1));K++)w(k[K],H+1,D)}(N,0,j),N}var c=function(){var j=this;function S(d,m){for(var x=1<<m-1>>>0;d&x;)x>>>=1;return x?(d&x-1)+x:d}function N(d,m,x,C,U){e(!(C%x));do d[m+(C-=x)]=U;while(0<C)}function w(d,m,x,C,U){if(e(2328>=U),512>=U)var $=s(512);else if(($=s(U))==null)return 0;return function(G,Y,J,re,de,we){var ie,he,ve=Y,Ae=1<<J,be=s(16),Ee=s(16);for(e(de!=0),e(re!=null),e(G!=null),e(0<J),he=0;he<de;++he){if(15<re[he])return 0;++be[re[he]]}if(be[0]==de)return 0;for(Ee[1]=0,ie=1;15>ie;++ie){if(be[ie]>1<<ie)return 0;Ee[ie+1]=Ee[ie]+be[ie]}for(he=0;he<de;++he)ie=re[he],0<re[he]&&(we[Ee[ie]++]=he);if(Ee[15]==1)return(re=new k).g=0,re.value=we[0],N(G,ve,1,Ae,re),Ae;var Te,Oe=-1,Le=Ae-1,it=0,Ge=1,Pt=1,Ze=1<<J;for(he=0,ie=1,de=2;ie<=J;++ie,de<<=1){if(Ge+=Pt<<=1,0>(Pt-=be[ie]))return 0;for(;0<be[ie];--be[ie])(re=new k).g=ie,re.value=we[he++],N(G,ve+it,de,Ze,re),it=S(it,ie)}for(ie=J+1,de=2;15>=ie;++ie,de<<=1){if(Ge+=Pt<<=1,0>(Pt-=be[ie]))return 0;for(;0<be[ie];--be[ie]){if(re=new k,(it&Le)!=Oe){for(ve+=Ze,Te=1<<(Oe=ie)-J;15>Oe&&!(0>=(Te-=be[Oe]));)++Oe,Te<<=1;Ae+=Ze=1<<(Te=Oe-J),G[Y+(Oe=it&Le)].g=Te+J,G[Y+Oe].value=ve-Y-Oe}re.g=ie-J,re.value=we[he++],N(G,ve+(it>>J),de,Ze,re),it=S(it,ie)}}return Ge!=2*Ee[15]-1?0:Ae}(d,m,x,C,U,$)}function k(){this.value=this.g=0}function H(){this.value=this.g=0}function D(){this.G=a(5,k),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(Rl,H)}function W(d,m,x,C){e(d!=null),e(m!=null),e(2147483648>C),d.Ca=254,d.I=0,d.b=-8,d.Ka=0,d.oa=m,d.pa=x,d.Jd=m,d.Yc=x+C,d.Zc=4<=C?x+C-4+1:x,me(d)}function K(d,m){for(var x=0;0<m--;)x|=xe(d,128)<<m;return x}function q(d,m){var x=K(d,m);return ye(d)?-x:x}function ee(d,m,x,C){var U,$=0;for(e(d!=null),e(m!=null),e(4294967288>C),d.Sb=C,d.Ra=0,d.u=0,d.h=0,4<C&&(C=4),U=0;U<C;++U)$+=m[x+U]<<8*U;d.Ra=$,d.bb=C,d.oa=m,d.pa=x}function ue(d){for(;8<=d.u&&d.bb<d.Sb;)d.Ra>>>=8,d.Ra+=d.oa[d.pa+d.bb]<<wo-8>>>0,++d.bb,d.u-=8;X(d)&&(d.h=1,d.u=0)}function ce(d,m){if(e(0<=m),!d.h&&m<=Oi){var x=O(d)&Di[m];return d.u+=m,ue(d),x}return d.h=1,d.u=0}function _(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function z(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function O(d){return d.Ra>>>(d.u&wo-1)>>>0}function X(d){return e(d.bb<=d.Sb),d.h||d.bb==d.Sb&&d.u>wo}function Z(d,m){d.u=m,d.h=X(d)}function le(d){d.u>=Pa&&(e(d.u>=Pa),ue(d))}function me(d){e(d!=null&&d.oa!=null),d.pa<d.Zc?(d.I=(d.oa[d.pa++]|d.I<<8)>>>0,d.b+=8):(e(d!=null&&d.oa!=null),d.pa<d.Yc?(d.b+=8,d.I=d.oa[d.pa++]|d.I<<8):d.Ka?d.b=0:(d.I<<=8,d.b+=8,d.Ka=1))}function ye(d){return K(d,1)}function xe(d,m){var x=d.Ca;0>d.b&&me(d);var C=d.b,U=x*m>>>8,$=(d.I>>>C>U)+0;for($?(x-=U,d.I-=U+1<<C>>>0):x=U+1,C=x,U=0;256<=C;)U+=8,C>>=8;return C=7^U+_o[C],d.b-=C,d.Ca=(x<<C)-1,$}function ke(d,m,x){d[m+0]=x>>24&255,d[m+1]=x>>16&255,d[m+2]=x>>8&255,d[m+3]=255&x}function Ve(d,m){return d[m+0]|d[m+1]<<8}function Ue(d,m){return Ve(d,m)|d[m+2]<<16}function Ne(d,m){return Ve(d,m)|Ve(d,m+2)<<16}function se(d,m){var x=1<<m;return e(d!=null),e(0<m),d.X=s(x),d.X==null?0:(d.Mb=32-m,d.Xa=m,1)}function yt(d,m){e(d!=null),e(m!=null),e(d.Xa==m.Xa),r(m.X,0,d.X,0,1<<m.Xa)}function Ye(){this.X=[],this.Xa=this.Mb=0}function ot(d,m,x,C){e(x!=null),e(C!=null);var U=x[0],$=C[0];return U==0&&(U=(d*$+m/2)/m),$==0&&($=(m*U+d/2)/d),0>=U||0>=$?0:(x[0]=U,C[0]=$,1)}function De(d,m){return d+(1<<m)-1>>>m}function je(d,m){return((4278255360&d)+(4278255360&m)>>>0&4278255360)+((16711935&d)+(16711935&m)>>>0&16711935)>>>0}function Ce(d,m){j[m]=function(x,C,U,$,G,Y,J){var re;for(re=0;re<G;++re){var de=j[d](Y[J+re-1],U,$+re);Y[J+re]=je(x[C+re],de)}}}function Et(){this.ud=this.hd=this.jd=0}function nt(d,m){return((4278124286&(d^m))>>>1)+(d&m)>>>0}function Bt(d){return 0<=d&&256>d?d:0>d?0:255<d?255:void 0}function Nt(d,m){return Bt(d+(d-m+.5>>1))}function tt(d,m,x){return Math.abs(m-x)-Math.abs(d-x)}function Tt(d,m,x,C,U,$,G){for(C=$[G-1],x=0;x<U;++x)$[G+x]=C=je(d[m+x],C)}function xt(d,m,x,C,U){var $;for($=0;$<x;++$){var G=d[m+$],Y=G>>8&255,J=16711935&(J=(J=16711935&G)+((Y<<16)+Y));C[U+$]=(4278255360&G)+J>>>0}}function rt(d,m){m.jd=255&d,m.hd=d>>8&255,m.ud=d>>16&255}function ft(d,m,x,C,U,$){var G;for(G=0;G<C;++G){var Y=m[x+G],J=Y>>>8,re=Y,de=255&(de=(de=Y>>>16)+((d.jd<<24>>24)*(J<<24>>24)>>>5));re=255&(re=(re+=(d.hd<<24>>24)*(J<<24>>24)>>>5)+((d.ud<<24>>24)*(de<<24>>24)>>>5)),U[$+G]=(4278255360&Y)+(de<<16)+re}}function at(d,m,x,C,U){j[m]=function($,G,Y,J,re,de,we,ie,he){for(J=we;J<ie;++J)for(we=0;we<he;++we)re[de++]=U(Y[C($[G++])])},j[d]=function($,G,Y,J,re,de,we){var ie=8>>$.b,he=$.Ea,ve=$.K[0],Ae=$.w;if(8>ie)for($=(1<<$.b)-1,Ae=(1<<ie)-1;G<Y;++G){var be,Ee=0;for(be=0;be<he;++be)be&$||(Ee=C(J[re++])),de[we++]=U(ve[Ee&Ae]),Ee>>=ie}else j["VP8LMapColor"+x](J,re,ve,Ae,de,we,G,Y,he)}}function Jt(d,m,x,C,U){for(x=m+x;m<x;){var $=d[m++];C[U++]=$>>16&255,C[U++]=$>>8&255,C[U++]=255&$}}function Wt(d,m,x,C,U){for(x=m+x;m<x;){var $=d[m++];C[U++]=$>>16&255,C[U++]=$>>8&255,C[U++]=255&$,C[U++]=$>>24&255}}function Je(d,m,x,C,U){for(x=m+x;m<x;){var $=(G=d[m++])>>16&240|G>>12&15,G=240&G|G>>28&15;C[U++]=$,C[U++]=G}}function bt(d,m,x,C,U){for(x=m+x;m<x;){var $=(G=d[m++])>>16&248|G>>13&7,G=G>>5&224|G>>3&31;C[U++]=$,C[U++]=G}}function sn(d,m,x,C,U){for(x=m+x;m<x;){var $=d[m++];C[U++]=255&$,C[U++]=$>>8&255,C[U++]=$>>16&255}}function dt(d,m,x,C,U,$){if($==0)for(x=m+x;m<x;)ke(C,(($=d[m++])[0]>>24|$[1]>>8&65280|$[2]<<8&16711680|$[3]<<24)>>>0),U+=32;else r(C,U,d,m,x)}function Rt(d,m){j[m][0]=j[d+"0"],j[m][1]=j[d+"1"],j[m][2]=j[d+"2"],j[m][3]=j[d+"3"],j[m][4]=j[d+"4"],j[m][5]=j[d+"5"],j[m][6]=j[d+"6"],j[m][7]=j[d+"7"],j[m][8]=j[d+"8"],j[m][9]=j[d+"9"],j[m][10]=j[d+"10"],j[m][11]=j[d+"11"],j[m][12]=j[d+"12"],j[m][13]=j[d+"13"],j[m][14]=j[d+"0"],j[m][15]=j[d+"0"]}function At(d){return d==eg||d==tg||d==Hh||d==ng}function In(){this.eb=[],this.size=this.A=this.fb=0}function _n(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function en(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new In,this.f.kb=new _n,this.sd=null}function pt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ot(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Us(d){return alert("todo:WebPSamplerProcessPlane"),d.T}function Qn(d,m){var x=d.T,C=m.ba.f.RGBA,U=C.eb,$=C.fb+d.ka*C.A,G=as[m.ba.S],Y=d.y,J=d.O,re=d.f,de=d.N,we=d.ea,ie=d.W,he=m.cc,ve=m.dc,Ae=m.Mc,be=m.Nc,Ee=d.ka,Te=d.ka+d.T,Oe=d.U,Le=Oe+1>>1;for(Ee==0?G(Y,J,null,null,re,de,we,ie,re,de,we,ie,U,$,null,null,Oe):(G(m.ec,m.fc,Y,J,he,ve,Ae,be,re,de,we,ie,U,$-C.A,U,$,Oe),++x);Ee+2<Te;Ee+=2)he=re,ve=de,Ae=we,be=ie,de+=d.Rc,ie+=d.Rc,$+=2*C.A,G(Y,(J+=2*d.fa)-d.fa,Y,J,he,ve,Ae,be,re,de,we,ie,U,$-C.A,U,$,Oe);return J+=d.fa,d.j+Te<d.o?(r(m.ec,m.fc,Y,J,Oe),r(m.cc,m.dc,re,de,Le),r(m.Mc,m.Nc,we,ie,Le),x--):1&Te||G(Y,J,null,null,re,de,we,ie,re,de,we,ie,U,$+C.A,null,null,Oe),x}function Zi(d,m,x){var C=d.F,U=[d.J];if(C!=null){var $=d.U,G=m.ba.S,Y=G==$h||G==Hh;m=m.ba.f.RGBA;var J=[0],re=d.ka;J[0]=d.T,d.Kb&&(re==0?--J[0]:(--re,U[0]-=d.width),d.j+d.ka+d.T==d.o&&(J[0]=d.o-d.j-re));var de=m.eb;re=m.fb+re*m.A,d=J2(C,U[0],d.width,$,J,de,re+(Y?0:3),m.A),e(x==J),d&&At(G)&&Xu(de,re,Y,$,J,m.A)}return 0}function Br(d){var m=d.ma,x=m.ba.S,C=11>x,U=x==qh||x==zh||x==$h||x==Zm||x==12||At(x);if(m.memory=null,m.Ib=null,m.Jb=null,m.Nd=null,!zu(m.Oa,d,U?11:12))return 0;if(U&&At(x)&&Ll(),d.da)alert("todo:use_scaling");else{if(C){if(m.Ib=Us,d.Kb){if(x=d.U+1>>1,m.memory=s(d.U+2*x),m.memory==null)return 0;m.ec=m.memory,m.fc=0,m.cc=m.ec,m.dc=m.fc+d.U,m.Mc=m.cc,m.Nc=m.dc+x,m.Ib=Qn,Ll()}}else alert("todo:EmitYUV");U&&(m.Jb=Zi,C&&yn())}if(C&&!py){for(d=0;256>d;++d)mS[d]=89858*(d-128)+Gh>>Wh,yS[d]=-22014*(d-128)+Gh,vS[d]=-45773*(d-128),gS[d]=113618*(d-128)+Gh>>Wh;for(d=Zu;d<sg;++d)m=76283*(d-16)+Gh>>Wh,xS[d-Zu]=Dt(m,255),bS[d-Zu]=Dt(m+8>>4,15);py=1}return 1}function ut(d){var m=d.ma,x=d.U,C=d.T;return e(!(1&d.ka)),0>=x||0>=C?0:(x=m.Ib(d,m),m.Jb!=null&&m.Jb(d,m,x),m.Dc+=x,1)}function Nn(d){d.ma.memory=null}function es(d,m,x,C){return ce(d,8)!=47?0:(m[0]=ce(d,14)+1,x[0]=ce(d,14)+1,C[0]=ce(d,1),ce(d,3)!=0?0:!d.h)}function br(d,m){if(4>d)return d+1;var x=d-2>>1;return(2+(1&d)<<x)+ce(m,x)+1}function wr(d,m){return 120<m?m-120:1<=(x=((x=tS[m-1])>>4)*d+(8-(15&x)))?x:1;var x}function jn(d,m,x){var C=O(x),U=d[m+=255&C].g-8;return 0<U&&(Z(x,x.u+8),C=O(x),m+=d[m].value,m+=C&(1<<U)-1),Z(x,x.u+d[m].g),d[m].value}function lr(d,m,x){return x.g+=d.g,x.value+=d.value<<m>>>0,e(8>=x.g),d.g}function Pn(d,m,x){var C=d.xc;return e((m=C==0?0:d.vc[d.md*(x>>C)+(m>>C)])<d.Wb),d.Ya[m]}function Na(d,m,x,C){var U=d.ab,$=d.c*m,G=d.C;m=G+m;var Y=x,J=C;for(C=d.Ta,x=d.Ua;0<U--;){var re=d.gc[U],de=G,we=m,ie=Y,he=J,ve=(J=C,Y=x,re.Ea);switch(e(de<we),e(we<=re.nc),re.hc){case 2:Jn(ie,he,(we-de)*ve,J,Y);break;case 0:var Ae=de,be=we,Ee=J,Te=Y,Oe=(Ze=re).Ea;Ae==0&&(Hu(ie,he,null,null,1,Ee,Te),Tt(ie,he+1,0,0,Oe-1,Ee,Te+1),he+=Oe,Te+=Oe,++Ae);for(var Le=1<<Ze.b,it=Le-1,Ge=De(Oe,Ze.b),Pt=Ze.K,Ze=Ze.w+(Ae>>Ze.b)*Ge;Ae<be;){var zt=Pt,pr=Ze,Lt=1;for(Nc(ie,he,Ee,Te-Oe,1,Ee,Te);Lt<Oe;){var et=(Lt&~it)+Le;et>Oe&&(et=Oe),(0,Gu[zt[pr++]>>8&15])(ie,he+ +Lt,Ee,Te+Lt-Oe,et-Lt,Ee,Te+Lt),Lt=et}he+=Oe,Te+=Oe,++Ae&it||(Ze+=Ge)}we!=re.nc&&r(J,Y-ve,J,Y+(we-de-1)*ve,ve);break;case 1:for(ve=ie,be=he,Oe=(ie=re.Ea)-(Te=ie&~(Ee=(he=1<<re.b)-1)),Ae=De(ie,re.b),Le=re.K,re=re.w+(de>>re.b)*Ae;de<we;){for(it=Le,Ge=re,Pt=new Et,Ze=be+Te,zt=be+ie;be<Ze;)rt(it[Ge++],Pt),Ku(Pt,ve,be,he,J,Y),be+=he,Y+=he;be<zt&&(rt(it[Ge++],Pt),Ku(Pt,ve,be,Oe,J,Y),be+=Oe,Y+=Oe),++de&Ee||(re+=Ae)}break;case 3:if(ie==J&&he==Y&&0<re.b){for(be=J,ie=ve=Y+(we-de)*ve-(Te=(we-de)*De(re.Ea,re.b)),he=J,Ee=Y,Ae=[],Te=(Oe=Te)-1;0<=Te;--Te)Ae[Te]=he[Ee+Te];for(Te=Oe-1;0<=Te;--Te)be[ie+Te]=Ae[Te];Fh(re,de,we,J,ve,J,Y)}else Fh(re,de,we,ie,he,J,Y)}Y=C,J=x}J!=x&&r(C,x,Y,J,$)}function Bs(d,m){var x=d.V,C=d.Ba+d.c*d.C,U=m-d.C;if(e(m<=d.l.o),e(16>=U),0<U){var $=d.l,G=d.Ta,Y=d.Ua,J=$.width;if(Na(d,U,x,C),U=Y=[Y],e((x=d.C)<(C=m)),e($.v<$.va),C>$.o&&(C=$.o),x<$.j){var re=$.j-x;x=$.j,U[0]+=re*J}if(x>=C?x=0:(U[0]+=4*$.v,$.ka=x-$.j,$.U=$.va-$.v,$.T=C-x,x=1),x){if(Y=Y[0],11>(x=d.ca).S){var de=x.f.RGBA,we=(C=x.S,U=$.U,$=$.T,re=de.eb,de.A),ie=$;for(de=de.fb+d.Ma*de.A;0<ie--;){var he=G,ve=Y,Ae=U,be=re,Ee=de;switch(C){case Bh:Yu(he,ve,Ae,be,Ee);break;case qh:No(he,ve,Ae,be,Ee);break;case eg:No(he,ve,Ae,be,Ee),Xu(be,Ee,0,Ae,1,0);break;case sy:Dl(he,ve,Ae,be,Ee);break;case zh:dt(he,ve,Ae,be,Ee,1);break;case tg:dt(he,ve,Ae,be,Ee,1),Xu(be,Ee,0,Ae,1,0);break;case $h:dt(he,ve,Ae,be,Ee,0);break;case Hh:dt(he,ve,Ae,be,Ee,0),Xu(be,Ee,1,Ae,1,0);break;case Zm:Ao(he,ve,Ae,be,Ee);break;case ng:Ao(he,ve,Ae,be,Ee),X2(be,Ee,Ae,1,0);break;case ay:So(he,ve,Ae,be,Ee);break;default:e(0)}Y+=J,de+=we}d.Ma+=$}else alert("todo:EmitRescaledRowsYUVA");e(d.Ma<=x.height)}}d.C=m,e(d.C<=d.i)}function qr(d){var m;if(0<d.ua)return 0;for(m=0;m<d.Wb;++m){var x=d.Ya[m].G,C=d.Ya[m].H;if(0<x[1][C[1]+0].g||0<x[2][C[2]+0].g||0<x[3][C[3]+0].g)return 0}return 1}function ki(d,m,x,C,U,$){if(d.Z!=0){var G=d.qd,Y=d.rd;for(e(Co[d.Z]!=null);m<x;++m)Co[d.Z](G,Y,C,U,C,U,$),G=C,Y=U,U+=$;d.qd=G,d.rd=Y}}function si(d,m){var x=d.l.ma,C=x.Z==0||x.Z==1?d.l.j:d.C;if(C=d.C<C?C:d.C,e(m<=d.l.o),m>C){var U=d.l.width,$=x.ca,G=x.tb+U*C,Y=d.V,J=d.Ba+d.c*C,re=d.gc;e(d.ab==1),e(re[0].hc==3),ea(re[0],C,m,Y,J,$,G),ki(x,C,m,$,G,U)}d.C=d.Ma=m}function zr(d,m,x,C,U,$,G){var Y=d.$/C,J=d.$%C,re=d.m,de=d.s,we=x+d.$,ie=we;U=x+C*U;var he=x+C*$,ve=280+de.ua,Ae=d.Pb?Y:16777216,be=0<de.ua?de.Wa:null,Ee=de.wc,Te=we<he?Pn(de,J,Y):null;e(d.C<$),e(he<=U);var Oe=!1;e:for(;;){for(;Oe||we<he;){var Le=0;if(Y>=Ae){var it=we-x;e((Ae=d).Pb),Ae.wd=Ae.m,Ae.xd=it,0<Ae.s.ua&&yt(Ae.s.Wa,Ae.s.vb),Ae=Y+rS}if(J&Ee||(Te=Pn(de,J,Y)),e(Te!=null),Te.Qb&&(m[we]=Te.qb,Oe=!0),!Oe)if(le(re),Te.jc){Le=re,it=m;var Ge=we,Pt=Te.pd[O(Le)&Rl-1];e(Te.jc),256>Pt.g?(Z(Le,Le.u+Pt.g),it[Ge]=Pt.value,Le=0):(Z(Le,Le.u+Pt.g-256),e(256<=Pt.value),Le=Pt.value),Le==0&&(Oe=!0)}else Le=jn(Te.G[0],Te.H[0],re);if(re.h)break;if(Oe||256>Le){if(!Oe)if(Te.nd)m[we]=(Te.qb|Le<<8)>>>0;else{if(le(re),Oe=jn(Te.G[1],Te.H[1],re),le(re),it=jn(Te.G[2],Te.H[2],re),Ge=jn(Te.G[3],Te.H[3],re),re.h)break;m[we]=(Ge<<24|Oe<<16|Le<<8|it)>>>0}if(Oe=!1,++we,++J>=C&&(J=0,++Y,G!=null&&Y<=$&&!(Y%16)&&G(d,Y),be!=null))for(;ie<we;)Le=m[ie++],be.X[(506832829*Le&4294967295)>>>be.Mb]=Le}else if(280>Le){if(Le=br(Le-256,re),it=jn(Te.G[4],Te.H[4],re),le(re),it=wr(C,it=br(it,re)),re.h)break;if(we-x<it||U-we<Le)break e;for(Ge=0;Ge<Le;++Ge)m[we+Ge]=m[we+Ge-it];for(we+=Le,J+=Le;J>=C;)J-=C,++Y,G!=null&&Y<=$&&!(Y%16)&&G(d,Y);if(e(we<=U),J&Ee&&(Te=Pn(de,J,Y)),be!=null)for(;ie<we;)Le=m[ie++],be.X[(506832829*Le&4294967295)>>>be.Mb]=Le}else{if(!(Le<ve))break e;for(Oe=Le-280,e(be!=null);ie<we;)Le=m[ie++],be.X[(506832829*Le&4294967295)>>>be.Mb]=Le;Le=we,e(!(Oe>>>(it=be).Xa)),m[Le]=it.X[Oe],Oe=!0}Oe||e(re.h==X(re))}if(d.Pb&&re.h&&we<U)e(d.m.h),d.a=5,d.m=d.wd,d.$=d.xd,0<d.s.ua&&yt(d.s.vb,d.s.Wa);else{if(re.h)break e;G!=null&&G(d,Y>$?$:Y),d.a=0,d.$=we-x}return 1}return d.a=3,0}function Xn(d){e(d!=null),d.vc=null,d.yc=null,d.Ya=null;var m=d.Wa;m!=null&&(m.X=null),d.vb=null,e(d!=null)}function qs(){var d=new Qe;return d==null?null:(d.a=0,d.xb=cy,Rt("Predictor","VP8LPredictors"),Rt("Predictor","VP8LPredictors_C"),Rt("PredictorAdd","VP8LPredictorsAdd"),Rt("PredictorAdd","VP8LPredictorsAdd_C"),Jn=xt,Ku=ft,Yu=Jt,No=Wt,Ao=Je,So=bt,Dl=sn,j.VP8LMapColor32b=Zs,j.VP8LMapColor8b=Wu,d)}function Ii(d,m,x,C,U){var $=1,G=[d],Y=[m],J=C.m,re=C.s,de=null,we=0;e:for(;;){if(x)for(;$&&ce(J,1);){var ie=G,he=Y,ve=C,Ae=1,be=ve.m,Ee=ve.gc[ve.ab],Te=ce(be,2);if(ve.Oc&1<<Te)$=0;else{switch(ve.Oc|=1<<Te,Ee.hc=Te,Ee.Ea=ie[0],Ee.nc=he[0],Ee.K=[null],++ve.ab,e(4>=ve.ab),Te){case 0:case 1:Ee.b=ce(be,3)+2,Ae=Ii(De(Ee.Ea,Ee.b),De(Ee.nc,Ee.b),0,ve,Ee.K),Ee.K=Ee.K[0];break;case 3:var Oe,Le=ce(be,8)+1,it=16<Le?0:4<Le?1:2<Le?2:3;if(ie[0]=De(Ee.Ea,it),Ee.b=it,Oe=Ae=Ii(Le,1,0,ve,Ee.K)){var Ge,Pt=Le,Ze=Ee,zt=1<<(8>>Ze.b),pr=s(zt);if(pr==null)Oe=0;else{var Lt=Ze.K[0],et=Ze.w;for(pr[0]=Ze.K[0][0],Ge=1;Ge<1*Pt;++Ge)pr[Ge]=je(Lt[et+Ge],pr[Ge-1]);for(;Ge<4*zt;++Ge)pr[Ge]=0;Ze.K[0]=null,Ze.K[0]=pr,Oe=1}}Ae=Oe;break;case 2:break;default:e(0)}$=Ae}}if(G=G[0],Y=Y[0],$&&ce(J,1)&&!($=1<=(we=ce(J,4))&&11>=we)){C.a=3;break e}var ze;if(ze=$)t:{var er,jt,Kt,An=C,Ir=G,li=Y,Wn=we,Hr=x,ci=An.m,mr=An.s,Qt=[null],ln=1,Gn=0,cn=nS[Wn];n:for(;;){if(Hr&&ce(ci,1)){var jr=ce(ci,3)+2,As=De(Ir,jr),tr=De(li,jr),xi=As*tr;if(!Ii(As,tr,0,An,Qt))break n;for(Qt=Qt[0],mr.xc=jr,er=0;er<xi;++er){var gn=Qt[er]>>8&65535;Qt[er]=gn,gn>=ln&&(ln=gn+1)}}if(ci.h)break n;for(jt=0;5>jt;++jt){var gr=oy[jt];!jt&&0<Wn&&(gr+=1<<Wn),Gn<gr&&(Gn=gr)}var Fi=a(ln*cn,k),ui=ln,Vi=a(ui,D);if(Vi==null)var Ui=null;else e(65536>=ui),Ui=Vi;var bi=s(Gn);if(Ui==null||bi==null||Fi==null){An.a=1;break n}var Bi=Fi;for(er=Kt=0;er<ln;++er){var bn=Ui[er],qi=bn.G,Ss=bn.H,Ml=0,Da=1,Pr=0;for(jt=0;5>jt;++jt){gr=oy[jt],qi[jt]=Bi,Ss[jt]=Kt,!jt&&0<Wn&&(gr+=1<<Wn);i:{var Yh,ag=gr,Qh=An,ed=bi,NS=Bi,AS=Kt,og=0,ko=Qh.m,SS=ce(ko,1);if(i(ed,0,0,ag),SS){var ES=ce(ko,1)+1,TS=ce(ko,1),vy=ce(ko,TS==0?1:8);ed[vy]=1,ES==2&&(ed[vy=ce(ko,8)]=1);var Xh=1}else{var yy=s(19),xy=ce(ko,4)+4;if(19<xy){Qh.a=3;var Jh=0;break i}for(Yh=0;Yh<xy;++Yh)yy[eS[Yh]]=ce(ko,3);var lg=void 0,td=void 0,by=Qh,CS=yy,Zh=ag,wy=ed,cg=0,Io=by.m,_y=8,Ny=a(128,k);r:for(;w(Ny,0,7,CS,19);){if(ce(Io,1)){var kS=2+2*ce(Io,3);if((lg=2+ce(Io,kS))>Zh)break r}else lg=Zh;for(td=0;td<Zh&&lg--;){le(Io);var Ay=Ny[0+(127&O(Io))];Z(Io,Io.u+Ay.g);var Sc=Ay.value;if(16>Sc)wy[td++]=Sc,Sc!=0&&(_y=Sc);else{var IS=Sc==16,Sy=Sc-16,jS=JA[Sy],Ey=ce(Io,XA[Sy])+jS;if(td+Ey>Zh)break r;for(var PS=IS?_y:0;0<Ey--;)wy[td++]=PS}}cg=1;break r}cg||(by.a=3),Xh=cg}(Xh=Xh&&!ko.h)&&(og=w(NS,AS,8,ed,ag)),Xh&&og!=0?Jh=og:(Qh.a=3,Jh=0)}if(Jh==0)break n;if(Da&&ZA[jt]==1&&(Da=Bi[Kt].g==0),Ml+=Bi[Kt].g,Kt+=Jh,3>=jt){var nd,ug=bi[0];for(nd=1;nd<gr;++nd)bi[nd]>ug&&(ug=bi[nd]);Pr+=ug}}if(bn.nd=Da,bn.Qb=0,Da&&(bn.qb=(qi[3][Ss[3]+0].value<<24|qi[1][Ss[1]+0].value<<16|qi[2][Ss[2]+0].value)>>>0,Ml==0&&256>qi[0][Ss[0]+0].value&&(bn.Qb=1,bn.qb+=qi[0][Ss[0]+0].value<<8)),bn.jc=!bn.Qb&&6>Pr,bn.jc){var ef,Oa=bn;for(ef=0;ef<Rl;++ef){var jo=ef,Po=Oa.pd[jo],tf=Oa.G[0][Oa.H[0]+jo];256<=tf.value?(Po.g=tf.g+256,Po.value=tf.value):(Po.g=0,Po.value=0,jo>>=lr(tf,8,Po),jo>>=lr(Oa.G[1][Oa.H[1]+jo],16,Po),jo>>=lr(Oa.G[2][Oa.H[2]+jo],0,Po),lr(Oa.G[3][Oa.H[3]+jo],24,Po))}}}mr.vc=Qt,mr.Wb=ln,mr.Ya=Ui,mr.yc=Fi,ze=1;break t}ze=0}if(!($=ze)){C.a=3;break e}if(0<we){if(re.ua=1<<we,!se(re.Wa,we)){C.a=1,$=0;break e}}else re.ua=0;var dg=C,Ty=G,LS=Y,hg=dg.s,fg=hg.xc;if(dg.c=Ty,dg.i=LS,hg.md=De(Ty,fg),hg.wc=fg==0?-1:(1<<fg)-1,x){C.xb=uS;break e}if((de=s(G*Y))==null){C.a=1,$=0;break e}$=($=zr(C,de,0,G,Y,Y,null))&&!J.h;break e}return $?(U!=null?U[0]=de:(e(de==null),e(x)),C.$=0,x||Xn(re)):Xn(re),$}function vs(d,m){var x=d.c*d.i,C=x+m+16*m;return e(d.c<=m),d.V=s(C),d.V==null?(d.Ta=null,d.Ua=0,d.a=1,0):(d.Ta=d.V,d.Ua=d.Ba+x+m,1)}function zs(d,m){var x=d.C,C=m-x,U=d.V,$=d.Ba+d.c*x;for(e(m<=d.l.o);0<C;){var G=16<C?16:C,Y=d.l.ma,J=d.l.width,re=J*G,de=Y.ca,we=Y.tb+J*x,ie=d.Ta,he=d.Ua;Na(d,G,U,$),Z2(ie,he,de,we,re),ki(Y,x,x+G,de,we,J),C-=G,U+=G*d.c,x+=G}e(x==m),d.C=d.Ma=m}function Aa(){this.ub=this.yd=this.td=this.Rb=0}function Sa(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ou(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function $s(){this.Yb=function(){var d=[];return function m(x,C,U){for(var $=U[C],G=0;G<$&&(x.push(U.length>C+1?[]:0),!(U.length<C+1));G++)m(x[G],C+1,U)}(d,0,[3,11]),d}()}function xl(){this.jb=s(3),this.Wc=l([4,8],$s),this.Xc=l([4,17],$s)}function uo(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function _r(){this.ld=this.La=this.dd=this.tc=0}function ji(){this.Na=this.la=0}function ho(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function bl(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function wl(){this.uc=this.M=this.Nb=0,this.wa=Array(new _r),this.Y=0,this.ya=Array(new bl),this.aa=0,this.l=new Hs}function _l(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Nl(){this.cb=this.a=0,this.sc="",this.m=new _,this.Od=new Aa,this.Kc=new Sa,this.ed=new uo,this.Qa=new Ou,this.Ic=this.$c=this.Aa=0,this.D=new wl,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,_),this.ia=0,this.pb=a(4,ho),this.Pa=new xl,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new _l),this.Hd=0,this.rb=Array(new ji),this.sb=0,this.wa=Array(new _r),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new bl),this.L=this.aa=0,this.gd=l([4,2],_r),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Hs(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Al(){var d=new Nl;return d!=null&&(d.a=0,d.sc="OK",d.cb=0,d.Xb=0,Ju||(Ju=ys)),d}function On(d,m,x){return d.a==0&&(d.a=m,d.sc=x,d.cb=0),0}function Sl(d,m,x){return 3<=x&&d[m+0]==157&&d[m+1]==1&&d[m+2]==42}function bc(d,m){if(d==null)return 0;if(d.a=0,d.sc="OK",m==null)return On(d,2,"null VP8Io passed to VP8GetHeaders()");var x=m.data,C=m.w,U=m.ha;if(4>U)return On(d,7,"Truncated header.");var $=x[C+0]|x[C+1]<<8|x[C+2]<<16,G=d.Od;if(G.Rb=!(1&$),G.td=$>>1&7,G.yd=$>>4&1,G.ub=$>>5,3<G.td)return On(d,3,"Incorrect keyframe parameters.");if(!G.yd)return On(d,4,"Frame not displayable.");C+=3,U-=3;var Y=d.Kc;if(G.Rb){if(7>U)return On(d,7,"cannot parse picture header");if(!Sl(x,C,U))return On(d,3,"Bad code word");Y.c=16383&(x[C+4]<<8|x[C+3]),Y.Td=x[C+4]>>6,Y.i=16383&(x[C+6]<<8|x[C+5]),Y.Ud=x[C+6]>>6,C+=7,U-=7,d.za=Y.c+15>>4,d.Ub=Y.i+15>>4,m.width=Y.c,m.height=Y.i,m.Da=0,m.j=0,m.v=0,m.va=m.width,m.o=m.height,m.da=0,m.ib=m.width,m.hb=m.height,m.U=m.width,m.T=m.height,i(($=d.Pa).jb,0,255,$.jb.length),e(($=d.Qa)!=null),$.Cb=0,$.Bb=0,$.Fb=1,i($.Zb,0,0,$.Zb.length),i($.Lb,0,0,$.Lb)}if(G.ub>U)return On(d,7,"bad partition length");W($=d.m,x,C,G.ub),C+=G.ub,U-=G.ub,G.Rb&&(Y.Ld=ye($),Y.Kd=ye($)),Y=d.Qa;var J,re=d.Pa;if(e($!=null),e(Y!=null),Y.Cb=ye($),Y.Cb){if(Y.Bb=ye($),ye($)){for(Y.Fb=ye($),J=0;4>J;++J)Y.Zb[J]=ye($)?q($,7):0;for(J=0;4>J;++J)Y.Lb[J]=ye($)?q($,6):0}if(Y.Bb)for(J=0;3>J;++J)re.jb[J]=ye($)?K($,8):255}else Y.Bb=0;if($.Ka)return On(d,3,"cannot parse segment header");if((Y=d.ed).zd=ye($),Y.Tb=K($,6),Y.wb=K($,3),Y.Pc=ye($),Y.Pc&&ye($)){for(re=0;4>re;++re)ye($)&&(Y.vd[re]=q($,6));for(re=0;4>re;++re)ye($)&&(Y.od[re]=q($,6))}if(d.L=Y.Tb==0?0:Y.zd?1:2,$.Ka)return On(d,3,"cannot parse filter header");var de=U;if(U=J=C,C=J+de,Y=de,d.Xb=(1<<K(d.m,2))-1,de<3*(re=d.Xb))x=7;else{for(J+=3*re,Y-=3*re,de=0;de<re;++de){var we=x[U+0]|x[U+1]<<8|x[U+2]<<16;we>Y&&(we=Y),W(d.Jc[+de],x,J,we),J+=we,Y-=we,U+=3}W(d.Jc[+re],x,J,Y),x=J<C?0:5}if(x!=0)return On(d,x,"cannot parse partitions");for(x=K(J=d.m,7),U=ye(J)?q(J,4):0,C=ye(J)?q(J,4):0,Y=ye(J)?q(J,4):0,re=ye(J)?q(J,4):0,J=ye(J)?q(J,4):0,de=d.Qa,we=0;4>we;++we){if(de.Cb){var ie=de.Zb[we];de.Fb||(ie+=x)}else{if(0<we){d.pb[we]=d.pb[0];continue}ie=x}var he=d.pb[we];he.Sc[0]=rg[Dt(ie+U,127)],he.Sc[1]=ig[Dt(ie+0,127)],he.Eb[0]=2*rg[Dt(ie+C,127)],he.Eb[1]=101581*ig[Dt(ie+Y,127)]>>16,8>he.Eb[1]&&(he.Eb[1]=8),he.Qc[0]=rg[Dt(ie+re,117)],he.Qc[1]=ig[Dt(ie+J,127)],he.lc=ie+J}if(!G.Rb)return On(d,4,"Not a key frame.");for(ye($),G=d.Pa,x=0;4>x;++x){for(U=0;8>U;++U)for(C=0;3>C;++C)for(Y=0;11>Y;++Y)re=xe($,lS[x][U][C][Y])?K($,8):aS[x][U][C][Y],G.Wc[x][U].Yb[C][Y]=re;for(U=0;17>U;++U)G.Xc[x][U]=G.Wc[x][cS[U]]}return d.kc=ye($),d.kc&&(d.Bd=K($,8)),d.cb=1}function ys(d,m,x,C,U,$,G){var Y=m[U].Yb[x];for(x=0;16>U;++U){if(!xe(d,Y[x+0]))return U;for(;!xe(d,Y[x+1]);)if(Y=m[++U].Yb[0],x=0,U==16)return 16;var J=m[U+1].Yb;if(xe(d,Y[x+2])){var re=d,de=0;if(xe(re,(ie=Y)[(we=x)+3]))if(xe(re,ie[we+6])){for(Y=0,we=2*(de=xe(re,ie[we+8]))+(ie=xe(re,ie[we+9+de])),de=0,ie=iS[we];ie[Y];++Y)de+=de+xe(re,ie[Y]);de+=3+(8<<we)}else xe(re,ie[we+7])?(de=7+2*xe(re,165),de+=xe(re,145)):de=5+xe(re,159);else de=xe(re,ie[we+4])?3+xe(re,ie[we+5]):2;Y=J[2]}else de=1,Y=J[1];J=G+sS[U],0>(re=d).b&&me(re);var we,ie=re.b,he=(we=re.Ca>>1)-(re.I>>ie)>>31;--re.b,re.Ca+=he,re.Ca|=1,re.I-=(we+1&he)<<ie,$[J]=((de^he)-he)*C[(0<U)+0]}return 16}function Ws(d){var m=d.rb[d.sb-1];m.la=0,m.Na=0,i(d.zc,0,0,d.zc.length),d.ja=0}function mi(d,m,x,C,U){U=d[m+x+32*C]+(U>>3),d[m+x+32*C]=-256&U?0>U?0:255:U}function Ea(d,m,x,C,U,$){mi(d,m,0,x,C+U),mi(d,m,1,x,C+$),mi(d,m,2,x,C-$),mi(d,m,3,x,C-U)}function an(d){return(20091*d>>16)+d}function ai(d,m,x,C){var U,$=0,G=s(16);for(U=0;4>U;++U){var Y=d[m+0]+d[m+8],J=d[m+0]-d[m+8],re=(35468*d[m+4]>>16)-an(d[m+12]),de=an(d[m+4])+(35468*d[m+12]>>16);G[$+0]=Y+de,G[$+1]=J+re,G[$+2]=J-re,G[$+3]=Y-de,$+=4,m++}for(U=$=0;4>U;++U)Y=(d=G[$+0]+4)+G[$+8],J=d-G[$+8],re=(35468*G[$+4]>>16)-an(G[$+12]),mi(x,C,0,0,Y+(de=an(G[$+4])+(35468*G[$+12]>>16))),mi(x,C,1,0,J+re),mi(x,C,2,0,J-re),mi(x,C,3,0,Y-de),$++,C+=32}function fo(d,m,x,C){var U=d[m+0]+4,$=35468*d[m+4]>>16,G=an(d[m+4]),Y=35468*d[m+1]>>16;Ea(x,C,0,U+G,d=an(d[m+1]),Y),Ea(x,C,1,U+$,d,Y),Ea(x,C,2,U-$,d,Y),Ea(x,C,3,U-G,d,Y)}function po(d,m,x,C,U){ai(d,m,x,C),U&&ai(d,m+16,x,C+4)}function wc(d,m,x,C){Ol(d,m+0,x,C,1),Ol(d,m+32,x,C+128,1)}function Vt(d,m,x,C){var U;for(d=d[m+0]+4,U=0;4>U;++U)for(m=0;4>m;++m)mi(x,C,m,U,d)}function Ta(d,m,x,C){d[m+0]&&rn(d,m+0,x,C),d[m+16]&&rn(d,m+16,x,C+4),d[m+32]&&rn(d,m+32,x,C+128),d[m+48]&&rn(d,m+48,x,C+128+4)}function Gs(d,m,x,C){var U,$=s(16);for(U=0;4>U;++U){var G=d[m+0+U]+d[m+12+U],Y=d[m+4+U]+d[m+8+U],J=d[m+4+U]-d[m+8+U],re=d[m+0+U]-d[m+12+U];$[0+U]=G+Y,$[8+U]=G-Y,$[4+U]=re+J,$[12+U]=re-J}for(U=0;4>U;++U)G=(d=$[0+4*U]+3)+$[3+4*U],Y=$[1+4*U]+$[2+4*U],J=$[1+4*U]-$[2+4*U],re=d-$[3+4*U],x[C+0]=G+Y>>3,x[C+16]=re+J>>3,x[C+32]=G-Y>>3,x[C+48]=re-J>>3,C+=64}function gi(d,m,x){var C,U=m-32,$=Mi,G=255-d[U-1];for(C=0;C<x;++C){var Y,J=$,re=G+d[m-1];for(Y=0;Y<x;++Y)d[m+Y]=J[re+d[U+Y]];m+=32}}function El(d,m){gi(d,m,4)}function _c(d,m){gi(d,m,8)}function Mu(d,m){gi(d,m,16)}function Fu(d,m){var x;for(x=0;16>x;++x)r(d,m+32*x,d,m-32,16)}function Tl(d,m){var x;for(x=16;0<x;--x)i(d,m,d[m-1],16),m+=32}function Ca(d,m,x){var C;for(C=0;16>C;++C)i(m,x+32*C,d,16)}function vi(d,m){var x,C=16;for(x=0;16>x;++x)C+=d[m-1+32*x]+d[m+x-32];Ca(C>>5,d,m)}function ts(d,m){var x,C=8;for(x=0;16>x;++x)C+=d[m-1+32*x];Ca(C>>4,d,m)}function Ks(d,m){var x,C=8;for(x=0;16>x;++x)C+=d[m+x-32];Ca(C>>4,d,m)}function mo(d,m){Ca(128,d,m)}function gt(d,m,x){return d+2*m+x+2>>2}function Ys(d,m){var x,C=m-32;for(C=new Uint8Array([gt(d[C-1],d[C+0],d[C+1]),gt(d[C+0],d[C+1],d[C+2]),gt(d[C+1],d[C+2],d[C+3]),gt(d[C+2],d[C+3],d[C+4])]),x=0;4>x;++x)r(d,m+32*x,C,0,C.length)}function Vu(d,m){var x=d[m-1],C=d[m-1+32],U=d[m-1+64],$=d[m-1+96];ke(d,m+0,16843009*gt(d[m-1-32],x,C)),ke(d,m+32,16843009*gt(x,C,U)),ke(d,m+64,16843009*gt(C,U,$)),ke(d,m+96,16843009*gt(U,$,$))}function Uu(d,m){var x,C=4;for(x=0;4>x;++x)C+=d[m+x-32]+d[m-1+32*x];for(C>>=3,x=0;4>x;++x)i(d,m+32*x,C,4)}function Bu(d,m){var x=d[m-1+0],C=d[m-1+32],U=d[m-1+64],$=d[m-1-32],G=d[m+0-32],Y=d[m+1-32],J=d[m+2-32],re=d[m+3-32];d[m+0+96]=gt(C,U,d[m-1+96]),d[m+1+96]=d[m+0+64]=gt(x,C,U),d[m+2+96]=d[m+1+64]=d[m+0+32]=gt($,x,C),d[m+3+96]=d[m+2+64]=d[m+1+32]=d[m+0+0]=gt(G,$,x),d[m+3+64]=d[m+2+32]=d[m+1+0]=gt(Y,G,$),d[m+3+32]=d[m+2+0]=gt(J,Y,G),d[m+3+0]=gt(re,J,Y)}function Nr(d,m){var x=d[m+1-32],C=d[m+2-32],U=d[m+3-32],$=d[m+4-32],G=d[m+5-32],Y=d[m+6-32],J=d[m+7-32];d[m+0+0]=gt(d[m+0-32],x,C),d[m+1+0]=d[m+0+32]=gt(x,C,U),d[m+2+0]=d[m+1+32]=d[m+0+64]=gt(C,U,$),d[m+3+0]=d[m+2+32]=d[m+1+64]=d[m+0+96]=gt(U,$,G),d[m+3+32]=d[m+2+64]=d[m+1+96]=gt($,G,Y),d[m+3+64]=d[m+2+96]=gt(G,Y,J),d[m+3+96]=gt(Y,J,J)}function xs(d,m){var x=d[m-1+0],C=d[m-1+32],U=d[m-1+64],$=d[m-1-32],G=d[m+0-32],Y=d[m+1-32],J=d[m+2-32],re=d[m+3-32];d[m+0+0]=d[m+1+64]=$+G+1>>1,d[m+1+0]=d[m+2+64]=G+Y+1>>1,d[m+2+0]=d[m+3+64]=Y+J+1>>1,d[m+3+0]=J+re+1>>1,d[m+0+96]=gt(U,C,x),d[m+0+64]=gt(C,x,$),d[m+0+32]=d[m+1+96]=gt(x,$,G),d[m+1+32]=d[m+2+96]=gt($,G,Y),d[m+2+32]=d[m+3+96]=gt(G,Y,J),d[m+3+32]=gt(Y,J,re)}function qu(d,m){var x=d[m+0-32],C=d[m+1-32],U=d[m+2-32],$=d[m+3-32],G=d[m+4-32],Y=d[m+5-32],J=d[m+6-32],re=d[m+7-32];d[m+0+0]=x+C+1>>1,d[m+1+0]=d[m+0+64]=C+U+1>>1,d[m+2+0]=d[m+1+64]=U+$+1>>1,d[m+3+0]=d[m+2+64]=$+G+1>>1,d[m+0+32]=gt(x,C,U),d[m+1+32]=d[m+0+96]=gt(C,U,$),d[m+2+32]=d[m+1+96]=gt(U,$,G),d[m+3+32]=d[m+2+96]=gt($,G,Y),d[m+3+64]=gt(G,Y,J),d[m+3+96]=gt(Y,J,re)}function go(d,m){var x=d[m-1+0],C=d[m-1+32],U=d[m-1+64],$=d[m-1+96];d[m+0+0]=x+C+1>>1,d[m+2+0]=d[m+0+32]=C+U+1>>1,d[m+2+32]=d[m+0+64]=U+$+1>>1,d[m+1+0]=gt(x,C,U),d[m+3+0]=d[m+1+32]=gt(C,U,$),d[m+3+32]=d[m+1+64]=gt(U,$,$),d[m+3+64]=d[m+2+64]=d[m+0+96]=d[m+1+96]=d[m+2+96]=d[m+3+96]=$}function bs(d,m){var x=d[m-1+0],C=d[m-1+32],U=d[m-1+64],$=d[m-1+96],G=d[m-1-32],Y=d[m+0-32],J=d[m+1-32],re=d[m+2-32];d[m+0+0]=d[m+2+32]=x+G+1>>1,d[m+0+32]=d[m+2+64]=C+x+1>>1,d[m+0+64]=d[m+2+96]=U+C+1>>1,d[m+0+96]=$+U+1>>1,d[m+3+0]=gt(Y,J,re),d[m+2+0]=gt(G,Y,J),d[m+1+0]=d[m+3+32]=gt(x,G,Y),d[m+1+32]=d[m+3+64]=gt(C,x,G),d[m+1+64]=d[m+3+96]=gt(U,C,x),d[m+1+96]=gt($,U,C)}function vo(d,m){var x;for(x=0;8>x;++x)r(d,m+32*x,d,m-32,8)}function Pi(d,m){var x;for(x=0;8>x;++x)i(d,m,d[m-1],8),m+=32}function ns(d,m,x){var C;for(C=0;8>C;++C)i(m,x+32*C,d,8)}function ka(d,m){var x,C=8;for(x=0;8>x;++x)C+=d[m+x-32]+d[m-1+32*x];ns(C>>4,d,m)}function Cl(d,m){var x,C=4;for(x=0;8>x;++x)C+=d[m+x-32];ns(C>>3,d,m)}function pn(d,m){var x,C=4;for(x=0;8>x;++x)C+=d[m-1+32*x];ns(C>>3,d,m)}function kl(d,m){ns(128,d,m)}function Ia(d,m,x){var C=d[m-x],U=d[m+0],$=3*(U-C)+Jm[1020+d[m-2*x]-d[m+x]],G=Uh[112+($+4>>3)];d[m-x]=Mi[255+C+Uh[112+($+3>>3)]],d[m+0]=Mi[255+U-G]}function Qs(d,m,x,C){var U=d[m+0],$=d[m+x];return ss[255+d[m-2*x]-d[m-x]]>C||ss[255+$-U]>C}function yo(d,m,x,C){return 4*ss[255+d[m-x]-d[m+0]]+ss[255+d[m-2*x]-d[m+x]]<=C}function ja(d,m,x,C,U){var $=d[m-3*x],G=d[m-2*x],Y=d[m-x],J=d[m+0],re=d[m+x],de=d[m+2*x],we=d[m+3*x];return 4*ss[255+Y-J]+ss[255+G-re]>C?0:ss[255+d[m-4*x]-$]<=U&&ss[255+$-G]<=U&&ss[255+G-Y]<=U&&ss[255+we-de]<=U&&ss[255+de-re]<=U&&ss[255+re-J]<=U}function Xs(d,m,x,C){var U=2*C+1;for(C=0;16>C;++C)yo(d,m+C,x,U)&&Ia(d,m+C,x)}function Js(d,m,x,C){var U=2*C+1;for(C=0;16>C;++C)yo(d,m+C*x,1,U)&&Ia(d,m+C*x,1)}function yi(d,m,x,C){var U;for(U=3;0<U;--U)Xs(d,m+=4*x,x,C)}function Il(d,m,x,C){var U;for(U=3;0<U;--U)Js(d,m+=4,x,C)}function ws(d,m,x,C,U,$,G,Y){for($=2*$+1;0<U--;){if(ja(d,m,x,$,G))if(Qs(d,m,x,Y))Ia(d,m,x);else{var J=d,re=m,de=x,we=J[re-2*de],ie=J[re-de],he=J[re+0],ve=J[re+de],Ae=J[re+2*de],be=27*(Te=Jm[1020+3*(he-ie)+Jm[1020+we-ve]])+63>>7,Ee=18*Te+63>>7,Te=9*Te+63>>7;J[re-3*de]=Mi[255+J[re-3*de]+Te],J[re-2*de]=Mi[255+we+Ee],J[re-de]=Mi[255+ie+be],J[re+0]=Mi[255+he-be],J[re+de]=Mi[255+ve-Ee],J[re+2*de]=Mi[255+Ae-Te]}m+=C}}function oi(d,m,x,C,U,$,G,Y){for($=2*$+1;0<U--;){if(ja(d,m,x,$,G))if(Qs(d,m,x,Y))Ia(d,m,x);else{var J=d,re=m,de=x,we=J[re-de],ie=J[re+0],he=J[re+de],ve=Uh[112+(4+(Ae=3*(ie-we))>>3)],Ae=Uh[112+(Ae+3>>3)],be=ve+1>>1;J[re-2*de]=Mi[255+J[re-2*de]+be],J[re-de]=Mi[255+we+Ae],J[re+0]=Mi[255+ie-ve],J[re+de]=Mi[255+he-be]}m+=C}}function jl(d,m,x,C,U,$){ws(d,m,x,1,16,C,U,$)}function xo(d,m,x,C,U,$){ws(d,m,1,x,16,C,U,$)}function rs(d,m,x,C,U,$){var G;for(G=3;0<G;--G)oi(d,m+=4*x,x,1,16,C,U,$)}function Pl(d,m,x,C,U,$){var G;for(G=3;0<G;--G)oi(d,m+=4,1,x,16,C,U,$)}function v(d,m,x,C,U,$,G,Y){ws(d,m,U,1,8,$,G,Y),ws(x,C,U,1,8,$,G,Y)}function V(d,m,x,C,U,$,G,Y){ws(d,m,1,U,8,$,G,Y),ws(x,C,1,U,8,$,G,Y)}function ne(d,m,x,C,U,$,G,Y){oi(d,m+4*U,U,1,8,$,G,Y),oi(x,C+4*U,U,1,8,$,G,Y)}function oe(d,m,x,C,U,$,G,Y){oi(d,m+4,1,U,8,$,G,Y),oi(x,C+4,1,U,8,$,G,Y)}function pe(){this.ba=new en,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ot,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Se(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Pe(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function He(){this.ua=0,this.Wa=new Ye,this.vb=new Ye,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new D,this.yc=new k}function Qe(){this.xb=this.a=0,this.l=new Hs,this.ca=new en,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new z,this.Pb=0,this.wd=new z,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new He,this.ab=0,this.gc=a(4,Pe),this.Oc=0}function ht(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Hs,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function wt(d,m,x,C,U,$,G){for(d=d==null?0:d[m+0],m=0;m<G;++m)U[$+m]=d+x[C+m]&255,d=U[$+m]}function Gt(d,m,x,C,U,$,G){var Y;if(d==null)wt(null,null,x,C,U,$,G);else for(Y=0;Y<G;++Y)U[$+Y]=d[m+Y]+x[C+Y]&255}function tn(d,m,x,C,U,$,G){if(d==null)wt(null,null,x,C,U,$,G);else{var Y,J=d[m+0],re=J,de=J;for(Y=0;Y<G;++Y)re=de+(J=d[m+Y])-re,de=x[C+Y]+(-256&re?0>re?0:255:re)&255,re=J,U[$+Y]=de}}function Mn(d,m,x,C){var U=m.width,$=m.o;if(e(d!=null&&m!=null),0>x||0>=C||x+C>$)return null;if(!d.Cc){if(d.ga==null){var G;if(d.ga=new ht,(G=d.ga==null)||(G=m.width*m.o,e(d.Gb.length==0),d.Gb=s(G),d.Uc=0,d.Gb==null?G=0:(d.mb=d.Gb,d.nb=d.Uc,d.rc=null,G=1),G=!G),!G){G=d.ga;var Y=d.Fa,J=d.P,re=d.qc,de=d.mb,we=d.nb,ie=J+1,he=re-1,ve=G.l;if(e(Y!=null&&de!=null&&m!=null),Co[0]=null,Co[1]=wt,Co[2]=Gt,Co[3]=tn,G.ca=de,G.tb=we,G.c=m.width,G.i=m.height,e(0<G.c&&0<G.i),1>=re)m=0;else if(G.$a=3&Y[J+0],G.Z=Y[J+0]>>2&3,G.Lc=Y[J+0]>>4&3,J=Y[J+0]>>6&3,0>G.$a||1<G.$a||4<=G.Z||1<G.Lc||J)m=0;else if(ve.put=ut,ve.ac=Br,ve.bc=Nn,ve.ma=G,ve.width=m.width,ve.height=m.height,ve.Da=m.Da,ve.v=m.v,ve.va=m.va,ve.j=m.j,ve.o=m.o,G.$a)e:{e(G.$a==1),m=qs();t:for(;;){if(m==null){m=0;break e}if(e(G!=null),G.mc=m,m.c=G.c,m.i=G.i,m.l=G.l,m.l.ma=G,m.l.width=G.c,m.l.height=G.i,m.a=0,ee(m.m,Y,ie,he),!Ii(G.c,G.i,1,m,null)||(m.ab==1&&m.gc[0].hc==3&&qr(m.s)?(G.ic=1,Y=m.c*m.i,m.Ta=null,m.Ua=0,m.V=s(Y),m.Ba=0,m.V==null?(m.a=1,m=0):m=1):(G.ic=0,m=vs(m,G.c)),!m))break t;m=1;break e}G.mc=null,m=0}else m=he>=G.c*G.i;G=!m}if(G)return null;d.ga.Lc!=1?d.Ga=0:C=$-x}e(d.ga!=null),e(x+C<=$);e:{if(m=(Y=d.ga).c,$=Y.l.o,Y.$a==0){if(ie=d.rc,he=d.Vc,ve=d.Fa,J=d.P+1+x*m,re=d.mb,de=d.nb+x*m,e(J<=d.P+d.qc),Y.Z!=0)for(e(Co[Y.Z]!=null),G=0;G<C;++G)Co[Y.Z](ie,he,ve,J,re,de,m),ie=re,he=de,de+=m,J+=m;else for(G=0;G<C;++G)r(re,de,ve,J,m),ie=re,he=de,de+=m,J+=m;d.rc=ie,d.Vc=he}else{if(e(Y.mc!=null),m=x+C,e((G=Y.mc)!=null),e(m<=G.i),G.C>=m)m=1;else if(Y.ic||yn(),Y.ic){Y=G.V,ie=G.Ba,he=G.c;var Ae=G.i,be=(ve=1,J=G.$/he,re=G.$%he,de=G.m,we=G.s,G.$),Ee=he*Ae,Te=he*m,Oe=we.wc,Le=be<Te?Pn(we,re,J):null;e(be<=Ee),e(m<=Ae),e(qr(we));t:for(;;){for(;!de.h&&be<Te;){if(re&Oe||(Le=Pn(we,re,J)),e(Le!=null),le(de),256>(Ae=jn(Le.G[0],Le.H[0],de)))Y[ie+be]=Ae,++be,++re>=he&&(re=0,++J<=m&&!(J%16)&&si(G,J));else{if(!(280>Ae)){ve=0;break t}Ae=br(Ae-256,de);var it,Ge=jn(Le.G[4],Le.H[4],de);if(le(de),!(be>=(Ge=wr(he,Ge=br(Ge,de)))&&Ee-be>=Ae)){ve=0;break t}for(it=0;it<Ae;++it)Y[ie+be+it]=Y[ie+be+it-Ge];for(be+=Ae,re+=Ae;re>=he;)re-=he,++J<=m&&!(J%16)&&si(G,J);be<Te&&re&Oe&&(Le=Pn(we,re,J))}e(de.h==X(de))}si(G,J>m?m:J);break t}!ve||de.h&&be<Ee?(ve=0,G.a=de.h?5:3):G.$=be,m=ve}else m=zr(G,G.V,G.Ba,G.c,G.i,m,zs);if(!m){C=0;break e}}x+C>=$&&(d.Cc=1),C=1}if(!C)return null;if(d.Cc&&((C=d.ga)!=null&&(C.mc=null),d.ga=null,0<d.Ga))return alert("todo:WebPDequantizeLevels"),null}return d.nb+x*U}function on(d,m,x,C,U,$){for(;0<U--;){var G,Y=d,J=m+(x?1:0),re=d,de=m+(x?0:3);for(G=0;G<C;++G){var we=re[de+4*G];we!=255&&(we*=32897,Y[J+4*G+0]=Y[J+4*G+0]*we>>23,Y[J+4*G+1]=Y[J+4*G+1]*we>>23,Y[J+4*G+2]=Y[J+4*G+2]*we>>23)}m+=$}}function $n(d,m,x,C,U){for(;0<C--;){var $;for($=0;$<x;++$){var G=d[m+2*$+0],Y=15&(re=d[m+2*$+1]),J=4369*Y,re=(240&re|re>>4)*J>>16;d[m+2*$+0]=(240&G|G>>4)*J>>16&240|(15&G|G<<4)*J>>16>>4&15,d[m+2*$+1]=240&re|Y}m+=U}}function Fn(d,m,x,C,U,$,G,Y){var J,re,de=255;for(re=0;re<U;++re){for(J=0;J<C;++J){var we=d[m+J];$[G+4*J]=we,de&=we}m+=x,G+=Y}return de!=255}function Hn(d,m,x,C,U){var $;for($=0;$<U;++$)x[C+$]=d[m+$]>>8}function yn(){Xu=on,X2=$n,J2=Fn,Z2=Hn}function Cr(d,m,x){j[d]=function(C,U,$,G,Y,J,re,de,we,ie,he,ve,Ae,be,Ee,Te,Oe){var Le,it=Oe-1>>1,Ge=Y[J+0]|re[de+0]<<16,Pt=we[ie+0]|he[ve+0]<<16;e(C!=null);var Ze=3*Ge+Pt+131074>>2;for(m(C[U+0],255&Ze,Ze>>16,Ae,be),$!=null&&(Ze=3*Pt+Ge+131074>>2,m($[G+0],255&Ze,Ze>>16,Ee,Te)),Le=1;Le<=it;++Le){var zt=Y[J+Le]|re[de+Le]<<16,pr=we[ie+Le]|he[ve+Le]<<16,Lt=Ge+zt+Pt+pr+524296,et=Lt+2*(zt+Pt)>>3;Ze=et+Ge>>1,Ge=(Lt=Lt+2*(Ge+pr)>>3)+zt>>1,m(C[U+2*Le-1],255&Ze,Ze>>16,Ae,be+(2*Le-1)*x),m(C[U+2*Le-0],255&Ge,Ge>>16,Ae,be+(2*Le-0)*x),$!=null&&(Ze=Lt+Pt>>1,Ge=et+pr>>1,m($[G+2*Le-1],255&Ze,Ze>>16,Ee,Te+(2*Le-1)*x),m($[G+2*Le+0],255&Ge,Ge>>16,Ee,Te+(2*Le+0)*x)),Ge=zt,Pt=pr}1&Oe||(Ze=3*Ge+Pt+131074>>2,m(C[U+Oe-1],255&Ze,Ze>>16,Ae,be+(Oe-1)*x),$!=null&&(Ze=3*Pt+Ge+131074>>2,m($[G+Oe-1],255&Ze,Ze>>16,Ee,Te+(Oe-1)*x)))}}function Ll(){as[Bh]=dS,as[qh]=uy,as[sy]=hS,as[zh]=dy,as[$h]=hy,as[Zm]=fy,as[ay]=fS,as[eg]=uy,as[tg]=dy,as[Hh]=hy,as[ng]=fy}function Li(d){return d&-16384?0>d?0:255:d>>pS}function h(d,m){return Li((19077*d>>8)+(26149*m>>8)-14234)}function b(d,m,x){return Li((19077*d>>8)-(6419*m>>8)-(13320*x>>8)+8708)}function R(d,m){return Li((19077*d>>8)+(33050*m>>8)-17685)}function Q(d,m,x,C,U){C[U+0]=h(d,x),C[U+1]=b(d,m,x),C[U+2]=R(d,m)}function ge(d,m,x,C,U){C[U+0]=R(d,m),C[U+1]=b(d,m,x),C[U+2]=h(d,x)}function _e(d,m,x,C,U){var $=b(d,m,x);m=$<<3&224|R(d,m)>>3,C[U+0]=248&h(d,x)|$>>5,C[U+1]=m}function Fe(d,m,x,C,U){var $=240&R(d,m)|15;C[U+0]=240&h(d,x)|b(d,m,x)>>4,C[U+1]=$}function qt(d,m,x,C,U){C[U+0]=255,Q(d,m,x,C,U+1)}function Vn(d,m,x,C,U){ge(d,m,x,C,U),C[U+3]=255}function Mt(d,m,x,C,U){Q(d,m,x,C,U),C[U+3]=255}function Dt(d,m){return 0>d?0:d>m?m:d}function xn(d,m,x){j[d]=function(C,U,$,G,Y,J,re,de,we){for(var ie=de+(-2&we)*x;de!=ie;)m(C[U+0],$[G+0],Y[J+0],re,de),m(C[U+1],$[G+0],Y[J+0],re,de+x),U+=2,++G,++J,de+=2*x;1&we&&m(C[U+0],$[G+0],Y[J+0],re,de)}}function Ri(d,m,x){return x==0?d==0?m==0?6:5:m==0?4:0:x}function $r(d,m,x,C,U){switch(d>>>30){case 3:Ol(m,x,C,U,0);break;case 2:is(m,x,C,U);break;case 1:rn(m,x,C,U)}}function kr(d,m){var x,C,U=m.M,$=m.Nb,G=d.oc,Y=d.pc+40,J=d.oc,re=d.pc+584,de=d.oc,we=d.pc+600;for(x=0;16>x;++x)G[Y+32*x-1]=129;for(x=0;8>x;++x)J[re+32*x-1]=129,de[we+32*x-1]=129;for(0<U?G[Y-1-32]=J[re-1-32]=de[we-1-32]=129:(i(G,Y-32-1,127,21),i(J,re-32-1,127,9),i(de,we-32-1,127,9)),C=0;C<d.za;++C){var ie=m.ya[m.aa+C];if(0<C){for(x=-1;16>x;++x)r(G,Y+32*x-4,G,Y+32*x+12,4);for(x=-1;8>x;++x)r(J,re+32*x-4,J,re+32*x+4,4),r(de,we+32*x-4,de,we+32*x+4,4)}var he=d.Gd,ve=d.Hd+C,Ae=ie.ad,be=ie.Hc;if(0<U&&(r(G,Y-32,he[ve].y,0,16),r(J,re-32,he[ve].f,0,8),r(de,we-32,he[ve].ea,0,8)),ie.Za){var Ee=G,Te=Y-32+16;for(0<U&&(C>=d.za-1?i(Ee,Te,he[ve].y[15],4):r(Ee,Te,he[ve+1].y,0,4)),x=0;4>x;x++)Ee[Te+128+x]=Ee[Te+256+x]=Ee[Te+384+x]=Ee[Te+0+x];for(x=0;16>x;++x,be<<=2)Ee=G,Te=Y+my[x],Ns[ie.Ob[x]](Ee,Te),$r(be,Ae,16*+x,Ee,Te)}else if(Ee=Ri(C,U,ie.Ob[0]),To[Ee](G,Y),be!=0)for(x=0;16>x;++x,be<<=2)$r(be,Ae,16*+x,G,Y+my[x]);for(x=ie.Gc,Ee=Ri(C,U,ie.Dd),Ra[Ee](J,re),Ra[Ee](de,we),be=Ae,Ee=J,Te=re,255&(ie=0|x)&&(170&ie?ta(be,256,Ee,Te):mn(be,256,Ee,Te)),ie=de,be=we,255&(x>>=8)&&(170&x?ta(Ae,320,ie,be):mn(Ae,320,ie,be)),U<d.Ub-1&&(r(he[ve].y,0,G,Y+480,16),r(he[ve].f,0,J,re+224,8),r(he[ve].ea,0,de,we+224,8)),x=8*$*d.B,he=d.sa,ve=d.ta+16*C+16*$*d.R,Ae=d.qa,ie=d.ra+8*C+x,be=d.Ha,Ee=d.Ia+8*C+x,x=0;16>x;++x)r(he,ve+x*d.R,G,Y+32*x,16);for(x=0;8>x;++x)r(Ae,ie+x*d.B,J,re+32*x,8),r(be,Ee+x*d.B,de,we+32*x,8)}}function _s(d,m,x,C,U,$,G,Y,J){var re=[0],de=[0],we=0,ie=J!=null?J.kd:0,he=J??new Se;if(d==null||12>x)return 7;he.data=d,he.w=m,he.ha=x,m=[m],x=[x],he.gb=[he.gb];e:{var ve=m,Ae=x,be=he.gb;if(e(d!=null),e(Ae!=null),e(be!=null),be[0]=0,12<=Ae[0]&&!n(d,ve[0],"RIFF")){if(n(d,ve[0]+8,"WEBP")){be=3;break e}var Ee=Ne(d,ve[0]+4);if(12>Ee||4294967286<Ee){be=3;break e}if(ie&&Ee>Ae[0]-8){be=7;break e}be[0]=Ee,ve[0]+=12,Ae[0]-=12}be=0}if(be!=0)return be;for(Ee=0<he.gb[0],x=x[0];;){e:{var Te=d;Ae=m,be=x;var Oe=re,Le=de,it=ve=[0];if((Ze=we=[we])[0]=0,8>be[0])be=7;else{if(!n(Te,Ae[0],"VP8X")){if(Ne(Te,Ae[0]+4)!=10){be=3;break e}if(18>be[0]){be=7;break e}var Ge=Ne(Te,Ae[0]+8),Pt=1+Ue(Te,Ae[0]+12);if(2147483648<=Pt*(Te=1+Ue(Te,Ae[0]+15))){be=3;break e}it!=null&&(it[0]=Ge),Oe!=null&&(Oe[0]=Pt),Le!=null&&(Le[0]=Te),Ae[0]+=18,be[0]-=18,Ze[0]=1}be=0}}if(we=we[0],ve=ve[0],be!=0)return be;if(Ae=!!(2&ve),!Ee&&we)return 3;if($!=null&&($[0]=!!(16&ve)),G!=null&&(G[0]=Ae),Y!=null&&(Y[0]=0),G=re[0],ve=de[0],we&&Ae&&J==null){be=0;break}if(4>x){be=7;break}if(Ee&&we||!Ee&&!we&&!n(d,m[0],"ALPH")){x=[x],he.na=[he.na],he.P=[he.P],he.Sa=[he.Sa];e:{Ge=d,be=m,Ee=x;var Ze=he.gb;Oe=he.na,Le=he.P,it=he.Sa,Pt=22,e(Ge!=null),e(Ee!=null),Te=be[0];var zt=Ee[0];for(e(Oe!=null),e(it!=null),Oe[0]=null,Le[0]=null,it[0]=0;;){if(be[0]=Te,Ee[0]=zt,8>zt){be=7;break e}var pr=Ne(Ge,Te+4);if(4294967286<pr){be=3;break e}var Lt=8+pr+1&-2;if(Pt+=Lt,0<Ze&&Pt>Ze){be=3;break e}if(!n(Ge,Te,"VP8 ")||!n(Ge,Te,"VP8L")){be=0;break e}if(zt[0]<Lt){be=7;break e}n(Ge,Te,"ALPH")||(Oe[0]=Ge,Le[0]=Te+8,it[0]=pr),Te+=Lt,zt-=Lt}}if(x=x[0],he.na=he.na[0],he.P=he.P[0],he.Sa=he.Sa[0],be!=0)break}x=[x],he.Ja=[he.Ja],he.xa=[he.xa];e:if(Ze=d,be=m,Ee=x,Oe=he.gb[0],Le=he.Ja,it=he.xa,Ge=be[0],Te=!n(Ze,Ge,"VP8 "),Pt=!n(Ze,Ge,"VP8L"),e(Ze!=null),e(Ee!=null),e(Le!=null),e(it!=null),8>Ee[0])be=7;else{if(Te||Pt){if(Ze=Ne(Ze,Ge+4),12<=Oe&&Ze>Oe-12){be=3;break e}if(ie&&Ze>Ee[0]-8){be=7;break e}Le[0]=Ze,be[0]+=8,Ee[0]-=8,it[0]=Pt}else it[0]=5<=Ee[0]&&Ze[Ge+0]==47&&!(Ze[Ge+4]>>5),Le[0]=Ee[0];be=0}if(x=x[0],he.Ja=he.Ja[0],he.xa=he.xa[0],m=m[0],be!=0)break;if(4294967286<he.Ja)return 3;if(Y==null||Ae||(Y[0]=he.xa?2:1),G=[G],ve=[ve],he.xa){if(5>x){be=7;break}Y=G,ie=ve,Ae=$,d==null||5>x?d=0:5<=x&&d[m+0]==47&&!(d[m+4]>>5)?(Ee=[0],Ze=[0],Oe=[0],ee(Le=new z,d,m,x),es(Le,Ee,Ze,Oe)?(Y!=null&&(Y[0]=Ee[0]),ie!=null&&(ie[0]=Ze[0]),Ae!=null&&(Ae[0]=Oe[0]),d=1):d=0):d=0}else{if(10>x){be=7;break}Y=ve,d==null||10>x||!Sl(d,m+3,x-3)?d=0:(ie=d[m+0]|d[m+1]<<8|d[m+2]<<16,Ae=16383&(d[m+7]<<8|d[m+6]),d=16383&(d[m+9]<<8|d[m+8]),1&ie||3<(ie>>1&7)||!(ie>>4&1)||ie>>5>=he.Ja||!Ae||!d?d=0:(G&&(G[0]=Ae),Y&&(Y[0]=d),d=1))}if(!d||(G=G[0],ve=ve[0],we&&(re[0]!=G||de[0]!=ve)))return 3;J!=null&&(J[0]=he,J.offset=m-J.w,e(4294967286>m-J.w),e(J.offset==J.ha-x));break}return be==0||be==7&&we&&J==null?($!=null&&($[0]|=he.na!=null&&0<he.na.length),C!=null&&(C[0]=G),U!=null&&(U[0]=ve),0):be}function zu(d,m,x){var C=m.width,U=m.height,$=0,G=0,Y=C,J=U;if(m.Da=d!=null&&0<d.Da,m.Da&&(Y=d.cd,J=d.bd,$=d.v,G=d.j,11>x||($&=-2,G&=-2),0>$||0>G||0>=Y||0>=J||$+Y>C||G+J>U))return 0;if(m.v=$,m.j=G,m.va=$+Y,m.o=G+J,m.U=Y,m.T=J,m.da=d!=null&&0<d.da,m.da){if(!ot(Y,J,x=[d.ib],$=[d.hb]))return 0;m.ib=x[0],m.hb=$[0]}return m.ob=d!=null&&d.ob,m.Kb=d==null||!d.Sd,m.da&&(m.ob=m.ib<3*C/4&&m.hb<3*U/4,m.Kb=0),1}function $u(d){if(d==null)return 2;if(11>d.S){var m=d.f.RGBA;m.fb+=(d.height-1)*m.A,m.A=-m.A}else m=d.f.kb,d=d.height,m.O+=(d-1)*m.fa,m.fa=-m.fa,m.N+=(d-1>>1)*m.Ab,m.Ab=-m.Ab,m.W+=(d-1>>1)*m.Db,m.Db=-m.Db,m.F!=null&&(m.J+=(d-1)*m.lb,m.lb=-m.lb);return 0}function bo(d,m,x,C){if(C==null||0>=d||0>=m)return 2;if(x!=null){if(x.Da){var U=x.cd,$=x.bd,G=-2&x.v,Y=-2&x.j;if(0>G||0>Y||0>=U||0>=$||G+U>d||Y+$>m)return 2;d=U,m=$}if(x.da){if(!ot(d,m,U=[x.ib],$=[x.hb]))return 2;d=U[0],m=$[0]}}C.width=d,C.height=m;e:{var J=C.width,re=C.height;if(d=C.S,0>=J||0>=re||!(d>=Bh&&13>d))d=2;else{if(0>=C.Rd&&C.sd==null){G=$=U=m=0;var de=(Y=J*gy[d])*re;if(11>d||($=(re+1)/2*(m=(J+1)/2),d==12&&(G=(U=J)*re)),(re=s(de+2*$+G))==null){d=1;break e}C.sd=re,11>d?((J=C.f.RGBA).eb=re,J.fb=0,J.A=Y,J.size=de):((J=C.f.kb).y=re,J.O=0,J.fa=Y,J.Fd=de,J.f=re,J.N=0+de,J.Ab=m,J.Cd=$,J.ea=re,J.W=0+de+$,J.Db=m,J.Ed=$,d==12&&(J.F=re,J.J=0+de+2*$),J.Tc=G,J.lb=U)}if(m=1,U=C.S,$=C.width,G=C.height,U>=Bh&&13>U)if(11>U)d=C.f.RGBA,m&=(Y=Math.abs(d.A))*(G-1)+$<=d.size,m&=Y>=$*gy[U],m&=d.eb!=null;else{d=C.f.kb,Y=($+1)/2,de=(G+1)/2,J=Math.abs(d.fa),re=Math.abs(d.Ab);var we=Math.abs(d.Db),ie=Math.abs(d.lb),he=ie*(G-1)+$;m&=J*(G-1)+$<=d.Fd,m&=re*(de-1)+Y<=d.Cd,m=(m&=we*(de-1)+Y<=d.Ed)&J>=$&re>=Y&we>=Y,m&=d.y!=null,m&=d.f!=null,m&=d.ea!=null,U==12&&(m&=ie>=$,m&=he<=d.Tc,m&=d.F!=null)}else m=0;d=m?0:2}}return d!=0||x!=null&&x.fd&&(d=$u(C)),d}var Rl=64,Di=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Oi=24,wo=32,Pa=8,_o=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ce("Predictor0","PredictorAdd0"),j.Predictor0=function(){return 4278190080},j.Predictor1=function(d){return d},j.Predictor2=function(d,m,x){return m[x+0]},j.Predictor3=function(d,m,x){return m[x+1]},j.Predictor4=function(d,m,x){return m[x-1]},j.Predictor5=function(d,m,x){return nt(nt(d,m[x+1]),m[x+0])},j.Predictor6=function(d,m,x){return nt(d,m[x-1])},j.Predictor7=function(d,m,x){return nt(d,m[x+0])},j.Predictor8=function(d,m,x){return nt(m[x-1],m[x+0])},j.Predictor9=function(d,m,x){return nt(m[x+0],m[x+1])},j.Predictor10=function(d,m,x){return nt(nt(d,m[x-1]),nt(m[x+0],m[x+1]))},j.Predictor11=function(d,m,x){var C=m[x+0];return 0>=tt(C>>24&255,d>>24&255,(m=m[x-1])>>24&255)+tt(C>>16&255,d>>16&255,m>>16&255)+tt(C>>8&255,d>>8&255,m>>8&255)+tt(255&C,255&d,255&m)?C:d},j.Predictor12=function(d,m,x){var C=m[x+0];return(Bt((d>>24&255)+(C>>24&255)-((m=m[x-1])>>24&255))<<24|Bt((d>>16&255)+(C>>16&255)-(m>>16&255))<<16|Bt((d>>8&255)+(C>>8&255)-(m>>8&255))<<8|Bt((255&d)+(255&C)-(255&m)))>>>0},j.Predictor13=function(d,m,x){var C=m[x-1];return(Nt((d=nt(d,m[x+0]))>>24&255,C>>24&255)<<24|Nt(d>>16&255,C>>16&255)<<16|Nt(d>>8&255,C>>8&255)<<8|Nt(255&d,255&C))>>>0};var Hu=j.PredictorAdd0;j.PredictorAdd1=Tt,Ce("Predictor2","PredictorAdd2"),Ce("Predictor3","PredictorAdd3"),Ce("Predictor4","PredictorAdd4"),Ce("Predictor5","PredictorAdd5"),Ce("Predictor6","PredictorAdd6"),Ce("Predictor7","PredictorAdd7"),Ce("Predictor8","PredictorAdd8"),Ce("Predictor9","PredictorAdd9"),Ce("Predictor10","PredictorAdd10"),Ce("Predictor11","PredictorAdd11"),Ce("Predictor12","PredictorAdd12"),Ce("Predictor13","PredictorAdd13");var Nc=j.PredictorAdd2;at("ColorIndexInverseTransform","MapARGB","32b",function(d){return d>>8&255},function(d){return d}),at("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(d){return d},function(d){return d>>8&255});var Jn,Fh=j.ColorIndexInverseTransform,Zs=j.MapARGB,ea=j.VP8LColorIndexInverseTransformAlpha,Wu=j.MapAlpha,Gu=j.VP8LPredictorsAdd=[];Gu.length=16,(j.VP8LPredictors=[]).length=16,(j.VP8LPredictorsAdd_C=[]).length=16,(j.VP8LPredictors_C=[]).length=16;var Ku,Yu,No,Ao,So,Dl,Eo,Ol,is,ta,rn,mn,Zn,fr,La,Qu,Ac,Vh,H2,W2,G2,K2,Y2,Q2,Xu,X2,J2,Z2,ey=s(511),ty=s(2041),ny=s(225),ry=s(767),iy=0,Jm=ty,Uh=ny,Mi=ry,ss=ey,Bh=0,qh=1,sy=2,zh=3,$h=4,Zm=5,ay=6,eg=7,tg=8,Hh=9,ng=10,XA=[2,3,7],JA=[3,3,11],oy=[280,256,256,256,40],ZA=[0,1,1,1,0],eS=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],tS=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],nS=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],rS=8,rg=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ig=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ju=null,iS=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],sS=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ly=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],aS=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],oS=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],lS=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],cS=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],To=[],Ns=[],Ra=[],uS=1,cy=2,Co=[],as=[];Cr("UpsampleRgbLinePair",Q,3),Cr("UpsampleBgrLinePair",ge,3),Cr("UpsampleRgbaLinePair",Mt,4),Cr("UpsampleBgraLinePair",Vn,4),Cr("UpsampleArgbLinePair",qt,4),Cr("UpsampleRgba4444LinePair",Fe,2),Cr("UpsampleRgb565LinePair",_e,2);var dS=j.UpsampleRgbLinePair,hS=j.UpsampleBgrLinePair,uy=j.UpsampleRgbaLinePair,dy=j.UpsampleBgraLinePair,hy=j.UpsampleArgbLinePair,fy=j.UpsampleRgba4444LinePair,fS=j.UpsampleRgb565LinePair,Wh=16,Gh=1<<Wh-1,Zu=-227,sg=482,pS=6,py=0,mS=s(256),gS=s(256),vS=s(256),yS=s(256),xS=s(sg-Zu),bS=s(sg-Zu);xn("YuvToRgbRow",Q,3),xn("YuvToBgrRow",ge,3),xn("YuvToRgbaRow",Mt,4),xn("YuvToBgraRow",Vn,4),xn("YuvToArgbRow",qt,4),xn("YuvToRgba4444Row",Fe,2),xn("YuvToRgb565Row",_e,2);var my=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Kh=[0,2,8],wS=[8,7,6,4,4,2,2,2,1,1,1,1],_S=1;this.WebPDecodeRGBA=function(d,m,x,C,U){var $=qh,G=new pe,Y=new en;G.ba=Y,Y.S=$,Y.width=[Y.width],Y.height=[Y.height];var J=Y.width,re=Y.height,de=new pt;if(de==null||d==null)var we=2;else e(de!=null),we=_s(d,m,x,de.width,de.height,de.Pd,de.Qd,de.format,null);if(we!=0?J=0:(J!=null&&(J[0]=de.width[0]),re!=null&&(re[0]=de.height[0]),J=1),J){Y.width=Y.width[0],Y.height=Y.height[0],C!=null&&(C[0]=Y.width),U!=null&&(U[0]=Y.height);e:{if(C=new Hs,(U=new Se).data=d,U.w=m,U.ha=x,U.kd=1,m=[0],e(U!=null),((d=_s(U.data,U.w,U.ha,null,null,null,m,null,U))==0||d==7)&&m[0]&&(d=4),(m=d)==0){if(e(G!=null),C.data=U.data,C.w=U.w+U.offset,C.ha=U.ha-U.offset,C.put=ut,C.ac=Br,C.bc=Nn,C.ma=G,U.xa){if((d=qs())==null){G=1;break e}if(function(ie,he){var ve=[0],Ae=[0],be=[0];t:for(;;){if(ie==null)return 0;if(he==null)return ie.a=2,0;if(ie.l=he,ie.a=0,ee(ie.m,he.data,he.w,he.ha),!es(ie.m,ve,Ae,be)){ie.a=3;break t}if(ie.xb=cy,he.width=ve[0],he.height=Ae[0],!Ii(ve[0],Ae[0],1,ie,null))break t;return 1}return e(ie.a!=0),0}(d,C)){if(C=(m=bo(C.width,C.height,G.Oa,G.ba))==0){t:{C=d;n:for(;;){if(C==null){C=0;break t}if(e(C.s.yc!=null),e(C.s.Ya!=null),e(0<C.s.Wb),e((x=C.l)!=null),e((U=x.ma)!=null),C.xb!=0){if(C.ca=U.ba,C.tb=U.tb,e(C.ca!=null),!zu(U.Oa,x,zh)){C.a=2;break n}if(!vs(C,x.width)||x.da)break n;if((x.da||At(C.ca.S))&&yn(),11>C.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),C.ca.f.kb.F!=null&&yn()),C.Pb&&0<C.s.ua&&C.s.vb.X==null&&!se(C.s.vb,C.s.Wa.Xa)){C.a=1;break n}C.xb=0}if(!zr(C,C.V,C.Ba,C.c,C.i,x.o,Bs))break n;U.Dc=C.Ma,C=1;break t}e(C.a!=0),C=0}C=!C}C&&(m=d.a)}else m=d.a}else{if((d=new Al)==null){G=1;break e}if(d.Fa=U.na,d.P=U.P,d.qc=U.Sa,bc(d,C)){if((m=bo(C.width,C.height,G.Oa,G.ba))==0){if(d.Aa=0,x=G.Oa,e((U=d)!=null),x!=null){if(0<(J=0>(J=x.Md)?0:100<J?255:255*J/100)){for(re=de=0;4>re;++re)12>(we=U.pb[re]).lc&&(we.ia=J*wS[0>we.lc?0:we.lc]>>3),de|=we.ia;de&&(alert("todo:VP8InitRandom"),U.ia=1)}U.Ga=x.Id,100<U.Ga?U.Ga=100:0>U.Ga&&(U.Ga=0)}(function(ie,he){if(ie==null)return 0;if(he==null)return On(ie,2,"NULL VP8Io parameter in VP8Decode().");if(!ie.cb&&!bc(ie,he))return 0;if(e(ie.cb),he.ac==null||he.ac(he)){he.ob&&(ie.L=0);var ve=Kh[ie.L];if(ie.L==2?(ie.yb=0,ie.zb=0):(ie.yb=he.v-ve>>4,ie.zb=he.j-ve>>4,0>ie.yb&&(ie.yb=0),0>ie.zb&&(ie.zb=0)),ie.Va=he.o+15+ve>>4,ie.Hb=he.va+15+ve>>4,ie.Hb>ie.za&&(ie.Hb=ie.za),ie.Va>ie.Ub&&(ie.Va=ie.Ub),0<ie.L){var Ae=ie.ed;for(ve=0;4>ve;++ve){var be;if(ie.Qa.Cb){var Ee=ie.Qa.Lb[ve];ie.Qa.Fb||(Ee+=Ae.Tb)}else Ee=Ae.Tb;for(be=0;1>=be;++be){var Te=ie.gd[ve][be],Oe=Ee;if(Ae.Pc&&(Oe+=Ae.vd[0],be&&(Oe+=Ae.od[0])),0<(Oe=0>Oe?0:63<Oe?63:Oe)){var Le=Oe;0<Ae.wb&&(Le=4<Ae.wb?Le>>2:Le>>1)>9-Ae.wb&&(Le=9-Ae.wb),1>Le&&(Le=1),Te.dd=Le,Te.tc=2*Oe+Le,Te.ld=40<=Oe?2:15<=Oe?1:0}else Te.tc=0;Te.La=be}}}ve=0}else On(ie,6,"Frame setup failed"),ve=ie.a;if(ve=ve==0){if(ve){ie.$c=0,0<ie.Aa||(ie.Ic=_S);t:{ve=ie.Ic,Ae=4*(Le=ie.za);var it=32*Le,Ge=Le+1,Pt=0<ie.L?Le*(0<ie.Aa?2:1):0,Ze=(ie.Aa==2?2:1)*Le;if((Te=Ae+832+(be=3*(16*ve+Kh[ie.L])/2*it)+(Ee=ie.Fa!=null&&0<ie.Fa.length?ie.Kc.c*ie.Kc.i:0))!=Te)ve=0;else{if(Te>ie.Vb){if(ie.Vb=0,ie.Ec=s(Te),ie.Fc=0,ie.Ec==null){ve=On(ie,1,"no memory during frame initialization.");break t}ie.Vb=Te}Te=ie.Ec,Oe=ie.Fc,ie.Ac=Te,ie.Bc=Oe,Oe+=Ae,ie.Gd=a(it,_l),ie.Hd=0,ie.rb=a(Ge+1,ji),ie.sb=1,ie.wa=Pt?a(Pt,_r):null,ie.Y=0,ie.D.Nb=0,ie.D.wa=ie.wa,ie.D.Y=ie.Y,0<ie.Aa&&(ie.D.Y+=Le),e(!0),ie.oc=Te,ie.pc=Oe,Oe+=832,ie.ya=a(Ze,bl),ie.aa=0,ie.D.ya=ie.ya,ie.D.aa=ie.aa,ie.Aa==2&&(ie.D.aa+=Le),ie.R=16*Le,ie.B=8*Le,Le=(it=Kh[ie.L])*ie.R,it=it/2*ie.B,ie.sa=Te,ie.ta=Oe+Le,ie.qa=ie.sa,ie.ra=ie.ta+16*ve*ie.R+it,ie.Ha=ie.qa,ie.Ia=ie.ra+8*ve*ie.B+it,ie.$c=0,Oe+=be,ie.mb=Ee?Te:null,ie.nb=Ee?Oe:null,e(Oe+Ee<=ie.Fc+ie.Vb),Ws(ie),i(ie.Ac,ie.Bc,0,Ae),ve=1}}if(ve){if(he.ka=0,he.y=ie.sa,he.O=ie.ta,he.f=ie.qa,he.N=ie.ra,he.ea=ie.Ha,he.Vd=ie.Ia,he.fa=ie.R,he.Rc=ie.B,he.F=null,he.J=0,!iy){for(ve=-255;255>=ve;++ve)ey[255+ve]=0>ve?-ve:ve;for(ve=-1020;1020>=ve;++ve)ty[1020+ve]=-128>ve?-128:127<ve?127:ve;for(ve=-112;112>=ve;++ve)ny[112+ve]=-16>ve?-16:15<ve?15:ve;for(ve=-255;510>=ve;++ve)ry[255+ve]=0>ve?0:255<ve?255:ve;iy=1}Eo=Gs,Ol=po,ta=wc,rn=Vt,mn=Ta,is=fo,Zn=jl,fr=xo,La=v,Qu=V,Ac=rs,Vh=Pl,H2=ne,W2=oe,G2=Xs,K2=Js,Y2=yi,Q2=Il,Ns[0]=Uu,Ns[1]=El,Ns[2]=Ys,Ns[3]=Vu,Ns[4]=Bu,Ns[5]=xs,Ns[6]=Nr,Ns[7]=qu,Ns[8]=bs,Ns[9]=go,To[0]=vi,To[1]=Mu,To[2]=Fu,To[3]=Tl,To[4]=ts,To[5]=Ks,To[6]=mo,Ra[0]=ka,Ra[1]=_c,Ra[2]=vo,Ra[3]=Pi,Ra[4]=pn,Ra[5]=Cl,Ra[6]=kl,ve=1}else ve=0}ve&&(ve=function(zt,pr){for(zt.M=0;zt.M<zt.Va;++zt.M){var Lt,et=zt.Jc[zt.M&zt.Xb],ze=zt.m,er=zt;for(Lt=0;Lt<er.za;++Lt){var jt=ze,Kt=er,An=Kt.Ac,Ir=Kt.Bc+4*Lt,li=Kt.zc,Wn=Kt.ya[Kt.aa+Lt];if(Kt.Qa.Bb?Wn.$b=xe(jt,Kt.Pa.jb[0])?2+xe(jt,Kt.Pa.jb[2]):xe(jt,Kt.Pa.jb[1]):Wn.$b=0,Kt.kc&&(Wn.Ad=xe(jt,Kt.Bd)),Wn.Za=!xe(jt,145)+0,Wn.Za){var Hr=Wn.Ob,ci=0;for(Kt=0;4>Kt;++Kt){var mr,Qt=li[0+Kt];for(mr=0;4>mr;++mr){Qt=oS[An[Ir+mr]][Qt];for(var ln=ly[xe(jt,Qt[0])];0<ln;)ln=ly[2*ln+xe(jt,Qt[ln])];Qt=-ln,An[Ir+mr]=Qt}r(Hr,ci,An,Ir,4),ci+=4,li[0+Kt]=Qt}}else Qt=xe(jt,156)?xe(jt,128)?1:3:xe(jt,163)?2:0,Wn.Ob[0]=Qt,i(An,Ir,Qt,4),i(li,0,Qt,4);Wn.Dd=xe(jt,142)?xe(jt,114)?xe(jt,183)?1:3:2:0}if(er.m.Ka)return On(zt,7,"Premature end-of-partition0 encountered.");for(;zt.ja<zt.za;++zt.ja){if(er=et,jt=(ze=zt).rb[ze.sb-1],An=ze.rb[ze.sb+ze.ja],Lt=ze.ya[ze.aa+ze.ja],Ir=ze.kc?Lt.Ad:0)jt.la=An.la=0,Lt.Za||(jt.Na=An.Na=0),Lt.Hc=0,Lt.Gc=0,Lt.ia=0;else{var Gn,cn;if(jt=An,An=er,Ir=ze.Pa.Xc,li=ze.ya[ze.aa+ze.ja],Wn=ze.pb[li.$b],Kt=li.ad,Hr=0,ci=ze.rb[ze.sb-1],Qt=mr=0,i(Kt,Hr,0,384),li.Za)var jr=0,As=Ir[3];else{ln=s(16);var tr=jt.Na+ci.Na;if(tr=Ju(An,Ir[1],tr,Wn.Eb,0,ln,0),jt.Na=ci.Na=(0<tr)+0,1<tr)Eo(ln,0,Kt,Hr);else{var xi=ln[0]+3>>3;for(ln=0;256>ln;ln+=16)Kt[Hr+ln]=xi}jr=1,As=Ir[0]}var gn=15&jt.la,gr=15&ci.la;for(ln=0;4>ln;++ln){var Fi=1&gr;for(xi=cn=0;4>xi;++xi)gn=gn>>1|(Fi=(tr=Ju(An,As,tr=Fi+(1&gn),Wn.Sc,jr,Kt,Hr))>jr)<<7,cn=cn<<2|(3<tr?3:1<tr?2:Kt[Hr+0]!=0),Hr+=16;gn>>=4,gr=gr>>1|Fi<<7,mr=(mr<<8|cn)>>>0}for(As=gn,jr=gr>>4,Gn=0;4>Gn;Gn+=2){for(cn=0,gn=jt.la>>4+Gn,gr=ci.la>>4+Gn,ln=0;2>ln;++ln){for(Fi=1&gr,xi=0;2>xi;++xi)tr=Fi+(1&gn),gn=gn>>1|(Fi=0<(tr=Ju(An,Ir[2],tr,Wn.Qc,0,Kt,Hr)))<<3,cn=cn<<2|(3<tr?3:1<tr?2:Kt[Hr+0]!=0),Hr+=16;gn>>=2,gr=gr>>1|Fi<<5}Qt|=cn<<4*Gn,As|=gn<<4<<Gn,jr|=(240&gr)<<Gn}jt.la=As,ci.la=jr,li.Hc=mr,li.Gc=Qt,li.ia=43690&Qt?0:Wn.ia,Ir=!(mr|Qt)}if(0<ze.L&&(ze.wa[ze.Y+ze.ja]=ze.gd[Lt.$b][Lt.Za],ze.wa[ze.Y+ze.ja].La|=!Ir),er.Ka)return On(zt,7,"Premature end-of-file encountered.")}if(Ws(zt),ze=pr,er=1,Lt=(et=zt).D,jt=0<et.L&&et.M>=et.zb&&et.M<=et.Va,et.Aa==0)t:{if(Lt.M=et.M,Lt.uc=jt,kr(et,Lt),er=1,Lt=(cn=et.D).Nb,jt=(Qt=Kh[et.L])*et.R,An=Qt/2*et.B,ln=16*Lt*et.R,xi=8*Lt*et.B,Ir=et.sa,li=et.ta-jt+ln,Wn=et.qa,Kt=et.ra-An+xi,Hr=et.Ha,ci=et.Ia-An+xi,gr=(gn=cn.M)==0,mr=gn>=et.Va-1,et.Aa==2&&kr(et,cn),cn.uc)for(Fi=(tr=et).D.M,e(tr.D.uc),cn=tr.yb;cn<tr.Hb;++cn){jr=cn,As=Fi;var ui=(Vi=(Pr=tr).D).Nb;Gn=Pr.R;var Vi=Vi.wa[Vi.Y+jr],Ui=Pr.sa,bi=Pr.ta+16*ui*Gn+16*jr,Bi=Vi.dd,bn=Vi.tc;if(bn!=0)if(e(3<=bn),Pr.L==1)0<jr&&K2(Ui,bi,Gn,bn+4),Vi.La&&Q2(Ui,bi,Gn,bn),0<As&&G2(Ui,bi,Gn,bn+4),Vi.La&&Y2(Ui,bi,Gn,bn);else{var qi=Pr.B,Ss=Pr.qa,Ml=Pr.ra+8*ui*qi+8*jr,Da=Pr.Ha,Pr=Pr.Ia+8*ui*qi+8*jr;ui=Vi.ld,0<jr&&(fr(Ui,bi,Gn,bn+4,Bi,ui),Qu(Ss,Ml,Da,Pr,qi,bn+4,Bi,ui)),Vi.La&&(Vh(Ui,bi,Gn,bn,Bi,ui),W2(Ss,Ml,Da,Pr,qi,bn,Bi,ui)),0<As&&(Zn(Ui,bi,Gn,bn+4,Bi,ui),La(Ss,Ml,Da,Pr,qi,bn+4,Bi,ui)),Vi.La&&(Ac(Ui,bi,Gn,bn,Bi,ui),H2(Ss,Ml,Da,Pr,qi,bn,Bi,ui))}}if(et.ia&&alert("todo:DitherRow"),ze.put!=null){if(cn=16*gn,gn=16*(gn+1),gr?(ze.y=et.sa,ze.O=et.ta+ln,ze.f=et.qa,ze.N=et.ra+xi,ze.ea=et.Ha,ze.W=et.Ia+xi):(cn-=Qt,ze.y=Ir,ze.O=li,ze.f=Wn,ze.N=Kt,ze.ea=Hr,ze.W=ci),mr||(gn-=Qt),gn>ze.o&&(gn=ze.o),ze.F=null,ze.J=null,et.Fa!=null&&0<et.Fa.length&&cn<gn&&(ze.J=Mn(et,ze,cn,gn-cn),ze.F=et.mb,ze.F==null&&ze.F.length==0)){er=On(et,3,"Could not decode alpha data.");break t}cn<ze.j&&(Qt=ze.j-cn,cn=ze.j,e(!(1&Qt)),ze.O+=et.R*Qt,ze.N+=et.B*(Qt>>1),ze.W+=et.B*(Qt>>1),ze.F!=null&&(ze.J+=ze.width*Qt)),cn<gn&&(ze.O+=ze.v,ze.N+=ze.v>>1,ze.W+=ze.v>>1,ze.F!=null&&(ze.J+=ze.v),ze.ka=cn-ze.j,ze.U=ze.va-ze.v,ze.T=gn-cn,er=ze.put(ze))}Lt+1!=et.Ic||mr||(r(et.sa,et.ta-jt,Ir,li+16*et.R,jt),r(et.qa,et.ra-An,Wn,Kt+8*et.B,An),r(et.Ha,et.Ia-An,Hr,ci+8*et.B,An))}if(!er)return On(zt,6,"Output aborted.")}return 1}(ie,he)),he.bc!=null&&he.bc(he),ve&=1}return ve?(ie.cb=0,ve):0})(d,C)||(m=d.a)}}else m=d.a}m==0&&G.Oa!=null&&G.Oa.fd&&(m=$u(G.ba))}G=m}$=G!=0?null:11>$?Y.f.RGBA.eb:Y.f.kb.y}else $=null;return $};var gy=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(j,S){for(var N="",w=0;w<4;w++)N+=String.fromCharCode(j[S++]);return N}function f(j,S){return j[S+0]|j[S+1]<<8}function g(j,S){return(j[S+0]|j[S+1]<<8|j[S+2]<<16)>>>0}function y(j,S){return(j[S+0]|j[S+1]<<8|j[S+2]<<16|j[S+3]<<24)>>>0}new c;var p=[0],T=[0],E=[],P=new c,A=t,L=function(j,S){var N={},w=0,k=!1,H=0,D=0;if(N.frames=[],!function(_,z){for(var O=0;O<4;O++)if(_[z+O]!="RIFF".charCodeAt(O))return!0;return!1}(j,S)){for(y(j,S+=4),S+=8;S<j.length;){var W=u(j,S),K=y(j,S+=4);S+=4;var q=K+(1&K);switch(W){case"VP8 ":case"VP8L":N.frames[w]===void 0&&(N.frames[w]={}),(ce=N.frames[w]).src_off=k?D:S-8,ce.src_size=H+K+8,w++,k&&(k=!1,H=0,D=0);break;case"VP8X":(ce=N.header={}).feature_flags=j[S];var ee=S+4;ce.canvas_width=1+g(j,ee),ee+=3,ce.canvas_height=1+g(j,ee),ee+=3;break;case"ALPH":k=!0,H=q+8,D=S-8;break;case"ANIM":(ce=N.header).bgcolor=y(j,S),ee=S+4,ce.loop_count=f(j,ee),ee+=2;break;case"ANMF":var ue,ce;(ce=N.frames[w]={}).offset_x=2*g(j,S),S+=3,ce.offset_y=2*g(j,S),S+=3,ce.width=1+g(j,S),S+=3,ce.height=1+g(j,S),S+=3,ce.duration=g(j,S),S+=3,ue=j[S++],ce.dispose=1&ue,ce.blend=ue>>1&1}W!="ANMF"&&(S+=q)}return N}}(A,0);L.response=A,L.rgbaoutput=!0,L.dataurl=!1;var M=L.header?L.header:null,F=L.frames?L.frames:null;if(M){M.loop_counter=M.loop_count,p=[M.canvas_height],T=[M.canvas_width];for(var te=0;te<F.length&&F[te].blend!=0;te++);}var ae=F[0],B=P.WebPDecodeRGBA(A,ae.src_off,ae.src_size,T,p);ae.rgba=B,ae.imgwidth=T[0],ae.imgheight=p[0];for(var I=0;I<T[0]*p[0]*4;I++)E[I]=B[I];return this.width=T,this.height=p,this.data=E,this}(function(t){var e,n,r,i,s,a,l,c,u,f=function(_){return _=_||{},this.isStrokeTransparent=_.isStrokeTransparent||!1,this.strokeOpacity=_.strokeOpacity||1,this.strokeStyle=_.strokeStyle||"#000000",this.fillStyle=_.fillStyle||"#000000",this.isFillTransparent=_.isFillTransparent||!1,this.fillOpacity=_.fillOpacity||1,this.font=_.font||"10px sans-serif",this.textBaseline=_.textBaseline||"alphabetic",this.textAlign=_.textAlign||"left",this.lineWidth=_.lineWidth||1,this.lineJoin=_.lineJoin||"miter",this.lineCap=_.lineCap||"butt",this.path=_.path||[],this.transform=_.transform!==void 0?_.transform.clone():new c,this.globalCompositeOperation=_.globalCompositeOperation||"normal",this.globalAlpha=_.globalAlpha||1,this.clip_path=_.clip_path||[],this.currentPoint=_.currentPoint||new a,this.miterLimit=_.miterLimit||10,this.lastPoint=_.lastPoint||new a,this.lineDashOffset=_.lineDashOffset||0,this.lineDash=_.lineDash||[],this.margin=_.margin||[0,0,0,0],this.prevPageLastElemOffset=_.prevPageLastElemOffset||0,this.ignoreClearRect=typeof _.ignoreClearRect!="boolean"||_.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new g(this),e=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,a=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new f}]);var g=function(_){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var z=_;Object.defineProperty(this,"pdf",{get:function(){return z}});var O=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return O},set:function(Ne){O=!!Ne}});var X=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return X},set:function(Ne){X=!!Ne}});var Z=0;Object.defineProperty(this,"posX",{get:function(){return Z},set:function(Ne){isNaN(Ne)||(Z=Ne)}});var le=0;Object.defineProperty(this,"posY",{get:function(){return le},set:function(Ne){isNaN(Ne)||(le=Ne)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(Ne){var se;typeof Ne=="number"?se=[Ne,Ne,Ne,Ne]:((se=new Array(4))[0]=Ne[0],se[1]=Ne.length>=2?Ne[1]:se[0],se[2]=Ne.length>=3?Ne[2]:se[0],se[3]=Ne.length>=4?Ne[3]:se[1]),u.margin=se}});var me=!1;Object.defineProperty(this,"autoPaging",{get:function(){return me},set:function(Ne){me=Ne}});var ye=0;Object.defineProperty(this,"lastBreak",{get:function(){return ye},set:function(Ne){ye=Ne}});var xe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return xe},set:function(Ne){xe=Ne}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(Ne){Ne instanceof f&&(u=Ne)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(Ne){u.path=Ne}});var ke=[];Object.defineProperty(this,"ctxStack",{get:function(){return ke},set:function(Ne){ke=Ne}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Ne){var se;se=y(Ne),this.ctx.fillStyle=se.style,this.ctx.isFillTransparent=se.a===0,this.ctx.fillOpacity=se.a,this.pdf.setFillColor(se.r,se.g,se.b,{a:se.a}),this.pdf.setTextColor(se.r,se.g,se.b,{a:se.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Ne){var se=y(Ne);this.ctx.strokeStyle=se.style,this.ctx.isStrokeTransparent=se.a===0,this.ctx.strokeOpacity=se.a,se.a===0?this.pdf.setDrawColor(255,255,255):(se.a,this.pdf.setDrawColor(se.r,se.g,se.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Ne){["butt","round","square"].indexOf(Ne)!==-1&&(this.ctx.lineCap=Ne,this.pdf.setLineCap(Ne))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Ne){isNaN(Ne)||(this.ctx.lineWidth=Ne,this.pdf.setLineWidth(Ne))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Ne){["bevel","round","miter"].indexOf(Ne)!==-1&&(this.ctx.lineJoin=Ne,this.pdf.setLineJoin(Ne))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Ne){isNaN(Ne)||(this.ctx.miterLimit=Ne,this.pdf.setMiterLimit(Ne))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Ne){this.ctx.textBaseline=Ne}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Ne){["right","end","center","left","start"].indexOf(Ne)!==-1&&(this.ctx.textAlign=Ne)}});var Ve=null,Ue=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ue},set:function(Ne){Ve=null,Ue=Ne}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Ne){var se;if(this.ctx.font=Ne,(se=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Ne))!==null){var yt=se[1];se[2];var Ye=se[3],ot=se[4];se[5];var De=se[6],je=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ot)[2];ot=Math.floor(je==="px"?parseFloat(ot)*this.pdf.internal.scaleFactor:je==="em"?parseFloat(ot)*this.pdf.getFontSize():parseFloat(ot)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ot);var Ce=function(ft){var at,Jt,Wt=[],Je=ft.trim();if(Je==="")return v0;if(Je in iw)return[iw[Je]];for(;Je!=="";){switch(Jt=null,at=(Je=aw(Je)).charAt(0)){case'"':case"'":Jt=kD(Je.substring(1),at);break;default:Jt=ID(Je)}if(Jt===null||(Wt.push(Jt[0]),(Je=aw(Jt[1]))!==""&&Je.charAt(0)!==","))return v0;Je=Je.replace(/^,/,"")}return Wt}(De);if(this.fontFaces){var Et=function(ft,at){if(Ve===null){var Jt=function(Wt){var Je=[];return Object.keys(Wt).forEach(function(bt){Wt[bt].forEach(function(sn){var dt=null;switch(sn){case"bold":dt={family:bt,weight:"bold"};break;case"italic":dt={family:bt,style:"italic"};break;case"bolditalic":dt={family:bt,weight:"bold",style:"italic"};break;case"":case"normal":dt={family:bt}}dt!==null&&(dt.ref={name:bt,style:sn},Je.push(dt))})}),Je}(ft.getFontList());Ve=function(Wt){for(var Je={},bt=0;bt<Wt.length;++bt){var sn=g0(Wt[bt]),dt=sn.family,Rt=sn.stretch,At=sn.style,In=sn.weight;Je[dt]=Je[dt]||{},Je[dt][Rt]=Je[dt][Rt]||{},Je[dt][Rt][At]=Je[dt][Rt][At]||{},Je[dt][Rt][At][In]=sn}return Je}(Jt.concat(at))}return Ve}(this.pdf,this.fontFaces),nt=Ce.map(function(ft){return{family:ft,stretch:"normal",weight:Ye,style:yt}}),Bt=function(ft,at,Jt){for(var Wt=(Jt=Jt||{}).defaultFontFamily||"times",Je=Object.assign({},CD,Jt.genericFontFamilies||{}),bt=null,sn=null,dt=0;dt<at.length;++dt)if(Je[(bt=g0(at[dt])).family]&&(bt.family=Je[bt.family]),ft.hasOwnProperty(bt.family)){sn=ft[bt.family];break}if(!(sn=sn||ft[Wt]))throw new Error("Could not find a font-family for the rule '"+sw(bt)+"' and default family '"+Wt+"'.");if(sn=function(Rt,At){if(At[Rt])return At[Rt];var In=K1[Rt],_n=In<=K1.normal?-1:1,en=rw(At,$A,In,_n);if(!en)throw new Error("Could not find a matching font-stretch value for "+Rt);return en}(bt.stretch,sn),sn=function(Rt,At){if(At[Rt])return At[Rt];for(var In=zA[Rt],_n=0;_n<In.length;++_n)if(At[In[_n]])return At[In[_n]];throw new Error("Could not find a matching font-style for "+Rt)}(bt.style,sn),!(sn=function(Rt,At){if(At[Rt])return At[Rt];if(Rt===400&&At[500])return At[500];if(Rt===500&&At[400])return At[400];var In=TD[Rt],_n=rw(At,HA,In,Rt<400?-1:1);if(!_n)throw new Error("Could not find a matching font-weight for value "+Rt);return _n}(bt.weight,sn)))throw new Error("Failed to resolve a font for the rule '"+sw(bt)+"'.");return sn}(Et,nt);this.pdf.setFont(Bt.ref.name,Bt.ref.style)}else{var Nt="";(Ye==="bold"||parseInt(Ye,10)>=700||yt==="bold")&&(Nt="bold"),yt==="italic"&&(Nt+="italic"),Nt.length===0&&(Nt="normal");for(var tt="",Tt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},xt=0;xt<Ce.length;xt++){if(this.pdf.internal.getFont(Ce[xt],Nt,{noFallback:!0,disableWarning:!0})!==void 0){tt=Ce[xt];break}if(Nt==="bolditalic"&&this.pdf.internal.getFont(Ce[xt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)tt=Ce[xt],Nt="bold";else if(this.pdf.internal.getFont(Ce[xt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){tt=Ce[xt],Nt="normal";break}}if(tt===""){for(var rt=0;rt<Ce.length;rt++)if(Tt[Ce[rt]]){tt=Tt[Ce[rt]];break}}tt=tt===""?"Times":tt,this.pdf.setFont(tt,Nt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Ne){this.ctx.globalCompositeOperation=Ne}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Ne){this.ctx.globalAlpha=Ne}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Ne){this.ctx.lineDashOffset=Ne,ce.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Ne){this.ctx.lineDash=Ne,ce.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Ne){this.ctx.ignoreClearRect=!!Ne}})};g.prototype.setLineDash=function(_){this.lineDash=_},g.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},g.prototype.fill=function(){F.call(this,"fill",!1)},g.prototype.stroke=function(){F.call(this,"stroke",!1)},g.prototype.beginPath=function(){this.path=[{type:"begin"}]},g.prototype.moveTo=function(_,z){if(isNaN(_)||isNaN(z))throw vn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var O=this.ctx.transform.applyToPoint(new a(_,z));this.path.push({type:"mt",x:O.x,y:O.y}),this.ctx.lastPoint=new a(_,z)},g.prototype.closePath=function(){var _=new a(0,0),z=0;for(z=this.path.length-1;z!==-1;z--)if(this.path[z].type==="begin"&&dn(this.path[z+1])==="object"&&typeof this.path[z+1].x=="number"){_=new a(this.path[z+1].x,this.path[z+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(_.x,_.y)},g.prototype.lineTo=function(_,z){if(isNaN(_)||isNaN(z))throw vn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var O=this.ctx.transform.applyToPoint(new a(_,z));this.path.push({type:"lt",x:O.x,y:O.y}),this.ctx.lastPoint=new a(O.x,O.y)},g.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),F.call(this,null,!0)},g.prototype.quadraticCurveTo=function(_,z,O,X){if(isNaN(O)||isNaN(X)||isNaN(_)||isNaN(z))throw vn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Z=this.ctx.transform.applyToPoint(new a(O,X)),le=this.ctx.transform.applyToPoint(new a(_,z));this.path.push({type:"qct",x1:le.x,y1:le.y,x:Z.x,y:Z.y}),this.ctx.lastPoint=new a(Z.x,Z.y)},g.prototype.bezierCurveTo=function(_,z,O,X,Z,le){if(isNaN(Z)||isNaN(le)||isNaN(_)||isNaN(z)||isNaN(O)||isNaN(X))throw vn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var me=this.ctx.transform.applyToPoint(new a(Z,le)),ye=this.ctx.transform.applyToPoint(new a(_,z)),xe=this.ctx.transform.applyToPoint(new a(O,X));this.path.push({type:"bct",x1:ye.x,y1:ye.y,x2:xe.x,y2:xe.y,x:me.x,y:me.y}),this.ctx.lastPoint=new a(me.x,me.y)},g.prototype.arc=function(_,z,O,X,Z,le){if(isNaN(_)||isNaN(z)||isNaN(O)||isNaN(X)||isNaN(Z))throw vn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(le=!!le,!this.ctx.transform.isIdentity){var me=this.ctx.transform.applyToPoint(new a(_,z));_=me.x,z=me.y;var ye=this.ctx.transform.applyToPoint(new a(0,O)),xe=this.ctx.transform.applyToPoint(new a(0,0));O=Math.sqrt(Math.pow(ye.x-xe.x,2)+Math.pow(ye.y-xe.y,2))}Math.abs(Z-X)>=2*Math.PI&&(X=0,Z=2*Math.PI),this.path.push({type:"arc",x:_,y:z,radius:O,startAngle:X,endAngle:Z,counterclockwise:le})},g.prototype.arcTo=function(_,z,O,X,Z){throw new Error("arcTo not implemented.")},g.prototype.rect=function(_,z,O,X){if(isNaN(_)||isNaN(z)||isNaN(O)||isNaN(X))throw vn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(_,z),this.lineTo(_+O,z),this.lineTo(_+O,z+X),this.lineTo(_,z+X),this.lineTo(_,z),this.lineTo(_+O,z),this.lineTo(_,z)},g.prototype.fillRect=function(_,z,O,X){if(isNaN(_)||isNaN(z)||isNaN(O)||isNaN(X))throw vn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var Z={};this.lineCap!=="butt"&&(Z.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Z.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(_,z,O,X),this.fill(),Z.hasOwnProperty("lineCap")&&(this.lineCap=Z.lineCap),Z.hasOwnProperty("lineJoin")&&(this.lineJoin=Z.lineJoin)}},g.prototype.strokeRect=function(_,z,O,X){if(isNaN(_)||isNaN(z)||isNaN(O)||isNaN(X))throw vn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");T.call(this)||(this.beginPath(),this.rect(_,z,O,X),this.stroke())},g.prototype.clearRect=function(_,z,O,X){if(isNaN(_)||isNaN(z)||isNaN(O)||isNaN(X))throw vn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(_,z,O,X))},g.prototype.save=function(_){_=typeof _!="boolean"||_;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,O=0;O<this.pdf.internal.getNumberOfPages();O++)this.pdf.setPage(O+1),this.pdf.internal.out("q");if(this.pdf.setPage(z),_){this.ctx.fontSize=this.pdf.internal.getFontSize();var X=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=X}},g.prototype.restore=function(_){_=typeof _!="boolean"||_;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,O=0;O<this.pdf.internal.getNumberOfPages();O++)this.pdf.setPage(O+1),this.pdf.internal.out("Q");this.pdf.setPage(z),_&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},g.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var y=function(_){var z,O,X,Z;if(_.isCanvasGradient===!0&&(_=_.getColor()),!_)return{r:0,g:0,b:0,a:0,style:_};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(_))z=0,O=0,X=0,Z=0;else{var le=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(_);if(le!==null)z=parseInt(le[1]),O=parseInt(le[2]),X=parseInt(le[3]),Z=1;else if((le=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(_))!==null)z=parseInt(le[1]),O=parseInt(le[2]),X=parseInt(le[3]),Z=parseFloat(le[4]);else{if(Z=1,typeof _=="string"&&_.charAt(0)!=="#"){var me=new OA(_);_=me.ok?me.toHex():"#000000"}_.length===4?(z=_.substring(1,2),z+=z,O=_.substring(2,3),O+=O,X=_.substring(3,4),X+=X):(z=_.substring(1,3),O=_.substring(3,5),X=_.substring(5,7)),z=parseInt(z,16),O=parseInt(O,16),X=parseInt(X,16)}}return{r:z,g:O,b:X,a:Z,style:_}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},T=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};g.prototype.fillText=function(_,z,O,X){if(isNaN(z)||isNaN(O)||typeof _!="string")throw vn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(X=isNaN(X)?void 0:X,!p.call(this)){var Z=q(this.ctx.transform.rotation),le=this.ctx.transform.scaleX;w.call(this,{text:_,x:z,y:O,scale:le,angle:Z,align:this.textAlign,maxWidth:X})}},g.prototype.strokeText=function(_,z,O,X){if(isNaN(z)||isNaN(O)||typeof _!="string")throw vn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!T.call(this)){X=isNaN(X)?void 0:X;var Z=q(this.ctx.transform.rotation),le=this.ctx.transform.scaleX;w.call(this,{text:_,x:z,y:O,scale:le,renderingMode:"stroke",angle:Z,align:this.textAlign,maxWidth:X})}},g.prototype.measureText=function(_){if(typeof _!="string")throw vn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var z=this.pdf,O=this.pdf.internal.scaleFactor,X=z.internal.getFontSize(),Z=z.getStringUnitWidth(_)*X/z.internal.scaleFactor;return new function(le){var me=(le=le||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return me}}),this}({width:Z*=Math.round(96*O/72*1e4)/1e4})},g.prototype.scale=function(_,z){if(isNaN(_)||isNaN(z))throw vn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var O=new c(_,0,0,z,0,0);this.ctx.transform=this.ctx.transform.multiply(O)},g.prototype.rotate=function(_){if(isNaN(_))throw vn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var z=new c(Math.cos(_),Math.sin(_),-Math.sin(_),Math.cos(_),0,0);this.ctx.transform=this.ctx.transform.multiply(z)},g.prototype.translate=function(_,z){if(isNaN(_)||isNaN(z))throw vn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var O=new c(1,0,0,1,_,z);this.ctx.transform=this.ctx.transform.multiply(O)},g.prototype.transform=function(_,z,O,X,Z,le){if(isNaN(_)||isNaN(z)||isNaN(O)||isNaN(X)||isNaN(Z)||isNaN(le))throw vn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var me=new c(_,z,O,X,Z,le);this.ctx.transform=this.ctx.transform.multiply(me)},g.prototype.setTransform=function(_,z,O,X,Z,le){_=isNaN(_)?1:_,z=isNaN(z)?0:z,O=isNaN(O)?0:O,X=isNaN(X)?1:X,Z=isNaN(Z)?0:Z,le=isNaN(le)?0:le,this.ctx.transform=new c(_,z,O,X,Z,le)};var E=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};g.prototype.drawImage=function(_,z,O,X,Z,le,me,ye,xe){var ke=this.pdf.getImageProperties(_),Ve=1,Ue=1,Ne=1,se=1;X!==void 0&&ye!==void 0&&(Ne=ye/X,se=xe/Z,Ve=ke.width/X*ye/X,Ue=ke.height/Z*xe/Z),le===void 0&&(le=z,me=O,z=0,O=0),X!==void 0&&ye===void 0&&(ye=X,xe=Z),X===void 0&&ye===void 0&&(ye=ke.width,xe=ke.height);for(var yt,Ye=this.ctx.transform.decompose(),ot=q(Ye.rotate.shx),De=new c,je=(De=(De=(De=De.multiply(Ye.translate)).multiply(Ye.skew)).multiply(Ye.scale)).applyToRectangle(new l(le-z*Ne,me-O*se,X*Ve,Z*Ue)),Ce=P.call(this,je),Et=[],nt=0;nt<Ce.length;nt+=1)Et.indexOf(Ce[nt])===-1&&Et.push(Ce[nt]);if(M(Et),this.autoPaging)for(var Bt=Et[0],Nt=Et[Et.length-1],tt=Bt;tt<Nt+1;tt++){this.pdf.setPage(tt);var Tt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],xt=tt===1?this.posY+this.margin[0]:this.margin[0],rt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ft=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],at=tt===1?0:rt+(tt-2)*ft;if(this.ctx.clip_path.length!==0){var Jt=this.path;yt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=L(yt,this.posX+this.margin[3],-at+xt+this.ctx.prevPageLastElemOffset),te.call(this,"fill",!0),this.path=Jt}var Wt=JSON.parse(JSON.stringify(je));Wt=L([Wt],this.posX+this.margin[3],-at+xt+this.ctx.prevPageLastElemOffset)[0];var Je=(tt>Bt||tt<Nt)&&E.call(this);Je&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Tt,ft,null).clip().discardPath()),this.pdf.addImage(_,"JPEG",Wt.x,Wt.y,Wt.w,Wt.h,null,null,ot),Je&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(_,"JPEG",je.x,je.y,je.w,je.h,null,null,ot)};var P=function(_,z,O){var X=[];z=z||this.pdf.internal.pageSize.width,O=O||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Z=this.posY+this.ctx.prevPageLastElemOffset;switch(_.type){default:case"mt":case"lt":X.push(Math.floor((_.y+Z)/O)+1);break;case"arc":X.push(Math.floor((_.y+Z-_.radius)/O)+1),X.push(Math.floor((_.y+Z+_.radius)/O)+1);break;case"qct":var le=ee(this.ctx.lastPoint.x,this.ctx.lastPoint.y,_.x1,_.y1,_.x,_.y);X.push(Math.floor((le.y+Z)/O)+1),X.push(Math.floor((le.y+le.h+Z)/O)+1);break;case"bct":var me=ue(this.ctx.lastPoint.x,this.ctx.lastPoint.y,_.x1,_.y1,_.x2,_.y2,_.x,_.y);X.push(Math.floor((me.y+Z)/O)+1),X.push(Math.floor((me.y+me.h+Z)/O)+1);break;case"rect":X.push(Math.floor((_.y+Z)/O)+1),X.push(Math.floor((_.y+_.h+Z)/O)+1)}for(var ye=0;ye<X.length;ye+=1)for(;this.pdf.internal.getNumberOfPages()<X[ye];)A.call(this);return X},A=function(){var _=this.fillStyle,z=this.strokeStyle,O=this.font,X=this.lineCap,Z=this.lineWidth,le=this.lineJoin;this.pdf.addPage(),this.fillStyle=_,this.strokeStyle=z,this.font=O,this.lineCap=X,this.lineWidth=Z,this.lineJoin=le},L=function(_,z,O){for(var X=0;X<_.length;X++)switch(_[X].type){case"bct":_[X].x2+=z,_[X].y2+=O;case"qct":_[X].x1+=z,_[X].y1+=O;default:_[X].x+=z,_[X].y+=O}return _},M=function(_){return _.sort(function(z,O){return z-O})},F=function(_,z){for(var O,X,Z=this.fillStyle,le=this.strokeStyle,me=this.lineCap,ye=this.lineWidth,xe=Math.abs(ye*this.ctx.transform.scaleX),ke=this.lineJoin,Ve=JSON.parse(JSON.stringify(this.path)),Ue=JSON.parse(JSON.stringify(this.path)),Ne=[],se=0;se<Ue.length;se++)if(Ue[se].x!==void 0)for(var yt=P.call(this,Ue[se]),Ye=0;Ye<yt.length;Ye+=1)Ne.indexOf(yt[Ye])===-1&&Ne.push(yt[Ye]);for(var ot=0;ot<Ne.length;ot++)for(;this.pdf.internal.getNumberOfPages()<Ne[ot];)A.call(this);if(M(Ne),this.autoPaging)for(var De=Ne[0],je=Ne[Ne.length-1],Ce=De;Ce<je+1;Ce++){this.pdf.setPage(Ce),this.fillStyle=Z,this.strokeStyle=le,this.lineCap=me,this.lineWidth=xe,this.lineJoin=ke;var Et=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],nt=Ce===1?this.posY+this.margin[0]:this.margin[0],Bt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Nt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],tt=Ce===1?0:Bt+(Ce-2)*Nt;if(this.ctx.clip_path.length!==0){var Tt=this.path;O=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=L(O,this.posX+this.margin[3],-tt+nt+this.ctx.prevPageLastElemOffset),te.call(this,_,!0),this.path=Tt}if(X=JSON.parse(JSON.stringify(Ve)),this.path=L(X,this.posX+this.margin[3],-tt+nt+this.ctx.prevPageLastElemOffset),z===!1||Ce===0){var xt=(Ce>De||Ce<je)&&E.call(this);xt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Et,Nt,null).clip().discardPath()),te.call(this,_,z),xt&&this.pdf.restoreGraphicsState()}this.lineWidth=ye}else this.lineWidth=xe,te.call(this,_,z),this.lineWidth=ye;this.path=Ve},te=function(_,z){if((_!=="stroke"||z||!T.call(this))&&(_==="stroke"||z||!p.call(this))){for(var O,X,Z=[],le=this.path,me=0;me<le.length;me++){var ye=le[me];switch(ye.type){case"begin":Z.push({begin:!0});break;case"close":Z.push({close:!0});break;case"mt":Z.push({start:ye,deltas:[],abs:[]});break;case"lt":var xe=Z.length;if(le[me-1]&&!isNaN(le[me-1].x)&&(O=[ye.x-le[me-1].x,ye.y-le[me-1].y],xe>0)){for(;xe>=0;xe--)if(Z[xe-1].close!==!0&&Z[xe-1].begin!==!0){Z[xe-1].deltas.push(O),Z[xe-1].abs.push(ye);break}}break;case"bct":O=[ye.x1-le[me-1].x,ye.y1-le[me-1].y,ye.x2-le[me-1].x,ye.y2-le[me-1].y,ye.x-le[me-1].x,ye.y-le[me-1].y],Z[Z.length-1].deltas.push(O);break;case"qct":var ke=le[me-1].x+2/3*(ye.x1-le[me-1].x),Ve=le[me-1].y+2/3*(ye.y1-le[me-1].y),Ue=ye.x+2/3*(ye.x1-ye.x),Ne=ye.y+2/3*(ye.y1-ye.y),se=ye.x,yt=ye.y;O=[ke-le[me-1].x,Ve-le[me-1].y,Ue-le[me-1].x,Ne-le[me-1].y,se-le[me-1].x,yt-le[me-1].y],Z[Z.length-1].deltas.push(O);break;case"arc":Z.push({deltas:[],abs:[],arc:!0}),Array.isArray(Z[Z.length-1].abs)&&Z[Z.length-1].abs.push(ye)}}X=z?null:_==="stroke"?"stroke":"fill";for(var Ye=!1,ot=0;ot<Z.length;ot++)if(Z[ot].arc)for(var De=Z[ot].abs,je=0;je<De.length;je++){var Ce=De[je];Ce.type==="arc"?I.call(this,Ce.x,Ce.y,Ce.radius,Ce.startAngle,Ce.endAngle,Ce.counterclockwise,void 0,z,!Ye):k.call(this,Ce.x,Ce.y),Ye=!0}else if(Z[ot].close===!0)this.pdf.internal.out("h"),Ye=!1;else if(Z[ot].begin!==!0){var Et=Z[ot].start.x,nt=Z[ot].start.y;H.call(this,Z[ot].deltas,Et,nt),Ye=!0}X&&j.call(this,X),z&&S.call(this)}},ae=function(_){var z=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,O=z*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return _-O;case"top":return _+z-O;case"hanging":return _+z-2*O;case"middle":return _+z/2-O;default:return _}},B=function(_){return _+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};g.prototype.createLinearGradient=function(){var _=function(){};return _.colorStops=[],_.addColorStop=function(z,O){this.colorStops.push([z,O])},_.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},_.isCanvasGradient=!0,_},g.prototype.createPattern=function(){return this.createLinearGradient()},g.prototype.createRadialGradient=function(){return this.createLinearGradient()};var I=function(_,z,O,X,Z,le,me,ye,xe){for(var ke=W.call(this,O,X,Z,le),Ve=0;Ve<ke.length;Ve++){var Ue=ke[Ve];Ve===0&&(xe?N.call(this,Ue.x1+_,Ue.y1+z):k.call(this,Ue.x1+_,Ue.y1+z)),D.call(this,_,z,Ue.x2,Ue.y2,Ue.x3,Ue.y3,Ue.x4,Ue.y4)}ye?S.call(this):j.call(this,me)},j=function(_){switch(_){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},S=function(){this.pdf.clip(),this.pdf.discardPath()},N=function(_,z){this.pdf.internal.out(n(_)+" "+r(z)+" m")},w=function(_){var z;switch(_.align){case"right":case"end":z="right";break;case"center":z="center";break;default:z="left"}var O=this.pdf.getTextDimensions(_.text),X=ae.call(this,_.y),Z=B.call(this,X)-O.h,le=this.ctx.transform.applyToPoint(new a(_.x,X)),me=this.ctx.transform.decompose(),ye=new c;ye=(ye=(ye=ye.multiply(me.translate)).multiply(me.skew)).multiply(me.scale);for(var xe,ke,Ve,Ue=this.ctx.transform.applyToRectangle(new l(_.x,X,O.w,O.h)),Ne=ye.applyToRectangle(new l(_.x,Z,O.w,O.h)),se=P.call(this,Ne),yt=[],Ye=0;Ye<se.length;Ye+=1)yt.indexOf(se[Ye])===-1&&yt.push(se[Ye]);if(M(yt),this.autoPaging)for(var ot=yt[0],De=yt[yt.length-1],je=ot;je<De+1;je++){this.pdf.setPage(je);var Ce=je===1?this.posY+this.margin[0]:this.margin[0],Et=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],nt=this.pdf.internal.pageSize.height-this.margin[2],Bt=nt-this.margin[0],Nt=this.pdf.internal.pageSize.width-this.margin[1],tt=Nt-this.margin[3],Tt=je===1?0:Et+(je-2)*Bt;if(this.ctx.clip_path.length!==0){var xt=this.path;xe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=L(xe,this.posX+this.margin[3],-1*Tt+Ce),te.call(this,"fill",!0),this.path=xt}var rt=L([JSON.parse(JSON.stringify(Ne))],this.posX+this.margin[3],-Tt+Ce+this.ctx.prevPageLastElemOffset)[0];_.scale>=.01&&(ke=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ke*_.scale),Ve=this.lineWidth,this.lineWidth=Ve*_.scale);var ft=this.autoPaging!=="text";if(ft||rt.y+rt.h<=nt){if(ft||rt.y>=Ce&&rt.x<=Nt){var at=ft?_.text:this.pdf.splitTextToSize(_.text,_.maxWidth||Nt-rt.x)[0],Jt=L([JSON.parse(JSON.stringify(Ue))],this.posX+this.margin[3],-Tt+Ce+this.ctx.prevPageLastElemOffset)[0],Wt=ft&&(je>ot||je<De)&&E.call(this);Wt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],tt,Bt,null).clip().discardPath()),this.pdf.text(at,Jt.x,Jt.y,{angle:_.angle,align:z,renderingMode:_.renderingMode}),Wt&&this.pdf.restoreGraphicsState()}}else rt.y<nt&&(this.ctx.prevPageLastElemOffset+=nt-rt.y);_.scale>=.01&&(this.pdf.setFontSize(ke),this.lineWidth=Ve)}else _.scale>=.01&&(ke=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ke*_.scale),Ve=this.lineWidth,this.lineWidth=Ve*_.scale),this.pdf.text(_.text,le.x+this.posX,le.y+this.posY,{angle:_.angle,align:z,renderingMode:_.renderingMode,maxWidth:_.maxWidth}),_.scale>=.01&&(this.pdf.setFontSize(ke),this.lineWidth=Ve)},k=function(_,z,O,X){O=O||0,X=X||0,this.pdf.internal.out(n(_+O)+" "+r(z+X)+" l")},H=function(_,z,O){return this.pdf.lines(_,z,O,null,null)},D=function(_,z,O,X,Z,le,me,ye){this.pdf.internal.out([e(i(O+_)),e(s(X+z)),e(i(Z+_)),e(s(le+z)),e(i(me+_)),e(s(ye+z)),"c"].join(" "))},W=function(_,z,O,X){for(var Z=2*Math.PI,le=Math.PI/2;z>O;)z-=Z;var me=Math.abs(O-z);me<Z&&X&&(me=Z-me);for(var ye=[],xe=X?-1:1,ke=z;me>1e-5;){var Ve=ke+xe*Math.min(me,le);ye.push(K.call(this,_,ke,Ve)),me-=Math.abs(Ve-ke),ke=Ve}return ye},K=function(_,z,O){var X=(O-z)/2,Z=_*Math.cos(X),le=_*Math.sin(X),me=Z,ye=-le,xe=me*me+ye*ye,ke=xe+me*Z+ye*le,Ve=4/3*(Math.sqrt(2*xe*ke)-ke)/(me*le-ye*Z),Ue=me-Ve*ye,Ne=ye+Ve*me,se=Ue,yt=-Ne,Ye=X+z,ot=Math.cos(Ye),De=Math.sin(Ye);return{x1:_*Math.cos(z),y1:_*Math.sin(z),x2:Ue*ot-Ne*De,y2:Ue*De+Ne*ot,x3:se*ot-yt*De,y3:se*De+yt*ot,x4:_*Math.cos(O),y4:_*Math.sin(O)}},q=function(_){return 180*_/Math.PI},ee=function(_,z,O,X,Z,le){var me=_+.5*(O-_),ye=z+.5*(X-z),xe=Z+.5*(O-Z),ke=le+.5*(X-le),Ve=Math.min(_,Z,me,xe),Ue=Math.max(_,Z,me,xe),Ne=Math.min(z,le,ye,ke),se=Math.max(z,le,ye,ke);return new l(Ve,Ne,Ue-Ve,se-Ne)},ue=function(_,z,O,X,Z,le,me,ye){var xe,ke,Ve,Ue,Ne,se,yt,Ye,ot,De,je,Ce,Et,nt,Bt=O-_,Nt=X-z,tt=Z-O,Tt=le-X,xt=me-Z,rt=ye-le;for(ke=0;ke<41;ke++)ot=(yt=(Ve=_+(xe=ke/40)*Bt)+xe*((Ne=O+xe*tt)-Ve))+xe*(Ne+xe*(Z+xe*xt-Ne)-yt),De=(Ye=(Ue=z+xe*Nt)+xe*((se=X+xe*Tt)-Ue))+xe*(se+xe*(le+xe*rt-se)-Ye),ke==0?(je=ot,Ce=De,Et=ot,nt=De):(je=Math.min(je,ot),Ce=Math.min(Ce,De),Et=Math.max(Et,ot),nt=Math.max(nt,De));return new l(Math.round(je),Math.round(Ce),Math.round(Et-je),Math.round(nt-Ce))},ce=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var _,z,O=(_=this.ctx.lineDash,z=this.ctx.lineDashOffset,JSON.stringify({lineDash:_,lineDashOffset:z}));this.prevLineDash!==O&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=O)}}})(st.API),function(t){var e=function(a){var l,c,u,f,g,y,p,T,E,P;for(c=[],u=0,f=(a+=l="\0\0\0\0".slice(a.length%4||4)).length;f>u;u+=4)(g=(a.charCodeAt(u)<<24)+(a.charCodeAt(u+1)<<16)+(a.charCodeAt(u+2)<<8)+a.charCodeAt(u+3))!==0?(y=(g=((g=((g=((g=(g-(P=g%85))/85)-(E=g%85))/85)-(T=g%85))/85)-(p=g%85))/85)%85,c.push(y+33,p+33,T+33,E+33,P+33)):c.push(122);return function(A,L){for(var M=L;M>0;M--)A.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},n=function(a){var l,c,u,f,g,y=String,p="length",T=255,E="charCodeAt",P="slice",A="replace";for(a[P](-2),a=a[P](0,-2)[A](/\s/g,"")[A]("z","!!!!!"),u=[],f=0,g=(a+=l="uuuuu"[P](a[p]%5||5))[p];g>f;f+=5)c=52200625*(a[E](f)-33)+614125*(a[E](f+1)-33)+7225*(a[E](f+2)-33)+85*(a[E](f+3)-33)+(a[E](f+4)-33),u.push(T&c>>24,T&c>>16,T&c>>8,T&c);return function(L,M){for(var F=M;F>0;F--)L.pop()}(u,l[p]),y.fromCharCode.apply(y,u)},r=function(a){return a.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(a){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),l.test(a)===!1)return"";for(var c="",u=0;u<a.length;u+=2)c+=String.fromCharCode("0x"+(a[u]+a[u+1]));return c},s=function(a){for(var l=new Uint8Array(a.length),c=a.length;c--;)l[c]=a.charCodeAt(c);return(l=B1(l)).reduce(function(u,f){return u+String.fromCharCode(f)},"")};t.processDataByFilters=function(a,l){var c=0,u=a||"",f=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=n(u),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=i(u),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=r(u),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:f.reverse().join(" ")}}}(st.API),function(t){t.loadFile=function(e,n,r){return function(i,s,a){s=s!==!1,a=typeof a=="function"?a:function(){};var l=void 0;try{l=function(c,u,f){var g=new XMLHttpRequest,y=0,p=function(T){var E=T.length,P=[],A=String.fromCharCode;for(y=0;y<E;y+=1)P.push(A(255&T.charCodeAt(y)));return P.join("")};if(g.open("GET",c,!u),g.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(g.onload=function(){g.status===200?f(p(this.responseText)):f(void 0)}),g.send(null),u&&g.status===200)return p(g.responseText)}(i,s,a)}catch{}return l}(e,n,r)},t.loadImageFile=t.loadFile}(st.API),function(t){function e(){return(_t.html2canvas?Promise.resolve(_t.html2canvas):Jg(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function n(){return(_t.DOMPurify?Promise.resolve(_t.DOMPurify):Jg(()=>import("./purify.es-B6FQ9oRL.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var r=function(l){var c=dn(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},i=function(l,c){var u=document.createElement(l);for(var f in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[f]=c.style[f];return u},s=function l(c,u){for(var f=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),g=c.firstChild;g;g=g.nextSibling)u!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||f.appendChild(l(g,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(f.value=c.value),f.addEventListener("load",function(){f.scrollTop=c.scrollTop,f.scrollLeft=c.scrollLeft},!0)),f},a=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),f=l.convert(Promise.resolve(),u);return(f=f.setProgress(1,l,1,[l])).set(c)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(l,c){return l.__proto__=c||a.prototype,l},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(r(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(n).then(function(u){return this.set({src:i("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},a.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=this.opt.jsPDF,f=this.opt.fontFaces,g=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,y=Object.assign({async:!0,allowTaint:!0,scale:g,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete y.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=f,f)for(var p=0;p<f.length;++p){var T=f[p],E=T.src.find(function(P){return P.format==="truetype"});E&&u.addFont(E.url,T.ref.name,T.ref.style)}return y.windowHeight=y.windowHeight||0,y.windowHeight=y.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):y.windowHeight,u.context2d.save(!0),c(this.prop.container,y)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},a.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},a.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},a.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(l){if(r(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in a.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},a.prototype.get=function(l,c){return this.then(function(){var u=l in a.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},a.prototype.setMargin=function(l){return this.then(function(){switch(r(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},a.prototype.setPageSize=function(l){function c(u,f){return Math.floor(u*f/72*96)}return this.then(function(){(l=l||st.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},a.prototype.setProgress=function(l,c,u,f){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(l,c,u,f){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,f?this.progress.stack.concat(f):null)},a.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(f,g){return u.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(y){return u.updateProgress(null,f),y}).then(f,g).then(function(y){return u.updateProgress(1),y})})},a.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var f=this;l&&(l=l.bind(f)),c&&(c=c.bind(f));var g=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:a.convert(Object.assign({},f),Promise.prototype),y=u.call(g,l,c);return a.convert(y,f.__proto__)},a.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},a.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},a.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return a.convert(c,this)},a.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},a.prototype.error=function(l){return this.then(function(){throw new Error(l)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,st.getPageSize=function(l,c,u){if(dn(l)==="object"){var f=l;l=f.orientation,c=f.unit||c,u=f.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var g,y=(""+u).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":g=1;break;case"mm":g=72/25.4;break;case"cm":g=72/2.54;break;case"in":g=72;break;case"px":g=.75;break;case"pc":case"em":g=12;break;case"ex":g=6;break;default:throw"Invalid unit: "+c}var T,E=0,P=0;if(p.hasOwnProperty(y))E=p[y][1]/g,P=p[y][0]/g;else try{E=u[1],P=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",P>E&&(T=P,P=E,E=T);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",E>P&&(T=P,P=E,E=T)}return{width:P,height:E,unit:c,k:g,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(g0):null;var u=new a(c);return c.worker?u:u.from(l).doCallback()}}(st.API),st.API.addJS=function(t){return lw=t,this.internal.events.subscribe("postPutResources",function(){Lf=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Lf+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),ow=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+lw+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Lf!==void 0&&ow!==void 0&&this.internal.out("/Names <</JavaScript "+Lf+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=n.outline.render().split(/\r\n/),s=0;s<i.length;s++){var a=i[s],l=r.exec(a);if(l!=null){var c=l[1];n.internal.newObjectDeferredBegin(c,!1)}n.internal.write(a)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,f=[];for(s=0;s<u;s++){var g=n.internal.newObject();f.push(g);var y=n.internal.getPageInfo(s+1);n.internal.write("<< /D["+y.objId+" 0 R /XYZ null null null]>> endobj")}var p=n.internal.newObject();for(n.internal.write("<< /Names [ "),s=0;s<f.length;s++)n.internal.write("(page_"+(s+1)+")"+f[s]+" 0 R");n.internal.write(" ] >>","endobj"),e=n.internal.newObject(),n.internal.write("<< /Dests "+p+" 0 R"),n.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,i,s){var a={title:i,options:s,children:[]};return r==null&&(r=this.root),r.children.push(a),a},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<r.children.length;s++){var a=r.children[s];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(r)),s>0&&this.line("/Prev "+this.makeRef(r.children[s-1])),s<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[s+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var l=this.count=this.count_r({count:0},a);if(l>0&&this.line("/Count "+l),a.options&&a.options.pageNumber){var c=n.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<r.children.length;u++)this.renderItems(r.children[u])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,i){for(var s=0;s<i.children.length;s++)r.count++,this.count_r(r,i.children[s]);return r.count}}])}(st.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(n,r,i,s,a,l){var c,u=this.decode.DCT_DECODE,f=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=a||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,c=function(g){for(var y,p=256*g.charCodeAt(4)+g.charCodeAt(5),T=g.length,E={width:0,height:0,numcomponents:1},P=4;P<T;P+=2){if(P+=p,e.indexOf(g.charCodeAt(P+1))!==-1){y=256*g.charCodeAt(P+5)+g.charCodeAt(P+6),E={width:256*g.charCodeAt(P+7)+g.charCodeAt(P+8),height:y,numcomponents:g.charCodeAt(P+9)};break}p=256*g.charCodeAt(P+2)+g.charCodeAt(P+3)}return E}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}f={data:n,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:r,alias:i}}return f}}(st.API),st.API.processPNG=function(t,e,n,r){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var i,s=fD(t,{checkCrc:!0}),a=s.width,l=s.height,c=s.channels,u=s.palette,f=s.depth;i=u&&c===1?function(I){for(var j=I.width,S=I.height,N=I.data,w=I.palette,k=I.depth,H=!1,D=[],W=[],K=void 0,q=!1,ee=0,ue=0;ue<w.length;ue++){var ce=h5(w[ue],4),_=ce[0],z=ce[1],O=ce[2],X=ce[3];D.push(_,z,O),X!=null&&(X===0?(ee++,W.length<1&&W.push(ue)):X<255&&(q=!0))}if(q||ee>1){H=!0,W=void 0;var Z=j*S;K=new Uint8Array(Z);for(var le=new DataView(N.buffer),me=0;me<Z;me++){var ye=y0(le,me,k),xe=h5(w[ye],4)[3];K[me]=xe}}else ee===0&&(W=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:H?8:void 0,colorBytes:N,alphaBytes:K,needSMask:H,palette:D,mask:W}}(s):c===2||c===4?function(I){for(var j=I.data,S=I.width,N=I.height,w=I.channels,k=I.depth,H=w===2?"DeviceGray":"DeviceRGB",D=w-1,W=S*N,K=D,q=W*K,ee=1*W,ue=Math.ceil(q*k/8),ce=Math.ceil(ee*k/8),_=new Uint8Array(ue),z=new Uint8Array(ce),O=new DataView(j.buffer),X=new DataView(_.buffer),Z=new DataView(z.buffer),le=!1,me=0;me<W;me++){for(var ye=me*w,xe=0;xe<K;xe++)vw(X,y0(O,ye+xe,k),me*K+xe,k);var ke=y0(O,ye+K,k);ke<(1<<k)-1&&(le=!0),vw(Z,ke,1*me,k)}return{colorSpace:H,colorsPerPixel:D,sMaskBitsPerComponent:le?k:void 0,colorBytes:_,alphaBytes:z,needSMask:le}}(s):function(I){var j=I.data,S=I.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:S,colorsPerPixel:S==="DeviceGray"?1:3,colorBytes:j instanceof Uint16Array?function(N){for(var w=N.length,k=new Uint8Array(2*w),H=new DataView(k.buffer,k.byteOffset,k.byteLength),D=0;D<w;D++)H.setUint16(2*D,N[D],!1);return k}(j):j,needSMask:!1}}(s);var g,y,p,T=i,E=T.colorSpace,P=T.colorsPerPixel,A=T.sMaskBitsPerComponent,L=T.colorBytes,M=T.alphaBytes,F=T.needSMask,te=T.palette,ae=T.mask,B=null;return r!==st.API.image_compression.NONE&&typeof B1=="function"?(B=function(I){var j;switch(I){case st.API.image_compression.FAST:j=11;break;case st.API.image_compression.MEDIUM:j=13;break;case st.API.image_compression.SLOW:j=14;break;default:j=12}return j}(r),g=this.decode.FLATE_DECODE,y="/Predictor ".concat(B," /Colors ").concat(P," /BitsPerComponent ").concat(f," /Columns ").concat(a),t=hw(L,Math.ceil(a*P*f/8),P,f,r),F&&(p=hw(M,Math.ceil(a*A/8),1,A,r))):(g=void 0,y=void 0,t=L,F&&(p=M)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(p&&this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),{alias:n,data:t,index:e,filter:g,decodeParameters:y,transparency:ae,palette:te,sMask:p,predictor:B,width:a,height:l,bitsPerComponent:f,sMaskBitsPerComponent:A,colorSpace:E}}},function(t){t.processGIF89A=function(e,n,r,i){var s=new RD(e),a=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:a,height:l},f=new x0(100).encode(u,100);return t.processJPEG.call(this,f,n,r,i)},t.processGIF87A=t.processGIF89A}(st.API),Ts.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:r,blue:n,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ts.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(n){vn.log("bit decode error:"+n)}},Ts.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var s=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[a+4*l]=c.blue,this.data[a+4*l+1]=c.green,this.data[a+4*l+2]=c.red,this.data[a+4*l+3]=255}n!==0&&(this.pos+=4-n)}},Ts.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<t;i++){var s=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+2*i*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[a]=u.blue,this.data[a+1]=u.green,this.data[a+2]=u.red,this.data[a+3]=255,2*i+1>=this.width)break;u=this.palette[c],this.data[a+4]=u.blue,this.data[a+4+1]=u.green,this.data[a+4+2]=u.red,this.data[a+4+3]=255}e!==0&&(this.pos+=4-e)}},Ts.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+4*r;if(i<this.palette.length){var a=this.palette[i];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},Ts.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,l=(s>>5&e)/e*255|0,c=(s>>10&e)/e*255|0,u=s>>15?255:0,f=r*this.width*4+4*i;this.data[f]=c,this.data[f+1]=l,this.data[f+2]=a,this.data[f+3]=u}this.pos+=t}},Ts.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(a&e)/e*255|0,c=(a>>5&n)/n*255|0,u=(a>>11)/e*255|0,f=i*this.width*4+4*s;this.data[f]=u,this.data[f+1]=c,this.data[f+2]=l,this.data[f+3]=255}this.pos+=t}},Ts.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*n;this.data[a]=s,this.data[a+1]=i,this.data[a+2]=r,this.data[a+3]=255}this.pos+=this.width%4}},Ts.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*n;this.data[l]=s,this.data[l+1]=i,this.data[l+2]=r,this.data[l+3]=a}},Ts.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,n,r,i){var s=new Ts(e,!1),a=s.width,l=s.height,c={data:s.getData(),width:a,height:l},u=new x0(100).encode(c,100);return t.processJPEG.call(this,u,n,r,i)}}(st.API),xw.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,n,r,i){var s=new xw(e),a=s.width,l=s.height,c={data:s.getData(),width:a,height:l},u=new x0(100).encode(c,100);return t.processJPEG.call(this,u,n,r,i)}}(st.API),st.API.processRGBA=function(t,e,n){for(var r=t.data,i=r.length,s=new Uint8Array(i/4*3),a=new Uint8Array(i/4),l=0,c=0,u=0;u<i;u+=4){var f=r[u],g=r[u+1],y=r[u+2],p=r[u+3];s[l++]=f,s[l++]=g,s[l++]=y,a[c++]=p}var T=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:T,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},st.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},kc=st.API,Rf=kc.getCharWidthsArray=function(t,e){var n,r,i=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),a=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:i.metadata.Unicode.kerning,f=u.fof?u.fof:1,g=e.doKerning!==!1,y=0,p=t.length,T=0,E=l[0]||c,P=[];for(n=0;n<p;n++)r=t.charCodeAt(n),typeof i.metadata.widthOfString=="function"?P.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+a*(1e3/s)||0)/1e3):(y=g&&dn(u[r])==="object"&&!isNaN(parseInt(u[r][T],10))?u[r][T]/f:0,P.push((l[r]||E)/c+y)),T=r;return P},cw=kc.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return kc.processArabic&&(t=kc.processArabic(t)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(t,n,i)/n:Rf.apply(this,arguments).reduce(function(s,a){return s+a},0)},uw=function(t,e,n,r){for(var i=[],s=0,a=t.length,l=0;s!==a&&l+e[s]<n;)l+=e[s],s++;i.push(t.slice(0,s));var c=s;for(l=0;s!==a;)l+e[s]>r&&(i.push(t.slice(c,s)),l=0,c=s),l+=e[s],s++;return c!==s&&i.push(t.slice(c,s)),i},dw=function(t,e,n){n||(n={});var r,i,s,a,l,c,u,f=[],g=[f],y=n.textIndent||0,p=0,T=0,E=t.split(" "),P=Rf.apply(this,[" ",n])[0];if(c=n.lineIndent===-1?E[0].length+2:n.lineIndent||0){var A=Array(c).join(" "),L=[];E.map(function(F){(F=F.split(/\s*\n/)).length>1?L=L.concat(F.map(function(te,ae){return(ae&&te.length?`
`:"")+te})):L.push(F[0])}),E=L,c=cw.apply(this,[A,n])}for(s=0,a=E.length;s<a;s++){var M=0;if(r=E[s],c&&r[0]==`
`&&(r=r.substr(1),M=1),y+p+(T=(i=Rf.apply(this,[r,n])).reduce(function(F,te){return F+te},0))>e||M){if(T>e){for(l=uw.apply(this,[r,i,e-(y+p),e]),f.push(l.shift()),f=[l.pop()];l.length;)g.push([l.shift()]);T=i.slice(r.length-(f[0]?f[0].length:0)).reduce(function(F,te){return F+te},0)}else f=[r];g.push(f),y=T+c,p=P}else f.push(r),y+=p+T,p=P}return u=c?function(F,te){return(te?A:"")+F.join(" ")}:function(F){return F.join(" ")},g.map(u)},kc.splitTextToSize=function(t,e,n){var r,i=(n=n||{}).fontSize||this.internal.getFontSize(),s=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var g=this.internal.getFont(f.fontName,f.fontStyle),y="Unicode";return g.metadata[y]?{widths:g.metadata[y].widths||{0:1},kerning:g.metadata[y].kerning||{}}:{font:g.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(t)?t:String(t).split(/\r?\n/);var a=1*this.internal.scaleFactor*e/i;s.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=n.lineIndent;var l,c,u=[];for(l=0,c=r.length;l<c;l++)u=u.concat(dw.apply(this,[r[l],a,s]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",n="klmnopqrstuvwxyz",r={},i={},s=0;s<16;s++)r[n[s]]=e[s],i[e[s]]=n[s];var a=function(y){return"0x"+parseInt(y,10).toString(16)},l=t.__fontmetrics__.compress=function(y){var p,T,E,P,A=["{"];for(var L in y){if(p=y[L],isNaN(parseInt(L,10))?T="'"+L+"'":(L=parseInt(L,10),T=(T=a(L).slice(2)).slice(0,-1)+i[T.slice(-1)]),typeof p=="number")p<0?(E=a(p).slice(3),P="-"):(E=a(p).slice(2),P=""),E=P+E.slice(0,-1)+i[E.slice(-1)];else{if(dn(p)!=="object")throw new Error("Don't know what to do with value type "+dn(p)+".");E=l(p)}A.push(T+E)}return A.push("}"),A.join("")},c=t.__fontmetrics__.uncompress=function(y){if(typeof y!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,T,E,P,A={},L=1,M=A,F=[],te="",ae="",B=y.length-1,I=1;I<B;I+=1)(P=y[I])=="'"?p?(E=p.join(""),p=void 0):p=[]:p?p.push(P):P=="{"?(F.push([M,E]),M={},E=void 0):P=="}"?((T=F.pop())[0][T[1]]=M,E=void 0,M=T[0]):P=="-"?L=-1:E===void 0?r.hasOwnProperty(P)?(te+=r[P],E=parseInt(te,16)*L,L=1,te=""):te+=P:r.hasOwnProperty(P)?(ae+=r[P],M[E]=parseInt(ae,16)*L,L=1,E=void 0,ae=""):ae+=P;return A},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},g={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(y){var p=y.font,T=g.Unicode[p.postScriptName];T&&(p.metadata.Unicode={},p.metadata.Unicode.widths=T.widths,p.metadata.Unicode.kerning=T.kerning);var E=f.Unicode[p.postScriptName];E&&(p.metadata.Unicode.encoding=E,p.encoding=E.codePages[0])}])}(st.API),function(t){var e=function(n){for(var r=n.length,i=new Uint8Array(r),s=0;s<r;s++)i[s]=n.charCodeAt(s);return i};t.API.events.push(["addFont",function(n){var r=void 0,i=n.font,s=n.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(a,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(ip(l)),a.metadata=t.API.TTFFont.open(l),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(i,r)}}])}(st),st.API.addSvgAsImage=function(t,e,n,r,i,s,a,l){if(isNaN(e)||isNaN(n))throw vn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(i))throw vn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=r,c.height=i;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},g=this;return(_t.canvg?Promise.resolve(_t.canvg):Jg(()=>import("./index.es-DDiQQfSH.js"),[])).catch(function(y){return Promise.reject(new Error("Could not load canvg: "+y))}).then(function(y){return y.default?y.default:y}).then(function(y){return y.fromString(u,t,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(y){return y.render(f)}).then(function(){g.addImage(c.toDataURL("image/jpeg",1),e,n,r,i,a,l)})},st.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(e,n);return this},st.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var r,i,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(a),c=[],u=0,f=0,g=0;function y(T,E){var P,A=!1;for(P=0;P<T.length;P+=1)T[P]===E&&(A=!0);return A}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var p=l.length;for(g=0;g<p;g+=1)n[l[g]].value=n[l[g]].defaultValue,n[l[g]].explicitSet=!1}if(dn(t)==="object"){for(i in t)if(s=t[i],y(l,i)&&s!==void 0){if(n[i].type==="boolean"&&typeof s=="boolean")n[i].value=s;else if(n[i].type==="name"&&y(n[i].valueSet,s))n[i].value=s;else if(n[i].type==="integer"&&Number.isInteger(s))n[i].value=s;else if(n[i].type==="array"){for(u=0;u<s.length;u+=1)if(r=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(f=0;f<s[u].length;f+=1)typeof s[u][f]!="number"&&(r=!1);r===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}n[i].value="["+c.join(" ")+"]"}else n[i].value=n[i].defaultValue;n[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var T,E=[];for(T in n)n[T].explicitSet===!0&&(n[T].type==="name"?E.push("/"+T+" /"+n[T].value):E.push("/"+T+" "+n[T].value));E.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+E.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(t){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(r)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+a.length+l.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(i+s+a+l+c),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(r,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",e)),this}}(st.API),function(t){var e=t.API,n=e.pdfEscape16=function(s,a){for(var l,c=a.metadata.Unicode.widths,u=["","0","00","000","0000"],f=[""],g=0,y=s.length;g<y;++g){if(l=a.metadata.characterToGlyph(s.charCodeAt(g)),a.metadata.glyIdsUsed.push(l),a.metadata.toUnicode[l]=s.charCodeAt(g),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(a.metadata.widthOfGlyph(l),10)])),l=="0")return f.join("");l=l.toString(16),f.push(u[4-l.length],l)}return f.join("")},r=function(s){var a,l,c,u,f,g,y;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],g=0,y=(l=Object.keys(s).sort(function(p,T){return p-T})).length;g<y;g++)a=l[g],c.length>=100&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[a]!==void 0&&s[a]!==null&&typeof s[a].toString=="function"&&(u=("0000"+s[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),c.push("<"+a+"><"+u+">"));return c.length&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(a){var l=a.font,c=a.out,u=a.newObject,f=a.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var g=l.metadata.Unicode.widths,y=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),p="",T=0;T<y.length;T++)p+=String.fromCharCode(y[T]);var E=u();f({data:p,addLength1:!0,objectId:E}),c("endobj");var P=u();f({data:r(l.metadata.toUnicode),addLength1:!0,objectId:P}),c("endobj");var A=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Rc(l.fontName)),c("/FontFile2 "+E+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var L=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Rc(l.fontName)),c("/FontDescriptor "+A+" 0 R"),c("/W "+t.API.PDFObject.convert(g)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+P+" 0 R"),c("/BaseFont /"+Rc(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+L+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(a){var l=a.font,c=a.out,u=a.newObject,f=a.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var g=l.metadata.rawData,y="",p=0;p<g.length;p++)y+=String.fromCharCode(g[p]);var T=u();f({data:y,addLength1:!0,objectId:T}),c("endobj");var E=u();f({data:r(l.metadata.toUnicode),addLength1:!0,objectId:E}),c("endobj");var P=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+T+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Rc(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var A=0;A<l.metadata.hmtx.widths.length;A++)l.metadata.hmtx.widths[A]=parseInt(l.metadata.hmtx.widths[A]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+E+" 0 R/BaseFont/"+Rc(l.fontName)+"/FontDescriptor "+P+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var i=function(s){var a,l=s.text||"",c=s.x,u=s.y,f=s.options||{},g=s.mutex||{},y=g.pdfEscape,p=g.activeFontKey,T=g.fonts,E=p,P="",A=0,L="",M=T[E].encoding;if(T[E].encoding!=="Identity-H")return{text:l,x:c,y:u,options:f,mutex:g};for(L=l,E=p,Array.isArray(l)&&(L=l[0]),A=0;A<L.length;A+=1)T[E].metadata.hasOwnProperty("cmap")&&(a=T[E].metadata.cmap.unicode.codeMap[L[A].charCodeAt(0)]),a||L[A].charCodeAt(0)<256&&T[E].metadata.hasOwnProperty("Unicode")?P+=L[A]:P+="";var F="";return parseInt(E.slice(1))<14||M==="WinAnsiEncoding"?F=y(P,E).split("").map(function(te){return te.charCodeAt(0).toString(16)}).join(""):M==="Identity-H"&&(F=n(P,T[E])),g.isHex=!0,{text:F,x:c,y:u,options:f,mutex:g}};e.events.push(["postProcessText",function(s){var a=s.text||"",l=[],c={text:a,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(a)){var u=0;for(u=0;u<a.length;u+=1)Array.isArray(a[u])&&a[u].length===3?l.push([i(Object.assign({},c,{text:a[u][0]})).text,a[u][1],a[u][2]]):l.push(i(Object.assign({},c,{text:a[u]})).text);s.text=l}else s.text=i(Object.assign({},c,{text:a})).text}])}(st),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0},t.addFileToVFS=function(n,r){return e.call(this),this.internal.vFS[n]=r,this},t.getFileFromVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(st.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(r){var i,s,a,l,c,u,f,g=e,y=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],T={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},E={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},P=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],A=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),L=!1,M=0;this.__bidiEngine__={};var F=function(N){var w=N.charCodeAt(),k=w>>8,H=E[k];return H!==void 0?g[256*H+(255&w)]:k===252||k===253?"AL":A.test(k)?"L":k===8?"R":"N"},te=function(N){for(var w,k=0;k<N.length;k++){if((w=F(N.charAt(k)))==="L")return!1;if(w==="R")return!0}return!1},ae=function(N,w,k,H){var D,W,K,q,ee=w[H];switch(ee){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":L=!1;break;case"N":case"AN":break;case"EN":L&&(ee="AN");break;case"AL":L=!0,ee="R";break;case"WS":case"BN":ee="N";break;case"CS":H<1||H+1>=w.length||(D=k[H-1])!=="EN"&&D!=="AN"||(W=w[H+1])!=="EN"&&W!=="AN"?ee="N":L&&(W="AN"),ee=W===D?W:"N";break;case"ES":ee=(D=H>0?k[H-1]:"B")==="EN"&&H+1<w.length&&w[H+1]==="EN"?"EN":"N";break;case"ET":if(H>0&&k[H-1]==="EN"){ee="EN";break}if(L){ee="N";break}for(K=H+1,q=w.length;K<q&&w[K]==="ET";)K++;ee=K<q&&w[K]==="EN"?"EN":"N";break;case"NSM":if(a&&!l){for(q=w.length,K=H+1;K<q&&w[K]==="NSM";)K++;if(K<q){var ue=N[H],ce=ue>=1425&&ue<=2303||ue===64286;if(D=w[K],ce&&(D==="R"||D==="AL")){ee="R";break}}}ee=H<1||(D=w[H-1])==="B"?"N":k[H-1];break;case"B":L=!1,i=!0,ee=M;break;case"S":s=!0,ee="N"}return ee},B=function(N,w,k){var H=N.split("");return k&&I(H,k,{hiLevel:M}),H.reverse(),w&&w.reverse(),H.join("")},I=function(N,w,k){var H,D,W,K,q,ee=-1,ue=N.length,ce=0,_=[],z=M?p:y,O=[];for(L=!1,i=!1,s=!1,D=0;D<ue;D++)O[D]=F(N[D]);for(W=0;W<ue;W++){if(q=ce,_[W]=ae(N,O,_,W),H=240&(ce=z[q][T[_[W]]]),ce&=15,w[W]=K=z[ce][5],H>0)if(H===16){for(D=ee;D<W;D++)w[D]=1;ee=-1}else ee=-1;if(z[ce][6])ee===-1&&(ee=W);else if(ee>-1){for(D=ee;D<W;D++)w[D]=K;ee=-1}O[W]==="B"&&(w[W]=0),k.hiLevel|=K}s&&function(X,Z,le){for(var me=0;me<le;me++)if(X[me]==="S"){Z[me]=M;for(var ye=me-1;ye>=0&&X[ye]==="WS";ye--)Z[ye]=M}}(O,w,ue)},j=function(N,w,k,H,D){if(!(D.hiLevel<N)){if(N===1&&M===1&&!i)return w.reverse(),void(k&&k.reverse());for(var W,K,q,ee,ue=w.length,ce=0;ce<ue;){if(H[ce]>=N){for(q=ce+1;q<ue&&H[q]>=N;)q++;for(ee=ce,K=q-1;ee<K;ee++,K--)W=w[ee],w[ee]=w[K],w[K]=W,k&&(W=k[ee],k[ee]=k[K],k[K]=W);ce=q}ce++}}},S=function(N,w,k){var H=N.split(""),D={hiLevel:M};return k||(k=[]),I(H,k,D),function(W,K,q){if(q.hiLevel!==0&&f)for(var ee,ue=0;ue<W.length;ue++)K[ue]===1&&(ee=P.indexOf(W[ue]))>=0&&(W[ue]=P[ee+1])}(H,k,D),j(2,H,w,k,D),j(1,H,w,k,D),H.join("")};return this.__bidiEngine__.doBidiReorder=function(N,w,k){if(function(D,W){if(W)for(var K=0;K<D.length;K++)W[K]=K;l===void 0&&(l=te(D)),u===void 0&&(u=te(D))}(N,w),a||!c||u)if(a&&c&&l^u)M=l?1:0,N=B(N,w,k);else if(!a&&c&&u)M=l?1:0,N=S(N,w,k),N=B(N,w);else if(!a||l||c||u){if(a&&!c&&l^u)N=B(N,w),l?(M=0,N=S(N,w,k)):(M=1,N=S(N,w,k),N=B(N,w));else if(a&&l&&!c&&u)M=1,N=S(N,w,k),N=B(N,w);else if(!a&&!c&&l^u){var H=f;l?(M=1,N=S(N,w,k),M=0,f=!1,N=S(N,w,k),f=H):(M=0,N=S(N,w,k),N=B(N,w),M=1,f=!1,N=S(N,w,k),f=H,N=B(N,w))}}else M=0,N=S(N,w,k);else M=l?1:0,N=S(N,w,k);return N},this.__bidiEngine__.setOptions=function(N){N&&(a=N.isInputVisual,c=N.isOutputVisual,l=N.isInputRtl,u=N.isOutputRtl,f=N.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(r){var i=r.text;r.x,r.y;var s=r.options||{};r.mutex,s.lang;var a=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,n.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(a=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?a.push([n.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):a.push([n.doBidiReorder(i[l])]);r.text=a}else r.text=n.doBidiReorder(i);n.setOptions({isInputVisual:!0})}])}(st),st.API.TTFFont=function(){function t(e){var n;if(this.rawData=e,n=this.contents=new pl(e),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new YD(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new DD(this.contents),this.head=new MD(this),this.name=new qD(this),this.cmap=new GA(this),this.toUnicode={},this.hhea=new FD(this),this.maxp=new zD(this),this.hmtx=new $D(this),this.post=new UD(this),this.os2=new VD(this),this.loca=new KD(this),this.glyf=new HD(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,n,r,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,l,c,u;for(u=[],a=0,l=(c=this.bbox).length;a<l;a++)e=c[a],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),32768&(n=i>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var n;return((n=this.cmap.unicode)!=null?n.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*n},t.prototype.widthOfString=function(e,n,r){var i,s,a,l;for(a=0,s=0,l=(e=""+e).length;0<=l?s<l:s>l;s=0<=l?++s:--s)i=e.charCodeAt(s),a+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/n)||0;return a*(n/1e3)},t.prototype.lineHeight=function(e,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},t}();var Vs,pl=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var n,r;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},t.prototype.writeString=function(e){var n,r,i;for(i=[],n=0,r=e.length;0<=r?n<r:n>r;n=0<=r?++n:--n)i.push(this.writeByte(e.charCodeAt(n)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,n,r,i,s,a,l,c;return e=this.readByte(),n=this.readByte(),r=this.readByte(),i=this.readByte(),s=this.readByte(),a=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^s)+65536*(255^a)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*n+1099511627776*r+4294967296*i+16777216*s+65536*a+256*l+c},t.prototype.writeLongLong=function(e){var n,r;return n=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var n,r;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n.push(this.readByte());return n},t.prototype.write=function(e){var n,r,i,s;for(s=[],r=0,i=e.length;r<i;r++)n=e[r],s.push(this.writeByte(n));return s},t}(),DD=function(){var t;function e(n){var r,i,s;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(n){var r,i,s,a,l,c,u,f,g,y,p,T,E;for(E in p=Object.keys(n).length,c=Math.log(2),g=16*Math.floor(Math.log(p)/c),a=Math.floor(g/c),f=16*p-g,(i=new pl).writeInt(this.scalarType),i.writeShort(p),i.writeShort(g),i.writeShort(a),i.writeShort(f),s=16*p,u=i.pos+s,l=null,T=[],n)for(y=n[E],i.writeString(E),i.writeInt(t(y)),i.writeInt(u),i.writeInt(y.length),T=T.concat(y),E==="head"&&(l=u),u+=y.length;u%4;)T.push(0),u++;return i.write(T),r=2981146554-t(i.data),i.pos=l+8,i.writeUInt32(r),i.data},t=function(n){var r,i,s,a;for(n=KA.call(n);n.length%4;)n.push(0);for(s=new pl(n),i=0,r=0,a=n.length;r<a;r=r+=4)i+=s.readUInt32();return 4294967295&i},e}(),OD={}.hasOwnProperty,_a=function(t,e){for(var n in e)OD.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Vs=function(){function t(e){var n;this.file=e,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var MD=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _a(t,Vs),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new pl).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t}(),bw=function(){function t(e,n){var r,i,s,a,l,c,u,f,g,y,p,T,E,P,A,L,M;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=n+e.readInt(),g=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(p=e.readUInt16(),y=p/2,e.pos+=6,s=function(){var F,te;for(te=[],c=F=0;0<=y?F<y:F>y;c=0<=y?++F:--F)te.push(e.readUInt16());return te}(),e.pos+=2,E=function(){var F,te;for(te=[],c=F=0;0<=y?F<y:F>y;c=0<=y?++F:--F)te.push(e.readUInt16());return te}(),u=function(){var F,te;for(te=[],c=F=0;0<=y?F<y:F>y;c=0<=y?++F:--F)te.push(e.readUInt16());return te}(),f=function(){var F,te;for(te=[],c=F=0;0<=y?F<y:F>y;c=0<=y?++F:--F)te.push(e.readUInt16());return te}(),i=(this.length-e.pos+this.offset)/2,l=function(){var F,te;for(te=[],c=F=0;0<=i?F<i:F>i;c=0<=i?++F:--F)te.push(e.readUInt16());return te}(),c=A=0,M=s.length;A<M;c=++A)for(P=s[c],r=L=T=E[c];T<=P?L<=P:L>=P;r=T<=P?++L:--L)f[c]===0?a=r+u[c]:(a=l[f[c]/2+(r-T)-(y-c)]||0)!==0&&(a+=u[c]),this.codeMap[r]=65535&a}e.pos=g}return t.encode=function(e,n){var r,i,s,a,l,c,u,f,g,y,p,T,E,P,A,L,M,F,te,ae,B,I,j,S,N,w,k,H,D,W,K,q,ee,ue,ce,_,z,O,X,Z,le,me,ye,xe,ke,Ve;switch(H=new pl,a=Object.keys(e).sort(function(Ue,Ne){return Ue-Ne}),n){case"macroman":for(E=0,P=function(){var Ue=[];for(T=0;T<256;++T)Ue.push(0);return Ue}(),L={0:0},s={},D=0,ee=a.length;D<ee;D++)L[ye=e[i=a[D]]]==null&&(L[ye]=++E),s[i]={old:e[i],new:L[e[i]]},P[i]=L[e[i]];return H.writeUInt16(1),H.writeUInt16(0),H.writeUInt32(12),H.writeUInt16(0),H.writeUInt16(262),H.writeUInt16(0),H.write(P),{charMap:s,subtable:H.data,maxGlyphID:E+1};case"unicode":for(w=[],g=[],M=0,L={},r={},A=u=null,W=0,ue=a.length;W<ue;W++)L[te=e[i=a[W]]]==null&&(L[te]=++M),r[i]={old:te,new:L[te]},l=L[te]-i,A!=null&&l===u||(A&&g.push(A),w.push(i),u=l),A=i;for(A&&g.push(A),g.push(65535),w.push(65535),S=2*(j=w.length),I=2*Math.pow(Math.log(j)/Math.LN2,2),y=Math.log(I/2)/Math.LN2,B=2*j-I,c=[],ae=[],p=[],T=K=0,ce=w.length;K<ce;T=++K){if(N=w[T],f=g[T],N===65535){c.push(0),ae.push(0);break}if(N-(k=r[N].new)>=32768)for(c.push(0),ae.push(2*(p.length+j-T)),i=q=N;N<=f?q<=f:q>=f;i=N<=f?++q:--q)p.push(r[i].new);else c.push(k-N),ae.push(0)}for(H.writeUInt16(3),H.writeUInt16(1),H.writeUInt32(12),H.writeUInt16(4),H.writeUInt16(16+8*j+2*p.length),H.writeUInt16(0),H.writeUInt16(S),H.writeUInt16(I),H.writeUInt16(y),H.writeUInt16(B),le=0,_=g.length;le<_;le++)i=g[le],H.writeUInt16(i);for(H.writeUInt16(0),me=0,z=w.length;me<z;me++)i=w[me],H.writeUInt16(i);for(xe=0,O=c.length;xe<O;xe++)l=c[xe],H.writeUInt16(l);for(ke=0,X=ae.length;ke<X;ke++)F=ae[ke],H.writeUInt16(F);for(Ve=0,Z=p.length;Ve<Z;Ve++)E=p[Ve],H.writeUInt16(E);return{charMap:r,subtable:H.data,maxGlyphID:M+1}}},t}(),GA=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _a(t,Vs),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,r,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=i?r<i:r>i;r=0<=i?++r:--r)n=new bw(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var r,i;return n==null&&(n="macroman"),r=bw.encode(e,n),(i=new pl).writeUInt16(0),i.writeUInt16(1),r.table=i.data.concat(r.subtable),r},t}(),FD=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _a(t,Vs),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),VD=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _a(t,Vs),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var n,r;for(r=[],n=0;n<10;++n)r.push(e.readByte());return r}(),this.charRange=function(){var n,r;for(r=[],n=0;n<4;++n)r.push(e.readInt());return r}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var n,r;for(r=[],n=0;n<2;n=++n)r.push(e.readInt());return r}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),UD=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _a(t,Vs),t.prototype.tag="post",t.prototype.parse=function(e){var n,r,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(r=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)n=e.readByte(),i.push(this.names.push(e.readString(n)));return i;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=(function(){var a,l,c;for(c=[],s=a=0,l=this.file.maxp.numGlyphs;0<=l?a<l:a>l;s=0<=l?++a:--a)c.push(e.readUInt32());return c}).call(this)}},t}(),BD=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},qD=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _a(t,Vs),t.prototype.tag="name",t.prototype.parse=function(e){var n,r,i,s,a,l,c,u,f,g,y;for(e.pos=this.offset,e.readShort(),n=e.readShort(),l=e.readShort(),r=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},s=f=0,g=r.length;f<g;s=++f)i=r[s],e.pos=i.offset,u=e.readString(i.length),a=new BD(u,i),c[y=i.nameID]==null&&(c[y]=[]),c[i.nameID].push(a);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),zD=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _a(t,Vs),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),$D=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _a(t,Vs),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,r,i,s,a,l,c;for(e.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,f;for(f=[],n=u=0;0<=i?u<i:u>i;n=0<=i?++u:--u)f.push(e.readInt16());return f}(),this.widths=(function(){var u,f,g,y;for(y=[],u=0,f=(g=this.metrics).length;u<f;u++)s=g[u],y.push(s.advance);return y}).call(this),r=this.widths[this.widths.length-1],c=[],n=a=0;0<=i?a<i:a>i;n=0<=i?++a:--a)c.push(this.widths.push(r));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),KA=[].slice,HD=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _a(t,Vs),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,r,i,s,a,l,c,u,f,g;return e in this.cache?this.cache[e]:(s=this.file.loca,n=this.file.contents,r=s.indexOf(e),(i=s.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+r,a=(l=new pl(n.read(i))).readShort(),u=l.readShort(),g=l.readShort(),c=l.readShort(),f=l.readShort(),this.cache[e]=a===-1?new GD(l,u,g,c,f):new WD(l,a,u,g,c,f),this.cache[e]))},t.prototype.encode=function(e,n,r){var i,s,a,l,c;for(a=[],s=[],l=0,c=n.length;l<c;l++)i=e[n[l]],s.push(a.length),i&&(a=a.concat(i.encode(r)));return s.push(a.length),{table:a,offsets:s}},t}(),WD=function(){function t(e,n,r,i,s,a){this.raw=e,this.numberOfContours=n,this.xMin=r,this.yMin=i,this.xMax=s,this.yMax=a,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),GD=function(){function t(e,n,r,i,s){var a,l;for(this.raw=e,this.xMin=n,this.yMin=r,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;l=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&l;)a.pos+=1&l?4:2,128&l?a.pos+=8:64&l?a.pos+=4:8&l&&(a.pos+=2)}return t.prototype.encode=function(){var e,n,r;for(n=new pl(KA.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)n.pos=this.glyphOffsets[e];return n.data},t}(),KD=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return _a(t,Vs),t.prototype.tag="loca",t.prototype.parse=function(e){var n,r;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,s;for(s=[],r=0,i=this.length;r<i;r+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],r=0,i=this.length;r<i;r+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var r=new Uint32Array(this.offsets.length),i=0,s=0,a=0;a<r.length;++a)if(r[a]=i,s<n.length&&n[s]==a){++s,r[a]=i;var l=this.offsets[a],c=this.offsets[a+1]-l;c>0&&(i+=c)}for(var u=new Array(4*r.length),f=0;f<r.length;++f)u[4*f+3]=255&r[f],u[4*f+2]=(65280&r[f])>>8,u[4*f+1]=(16711680&r[f])>>16,u[4*f]=(4278190080&r[f])>>24;return u},t}(),YD=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,n,r,i,s;for(n in i=this.font.cmap.tables[0].codeMap,e={},s=this.subset)r=s[n],e[n]=i[r];return e},t.prototype.glyphsFor=function(e){var n,r,i,s,a,l,c;for(i={},a=0,l=e.length;a<l;a++)i[s=e[a]]=this.font.glyf.glyphFor(s);for(s in n=[],i)(r=i[s])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(s in c=this.glyphsFor(n))r=c[s],i[s]=r;return i},t.prototype.encode=function(e,n){var r,i,s,a,l,c,u,f,g,y,p,T,E,P,A;for(i in r=GA.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(e),p={0:0},A=r.charMap)p[(c=A[i]).old]=c.new;for(T in y=r.maxGlyphID,a)T in p||(p[T]=y++);return f=function(L){var M,F;for(M in F={},L)F[L[M]]=M;return F}(p),g=Object.keys(f).sort(function(L,M){return L-M}),E=function(){var L,M,F;for(F=[],L=0,M=g.length;L<M;L++)l=g[L],F.push(f[l]);return F}(),s=this.font.glyf.encode(a,E,p),u=this.font.loca.encode(s.offsets,E),P={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(P["OS/2"]=this.font.os2.raw()),this.font.directory.encode(P)},t}();st.API.PDFObject=function(){var t;function e(){}return t=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},e.convert=function(n){var r,i,s,a;if(Array.isArray(n))return"["+function(){var l,c,u;for(u=[],l=0,c=n.length;l<c;l++)r=n[l],u.push(e.convert(r));return u}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(i in s=["<<"],n)a=n[i],s.push("/"+i+" "+e.convert(a));return s.push(">>"),s.join(`
`)}return""+n},e}();function QD({isDemo:t,userRole:e}){const{addNotification:n}=kn(),[r,i]=fe.useState([]),[s,a]=fe.useState([]),[l,c]=fe.useState(""),[u,f]=fe.useState("Todos"),[g,y]=fe.useState("Todos"),[p,T]=fe.useState(!0),[E,P]=fe.useState("history"),[A,L]=fe.useState(!1),M=["Todos","Pendiente","Procesando","Completado","Fallido","Cancelado","Reembolsado"],F=["Todos","Bold","PayPal","PayU","Transferencia Bancaria","Manual"];fe.useEffect(()=>{if(t){i([{id:"demo1",serviceNumber:"SRV-241017-123456",clientName:"Juan Pérez",clientEmail:"juan@ejemplo.com",amount:10.99,currency:"USD",status:"Completado",gateway:"Bold",transactionId:"bold_txn_123456",createdAt:{seconds:Date.now()/1e3-86400},completedAt:{seconds:Date.now()/1e3-3600}},{id:"demo2",serviceNumber:"SRV-241017-789012",clientName:"María García",clientEmail:"maria@ejemplo.com",amount:25,currency:"USD",status:"Pendiente",gateway:"PayPal",transactionId:"paypal_txn_789012",createdAt:{seconds:Date.now()/1e3-7200}},{id:"demo3",serviceNumber:"SRV-241017-345678",clientName:"Carlos López",clientEmail:"carlos@ejemplo.com",amount:50,currency:"USD",status:"Completado",gateway:"Transferencia Bancaria",transactionId:"TRF-123456789",createdAt:{seconds:Date.now()/1e3-10800},completedAt:{seconds:Date.now()/1e3-9e3}}]),a([{id:"client1",fullName:"Juan Pérez",email:"juan@ejemplo.com"},{id:"client2",fullName:"María García",email:"maria@ejemplo.com"}]),T(!1);return}const D=Ht(qe,"artifacts",Be,"public","data","payments"),W=nn(D,ee=>{console.log("Admin payments snapshot:",ee.size,"documents");const ue=ee.docs.map(ce=>{const _=ce.data();return console.log("Payment doc:",ce.id,_),{id:ce.id,..._}});ue.sort((ce,_)=>{var X,Z;const z=((X=ce.createdAt)==null?void 0:X.seconds)||0;return(((Z=_.createdAt)==null?void 0:Z.seconds)||0)-z}),console.log("Admin payments loaded:",ue.length,ue),i(ue),T(!1)},ee=>{console.error("Error loading payments:",ee),n("Error al cargar los pagos","error"),T(!1)}),K=or(Ht(qe,"artifacts",Be,"public","data","users"),Or("role","==","client")),q=nn(K,ee=>{const ue=ee.docs.map(ce=>({id:ce.id,...ce.data()}));a(ue)});return()=>{W(),q()}},[t,n]);const te=r.filter(D=>{var ee,ue,ce,_;const W=((ee=D.serviceNumber)==null?void 0:ee.toLowerCase().includes(l.toLowerCase()))||((ue=D.clientName)==null?void 0:ue.toLowerCase().includes(l.toLowerCase()))||((ce=D.clientEmail)==null?void 0:ce.toLowerCase().includes(l.toLowerCase()))||((_=D.transactionId)==null?void 0:_.toLowerCase().includes(l.toLowerCase())),K=u==="Todos"||D.status===u,q=g==="Todos"||D.gateway===g;return W&&K&&q}),ae=async(D,W=null)=>{try{if(W!=null&&W.exchangeRate)return Number(W.exchangeRate);const K=D instanceof Date?D:new Date(D),q=K.toISOString().split("T")[0];try{if(Math.floor((new Date-K)/(1e3*60*60*24))<=7){const ce=await fetch("https://api.exchangerate.host/latest?base=USD&symbols=COP");if(ce.ok){const _=await ce.json();if(_.success&&_.rates&&_.rates.COP)return Number(_.rates.COP)}}else{const ce=await fetch(`https://api.exchangerate.host/${q}?base=USD&symbols=COP`);if(ce.ok){const _=await ce.json();if(_.success&&_.rates&&_.rates.COP)return Number(_.rates.COP)}}}catch(ee){console.warn("Error obteniendo tasa de cambio de API:",ee)}return console.warn("Usando tasa de cambio predeterminada (4000 COP/USD). Para tasas históricas precisas, configure una API key."),4e3}catch(K){return console.error("Error en getExchangeRate:",K),4e3}},B=async D=>{var W;try{if(!D||!D.id){console.error("Payment inválido para generar invoice:",D);return}const q="INV-"+String(D.id||"").slice(-8).toUpperCase(),ee=(W=D.createdAt)!=null&&W.seconds?new Date(D.createdAt.seconds*1e3):new Date,ue=ee.toLocaleDateString("es-ES"),ce=D.dueDate?new Date(D.dueDate.seconds*1e3).toLocaleDateString("es-ES"):"N/A",_=String(D.clientName||"Cliente"),z=String(D.clientEmail||"N/A"),O=String(D.serviceNumber||"N/A"),X=String(D.serviceType||"Servicio"),Z=String(D.description||"Descripción del servicio"),le=Number(D.amount||0),me=String(D.currency||"USD"),ye=String(D.gateway||"N/A"),xe=String(D.transactionId||"N/A"),ke=String(D.paymentMethod||"N/A");let Ve=le,Ue=me,Ne=null,se=null,yt=null;me.toUpperCase()==="USD"&&(se=await ae(ee,D),yt=ee.toLocaleDateString("es-ES"),Ne=le,Ve=le*se,Ue="COP");const Ye=Ve.toLocaleString("es-CO",{minimumFractionDigits:2,maximumFractionDigits:2}),ot=Ne?Ne.toFixed(2):null,De=se?se.toLocaleString("es-CO",{minimumFractionDigits:2,maximumFractionDigits:2}):null,je=new st;let Ce=20;return je.setFontSize(24),je.setTextColor(37,99,235),je.text("Gestor de Cobros",105,Ce,{align:"center"}),Ce+=10,je.setFontSize(18),je.setTextColor(102,102,102),je.text("FACTURA",105,Ce,{align:"center"}),Ce+=20,je.setFontSize(12),je.setTextColor(0,0,0),je.setFont(void 0,"bold"),je.text("Cliente:",20,Ce),je.setFont(void 0,"normal"),je.text(_,60,Ce),Ce+=7,je.text(z,60,Ce),Ce+=15,je.setFont(void 0,"bold"),je.text("Detalles de la Factura:",20,Ce),Ce+=7,je.setFont(void 0,"normal"),je.text("Número: "+q,20,Ce),Ce+=7,je.text("Fecha: "+ue,20,Ce),Ce+=7,je.text("Vencimiento: "+ce,20,Ce),Ce+=7,je.text("Estado: Completado",20,Ce),Ce+=15,je.setFont(void 0,"bold"),je.text("Detalles del Servicio:",20,Ce),Ce+=10,je.setFillColor(248,249,250),je.rect(20,Ce-5,170,8,"F"),je.setFont(void 0,"bold"),je.text("Servicio",25,Ce),je.text("Descripción",70,Ce),je.text("Monto",165,Ce,{align:"right"}),Ce+=10,je.setFont(void 0,"normal"),je.text(X,25,Ce),je.text(Z.substring(0,35),70,Ce),je.text(Ue+" "+Ye,165,Ce,{align:"right"}),Ce+=10,Ne&&se&&(je.setFontSize(8),je.setTextColor(102,102,102),je.text("Equivale a USD "+ot+" (Tasa: "+De+" COP/USD del "+yt+")",165,Ce,{align:"right"}),Ce+=10),Ce+=5,je.setFontSize(16),je.setFont(void 0,"bold"),je.setTextColor(37,99,235),je.text("Total: "+Ue+" "+Ye,165,Ce,{align:"right"}),Ce+=20,je.setFontSize(10),je.setTextColor(102,102,102),je.setFont(void 0,"normal"),je.text("Método de Pago: "+ke,20,Ce),Ce+=6,je.text("Gateway: "+ye,20,Ce),Ce+=6,xe!=="N/A"&&(je.text("ID de Transacción: "+xe,20,Ce),Ce+=6),je.text("Gracias por su negocio",105,Ce,{align:"center"}),je.save("invoice-"+q+".pdf"),je}catch(K){return console.error("Error generando PDF:",K),n("Error al generar el PDF del invoice","error"),null}},I=async(D,W)=>{if(t){n("Función no disponible en modo demo","error");return}try{const K=mt(qe,"artifacts",Be,"public","data","payments",D),q=await Xl(K);if(!q.exists()){n("No se encontró el pago","error");return}const ee={id:D,...q.data()};if(await hr(K,{status:W,updatedAt:lt.now(),...W==="Completado"?{completedAt:lt.now()}:{}}),W==="Completado"){const ue=await Xl(K),ce={id:D,...ue.data(),clientName:ue.data().clientName||ee.clientName||"Cliente",clientEmail:ue.data().clientEmail||ee.clientEmail||"N/A",serviceNumber:ue.data().serviceNumber||ee.serviceNumber||"N/A",serviceType:ue.data().serviceType||ee.serviceType||"Servicio",description:ue.data().description||ee.description||"Descripción del servicio",amount:ue.data().amount||ee.amount||0,currency:ue.data().currency||ee.currency||"USD",gateway:ue.data().gateway||ee.gateway||"N/A",transactionId:ue.data().transactionId||ee.transactionId||"N/A",paymentMethod:ue.data().paymentMethod||ee.paymentMethod||"N/A",createdAt:ue.data().createdAt||ee.createdAt,dueDate:ue.data().dueDate||ee.dueDate};await B(ce);const _=ce.serviceId;if(_)try{const z=mt(qe,"artifacts",Be,"public","data","services",_),O=await Xl(z);if(O.exists()){const X=O.data(),Z={updatedAt:lt.now()};ce.isRenewal||ce.paymentType==="Renovación"?(ce.startDate&&(Z.dueDate=ce.startDate),ce.endDate&&(Z.expirationDate=ce.endDate),Z.status="Activo"):(X.billingCycle==="One-Time"||ce.paymentType==="Pago Único")&&(Z.paidDate=lt.now(),Z.status="Completado"),Object.keys(Z).length>1&&await hr(z,Z)}}catch(z){console.error("Error actualizando servicio después de completar pago:",z)}n("Pago completado, servicio actualizado e invoice generado","success")}else n(`Estado del pago actualizado a ${W}`,"success")}catch(K){console.error("Error updating payment status:",K),n("Error al actualizar el estado del pago","error")}},j=async D=>{try{await B(D),n("Invoice PDF descargado exitosamente","success")}catch(W){console.error("Error descargando invoice:",W),n("Error al generar el invoice PDF","error")}},S=async D=>{if(t){n("Función no disponible en modo demo","error");return}if(window.confirm("¿Estás seguro de que quieres eliminar este pago? Esta acción no se puede deshacer."))try{await Su(mt(qe,"artifacts",Be,"public","data","payments",D)),n("Pago eliminado exitosamente","success")}catch(W){console.error("Error deleting payment:",W),n("Error al eliminar el pago","error")}},N=D=>({Pendiente:"bg-yellow-100 text-yellow-800",Procesando:"bg-blue-100 text-blue-800",Completado:"bg-green-100 text-green-800",Fallido:"bg-red-100 text-red-800",Cancelado:"bg-gray-100 text-gray-800",Reembolsado:"bg-purple-100 text-purple-800"})[D]||"bg-gray-100 text-gray-800",w=D=>({Bold:"bg-blue-100 text-blue-800",PayPal:"bg-yellow-100 text-yellow-800",PayU:"bg-green-100 text-green-800","Transferencia Bancaria":"bg-purple-100 text-purple-800",Manual:"bg-gray-100 text-gray-800"})[D]||"bg-gray-100 text-gray-800",k=D=>D?new Date(D.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",H=(D,W)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:W||"USD"}).format(D);return p?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[o.jsx("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:o.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[o.jsx(Yi,{}),"Gestión de Pagos"]})}),o.jsx("div",{className:"border-b border-gray-200 mb-6",children:o.jsxs("nav",{className:"-mb-px flex space-x-8",children:[o.jsxs("button",{onClick:()=>P("history"),className:`${E==="history"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[o.jsx(Yi,{}),"Historial de Pagos"]}),o.jsxs("button",{onClick:()=>P("renewal"),className:`${E==="renewal"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[o.jsx(al,{}),"Renovaciones"]}),e==="superadmin"&&o.jsxs("button",{onClick:()=>P("config"),className:`${E==="config"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[o.jsx(Ym,{}),"Configuración"]})]})}),E==="renewal"?o.jsxs("div",{className:"p-6",children:[o.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Configuración de Renovaciones"}),o.jsx(s8,{isDemo:t})]}):E==="config"?o.jsx(rA,{isDemo:t}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:o.jsxs("div",{className:"text-sm text-gray-500",children:[te.length," pago",te.length!==1?"s":""," encontrado",te.length!==1?"s":""]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",placeholder:"Buscar por servicio, cliente, email o transacción...",value:l,onChange:D=>c(D.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md"}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Ru,{})})]}),o.jsx("select",{value:u,onChange:D=>f(D.target.value),className:"w-full p-2 border rounded-md",children:M.map(D=>o.jsx("option",{value:D,children:D},D))}),o.jsx("select",{value:g,onChange:D=>y(D.target.value),className:"w-full p-2 border rounded-md",children:F.map(D=>o.jsx("option",{value:D,children:D},D))}),o.jsxs("button",{className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:[o.jsx(su,{}),"Filtros"]})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:o.jsxs("table",{className:"w-full text-left",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsx("tr",{children:["Servicio","Cliente","Monto","Estado","Pasarela","Transacción","Fecha","Acciones"].map(D=>o.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:D},D))})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:te.map(D=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsxs("td",{className:"px-6 py-4",children:[o.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:D.serviceNumber||D.id}),o.jsx("div",{className:"text-sm text-gray-600",children:D.serviceName||D.serviceType||"N/A"}),D.serviceDescription&&o.jsx("div",{className:"text-xs text-gray-500 truncate max-w-xs",children:D.serviceDescription}),D.isRenewal&&o.jsxs("div",{className:"text-xs text-green-600 font-medium",children:["Renovación: ",D.renewalPeriod||"N/A"]})]}),o.jsxs("td",{className:"px-6 py-4",children:[o.jsx("div",{className:"font-medium text-gray-900",children:D.clientName}),o.jsx("div",{className:"text-sm text-gray-500",children:D.clientEmail})]}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("div",{className:"font-semibold text-gray-900",children:H(D.amount,D.currency)})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${N(D.status)}`,children:D.status})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${w(D.gateway)}`,children:D.gateway})}),o.jsxs("td",{className:"px-6 py-4",children:[o.jsx("div",{className:"font-mono text-sm text-gray-600",children:D.transactionId||"N/A"}),D.proofUrl&&o.jsx("div",{className:"mt-2",children:o.jsx("button",{onClick:()=>{setSelectedPayment(D),L(!0)},className:"px-2 py-1 text-xs bg-purple-100 text-purple-700 rounded hover:bg-purple-200",children:"Ver Comprobante"})})]}),o.jsxs("td",{className:"px-6 py-4",children:[o.jsxs("div",{className:"text-sm text-gray-900 flex items-center gap-2",children:[k(D.createdAt),D.proofUrl&&o.jsx("span",{className:"ml-2 inline-flex px-2 py-0.5 text-xs rounded-full bg-purple-100 text-purple-700",title:"Comprobante adjunto",children:"Comprobante"})]}),D.completedAt&&o.jsxs("div",{className:"text-xs text-gray-500",children:["Completado: ",k(D.completedAt)]}),D.startDate&&D.endDate&&o.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[o.jsxs("div",{children:["Inicio: ",k(D.startDate)]}),o.jsxs("div",{children:["Fin: ",k(D.endDate)]})]})]}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[D.proofUrl&&o.jsx("button",{onClick:()=>{setSelectedPayment(D),L(!0)},className:"p-2 text-purple-600 hover:bg-purple-50 rounded-md",title:"Ver comprobante de pago",children:o.jsx(fl,{})}),e==="superadmin"&&o.jsx(o.Fragment,{children:o.jsxs(Oh,{children:[o.jsx("select",{value:D.status,onChange:W=>I(D.id,W.target.value),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 border-none bg-transparent",children:M.filter(W=>W!=="Todos").map(W=>o.jsx("option",{value:W,children:W},W))}),o.jsxs("button",{onClick:()=>j(D),className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50 flex items-center",children:[o.jsx(fl,{className:"h-4 w-4 mr-2"}),"Descargar Invoice"]}),o.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:"Ver Detalles"}),o.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-yellow-700 hover:bg-yellow-50",children:"Reembolsar"}),o.jsxs("button",{onClick:()=>S(D.id),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50 flex items-center",children:[o.jsx(Z3,{className:"h-4 w-4 mr-2"}),"Eliminar Pago"]})]})})]})})]},D.id))})]})}),te.length===0&&o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[o.jsx(Yi,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron pagos"}),o.jsx("p",{className:"text-gray-500",children:"No hay pagos que coincidan con los filtros seleccionados."})]})]}),A&&(selectedPayment==null?void 0:selectedPayment.proofUrl)&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"p-4 flex justify-between items-center border-b",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Comprobante de Pago"}),o.jsx("button",{onClick:()=>L(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),o.jsx("div",{className:"p-4",children:o.jsx("img",{src:selectedPayment.proofUrl,alt:"Comprobante",className:"max-w-full h-auto rounded"})})]})})]})}function XD({isDemo:t,userRole:e}){const{addNotification:n}=kn(),[r,i]=fe.useState([]),[s,a]=fe.useState(""),[l,c]=fe.useState("Todos"),[u,f]=fe.useState("Todos"),[g,y]=fe.useState("Todos"),[p,T]=fe.useState(!0),[E,P]=fe.useState(null),[A,L]=fe.useState(!1),M=["Todos","Enviado","Entregado","Leído","Fallido","Pendiente"],F=["Todos","Aprobación","Rechazo","Recordatorio","Notificación","Activación","Sistema"],te=["Todos","Cliente","Administrador","Sistema"];fe.useEffect(()=>{if(t){i([{id:"msg1",type:"Aprobación",recipientType:"Cliente",recipientName:"Juan Pérez",recipientEmail:"juan@ejemplo.com",subject:"Pago Aprobado - SRV-241017-123456",message:`Estimado/a Juan Pérez,

Su pago por el servicio SRV-241017-123456 ha sido aprobado exitosamente.

Detalles del pago:
- Servicio: Hosting Básico
- Monto: $50,000 COP
- Fecha: 17/10/2024
- Método: Bold

Su servicio está ahora activo. Gracias por su pago.

Saludos cordiales,
Equipo de Soporte`,status:"Entregado",sentAt:{seconds:Date.now()/1e3-3600},deliveredAt:{seconds:Date.now()/1e3-3e3},readAt:{seconds:Date.now()/1e3-1800},templateId:"approval_1",paymentId:"pay1",serviceId:"srv1",sentBy:"admin@empresa.com",channel:"email"},{id:"msg2",type:"Recordatorio",recipientType:"Cliente",recipientName:"María García",recipientEmail:"maria@ejemplo.com",subject:"Recordatorio de Vencimiento - SRV-241017-789012",message:`Hola María García,

Te recordamos que tu servicio SRV-241017-789012 vence en 3 días.

Para evitar interrupciones, por favor realiza el pago correspondiente.

Gracias por tu atención.

Equipo de Soporte`,status:"Enviado",sentAt:{seconds:Date.now()/1e3-7200},deliveredAt:null,readAt:null,templateId:"reminder_1",serviceId:"srv2",sentBy:"sistema@empresa.com",channel:"email"},{id:"msg3",type:"Rechazo",recipientType:"Cliente",recipientName:"Carlos López",recipientEmail:"carlos@ejemplo.com",subject:"Pago Rechazado - SRV-241017-345678",message:`Estimado/a Carlos López,

Lamentamos informarle que su pago por el servicio SRV-241017-345678 no pudo ser procesado.

Por favor, verifique los datos de su método de pago e intente nuevamente.

Si necesita ayuda, contacte a nuestro equipo de soporte.

Saludos cordiales,
Equipo de Soporte`,status:"Fallido",sentAt:{seconds:Date.now()/1e3-10800},deliveredAt:null,readAt:null,templateId:"rejection_1",paymentId:"pay3",serviceId:"srv3",sentBy:"admin@empresa.com",channel:"email",errorMessage:"Error de conexión con el servidor de email"},{id:"msg4",type:"Notificación",recipientType:"Administrador",recipientName:"Admin Principal",recipientEmail:"admin@empresa.com",subject:"Nuevo Pago Recibido",message:`Se ha recibido un nuevo pago:

- Cliente: Ana Martínez
- Servicio: SRV-241017-456789
- Monto: $75,000 COP
- Método: Transferencia Bancaria

Por favor, verifica y aprueba el pago si es necesario.`,status:"Leído",sentAt:{seconds:Date.now()/1e3-14400},deliveredAt:{seconds:Date.now()/1e3-14300},readAt:{seconds:Date.now()/1e3-14200},templateId:"admin_payment_notification",paymentId:"pay4",serviceId:"srv4",sentBy:"sistema@empresa.com",channel:"email"}]),T(!1);return}const H=or(Ht(qe,"artifacts",Be,"public","data","messages"),Rh("sentAt","desc")),D=nn(H,W=>{const K=W.docs.map(q=>({id:q.id,...q.data()}));i(K),T(!1)},W=>{console.error("Error loading messages:",W),n("Error al cargar los mensajes.","error"),T(!1)});return()=>D()},[t,n]);const ae=async(H,D)=>{if(t){n("Función no disponible en modo demo","error");return}try{const W=mt(qe,"artifacts",Be,"public","data","messages",H);await hr(W,{status:D,updatedAt:new Date}),n(`Estado del mensaje actualizado a ${D}`,"success")}catch(W){console.error("Error updating message status:",W),n("Error al actualizar el estado del mensaje","error")}},B=H=>{P(H),L(!0)},I=H=>({Enviado:"bg-blue-100 text-blue-800",Entregado:"bg-green-100 text-green-800",Leído:"bg-purple-100 text-purple-800",Fallido:"bg-red-100 text-red-800",Pendiente:"bg-yellow-100 text-yellow-800"})[H]||"bg-gray-100 text-gray-800",j=H=>({Aprobación:"bg-green-100 text-green-800",Rechazo:"bg-red-100 text-red-800",Recordatorio:"bg-yellow-100 text-yellow-800",Notificación:"bg-blue-100 text-blue-800",Activación:"bg-purple-100 text-purple-800",Sistema:"bg-gray-100 text-gray-800"})[H]||"bg-gray-100 text-gray-800",S=H=>({Cliente:"bg-blue-100 text-blue-800",Administrador:"bg-purple-100 text-purple-800",Sistema:"bg-gray-100 text-gray-800"})[H]||"bg-gray-100 text-gray-800",N=H=>H?new Date(H.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",w=H=>{switch(H){case"Enviado":return o.jsx(cs,{});case"Entregado":return o.jsx(tA,{});case"Leído":return o.jsx(fl,{});case"Fallido":return o.jsx(tm,{});case"Pendiente":return o.jsx(cs,{});default:return o.jsx(cs,{})}},k=r.filter(H=>{const D=s===""||H.recipientName.toLowerCase().includes(s.toLowerCase())||H.recipientEmail.toLowerCase().includes(s.toLowerCase())||H.subject.toLowerCase().includes(s.toLowerCase())||H.message.toLowerCase().includes(s.toLowerCase()),W=l==="Todos"||H.status===l,K=u==="Todos"||H.type===u,q=g==="Todos"||H.recipientType===g;return D&&W&&K&&q});return p?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[o.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[o.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[o.jsx(np,{}),"Historial de Mensajes"]}),o.jsxs("div",{className:"text-sm text-gray-500",children:[k.length," mensaje",k.length!==1?"s":""," encontrado",k.length!==1?"s":""]})]}),o.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",placeholder:"Buscar por destinatario, asunto o contenido...",value:s,onChange:H=>a(H.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full"}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Ru,{})})]}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{value:l,onChange:H=>c(H.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:M.map(H=>o.jsx("option",{value:H,children:H},H))}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(su,{})})]}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{value:u,onChange:H=>f(H.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:F.map(H=>o.jsx("option",{value:H,children:H},H))}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(np,{})})]}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{value:g,onChange:H=>y(H.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:te.map(H=>o.jsx("option",{value:H,children:H},H))}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(su,{})})]})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsx("tr",{children:["Tipo","Destinatario","Asunto","Estado","Canal","Enviado","Entregado","Leído","Acciones"].map(H=>o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:H},H))})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:k.map(H=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${j(H.type)}`,children:H.type}),o.jsx("span",{className:`ml-2 px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${S(H.recipientType)}`,children:H.recipientType})]})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:H.recipientName}),o.jsx("div",{className:"text-sm text-gray-500",children:H.recipientEmail})]}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",title:H.subject,children:H.subject})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${I(H.status)}`,children:H.status}),o.jsx("div",{className:"ml-2 text-gray-400",children:w(H.status)})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:H.channel||"Email"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:N(H.sentAt)}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:H.deliveredAt?N(H.deliveredAt):"--"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:H.readAt?N(H.readAt):"--"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:o.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[o.jsx("button",{onClick:()=>B(H),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md",title:"Ver mensaje completo",children:o.jsx(fl,{})}),e==="superadmin"&&o.jsxs(Oh,{children:[o.jsx("select",{value:H.status,onChange:D=>ae(H.id,D.target.value),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 border-none bg-transparent",children:M.filter(D=>D!=="Todos").map(D=>o.jsx("option",{value:D,children:D},D))}),o.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:"Reenviar"}),o.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"Eliminar"})]})]})})]},H.id))})]})}),k.length===0&&o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[o.jsx(np,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron mensajes"}),o.jsx("p",{className:"text-gray-500",children:"No hay mensajes que coincidan con los filtros seleccionados."})]}),A&&E&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Detalles del Mensaje"}),o.jsx("button",{onClick:()=>L(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tipo"}),o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${j(E.type)}`,children:E.type})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${I(E.status)}`,children:E.status})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Destinatario"}),o.jsx("div",{className:"text-sm text-gray-900",children:E.recipientName}),o.jsx("div",{className:"text-sm text-gray-500",children:E.recipientEmail})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Canal"}),o.jsx("div",{className:"text-sm text-gray-900",children:E.channel||"Email"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto"}),o.jsx("div",{className:"text-sm text-gray-900 p-3 bg-gray-50 rounded-md",children:E.subject})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contenido del Mensaje"}),o.jsx("div",{className:"text-sm text-gray-900 p-4 bg-gray-50 rounded-md whitespace-pre-wrap max-h-64 overflow-y-auto",children:E.message})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Enviado"}),o.jsx("div",{className:"text-gray-900",children:N(E.sentAt)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Entregado"}),o.jsx("div",{className:"text-gray-900",children:E.deliveredAt?N(E.deliveredAt):"No entregado"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Leído"}),o.jsx("div",{className:"text-gray-900",children:E.readAt?N(E.readAt):"No leído"})]})]}),E.errorMessage&&o.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("label",{className:"block text-sm font-medium text-red-700 mb-1",children:"Error"}),o.jsx("div",{className:"text-sm text-red-600",children:E.errorMessage})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[o.jsx("button",{onClick:()=>L(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cerrar"}),e==="superadmin"&&o.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Reenviar Mensaje"})]})]})]})})]})}function YA({ticketId:t,isDemo:e,userRole:n,currentUser:r}){const{addNotification:i}=kn(),[s,a]=fe.useState([]),[l,c]=fe.useState(""),[u,f]=fe.useState(!0),[g,y]=fe.useState(!1);fe.useEffect(()=>{if(e){a([{id:"msg1",ticketId:t,content:"Hola, tengo un problema con el acceso a mi panel de cliente. No puedo iniciar sesión desde ayer.",senderId:"client1",senderName:"Juan Pérez",senderRole:"client",senderEmail:"juan@ejemplo.com",isInternal:!1,createdAt:{seconds:Date.now()/1e3-3600},attachments:[]},{id:"msg2",ticketId:t,content:"Hola Juan, gracias por contactarnos. He revisado tu cuenta y veo que hay un problema con la configuración de tu perfil. Voy a solucionarlo ahora mismo.",senderId:"admin1",senderName:"Admin Principal",senderRole:"admin",senderEmail:"admin@empresa.com",isInternal:!1,createdAt:{seconds:Date.now()/1e3-1800},attachments:[]},{id:"msg3",ticketId:t,content:"Nota interna: El cliente tiene un problema de configuración en su perfil. Necesito revisar la base de datos.",senderId:"admin1",senderName:"Admin Principal",senderRole:"admin",senderEmail:"admin@empresa.com",isInternal:!0,createdAt:{seconds:Date.now()/1e3-900},attachments:[]}]),f(!1);return}if(!t){f(!1);return}const E=or(Ht(qe,"artifacts",Be,"public","data","ticketMessages"),Or("ticketId","==",t)),P=nn(E,A=>{const L=A.docs.map(M=>({id:M.id,...M.data()}));L.sort((M,F)=>{var B,I;const te=((B=M.createdAt)==null?void 0:B.seconds)||0,ae=((I=F.createdAt)==null?void 0:I.seconds)||0;return te-ae}),a(L),f(!1)},A=>{console.error("Error loading messages:",A),i("Error al cargar los mensajes","error"),f(!1)});return()=>P()},[t,e,i]);const p=async E=>{if(E.preventDefault(),!!l.trim()){if(y(!0),e){const P={id:`msg_${Date.now()}`,ticketId:t,content:l,senderId:(r==null?void 0:r.uid)||"demo",senderName:(r==null?void 0:r.displayName)||"Usuario Demo",senderRole:n||"client",senderEmail:(r==null?void 0:r.email)||"demo@ejemplo.com",isInternal:!1,createdAt:{seconds:Date.now()/1e3},attachments:[]};a(A=>[...A,P]),c(""),y(!1),i("Mensaje enviado (modo demo)","success"),window.updateTicketReplyCount&&window.updateTicketReplyCount(t,s.length+1);return}try{const P={ticketId:t,content:l.trim(),senderId:r.uid,senderName:r.displayName||r.email,senderRole:n,senderEmail:r.email,isInternal:!1,createdAt:lt.now(),attachments:[]};await ao(Ht(qe,"artifacts",Be,"public","data","ticketMessages"),P);const A=mt(qe,"artifacts",Be,"public","data","tickets",t);await hr(A,{replyCount:s.length+1,lastReplyAt:lt.now(),lastReplyBy:r.displayName||r.email,updatedAt:lt.now()}),c(""),i("Mensaje enviado","success")}catch(P){console.error("Error sending message:",P),i("Error al enviar el mensaje","error")}finally{y(!1)}}},T=E=>{if(!E)return"--";const P=new Date,A=new Date(E.seconds*1e3),L=P.getTime()-A.getTime(),M=Math.floor(L/(1e3*60*60*24)),F=Math.floor(L/(1e3*60*60)),te=Math.floor(L/(1e3*60));return M>0?`hace ${M} día${M>1?"s":""}`:F>0?`hace ${F} hora${F>1?"s":""}`:te>0?`hace ${te} minuto${te>1?"s":""}`:"hace unos segundos"};return u?o.jsx("div",{className:"flex justify-center items-center h-32",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:s.length===0?o.jsxs("div",{className:"text-center py-8 text-gray-500",children:[o.jsx(nm,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),o.jsx("p",{children:"No hay mensajes en este ticket"})]}):s.map(E=>o.jsx("div",{className:`flex ${E.senderRole==="client"?"justify-start":"justify-end"}`,children:o.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${E.senderRole==="client"?"bg-gray-100 text-gray-900":E.isInternal?"bg-yellow-100 text-yellow-900 border border-yellow-300":"bg-blue-100 text-blue-900"}`,children:[E.isInternal&&o.jsx("div",{className:"text-xs font-semibold text-yellow-700 mb-1",children:"NOTA INTERNA"}),o.jsx("div",{className:"text-sm whitespace-pre-wrap",children:E.content}),o.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-gray-500",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(hh,{}),o.jsx("span",{children:E.senderName})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(cs,{}),o.jsx("span",{children:T(E.createdAt)})]})]}),E.attachments&&E.attachments.length>0&&o.jsx("div",{className:"mt-2 pt-2 border-t border-gray-300",children:o.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[o.jsx(YR,{}),o.jsxs("span",{children:[E.attachments.length," archivo",E.attachments.length!==1?"s":""]})]})})]})},E.id))}),o.jsx("div",{className:"border-t pt-4",children:o.jsxs("form",{onSubmit:p,className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n==="client"?"Responder al ticket":"Responder al cliente"}),o.jsx("textarea",{value:l,onChange:E=>c(E.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:n==="client"?"Escribe tu respuesta aquí...":"Escribe tu respuesta al cliente aquí...",required:!0})]}),n==="admin"||n==="superadmin"?o.jsx("div",{className:"flex items-center gap-4",children:o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Nota interna (solo visible para administradores)"})]})}):null,o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{type:"submit",disabled:g||!l.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:g?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Enviando..."]}):o.jsxs(o.Fragment,{children:[o.jsx(nm,{}),"Enviar Mensaje"]})})})]})})]})}function JD({isDemo:t,userRole:e}){const{addNotification:n}=kn(),[r,i]=fe.useState([]),[s,a]=fe.useState([]),[l,c]=fe.useState(""),[u,f]=fe.useState("Todos"),[g,y]=fe.useState("Todos"),[p,T]=fe.useState("Todos"),[E,P]=fe.useState(!0),[A,L]=fe.useState(null),[M,F]=fe.useState(!1),[te,ae]=fe.useState(!1),[B,I]=fe.useState({subject:"",department:"Soporte Técnico",priority:"Media",description:"",clientId:"",clientName:"",clientEmail:""}),j=["Todos","Abierto","En Progreso","Respondido","Cerrado","Esperando Cliente"],S=["Todos","Baja","Media","Alta","Crítica"],N=["Todos","Soporte Técnico","Facturación","Ventas","General"];fe.useEffect(()=>{if(t){i([{id:"ticket1",ticketNumber:"TKT-2024-001",subject:"Problema con el acceso al panel de cliente",description:"No puedo acceder a mi panel de cliente desde ayer. Me aparece un error 500.",status:"Abierto",priority:"Alta",department:"Soporte Técnico",clientId:"client1",clientName:"Juan Pérez",clientEmail:"juan@ejemplo.com",assignedTo:null,assignedToName:null,createdAt:{seconds:Date.now()/1e3-3600},updatedAt:{seconds:Date.now()/1e3-3600},lastReplyAt:{seconds:Date.now()/1e3-3600},lastReplyBy:"Cliente",replyCount:0,attachments:[]},{id:"ticket2",ticketNumber:"TKT-2024-002",subject:"Consulta sobre facturación",description:"Necesito una copia de mi factura del mes pasado para contabilidad.",status:"Respondido",priority:"Media",department:"Facturación",clientId:"client2",clientName:"María García",clientEmail:"maria@ejemplo.com",assignedTo:"admin1",assignedToName:"Admin Principal",createdAt:{seconds:Date.now()/1e3-7200},updatedAt:{seconds:Date.now()/1e3-1800},lastReplyAt:{seconds:Date.now()/1e3-1800},lastReplyBy:"Admin Principal",replyCount:2,attachments:["factura_enero.pdf"]},{id:"ticket3",ticketNumber:"TKT-2024-003",subject:"Solicitud de nuevo servicio",description:"Me gustaría contratar un plan de hosting más grande para mi sitio web.",status:"En Progreso",priority:"Baja",department:"Ventas",clientId:"client3",clientName:"Carlos López",clientEmail:"carlos@ejemplo.com",assignedTo:"admin2",assignedToName:"Admin Ventas",createdAt:{seconds:Date.now()/1e3-10800},updatedAt:{seconds:Date.now()/1e3-900},lastReplyAt:{seconds:Date.now()/1e3-900},lastReplyBy:"Admin Ventas",replyCount:1,attachments:[]},{id:"ticket4",ticketNumber:"TKT-2024-004",subject:"Error crítico en el servidor",description:"Mi sitio web está caído y no responde. Es urgente.",status:"Abierto",priority:"Crítica",department:"Soporte Técnico",clientId:"client4",clientName:"Ana Martínez",clientEmail:"ana@ejemplo.com",assignedTo:null,assignedToName:null,createdAt:{seconds:Date.now()/1e3-300},updatedAt:{seconds:Date.now()/1e3-300},lastReplyAt:{seconds:Date.now()/1e3-300},lastReplyBy:"Cliente",replyCount:0,attachments:["error_screenshot.png"]}]),a([{id:"client1",fullName:"Juan Pérez",email:"juan@ejemplo.com"},{id:"client2",fullName:"María García",email:"maria@ejemplo.com"},{id:"client3",fullName:"Carlos López",email:"carlos@ejemplo.com"},{id:"client4",fullName:"Ana Martínez",email:"ana@ejemplo.com"}]),P(!1);return}const O=or(Ht(qe,"artifacts",Be,"public","data","tickets")),X=nn(O,me=>{const ye=me.docs.map(xe=>({id:xe.id,...xe.data()}));ye.sort((xe,ke)=>{var Ne,se;const Ve=((Ne=xe.createdAt)==null?void 0:Ne.seconds)||0;return(((se=ke.createdAt)==null?void 0:se.seconds)||0)-Ve}),i(ye),P(!1)},me=>{console.error("Error loading tickets:",me),n("Error al cargar los tickets.","error"),P(!1)}),Z=or(Ht(qe,"artifacts",Be,"public","data","users"),Or("role","==","client")),le=nn(Z,me=>{const ye=me.docs.map(xe=>({id:xe.id,...xe.data()}));a(ye)},me=>{console.error("Error loading clients:",me)});return()=>{X(),le()}},[t,n]);const w=async(O,X)=>{if(t){n("Función no disponible en modo demo","error");return}try{const Z=mt(qe,"artifacts",Be,"public","data","tickets",O);await hr(Z,{status:X,updatedAt:lt.now()}),n(`Estado del ticket actualizado a ${X}`,"success")}catch(Z){console.error("Error updating ticket status:",Z),n("Error al actualizar el estado del ticket","error")}},k=async(O,X)=>{if(t){n("Función no disponible en modo demo","error");return}try{const Z=mt(qe,"artifacts",Be,"public","data","tickets",O);await hr(Z,{assignedTo:X,assignedToName:X?"Admin Actual":null,updatedAt:lt.now()}),n("Ticket asignado correctamente","success")}catch(Z){console.error("Error assigning ticket:",Z),n("Error al asignar el ticket","error")}},H=O=>{L(O),F(!0)},D=async O=>{if(t){i(X=>X.filter(Z=>Z.id!==O)),n("Ticket eliminado (modo demo)","success");return}try{await Su(mt(qe,"artifacts",Be,"public","data","tickets",O));const X=or(Ht(qe,"artifacts",Be,"public","data","ticketMessages"),Or("ticketId","==",O)),le=(await ga(X)).docs.map(me=>Su(me.ref));await Promise.all(le),n("Ticket eliminado exitosamente","success")}catch(X){console.error("Error deleting ticket:",X),n("Error al eliminar el ticket","error")}},W=async O=>{if(O.preventDefault(),t){const X={id:`ticket_${Date.now()}`,ticketNumber:`TKT-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,subject:B.subject,description:B.description,status:"Abierto",priority:B.priority,department:B.department,clientId:B.clientId||"demo",clientName:B.clientName||"Cliente Demo",clientEmail:B.clientEmail||"demo@ejemplo.com",assignedTo:null,assignedToName:null,createdAt:{seconds:Date.now()/1e3},updatedAt:{seconds:Date.now()/1e3},lastReplyAt:{seconds:Date.now()/1e3},lastReplyBy:"Cliente",replyCount:0,attachments:[]};i(Z=>[X,...Z]),n("Ticket creado (modo demo)","success"),ae(!1),I({subject:"",department:"Soporte Técnico",priority:"Media",description:"",clientId:"",clientName:"",clientEmail:""});return}try{const X={...B,ticketNumber:`TKT-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,status:"Abierto",assignedTo:null,assignedToName:null,createdAt:lt.now(),updatedAt:lt.now(),lastReplyAt:lt.now(),lastReplyBy:"Cliente",replyCount:0,attachments:[]};await ao(Ht(qe,"artifacts",Be,"public","data","tickets"),X),n("Ticket creado exitosamente","success"),ae(!1),I({subject:"",department:"Soporte Técnico",priority:"Media",description:"",clientId:"",clientName:"",clientEmail:""})}catch(X){console.error("Error creating ticket:",X),n("Error al crear el ticket","error")}},K=O=>({Abierto:"bg-red-100 text-red-800","En Progreso":"bg-yellow-100 text-yellow-800",Respondido:"bg-blue-100 text-blue-800",Cerrado:"bg-gray-100 text-gray-800","Esperando Cliente":"bg-orange-100 text-orange-800"})[O]||"bg-gray-100 text-gray-800",q=O=>({Baja:"bg-green-100 text-green-800",Media:"bg-yellow-100 text-yellow-800",Alta:"bg-orange-100 text-orange-800",Crítica:"bg-red-100 text-red-800"})[O]||"bg-gray-100 text-gray-800",ee=O=>({"Soporte Técnico":"bg-blue-100 text-blue-800",Facturación:"bg-green-100 text-green-800",Ventas:"bg-purple-100 text-purple-800",General:"bg-gray-100 text-gray-800"})[O]||"bg-gray-100 text-gray-800",ue=O=>O?new Date(O.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",ce=O=>{switch(O){case"Abierto":return o.jsx(cs,{});case"En Progreso":return o.jsx(cs,{});case"Respondido":return o.jsx(tA,{});case"Cerrado":return o.jsx(tm,{});case"Esperando Cliente":return o.jsx(hh,{});default:return o.jsx(cs,{})}},_=O=>{if(!O)return"--";const X=new Date,Z=new Date(O.seconds*1e3),le=X.getTime()-Z.getTime(),me=Math.floor(le/(1e3*60*60*24)),ye=Math.floor(le/(1e3*60*60)),xe=Math.floor(le/(1e3*60));return me>0?`hace ${me} día${me>1?"s":""}`:ye>0?`hace ${ye} hora${ye>1?"s":""}`:xe>0?`hace ${xe} minuto${xe>1?"s":""}`:"hace unos segundos"},z=r.filter(O=>{const X=l===""||O.ticketNumber.toLowerCase().includes(l.toLowerCase())||O.subject.toLowerCase().includes(l.toLowerCase())||O.clientName.toLowerCase().includes(l.toLowerCase())||O.clientEmail.toLowerCase().includes(l.toLowerCase())||O.description.toLowerCase().includes(l.toLowerCase()),Z=u==="Todos"||O.status===u,le=g==="Todos"||O.priority===g,me=p==="Todos"||O.department===p;return X&&Z&&le&&me});return E?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[o.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[o.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[o.jsx(Jl,{}),"Sistema de Tickets"]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{className:"text-sm text-gray-500",children:[z.length," ticket",z.length!==1?"s":""," encontrado",z.length!==1?"s":""]}),o.jsxs("button",{onClick:()=>ae(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[o.jsx(Dh,{}),"Nuevo Ticket"]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:o.jsx(cs,{})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Abiertos"}),o.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(O=>O.status==="Abierto").length})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:o.jsx(cs,{})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"En Progreso"}),o.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(O=>O.status==="En Progreso").length})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:o.jsx(hh,{})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Esperando Cliente"}),o.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(O=>O.status==="Esperando Cliente").length})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:o.jsx(tm,{})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Críticos"}),o.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(O=>O.priority==="Crítica").length})]})]})})]}),o.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",placeholder:"Buscar por número, asunto, cliente...",value:l,onChange:O=>c(O.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full"}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Ru,{})})]}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{value:u,onChange:O=>f(O.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:j.map(O=>o.jsx("option",{value:O,children:O},O))}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(su,{})})]}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{value:g,onChange:O=>y(O.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:S.map(O=>o.jsx("option",{value:O,children:O},O))}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(su,{})})]}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{value:p,onChange:O=>T(O.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:N.map(O=>o.jsx("option",{value:O,children:O},O))}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(su,{})})]})]})}),o.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsx("tr",{children:["Ticket","Cliente","Asunto","Estado","Prioridad","Departamento","Asignado","Última Actividad","Respuestas","Acciones"].map(O=>o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:O},O))})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:z.map(O=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:O.ticketNumber}),o.jsx("div",{className:"text-xs text-gray-500",children:ue(O.createdAt)})]}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:O.clientName}),o.jsx("div",{className:"text-sm text-gray-500",children:O.clientEmail})]}),o.jsxs("td",{className:"px-6 py-4",children:[o.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",title:O.subject,children:O.subject}),o.jsx("div",{className:"text-xs text-gray-500 max-w-xs truncate",title:O.description,children:O.description})]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${K(O.status)}`,children:O.status}),o.jsx("div",{className:"ml-2 text-gray-400",children:ce(O.status)})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${q(O.priority)}`,children:O.priority})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ee(O.department)}`,children:O.department})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:O.assignedToName||"Sin asignar"}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[o.jsx("div",{children:_(O.lastReplyAt)}),o.jsxs("div",{className:"text-xs text-gray-400",children:["por ",O.lastReplyBy]})]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(nm,{}),o.jsx("span",{className:"ml-1",children:O.replyCount})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:o.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[o.jsx("button",{onClick:()=>H(O),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md",title:"Ver ticket completo",children:o.jsx(fl,{})}),e==="superadmin"&&o.jsxs(Oh,{children:[o.jsx("select",{value:O.status,onChange:X=>w(O.id,X.target.value),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 border-none bg-transparent",children:j.filter(X=>X!=="Todos").map(X=>o.jsx("option",{value:X,children:X},X))}),o.jsx("button",{onClick:()=>k(O.id,O.assignedTo?null:"admin"),className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:O.assignedTo?"Desasignar":"Asignar"}),o.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:"Responder"}),o.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-orange-700 hover:bg-orange-50",children:"Cerrar Ticket"}),o.jsx("button",{onClick:()=>{window.confirm("¿Estás seguro de que quieres eliminar este ticket? Esta acción no se puede deshacer.")&&D(O.id)},className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"Eliminar Ticket"})]})]})})]},O.id))})]})}),z.length===0&&o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[o.jsx(Jl,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron tickets"}),o.jsx("p",{className:"text-gray-500",children:"No hay tickets que coincidan con los filtros seleccionados."})]}),M&&A&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:["Ticket ",A.ticketNumber]}),o.jsx("button",{onClick:()=>F(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cliente"}),o.jsx("div",{className:"text-sm text-gray-900",children:A.clientName}),o.jsx("div",{className:"text-sm text-gray-500",children:A.clientEmail})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Asignado a"}),o.jsx("div",{className:"text-sm text-gray-900",children:A.assignedToName||"Sin asignar"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${K(A.status)}`,children:A.status})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prioridad"}),o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${q(A.priority)}`,children:A.priority})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Departamento"}),o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ee(A.department)}`,children:A.department})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Creado"}),o.jsx("div",{className:"text-sm text-gray-900",children:ue(A.createdAt)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto"}),o.jsx("div",{className:"text-sm text-gray-900 p-3 bg-gray-50 rounded-md",children:A.subject})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción"}),o.jsx("div",{className:"text-sm text-gray-900 p-4 bg-gray-50 rounded-md whitespace-pre-wrap",children:A.description})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Historial de Mensajes"}),o.jsx("div",{className:"border border-gray-200 rounded-md p-4",children:o.jsx(YA,{ticketId:A.id,isDemo:t,userRole:e,currentUser:{uid:"admin",displayName:"Admin",email:"admin@empresa.com"}})})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[o.jsx("button",{onClick:()=>F(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cerrar"}),e==="superadmin"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Responder"}),o.jsx("button",{onClick:()=>{window.confirm("¿Estás seguro de que quieres eliminar este ticket? Esta acción no se puede deshacer.")&&(D(A.id),F(!1))},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Eliminar Ticket"})]})]})]})]})}),te&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Crear Nuevo Ticket"}),o.jsx("button",{onClick:()=>ae(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),o.jsxs("form",{onSubmit:W,className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cliente"}),o.jsxs("select",{value:B.clientId,onChange:O=>{const X=s.find(Z=>Z.id===O.target.value);I(Z=>({...Z,clientId:O.target.value,clientName:(X==null?void 0:X.fullName)||"",clientEmail:(X==null?void 0:X.email)||""}))},className:"w-full p-2 border rounded-md",required:!0,children:[o.jsx("option",{value:"",children:"Seleccionar cliente"}),s.map(O=>o.jsxs("option",{value:O.id,children:[O.fullName," (",O.email,")"]},O.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento"}),o.jsx("select",{value:B.department,onChange:O=>I(X=>({...X,department:O.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:N.filter(O=>O!=="Todos").map(O=>o.jsx("option",{value:O,children:O},O))})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridad"}),o.jsx("select",{value:B.priority,onChange:O=>I(X=>({...X,priority:O.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:S.filter(O=>O!=="Todos").map(O=>o.jsx("option",{value:O,children:O},O))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email del Cliente"}),o.jsx("input",{type:"email",value:B.clientEmail,onChange:O=>I(X=>({...X,clientEmail:O.target.value})),className:"w-full p-2 border rounded-md",placeholder:"email@ejemplo.com",required:!0})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto *"}),o.jsx("input",{type:"text",value:B.subject,onChange:O=>I(X=>({...X,subject:O.target.value})),className:"w-full p-2 border rounded-md",placeholder:"Describe brevemente el problema o consulta",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción *"}),o.jsx("textarea",{value:B.description,onChange:O=>I(X=>({...X,description:O.target.value})),className:"w-full p-2 border rounded-md",rows:6,placeholder:"Describe el problema o consulta en detalle...",required:!0})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[o.jsx("button",{type:"button",onClick:()=>ae(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Crear Ticket"})]})]})]})})]})}function ZD({isDemo:t,setIsDemoMode:e,onLogout:n}){const{addNotification:r}=kn(),[i,s]=fe.useState({}),a="company_info";fe.useEffect(()=>{if(t){s({companyName:"Mi Empresa (Demo)",identification:"123.456.789-0",address:"Calle Falsa 123, Ciudad Demo",phone:"+57 300 123 4567",email:"contacto@empresa-demo.com",website:"www.empresa-demo.com",logoUrl:"https://placehold.co/200x80/1d4ed8/ffffff?text=Mi+Logo"});return}const f=mt(qe,"artifacts",Be,"public","data","settings",a);return nn(f,y=>{y.exists()&&s(y.data())})},[t]);const l=f=>{const{name:g,value:y}=f.target;s(p=>({...p,[g]:y}))},c=()=>{const f=!t;e(f),f&&r("Modo demo activado. Recuerda guardar la configuración para aplicar los cambios.","info")},u=async()=>{if(t){r("Función no disponible en modo demo.","error");return}try{const f=mt(qe,"artifacts",Be,"public","data","settings",a),g={...i,isDemoMode:t,allowDemoMode:!0};await va(f,g,{merge:!0}),r("Configuración de la empresa guardada.","success"),t&&n&&(r("Modo demo activado. Cerrando sesión para probar los botones de demo...","info"),setTimeout(()=>{n()},2e3))}catch{r("Error al guardar la configuración.","error")}};return o.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[o.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Configuración"}),o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md max-w-4xl mx-auto space-y-8",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-bold mb-4",children:"Información de Facturación y Contacto"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsx("input",{name:"companyName",value:i.companyName||"",onChange:l,placeholder:"Nombre de la Empresa",className:"w-full p-2 border rounded-md"}),o.jsx("input",{name:"identification",value:i.identification||"",onChange:l,placeholder:"NIT / Identificación Fiscal",className:"w-full p-2 border rounded-md"}),o.jsx("input",{name:"address",value:i.address||"",onChange:l,placeholder:"Dirección",className:"w-full p-2 border rounded-md"}),o.jsx("input",{name:"phone",value:i.phone||"",onChange:l,placeholder:"Teléfono",className:"w-full p-2 border rounded-md"}),o.jsx("input",{name:"email",type:"email",value:i.email||"",onChange:l,placeholder:"Email de Contacto",className:"w-full p-2 border rounded-md"}),o.jsx("input",{name:"website",value:i.website||"",onChange:l,placeholder:"Sitio Web",className:"w-full p-2 border rounded-md"})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-bold mt-8 mb-4",children:"Branding"}),o.jsx("input",{name:"logoUrl",value:i.logoUrl||"",onChange:l,placeholder:"URL del Logo (enlace a la imagen)",className:"w-full p-2 border rounded-md"}),i.logoUrl&&o.jsx("img",{src:i.logoUrl,alt:"Vista previa del logo",className:"mt-4 max-h-20 bg-gray-100 p-2 rounded"})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-bold mb-4",children:"Modo de Operación"}),o.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-800",children:"Activar Modo de Prueba"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Usa datos de ejemplo sin afectar la información real. En modo prueba aparecerán botones separados para admin y cliente."})]}),o.jsx("label",{htmlFor:"demoToggle",className:"flex items-center cursor-pointer",children:o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"checkbox",id:"demoToggle",className:"sr-only",checked:t,onChange:c}),o.jsx("div",{className:"block bg-gray-600 w-14 h-8 rounded-full"}),o.jsx("div",{className:"dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition"})]})})]}),t&&o.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[o.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Modo de Prueba Activado"}),o.jsxs("p",{className:"text-sm text-blue-700 mb-2",children:["En el login aparecerán dos botones:",o.jsx("br",{}),"• ",o.jsx("strong",{children:"Administrador:"})," Acceso completo al sistema",o.jsx("br",{}),"• ",o.jsx("strong",{children:"Cliente:"})," Vista limitada de servicios y tickets"]}),o.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded",children:o.jsx("p",{className:"text-sm text-yellow-800 font-medium",children:"⚠️ Recuerda guardar la configuración para aplicar los cambios. Se cerrará la sesión automáticamente para probar los botones de demo."})})]}),o.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[o.jsx("h4",{className:"font-semibold text-green-800 mb-2",children:"🔧 Herramientas de Desarrollo"}),o.jsx("p",{className:"text-sm text-green-700 mb-2",children:"Al activar el modo de prueba, también se habilitarán:"}),o.jsxs("ul",{className:"text-sm text-green-700 list-disc list-inside space-y-1",children:[o.jsx("li",{children:"Botón de cambio entre modo Demo/Live en el login"}),o.jsx("li",{children:"Botón de diagnóstico de Firebase para debugging"}),o.jsx("li",{children:"Acceso a herramientas de desarrollo"})]})]})]}),o.jsx("button",{onClick:u,className:"mt-4 px-5 py-2 bg-blue-600 text-white font-semibold rounded-md shadow-sm hover:bg-blue-700",children:"Guardar Configuración"})]})]})}function eO({user:t,isDemo:e,setIsDemoMode:n,userRole:r,companySettings:i,onLogout:s}){const[a,l]=fe.useState("services"),c=()=>{switch(a){case"users":return o.jsx(r8,{isDemo:e,userRole:r});case"templates":return o.jsx(i8,{isDemo:e});case"messages":return o.jsx(XD,{isDemo:e,userRole:r});case"tickets":return o.jsx(JD,{isDemo:e,userRole:r});case"payments":return o.jsx(QD,{isDemo:e,userRole:r});case"payment-config":return o.jsx(rA,{isDemo:e});case"settings":return o.jsx(ZD,{isDemo:e,setIsDemoMode:n,onLogout:s});case"services":default:return o.jsx(ZR,{isDemo:e,userRole:r})}};return o.jsxs("main",{className:"container mx-auto",children:[o.jsx("div",{className:"border-b border-gray-200",children:o.jsxs("nav",{className:"-mb-px flex space-x-8 px-4 sm:px-6 lg:px-8","aria-label":"Tabs",children:[o.jsxs("button",{onClick:()=>l("services"),className:`${a==="services"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[o.jsx(em,{})," Servicios"]}),r==="superadmin"&&o.jsxs("button",{onClick:()=>l("users"),className:`${a==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[o.jsx($R,{})," Usuarios"]}),o.jsxs("button",{onClick:()=>l("templates"),className:`${a==="templates"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[o.jsx(eA,{})," Plantillas"]}),o.jsxs("button",{onClick:()=>l("messages"),className:`${a==="messages"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[o.jsx(np,{})," Mensajes"]}),o.jsxs("button",{onClick:()=>l("payments"),className:`${a==="payments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[o.jsx(Yi,{})," Pagos"]}),o.jsxs("button",{onClick:()=>l("tickets"),className:`${a==="tickets"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[o.jsx(Jl,{})," Tickets"]}),r==="superadmin"&&o.jsxs("button",{onClick:()=>l("settings"),className:`${a==="settings"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[o.jsx(HR,{})," Empresa"]})]})}),c()]})}function tO({isOpen:t,onClose:e,onConfirm:n,service:r,paymentType:i,warningMessage:s}){if(!t)return null;const a=()=>i==="One-Time"?o.jsx(Yi,{className:"h-8 w-8 text-blue-600"}):o.jsx(al,{className:"h-8 w-8 text-green-600"}),l=()=>i==="One-Time"?"Solicitar Pago Único":"Solicitar Pago de Renovación",c=()=>i==="One-Time"?"Esta es una solicitud de pago único que no se renovará automáticamente":"Esta solicitud renovará tu servicio por el período seleccionado",u=()=>i==="One-Time"?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"bg-green-600 hover:bg-green-700 focus:ring-green-500";return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 transform transition-all",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"flex-shrink-0",children:a()}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:l()}),o.jsx("p",{className:"text-sm text-gray-500",children:c()})]})]})}),o.jsxs("div",{className:"px-6 py-4",children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h4",{className:"font-medium text-gray-900",children:r.serviceType}),o.jsxs("span",{className:"text-sm font-semibold text-gray-600",children:[r.currency," ",r.amount.toFixed(2)]})]}),o.jsx("p",{className:"text-sm text-gray-600 mb-2",children:r.description}),o.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[o.jsxs("span",{children:["Número: ",r.serviceNumber]}),i!=="One-Time"&&o.jsxs("span",{children:["Ciclo: ",r.billingCycle]})]})]}),o.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(QR,{className:"h-5 w-5 text-amber-600 flex-shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h5",{className:"text-sm font-medium text-amber-800 mb-1",children:"Información Importante"}),o.jsx("p",{className:"text-sm text-amber-700",children:s})]})]})}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Tipo de Pago:"}),o.jsx("span",{className:"font-medium text-gray-900",children:i==="One-Time"?"Pago Único":"Renovación"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Monto:"}),o.jsxs("span",{className:"font-medium text-gray-900",children:[r.currency," ",r.amount.toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Método de Pago:"}),o.jsx("span",{className:"font-medium text-gray-900",children:"Transferencia Bancaria"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600",children:"Estado Inicial:"}),o.jsx("span",{className:"font-medium text-amber-600",children:"Pendiente"})]})]})]}),o.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-2xl flex justify-end space-x-3",children:[o.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors",children:"Cancelar"}),o.jsx("button",{onClick:n,className:`px-6 py-2 text-sm font-medium text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors ${u()}`,children:i==="One-Time"?"Solicitar Pago Único":"Solicitar Renovación"})]})]})})}function nO({user:t,isDemo:e,userProfile:n}){const{addNotification:r}=kn(),[i,s]=fe.useState([]),[a,l]=fe.useState(!0),[c,u]=fe.useState(new Set),[f,g]=fe.useState(new Set),[y,p]=fe.useState({}),[T,E]=fe.useState(null),[P,A]=fe.useState({isOpen:!1,service:null}),L=w=>{if(!w.dueDate||!w.billingCycle||w.billingCycle==="One-Time")return w.expirationDate?new Date(w.expirationDate.seconds*1e3):null;const k=new Date(w.dueDate.seconds*1e3);let H=new Date(k);switch(w.billingCycle){case"Monthly":H.setMonth(H.getMonth()+1);break;case"Semiannually":H.setMonth(H.getMonth()+6);break;case"Annually":H.setFullYear(H.getFullYear()+1);break;case"Biennially":H.setFullYear(H.getFullYear()+2);break;case"Triennially":H.setFullYear(H.getFullYear()+3);break;default:return null}return H},M=w=>{const k=L(w);return k?k.toLocaleDateString():"N/A"},F=w=>({"One-Time":"Pago único",Monthly:"Mensual",Semiannually:"Semestral",Annually:"Anual",Biennially:"Bianual",Triennially:"Trienal",Custom:"Personalizado"})[w]||w,te=w=>{if(c.has(w.id)){r("Ya se está solicitando un pago para este servicio","warning");return}if(f.has(w.id)){r("Ya existe una solicitud de pago pendiente para este servicio","warning");return}A({isOpen:!0,service:w})},ae=async w=>{if(e){r("Solicitud de pago creada exitosamente (modo demo)","success"),A({isOpen:!1,service:null});return}u(k=>new Set(k).add(w.id));try{let k;if(w.billingCycle==="One-Time")k=w.dueDate?new Date(w.dueDate.seconds*1e3):new Date,k.setDate(k.getDate()+30);else{const _=L(w);_?k=_:k=new Date(Date.now()+30*24*60*60*1e3)}const H=_=>{if(!_)return null;if(_.gateways)return _.gateways;const{bold:z,paypal:O,payu:X,bankTransfer:Z}=_,le={};return z&&(le.bold={name:"Bold",...z}),O&&(le.paypal={name:"PayPal",...O}),X&&(le.payu={name:"PayU",...X}),Z&&(le.bankTransfer={name:"Transferencia Bancaria",...Z}),le},[D,W]=fe.useState(null);fe.useEffect(()=>{if(e){W({gateways:{bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}}});return}const _=mt(qe,"artifacts",Be,"public","data","settings","paymentConfig"),z=nn(_,O=>{O.exists()&&W(O.data())});return()=>z()},[e]);let K=D&&H(D);const q=K?Object.values(K).filter(_=>_.enabled):[];let ee="Transferencia Bancaria",ue="Transferencia Bancaria";q.length===1?(ee=q[0].name,ue=q[0].name):q.length>1&&(ee="Pendiente de Selección",ue=w.billingCycle==="One-Time"?"Pago Único":"Renovación");const ce={serviceId:w.id,serviceNumber:w.serviceNumber,serviceType:w.serviceType,description:w.description,amount:w.amount,currency:w.currency,status:"Pendiente",gateway:ee,userId:t.uid,clientName:(n==null?void 0:n.fullName)||"Cliente",clientEmail:t.email,dueDate:lt.fromDate(k),createdAt:lt.now(),paymentMethod:ue,notes:`Solicitud de pago automática para servicio ${w.serviceNumber} - Ciclo: ${F(w.billingCycle)}`,billingCycle:w.billingCycle,isAutoGenerated:!0,originalServiceDueDate:w.dueDate?w.dueDate.toDate?w.dueDate:lt.fromDate(new Date(w.dueDate)):null,paymentType:w.billingCycle==="One-Time"?"Pago Único":"Renovación"};await ao(Ht(qe,"artifacts",Be,"public","data","payments"),ce),r("Solicitud de pago creada exitosamente. Revisa la sección de pagos.","success"),A({isOpen:!1,service:null})}catch(k){console.error("Error generating payment:",k),r("Error al crear la solicitud de pago. Intenta nuevamente.","error")}finally{u(k=>{const H=new Set(k);return H.delete(w.id),H})}},B=w=>{localStorage.setItem("selectedServiceForRenewal",JSON.stringify({id:w.id,serviceNumber:w.serviceNumber,serviceType:w.serviceType,description:w.description,amount:w.amount,currency:w.currency,billingCycle:w.billingCycle,dueDate:w.dueDate})),window.location.hash==="#renewals"?(window.location.hash="",setTimeout(()=>{window.location.hash="renewals"},50)):window.location.hash="renewals",r("Redirigiendo a renovaciones para este servicio","success")};fe.useEffect(()=>{if(e){g(new Set(["demo1","demo2"]));return}if(!(t!=null&&t.uid))return;const w=or(Ht(qe,"artifacts",Be,"public","data","payments"),Or("userId","==",t.uid),Or("status","==","Pendiente")),k=nn(w,H=>{const D=new Set,W={};H.docs.forEach(K=>{const q=K.data();q.serviceId&&(D.add(q.serviceId),W[q.serviceId]={id:K.id,...q})}),g(D),p(W)});return()=>k()},[t==null?void 0:t.uid,e]),fe.useEffect(()=>{if(e){E({renewalSettings:{reminderDays:10,gracePeriodDays:7}});return}const w=mt(qe,"artifacts",Be,"public","data","settings","renewalConfig"),k=nn(w,H=>{H.exists()&&E(H.data())});return()=>k()},[e]);const I=w=>{if(!w||w.billingCycle==="One-Time")return null;const k=L(w);if(!k)return null;const H=new Date;return Math.ceil((k.getTime()-H.getTime())/(1e3*60*60*24))};fe.useEffect(()=>{if(e||!(T!=null&&T.renewalSettings)||!(t!=null&&t.uid))return;const w=Number(T.renewalSettings.reminderDays??0),k=Number(T.renewalSettings.gracePeriodDays??0);(async()=>{for(const D of i){if(!D||D.billingCycle==="One-Time")continue;const W=I(D);if(W!=null){if(W<=w&&W>=-k&&!f.has(D.id))try{await ae(D)}catch(K){console.error("Auto-generate payment failed:",K)}if(W<-k){const K=y[D.id];if(K!=null&&K.id)try{await hr(mt(qe,"artifacts",Be,"public","data","payments",K.id),{status:"Cancelado",updatedAt:new Date,cancelReason:"Periodo de gracia agotado"}),r(`Solicitud de pago cancelada por período de gracia (${D.serviceNumber})`,"warning")}catch(q){console.error("Auto-cancel payment failed:",q)}}}}})()},[i,T,f,y,t==null?void 0:t.uid,e]),fe.useEffect(()=>{if(e){s([{id:"demo1",serviceNumber:"SRV-241017-123456",serviceType:"Hosting",description:"Plan Básico - 1GB",amount:10.99,currency:"USD",status:"Activo",dueDate:{seconds:Date.now()/1e3+30*24*60*60},billingCycle:"Monthly",clientNotes:"Servicio de hosting básico"},{id:"demo2",serviceNumber:"SRV-241017-789012",serviceType:"Dominio",description:"midominio.com",amount:15,currency:"USD",status:"Pendiente Pago",dueDate:{seconds:Date.now()/1e3+10*24*60*60},billingCycle:"Annually",clientNotes:"Renovación de dominio"}]),l(!1);return}if(!(t!=null&&t.uid)){l(!1);return}const w=or(Ht(qe,"artifacts",Be,"public","data","services"),Or("assignedUserId","==",t.uid)),k=nn(w,H=>{const D=H.docs.map(W=>({id:W.id,...W.data()}));D.sort((W,K)=>{var ue,ce;const q=((ue=W.createdAt)==null?void 0:ue.seconds)||0;return(((ce=K.createdAt)==null?void 0:ce.seconds)||0)-q}),s(D),l(!1)},H=>{console.error("Error loading services:",H),r("Error al cargar los servicios","error"),l(!1)});return()=>k()},[t==null?void 0:t.uid,e,r]);const j=w=>({Activo:"bg-green-100 text-green-800","Periodo de Gracia Vencido":"bg-yellow-100 text-yellow-800","Pendiente Pago":"bg-red-100 text-red-800",Pago:"bg-blue-100 text-blue-800",Cancelado:"bg-gray-100 text-gray-800"})[w]||"bg-gray-100 text-gray-800",S=w=>w?new Date(w.seconds*1e3).toLocaleDateString("es-ES"):"--",N=(w,k)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:k||"USD"}).format(w);return a?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[o.jsx(em,{}),"Mis Servicios Contratados"]}),o.jsxs("div",{className:"text-sm text-gray-500",children:[i.length," servicio",i.length!==1?"s":""," encontrado",i.length!==1?"s":""]})]}),i.length===0?o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[o.jsx(em,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes servicios asignados"}),o.jsx("p",{className:"text-gray-500",children:"Contacta al administrador para que te asigne servicios."})]}):o.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:o.jsxs("table",{className:"w-full text-left",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsx("tr",{children:["Número","Servicio","Descripción","Monto","Estado","Ciclo","Fecha de Inicio","Fecha de Vencimiento","Notas","Acciones"].map(w=>o.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:w},w))})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:i.map(w=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4",children:o.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:w.serviceNumber||"N/A"})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("div",{className:"font-medium text-gray-900",children:w.serviceType})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("div",{className:"text-gray-900",children:w.description})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("div",{className:"font-medium text-gray-900",children:N(w.amount,w.currency)})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${j(w.status)}`,children:w.status})}),o.jsxs("td",{className:"px-6 py-4",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:F(w.billingCycle)}),w.billingCycle==="Custom"&&w.customBillingCycle&&o.jsxs("div",{className:"text-xs text-gray-500",children:["(",w.customBillingCycle,")"]})]}),o.jsxs("td",{className:"px-6 py-4",children:[o.jsx("div",{className:"text-sm text-gray-900",children:S(w.dueDate)}),o.jsx("div",{className:"text-xs text-gray-500",children:"Inicio"})]}),o.jsxs("td",{className:"px-6 py-4",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:M(w)}),o.jsx("div",{className:"text-xs text-gray-500",children:"Vencimiento"})]}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("div",{className:"text-gray-600 text-sm max-w-xs truncate",children:w.clientNotes||"--"})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("div",{className:"flex items-center space-x-2",children:f.has(w.id)?o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-xs text-orange-600 font-medium mb-1",children:"Por pagar"}),o.jsxs("button",{onClick:()=>window.location.href="#payments",className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700",title:"Ir a Pago",children:[o.jsx(fl,{className:"h-4 w-4 mr-1"}),"Ir a Pago"]})]}):o.jsxs("div",{className:"flex flex-col space-y-2",children:[o.jsxs("button",{onClick:()=>{const k=I(w);if(w.billingCycle!=="One-Time"&&(k==null||T!=null&&T.renewalSettings&&k>(T.renewalSettings.reminderDays??0))){B(w);return}te(w)},disabled:c.has(w.id),className:`inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${c.has(w.id)?"text-gray-400 bg-gray-200 cursor-not-allowed":"text-white bg-blue-600 hover:bg-blue-700"}`,title:c.has(w.id)?"Creando solicitud...":w.billingCycle==="One-Time"?"Solicitar de Nuevo":"Solicitar de Nuevo (irá a Renovaciones fuera de ventana)",children:[o.jsx(Yi,{className:"h-4 w-4 mr-1"}),c.has(w.id)?"Creando...":f.has(w.id)?"Ir a Pago":"Solicitar de Nuevo"]}),w.billingCycle!=="One-Time"&&o.jsxs("button",{onClick:()=>B(w),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",title:"Aumentar ciclo de este servicio",children:[o.jsx(al,{className:"h-4 w-4 mr-1"}),"Aumentar Ciclo"]})]})})})]},w.id))})]})}),P.isOpen&&P.service&&o.jsx(tO,{isOpen:P.isOpen,onClose:()=>A({isOpen:!1,service:null}),onConfirm:()=>ae(P.service),service:P.service,paymentType:P.service.billingCycle,warningMessage:P.service.billingCycle==="One-Time"?`Se creará una solicitud de pago único para el servicio "${P.service.serviceType}". La solicitud vencerá en 30 días desde la fecha actual.`:`Se creará una solicitud de pago de renovación para el servicio "${P.service.serviceType}" con ciclo ${F(P.service.billingCycle)}. La solicitud vencerá en la fecha de vencimiento del servicio.`})]})}function rO({bankAccounts:t,serviceNumber:e,amount:n,currency:r,onUpload:i}){const s=(a,l)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:l||"USD"}).format(a);return!t||t.length===0?o.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:o.jsx("p",{className:"text-yellow-800",children:"No hay cuentas bancarias configuradas. Contacta al administrador."})}):o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[o.jsx(Yi,{}),o.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Instrucciones para Transferencia Bancaria"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[o.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Información del Pago"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-gray-700",children:"Número de Servicio:"}),o.jsx("span",{className:"ml-2 font-mono text-blue-600",children:e})]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-gray-700",children:"Monto a Pagar:"}),o.jsx("span",{className:"ml-2 font-semibold text-green-600",children:s(n,r)})]})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Cuentas Disponibles para Transferencia"}),o.jsx("div",{className:"space-y-4",children:t.map((a,l)=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h5",{className:"font-medium text-gray-700",children:["Opción ",l+1]}),o.jsx("span",{className:"text-sm text-gray-500",children:a.accountType})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-gray-600",children:"Banco:"}),o.jsx("span",{className:"ml-2 text-gray-800",children:a.bankName})]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-gray-600",children:"Número de Cuenta:"}),o.jsx("span",{className:"ml-2 font-mono text-blue-600",children:a.accountNumber})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("span",{className:"font-medium text-gray-600",children:"Titular:"}),o.jsx("span",{className:"ml-2 text-gray-800",children:a.accountHolder})]})]})]},a.id))})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[o.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Instrucciones Paso a Paso"}),o.jsxs("ol",{className:"space-y-2 text-sm text-gray-700",children:[o.jsxs("li",{className:"flex items-start",children:[o.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"1"}),o.jsx("span",{children:"Realiza una transferencia bancaria a cualquiera de las cuentas mostradas arriba"})]}),o.jsxs("li",{className:"flex items-start",children:[o.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"2"}),o.jsxs("span",{children:["Usa el ",o.jsx("strong",{children:"Número de Servicio"})," como referencia en la transferencia"]})]}),o.jsxs("li",{className:"flex items-start",children:[o.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"3"}),o.jsxs("span",{children:["Transfiere el monto exacto: ",o.jsx("strong",{children:s(n,r)})]})]}),o.jsxs("li",{className:"flex items-start",children:[o.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"4"}),o.jsx("span",{children:"Guarda el comprobante de transferencia"})]}),o.jsxs("li",{className:"flex items-start",children:[o.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"5"}),o.jsx("span",{children:"Envía el comprobante por email o sube una foto en el sistema"})]})]})]}),o.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[o.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"⚠️ Información Importante"}),o.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[o.jsx("li",{children:"• El pago puede tardar hasta 24 horas en ser procesado"}),o.jsx("li",{children:"• Asegúrate de incluir el número de servicio como referencia"}),o.jsx("li",{children:"• El monto debe ser exacto para evitar retrasos"}),o.jsx("li",{children:"• Contacta al administrador si tienes alguna duda"})]})]}),o.jsx("div",{className:"text-center",children:o.jsxs("label",{className:"inline-block px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium cursor-pointer",children:["Subir Comprobante de Transferencia",o.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:a=>{var l;return i&&((l=a.target.files)==null?void 0:l[0])&&i(a.target.files[0])}})]})})]})]})}function iO({user:t,isDemo:e,userProfile:n}){const{addNotification:r}=kn(),[i,s]=fe.useState([]),[a,l]=fe.useState(""),[c,u]=fe.useState("Todos"),[f,g]=fe.useState(!0),[y,p]=fe.useState([]),[T,E]=fe.useState(!1),[P,A]=fe.useState(null),[L,M]=fe.useState(null),[F,te]=fe.useState({}),[ae,B]=fe.useState(!1),[I,j]=fe.useState(null),S=()=>{if(!L)return null;if(L.gateways)return L.gateways;const{bold:_,paypal:z,payu:O,bankTransfer:X}=L,Z={};return _&&(Z.bold={name:"Bold",..._}),z&&(Z.paypal={name:"PayPal",...z}),O&&(Z.payu={name:"PayU",...O}),X&&(Z.bankTransfer={name:"Transferencia Bancaria",...X}),Z},N=["Todos","Pendiente","Procesando","Completado","Fallido","Cancelado","Reembolsado"];fe.useEffect(()=>{if(e){M({gateways:{bold:{enabled:!0,name:"Bold",autoApprove:!1},paypal:{enabled:!0,name:"PayPal",autoApprove:!1},payu:{enabled:!0,name:"PayU",autoApprove:!1},bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}},bankAccounts:[{id:"1",bank:"Banco Nacional",accountNumber:"1234567890",accountHolder:"Mi Empresa"},{id:"2",bank:"Banco Popular",accountNumber:"0987654321",accountHolder:"Mi Empresa"}]});return}const _=mt(qe,"artifacts",Be,"public","data","settings","paymentConfig"),z=nn(_,O=>{O.exists()?(M(O.data()),console.log("Payment config loaded:",O.data())):(console.log("No payment config found, using defaults"),M({gateways:{bold:{enabled:!0,name:"Bold",autoApprove:!1},paypal:{enabled:!0,name:"PayPal",autoApprove:!1},payu:{enabled:!0,name:"PayU",autoApprove:!1},bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}},bankAccounts:[]}))},O=>{console.error("Error loading payment config:",O)});return()=>z()},[e]),fe.useEffect(()=>{if(e){s([{id:"demo1",serviceNumber:"SRV-241017-123456",serviceType:"Hosting",amount:10.99,currency:"USD",status:"Completado",gateway:"Bold",transactionId:"bold_txn_123456",createdAt:{seconds:Date.now()/1e3-86400},completedAt:{seconds:Date.now()/1e3-3600}},{id:"demo2",serviceNumber:"SRV-241017-789012",serviceType:"Dominio",amount:25,currency:"USD",status:"Pendiente",gateway:"PayPal",transactionId:"paypal_txn_789012",createdAt:{seconds:Date.now()/1e3-7200}},{id:"demo3",serviceNumber:"SRV-241017-345678",serviceType:"Hosting Premium",amount:50,currency:"USD",status:"Completado",gateway:"Transferencia Bancaria",transactionId:"TRF-123456789",createdAt:{seconds:Date.now()/1e3-10800},completedAt:{seconds:Date.now()/1e3-9e3}}]),p([{id:"1",bankName:"Banco Nacional",accountNumber:"1234567890",accountHolder:"Empresa Demo",accountType:"Ahorros"},{id:"2",bankName:"Banco Popular",accountNumber:"0987654321",accountHolder:"Empresa Demo",accountType:"Corriente"}]),g(!1);return}if(!(t!=null&&t.uid)){g(!1);return}const _=or(Ht(qe,"artifacts",Be,"public","data","payments"),Or("userId","==",t.uid)),z=nn(_,O=>{const X=O.docs.map(Z=>({id:Z.id,...Z.data()}));console.log("Payments loaded:",X.length,X),X.sort((Z,le)=>{var xe,ke;const me=((xe=Z.createdAt)==null?void 0:xe.seconds)||0;return(((ke=le.createdAt)==null?void 0:ke.seconds)||0)-me}),s(X),g(!1)},O=>{console.error("Error loading payments:",O),r("Error al cargar los pagos","error"),g(!1)});return()=>z()},[t==null?void 0:t.uid,e,r]),fe.useEffect(()=>{if(e)return;const _=mt(qe,"artifacts",Be,"public","data","settings","paymentConfig"),z=nn(_,O=>{var X;if(O.exists()){const Z=O.data();(X=Z.bankTransfer)!=null&&X.accounts&&p(Z.bankTransfer.accounts)}});return()=>z()},[e]);const w=i.filter(_=>{const z=a===""||_.serviceNumber&&_.serviceNumber.toLowerCase().includes(a.toLowerCase())||_.serviceType&&_.serviceType.toLowerCase().includes(a.toLowerCase())||_.serviceName&&_.serviceName.toLowerCase().includes(a.toLowerCase())||_.transactionId&&_.transactionId.toLowerCase().includes(a.toLowerCase()),O=c==="Todos"||_.status===c,X=z&&O;return console.log("Payment filter:",{payment:_.id,serviceType:_.serviceType,serviceName:_.serviceName,status:_.status,searchTerm:a,statusFilter:c,matchesSearch:z,matchesStatus:O,result:X}),X}),k=_=>({Pendiente:"bg-yellow-100 text-yellow-800",Procesando:"bg-blue-100 text-blue-800",Completado:"bg-green-100 text-green-800",Fallido:"bg-red-100 text-red-800",Cancelado:"bg-gray-100 text-gray-800",Reembolsado:"bg-purple-100 text-purple-800"})[_]||"bg-gray-100 text-gray-800",H=_=>({Bold:"bg-blue-100 text-blue-800",PayPal:"bg-yellow-100 text-yellow-800",PayU:"bg-green-100 text-green-800","Transferencia Bancaria":"bg-purple-100 text-purple-800",Manual:"bg-gray-100 text-gray-800"})[_]||"bg-gray-100 text-gray-800",D=_=>{const z={invoiceNumber:`INV-${_.id.slice(-8).toUpperCase()}`,date:new Date(_.createdAt.seconds*1e3).toLocaleDateString(),dueDate:_.dueDate?new Date(_.dueDate.seconds*1e3).toLocaleDateString():"N/A",clientName:_.clientName||(n==null?void 0:n.fullName)||"Cliente",clientEmail:_.clientEmail||(t==null?void 0:t.email)||"N/A",serviceNumber:_.serviceNumber||"N/A",serviceType:_.serviceType||"Servicio",description:_.description||"Descripción del servicio",amount:_.amount||0,currency:_.currency||"USD",status:_.status||"Pendiente",gateway:_.gateway||"N/A",transactionId:_.transactionId||"N/A",paymentMethod:_.paymentMethod||"N/A"},O=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>Invoice ${z.invoiceNumber}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
          .invoice { background: white; max-width: 800px; margin: 0 auto; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
          .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #e5e5e5; padding-bottom: 20px; }
          .company-name { font-size: 24px; font-weight: bold; color: #2563eb; margin-bottom: 5px; }
          .invoice-title { font-size: 18px; color: #666; }
          .invoice-details { display: flex; justify-content: space-between; margin-bottom: 30px; }
          .client-info, .invoice-info { flex: 1; }
          .client-info h3, .invoice-info h3 { margin: 0 0 10px 0; color: #333; font-size: 16px; }
          .client-info p, .invoice-info p { margin: 5px 0; color: #666; font-size: 14px; }
          .service-details { margin-bottom: 30px; }
          .service-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
          .service-table th, .service-table td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e5e5; }
          .service-table th { background: #f8f9fa; font-weight: bold; color: #333; }
          .service-table .amount { text-align: right; font-weight: bold; }
          .total { text-align: right; margin-top: 20px; }
          .total-amount { font-size: 20px; font-weight: bold; color: #2563eb; }
          .status { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; }
          .status.completado { background: #d1fae5; color: #065f46; }
          .status.pendiente { background: #fef3c7; color: #92400e; }
          .status.fallido { background: #fee2e2; color: #991b1b; }
          .status.cancelado { background: #f3f4f6; color: #374151; }
          .footer { margin-top: 40px; text-align: center; color: #666; font-size: 12px; border-top: 1px solid #e5e5e5; padding-top: 20px; }
        </style>
      </head>
      <body>
        <div class="invoice">
          <div class="header">
            <div class="company-name">Gestor de Cobros</div>
            <div class="invoice-title">FACTURA</div>
          </div>
          
          <div class="invoice-details">
            <div class="client-info">
              <h3>Cliente</h3>
              <p><strong>${z.clientName}</strong></p>
              <p>${z.clientEmail}</p>
            </div>
            <div class="invoice-info">
              <h3>Detalles de la Factura</h3>
              <p><strong>Número:</strong> ${z.invoiceNumber}</p>
              <p><strong>Fecha:</strong> ${z.date}</p>
              <p><strong>Vencimiento:</strong> ${z.dueDate}</p>
              <p><strong>Estado:</strong> <span class="status ${z.status.toLowerCase()}">${z.status}</span></p>
            </div>
          </div>
          
          <div class="service-details">
            <h3>Detalles del Servicio</h3>
            <table class="service-table">
              <thead>
                <tr>
                  <th>Servicio</th>
                  <th>Descripción</th>
                  <th>Monto</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>${z.serviceType}</td>
                  <td>${z.description}</td>
                  <td class="amount">${z.currency} ${z.amount.toFixed(2)}</td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <div class="total">
            <div class="total-amount">Total: ${z.currency} ${z.amount.toFixed(2)}</div>
          </div>
          
          <div class="footer">
            <p>Método de Pago: ${z.paymentMethod}</p>
            <p>Gateway: ${z.gateway}</p>
            ${z.transactionId!=="N/A"?`<p>ID de Transacción: ${z.transactionId}</p>`:""}
            <p>Gracias por su negocio</p>
          </div>
        </div>
      </body>
      </html>
    `,X=new Blob([O],{type:"text/html"}),Z=URL.createObjectURL(X),le=document.createElement("a");le.href=Z,le.download=`invoice-${z.invoiceNumber}.html`,document.body.appendChild(le),le.click(),document.body.removeChild(le),URL.revokeObjectURL(Z),r("Invoice descargado exitosamente","success")},W=_=>_?new Date(_.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",K=(_,z)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:z||"USD"}).format(_),q=_=>{switch(_){case"Completado":return"✅";case"Pendiente":return"⏳";case"Procesando":return"🔄";case"Fallido":return"❌";case"Cancelado":return"🚫";case"Reembolsado":return"↩️";default:return"❓"}},ee=_=>{A(_),E(!0)},ue=async(_,z)=>{const O=S(),X=O==null?void 0:O[z];if(X)if(z==="bankTransfer"){if(_.gateway!=="Transferencia Bancaria")try{const Z=mt(qe,"artifacts",Be,"public","data","payments",_.id);await hr(Z,{gateway:"Transferencia Bancaria",updatedAt:new Date}),r("Pasarela cambiada a Transferencia Bancaria","success")}catch{r("No se pudo actualizar la pasarela del pago","error")}ee({..._,gateway:"Transferencia Bancaria"})}else r(`Redirigiendo a ${X.name} para procesar el pago`,"info")},ce=async(_,z)=>{if(!z||!(_!=null&&_.id)){r("Selecciona una imagen válida","warning");return}try{te(xe=>({...xe,[_.id]:!0})),console.log("🔄 Iniciando subida de comprobante vía PHP...");const O=new FormData;O.append("file",z);const X=window.location.origin+"/upload.php";console.log("📤 Enviando a:",X);const Z=await fetch(X,{method:"POST",body:O});if(console.log("📥 Respuesta recibida:",Z.status,Z.statusText),!Z.ok){const xe=await Z.text();throw console.error("❌ Error del servidor:",xe),new Error(`upload_failed_${Z.status}: ${xe}`)}const le=await Z.json();console.log("✅ Respuesta JSON:",le);const me=le==null?void 0:le.url;if(!me)throw console.error("❌ No se recibió URL en la respuesta:",le),new Error("missing_url");const ye=mt(qe,"artifacts",Be,"public","data","payments",_.id);await hr(ye,{proofUrl:me,proofUploadedAt:new Date,status:"Procesando"}),console.log("✅ Comprobante guardado en Firestore:",me),A(xe=>xe&&xe.id===_.id?{...xe,proofUrl:me,status:"Procesando"}:xe),s(xe=>xe.map(ke=>ke.id===_.id?{...ke,proofUrl:me,status:"Procesando"}:ke)),E(!1),r("Comprobante subido correctamente","success")}catch(O){console.error("❌ Upload proof failed:",O),r(`No se pudo subir el comprobante: ${O.message}`,"error")}finally{te(O=>({...O,[_.id]:!1}))}};return f?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[o.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[o.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[o.jsx(Yi,{}),"Mis Pagos"]}),o.jsxs("div",{className:"text-sm text-gray-500",children:[w.length," pago",w.length!==1?"s":""," encontrado",w.length!==1?"s":""]})]}),o.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",placeholder:"Buscar por servicio o transacción...",value:a,onChange:_=>l(_.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md"}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Ru,{})})]}),o.jsx("select",{value:c,onChange:_=>u(_.target.value),className:"w-full p-2 border rounded-md",children:N.map(_=>o.jsx("option",{value:_,children:_},_))})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Total Pagado"}),o.jsx("div",{className:"text-2xl font-bold text-green-600",children:K(i.filter(_=>_.status==="Completado").reduce((_,z)=>_+(z.amount||0),0),"USD")})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Pendientes"}),o.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:i.filter(_=>_.status==="Pendiente").length})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Completados"}),o.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.filter(_=>_.status==="Completado").length})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Fallidos"}),o.jsx("div",{className:"text-2xl font-bold text-red-600",children:i.filter(_=>_.status==="Fallido").length})]})]}),w.length===0?o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[o.jsx(Yi,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes pagos registrados"}),o.jsx("p",{className:"text-gray-500",children:"Los pagos aparecerán aquí una vez que realices una transacción."})]}):o.jsx("div",{className:"space-y-4",children:w.map(_=>o.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:o.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("span",{className:"text-2xl",children:q(_.status)}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-gray-900",children:_.serviceName||_.serviceType||"Servicio"}),o.jsx("p",{className:"text-sm text-gray-500 font-mono",children:_.serviceNumber||_.id}),_.serviceDescription&&o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:_.serviceDescription}),_.isRenewal&&o.jsxs("div",{className:"text-xs text-green-600 font-medium mt-1",children:["Renovación: ",_.renewalPeriod||"N/A"]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Monto:"}),o.jsx("div",{className:"font-semibold text-lg text-gray-900",children:K(_.amount,_.currency)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Estado:"}),o.jsx("div",{className:"mt-1",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${k(_.status)}`,children:_.status})})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Pasarela:"}),o.jsx("div",{className:"mt-1",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${H(_.gateway)}`,children:_.gateway})})]})]}),o.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:[o.jsxs("div",{children:["Fecha: ",W(_.createdAt)]}),_.completedAt&&o.jsxs("div",{children:["Completado: ",W(_.completedAt)]}),_.startDate&&_.endDate&&o.jsx("div",{className:"text-blue-600 mt-2",children:o.jsxs("div",{children:["Período: ",W(_.startDate)," - ",W(_.endDate)]})}),_.transactionId&&o.jsxs("div",{className:"font-mono",children:["ID: ",_.transactionId]}),_.isRenewal&&_.renewalMonths&&o.jsxs("div",{className:"text-green-600",children:["Duración: ",_.renewalMonths," meses"]})]})]}),o.jsxs("div",{className:"mt-4 md:mt-0 md:ml-4 flex flex-wrap gap-2",children:[(_.status==="Completado"||_.status==="Fallido"||_.status==="Cancelado")&&o.jsxs("button",{onClick:()=>D(_),className:"inline-flex items-center px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm",children:[o.jsx(fl,{className:"h-4 w-4 mr-1"}),"Descargar Invoice"]}),_.status==="Pendiente"&&o.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{const z=S();return z?Object.entries(z).map(([O,X])=>X.enabled?o.jsxs("button",{onClick:()=>ue(_,O),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:["Pagar con ",X.name]},O):null):null})()}),_.status==="Pendiente"&&_.gateway==="Transferencia Bancaria"&&o.jsxs(o.Fragment,{children:[o.jsxs("label",{className:`px-4 py-2 ${F[_.id]?"bg-gray-200 text-gray-400 cursor-wait":"bg-gray-100 text-gray-800 hover:bg-gray-200 cursor-pointer"} rounded-lg text-sm`,children:[F[_.id]?"Subiendo...":"Subir Comprobante",o.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:z=>{var O;return((O=z.target.files)==null?void 0:O[0])&&ce(_,z.target.files[0])}})]}),_.proofUrl&&o.jsx("button",{onClick:()=>{j(_.proofUrl),B(!0)},className:"px-4 py-2 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 text-sm",children:"Ver Comprobante"})]})]})]})},_.id))}),T&&P&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:o.jsx("div",{className:"bg-white rounded-lg shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Instrucciones de Transferencia"}),o.jsx("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),o.jsx(rO,{bankAccounts:y,serviceNumber:P.serviceNumber,amount:P.amount,currency:P.currency,onUpload:_=>ce(P,_)})]})})}),ae&&I&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-50 flex justify-center items-center p-4",onClick:()=>B(!1),children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-5xl w-full max-h-[95vh] overflow-hidden flex flex-col",onClick:_=>_.stopPropagation(),children:[o.jsxs("div",{className:"flex justify-between items-center p-4 border-b bg-gray-50",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Comprobante de Pago"}),o.jsx("button",{onClick:()=>B(!1),className:"text-gray-400 hover:text-gray-600 text-2xl font-bold w-8 h-8 flex items-center justify-center","aria-label":"Cerrar",children:"✕"})]}),o.jsx("div",{className:"flex-1 overflow-auto p-4 bg-gray-100 flex justify-center items-center min-h-[400px]",children:o.jsx("img",{src:I,alt:"Comprobante de pago",className:"max-w-full max-h-[80vh] object-contain rounded-lg shadow-lg",onError:_=>{_.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="%23999"%3ENo se pudo cargar la imagen%3C/text%3E%3C/svg%3E'}})}),o.jsxs("div",{className:"p-4 border-t bg-gray-50 flex justify-end gap-2",children:[o.jsx("a",{href:I,target:"_blank",rel:"noreferrer",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:"Abrir en Nueva Pestaña"}),o.jsx("button",{onClick:()=>{const _=document.createElement("a");_.href=I,_.download=`comprobante-${Date.now()}.${I.split(".").pop().split("?")[0]}`,document.body.appendChild(_),_.click(),document.body.removeChild(_)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm",children:"Descargar"}),o.jsx("button",{onClick:()=>B(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 text-sm",children:"Cerrar"})]})]})})]})}function sO({user:t,isDemo:e,userProfile:n}){const{addNotification:r}=kn(),[i,s]=fe.useState([]),[a,l]=fe.useState(null),[c,u]=fe.useState(!0),[f,g]=fe.useState(null),[y,p]=fe.useState(new Set),[T,E]=fe.useState(!1),P=[{key:"monthly",label:"Mensual",months:1},{key:"quarterly",label:"Trimestral",months:3},{key:"semiAnnual",label:"Semestral",months:6},{key:"annual",label:"Anual",months:12},{key:"biennial",label:"Bienal (2 años)",months:24},{key:"triennial",label:"Trienal (3 años)",months:36}];fe.useEffect(()=>{if(e){l({discounts:{monthly:{enabled:!1,percentage:0},quarterly:{enabled:!0,percentage:5},semiAnnual:{enabled:!0,percentage:10},annual:{enabled:!0,percentage:15},biennial:{enabled:!0,percentage:25},triennial:{enabled:!0,percentage:35}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"}});return}const K=mt(qe,"artifacts",Be,"public","data","settings","renewalConfig"),q=nn(K,ee=>{ee.exists()?(l(ee.data()),console.log("Renewal config loaded:",ee.data())):(console.log("No renewal config found, using defaults"),l({discounts:{monthly:{enabled:!1,percentage:0},quarterly:{enabled:!0,percentage:5},semiAnnual:{enabled:!0,percentage:10},annual:{enabled:!0,percentage:15},biennial:{enabled:!0,percentage:25},triennial:{enabled:!0,percentage:35}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"}}))},ee=>{console.error("Error loading renewal config:",ee)});return()=>q()},[e]),fe.useEffect(()=>{const K=localStorage.getItem("selectedServiceForRenewal");if(K)try{const q=JSON.parse(K);g(q),r(`Servicio "${q.serviceType}" seleccionado para renovación`,"success"),localStorage.removeItem("selectedServiceForRenewal")}catch(q){console.error("Error parsing selected service:",q)}},[]),fe.useEffect(()=>{if(!f||i.length===0)return;const K=document.getElementById(`service-${f.id}`);K&&K.scrollIntoView({behavior:"smooth",block:"start"})},[f,i]),fe.useEffect(()=>{if(e||!(t!=null&&t.uid))return;const K=or(Ht(qe,"artifacts",Be,"public","data","payments"),Or("userId","==",t.uid),Or("status","==","Pendiente"),Or("isRenewal","==",!0)),q=nn(K,ee=>{const ue=new Set;ee.docs.forEach(ce=>{const _=ce.data();_.serviceId&&ue.add(_.serviceId)}),p(ue)},ee=>{console.error("Error loading pending renewals:",ee)});return()=>q()},[t==null?void 0:t.uid,e]);const A=K=>{if(!K.dueDate||!K.billingCycle||K.billingCycle==="One-Time")return K.expirationDate?new Date(K.expirationDate.seconds*1e3):null;const q=new Date(K.dueDate.seconds*1e3);let ee=new Date(q);switch(K.billingCycle){case"Monthly":ee.setMonth(ee.getMonth()+1);break;case"Semiannually":ee.setMonth(ee.getMonth()+6);break;case"Annually":ee.setFullYear(ee.getFullYear()+1);break;case"Biennially":ee.setFullYear(ee.getFullYear()+2);break;case"Triennially":ee.setFullYear(ee.getFullYear()+3);break;default:return null}return ee},L=K=>K.billingCycle==="One-Time"?K.dueDate?new Date(K.dueDate.seconds*1e3):null:A(K);fe.useEffect(()=>{if(e){s([{id:"demo1",serviceNumber:"SRV-241017-123456",serviceType:"Hosting Básico",description:"Plan Básico - 1GB",amount:5e4,currency:"COP",status:"Activo",dueDate:{seconds:Date.now()/1e3+30*24*60*60},billingCycle:"Monthly",clientNotes:"Servicio de hosting básico"},{id:"demo2",serviceNumber:"SRV-241017-789012",serviceType:"Dominio",description:"midominio.com",amount:15e4,currency:"COP",status:"Activo",dueDate:{seconds:Date.now()/1e3+10*24*60*60},billingCycle:"Annually",clientNotes:"Renovación de dominio"}]),l({renewalSettings:{enabled:!0,maxRenewalYears:3,autoRenewal:!0,gracePeriodDays:7,reminderDays:3},discounts:{monthly:{enabled:!1,discount:0,description:"Descuento por pago mensual"},quarterly:{enabled:!0,discount:5,description:"Descuento por pago trimestral"},semiAnnual:{enabled:!0,discount:10,description:"Descuento por pago semestral"},annual:{enabled:!0,discount:15,description:"Descuento por pago anual"},biennial:{enabled:!0,discount:25,description:"Descuento por pago bienal (2 años)"},triennial:{enabled:!0,discount:35,description:"Descuento por pago trienal (3 años)"}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"},pricingSettings:{roundToNearest:100,minimumAmount:1e3,maximumAmount:1e7}}),u(!1);return}if(!(t!=null&&t.uid)){u(!1);return}const K=or(Ht(qe,"artifacts",Be,"public","data","services"),Or("assignedUserId","==",t.uid)),q=nn(K,ce=>{const _=ce.docs.map(z=>({id:z.id,...z.data()}));s(_)},ce=>{console.error("Error loading services:",ce),r("Error al cargar los servicios","error")}),ee=mt(qe,"artifacts",Be,"public","data","settings","renewalConfig"),ue=nn(ee,ce=>{ce.exists()&&l(ce.data()),u(!1)});return()=>{q(),ue()}},[t==null?void 0:t.uid,e,r]);const M=(K,q)=>{var z,O;if(!((O=(z=a==null?void 0:a.discounts)==null?void 0:z[q])!=null&&O.enabled))return K;const ee=a.discounts[q],ue=K*ee.discount/100,ce=K-ue,_=Math.round(ce/a.pricingSettings.roundToNearest)*a.pricingSettings.roundToNearest;return Math.max(_,a.pricingSettings.minimumAmount)},F=K=>{var q;if(!((q=a==null?void 0:a.taxSettings)!=null&&q.ivaEnabled)||a.taxSettings.ivaIncluded)return K;{const ee=K*a.taxSettings.ivaPercentage/100;return K+ee}},te=K=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(K),ae=K=>{const q=L(K);if(!q)return 0;const ee=new Date,ue=q.getTime()-ee.getTime();return Math.ceil(ue/(1e3*60*60*24))},B=K=>{switch(K){case"Activo":return"bg-green-100 text-green-800";case"Periodo de Gracia Vencido":return"bg-yellow-100 text-yellow-800";case"Pendiente Pago":return"bg-orange-100 text-orange-800";case"Pago":return"bg-blue-100 text-blue-800";case"Cancelado":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},I=K=>{switch(K){case"Monthly":return 1;case"Quarterly":return 3;case"Semi-Annual":return 6;case"Annually":return 12;case"Biennial":return 24;case"Triennial":return 36;case"One-Time":return 0;default:return 1}},j=(K,q)=>{var ce;const ee=I(K.billingCycle),ue=((ce=P.find(_=>_.key===q))==null?void 0:ce.months)||0;return ee===0?!1:ue>=ee},S=(K,q)=>{var z;const ee=L(K);if(!ee)return{startDate:null,endDate:null};const ue=((z=P.find(O=>O.key===q))==null?void 0:z.months)||0,ce=new Date(ee),_=new Date(ce);return _.setMonth(_.getMonth()+ue),{startDate:ce,endDate:_}},N=(K,q)=>{var ce;const ee=I(K.billingCycle);return ee===0?"Volver a Comprar":(((ce=P.find(_=>_.key===q))==null?void 0:ce.months)||0)<ee?"Período Insuficiente":"Renovar"},w=()=>{window.location.href="#payments"},k=K=>{if(!K)return null;if(K.gateways)return K.gateways;const{bold:q,paypal:ee,payu:ue,bankTransfer:ce}=K,_={};return q&&(_.bold={name:"Bold",...q}),ee&&(_.paypal={name:"PayPal",...ee}),ue&&(_.payu={name:"PayU",...ue}),ce&&(_.bankTransfer={name:"Transferencia Bancaria",...ce}),_},[H,D]=fe.useState(null);fe.useEffect(()=>{if(e){D({gateways:{bankTransfer:{enabled:!0,name:"Transferencia Bancaria"}}});return}const K=mt(qe,"artifacts",Be,"public","data","settings","paymentConfig"),q=nn(K,ee=>{ee.exists()&&D(ee.data())});return()=>q()},[e]);const W=async(K,q)=>{var ee,ue,ce,_,z;if(e){const O=N(K,q);r(`${O} ${(ee=P.find(X=>X.key===q))==null?void 0:ee.label} iniciada (modo demo)`,"success");return}if(y.has(K.id)){r("Ya tienes una solicitud de renovación pendiente para este servicio","warning");return}if(T){r("Ya se está procesando una solicitud de renovación","warning");return}E(!0);try{const{startDate:O,endDate:X}=S(K,q),Z=K.amount,le=M(Z,q),me=F(le);let ye=H&&k(H);const xe=ye?Object.values(ye).filter(Ye=>Ye.enabled):[];let ke="Pendiente de Selección",Ve="Renovación";xe.length===1&&(ke=xe[0].name,Ve=xe[0].name);const Ue={userId:t.uid,serviceId:K.id,serviceName:K.serviceType,serviceType:K.serviceType,serviceDescription:K.description,serviceNumber:K.serviceNumber,amount:me,originalAmount:Z,discount:Z-le,currency:"USD",status:"Pendiente",paymentMethod:Ve,paymentType:"Renovación",gateway:ke,transactionId:null,dueDate:lt.fromDate(new Date(O)),renewalPeriod:((ue=P.find(Ye=>Ye.key===q))==null?void 0:ue.label)||q,renewalMonths:((ce=P.find(Ye=>Ye.key===q))==null?void 0:ce.months)||0,startDate:lt.fromDate(new Date(O)),endDate:lt.fromDate(new Date(X)),createdAt:lt.now(),updatedAt:lt.now(),notes:`Renovación de ${(_=P.find(Ye=>Ye.key===q))==null?void 0:_.label} para el servicio ${K.serviceType}`,isRenewal:!0},Ne=Ht(qe,`artifacts/${Be}/public/data/payments`);await ao(Ne,Ue);const se={service:K,period:q,startDate:O,endDate:X,originalPrice:Z,discountedPrice:le,finalPrice:me};localStorage.setItem("renewalData",JSON.stringify(se));const yt=N(K,q);r(`${yt} ${(z=P.find(Ye=>Ye.key===q))==null?void 0:z.label} - Redirigiendo a pagos`,"success"),p(Ye=>new Set([...Ye,K.id])),setTimeout(()=>{window.location.href="#payments"},1500)}catch(O){console.error("Error creating renewal payment:",O),r("Error al crear la solicitud de renovación. Intenta nuevamente.","error")}finally{E(!1)}};return c?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o.jsxs("main",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.jsx("div",{className:"flex justify-between items-center mb-6",children:o.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[o.jsx(al,{}),"Renovaciones de Servicios"]})}),i.length===0?o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[o.jsx(al,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes servicios para renovar"}),o.jsx("p",{className:"text-gray-500",children:"Contacta al administrador para que te asigne servicios."})]}):o.jsx("div",{className:"space-y-6",children:i.map(K=>{const q=ae(K),ee=q<=30&&q>0,ue=q<=0,ce=f&&f.id===K.id;return o.jsxs("div",{id:`service-${K.id}`,className:`bg-white rounded-xl shadow-lg p-6 ${ce?"ring-2 ring-blue-500 border-blue-200":""}`,children:[o.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:K.serviceType}),ce&&o.jsx("span",{className:"px-2 py-1 text-xs font-semibold text-blue-700 bg-blue-100 rounded-full",children:"Seleccionado"})]}),o.jsx("p",{className:"text-sm text-gray-500 font-mono",children:K.serviceNumber}),o.jsx("p",{className:"text-sm text-gray-600",children:K.description})]}),o.jsx("div",{className:"mt-2 md:mt-0",children:o.jsx("span",{className:`px-3 py-1 text-sm font-semibold rounded-full ${B(K.status)}`,children:K.status})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Precio Actual:"}),o.jsx("div",{className:"font-semibold text-lg text-gray-900",children:te(K.amount)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-gray-500",children:K.billingCycle==="One-Time"?"Fecha de Inicio:":"Fecha de Vencimiento:"}),o.jsx("div",{className:`font-semibold ${ue?"text-red-600":ee?"text-orange-600":"text-gray-900"}`,children:(()=>{const _=L(K);return _?_.toLocaleDateString():"N/A"})()}),o.jsx("div",{className:"text-xs text-gray-500",children:ue?"Vencido":ee?`${q} días restantes`:`${q} días restantes`})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-gray-500",children:"Ciclo Actual:"}),o.jsx("div",{className:"font-semibold text-gray-900",children:K.billingCycle})]})]}),o.jsxs("div",{className:"border-t pt-6",children:[o.jsxs("h4",{className:"text-md font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[o.jsx(nA,{}),I(K.billingCycle)===0?"Opciones de Compra":"Opciones de Renovación"]}),I(K.billingCycle)===0?o.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.725-1.36 3.49 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Servicio de Pago Único"}),o.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:o.jsx("p",{children:'Este servicio es de pago único. Para volver a adquirirlo, contacta al administrador o selecciona "Volver a Comprar" si está disponible.'})})]})]})}):o.jsxs("div",{className:"space-y-4",children:[(()=>{var z,O;const _=P.find(X=>I(K.billingCycle)===X.months);if(_){const X=K.amount,Z=M(X,_.key),le=F(Z),me=(z=a==null?void 0:a.discounts)==null?void 0:z[_.key],ye=X-Z,{startDate:xe,endDate:ke}=S(K,_.key);return o.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h5",{className:"font-semibold text-blue-900 flex items-center gap-2",children:[o.jsx(al,{className:"h-4 w-4"}),"Renovación de Período Actual"]}),o.jsx("span",{className:"px-3 py-1 bg-blue-200 text-blue-800 text-sm font-semibold rounded-full",children:_.label})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[o.jsxs("div",{children:["Precio base: ",te(X)]}),(me==null?void 0:me.enabled)&&ye>0&&o.jsxs("div",{className:"text-green-600",children:["Ahorras: ",te(ye)]})]}),o.jsx("div",{className:"font-bold text-xl text-blue-600",children:te(le)}),((O=a==null?void 0:a.taxSettings)==null?void 0:O.ivaEnabled)&&o.jsx("div",{className:"text-xs text-gray-500",children:a.taxSettings.ivaIncluded?"IVA incluido":`+ ${a.taxSettings.taxName} ${a.taxSettings.ivaPercentage}%`})]}),o.jsx("div",{children:xe&&ke&&o.jsxs("div",{className:"p-3 bg-white border border-blue-200 rounded-lg",children:[o.jsx("div",{className:"text-xs font-medium text-blue-800 mb-2",children:"Fechas de Renovación:"}),o.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[o.jsxs("div",{children:["Fecha de Vencimiento: ",xe.toLocaleDateString()]}),o.jsxs("div",{children:["Fecha Nueva Renovación: ",ke.toLocaleDateString()]})]})]})})]}),y.has(K.id)?o.jsx("button",{onClick:w,className:"w-full mt-4 px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-colors",children:"Ver Solicitud Pendiente"}):o.jsx("button",{onClick:()=>W(K,_.key),disabled:T,className:`w-full mt-4 px-6 py-3 font-semibold rounded-lg transition-colors ${T?"bg-gray-400 text-white cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:T?"Creando...":`Renovar ${_.label}`})]})}return null})(),o.jsxs("div",{children:[o.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-3",children:"Otras Opciones de Renovación:"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.map(_=>{var Ue,Ne,se;const z=K.amount,O=M(z,_.key),X=F(O),Z=(Ue=a==null?void 0:a.discounts)==null?void 0:Ue[_.key],le=z-O,me=j(K,_),ye=N(K,_),xe=I(K.billingCycle)===_.months,ke=!((Ne=a==null?void 0:a.discounts)!=null&&Ne[_.key])||a.discounts[_.key].enabled,Ve=me&&!xe&&ke;return Ve?o.jsxs("div",{className:"border rounded-lg p-4 transition-shadow border-gray-200 hover:shadow-md",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h5",{className:"font-medium text-gray-800",children:_.label}),(Z==null?void 0:Z.enabled)&&Ve&&o.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-semibold rounded-full",children:["-",Z.discount,"%"]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"text-sm text-gray-600",children:[o.jsxs("div",{children:["Precio base: ",te(z)]}),(Z==null?void 0:Z.enabled)&&le>0&&o.jsxs("div",{className:"text-green-600",children:["Ahorras: ",te(le)]})]}),o.jsx("div",{className:"font-semibold text-lg text-blue-600",children:te(X)}),((se=a==null?void 0:a.taxSettings)==null?void 0:se.ivaEnabled)&&o.jsx("div",{className:"text-xs text-gray-500",children:a.taxSettings.ivaIncluded?"IVA incluido":`+ ${a.taxSettings.taxName} ${a.taxSettings.ivaPercentage}%`}),(()=>{const{startDate:yt,endDate:Ye}=S(K,_);return yt&&Ye?o.jsxs("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[o.jsx("div",{className:"text-xs font-medium text-blue-800 mb-2",children:"Fechas de Renovación:"}),o.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[o.jsxs("div",{children:["Fecha de Vencimiento: ",yt.toLocaleDateString()]}),o.jsxs("div",{children:["Fecha Nueva Renovación: ",Ye.toLocaleDateString()]})]})]}):null})(),y.has(K.id)?o.jsx("button",{onClick:w,className:"w-full px-4 py-2 rounded-md text-sm font-medium bg-green-600 text-white hover:bg-green-700",children:"Ver Solicitud"}):o.jsx("button",{onClick:()=>W(K,_.key),disabled:T,className:`w-full px-4 py-2 rounded-md text-sm font-medium ${T?"bg-gray-400 text-white cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:T?"Creando...":`${ye} ${_.label}`})]})]},_.key):null})})]})]})]}),o.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[o.jsx("h5",{className:"font-medium text-gray-800 mb-2",children:"Información Importante"}),o.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[o.jsxs("li",{children:["• ",o.jsx("strong",{children:'La "Renovación de Período Actual" siempre está disponible y destacada'})]}),o.jsxs("li",{children:["• ",o.jsx("strong",{children:"Fecha de Vencimiento"}),": Fecha actual de vencimiento del servicio"]}),o.jsxs("li",{children:["• ",o.jsx("strong",{children:"Fecha Nueva Renovación"}),": Fecha calculada después de sumar el período"]}),o.jsx("li",{children:"• Los descuentos se aplican automáticamente según el período seleccionado (si están configurados)"}),o.jsx("li",{children:"• Los precios se redondean para evitar decimales"}),o.jsx("li",{children:"• El IVA se calcula según la configuración actual"}),o.jsxs("li",{children:["• ",o.jsx("strong",{children:"La renovación extiende el servicio desde la fecha de vencimiento actual"})]}),o.jsx("li",{children:"• El período de renovación no puede ser inferior al ciclo actual del servicio"}),o.jsx("li",{children:'• Los servicios de pago único requieren "Volver a Comprar" en lugar de renovar'}),o.jsx("li",{children:"• Al seleccionar una renovación, serás redirigido a la sección de pagos para proceder"})]})]})]},K.id)})})]})}function aO({user:t,isDemo:e,userProfile:n}){const{addNotification:r}=kn(),[i,s]=fe.useState([]),[a,l]=fe.useState(!0),[c,u]=fe.useState(!1),[f,g]=fe.useState(null),[y,p]=fe.useState(!1),[T,E]=fe.useState({subject:"",department:"Soporte Técnico",priority:"Media",description:""}),P=["Soporte Técnico","Facturación","Ventas","General"],A=["Baja","Media","Alta","Crítica"];fe.useEffect(()=>{if(e){s([{id:"ticket1",ticketNumber:"TKT-2024-001",subject:"Problema con el acceso al panel de cliente",description:"No puedo acceder a mi panel de cliente desde ayer. Me aparece un error 500.",status:"Abierto",priority:"Alta",department:"Soporte Técnico",clientId:(t==null?void 0:t.uid)||"demo",clientName:(n==null?void 0:n.fullName)||"Usuario Demo",clientEmail:(t==null?void 0:t.email)||"demo@ejemplo.com",assignedTo:null,assignedToName:null,createdAt:{seconds:Date.now()/1e3-3600},updatedAt:{seconds:Date.now()/1e3-3600},lastReplyAt:{seconds:Date.now()/1e3-3600},lastReplyBy:"Cliente",replyCount:0,attachments:[]},{id:"ticket2",ticketNumber:"TKT-2024-002",subject:"Consulta sobre facturación",description:"Necesito una copia de mi factura del mes pasado para contabilidad.",status:"Respondido",priority:"Media",department:"Facturación",clientId:(t==null?void 0:t.uid)||"demo",clientName:(n==null?void 0:n.fullName)||"Usuario Demo",clientEmail:(t==null?void 0:t.email)||"demo@ejemplo.com",assignedTo:"admin1",assignedToName:"Admin Principal",createdAt:{seconds:Date.now()/1e3-7200},updatedAt:{seconds:Date.now()/1e3-1800},lastReplyAt:{seconds:Date.now()/1e3-1800},lastReplyBy:"Admin Principal",replyCount:2,attachments:["factura_enero.pdf"]}]),l(!1);return}if(!(t!=null&&t.uid)){l(!1);return}const S=or(Ht(qe,"artifacts",Be,"public","data","tickets"),Or("clientId","==",t.uid)),N=nn(S,w=>{const k=w.docs.map(H=>({id:H.id,...H.data()}));k.sort((H,D)=>{var q,ee;const W=((q=H.createdAt)==null?void 0:q.seconds)||0;return(((ee=D.createdAt)==null?void 0:ee.seconds)||0)-W}),s(k),l(!1)},w=>{console.error("Error loading tickets:",w),r("Error al cargar los tickets","error"),l(!1)});return()=>N()},[t==null?void 0:t.uid,e,r,n]);const L=async S=>{if(S.preventDefault(),e){r("Ticket creado (modo demo)","success"),u(!1),E({subject:"",department:"Soporte Técnico",priority:"Media",description:""});return}try{const N={...T,ticketNumber:`TKT-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,status:"Abierto",clientId:t.uid,clientName:(n==null?void 0:n.fullName)||t.email,clientEmail:t.email,assignedTo:null,assignedToName:null,createdAt:lt.now(),updatedAt:lt.now(),lastReplyAt:lt.now(),lastReplyBy:"Cliente",replyCount:0,attachments:[]};await ao(Ht(qe,"artifacts",Be,"public","data","tickets"),N),r("Ticket creado exitosamente","success"),u(!1),E({subject:"",department:"Soporte Técnico",priority:"Media",description:""})}catch(N){console.error("Error creating ticket:",N),r("Error al crear el ticket","error")}},M=S=>{g(S),p(!0)},F=async S=>{if(e){s(N=>N.map(w=>w.id===S?{...w,status:"Cerrado",updatedAt:{seconds:Date.now()/1e3}}:w)),r("Ticket cerrado (modo demo)","success");return}try{const N=mt(qe,"artifacts",Be,"public","data","tickets",S);await hr(N,{status:"Cerrado",updatedAt:lt.now()}),r("Ticket cerrado exitosamente","success")}catch(N){console.error("Error closing ticket:",N),r("Error al cerrar el ticket","error")}},te=S=>({Abierto:"bg-red-100 text-red-800","En Progreso":"bg-yellow-100 text-yellow-800",Respondido:"bg-blue-100 text-blue-800",Cerrado:"bg-gray-100 text-gray-800","Esperando Cliente":"bg-orange-100 text-orange-800"})[S]||"bg-gray-100 text-gray-800",ae=S=>({Baja:"bg-green-100 text-green-800",Media:"bg-yellow-100 text-yellow-800",Alta:"bg-orange-100 text-orange-800",Crítica:"bg-red-100 text-red-800"})[S]||"bg-gray-100 text-gray-800",B=S=>({"Soporte Técnico":"bg-blue-100 text-blue-800",Facturación:"bg-green-100 text-green-800",Ventas:"bg-purple-100 text-purple-800",General:"bg-gray-100 text-gray-800"})[S]||"bg-gray-100 text-gray-800",I=S=>S?new Date(S.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",j=S=>{if(!S)return"--";const N=new Date,w=new Date(S.seconds*1e3),k=N.getTime()-w.getTime(),H=Math.floor(k/(1e3*60*60*24)),D=Math.floor(k/(1e3*60*60)),W=Math.floor(k/(1e3*60));return H>0?`hace ${H} día${H>1?"s":""}`:D>0?`hace ${D} hora${D>1?"s":""}`:W>0?`hace ${W} minuto${W>1?"s":""}`:"hace unos segundos"};return a?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o.jsxs("main",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[o.jsx(Jl,{}),"Mis Tickets de Soporte"]}),o.jsxs("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[o.jsx(Dh,{}),"Nuevo Ticket"]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:o.jsx(cs,{})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Abiertos"}),o.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:i.filter(S=>S.status==="Abierto").length})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:o.jsx(hh,{})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Respondidos"}),o.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:i.filter(S=>S.status==="Respondido").length})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:o.jsx(cs,{})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"En Progreso"}),o.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:i.filter(S=>S.status==="En Progreso").length})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:o.jsx(Jl,{})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Cerrados"}),o.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:i.filter(S=>S.status==="Cerrado").length})]})]})})]}),i.length===0?o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[o.jsx(Jl,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes tickets"}),o.jsx("p",{className:"text-gray-500 mb-4",children:"Crea tu primer ticket para obtener soporte."}),o.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Crear Primer Ticket"})]}):o.jsx("div",{className:"space-y-4",children:i.map(S=>o.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("span",{className:"font-mono text-sm font-medium text-blue-600",children:S.ticketNumber}),o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${te(S.status)}`,children:S.status}),o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ae(S.priority)}`,children:S.priority}),o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${B(S.department)}`,children:S.department})]}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:S.subject}),o.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:S.description}),o.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(cs,{}),o.jsxs("span",{children:["Creado ",j(S.createdAt)]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(nm,{}),o.jsxs("span",{children:[S.replyCount," respuesta",S.replyCount!==1?"s":""]})]}),S.assignedToName&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(hh,{}),o.jsxs("span",{children:["Asignado a ",S.assignedToName]})]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>M(S),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md",title:"Ver ticket completo",children:o.jsx(fl,{})}),S.status!=="Cerrado"&&o.jsx("button",{onClick:()=>F(S.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-md",title:"Cerrar ticket",children:o.jsx(tm,{})})]})]})},S.id))}),c&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Crear Nuevo Ticket"}),o.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),o.jsxs("form",{onSubmit:L,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto *"}),o.jsx("input",{type:"text",value:T.subject,onChange:S=>E(N=>({...N,subject:S.target.value})),className:"w-full p-2 border rounded-md",placeholder:"Describe brevemente tu problema o consulta",required:!0})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento *"}),o.jsx("select",{value:T.department,onChange:S=>E(N=>({...N,department:S.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:P.map(S=>o.jsx("option",{value:S,children:S},S))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridad *"}),o.jsx("select",{value:T.priority,onChange:S=>E(N=>({...N,priority:S.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:A.map(S=>o.jsx("option",{value:S,children:S},S))})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción *"}),o.jsx("textarea",{value:T.description,onChange:S=>E(N=>({...N,description:S.target.value})),className:"w-full p-2 border rounded-md",rows:6,placeholder:"Describe tu problema o consulta en detalle. Incluye cualquier información relevante que pueda ayudar a resolver tu ticket más rápidamente.",required:!0})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[o.jsx("button",{type:"button",onClick:()=>u(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Crear Ticket"})]})]})]})}),y&&f&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:["Ticket ",f.ticketNumber]}),o.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${te(f.status)}`,children:f.status})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prioridad"}),o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ae(f.priority)}`,children:f.priority})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Departamento"}),o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${B(f.department)}`,children:f.department})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Asignado a"}),o.jsx("div",{className:"text-sm text-gray-900",children:f.assignedToName||"Sin asignar"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Creado"}),o.jsx("div",{className:"text-sm text-gray-900",children:I(f.createdAt)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Última actividad"}),o.jsx("div",{className:"text-sm text-gray-900",children:j(f.lastReplyAt)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto"}),o.jsx("div",{className:"text-sm text-gray-900 p-3 bg-gray-50 rounded-md",children:f.subject})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción"}),o.jsx("div",{className:"text-sm text-gray-900 p-4 bg-gray-50 rounded-md whitespace-pre-wrap",children:f.description})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Historial de Mensajes"}),o.jsx("div",{className:"border border-gray-200 rounded-md p-4",children:o.jsx(YA,{ticketId:f.id,isDemo:e,userRole:"client",currentUser:t})})]}),o.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[o.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cerrar"}),f.status!=="Cerrado"&&o.jsx("button",{onClick:()=>{F(f.id),p(!1)},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Cerrar Ticket"}),o.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Responder"})]})]})]})})]})}function oO({user:t,isDemo:e,userProfile:n}){const[r,i]=fe.useState("services");fe.useEffect(()=>{const a=()=>{const l=(window.location.hash||"").replace("#","");(l==="services"||l==="payments"||l==="renewals"||l==="tickets")&&i(l)};return a(),window.addEventListener("hashchange",a),()=>window.removeEventListener("hashchange",a)},[]);const s=()=>{switch(r){case"tickets":return o.jsx(aO,{user:t,isDemo:e,userProfile:n});case"payments":return o.jsx(iO,{user:t,isDemo:e,userProfile:n});case"renewals":return o.jsx(sO,{user:t,isDemo:e,userProfile:n});case"services":default:return o.jsx(nO,{user:t,isDemo:e,userProfile:n})}};return o.jsxs("main",{className:"container mx-auto",children:[o.jsx("div",{className:"border-b border-gray-200",children:o.jsxs("nav",{className:"-mb-px flex space-x-8 px-4 sm:px-6 lg:px-8","aria-label":"Tabs",children:[o.jsxs("button",{onClick:()=>i("services"),className:`${r==="services"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[o.jsx(em,{})," Mis Servicios"]}),o.jsxs("button",{onClick:()=>i("payments"),className:`${r==="payments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[o.jsx(Yi,{})," Mis Pagos"]}),o.jsxs("button",{onClick:()=>i("renewals"),className:`${r==="renewals"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[o.jsx(al,{})," Renovaciones"]}),o.jsxs("button",{onClick:()=>i("tickets"),className:`${r==="tickets"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[o.jsx(Jl,{})," Tickets de Soporte"]})]})}),s()]})}function lO({companySettings:t}){const{addNotification:e}=kn(),[n,r]=fe.useState(!0),[i,s]=fe.useState(""),[a,l]=fe.useState(""),c=async u=>{u.preventDefault();try{if(n){const f=await Vp(yr,i,a),g=await ga(or(Ht(qe,"artifacts",Be,"public","data","users"),Or("__name__","==",f.user.uid)));if(g.docs.length===0)throw new Error("No se encontró el perfil de usuario.");const y=g.docs[0].data();if(y.status==="pending"||y.status==="disabled")throw await Wl(yr),new Error("Tu cuenta está pendiente de activación o ha sido deshabilitada.")}else{const f=await Em(yr,i,a);await m4(f.user);const g=Ht(qe,"artifacts",Be,"public","data","users");let p=(await ga(g)).empty?"superadmin":"client";const T=p==="superadmin"?"active":"pending",E=p!=="superadmin";await va(mt(qe,"artifacts",Be,"public","data","users",f.user.uid),{email:i,role:p,status:T,isProfileComplete:!1,createdAt:lt.now(),fullName:"",identification:"",requiresPasswordChange:E}),p==="superadmin"?e("¡Registro exitoso! Eres el primer usuario y tienes permisos de superadministrador.","success"):(e("¡Registro exitoso! Revisa tu correo para verificar la cuenta. Un administrador debe activar tu usuario.","success"),await Wl(yr))}}catch(f){e(f.message,"error")}};return o.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:o.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-sm w-full",children:[o.jsx("div",{className:"flex justify-center mb-6",children:t.logoUrl?o.jsx("img",{src:t.logoUrl,alt:"Logo de la Empresa",className:"max-h-16"}):o.jsx("h1",{className:"text-3xl font-bold",children:t.companyName||"Gestor de Pagos"})}),o.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:n?"Iniciar Sesión":"Crear Cuenta"}),o.jsxs("form",{onSubmit:c,children:[o.jsx("input",{type:"email",value:i,onChange:u=>s(u.target.value),placeholder:"Email",className:"w-full p-2 mb-4 border rounded",required:!0}),o.jsx("input",{type:"password",value:a,onChange:u=>l(u.target.value),placeholder:"Contraseña",className:"w-full p-2 mb-4 border rounded",required:!0}),o.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700",children:n?"Entrar":"Registrarse"})]}),o.jsx("button",{onClick:()=>r(!n),className:"w-full mt-4 text-sm text-blue-600 hover:underline",children:n?"¿No tienes cuenta? Regístrate":"¿Ya tienes cuenta? Inicia sesión"})]})})}function cO({companySettings:t,onLogin:e}){const{addNotification:n}=kn(),[r,i]=fe.useState(!1),s=async()=>{i(!0);try{const u=await Vp(yr,"admin@test.com","admin123");e(u.user,"superadmin")}catch{n("Error al iniciar sesión como administrador. Verifica las credenciales.","error")}finally{i(!1)}},a=async()=>{i(!0);try{const u=await Vp(yr,"cliente@test.com","cliente123");e(u.user,"client")}catch{n("Error al iniciar sesión como cliente. Verifica las credenciales.","error")}finally{i(!1)}};return o.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:o.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-md w-full",children:[o.jsx("div",{className:"flex justify-center mb-6",children:t.logoUrl?o.jsx("img",{src:t.logoUrl,alt:"Logo de la Empresa",className:"max-h-16"}):o.jsx("h1",{className:"text-3xl font-bold",children:t.companyName||"Gestor de Cobros"})}),o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Modo de Prueba"}),o.jsx("p",{className:"text-gray-600",children:"Selecciona el tipo de usuario para probar el sistema"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("button",{onClick:s,disabled:r,className:"w-full bg-blue-600 text-white p-4 rounded-lg hover:bg-blue-700 font-semibold text-lg disabled:opacity-50 flex items-center justify-center gap-2",children:r?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"👨‍💼"}),o.jsx("span",{children:"Entrar como Administrador"})]})}),o.jsx("button",{onClick:a,disabled:r,className:"w-full bg-green-600 text-white p-4 rounded-lg hover:bg-green-700 font-semibold text-lg disabled:opacity-50 flex items-center justify-center gap-2",children:r?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"👤"}),o.jsx("span",{children:"Entrar como Cliente"})]})})]}),o.jsx("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:o.jsxs("p",{className:"text-sm text-yellow-800 text-center",children:[o.jsx("strong",{children:"Credenciales de Prueba:"}),o.jsx("br",{}),"Admin: admin@test.com / admin123",o.jsx("br",{}),"Cliente: cliente@test.com / cliente123"]})})]})})}function uO({isOpen:t,onSave:e}){const{addNotification:n}=kn(),[r,i]=fe.useState(""),[s,a]=fe.useState(""),[l,c]=fe.useState(""),u=async f=>{if(f.preventDefault(),r.length<6){c("La contraseña debe tener al menos 6 caracteres.");return}if(r!==s){c("Las contraseñas no coinciden.");return}c("");try{await e(r),n("Contraseña cambiada exitosamente.","success")}catch{n("Error al cambiar la contraseña.","error")}};return t?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-md w-full",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Cambio de Contraseña Requerido"}),o.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Por seguridad, debes establecer una nueva contraseña para continuar."}),o.jsxs("form",{onSubmit:u,className:"space-y-4",children:[o.jsx("input",{type:"password",value:r,onChange:f=>i(f.target.value),placeholder:"Nueva Contraseña",className:"w-full p-2 border rounded-md",required:!0}),o.jsx("input",{type:"password",value:s,onChange:f=>a(f.target.value),placeholder:"Confirmar Nueva Contraseña",className:"w-full p-2 border rounded-md",required:!0}),l&&o.jsx("p",{className:"text-red-500 text-sm",children:l}),o.jsx("button",{type:"submit",className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md",children:"Guardar Contraseña"})]})]})}):null}function dO({isOpen:t,onComplete:e,user:n,userProfile:r}){const{addNotification:i}=kn(),[s,a]=fe.useState({fullName:(r==null?void 0:r.fullName)||"",identification:(r==null?void 0:r.identification)||"",phone:(r==null?void 0:r.phone)||"",address:(r==null?void 0:r.address)||""}),[l,c]=fe.useState(!1);fe.useEffect(()=>{const g=new URLSearchParams(window.location.search),y=g.get("uid");g.get("email");const p=g.get("name"),T=g.get("id");y&&y===(n==null?void 0:n.uid)&&(p||T)&&a(E=>({...E,fullName:p?decodeURIComponent(p):E.fullName,identification:T?decodeURIComponent(T):E.identification}))},[n==null?void 0:n.uid]);const u=g=>{const{name:y,value:p}=g.target;a(T=>({...T,[y]:p}))},f=async g=>{if(g.preventDefault(),!s.fullName.trim()){i("El nombre completo es obligatorio","error");return}c(!0);try{const y=mt(qe,"artifacts",Be,"public","data","users",n.uid);await hr(y,{fullName:s.fullName.trim(),identification:s.identification.trim(),phone:s.phone.trim(),address:s.address.trim(),isProfileComplete:!0,profileCompletedAt:new Date}),i("Perfil completado exitosamente","success"),e()}catch(y){console.error("Error completing profile:",y),i("Error al completar el perfil","error")}finally{c(!1)}};return t?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Completar Perfil"}),o.jsxs("p",{className:"text-gray-600 mt-2",children:["Bienvenido ",n.email,"! Confirma o actualiza tu información para continuar."]})]}),o.jsxs("form",{onSubmit:f,className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Completo *"}),o.jsx("input",{name:"fullName",value:s.fullName,onChange:u,placeholder:"Tu nombre completo",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Identificación"}),o.jsx("input",{name:"identification",value:s.identification,onChange:u,placeholder:"Cédula, DNI, etc.",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teléfono"}),o.jsx("input",{name:"phone",value:s.phone,onChange:u,placeholder:"+57 300 123 4567",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dirección"}),o.jsx("input",{name:"address",value:s.address,onChange:u,placeholder:"Tu dirección",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]})]}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[o.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Información Importante"}),o.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[o.jsx("li",{children:"• Los datos mostrados fueron configurados por el administrador"}),o.jsx("li",{children:"• Puedes confirmar o modificar la información"}),o.jsx("li",{children:"• Esta información se usará para la facturación"}),o.jsx("li",{children:"• Puedes actualizar estos datos más tarde"})]})]}),o.jsx("div",{className:"flex justify-end pt-4",children:o.jsx("button",{type:"submit",disabled:l,className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold disabled:opacity-50 flex items-center gap-2",children:l?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Completando..."]}):"Completar Perfil"})})]})]})}):null}function hO({onComplete:t}){const{addNotification:e}=kn(),[n,r]=fe.useState(1),[i,s]=fe.useState({companyName:"",identification:"",address:"",phone:"",email:"",website:""}),[a,l]=fe.useState({email:"",password:"",confirmPassword:"",fullName:"",identification:""}),[c,u]=fe.useState(!1),f=T=>{const{name:E,value:P}=T.target;s(A=>({...A,[E]:P}))},g=T=>{const{name:E,value:P}=T.target;l(A=>({...A,[E]:P}))},y=T=>{if(T.preventDefault(),!i.companyName){e("El nombre de la empresa es obligatorio","error");return}r(2)},p=async T=>{if(T.preventDefault(),a.password!==a.confirmPassword){e("Las contraseñas no coinciden","error");return}if(a.password.length<6){e("La contraseña debe tener al menos 6 caracteres","error");return}u(!0);try{const E=await Em(yr,a.email,a.password);await va(mt(qe,"artifacts",Be,"public","data","users",E.user.uid),{email:a.email,fullName:a.fullName,identification:a.identification,role:"superadmin",status:"active",isProfileComplete:!0,createdAt:lt.now(),requiresPasswordChange:!1}),await va(mt(qe,"artifacts",Be,"public","data","settings","company_info"),{...i,isDemoMode:!1,createdAt:lt.now()}),e("¡Configuración inicial completada exitosamente!","success"),r(3),setTimeout(()=>{t()},2e3)}catch(E){console.error("Error en configuración inicial:",E),e(`Error: ${E.message}`,"error")}finally{u(!1)}};return n===1?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Configuración Inicial"}),o.jsx("p",{className:"text-gray-600 mt-2",children:"Paso 1 de 2: Información de la Empresa"})]}),o.jsxs("form",{onSubmit:y,className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx("input",{name:"companyName",value:i.companyName,onChange:f,placeholder:"Nombre de la Empresa *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),o.jsx("input",{name:"identification",value:i.identification,onChange:f,placeholder:"NIT / Identificación Fiscal",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx("input",{name:"address",value:i.address,onChange:f,placeholder:"Dirección",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"}),o.jsx("input",{name:"phone",value:i.phone,onChange:f,placeholder:"Teléfono",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx("input",{name:"email",type:"email",value:i.email,onChange:f,placeholder:"Email de Contacto",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"}),o.jsx("input",{name:"website",value:i.website,onChange:f,placeholder:"Sitio Web",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),o.jsx("div",{className:"flex justify-end pt-4",children:o.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold",children:"Continuar"})})]})]})}):n===2?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Crear Superadministrador"}),o.jsx("p",{className:"text-gray-600 mt-2",children:"Paso 2 de 2: Cuenta de Administrador Principal"})]}),o.jsxs("form",{onSubmit:p,className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx("input",{name:"fullName",value:a.fullName,onChange:g,placeholder:"Nombre Completo *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),o.jsx("input",{name:"identification",value:a.identification,onChange:g,placeholder:"Identificación",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),o.jsx("input",{name:"email",type:"email",value:a.email,onChange:g,placeholder:"Email del Administrador *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx("input",{name:"password",type:"password",value:a.password,onChange:g,placeholder:"Contraseña *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),o.jsx("input",{name:"confirmPassword",type:"password",value:a.confirmPassword,onChange:g,placeholder:"Confirmar Contraseña *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0})]}),o.jsxs("div",{className:"flex justify-between pt-4",children:[o.jsx("button",{type:"button",onClick:()=>r(1),className:"px-6 py-3 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 font-semibold",children:"Atrás"}),o.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold disabled:opacity-50",children:c?"Creando...":"Completar Configuración"})]})]})]})}):n===3?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-md w-full text-center",children:[o.jsx("div",{className:"text-green-500 text-6xl mb-4",children:"✅"}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"¡Configuración Completada!"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"El sistema está listo para usar. Serás redirigido al dashboard en unos segundos..."}),o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"})]})}):null}const fO=async()=>{console.log("🔍 Iniciando diagnóstico de Firebase...");try{console.log("📋 Configuración de Firebase:"),console.log("- App ID:",Be),console.log("- Auth:",yr?"✅ Configurado":"❌ No configurado"),console.log("- Firestore:",qe?"✅ Configurado":"❌ No configurado"),console.log(`
👥 Verificando usuarios existentes...`);const t=Ht(qe,"artifacts",Be,"public","data","users"),e=await ga(t);if(e.empty)return console.log("⚠️ No hay usuarios en la base de datos"),{success:!1,message:"No hay usuarios registrados"};const n=e.docs.map(s=>({id:s.id,...s.data()}));console.log("📊 Usuarios encontrados:",n.length),n.forEach(s=>{console.log(`- ${s.email} (${s.role}) - Estado: ${s.status}`)}),console.log(`
🏢 Verificando configuración de empresa...`);const r=mt(qe,"artifacts",Be,"public","data","settings","company_info"),i=await Xl(r);return i.exists()?(console.log("✅ Configuración de empresa encontrada"),console.log("- Nombre:",i.data().companyName)):console.log("⚠️ No hay configuración de empresa"),{success:!0,users:n,settings:i.exists()?i.data():null}}catch(t){return console.error("❌ Error en diagnóstico:",t),{success:!1,error:t.message}}},QA=async(t,e,n="client")=>{try{console.log(`🔧 Creando usuario de prueba: ${t}`);const r=await Em(yr,t,e);return await va(mt(qe,"artifacts",Be,"public","data","users",r.user.uid),{email:t,fullName:`Usuario ${n}`,identification:"12345678",role:n,status:"active",isProfileComplete:!0,createdAt:lt.now(),requiresPasswordChange:!1}),console.log("✅ Usuario creado exitosamente"),{success:!0,user:r.user}}catch(r){return console.error("❌ Error creando usuario:",r),{success:!1,error:r.message}}},pO=async(t,e)=>{try{console.log(`🔐 Probando login: ${t}`);const n=await Vp(yr,t,e);return console.log("✅ Login exitoso"),await Wl(yr),console.log("🚪 Sesión cerrada"),{success:!0,user:n.user}}catch(n){return console.error("❌ Error en login:",n),{success:!1,error:n.message}}},mO=async()=>{const t=[{email:"admin@test.com",password:"admin123",role:"superadmin"},{email:"cliente@test.com",password:"cliente123",role:"client"}];console.log("🚀 Creando usuarios de prueba por defecto...");for(const e of t){const n=await QA(e.email,e.password,e.role);n.success?console.log(`✅ ${e.email} creado`):console.log(`❌ Error creando ${e.email}:`,n.error)}},gO=async()=>{try{console.log("🔧 Verificando configuración básica...");const t=mt(qe,"artifacts",Be,"public","data","settings","company_info");(await Xl(t)).exists()||(console.log("📝 Creando configuración básica de empresa..."),await va(t,{companyName:"Gestor de Cobros",identification:"123.456.789-0",address:"Dirección de Prueba",phone:"+57 300 123 4567",email:"contacto@gestor-cobros.com",website:"www.gestor-cobros.com",isDemoMode:!1,createdAt:lt.now()}),console.log("✅ Configuración de empresa creada"));const n=Ht(qe,"artifacts",Be,"public","data","users");return(await ga(n)).empty&&(console.log("👥 Creando superadmin inicial..."),await QA("admin@gestor-cobros.com","admin123","superadmin")),console.log("✅ Configuración básica completada"),{success:!0}}catch(t){return console.error("❌ Error en configuración básica:",t),{success:!1,error:t.message}}};function vO(){const[t,e]=fe.useState([]),[n,r]=fe.useState(!1),i=(y,p="info")=>{e(T=>[...T,{message:y,type:p,timestamp:new Date().toLocaleTimeString()}])},s=()=>e([]),a=async()=>{r(!0),s(),i("🔍 Iniciando diagnóstico de Firebase...","info");try{const y=await fO();y.success?(i("✅ Diagnóstico completado exitosamente","success"),i(`📊 Usuarios encontrados: ${y.users.length}`,"info"),y.users.forEach(p=>{i(`- ${p.email} (${p.role}) - Estado: ${p.status}`,"info")})):i(`❌ Error en diagnóstico: ${y.message}`,"error")}catch(y){i(`❌ Error: ${y.message}`,"error")}finally{r(!1)}},l=async()=>{r(!0),s(),i("🚀 Creando usuarios de prueba...","info");try{await mO(),i("✅ Usuarios de prueba creados","success")}catch(y){i(`❌ Error: ${y.message}`,"error")}finally{r(!1)}},c=async()=>{r(!0),s(),i("🔧 Configurando sistema básico...","info");try{const y=await gO();y.success?i("✅ Configuración básica completada","success"):i(`❌ Error: ${y.error}`,"error")}catch(y){i(`❌ Error: ${y.message}`,"error")}finally{r(!1)}},u=async()=>{r(!0),s(),i("🔐 Probando login con usuario de prueba...","info");try{const y=await pO("admin@test.com","admin123");y.success?i("✅ Login de prueba exitoso","success"):i(`❌ Error en login: ${y.error}`,"error")}catch(y){i(`❌ Error: ${y.message}`,"error")}finally{r(!1)}},f=async()=>{r(!0),s(),i("🔍 Ejecutando diagnóstico avanzado...","info");try{const y=await X3();if(y.hasUsers){i(`✅ Usuarios encontrados: ${y.users.length}`,"success"),y.users.forEach((T,E)=>{i(`👤 ${E+1}. ${T.email} (${T.role}) - ${T.status}`,"info")}),y.hasSettings?i("✅ Configuración de empresa encontrada","success"):i("⚠️ No hay configuración de empresa","warning");const p=await VR();p&&i(`👑 Usuario más antiguo: ${p.data.email} (${p.data.role})`,"info")}else i("❌ No hay usuarios en la base de datos","error"),y.error&&i(`Error: ${y.error}`,"error")}catch(y){i(`❌ Error en diagnóstico: ${y.message}`,"error")}finally{r(!1)}},g=y=>{switch(y){case"success":return"text-green-600";case"error":return"text-red-600";case"warning":return"text-yellow-600";default:return"text-blue-600"}};return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsx("h2",{className:"text-2xl font-bold mb-6",children:"🔧 Diagnóstico de Firebase"}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[o.jsx("button",{onClick:a,disabled:n,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:"🔍 Diagnóstico"}),o.jsx("button",{onClick:f,disabled:n,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50",children:"🔬 Avanzado"}),o.jsx("button",{onClick:l,disabled:n,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50",children:"👥 Crear Usuarios"}),o.jsx("button",{onClick:c,disabled:n,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50",children:"⚙️ Configurar"}),o.jsx("button",{onClick:u,disabled:n,className:"px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 disabled:opacity-50",children:"🔐 Probar Login"})]}),o.jsx("div",{className:"mb-4",children:o.jsx("button",{onClick:s,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"🗑️ Limpiar"})}),o.jsxs("div",{className:"bg-gray-100 rounded-lg p-4 max-h-96 overflow-y-auto",children:[o.jsx("h3",{className:"font-semibold mb-2",children:"Resultados:"}),t.length===0?o.jsx("p",{className:"text-gray-500",children:"No hay resultados aún. Ejecuta un diagnóstico."}):o.jsx("div",{className:"space-y-1",children:t.map((y,p)=>o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-xs text-gray-400",children:y.timestamp}),o.jsx("span",{className:`text-sm ${g(y.type)}`,children:y.message})]},p))})]}),o.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[o.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Credenciales de Prueba:"}),o.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Admin:"})," admin@test.com / admin123"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Cliente:"})," cliente@test.com / cliente123"]})]})]}),o.jsx("div",{className:"mt-4 flex justify-end",children:o.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"🔄 Recargar Página"})})]})})}function yO(){const{addNotification:t}=kn(),[e,n]=fe.useState(null),[r,i]=fe.useState(null),[s,a]=fe.useState(!0),[l,c]=fe.useState(()=>localStorage.getItem("isDemoMode")==="true"),[u,f]=fe.useState({companyName:"Gestor de Cobros"}),[g,y]=fe.useState(!1),[p,T]=fe.useState(!1),[E,P]=fe.useState(!1);fe.useEffect(()=>{localStorage.setItem("isDemoMode",l.toString())},[l]);const A=async()=>{try{console.log("🔍 Verificando si el sistema está configurado...");try{if((await X3()).hasUsers)return console.log("✅ Usuarios encontrados en Firestore"),!0}catch(w){console.warn("⚠️ Error accediendo a Firestore:",w.message)}return await UR()?(console.log("✅ Usuarios encontrados en Authentication"),!0):(console.log("⚠️ Asumiendo que el sistema está configurado (hay errores de permisos)"),!0)}catch(N){return console.error("❌ Error verificando configuración:",N),!0}};fe.useEffect(()=>{(async()=>{try{console.log("🔧 Iniciando verificación de configuración..."),console.log("🏢 Verificando configuración de empresa...");const w=mt(qe,"artifacts",Be,"public","data","settings","company_info"),k=await Xl(w);if(k.exists()){console.log("✅ Configuración de empresa encontrada");const D=k.data();console.log("📋 Configuración:",D),f(D),c(D.isDemoMode||!1),T(!0),y(!1),console.log("✅ Sistema configurado con configuración existente");return}console.log("👥 No hay configuración, verificando si hay usuarios..."),await A()?(console.log("✅ Sistema ya configurado, saltando setup inicial"),f({companyName:"Gestor de Cobros",isDemoMode:!1}),T(!0),y(!1)):(console.log("❌ Sistema no configurado, mostrando setup inicial"),y(!0))}catch(w){console.error("❌ Error checking configuration:",w),console.log("⚠️ Error en verificación, asumiendo que el sistema está configurado"),f({companyName:"Gestor de Cobros",isDemoMode:!1}),T(!0),y(!1)}})()},[]),fe.useEffect(()=>{if(!p)return;if(l){n({email:"superadmin@demo.com",uid:"demouser"}),i({role:"superadmin"}),a(!1);return}const N=zk(yr,w=>{if(w){const k=mt(qe,"artifacts",Be,"public","data","users",w.uid),H=nn(k,async D=>{if(D.exists()){const W=D.data();W.status==="active"||W.role==="superadmin"?(i(W),n(w)):(console.warn("Usuario inactivo o sin permisos:",W),t("Tu cuenta no está activa. Contacta al administrador.","error"),Wl(yr))}else console.warn("No se encontró el perfil de usuario en la base de datos"),console.log("Usuario no tiene perfil en Firestore, cerrando sesión..."),t("Usuario no encontrado en el sistema. Contacta al administrador.","error"),Wl(yr);a(!1)},D=>{console.error("Error fetching user data:",D),w&&t("Error al cargar el perfil de usuario. Intenta nuevamente.","error"),a(!1)});return()=>H()}else n(null),i(null),a(!1)});return()=>{N()}},[p,l]);const L=async N=>{const w=yr.currentUser;if(w)try{await Vk(w,N);const k=mt(qe,"artifacts",Be,"public","data","users",w.uid);await hr(k,{requiresPasswordChange:!1})}catch(k){console.error("Error updating password:",k),t("Hubo un error al cambiar la contraseña.","error"),Wl(yr)}},M=()=>{l?(n(null),i(null)):Wl(yr)},F=(N,w)=>{n(N),i({role:w,status:"active"})},te=()=>{y(!1),T(!0),window.location.reload()};if(g)return o.jsx(hO,{onComplete:te});if(E)return o.jsx(vO,{onClose:()=>P(!1)});if(s)return o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"Cargando..."});const ae=l?{email:"superadmin@demo.com",uid:"demouser"}:e,B=l?"superadmin":r==null?void 0:r.role;if(r!=null&&r.requiresPasswordChange&&!l)return o.jsx(uO,{isOpen:!0,onSave:L});const j=new URLSearchParams(window.location.search).get("uid"),S=j&&j===(e==null?void 0:e.uid);return(r==null?void 0:r.role)==="client"&&!l&&(!(r!=null&&r.isProfileComplete)&&(r==null?void 0:r.requiresPasswordChange)===!1||S)?o.jsx(dO,{isOpen:!0,onComplete:()=>{i(N=>({...N,isProfileComplete:!0})),S&&window.history.replaceState({},document.title,window.location.pathname)},user:e,userProfile:r}):o.jsx("div",{className:"bg-gray-50 min-h-screen font-sans text-gray-800",children:ae?o.jsxs(o.Fragment,{children:[o.jsx("header",{className:"bg-white shadow-md",children:o.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center",children:[u.logoUrl?o.jsx("img",{src:u.logoUrl,alt:u.companyName,className:"max-h-10"}):o.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:u.companyName}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("span",{className:"text-sm text-gray-600 hidden sm:block",children:ae.email}),o.jsx("button",{onClick:M,className:"text-gray-500 hover:text-red-600",children:o.jsx(zR,{})})]})]})}),l&&o.jsx("div",{className:"bg-yellow-400 text-center p-2 text-sm font-semibold",children:"MODO DE PRUEBA ACTIVO"}),B==="superadmin"||B==="admin"?o.jsx(eO,{user:ae,isDemo:l,setIsDemoMode:c,userRole:B,companySettings:u,onLogout:M}):o.jsx(oO,{user:ae,isDemo:l,userProfile:r})]}):o.jsxs("div",{className:"flex flex-col min-h-screen",children:[l&&o.jsx("div",{className:"bg-yellow-400 text-center p-3 text-sm font-semibold",children:"🟡 MODO DEMO ACTIVO - Usa los botones de prueba para acceder"}),o.jsx("div",{className:"flex-grow",children:l?o.jsx(cO,{companySettings:u,onLogin:F}):o.jsx(lO,{companySettings:u})}),(u.isDemoMode||u.allowDemoMode)&&o.jsxs("div",{className:"fixed bottom-4 right-4 flex flex-col gap-2",children:[o.jsx("button",{onClick:()=>c(!l),className:`px-4 py-2 rounded-lg shadow-lg text-sm font-medium transition-colors ${l?"bg-green-600 text-white hover:bg-green-700":"bg-yellow-600 text-white hover:bg-yellow-700"}`,title:l?"Cambiar a modo Live":"Cambiar a modo Demo",children:l?"🟢 Live":"🟡 Demo"}),o.jsx("button",{onClick:()=>P(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg shadow-lg hover:bg-red-700 text-sm",title:"Diagnóstico de Firebase",children:"🔧 Debug"})]})]})})}function xO(){return o.jsx(qR,{children:o.jsx(yO,{})})}b0.createRoot(document.getElementById("root")).render(o.jsx(JS.StrictMode,{children:o.jsx(xO,{})}));export{dn as _,wO as c,OS as g};
