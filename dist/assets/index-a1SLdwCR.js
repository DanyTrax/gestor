var zS=Object.defineProperty;var qS=(t,e,n)=>e in t?zS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var dn=(t,e,n)=>qS(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var WO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function HS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var I5={exports:{}},fp={},P5={exports:{}},Vt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bh=Symbol.for("react.element"),WS=Symbol.for("react.portal"),GS=Symbol.for("react.fragment"),KS=Symbol.for("react.strict_mode"),YS=Symbol.for("react.profiler"),QS=Symbol.for("react.provider"),XS=Symbol.for("react.context"),JS=Symbol.for("react.forward_ref"),ZS=Symbol.for("react.suspense"),e3=Symbol.for("react.memo"),t3=Symbol.for("react.lazy"),F2=Symbol.iterator;function n3(t){return t===null||typeof t!="object"?null:(t=F2&&t[F2]||t["@@iterator"],typeof t=="function"?t:null)}var R5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},L5=Object.assign,D5={};function Cu(t,e,n){this.props=t,this.context=e,this.refs=D5,this.updater=n||R5}Cu.prototype.isReactComponent={};Cu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Cu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function O5(){}O5.prototype=Cu.prototype;function t1(t,e,n){this.props=t,this.context=e,this.refs=D5,this.updater=n||R5}var n1=t1.prototype=new O5;n1.constructor=t1;L5(n1,Cu.prototype);n1.isPureReactComponent=!0;var U2=Array.isArray,M5=Object.prototype.hasOwnProperty,r1={current:null},F5={key:!0,ref:!0,__self:!0,__source:!0};function U5(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)M5.call(e,r)&&!F5.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:bh,type:t,key:s,ref:o,props:i,_owner:r1.current}}function r3(t,e){return{$$typeof:bh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function i1(t){return typeof t=="object"&&t!==null&&t.$$typeof===bh}function i3(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var V2=/\/+/g;function xg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?i3(""+t.key):e.toString(36)}function Uf(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case bh:case WS:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+xg(o,0):r,U2(i)?(n="",t!=null&&(n=t.replace(V2,"$&/")+"/"),Uf(i,e,n,"",function(u){return u})):i!=null&&(i1(i)&&(i=r3(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(V2,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",U2(t))for(var l=0;l<t.length;l++){s=t[l];var c=r+xg(s,l);o+=Uf(s,e,n,c,i)}else if(c=n3(t),typeof c=="function")for(t=c.call(t),l=0;!(s=t.next()).done;)s=s.value,c=r+xg(s,l++),o+=Uf(s,e,n,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function of(t,e,n){if(t==null)return t;var r=[],i=0;return Uf(t,r,"","",function(s){return e.call(n,s,i++)}),r}function s3(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var gi={current:null},Vf={transition:null},a3={ReactCurrentDispatcher:gi,ReactCurrentBatchConfig:Vf,ReactCurrentOwner:r1};function V5(){throw Error("act(...) is not supported in production builds of React.")}Vt.Children={map:of,forEach:function(t,e,n){of(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return of(t,function(){e++}),e},toArray:function(t){return of(t,function(e){return e})||[]},only:function(t){if(!i1(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Vt.Component=Cu;Vt.Fragment=GS;Vt.Profiler=YS;Vt.PureComponent=t1;Vt.StrictMode=KS;Vt.Suspense=ZS;Vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=a3;Vt.act=V5;Vt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=L5({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=r1.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)M5.call(e,c)&&!F5.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:bh,type:t.type,key:i,ref:s,props:r,_owner:o}};Vt.createContext=function(t){return t={$$typeof:XS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:QS,_context:t},t.Consumer=t};Vt.createElement=U5;Vt.createFactory=function(t){var e=U5.bind(null,t);return e.type=t,e};Vt.createRef=function(){return{current:null}};Vt.forwardRef=function(t){return{$$typeof:JS,render:t}};Vt.isValidElement=i1;Vt.lazy=function(t){return{$$typeof:t3,_payload:{_status:-1,_result:t},_init:s3}};Vt.memo=function(t,e){return{$$typeof:e3,type:t,compare:e===void 0?null:e}};Vt.startTransition=function(t){var e=Vf.transition;Vf.transition={};try{t()}finally{Vf.transition=e}};Vt.unstable_act=V5;Vt.useCallback=function(t,e){return gi.current.useCallback(t,e)};Vt.useContext=function(t){return gi.current.useContext(t)};Vt.useDebugValue=function(){};Vt.useDeferredValue=function(t){return gi.current.useDeferredValue(t)};Vt.useEffect=function(t,e){return gi.current.useEffect(t,e)};Vt.useId=function(){return gi.current.useId()};Vt.useImperativeHandle=function(t,e,n){return gi.current.useImperativeHandle(t,e,n)};Vt.useInsertionEffect=function(t,e){return gi.current.useInsertionEffect(t,e)};Vt.useLayoutEffect=function(t,e){return gi.current.useLayoutEffect(t,e)};Vt.useMemo=function(t,e){return gi.current.useMemo(t,e)};Vt.useReducer=function(t,e,n){return gi.current.useReducer(t,e,n)};Vt.useRef=function(t){return gi.current.useRef(t)};Vt.useState=function(t){return gi.current.useState(t)};Vt.useSyncExternalStore=function(t,e,n){return gi.current.useSyncExternalStore(t,e,n)};Vt.useTransition=function(){return gi.current.useTransition()};Vt.version="18.3.1";P5.exports=Vt;var ue=P5.exports;const o3=HS(ue);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l3=ue,c3=Symbol.for("react.element"),u3=Symbol.for("react.fragment"),d3=Object.prototype.hasOwnProperty,h3=l3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,f3={key:!0,ref:!0,__self:!0,__source:!0};function B5(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)d3.call(e,r)&&!f3.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:c3,type:t,key:s,ref:o,props:i,_owner:h3.current}}fp.Fragment=u3;fp.jsx=B5;fp.jsxs=B5;I5.exports=fp;var a=I5.exports,k0={},$5={exports:{}},es={},z5={exports:{}},q5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,W){var Y=H.length;H.push(W);e:for(;0<Y;){var B=Y-1>>>1,A=H[B];if(0<i(A,W))H[B]=W,H[Y]=A,Y=B;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var W=H[0],Y=H.pop();if(Y!==W){H[0]=Y;e:for(var B=0,A=H.length,P=A>>>1;B<P;){var q=2*(B+1)-1,te=H[q],le=q+1,ce=H[le];if(0>i(te,Y))le<A&&0>i(ce,te)?(H[B]=ce,H[le]=Y,B=le):(H[B]=te,H[q]=Y,B=q);else if(le<A&&0>i(ce,Y))H[B]=ce,H[le]=Y,B=le;else break e}}return W}function i(H,W){var Y=H.sortIndex-W.sortIndex;return Y!==0?Y:H.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],f=1,v=null,g=3,p=!1,S=!1,k=!1,C=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(H){for(var W=n(u);W!==null;){if(W.callback===null)r(u);else if(W.startTime<=H)r(u),W.sortIndex=W.expirationTime,e(c,W);else break;W=n(u)}}function D(H){if(k=!1,R(H),!S)if(n(c)!==null)S=!0,F(ee);else{var W=n(u);W!==null&&X(D,W.startTime-H)}}function ee(H,W){S=!1,k&&(k=!1,b(T),T=-1),p=!0;var Y=g;try{for(R(W),v=n(c);v!==null&&(!(v.expirationTime>W)||H&&!E());){var B=v.callback;if(typeof B=="function"){v.callback=null,g=v.priorityLevel;var A=B(v.expirationTime<=W);W=t.unstable_now(),typeof A=="function"?v.callback=A:v===n(c)&&r(c),R(W)}else r(c);v=n(c)}if(v!==null)var P=!0;else{var q=n(u);q!==null&&X(D,q.startTime-W),P=!1}return P}finally{v=null,g=Y,p=!1}}var oe=!1,V=null,T=-1,N=5,U=-1;function E(){return!(t.unstable_now()-U<N)}function L(){if(V!==null){var H=t.unstable_now();U=H;var W=!0;try{W=V(!0,H)}finally{W?_():(oe=!1,V=null)}}else oe=!1}var _;if(typeof I=="function")_=function(){I(L)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,K=M.port2;M.port1.onmessage=L,_=function(){K.postMessage(null)}}else _=function(){C(L,0)};function F(H){V=H,oe||(oe=!0,_())}function X(H,W){T=C(function(){H(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){S||p||(S=!0,F(ee))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(H){switch(g){case 1:case 2:case 3:var W=3;break;default:W=g}var Y=g;g=W;try{return H()}finally{g=Y}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,W){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var Y=g;g=H;try{return W()}finally{g=Y}},t.unstable_scheduleCallback=function(H,W,Y){var B=t.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?B+Y:B):Y=B,H){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=Y+A,H={id:f++,callback:W,priorityLevel:H,startTime:Y,expirationTime:A,sortIndex:-1},Y>B?(H.sortIndex=Y,e(u,H),n(c)===null&&H===n(u)&&(k?(b(T),T=-1):k=!0,X(D,Y-B))):(H.sortIndex=A,e(c,H),S||p||(S=!0,F(ee))),H},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(H){var W=g;return function(){var Y=g;g=W;try{return H.apply(this,arguments)}finally{g=Y}}}})(q5);z5.exports=q5;var m3=z5.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p3=ue,Zi=m3;function Ue(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var H5=new Set,Hd={};function yc(t,e){pu(t,e),pu(t+"Capture",e)}function pu(t,e){for(Hd[t]=e,t=0;t<e.length;t++)H5.add(e[t])}var no=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),T0=Object.prototype.hasOwnProperty,g3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,B2={},$2={};function v3(t){return T0.call($2,t)?!0:T0.call(B2,t)?!1:g3.test(t)?$2[t]=!0:(B2[t]=!0,!1)}function y3(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function x3(t,e,n,r){if(e===null||typeof e>"u"||y3(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function vi(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var $r={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){$r[t]=new vi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];$r[e]=new vi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){$r[t]=new vi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){$r[t]=new vi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){$r[t]=new vi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){$r[t]=new vi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){$r[t]=new vi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){$r[t]=new vi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){$r[t]=new vi(t,5,!1,t.toLowerCase(),null,!1,!1)});var s1=/[\-:]([a-z])/g;function a1(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(s1,a1);$r[e]=new vi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(s1,a1);$r[e]=new vi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(s1,a1);$r[e]=new vi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){$r[t]=new vi(t,1,!1,t.toLowerCase(),null,!1,!1)});$r.xlinkHref=new vi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){$r[t]=new vi(t,1,!1,t.toLowerCase(),null,!0,!0)});function o1(t,e,n,r){var i=$r.hasOwnProperty(e)?$r[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(x3(e,n,i,r)&&(n=null),r||i===null?v3(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var fo=p3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,lf=Symbol.for("react.element"),Vc=Symbol.for("react.portal"),Bc=Symbol.for("react.fragment"),l1=Symbol.for("react.strict_mode"),j0=Symbol.for("react.profiler"),W5=Symbol.for("react.provider"),G5=Symbol.for("react.context"),c1=Symbol.for("react.forward_ref"),C0=Symbol.for("react.suspense"),I0=Symbol.for("react.suspense_list"),u1=Symbol.for("react.memo"),$o=Symbol.for("react.lazy"),K5=Symbol.for("react.offscreen"),z2=Symbol.iterator;function ld(t){return t===null||typeof t!="object"?null:(t=z2&&t[z2]||t["@@iterator"],typeof t=="function"?t:null)}var qn=Object.assign,bg;function xd(t){if(bg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);bg=e&&e[1]||""}return`
`+bg+t}var wg=!1;function Ng(t,e){if(!t||wg)return"";wg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{wg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?xd(t):""}function b3(t){switch(t.tag){case 5:return xd(t.type);case 16:return xd("Lazy");case 13:return xd("Suspense");case 19:return xd("SuspenseList");case 0:case 2:case 15:return t=Ng(t.type,!1),t;case 11:return t=Ng(t.type.render,!1),t;case 1:return t=Ng(t.type,!0),t;default:return""}}function P0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Bc:return"Fragment";case Vc:return"Portal";case j0:return"Profiler";case l1:return"StrictMode";case C0:return"Suspense";case I0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case G5:return(t.displayName||"Context")+".Consumer";case W5:return(t._context.displayName||"Context")+".Provider";case c1:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case u1:return e=t.displayName||null,e!==null?e:P0(t.type)||"Memo";case $o:e=t._payload,t=t._init;try{return P0(t(e))}catch{}}return null}function w3(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return P0(e);case 8:return e===l1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function hl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Y5(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function N3(t){var e=Y5(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function cf(t){t._valueTracker||(t._valueTracker=N3(t))}function Q5(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Y5(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function fm(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function R0(t,e){var n=e.checked;return qn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function q2(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=hl(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function X5(t,e){e=e.checked,e!=null&&o1(t,"checked",e,!1)}function L0(t,e){X5(t,e);var n=hl(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?D0(t,e.type,n):e.hasOwnProperty("defaultValue")&&D0(t,e.type,hl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function H2(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function D0(t,e,n){(e!=="number"||fm(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var bd=Array.isArray;function eu(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+hl(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function O0(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ue(91));return qn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function W2(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Ue(92));if(bd(n)){if(1<n.length)throw Error(Ue(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:hl(n)}}function J5(t,e){var n=hl(e.value),r=hl(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function G2(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Z5(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function M0(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Z5(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var uf,eN=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(uf=uf||document.createElement("div"),uf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=uf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Wd(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var jd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_3=["Webkit","ms","Moz","O"];Object.keys(jd).forEach(function(t){_3.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),jd[e]=jd[t]})});function tN(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||jd.hasOwnProperty(t)&&jd[t]?(""+e).trim():e+"px"}function nN(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=tN(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var E3=qn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function F0(t,e){if(e){if(E3[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ue(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ue(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ue(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ue(62))}}function U0(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var V0=null;function d1(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var B0=null,tu=null,nu=null;function K2(t){if(t=_h(t)){if(typeof B0!="function")throw Error(Ue(280));var e=t.stateNode;e&&(e=yp(e),B0(t.stateNode,t.type,e))}}function rN(t){tu?nu?nu.push(t):nu=[t]:tu=t}function iN(){if(tu){var t=tu,e=nu;if(nu=tu=null,K2(t),e)for(t=0;t<e.length;t++)K2(e[t])}}function sN(t,e){return t(e)}function aN(){}var _g=!1;function oN(t,e,n){if(_g)return t(e,n);_g=!0;try{return sN(t,e,n)}finally{_g=!1,(tu!==null||nu!==null)&&(aN(),iN())}}function Gd(t,e){var n=t.stateNode;if(n===null)return null;var r=yp(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Ue(231,e,typeof n));return n}var $0=!1;if(no)try{var cd={};Object.defineProperty(cd,"passive",{get:function(){$0=!0}}),window.addEventListener("test",cd,cd),window.removeEventListener("test",cd,cd)}catch{$0=!1}function A3(t,e,n,r,i,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var Cd=!1,mm=null,pm=!1,z0=null,S3={onError:function(t){Cd=!0,mm=t}};function k3(t,e,n,r,i,s,o,l,c){Cd=!1,mm=null,A3.apply(S3,arguments)}function T3(t,e,n,r,i,s,o,l,c){if(k3.apply(this,arguments),Cd){if(Cd){var u=mm;Cd=!1,mm=null}else throw Error(Ue(198));pm||(pm=!0,z0=u)}}function xc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function lN(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Y2(t){if(xc(t)!==t)throw Error(Ue(188))}function j3(t){var e=t.alternate;if(!e){if(e=xc(t),e===null)throw Error(Ue(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Y2(i),t;if(s===r)return Y2(i),e;s=s.sibling}throw Error(Ue(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(Ue(189))}}if(n.alternate!==r)throw Error(Ue(190))}if(n.tag!==3)throw Error(Ue(188));return n.stateNode.current===n?t:e}function cN(t){return t=j3(t),t!==null?uN(t):null}function uN(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=uN(t);if(e!==null)return e;t=t.sibling}return null}var dN=Zi.unstable_scheduleCallback,Q2=Zi.unstable_cancelCallback,C3=Zi.unstable_shouldYield,I3=Zi.unstable_requestPaint,sr=Zi.unstable_now,P3=Zi.unstable_getCurrentPriorityLevel,h1=Zi.unstable_ImmediatePriority,hN=Zi.unstable_UserBlockingPriority,gm=Zi.unstable_NormalPriority,R3=Zi.unstable_LowPriority,fN=Zi.unstable_IdlePriority,mp=null,pa=null;function L3(t){if(pa&&typeof pa.onCommitFiberRoot=="function")try{pa.onCommitFiberRoot(mp,t,void 0,(t.current.flags&128)===128)}catch{}}var Fs=Math.clz32?Math.clz32:M3,D3=Math.log,O3=Math.LN2;function M3(t){return t>>>=0,t===0?32:31-(D3(t)/O3|0)|0}var df=64,hf=4194304;function wd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function vm(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=wd(l):(s&=o,s!==0&&(r=wd(s)))}else o=n&~i,o!==0?r=wd(o):s!==0&&(r=wd(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Fs(e),i=1<<n,r|=t[n],e&=~i;return r}function F3(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function U3(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Fs(s),l=1<<o,c=i[o];c===-1?(!(l&n)||l&r)&&(i[o]=F3(l,e)):c<=e&&(t.expiredLanes|=l),s&=~l}}function q0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function mN(){var t=df;return df<<=1,!(df&4194240)&&(df=64),t}function Eg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function wh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Fs(e),t[e]=n}function V3(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Fs(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function f1(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Fs(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var fn=0;function pN(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var gN,m1,vN,yN,xN,H0=!1,ff=[],el=null,tl=null,nl=null,Kd=new Map,Yd=new Map,qo=[],B3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function X2(t,e){switch(t){case"focusin":case"focusout":el=null;break;case"dragenter":case"dragleave":tl=null;break;case"mouseover":case"mouseout":nl=null;break;case"pointerover":case"pointerout":Kd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yd.delete(e.pointerId)}}function ud(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=_h(e),e!==null&&m1(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function $3(t,e,n,r,i){switch(e){case"focusin":return el=ud(el,t,e,n,r,i),!0;case"dragenter":return tl=ud(tl,t,e,n,r,i),!0;case"mouseover":return nl=ud(nl,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Kd.set(s,ud(Kd.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Yd.set(s,ud(Yd.get(s)||null,t,e,n,r,i)),!0}return!1}function bN(t){var e=Xl(t.target);if(e!==null){var n=xc(e);if(n!==null){if(e=n.tag,e===13){if(e=lN(n),e!==null){t.blockedOn=e,xN(t.priority,function(){vN(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Bf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=W0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);V0=r,n.target.dispatchEvent(r),V0=null}else return e=_h(n),e!==null&&m1(e),t.blockedOn=n,!1;e.shift()}return!0}function J2(t,e,n){Bf(t)&&n.delete(e)}function z3(){H0=!1,el!==null&&Bf(el)&&(el=null),tl!==null&&Bf(tl)&&(tl=null),nl!==null&&Bf(nl)&&(nl=null),Kd.forEach(J2),Yd.forEach(J2)}function dd(t,e){t.blockedOn===e&&(t.blockedOn=null,H0||(H0=!0,Zi.unstable_scheduleCallback(Zi.unstable_NormalPriority,z3)))}function Qd(t){function e(i){return dd(i,t)}if(0<ff.length){dd(ff[0],t);for(var n=1;n<ff.length;n++){var r=ff[n];r.blockedOn===t&&(r.blockedOn=null)}}for(el!==null&&dd(el,t),tl!==null&&dd(tl,t),nl!==null&&dd(nl,t),Kd.forEach(e),Yd.forEach(e),n=0;n<qo.length;n++)r=qo[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<qo.length&&(n=qo[0],n.blockedOn===null);)bN(n),n.blockedOn===null&&qo.shift()}var ru=fo.ReactCurrentBatchConfig,ym=!0;function q3(t,e,n,r){var i=fn,s=ru.transition;ru.transition=null;try{fn=1,p1(t,e,n,r)}finally{fn=i,ru.transition=s}}function H3(t,e,n,r){var i=fn,s=ru.transition;ru.transition=null;try{fn=4,p1(t,e,n,r)}finally{fn=i,ru.transition=s}}function p1(t,e,n,r){if(ym){var i=W0(t,e,n,r);if(i===null)Lg(t,e,r,xm,n),X2(t,r);else if($3(i,t,e,n,r))r.stopPropagation();else if(X2(t,r),e&4&&-1<B3.indexOf(t)){for(;i!==null;){var s=_h(i);if(s!==null&&gN(s),s=W0(t,e,n,r),s===null&&Lg(t,e,r,xm,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Lg(t,e,r,null,n)}}var xm=null;function W0(t,e,n,r){if(xm=null,t=d1(r),t=Xl(t),t!==null)if(e=xc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=lN(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return xm=t,null}function wN(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(P3()){case h1:return 1;case hN:return 4;case gm:case R3:return 16;case fN:return 536870912;default:return 16}default:return 16}}var Qo=null,g1=null,$f=null;function NN(){if($f)return $f;var t,e=g1,n=e.length,r,i="value"in Qo?Qo.value:Qo.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return $f=i.slice(t,1<r?1-r:void 0)}function zf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function mf(){return!0}function Z2(){return!1}function ts(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?mf:Z2,this.isPropagationStopped=Z2,this}return qn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=mf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=mf)},persist:function(){},isPersistent:mf}),e}var Iu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},v1=ts(Iu),Nh=qn({},Iu,{view:0,detail:0}),W3=ts(Nh),Ag,Sg,hd,pp=qn({},Nh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:y1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==hd&&(hd&&t.type==="mousemove"?(Ag=t.screenX-hd.screenX,Sg=t.screenY-hd.screenY):Sg=Ag=0,hd=t),Ag)},movementY:function(t){return"movementY"in t?t.movementY:Sg}}),ex=ts(pp),G3=qn({},pp,{dataTransfer:0}),K3=ts(G3),Y3=qn({},Nh,{relatedTarget:0}),kg=ts(Y3),Q3=qn({},Iu,{animationName:0,elapsedTime:0,pseudoElement:0}),X3=ts(Q3),J3=qn({},Iu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Z3=ts(J3),ek=qn({},Iu,{data:0}),tx=ts(ek),tk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ik(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=rk[t])?!!e[t]:!1}function y1(){return ik}var sk=qn({},Nh,{key:function(t){if(t.key){var e=tk[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=zf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?nk[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:y1,charCode:function(t){return t.type==="keypress"?zf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?zf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),ak=ts(sk),ok=qn({},pp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nx=ts(ok),lk=qn({},Nh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:y1}),ck=ts(lk),uk=qn({},Iu,{propertyName:0,elapsedTime:0,pseudoElement:0}),dk=ts(uk),hk=qn({},pp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),fk=ts(hk),mk=[9,13,27,32],x1=no&&"CompositionEvent"in window,Id=null;no&&"documentMode"in document&&(Id=document.documentMode);var pk=no&&"TextEvent"in window&&!Id,_N=no&&(!x1||Id&&8<Id&&11>=Id),rx=" ",ix=!1;function EN(t,e){switch(t){case"keyup":return mk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function AN(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var $c=!1;function gk(t,e){switch(t){case"compositionend":return AN(e);case"keypress":return e.which!==32?null:(ix=!0,rx);case"textInput":return t=e.data,t===rx&&ix?null:t;default:return null}}function vk(t,e){if($c)return t==="compositionend"||!x1&&EN(t,e)?(t=NN(),$f=g1=Qo=null,$c=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return _N&&e.locale!=="ko"?null:e.data;default:return null}}var yk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!yk[t.type]:e==="textarea"}function SN(t,e,n,r){rN(r),e=bm(e,"onChange"),0<e.length&&(n=new v1("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Pd=null,Xd=null;function xk(t){MN(t,0)}function gp(t){var e=Hc(t);if(Q5(e))return t}function bk(t,e){if(t==="change")return e}var kN=!1;if(no){var Tg;if(no){var jg="oninput"in document;if(!jg){var ax=document.createElement("div");ax.setAttribute("oninput","return;"),jg=typeof ax.oninput=="function"}Tg=jg}else Tg=!1;kN=Tg&&(!document.documentMode||9<document.documentMode)}function ox(){Pd&&(Pd.detachEvent("onpropertychange",TN),Xd=Pd=null)}function TN(t){if(t.propertyName==="value"&&gp(Xd)){var e=[];SN(e,Xd,t,d1(t)),oN(xk,e)}}function wk(t,e,n){t==="focusin"?(ox(),Pd=e,Xd=n,Pd.attachEvent("onpropertychange",TN)):t==="focusout"&&ox()}function Nk(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return gp(Xd)}function _k(t,e){if(t==="click")return gp(e)}function Ek(t,e){if(t==="input"||t==="change")return gp(e)}function Ak(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Vs=typeof Object.is=="function"?Object.is:Ak;function Jd(t,e){if(Vs(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!T0.call(e,i)||!Vs(t[i],e[i]))return!1}return!0}function lx(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function cx(t,e){var n=lx(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=lx(n)}}function jN(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?jN(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function CN(){for(var t=window,e=fm();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=fm(t.document)}return e}function b1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Sk(t){var e=CN(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&jN(n.ownerDocument.documentElement,n)){if(r!==null&&b1(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=cx(n,s);var o=cx(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var kk=no&&"documentMode"in document&&11>=document.documentMode,zc=null,G0=null,Rd=null,K0=!1;function ux(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;K0||zc==null||zc!==fm(r)||(r=zc,"selectionStart"in r&&b1(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Rd&&Jd(Rd,r)||(Rd=r,r=bm(G0,"onSelect"),0<r.length&&(e=new v1("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=zc)))}function pf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var qc={animationend:pf("Animation","AnimationEnd"),animationiteration:pf("Animation","AnimationIteration"),animationstart:pf("Animation","AnimationStart"),transitionend:pf("Transition","TransitionEnd")},Cg={},IN={};no&&(IN=document.createElement("div").style,"AnimationEvent"in window||(delete qc.animationend.animation,delete qc.animationiteration.animation,delete qc.animationstart.animation),"TransitionEvent"in window||delete qc.transitionend.transition);function vp(t){if(Cg[t])return Cg[t];if(!qc[t])return t;var e=qc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in IN)return Cg[t]=e[n];return t}var PN=vp("animationend"),RN=vp("animationiteration"),LN=vp("animationstart"),DN=vp("transitionend"),ON=new Map,dx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function wl(t,e){ON.set(t,e),yc(e,[t])}for(var Ig=0;Ig<dx.length;Ig++){var Pg=dx[Ig],Tk=Pg.toLowerCase(),jk=Pg[0].toUpperCase()+Pg.slice(1);wl(Tk,"on"+jk)}wl(PN,"onAnimationEnd");wl(RN,"onAnimationIteration");wl(LN,"onAnimationStart");wl("dblclick","onDoubleClick");wl("focusin","onFocus");wl("focusout","onBlur");wl(DN,"onTransitionEnd");pu("onMouseEnter",["mouseout","mouseover"]);pu("onMouseLeave",["mouseout","mouseover"]);pu("onPointerEnter",["pointerout","pointerover"]);pu("onPointerLeave",["pointerout","pointerover"]);yc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yc("onBeforeInput",["compositionend","keypress","textInput","paste"]);yc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ck=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nd));function hx(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,T3(r,e,void 0,t),t.currentTarget=null}function MN(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;hx(i,l,u),s=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;hx(i,l,u),s=c}}}if(pm)throw t=z0,pm=!1,z0=null,t}function jn(t,e){var n=e[Z0];n===void 0&&(n=e[Z0]=new Set);var r=t+"__bubble";n.has(r)||(FN(e,t,2,!1),n.add(r))}function Rg(t,e,n){var r=0;e&&(r|=4),FN(n,t,r,e)}var gf="_reactListening"+Math.random().toString(36).slice(2);function Zd(t){if(!t[gf]){t[gf]=!0,H5.forEach(function(n){n!=="selectionchange"&&(Ck.has(n)||Rg(n,!1,t),Rg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[gf]||(e[gf]=!0,Rg("selectionchange",!1,e))}}function FN(t,e,n,r){switch(wN(e)){case 1:var i=q3;break;case 4:i=H3;break;default:i=p1}n=i.bind(null,e,n,t),i=void 0,!$0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Lg(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Xl(l),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}l=l.parentNode}}r=r.return}oN(function(){var u=s,f=d1(n),v=[];e:{var g=ON.get(t);if(g!==void 0){var p=v1,S=t;switch(t){case"keypress":if(zf(n)===0)break e;case"keydown":case"keyup":p=ak;break;case"focusin":S="focus",p=kg;break;case"focusout":S="blur",p=kg;break;case"beforeblur":case"afterblur":p=kg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=ex;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=K3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=ck;break;case PN:case RN:case LN:p=X3;break;case DN:p=dk;break;case"scroll":p=W3;break;case"wheel":p=fk;break;case"copy":case"cut":case"paste":p=Z3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=nx}var k=(e&4)!==0,C=!k&&t==="scroll",b=k?g!==null?g+"Capture":null:g;k=[];for(var I=u,R;I!==null;){R=I;var D=R.stateNode;if(R.tag===5&&D!==null&&(R=D,b!==null&&(D=Gd(I,b),D!=null&&k.push(eh(I,D,R)))),C)break;I=I.return}0<k.length&&(g=new p(g,S,null,n,f),v.push({event:g,listeners:k}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",g&&n!==V0&&(S=n.relatedTarget||n.fromElement)&&(Xl(S)||S[ro]))break e;if((p||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,p?(S=n.relatedTarget||n.toElement,p=u,S=S?Xl(S):null,S!==null&&(C=xc(S),S!==C||S.tag!==5&&S.tag!==6)&&(S=null)):(p=null,S=u),p!==S)){if(k=ex,D="onMouseLeave",b="onMouseEnter",I="mouse",(t==="pointerout"||t==="pointerover")&&(k=nx,D="onPointerLeave",b="onPointerEnter",I="pointer"),C=p==null?g:Hc(p),R=S==null?g:Hc(S),g=new k(D,I+"leave",p,n,f),g.target=C,g.relatedTarget=R,D=null,Xl(f)===u&&(k=new k(b,I+"enter",S,n,f),k.target=R,k.relatedTarget=C,D=k),C=D,p&&S)t:{for(k=p,b=S,I=0,R=k;R;R=Ic(R))I++;for(R=0,D=b;D;D=Ic(D))R++;for(;0<I-R;)k=Ic(k),I--;for(;0<R-I;)b=Ic(b),R--;for(;I--;){if(k===b||b!==null&&k===b.alternate)break t;k=Ic(k),b=Ic(b)}k=null}else k=null;p!==null&&fx(v,g,p,k,!1),S!==null&&C!==null&&fx(v,C,S,k,!0)}}e:{if(g=u?Hc(u):window,p=g.nodeName&&g.nodeName.toLowerCase(),p==="select"||p==="input"&&g.type==="file")var ee=bk;else if(sx(g))if(kN)ee=Ek;else{ee=Nk;var oe=wk}else(p=g.nodeName)&&p.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(ee=_k);if(ee&&(ee=ee(t,u))){SN(v,ee,n,f);break e}oe&&oe(t,g,u),t==="focusout"&&(oe=g._wrapperState)&&oe.controlled&&g.type==="number"&&D0(g,"number",g.value)}switch(oe=u?Hc(u):window,t){case"focusin":(sx(oe)||oe.contentEditable==="true")&&(zc=oe,G0=u,Rd=null);break;case"focusout":Rd=G0=zc=null;break;case"mousedown":K0=!0;break;case"contextmenu":case"mouseup":case"dragend":K0=!1,ux(v,n,f);break;case"selectionchange":if(kk)break;case"keydown":case"keyup":ux(v,n,f)}var V;if(x1)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else $c?EN(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(_N&&n.locale!=="ko"&&($c||T!=="onCompositionStart"?T==="onCompositionEnd"&&$c&&(V=NN()):(Qo=f,g1="value"in Qo?Qo.value:Qo.textContent,$c=!0)),oe=bm(u,T),0<oe.length&&(T=new tx(T,t,null,n,f),v.push({event:T,listeners:oe}),V?T.data=V:(V=AN(n),V!==null&&(T.data=V)))),(V=pk?gk(t,n):vk(t,n))&&(u=bm(u,"onBeforeInput"),0<u.length&&(f=new tx("onBeforeInput","beforeinput",null,n,f),v.push({event:f,listeners:u}),f.data=V))}MN(v,e)})}function eh(t,e,n){return{instance:t,listener:e,currentTarget:n}}function bm(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Gd(t,n),s!=null&&r.unshift(eh(t,s,i)),s=Gd(t,e),s!=null&&r.push(eh(t,s,i))),t=t.return}return r}function Ic(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function fx(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,i?(c=Gd(n,s),c!=null&&o.unshift(eh(n,c,l))):i||(c=Gd(n,s),c!=null&&o.push(eh(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Ik=/\r\n?/g,Pk=/\u0000|\uFFFD/g;function mx(t){return(typeof t=="string"?t:""+t).replace(Ik,`
`).replace(Pk,"")}function vf(t,e,n){if(e=mx(e),mx(t)!==e&&n)throw Error(Ue(425))}function wm(){}var Y0=null,Q0=null;function X0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var J0=typeof setTimeout=="function"?setTimeout:void 0,Rk=typeof clearTimeout=="function"?clearTimeout:void 0,px=typeof Promise=="function"?Promise:void 0,Lk=typeof queueMicrotask=="function"?queueMicrotask:typeof px<"u"?function(t){return px.resolve(null).then(t).catch(Dk)}:J0;function Dk(t){setTimeout(function(){throw t})}function Dg(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Qd(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Qd(e)}function rl(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function gx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Pu=Math.random().toString(36).slice(2),ha="__reactFiber$"+Pu,th="__reactProps$"+Pu,ro="__reactContainer$"+Pu,Z0="__reactEvents$"+Pu,Ok="__reactListeners$"+Pu,Mk="__reactHandles$"+Pu;function Xl(t){var e=t[ha];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ro]||n[ha]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=gx(t);t!==null;){if(n=t[ha])return n;t=gx(t)}return e}t=n,n=t.parentNode}return null}function _h(t){return t=t[ha]||t[ro],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Hc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Ue(33))}function yp(t){return t[th]||null}var ev=[],Wc=-1;function Nl(t){return{current:t}}function Pn(t){0>Wc||(t.current=ev[Wc],ev[Wc]=null,Wc--)}function En(t,e){Wc++,ev[Wc]=t.current,t.current=e}var fl={},ai=Nl(fl),ki=Nl(!1),ac=fl;function gu(t,e){var n=t.type.contextTypes;if(!n)return fl;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Ti(t){return t=t.childContextTypes,t!=null}function Nm(){Pn(ki),Pn(ai)}function vx(t,e,n){if(ai.current!==fl)throw Error(Ue(168));En(ai,e),En(ki,n)}function UN(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Ue(108,w3(t)||"Unknown",i));return qn({},n,r)}function _m(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||fl,ac=ai.current,En(ai,t),En(ki,ki.current),!0}function yx(t,e,n){var r=t.stateNode;if(!r)throw Error(Ue(169));n?(t=UN(t,e,ac),r.__reactInternalMemoizedMergedChildContext=t,Pn(ki),Pn(ai),En(ai,t)):Pn(ki),En(ki,n)}var Wa=null,xp=!1,Og=!1;function VN(t){Wa===null?Wa=[t]:Wa.push(t)}function Fk(t){xp=!0,VN(t)}function _l(){if(!Og&&Wa!==null){Og=!0;var t=0,e=fn;try{var n=Wa;for(fn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Wa=null,xp=!1}catch(i){throw Wa!==null&&(Wa=Wa.slice(t+1)),dN(h1,_l),i}finally{fn=e,Og=!1}}return null}var Gc=[],Kc=0,Em=null,Am=0,us=[],ds=0,oc=null,Ka=1,Ya="";function Hl(t,e){Gc[Kc++]=Am,Gc[Kc++]=Em,Em=t,Am=e}function BN(t,e,n){us[ds++]=Ka,us[ds++]=Ya,us[ds++]=oc,oc=t;var r=Ka;t=Ya;var i=32-Fs(r)-1;r&=~(1<<i),n+=1;var s=32-Fs(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ka=1<<32-Fs(e)+i|n<<i|r,Ya=s+t}else Ka=1<<s|n<<i|r,Ya=t}function w1(t){t.return!==null&&(Hl(t,1),BN(t,1,0))}function N1(t){for(;t===Em;)Em=Gc[--Kc],Gc[Kc]=null,Am=Gc[--Kc],Gc[Kc]=null;for(;t===oc;)oc=us[--ds],us[ds]=null,Ya=us[--ds],us[ds]=null,Ka=us[--ds],us[ds]=null}var Xi=null,Ki=null,Mn=!1,Os=null;function $N(t,e){var n=fs(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function xx(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Xi=t,Ki=rl(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Xi=t,Ki=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=oc!==null?{id:Ka,overflow:Ya}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=fs(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Xi=t,Ki=null,!0):!1;default:return!1}}function tv(t){return(t.mode&1)!==0&&(t.flags&128)===0}function nv(t){if(Mn){var e=Ki;if(e){var n=e;if(!xx(t,e)){if(tv(t))throw Error(Ue(418));e=rl(n.nextSibling);var r=Xi;e&&xx(t,e)?$N(r,n):(t.flags=t.flags&-4097|2,Mn=!1,Xi=t)}}else{if(tv(t))throw Error(Ue(418));t.flags=t.flags&-4097|2,Mn=!1,Xi=t}}}function bx(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Xi=t}function yf(t){if(t!==Xi)return!1;if(!Mn)return bx(t),Mn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!X0(t.type,t.memoizedProps)),e&&(e=Ki)){if(tv(t))throw zN(),Error(Ue(418));for(;e;)$N(t,e),e=rl(e.nextSibling)}if(bx(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ue(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ki=rl(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ki=null}}else Ki=Xi?rl(t.stateNode.nextSibling):null;return!0}function zN(){for(var t=Ki;t;)t=rl(t.nextSibling)}function vu(){Ki=Xi=null,Mn=!1}function _1(t){Os===null?Os=[t]:Os.push(t)}var Uk=fo.ReactCurrentBatchConfig;function fd(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Ue(309));var r=n.stateNode}if(!r)throw Error(Ue(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Ue(284));if(!n._owner)throw Error(Ue(290,t))}return t}function xf(t,e){throw t=Object.prototype.toString.call(e),Error(Ue(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function wx(t){var e=t._init;return e(t._payload)}function qN(t){function e(b,I){if(t){var R=b.deletions;R===null?(b.deletions=[I],b.flags|=16):R.push(I)}}function n(b,I){if(!t)return null;for(;I!==null;)e(b,I),I=I.sibling;return null}function r(b,I){for(b=new Map;I!==null;)I.key!==null?b.set(I.key,I):b.set(I.index,I),I=I.sibling;return b}function i(b,I){return b=ol(b,I),b.index=0,b.sibling=null,b}function s(b,I,R){return b.index=R,t?(R=b.alternate,R!==null?(R=R.index,R<I?(b.flags|=2,I):R):(b.flags|=2,I)):(b.flags|=1048576,I)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function l(b,I,R,D){return I===null||I.tag!==6?(I=zg(R,b.mode,D),I.return=b,I):(I=i(I,R),I.return=b,I)}function c(b,I,R,D){var ee=R.type;return ee===Bc?f(b,I,R.props.children,D,R.key):I!==null&&(I.elementType===ee||typeof ee=="object"&&ee!==null&&ee.$$typeof===$o&&wx(ee)===I.type)?(D=i(I,R.props),D.ref=fd(b,I,R),D.return=b,D):(D=Qf(R.type,R.key,R.props,null,b.mode,D),D.ref=fd(b,I,R),D.return=b,D)}function u(b,I,R,D){return I===null||I.tag!==4||I.stateNode.containerInfo!==R.containerInfo||I.stateNode.implementation!==R.implementation?(I=qg(R,b.mode,D),I.return=b,I):(I=i(I,R.children||[]),I.return=b,I)}function f(b,I,R,D,ee){return I===null||I.tag!==7?(I=nc(R,b.mode,D,ee),I.return=b,I):(I=i(I,R),I.return=b,I)}function v(b,I,R){if(typeof I=="string"&&I!==""||typeof I=="number")return I=zg(""+I,b.mode,R),I.return=b,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case lf:return R=Qf(I.type,I.key,I.props,null,b.mode,R),R.ref=fd(b,null,I),R.return=b,R;case Vc:return I=qg(I,b.mode,R),I.return=b,I;case $o:var D=I._init;return v(b,D(I._payload),R)}if(bd(I)||ld(I))return I=nc(I,b.mode,R,null),I.return=b,I;xf(b,I)}return null}function g(b,I,R,D){var ee=I!==null?I.key:null;if(typeof R=="string"&&R!==""||typeof R=="number")return ee!==null?null:l(b,I,""+R,D);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case lf:return R.key===ee?c(b,I,R,D):null;case Vc:return R.key===ee?u(b,I,R,D):null;case $o:return ee=R._init,g(b,I,ee(R._payload),D)}if(bd(R)||ld(R))return ee!==null?null:f(b,I,R,D,null);xf(b,R)}return null}function p(b,I,R,D,ee){if(typeof D=="string"&&D!==""||typeof D=="number")return b=b.get(R)||null,l(I,b,""+D,ee);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case lf:return b=b.get(D.key===null?R:D.key)||null,c(I,b,D,ee);case Vc:return b=b.get(D.key===null?R:D.key)||null,u(I,b,D,ee);case $o:var oe=D._init;return p(b,I,R,oe(D._payload),ee)}if(bd(D)||ld(D))return b=b.get(R)||null,f(I,b,D,ee,null);xf(I,D)}return null}function S(b,I,R,D){for(var ee=null,oe=null,V=I,T=I=0,N=null;V!==null&&T<R.length;T++){V.index>T?(N=V,V=null):N=V.sibling;var U=g(b,V,R[T],D);if(U===null){V===null&&(V=N);break}t&&V&&U.alternate===null&&e(b,V),I=s(U,I,T),oe===null?ee=U:oe.sibling=U,oe=U,V=N}if(T===R.length)return n(b,V),Mn&&Hl(b,T),ee;if(V===null){for(;T<R.length;T++)V=v(b,R[T],D),V!==null&&(I=s(V,I,T),oe===null?ee=V:oe.sibling=V,oe=V);return Mn&&Hl(b,T),ee}for(V=r(b,V);T<R.length;T++)N=p(V,b,T,R[T],D),N!==null&&(t&&N.alternate!==null&&V.delete(N.key===null?T:N.key),I=s(N,I,T),oe===null?ee=N:oe.sibling=N,oe=N);return t&&V.forEach(function(E){return e(b,E)}),Mn&&Hl(b,T),ee}function k(b,I,R,D){var ee=ld(R);if(typeof ee!="function")throw Error(Ue(150));if(R=ee.call(R),R==null)throw Error(Ue(151));for(var oe=ee=null,V=I,T=I=0,N=null,U=R.next();V!==null&&!U.done;T++,U=R.next()){V.index>T?(N=V,V=null):N=V.sibling;var E=g(b,V,U.value,D);if(E===null){V===null&&(V=N);break}t&&V&&E.alternate===null&&e(b,V),I=s(E,I,T),oe===null?ee=E:oe.sibling=E,oe=E,V=N}if(U.done)return n(b,V),Mn&&Hl(b,T),ee;if(V===null){for(;!U.done;T++,U=R.next())U=v(b,U.value,D),U!==null&&(I=s(U,I,T),oe===null?ee=U:oe.sibling=U,oe=U);return Mn&&Hl(b,T),ee}for(V=r(b,V);!U.done;T++,U=R.next())U=p(V,b,T,U.value,D),U!==null&&(t&&U.alternate!==null&&V.delete(U.key===null?T:U.key),I=s(U,I,T),oe===null?ee=U:oe.sibling=U,oe=U);return t&&V.forEach(function(L){return e(b,L)}),Mn&&Hl(b,T),ee}function C(b,I,R,D){if(typeof R=="object"&&R!==null&&R.type===Bc&&R.key===null&&(R=R.props.children),typeof R=="object"&&R!==null){switch(R.$$typeof){case lf:e:{for(var ee=R.key,oe=I;oe!==null;){if(oe.key===ee){if(ee=R.type,ee===Bc){if(oe.tag===7){n(b,oe.sibling),I=i(oe,R.props.children),I.return=b,b=I;break e}}else if(oe.elementType===ee||typeof ee=="object"&&ee!==null&&ee.$$typeof===$o&&wx(ee)===oe.type){n(b,oe.sibling),I=i(oe,R.props),I.ref=fd(b,oe,R),I.return=b,b=I;break e}n(b,oe);break}else e(b,oe);oe=oe.sibling}R.type===Bc?(I=nc(R.props.children,b.mode,D,R.key),I.return=b,b=I):(D=Qf(R.type,R.key,R.props,null,b.mode,D),D.ref=fd(b,I,R),D.return=b,b=D)}return o(b);case Vc:e:{for(oe=R.key;I!==null;){if(I.key===oe)if(I.tag===4&&I.stateNode.containerInfo===R.containerInfo&&I.stateNode.implementation===R.implementation){n(b,I.sibling),I=i(I,R.children||[]),I.return=b,b=I;break e}else{n(b,I);break}else e(b,I);I=I.sibling}I=qg(R,b.mode,D),I.return=b,b=I}return o(b);case $o:return oe=R._init,C(b,I,oe(R._payload),D)}if(bd(R))return S(b,I,R,D);if(ld(R))return k(b,I,R,D);xf(b,R)}return typeof R=="string"&&R!==""||typeof R=="number"?(R=""+R,I!==null&&I.tag===6?(n(b,I.sibling),I=i(I,R),I.return=b,b=I):(n(b,I),I=zg(R,b.mode,D),I.return=b,b=I),o(b)):n(b,I)}return C}var yu=qN(!0),HN=qN(!1),Sm=Nl(null),km=null,Yc=null,E1=null;function A1(){E1=Yc=km=null}function S1(t){var e=Sm.current;Pn(Sm),t._currentValue=e}function rv(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function iu(t,e){km=t,E1=Yc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Si=!0),t.firstContext=null)}function ys(t){var e=t._currentValue;if(E1!==t)if(t={context:t,memoizedValue:e,next:null},Yc===null){if(km===null)throw Error(Ue(308));Yc=t,km.dependencies={lanes:0,firstContext:t}}else Yc=Yc.next=t;return e}var Jl=null;function k1(t){Jl===null?Jl=[t]:Jl.push(t)}function WN(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,k1(e)):(n.next=i.next,i.next=n),e.interleaved=n,io(t,r)}function io(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var zo=!1;function T1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function GN(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Za(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function il(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Zt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,io(t,n)}return i=r.interleaved,i===null?(e.next=e,k1(r)):(e.next=i.next,i.next=e),r.interleaved=e,io(t,n)}function qf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,f1(t,n)}}function Nx(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Tm(t,e,n,r){var i=t.updateQueue;zo=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=c))}if(s!==null){var v=i.baseState;o=0,f=u=c=null,l=s;do{var g=l.lane,p=l.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var S=t,k=l;switch(g=e,p=n,k.tag){case 1:if(S=k.payload,typeof S=="function"){v=S.call(p,v,g);break e}v=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=k.payload,g=typeof S=="function"?S.call(p,v,g):S,g==null)break e;v=qn({},v,g);break e;case 2:zo=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[l]:g.push(l))}else p={eventTime:p,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(u=f=p,c=v):f=f.next=p,o|=g;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;g=l,l=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(c=v),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);cc|=o,t.lanes=o,t.memoizedState=v}}function _x(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Ue(191,i));i.call(r)}}}var Eh={},ga=Nl(Eh),nh=Nl(Eh),rh=Nl(Eh);function Zl(t){if(t===Eh)throw Error(Ue(174));return t}function j1(t,e){switch(En(rh,e),En(nh,t),En(ga,Eh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:M0(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=M0(e,t)}Pn(ga),En(ga,e)}function xu(){Pn(ga),Pn(nh),Pn(rh)}function KN(t){Zl(rh.current);var e=Zl(ga.current),n=M0(e,t.type);e!==n&&(En(nh,t),En(ga,n))}function C1(t){nh.current===t&&(Pn(ga),Pn(nh))}var $n=Nl(0);function jm(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Mg=[];function I1(){for(var t=0;t<Mg.length;t++)Mg[t]._workInProgressVersionPrimary=null;Mg.length=0}var Hf=fo.ReactCurrentDispatcher,Fg=fo.ReactCurrentBatchConfig,lc=0,zn=null,wr=null,jr=null,Cm=!1,Ld=!1,ih=0,Vk=0;function Yr(){throw Error(Ue(321))}function P1(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Vs(t[n],e[n]))return!1;return!0}function R1(t,e,n,r,i,s){if(lc=s,zn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Hf.current=t===null||t.memoizedState===null?qk:Hk,t=n(r,i),Ld){s=0;do{if(Ld=!1,ih=0,25<=s)throw Error(Ue(301));s+=1,jr=wr=null,e.updateQueue=null,Hf.current=Wk,t=n(r,i)}while(Ld)}if(Hf.current=Im,e=wr!==null&&wr.next!==null,lc=0,jr=wr=zn=null,Cm=!1,e)throw Error(Ue(300));return t}function L1(){var t=ih!==0;return ih=0,t}function da(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jr===null?zn.memoizedState=jr=t:jr=jr.next=t,jr}function xs(){if(wr===null){var t=zn.alternate;t=t!==null?t.memoizedState:null}else t=wr.next;var e=jr===null?zn.memoizedState:jr.next;if(e!==null)jr=e,wr=t;else{if(t===null)throw Error(Ue(310));wr=t,t={memoizedState:wr.memoizedState,baseState:wr.baseState,baseQueue:wr.baseQueue,queue:wr.queue,next:null},jr===null?zn.memoizedState=jr=t:jr=jr.next=t}return jr}function sh(t,e){return typeof e=="function"?e(t):e}function Ug(t){var e=xs(),n=e.queue;if(n===null)throw Error(Ue(311));n.lastRenderedReducer=t;var r=wr,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,c=null,u=s;do{var f=u.lane;if((lc&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var v={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=v,o=r):c=c.next=v,zn.lanes|=f,cc|=f}u=u.next}while(u!==null&&u!==s);c===null?o=r:c.next=l,Vs(r,e.memoizedState)||(Si=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,zn.lanes|=s,cc|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Vg(t){var e=xs(),n=e.queue;if(n===null)throw Error(Ue(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Vs(s,e.memoizedState)||(Si=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function YN(){}function QN(t,e){var n=zn,r=xs(),i=e(),s=!Vs(r.memoizedState,i);if(s&&(r.memoizedState=i,Si=!0),r=r.queue,D1(ZN.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||jr!==null&&jr.memoizedState.tag&1){if(n.flags|=2048,ah(9,JN.bind(null,n,r,i,e),void 0,null),Ir===null)throw Error(Ue(349));lc&30||XN(n,e,i)}return i}function XN(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=zn.updateQueue,e===null?(e={lastEffect:null,stores:null},zn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function JN(t,e,n,r){e.value=n,e.getSnapshot=r,e_(e)&&t_(t)}function ZN(t,e,n){return n(function(){e_(e)&&t_(t)})}function e_(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Vs(t,n)}catch{return!0}}function t_(t){var e=io(t,1);e!==null&&Us(e,t,1,-1)}function Ex(t){var e=da();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sh,lastRenderedState:t},e.queue=t,t=t.dispatch=zk.bind(null,zn,t),[e.memoizedState,t]}function ah(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=zn.updateQueue,e===null?(e={lastEffect:null,stores:null},zn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function n_(){return xs().memoizedState}function Wf(t,e,n,r){var i=da();zn.flags|=t,i.memoizedState=ah(1|e,n,void 0,r===void 0?null:r)}function bp(t,e,n,r){var i=xs();r=r===void 0?null:r;var s=void 0;if(wr!==null){var o=wr.memoizedState;if(s=o.destroy,r!==null&&P1(r,o.deps)){i.memoizedState=ah(e,n,s,r);return}}zn.flags|=t,i.memoizedState=ah(1|e,n,s,r)}function Ax(t,e){return Wf(8390656,8,t,e)}function D1(t,e){return bp(2048,8,t,e)}function r_(t,e){return bp(4,2,t,e)}function i_(t,e){return bp(4,4,t,e)}function s_(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function a_(t,e,n){return n=n!=null?n.concat([t]):null,bp(4,4,s_.bind(null,e,t),n)}function O1(){}function o_(t,e){var n=xs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&P1(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function l_(t,e){var n=xs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&P1(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function c_(t,e,n){return lc&21?(Vs(n,e)||(n=mN(),zn.lanes|=n,cc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Si=!0),t.memoizedState=n)}function Bk(t,e){var n=fn;fn=n!==0&&4>n?n:4,t(!0);var r=Fg.transition;Fg.transition={};try{t(!1),e()}finally{fn=n,Fg.transition=r}}function u_(){return xs().memoizedState}function $k(t,e,n){var r=al(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},d_(t))h_(e,n);else if(n=WN(t,e,n,r),n!==null){var i=pi();Us(n,t,r,i),f_(n,e,r)}}function zk(t,e,n){var r=al(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(d_(t))h_(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,n);if(i.hasEagerState=!0,i.eagerState=l,Vs(l,o)){var c=e.interleaved;c===null?(i.next=i,k1(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=WN(t,e,i,r),n!==null&&(i=pi(),Us(n,t,r,i),f_(n,e,r))}}function d_(t){var e=t.alternate;return t===zn||e!==null&&e===zn}function h_(t,e){Ld=Cm=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function f_(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,f1(t,n)}}var Im={readContext:ys,useCallback:Yr,useContext:Yr,useEffect:Yr,useImperativeHandle:Yr,useInsertionEffect:Yr,useLayoutEffect:Yr,useMemo:Yr,useReducer:Yr,useRef:Yr,useState:Yr,useDebugValue:Yr,useDeferredValue:Yr,useTransition:Yr,useMutableSource:Yr,useSyncExternalStore:Yr,useId:Yr,unstable_isNewReconciler:!1},qk={readContext:ys,useCallback:function(t,e){return da().memoizedState=[t,e===void 0?null:e],t},useContext:ys,useEffect:Ax,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Wf(4194308,4,s_.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Wf(4194308,4,t,e)},useInsertionEffect:function(t,e){return Wf(4,2,t,e)},useMemo:function(t,e){var n=da();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=da();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=$k.bind(null,zn,t),[r.memoizedState,t]},useRef:function(t){var e=da();return t={current:t},e.memoizedState=t},useState:Ex,useDebugValue:O1,useDeferredValue:function(t){return da().memoizedState=t},useTransition:function(){var t=Ex(!1),e=t[0];return t=Bk.bind(null,t[1]),da().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=zn,i=da();if(Mn){if(n===void 0)throw Error(Ue(407));n=n()}else{if(n=e(),Ir===null)throw Error(Ue(349));lc&30||XN(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Ax(ZN.bind(null,r,s,t),[t]),r.flags|=2048,ah(9,JN.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=da(),e=Ir.identifierPrefix;if(Mn){var n=Ya,r=Ka;n=(r&~(1<<32-Fs(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ih++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Vk++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Hk={readContext:ys,useCallback:o_,useContext:ys,useEffect:D1,useImperativeHandle:a_,useInsertionEffect:r_,useLayoutEffect:i_,useMemo:l_,useReducer:Ug,useRef:n_,useState:function(){return Ug(sh)},useDebugValue:O1,useDeferredValue:function(t){var e=xs();return c_(e,wr.memoizedState,t)},useTransition:function(){var t=Ug(sh)[0],e=xs().memoizedState;return[t,e]},useMutableSource:YN,useSyncExternalStore:QN,useId:u_,unstable_isNewReconciler:!1},Wk={readContext:ys,useCallback:o_,useContext:ys,useEffect:D1,useImperativeHandle:a_,useInsertionEffect:r_,useLayoutEffect:i_,useMemo:l_,useReducer:Vg,useRef:n_,useState:function(){return Vg(sh)},useDebugValue:O1,useDeferredValue:function(t){var e=xs();return wr===null?e.memoizedState=t:c_(e,wr.memoizedState,t)},useTransition:function(){var t=Vg(sh)[0],e=xs().memoizedState;return[t,e]},useMutableSource:YN,useSyncExternalStore:QN,useId:u_,unstable_isNewReconciler:!1};function Ls(t,e){if(t&&t.defaultProps){e=qn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function iv(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:qn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var wp={isMounted:function(t){return(t=t._reactInternals)?xc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=pi(),i=al(t),s=Za(r,i);s.payload=e,n!=null&&(s.callback=n),e=il(t,s,i),e!==null&&(Us(e,t,i,r),qf(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=pi(),i=al(t),s=Za(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=il(t,s,i),e!==null&&(Us(e,t,i,r),qf(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=pi(),r=al(t),i=Za(n,r);i.tag=2,e!=null&&(i.callback=e),e=il(t,i,r),e!==null&&(Us(e,t,r,n),qf(e,t,r))}};function Sx(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Jd(n,r)||!Jd(i,s):!0}function m_(t,e,n){var r=!1,i=fl,s=e.contextType;return typeof s=="object"&&s!==null?s=ys(s):(i=Ti(e)?ac:ai.current,r=e.contextTypes,s=(r=r!=null)?gu(t,i):fl),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=wp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function kx(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&wp.enqueueReplaceState(e,e.state,null)}function sv(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},T1(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=ys(s):(s=Ti(e)?ac:ai.current,i.context=gu(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(iv(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&wp.enqueueReplaceState(i,i.state,null),Tm(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function bu(t,e){try{var n="",r=e;do n+=b3(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Bg(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function av(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Gk=typeof WeakMap=="function"?WeakMap:Map;function p_(t,e,n){n=Za(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Rm||(Rm=!0,gv=r),av(t,e)},n}function g_(t,e,n){n=Za(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){av(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){av(t,e),typeof r!="function"&&(sl===null?sl=new Set([this]):sl.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Tx(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Gk;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=oT.bind(null,t,e,n),e.then(t,t))}function jx(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Cx(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Za(-1,1),e.tag=2,il(n,e,1))),n.lanes|=1),t)}var Kk=fo.ReactCurrentOwner,Si=!1;function mi(t,e,n,r){e.child=t===null?HN(e,null,n,r):yu(e,t.child,n,r)}function Ix(t,e,n,r,i){n=n.render;var s=e.ref;return iu(e,i),r=R1(t,e,n,r,s,i),n=L1(),t!==null&&!Si?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,so(t,e,i)):(Mn&&n&&w1(e),e.flags|=1,mi(t,e,r,i),e.child)}function Px(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!q1(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,v_(t,e,s,r,i)):(t=Qf(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Jd,n(o,r)&&t.ref===e.ref)return so(t,e,i)}return e.flags|=1,t=ol(s,r),t.ref=e.ref,t.return=e,e.child=t}function v_(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Jd(s,r)&&t.ref===e.ref)if(Si=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Si=!0);else return e.lanes=t.lanes,so(t,e,i)}return ov(t,e,n,r,i)}function y_(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},En(Xc,Gi),Gi|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,En(Xc,Gi),Gi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,En(Xc,Gi),Gi|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,En(Xc,Gi),Gi|=r;return mi(t,e,i,n),e.child}function x_(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function ov(t,e,n,r,i){var s=Ti(n)?ac:ai.current;return s=gu(e,s),iu(e,i),n=R1(t,e,n,r,s,i),r=L1(),t!==null&&!Si?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,so(t,e,i)):(Mn&&r&&w1(e),e.flags|=1,mi(t,e,n,i),e.child)}function Rx(t,e,n,r,i){if(Ti(n)){var s=!0;_m(e)}else s=!1;if(iu(e,i),e.stateNode===null)Gf(t,e),m_(e,n,r),sv(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=ys(u):(u=Ti(n)?ac:ai.current,u=gu(e,u));var f=n.getDerivedStateFromProps,v=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";v||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&kx(e,o,r,u),zo=!1;var g=e.memoizedState;o.state=g,Tm(e,r,o,i),c=e.memoizedState,l!==r||g!==c||ki.current||zo?(typeof f=="function"&&(iv(e,n,f,r),c=e.memoizedState),(l=zo||Sx(e,n,l,r,g,c,u))?(v||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,GN(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Ls(e.type,l),o.props=u,v=e.pendingProps,g=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=ys(c):(c=Ti(n)?ac:ai.current,c=gu(e,c));var p=n.getDerivedStateFromProps;(f=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==v||g!==c)&&kx(e,o,r,c),zo=!1,g=e.memoizedState,o.state=g,Tm(e,r,o,i);var S=e.memoizedState;l!==v||g!==S||ki.current||zo?(typeof p=="function"&&(iv(e,n,p,r),S=e.memoizedState),(u=zo||Sx(e,n,u,r,g,S,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,S,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,S,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=S),o.props=r,o.state=S,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return lv(t,e,n,r,s,i)}function lv(t,e,n,r,i,s){x_(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&yx(e,n,!1),so(t,e,s);r=e.stateNode,Kk.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=yu(e,t.child,null,s),e.child=yu(e,null,l,s)):mi(t,e,l,s),e.memoizedState=r.state,i&&yx(e,n,!0),e.child}function b_(t){var e=t.stateNode;e.pendingContext?vx(t,e.pendingContext,e.pendingContext!==e.context):e.context&&vx(t,e.context,!1),j1(t,e.containerInfo)}function Lx(t,e,n,r,i){return vu(),_1(i),e.flags|=256,mi(t,e,n,r),e.child}var cv={dehydrated:null,treeContext:null,retryLane:0};function uv(t){return{baseLanes:t,cachePool:null,transitions:null}}function w_(t,e,n){var r=e.pendingProps,i=$n.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),En($n,i&1),t===null)return nv(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Ep(o,r,0,null),t=nc(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=uv(n),e.memoizedState=cv,t):M1(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return Yk(t,e,o,r,l,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=ol(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=ol(l,s):(s=nc(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?uv(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=cv,r}return s=t.child,t=s.sibling,r=ol(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function M1(t,e){return e=Ep({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function bf(t,e,n,r){return r!==null&&_1(r),yu(e,t.child,null,n),t=M1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Yk(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Bg(Error(Ue(422))),bf(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Ep({mode:"visible",children:r.children},i,0,null),s=nc(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&yu(e,t.child,null,o),e.child.memoizedState=uv(o),e.memoizedState=cv,s);if(!(e.mode&1))return bf(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(Ue(419)),r=Bg(s,r,void 0),bf(t,e,o,r)}if(l=(o&t.childLanes)!==0,Si||l){if(r=Ir,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,io(t,i),Us(r,t,i,-1))}return z1(),r=Bg(Error(Ue(421))),bf(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=lT.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Ki=rl(i.nextSibling),Xi=e,Mn=!0,Os=null,t!==null&&(us[ds++]=Ka,us[ds++]=Ya,us[ds++]=oc,Ka=t.id,Ya=t.overflow,oc=e),e=M1(e,r.children),e.flags|=4096,e)}function Dx(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),rv(t.return,e,n)}function $g(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function N_(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(mi(t,e,r.children,n),r=$n.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Dx(t,n,e);else if(t.tag===19)Dx(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(En($n,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&jm(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),$g(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&jm(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}$g(e,!0,n,null,s);break;case"together":$g(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Gf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function so(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),cc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Ue(153));if(e.child!==null){for(t=e.child,n=ol(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ol(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Qk(t,e,n){switch(e.tag){case 3:b_(e),vu();break;case 5:KN(e);break;case 1:Ti(e.type)&&_m(e);break;case 4:j1(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;En(Sm,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(En($n,$n.current&1),e.flags|=128,null):n&e.child.childLanes?w_(t,e,n):(En($n,$n.current&1),t=so(t,e,n),t!==null?t.sibling:null);En($n,$n.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return N_(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),En($n,$n.current),r)break;return null;case 22:case 23:return e.lanes=0,y_(t,e,n)}return so(t,e,n)}var __,dv,E_,A_;__=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};dv=function(){};E_=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Zl(ga.current);var s=null;switch(n){case"input":i=R0(t,i),r=R0(t,r),s=[];break;case"select":i=qn({},i,{value:void 0}),r=qn({},r,{value:void 0}),s=[];break;case"textarea":i=O0(t,i),r=O0(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=wm)}F0(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Hd.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Hd.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&jn("scroll",t),s||l===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};A_=function(t,e,n,r){n!==r&&(e.flags|=4)};function md(t,e){if(!Mn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Qr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Xk(t,e,n){var r=e.pendingProps;switch(N1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qr(e),null;case 1:return Ti(e.type)&&Nm(),Qr(e),null;case 3:return r=e.stateNode,xu(),Pn(ki),Pn(ai),I1(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(yf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Os!==null&&(xv(Os),Os=null))),dv(t,e),Qr(e),null;case 5:C1(e);var i=Zl(rh.current);if(n=e.type,t!==null&&e.stateNode!=null)E_(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Ue(166));return Qr(e),null}if(t=Zl(ga.current),yf(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[ha]=e,r[th]=s,t=(e.mode&1)!==0,n){case"dialog":jn("cancel",r),jn("close",r);break;case"iframe":case"object":case"embed":jn("load",r);break;case"video":case"audio":for(i=0;i<Nd.length;i++)jn(Nd[i],r);break;case"source":jn("error",r);break;case"img":case"image":case"link":jn("error",r),jn("load",r);break;case"details":jn("toggle",r);break;case"input":q2(r,s),jn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},jn("invalid",r);break;case"textarea":W2(r,s),jn("invalid",r)}F0(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&vf(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&vf(r.textContent,l,t),i=["children",""+l]):Hd.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&jn("scroll",r)}switch(n){case"input":cf(r),H2(r,s,!0);break;case"textarea":cf(r),G2(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=wm)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Z5(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[ha]=e,t[th]=r,__(t,e,!1,!1),e.stateNode=t;e:{switch(o=U0(n,r),n){case"dialog":jn("cancel",t),jn("close",t),i=r;break;case"iframe":case"object":case"embed":jn("load",t),i=r;break;case"video":case"audio":for(i=0;i<Nd.length;i++)jn(Nd[i],t);i=r;break;case"source":jn("error",t),i=r;break;case"img":case"image":case"link":jn("error",t),jn("load",t),i=r;break;case"details":jn("toggle",t),i=r;break;case"input":q2(t,r),i=R0(t,r),jn("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=qn({},r,{value:void 0}),jn("invalid",t);break;case"textarea":W2(t,r),i=O0(t,r),jn("invalid",t);break;default:i=r}F0(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?nN(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&eN(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Wd(t,c):typeof c=="number"&&Wd(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Hd.hasOwnProperty(s)?c!=null&&s==="onScroll"&&jn("scroll",t):c!=null&&o1(t,s,c,o))}switch(n){case"input":cf(t),H2(t,r,!1);break;case"textarea":cf(t),G2(t);break;case"option":r.value!=null&&t.setAttribute("value",""+hl(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?eu(t,!!r.multiple,s,!1):r.defaultValue!=null&&eu(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=wm)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Qr(e),null;case 6:if(t&&e.stateNode!=null)A_(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Ue(166));if(n=Zl(rh.current),Zl(ga.current),yf(e)){if(r=e.stateNode,n=e.memoizedProps,r[ha]=e,(s=r.nodeValue!==n)&&(t=Xi,t!==null))switch(t.tag){case 3:vf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&vf(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ha]=e,e.stateNode=r}return Qr(e),null;case 13:if(Pn($n),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Mn&&Ki!==null&&e.mode&1&&!(e.flags&128))zN(),vu(),e.flags|=98560,s=!1;else if(s=yf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Ue(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ue(317));s[ha]=e}else vu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Qr(e),s=!1}else Os!==null&&(xv(Os),Os=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||$n.current&1?_r===0&&(_r=3):z1())),e.updateQueue!==null&&(e.flags|=4),Qr(e),null);case 4:return xu(),dv(t,e),t===null&&Zd(e.stateNode.containerInfo),Qr(e),null;case 10:return S1(e.type._context),Qr(e),null;case 17:return Ti(e.type)&&Nm(),Qr(e),null;case 19:if(Pn($n),s=e.memoizedState,s===null)return Qr(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)md(s,!1);else{if(_r!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=jm(t),o!==null){for(e.flags|=128,md(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return En($n,$n.current&1|2),e.child}t=t.sibling}s.tail!==null&&sr()>wu&&(e.flags|=128,r=!0,md(s,!1),e.lanes=4194304)}else{if(!r)if(t=jm(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),md(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Mn)return Qr(e),null}else 2*sr()-s.renderingStartTime>wu&&n!==1073741824&&(e.flags|=128,r=!0,md(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=sr(),e.sibling=null,n=$n.current,En($n,r?n&1|2:n&1),e):(Qr(e),null);case 22:case 23:return $1(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Gi&1073741824&&(Qr(e),e.subtreeFlags&6&&(e.flags|=8192)):Qr(e),null;case 24:return null;case 25:return null}throw Error(Ue(156,e.tag))}function Jk(t,e){switch(N1(e),e.tag){case 1:return Ti(e.type)&&Nm(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return xu(),Pn(ki),Pn(ai),I1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return C1(e),null;case 13:if(Pn($n),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Ue(340));vu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Pn($n),null;case 4:return xu(),null;case 10:return S1(e.type._context),null;case 22:case 23:return $1(),null;case 24:return null;default:return null}}var wf=!1,ri=!1,Zk=typeof WeakSet=="function"?WeakSet:Set,Ge=null;function Qc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Xn(t,e,r)}else n.current=null}function hv(t,e,n){try{n()}catch(r){Xn(t,e,r)}}var Ox=!1;function eT(t,e){if(Y0=ym,t=CN(),b1(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,f=0,v=t,g=null;t:for(;;){for(var p;v!==n||i!==0&&v.nodeType!==3||(l=o+i),v!==s||r!==0&&v.nodeType!==3||(c=o+r),v.nodeType===3&&(o+=v.nodeValue.length),(p=v.firstChild)!==null;)g=v,v=p;for(;;){if(v===t)break t;if(g===n&&++u===i&&(l=o),g===s&&++f===r&&(c=o),(p=v.nextSibling)!==null)break;v=g,g=v.parentNode}v=p}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Q0={focusedElem:t,selectionRange:n},ym=!1,Ge=e;Ge!==null;)if(e=Ge,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ge=t;else for(;Ge!==null;){e=Ge;try{var S=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var k=S.memoizedProps,C=S.memoizedState,b=e.stateNode,I=b.getSnapshotBeforeUpdate(e.elementType===e.type?k:Ls(e.type,k),C);b.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var R=e.stateNode.containerInfo;R.nodeType===1?R.textContent="":R.nodeType===9&&R.documentElement&&R.removeChild(R.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ue(163))}}catch(D){Xn(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,Ge=t;break}Ge=e.return}return S=Ox,Ox=!1,S}function Dd(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&hv(e,n,s)}i=i.next}while(i!==r)}}function Np(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function fv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function S_(t){var e=t.alternate;e!==null&&(t.alternate=null,S_(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ha],delete e[th],delete e[Z0],delete e[Ok],delete e[Mk])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function k_(t){return t.tag===5||t.tag===3||t.tag===4}function Mx(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||k_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function mv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=wm));else if(r!==4&&(t=t.child,t!==null))for(mv(t,e,n),t=t.sibling;t!==null;)mv(t,e,n),t=t.sibling}function pv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(pv(t,e,n),t=t.sibling;t!==null;)pv(t,e,n),t=t.sibling}var Mr=null,Ds=!1;function Fo(t,e,n){for(n=n.child;n!==null;)T_(t,e,n),n=n.sibling}function T_(t,e,n){if(pa&&typeof pa.onCommitFiberUnmount=="function")try{pa.onCommitFiberUnmount(mp,n)}catch{}switch(n.tag){case 5:ri||Qc(n,e);case 6:var r=Mr,i=Ds;Mr=null,Fo(t,e,n),Mr=r,Ds=i,Mr!==null&&(Ds?(t=Mr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Mr.removeChild(n.stateNode));break;case 18:Mr!==null&&(Ds?(t=Mr,n=n.stateNode,t.nodeType===8?Dg(t.parentNode,n):t.nodeType===1&&Dg(t,n),Qd(t)):Dg(Mr,n.stateNode));break;case 4:r=Mr,i=Ds,Mr=n.stateNode.containerInfo,Ds=!0,Fo(t,e,n),Mr=r,Ds=i;break;case 0:case 11:case 14:case 15:if(!ri&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&hv(n,e,o),i=i.next}while(i!==r)}Fo(t,e,n);break;case 1:if(!ri&&(Qc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Xn(n,e,l)}Fo(t,e,n);break;case 21:Fo(t,e,n);break;case 22:n.mode&1?(ri=(r=ri)||n.memoizedState!==null,Fo(t,e,n),ri=r):Fo(t,e,n);break;default:Fo(t,e,n)}}function Fx(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Zk),e.forEach(function(r){var i=cT.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Ps(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Mr=l.stateNode,Ds=!1;break e;case 3:Mr=l.stateNode.containerInfo,Ds=!0;break e;case 4:Mr=l.stateNode.containerInfo,Ds=!0;break e}l=l.return}if(Mr===null)throw Error(Ue(160));T_(s,o,i),Mr=null,Ds=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){Xn(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)j_(e,t),e=e.sibling}function j_(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ps(e,t),la(t),r&4){try{Dd(3,t,t.return),Np(3,t)}catch(k){Xn(t,t.return,k)}try{Dd(5,t,t.return)}catch(k){Xn(t,t.return,k)}}break;case 1:Ps(e,t),la(t),r&512&&n!==null&&Qc(n,n.return);break;case 5:if(Ps(e,t),la(t),r&512&&n!==null&&Qc(n,n.return),t.flags&32){var i=t.stateNode;try{Wd(i,"")}catch(k){Xn(t,t.return,k)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&X5(i,s),U0(l,o);var u=U0(l,s);for(o=0;o<c.length;o+=2){var f=c[o],v=c[o+1];f==="style"?nN(i,v):f==="dangerouslySetInnerHTML"?eN(i,v):f==="children"?Wd(i,v):o1(i,f,v,u)}switch(l){case"input":L0(i,s);break;case"textarea":J5(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?eu(i,!!s.multiple,p,!1):g!==!!s.multiple&&(s.defaultValue!=null?eu(i,!!s.multiple,s.defaultValue,!0):eu(i,!!s.multiple,s.multiple?[]:"",!1))}i[th]=s}catch(k){Xn(t,t.return,k)}}break;case 6:if(Ps(e,t),la(t),r&4){if(t.stateNode===null)throw Error(Ue(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(k){Xn(t,t.return,k)}}break;case 3:if(Ps(e,t),la(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Qd(e.containerInfo)}catch(k){Xn(t,t.return,k)}break;case 4:Ps(e,t),la(t);break;case 13:Ps(e,t),la(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(V1=sr())),r&4&&Fx(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(ri=(u=ri)||f,Ps(e,t),ri=u):Ps(e,t),la(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(Ge=t,f=t.child;f!==null;){for(v=Ge=f;Ge!==null;){switch(g=Ge,p=g.child,g.tag){case 0:case 11:case 14:case 15:Dd(4,g,g.return);break;case 1:Qc(g,g.return);var S=g.stateNode;if(typeof S.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,S.props=e.memoizedProps,S.state=e.memoizedState,S.componentWillUnmount()}catch(k){Xn(r,n,k)}}break;case 5:Qc(g,g.return);break;case 22:if(g.memoizedState!==null){Vx(v);continue}}p!==null?(p.return=g,Ge=p):Vx(v)}f=f.sibling}e:for(f=null,v=t;;){if(v.tag===5){if(f===null){f=v;try{i=v.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=v.stateNode,c=v.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=tN("display",o))}catch(k){Xn(t,t.return,k)}}}else if(v.tag===6){if(f===null)try{v.stateNode.nodeValue=u?"":v.memoizedProps}catch(k){Xn(t,t.return,k)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===t)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;f===v&&(f=null),v=v.return}f===v&&(f=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:Ps(e,t),la(t),r&4&&Fx(t);break;case 21:break;default:Ps(e,t),la(t)}}function la(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(k_(n)){var r=n;break e}n=n.return}throw Error(Ue(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Wd(i,""),r.flags&=-33);var s=Mx(t);pv(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Mx(t);mv(t,l,o);break;default:throw Error(Ue(161))}}catch(c){Xn(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function tT(t,e,n){Ge=t,C_(t)}function C_(t,e,n){for(var r=(t.mode&1)!==0;Ge!==null;){var i=Ge,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||wf;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||ri;l=wf;var u=ri;if(wf=o,(ri=c)&&!u)for(Ge=i;Ge!==null;)o=Ge,c=o.child,o.tag===22&&o.memoizedState!==null?Bx(i):c!==null?(c.return=o,Ge=c):Bx(i);for(;s!==null;)Ge=s,C_(s),s=s.sibling;Ge=i,wf=l,ri=u}Ux(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Ge=s):Ux(t)}}function Ux(t){for(;Ge!==null;){var e=Ge;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ri||Np(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ri)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Ls(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&_x(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}_x(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var v=f.dehydrated;v!==null&&Qd(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ue(163))}ri||e.flags&512&&fv(e)}catch(g){Xn(e,e.return,g)}}if(e===t){Ge=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ge=n;break}Ge=e.return}}function Vx(t){for(;Ge!==null;){var e=Ge;if(e===t){Ge=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ge=n;break}Ge=e.return}}function Bx(t){for(;Ge!==null;){var e=Ge;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Np(4,e)}catch(c){Xn(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Xn(e,i,c)}}var s=e.return;try{fv(e)}catch(c){Xn(e,s,c)}break;case 5:var o=e.return;try{fv(e)}catch(c){Xn(e,o,c)}}}catch(c){Xn(e,e.return,c)}if(e===t){Ge=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Ge=l;break}Ge=e.return}}var nT=Math.ceil,Pm=fo.ReactCurrentDispatcher,F1=fo.ReactCurrentOwner,ms=fo.ReactCurrentBatchConfig,Zt=0,Ir=null,mr=null,Vr=0,Gi=0,Xc=Nl(0),_r=0,oh=null,cc=0,_p=0,U1=0,Od=null,Ei=null,V1=0,wu=1/0,Ha=null,Rm=!1,gv=null,sl=null,Nf=!1,Xo=null,Lm=0,Md=0,vv=null,Kf=-1,Yf=0;function pi(){return Zt&6?sr():Kf!==-1?Kf:Kf=sr()}function al(t){return t.mode&1?Zt&2&&Vr!==0?Vr&-Vr:Uk.transition!==null?(Yf===0&&(Yf=mN()),Yf):(t=fn,t!==0||(t=window.event,t=t===void 0?16:wN(t.type)),t):1}function Us(t,e,n,r){if(50<Md)throw Md=0,vv=null,Error(Ue(185));wh(t,n,r),(!(Zt&2)||t!==Ir)&&(t===Ir&&(!(Zt&2)&&(_p|=n),_r===4&&Ho(t,Vr)),ji(t,r),n===1&&Zt===0&&!(e.mode&1)&&(wu=sr()+500,xp&&_l()))}function ji(t,e){var n=t.callbackNode;U3(t,e);var r=vm(t,t===Ir?Vr:0);if(r===0)n!==null&&Q2(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Q2(n),e===1)t.tag===0?Fk($x.bind(null,t)):VN($x.bind(null,t)),Lk(function(){!(Zt&6)&&_l()}),n=null;else{switch(pN(r)){case 1:n=h1;break;case 4:n=hN;break;case 16:n=gm;break;case 536870912:n=fN;break;default:n=gm}n=F_(n,I_.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function I_(t,e){if(Kf=-1,Yf=0,Zt&6)throw Error(Ue(327));var n=t.callbackNode;if(su()&&t.callbackNode!==n)return null;var r=vm(t,t===Ir?Vr:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Dm(t,r);else{e=r;var i=Zt;Zt|=2;var s=R_();(Ir!==t||Vr!==e)&&(Ha=null,wu=sr()+500,tc(t,e));do try{sT();break}catch(l){P_(t,l)}while(!0);A1(),Pm.current=s,Zt=i,mr!==null?e=0:(Ir=null,Vr=0,e=_r)}if(e!==0){if(e===2&&(i=q0(t),i!==0&&(r=i,e=yv(t,i))),e===1)throw n=oh,tc(t,0),Ho(t,r),ji(t,sr()),n;if(e===6)Ho(t,r);else{if(i=t.current.alternate,!(r&30)&&!rT(i)&&(e=Dm(t,r),e===2&&(s=q0(t),s!==0&&(r=s,e=yv(t,s))),e===1))throw n=oh,tc(t,0),Ho(t,r),ji(t,sr()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Ue(345));case 2:Wl(t,Ei,Ha);break;case 3:if(Ho(t,r),(r&130023424)===r&&(e=V1+500-sr(),10<e)){if(vm(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){pi(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=J0(Wl.bind(null,t,Ei,Ha),e);break}Wl(t,Ei,Ha);break;case 4:if(Ho(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Fs(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=sr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*nT(r/1960))-r,10<r){t.timeoutHandle=J0(Wl.bind(null,t,Ei,Ha),r);break}Wl(t,Ei,Ha);break;case 5:Wl(t,Ei,Ha);break;default:throw Error(Ue(329))}}}return ji(t,sr()),t.callbackNode===n?I_.bind(null,t):null}function yv(t,e){var n=Od;return t.current.memoizedState.isDehydrated&&(tc(t,e).flags|=256),t=Dm(t,e),t!==2&&(e=Ei,Ei=n,e!==null&&xv(e)),t}function xv(t){Ei===null?Ei=t:Ei.push.apply(Ei,t)}function rT(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Vs(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ho(t,e){for(e&=~U1,e&=~_p,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Fs(e),r=1<<n;t[n]=-1,e&=~r}}function $x(t){if(Zt&6)throw Error(Ue(327));su();var e=vm(t,0);if(!(e&1))return ji(t,sr()),null;var n=Dm(t,e);if(t.tag!==0&&n===2){var r=q0(t);r!==0&&(e=r,n=yv(t,r))}if(n===1)throw n=oh,tc(t,0),Ho(t,e),ji(t,sr()),n;if(n===6)throw Error(Ue(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Wl(t,Ei,Ha),ji(t,sr()),null}function B1(t,e){var n=Zt;Zt|=1;try{return t(e)}finally{Zt=n,Zt===0&&(wu=sr()+500,xp&&_l())}}function uc(t){Xo!==null&&Xo.tag===0&&!(Zt&6)&&su();var e=Zt;Zt|=1;var n=ms.transition,r=fn;try{if(ms.transition=null,fn=1,t)return t()}finally{fn=r,ms.transition=n,Zt=e,!(Zt&6)&&_l()}}function $1(){Gi=Xc.current,Pn(Xc)}function tc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Rk(n)),mr!==null)for(n=mr.return;n!==null;){var r=n;switch(N1(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Nm();break;case 3:xu(),Pn(ki),Pn(ai),I1();break;case 5:C1(r);break;case 4:xu();break;case 13:Pn($n);break;case 19:Pn($n);break;case 10:S1(r.type._context);break;case 22:case 23:$1()}n=n.return}if(Ir=t,mr=t=ol(t.current,null),Vr=Gi=e,_r=0,oh=null,U1=_p=cc=0,Ei=Od=null,Jl!==null){for(e=0;e<Jl.length;e++)if(n=Jl[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Jl=null}return t}function P_(t,e){do{var n=mr;try{if(A1(),Hf.current=Im,Cm){for(var r=zn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Cm=!1}if(lc=0,jr=wr=zn=null,Ld=!1,ih=0,F1.current=null,n===null||n.return===null){_r=1,oh=e,mr=null;break}e:{var s=t,o=n.return,l=n,c=e;if(e=Vr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=l,v=f.tag;if(!(f.mode&1)&&(v===0||v===11||v===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=jx(o);if(p!==null){p.flags&=-257,Cx(p,o,l,s,e),p.mode&1&&Tx(s,u,e),e=p,c=u;var S=e.updateQueue;if(S===null){var k=new Set;k.add(c),e.updateQueue=k}else S.add(c);break e}else{if(!(e&1)){Tx(s,u,e),z1();break e}c=Error(Ue(426))}}else if(Mn&&l.mode&1){var C=jx(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),Cx(C,o,l,s,e),_1(bu(c,l));break e}}s=c=bu(c,l),_r!==4&&(_r=2),Od===null?Od=[s]:Od.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var b=p_(s,c,e);Nx(s,b);break e;case 1:l=c;var I=s.type,R=s.stateNode;if(!(s.flags&128)&&(typeof I.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(sl===null||!sl.has(R)))){s.flags|=65536,e&=-e,s.lanes|=e;var D=g_(s,l,e);Nx(s,D);break e}}s=s.return}while(s!==null)}D_(n)}catch(ee){e=ee,mr===n&&n!==null&&(mr=n=n.return);continue}break}while(!0)}function R_(){var t=Pm.current;return Pm.current=Im,t===null?Im:t}function z1(){(_r===0||_r===3||_r===2)&&(_r=4),Ir===null||!(cc&268435455)&&!(_p&268435455)||Ho(Ir,Vr)}function Dm(t,e){var n=Zt;Zt|=2;var r=R_();(Ir!==t||Vr!==e)&&(Ha=null,tc(t,e));do try{iT();break}catch(i){P_(t,i)}while(!0);if(A1(),Zt=n,Pm.current=r,mr!==null)throw Error(Ue(261));return Ir=null,Vr=0,_r}function iT(){for(;mr!==null;)L_(mr)}function sT(){for(;mr!==null&&!C3();)L_(mr)}function L_(t){var e=M_(t.alternate,t,Gi);t.memoizedProps=t.pendingProps,e===null?D_(t):mr=e,F1.current=null}function D_(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Jk(n,e),n!==null){n.flags&=32767,mr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{_r=6,mr=null;return}}else if(n=Xk(n,e,Gi),n!==null){mr=n;return}if(e=e.sibling,e!==null){mr=e;return}mr=e=t}while(e!==null);_r===0&&(_r=5)}function Wl(t,e,n){var r=fn,i=ms.transition;try{ms.transition=null,fn=1,aT(t,e,n,r)}finally{ms.transition=i,fn=r}return null}function aT(t,e,n,r){do su();while(Xo!==null);if(Zt&6)throw Error(Ue(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Ue(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(V3(t,s),t===Ir&&(mr=Ir=null,Vr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Nf||(Nf=!0,F_(gm,function(){return su(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=ms.transition,ms.transition=null;var o=fn;fn=1;var l=Zt;Zt|=4,F1.current=null,eT(t,n),j_(n,t),Sk(Q0),ym=!!Y0,Q0=Y0=null,t.current=n,tT(n),I3(),Zt=l,fn=o,ms.transition=s}else t.current=n;if(Nf&&(Nf=!1,Xo=t,Lm=i),s=t.pendingLanes,s===0&&(sl=null),L3(n.stateNode),ji(t,sr()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Rm)throw Rm=!1,t=gv,gv=null,t;return Lm&1&&t.tag!==0&&su(),s=t.pendingLanes,s&1?t===vv?Md++:(Md=0,vv=t):Md=0,_l(),null}function su(){if(Xo!==null){var t=pN(Lm),e=ms.transition,n=fn;try{if(ms.transition=null,fn=16>t?16:t,Xo===null)var r=!1;else{if(t=Xo,Xo=null,Lm=0,Zt&6)throw Error(Ue(331));var i=Zt;for(Zt|=4,Ge=t.current;Ge!==null;){var s=Ge,o=s.child;if(Ge.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Ge=u;Ge!==null;){var f=Ge;switch(f.tag){case 0:case 11:case 15:Dd(8,f,s)}var v=f.child;if(v!==null)v.return=f,Ge=v;else for(;Ge!==null;){f=Ge;var g=f.sibling,p=f.return;if(S_(f),f===u){Ge=null;break}if(g!==null){g.return=p,Ge=g;break}Ge=p}}}var S=s.alternate;if(S!==null){var k=S.child;if(k!==null){S.child=null;do{var C=k.sibling;k.sibling=null,k=C}while(k!==null)}}Ge=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Ge=o;else e:for(;Ge!==null;){if(s=Ge,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Dd(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,Ge=b;break e}Ge=s.return}}var I=t.current;for(Ge=I;Ge!==null;){o=Ge;var R=o.child;if(o.subtreeFlags&2064&&R!==null)R.return=o,Ge=R;else e:for(o=I;Ge!==null;){if(l=Ge,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Np(9,l)}}catch(ee){Xn(l,l.return,ee)}if(l===o){Ge=null;break e}var D=l.sibling;if(D!==null){D.return=l.return,Ge=D;break e}Ge=l.return}}if(Zt=i,_l(),pa&&typeof pa.onPostCommitFiberRoot=="function")try{pa.onPostCommitFiberRoot(mp,t)}catch{}r=!0}return r}finally{fn=n,ms.transition=e}}return!1}function zx(t,e,n){e=bu(n,e),e=p_(t,e,1),t=il(t,e,1),e=pi(),t!==null&&(wh(t,1,e),ji(t,e))}function Xn(t,e,n){if(t.tag===3)zx(t,t,n);else for(;e!==null;){if(e.tag===3){zx(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(sl===null||!sl.has(r))){t=bu(n,t),t=g_(e,t,1),e=il(e,t,1),t=pi(),e!==null&&(wh(e,1,t),ji(e,t));break}}e=e.return}}function oT(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=pi(),t.pingedLanes|=t.suspendedLanes&n,Ir===t&&(Vr&n)===n&&(_r===4||_r===3&&(Vr&130023424)===Vr&&500>sr()-V1?tc(t,0):U1|=n),ji(t,e)}function O_(t,e){e===0&&(t.mode&1?(e=hf,hf<<=1,!(hf&130023424)&&(hf=4194304)):e=1);var n=pi();t=io(t,e),t!==null&&(wh(t,e,n),ji(t,n))}function lT(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),O_(t,n)}function cT(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Ue(314))}r!==null&&r.delete(e),O_(t,n)}var M_;M_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ki.current)Si=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Si=!1,Qk(t,e,n);Si=!!(t.flags&131072)}else Si=!1,Mn&&e.flags&1048576&&BN(e,Am,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Gf(t,e),t=e.pendingProps;var i=gu(e,ai.current);iu(e,n),i=R1(null,e,r,t,i,n);var s=L1();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ti(r)?(s=!0,_m(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,T1(e),i.updater=wp,e.stateNode=i,i._reactInternals=e,sv(e,r,t,n),e=lv(null,e,r,!0,s,n)):(e.tag=0,Mn&&s&&w1(e),mi(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Gf(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=dT(r),t=Ls(r,t),i){case 0:e=ov(null,e,r,t,n);break e;case 1:e=Rx(null,e,r,t,n);break e;case 11:e=Ix(null,e,r,t,n);break e;case 14:e=Px(null,e,r,Ls(r.type,t),n);break e}throw Error(Ue(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ls(r,i),ov(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ls(r,i),Rx(t,e,r,i,n);case 3:e:{if(b_(e),t===null)throw Error(Ue(387));r=e.pendingProps,s=e.memoizedState,i=s.element,GN(t,e),Tm(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=bu(Error(Ue(423)),e),e=Lx(t,e,r,n,i);break e}else if(r!==i){i=bu(Error(Ue(424)),e),e=Lx(t,e,r,n,i);break e}else for(Ki=rl(e.stateNode.containerInfo.firstChild),Xi=e,Mn=!0,Os=null,n=HN(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(vu(),r===i){e=so(t,e,n);break e}mi(t,e,r,n)}e=e.child}return e;case 5:return KN(e),t===null&&nv(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,X0(r,i)?o=null:s!==null&&X0(r,s)&&(e.flags|=32),x_(t,e),mi(t,e,o,n),e.child;case 6:return t===null&&nv(e),null;case 13:return w_(t,e,n);case 4:return j1(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=yu(e,null,r,n):mi(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ls(r,i),Ix(t,e,r,i,n);case 7:return mi(t,e,e.pendingProps,n),e.child;case 8:return mi(t,e,e.pendingProps.children,n),e.child;case 12:return mi(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,En(Sm,r._currentValue),r._currentValue=o,s!==null)if(Vs(s.value,o)){if(s.children===i.children&&!ki.current){e=so(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Za(-1,n&-n),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),rv(s.return,n,e),l.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Ue(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),rv(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}mi(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,iu(e,n),i=ys(i),r=r(i),e.flags|=1,mi(t,e,r,n),e.child;case 14:return r=e.type,i=Ls(r,e.pendingProps),i=Ls(r.type,i),Px(t,e,r,i,n);case 15:return v_(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ls(r,i),Gf(t,e),e.tag=1,Ti(r)?(t=!0,_m(e)):t=!1,iu(e,n),m_(e,r,i),sv(e,r,i,n),lv(null,e,r,!0,t,n);case 19:return N_(t,e,n);case 22:return y_(t,e,n)}throw Error(Ue(156,e.tag))};function F_(t,e){return dN(t,e)}function uT(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fs(t,e,n,r){return new uT(t,e,n,r)}function q1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function dT(t){if(typeof t=="function")return q1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===c1)return 11;if(t===u1)return 14}return 2}function ol(t,e){var n=t.alternate;return n===null?(n=fs(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Qf(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")q1(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Bc:return nc(n.children,i,s,e);case l1:o=8,i|=8;break;case j0:return t=fs(12,n,e,i|2),t.elementType=j0,t.lanes=s,t;case C0:return t=fs(13,n,e,i),t.elementType=C0,t.lanes=s,t;case I0:return t=fs(19,n,e,i),t.elementType=I0,t.lanes=s,t;case K5:return Ep(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case W5:o=10;break e;case G5:o=9;break e;case c1:o=11;break e;case u1:o=14;break e;case $o:o=16,r=null;break e}throw Error(Ue(130,t==null?t:typeof t,""))}return e=fs(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function nc(t,e,n,r){return t=fs(7,t,r,e),t.lanes=n,t}function Ep(t,e,n,r){return t=fs(22,t,r,e),t.elementType=K5,t.lanes=n,t.stateNode={isHidden:!1},t}function zg(t,e,n){return t=fs(6,t,null,e),t.lanes=n,t}function qg(t,e,n){return e=fs(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function hT(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Eg(0),this.expirationTimes=Eg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Eg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function H1(t,e,n,r,i,s,o,l,c){return t=new hT(t,e,n,l,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=fs(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},T1(s),t}function fT(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function U_(t){if(!t)return fl;t=t._reactInternals;e:{if(xc(t)!==t||t.tag!==1)throw Error(Ue(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ti(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ue(171))}if(t.tag===1){var n=t.type;if(Ti(n))return UN(t,n,e)}return e}function V_(t,e,n,r,i,s,o,l,c){return t=H1(n,r,!0,t,i,s,o,l,c),t.context=U_(null),n=t.current,r=pi(),i=al(n),s=Za(r,i),s.callback=e??null,il(n,s,i),t.current.lanes=i,wh(t,i,r),ji(t,r),t}function Ap(t,e,n,r){var i=e.current,s=pi(),o=al(i);return n=U_(n),e.context===null?e.context=n:e.pendingContext=n,e=Za(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=il(i,e,o),t!==null&&(Us(t,i,o,s),qf(t,i,o)),o}function Om(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function qx(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function W1(t,e){qx(t,e),(t=t.alternate)&&qx(t,e)}function mT(){return null}var B_=typeof reportError=="function"?reportError:function(t){console.error(t)};function G1(t){this._internalRoot=t}Sp.prototype.render=G1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Ue(409));Ap(t,e,null,null)};Sp.prototype.unmount=G1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;uc(function(){Ap(null,t,null,null)}),e[ro]=null}};function Sp(t){this._internalRoot=t}Sp.prototype.unstable_scheduleHydration=function(t){if(t){var e=yN();t={blockedOn:null,target:t,priority:e};for(var n=0;n<qo.length&&e!==0&&e<qo[n].priority;n++);qo.splice(n,0,t),n===0&&bN(t)}};function K1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function kp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Hx(){}function pT(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Om(o);s.call(u)}}var o=V_(e,r,t,0,null,!1,!1,"",Hx);return t._reactRootContainer=o,t[ro]=o.current,Zd(t.nodeType===8?t.parentNode:t),uc(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=Om(c);l.call(u)}}var c=H1(t,0,!1,null,null,!1,!1,"",Hx);return t._reactRootContainer=c,t[ro]=c.current,Zd(t.nodeType===8?t.parentNode:t),uc(function(){Ap(e,c,n,r)}),c}function Tp(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=Om(o);l.call(c)}}Ap(e,o,t,i)}else o=pT(n,e,t,i,r);return Om(o)}gN=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=wd(e.pendingLanes);n!==0&&(f1(e,n|1),ji(e,sr()),!(Zt&6)&&(wu=sr()+500,_l()))}break;case 13:uc(function(){var r=io(t,1);if(r!==null){var i=pi();Us(r,t,1,i)}}),W1(t,1)}};m1=function(t){if(t.tag===13){var e=io(t,134217728);if(e!==null){var n=pi();Us(e,t,134217728,n)}W1(t,134217728)}};vN=function(t){if(t.tag===13){var e=al(t),n=io(t,e);if(n!==null){var r=pi();Us(n,t,e,r)}W1(t,e)}};yN=function(){return fn};xN=function(t,e){var n=fn;try{return fn=t,e()}finally{fn=n}};B0=function(t,e,n){switch(e){case"input":if(L0(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=yp(r);if(!i)throw Error(Ue(90));Q5(r),L0(r,i)}}}break;case"textarea":J5(t,n);break;case"select":e=n.value,e!=null&&eu(t,!!n.multiple,e,!1)}};sN=B1;aN=uc;var gT={usingClientEntryPoint:!1,Events:[_h,Hc,yp,rN,iN,B1]},pd={findFiberByHostInstance:Xl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vT={bundleType:pd.bundleType,version:pd.version,rendererPackageName:pd.rendererPackageName,rendererConfig:pd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=cN(t),t===null?null:t.stateNode},findFiberByHostInstance:pd.findFiberByHostInstance||mT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _f=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_f.isDisabled&&_f.supportsFiber)try{mp=_f.inject(vT),pa=_f}catch{}}es.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gT;es.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!K1(e))throw Error(Ue(200));return fT(t,e,null,n)};es.createRoot=function(t,e){if(!K1(t))throw Error(Ue(299));var n=!1,r="",i=B_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=H1(t,1,!1,null,null,n,!1,r,i),t[ro]=e.current,Zd(t.nodeType===8?t.parentNode:t),new G1(e)};es.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Ue(188)):(t=Object.keys(t).join(","),Error(Ue(268,t)));return t=cN(e),t=t===null?null:t.stateNode,t};es.flushSync=function(t){return uc(t)};es.hydrate=function(t,e,n){if(!kp(e))throw Error(Ue(200));return Tp(null,t,e,!0,n)};es.hydrateRoot=function(t,e,n){if(!K1(t))throw Error(Ue(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=B_;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=V_(e,null,t,1,n??null,i,!1,s,o),t[ro]=e.current,Zd(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Sp(e)};es.render=function(t,e,n){if(!kp(e))throw Error(Ue(200));return Tp(null,t,e,!1,n)};es.unmountComponentAtNode=function(t){if(!kp(t))throw Error(Ue(40));return t._reactRootContainer?(uc(function(){Tp(null,null,t,!1,function(){t._reactRootContainer=null,t[ro]=null})}),!0):!1};es.unstable_batchedUpdates=B1;es.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!kp(n))throw Error(Ue(200));if(t==null||t._reactInternals===void 0)throw Error(Ue(38));return Tp(t,e,n,!1,r)};es.version="18.3.1-next-f1338f8080-20240426";function $_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($_)}catch(t){console.error(t)}}$_(),$5.exports=es;var yT=$5.exports,Wx=yT;k0.createRoot=Wx.createRoot,k0.hydrateRoot=Wx.hydrateRoot;var Gx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z_=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},xT=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],l=t[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},q_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,l=o?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,f=s>>2,v=(s&3)<<4|l>>4;let g=(l&15)<<2|u>>6,p=u&63;c||(p=64,o||(g=64)),r.push(n[f],n[v],n[g],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(z_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):xT(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const v=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||l==null||u==null||v==null)throw new bT;const g=s<<2|l>>4;if(r.push(g),u!==64){const p=l<<4&240|u>>2;if(r.push(p),v!==64){const S=u<<6&192|v;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class bT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wT=function(t){const e=z_(t);return q_.encodeByteArray(e,!0)},Mm=function(t){return wT(t).replace(/\./g,"")},H_=function(t){try{return q_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _T=()=>NT().__FIREBASE_DEFAULTS__,ET=()=>{if(typeof process>"u"||typeof Gx>"u")return;const t=Gx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},AT=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&H_(t[1]);return e&&JSON.parse(e)},jp=()=>{try{return _T()||ET()||AT()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},W_=t=>{var e,n;return(n=(e=jp())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Y1=t=>{const e=W_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},G_=()=>{var t;return(t=jp())===null||t===void 0?void 0:t.config},K_=t=>{var e;return(e=jp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ST{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y_(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Mm(JSON.stringify(n)),Mm(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function kT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(oi())}function TT(){var t;const e=(t=jp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function jT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function CT(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function IT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function PT(){const t=oi();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function RT(){return!TT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function LT(){try{return typeof indexedDB=="object"}catch{return!1}}function DT(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OT="FirebaseError";class Ea extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=OT,Object.setPrototypeOf(this,Ea.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ah.prototype.create)}}class Ah{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?MT(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Ea(i,l,r)}}function MT(t,e){return t.replace(FT,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const FT=/\{\$([^}]+)}/g;function UT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Fm(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(Kx(s)&&Kx(o)){if(!Fm(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Kx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sh(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function _d(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Ed(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function VT(t,e){const n=new BT(t,e);return n.subscribe.bind(n)}class BT{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");$T(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Hg),i.error===void 0&&(i.error=Hg),i.complete===void 0&&(i.complete=Hg);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $T(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Hg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bn(t){return t&&t._delegate?t._delegate:t}class ao{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new ST;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HT(e))try{this.getOrInitializeService({instanceIdentifier:Gl})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Gl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Gl){return this.instances.has(e)}getOptions(e=Gl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:qT(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Gl){return this.component?this.component.multipleInstances?e:Gl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function qT(t){return t===Gl?void 0:t}function HT(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new zT(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Wt||(Wt={}));const GT={debug:Wt.DEBUG,verbose:Wt.VERBOSE,info:Wt.INFO,warn:Wt.WARN,error:Wt.ERROR,silent:Wt.SILENT},KT=Wt.INFO,YT={[Wt.DEBUG]:"log",[Wt.VERBOSE]:"log",[Wt.INFO]:"info",[Wt.WARN]:"warn",[Wt.ERROR]:"error"},QT=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=YT[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Q1{constructor(e){this.name=e,this._logLevel=KT,this._logHandler=QT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Wt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Wt.DEBUG,...e),this._logHandler(this,Wt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Wt.VERBOSE,...e),this._logHandler(this,Wt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Wt.INFO,...e),this._logHandler(this,Wt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Wt.WARN,...e),this._logHandler(this,Wt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Wt.ERROR,...e),this._logHandler(this,Wt.ERROR,...e)}}const XT=(t,e)=>e.some(n=>t instanceof n);let Yx,Qx;function JT(){return Yx||(Yx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ZT(){return Qx||(Qx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Q_=new WeakMap,bv=new WeakMap,X_=new WeakMap,Wg=new WeakMap,X1=new WeakMap;function ej(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(ll(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Q_.set(n,t)}).catch(()=>{}),X1.set(e,t),e}function tj(t){if(bv.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});bv.set(t,e)}let wv={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return bv.get(t);if(e==="objectStoreNames")return t.objectStoreNames||X_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ll(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function nj(t){wv=t(wv)}function rj(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Gg(this),e,...n);return X_.set(r,e.sort?e.sort():[e]),ll(r)}:ZT().includes(t)?function(...e){return t.apply(Gg(this),e),ll(Q_.get(this))}:function(...e){return ll(t.apply(Gg(this),e))}}function ij(t){return typeof t=="function"?rj(t):(t instanceof IDBTransaction&&tj(t),XT(t,JT())?new Proxy(t,wv):t)}function ll(t){if(t instanceof IDBRequest)return ej(t);if(Wg.has(t))return Wg.get(t);const e=ij(t);return e!==t&&(Wg.set(t,e),X1.set(e,t)),e}const Gg=t=>X1.get(t);function sj(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),l=ll(o);return r&&o.addEventListener("upgradeneeded",c=>{r(ll(o.result),c.oldVersion,c.newVersion,ll(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const aj=["get","getKey","getAll","getAllKeys","count"],oj=["put","add","delete","clear"],Kg=new Map;function Xx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Kg.get(e))return Kg.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=oj.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||aj.includes(n)))return;const s=async function(o,...l){const c=this.transaction(o,i?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),i&&c.done]))[0]};return Kg.set(e,s),s}nj(t=>({...t,get:(e,n,r)=>Xx(e,n)||t.get(e,n,r),has:(e,n)=>!!Xx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lj{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(cj(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function cj(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Nv="@firebase/app",Jx="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oo=new Q1("@firebase/app"),uj="@firebase/app-compat",dj="@firebase/analytics-compat",hj="@firebase/analytics",fj="@firebase/app-check-compat",mj="@firebase/app-check",pj="@firebase/auth",gj="@firebase/auth-compat",vj="@firebase/database",yj="@firebase/data-connect",xj="@firebase/database-compat",bj="@firebase/functions",wj="@firebase/functions-compat",Nj="@firebase/installations",_j="@firebase/installations-compat",Ej="@firebase/messaging",Aj="@firebase/messaging-compat",Sj="@firebase/performance",kj="@firebase/performance-compat",Tj="@firebase/remote-config",jj="@firebase/remote-config-compat",Cj="@firebase/storage",Ij="@firebase/storage-compat",Pj="@firebase/firestore",Rj="@firebase/vertexai-preview",Lj="@firebase/firestore-compat",Dj="firebase",Oj="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _v="[DEFAULT]",Mj={[Nv]:"fire-core",[uj]:"fire-core-compat",[hj]:"fire-analytics",[dj]:"fire-analytics-compat",[mj]:"fire-app-check",[fj]:"fire-app-check-compat",[pj]:"fire-auth",[gj]:"fire-auth-compat",[vj]:"fire-rtdb",[yj]:"fire-data-connect",[xj]:"fire-rtdb-compat",[bj]:"fire-fn",[wj]:"fire-fn-compat",[Nj]:"fire-iid",[_j]:"fire-iid-compat",[Ej]:"fire-fcm",[Aj]:"fire-fcm-compat",[Sj]:"fire-perf",[kj]:"fire-perf-compat",[Tj]:"fire-rc",[jj]:"fire-rc-compat",[Cj]:"fire-gcs",[Ij]:"fire-gcs-compat",[Pj]:"fire-fst",[Lj]:"fire-fst-compat",[Rj]:"fire-vertex","fire-js":"fire-js",[Dj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Um=new Map,Fj=new Map,Ev=new Map;function Zx(t,e){try{t.container.addComponent(e)}catch(n){oo.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ml(t){const e=t.name;if(Ev.has(e))return oo.debug(`There were multiple attempts to register component ${e}.`),!1;Ev.set(e,t);for(const n of Um.values())Zx(n,t);for(const n of Fj.values())Zx(n,t);return!0}function kh(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function fa(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},cl=new Ah("app","Firebase",Uj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vj{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ao("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cl.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bc=Oj;function J_(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:_v,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw cl.create("bad-app-name",{appName:String(i)});if(n||(n=G_()),!n)throw cl.create("no-options");const s=Um.get(i);if(s){if(Fm(n,s.options)&&Fm(r,s.config))return s;throw cl.create("duplicate-app",{appName:i})}const o=new WT(i);for(const c of Ev.values())o.addComponent(c);const l=new Vj(n,r,o);return Um.set(i,l),l}function Cp(t=_v){const e=Um.get(t);if(!e&&t===_v&&G_())return J_();if(!e)throw cl.create("no-app",{appName:t});return e}function ps(t,e,n){var r;let i=(r=Mj[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),oo.warn(l.join(" "));return}ml(new ao(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bj="firebase-heartbeat-database",$j=1,lh="firebase-heartbeat-store";let Yg=null;function Z_(){return Yg||(Yg=sj(Bj,$j,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(lh)}catch(n){console.warn(n)}}}}).catch(t=>{throw cl.create("idb-open",{originalErrorMessage:t.message})})),Yg}async function zj(t){try{const n=(await Z_()).transaction(lh),r=await n.objectStore(lh).get(e4(t));return await n.done,r}catch(e){if(e instanceof Ea)oo.warn(e.message);else{const n=cl.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});oo.warn(n.message)}}}async function eb(t,e){try{const r=(await Z_()).transaction(lh,"readwrite");await r.objectStore(lh).put(e,e4(t)),await r.done}catch(n){if(n instanceof Ea)oo.warn(n.message);else{const r=cl.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});oo.warn(r.message)}}}function e4(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qj=1024,Hj=30*24*60*60*1e3;class Wj{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Kj(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=tb();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=Hj}),this._storage.overwrite(this._heartbeatsCache))}catch(r){oo.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=tb(),{heartbeatsToSend:r,unsentEntries:i}=Gj(this._heartbeatsCache.heartbeats),s=Mm(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return oo.warn(n),""}}}function tb(){return new Date().toISOString().substring(0,10)}function Gj(t,e=qj){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),nb(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),nb(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Kj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return LT()?DT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await zj(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return eb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return eb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function nb(t){return Mm(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(t){ml(new ao("platform-logger",e=>new lj(e),"PRIVATE")),ml(new ao("heartbeat",e=>new Wj(e),"PRIVATE")),ps(Nv,Jx,t),ps(Nv,Jx,"esm2017"),ps("fire-js","")}Yj("");function J1(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function t4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Qj=t4,n4=new Ah("auth","Firebase",t4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm=new Q1("@firebase/auth");function Xj(t,...e){Vm.logLevel<=Wt.WARN&&Vm.warn(`Auth (${bc}): ${t}`,...e)}function Xf(t,...e){Vm.logLevel<=Wt.ERROR&&Vm.error(`Auth (${bc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bs(t,...e){throw Z1(t,...e)}function va(t,...e){return Z1(t,...e)}function r4(t,e,n){const r=Object.assign(Object.assign({},Qj()),{[e]:n});return new Ah("auth","Firebase",r).create(e,{appName:t.name})}function eo(t){return r4(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Z1(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return n4.create(t,...e)}function ht(t,e,...n){if(!t)throw Z1(e,...n)}function Qa(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Xf(e),new Error(e)}function lo(t,e){t||Qa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Av(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Jj(){return rb()==="http:"||rb()==="https:"}function rb(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Jj()||CT()||"connection"in navigator)?navigator.onLine:!0}function eC(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(e,n){this.shortDelay=e,this.longDelay=n,lo(n>e,"Short delay should be less than long delay!"),this.isMobile=kT()||IT()}get(){return Zj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ey(t,e){lo(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i4{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Qa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Qa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Qa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nC=new Th(3e4,6e4);function Aa(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function zs(t,e,n,r,i={}){return s4(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const l=Sh(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},s);return jT()||(u.referrerPolicy="no-referrer"),i4.fetch()(a4(t,t.config.apiHost,n,l),u)})}async function s4(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},tC),e);try{const i=new iC(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Ef(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ef(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Ef(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Ef(t,"user-disabled",o);const f=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw r4(t,f,u);bs(t,f)}}catch(i){if(i instanceof Ea)throw i;bs(t,"network-request-failed",{message:String(i)})}}async function jh(t,e,n,r,i={}){const s=await zs(t,e,n,r,i);return"mfaPendingCredential"in s&&bs(t,"multi-factor-auth-required",{_serverResponse:s}),s}function a4(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?ey(t.config,i):`${t.config.apiScheme}://${i}`}function rC(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class iC{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(va(this.auth,"network-request-failed")),nC.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ef(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=va(t,e,r);return i.customData._tokenResponse=n,i}function ib(t){return t!==void 0&&t.enterprise!==void 0}class sC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return rC(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function aC(t,e){return zs(t,"GET","/v2/recaptchaConfig",Aa(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oC(t,e){return zs(t,"POST","/v1/accounts:delete",e)}async function o4(t,e){return zs(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fd(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function lC(t,e=!1){const n=bn(t),r=await n.getIdToken(e),i=ty(r);ht(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Fd(Qg(i.auth_time)),issuedAtTime:Fd(Qg(i.iat)),expirationTime:Fd(Qg(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Qg(t){return Number(t)*1e3}function ty(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Xf("JWT malformed, contained fewer than 3 sections"),null;try{const i=H_(n);return i?JSON.parse(i):(Xf("Failed to decode base64 JWT payload"),null)}catch(i){return Xf("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function sb(t){const e=ty(t);return ht(e,"internal-error"),ht(typeof e.exp<"u","internal-error"),ht(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ea&&cC(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function cC({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Fd(this.lastLoginAt),this.creationTime=Fd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bm(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Nu(t,o4(n,{idToken:r}));ht(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?l4(s.providerUserInfo):[],l=hC(t.providerData,o),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),f=c?u:!1,v={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new Sv(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,v)}async function dC(t){const e=bn(t);await Bm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function hC(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function l4(t){return t.map(e=>{var{providerId:n}=e,r=J1(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fC(t,e){const n=await s4(t,{},async()=>{const r=Sh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=a4(t,i,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",i4.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function mC(t,e){return zs(t,"POST","/v2/accounts:revokeToken",Aa(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ht(e.idToken,"internal-error"),ht(typeof e.idToken<"u","internal-error"),ht(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):sb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ht(e.length!==0,"internal-error");const n=sb(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ht(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await fC(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new au;return r&&(ht(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(ht(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(ht(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new au,this.toJSON())}_performRefresh(){return Qa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uo(t,e){ht(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Xa{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=J1(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new uC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Sv(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Nu(this,this.stsTokenManager.getToken(this.auth,e));return ht(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return lC(this,e)}reload(){return dC(this)}_assign(e){this!==e&&(ht(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Xa(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ht(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Bm(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(fa(this.auth.app))return Promise.reject(eo(this.auth));const e=await this.getIdToken();return await Nu(this,oC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,l,c,u,f;const v=(r=n.displayName)!==null&&r!==void 0?r:void 0,g=(i=n.email)!==null&&i!==void 0?i:void 0,p=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,S=(o=n.photoURL)!==null&&o!==void 0?o:void 0,k=(l=n.tenantId)!==null&&l!==void 0?l:void 0,C=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,b=(u=n.createdAt)!==null&&u!==void 0?u:void 0,I=(f=n.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:R,emailVerified:D,isAnonymous:ee,providerData:oe,stsTokenManager:V}=n;ht(R&&V,e,"internal-error");const T=au.fromJSON(this.name,V);ht(typeof R=="string",e,"internal-error"),Uo(v,e.name),Uo(g,e.name),ht(typeof D=="boolean",e,"internal-error"),ht(typeof ee=="boolean",e,"internal-error"),Uo(p,e.name),Uo(S,e.name),Uo(k,e.name),Uo(C,e.name),Uo(b,e.name),Uo(I,e.name);const N=new Xa({uid:R,auth:e,email:g,emailVerified:D,displayName:v,isAnonymous:ee,photoURL:S,phoneNumber:p,tenantId:k,stsTokenManager:T,createdAt:b,lastLoginAt:I});return oe&&Array.isArray(oe)&&(N.providerData=oe.map(U=>Object.assign({},U))),C&&(N._redirectEventId=C),N}static async _fromIdTokenResponse(e,n,r=!1){const i=new au;i.updateFromServerResponse(n);const s=new Xa({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Bm(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];ht(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?l4(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new au;l.updateFromIdToken(r);const c=new Xa({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Sv(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ab=new Map;function Ja(t){lo(t instanceof Function,"Expected a class definition");let e=ab.get(t);return e?(lo(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,ab.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}c4.type="NONE";const ob=c4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jf(t,e,n){return`firebase:${t}:${e}:${n}`}class ou{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Jf(this.userKey,i.apiKey,s),this.fullPersistenceKey=Jf("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Xa._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ou(Ja(ob),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Ja(ob);const o=Jf(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const f=await u._get(o);if(f){const v=Xa._fromJSON(e,f);u!==s&&(l=v),s=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new ou(s,e,r):(s=c[0],l&&await s._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new ou(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lb(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(f4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(u4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(p4(e))return"Blackberry";if(g4(e))return"Webos";if(d4(e))return"Safari";if((e.includes("chrome/")||h4(e))&&!e.includes("edge/"))return"Chrome";if(m4(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function u4(t=oi()){return/firefox\//i.test(t)}function d4(t=oi()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function h4(t=oi()){return/crios\//i.test(t)}function f4(t=oi()){return/iemobile/i.test(t)}function m4(t=oi()){return/android/i.test(t)}function p4(t=oi()){return/blackberry/i.test(t)}function g4(t=oi()){return/webos/i.test(t)}function ny(t=oi()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function pC(t=oi()){var e;return ny(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function gC(){return PT()&&document.documentMode===10}function v4(t=oi()){return ny(t)||m4(t)||g4(t)||p4(t)||/windows phone/i.test(t)||f4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y4(t,e=[]){let n;switch(t){case"Browser":n=lb(oi());break;case"Worker":n=`${lb(oi())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${bc}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,l)=>{try{const c=e(s);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yC(t,e={}){return zs(t,"GET","/v2/passwordPolicy",Aa(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xC=6;class bC{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:xC,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cb(this),this.idTokenSubscription=new cb(this),this.beforeStateQueue=new vC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=n4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ja(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await ou.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await o4(this,{idToken:e}),r=await Xa._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(fa(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ht(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Bm(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=eC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(fa(this.app))return Promise.reject(eo(this));const n=e?bn(e):null;return n&&ht(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ht(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return fa(this.app)?Promise.reject(eo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return fa(this.app)?Promise.reject(eo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ja(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await yC(this),n=new bC(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ah("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await mC(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ja(e)||this._popupRedirectResolver;ht(n,this,"argument-error"),this.redirectPersistenceManager=await ou.create(this,[Ja(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ht(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,i);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ht(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=y4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&Xj(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function mo(t){return bn(t)}class cb{constructor(e){this.auth=e,this.observer=null,this.addObserver=VT(n=>this.observer=n)}get next(){return ht(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ip={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function NC(t){Ip=t}function x4(t){return Ip.loadJS(t)}function _C(){return Ip.recaptchaEnterpriseScript}function EC(){return Ip.gapiScript}function AC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const SC="recaptcha-enterprise",kC="NO_RECAPTCHA";class TC{constructor(e){this.type=SC,this.auth=mo(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{aC(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new sC(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function i(s,o,l){const c=window.grecaptcha;ib(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(kC)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(l=>{if(!n&&ib(window.grecaptcha))i(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=_C();c.length!==0&&(c+=l),x4(c).then(()=>{i(l,s,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function ub(t,e,n,r=!1){const i=new TC(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function $m(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await ub(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await ub(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jC(t,e){const n=kh(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Fm(s,e??{}))return i;bs(i,"already-initialized")}return n.initialize({options:e})}function CC(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ja);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function IC(t,e,n){const r=mo(t);ht(r._canInitEmulator,r,"emulator-config-failed"),ht(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=b4(e),{host:o,port:l}=PC(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),RC()}function b4(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function PC(t){const e=b4(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:db(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:db(o)}}}function db(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function RC(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Qa("not implemented")}_getIdTokenResponse(e){return Qa("not implemented")}_linkToIdToken(e,n){return Qa("not implemented")}_getReauthenticationResolver(e){return Qa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w4(t,e){return zs(t,"POST","/v1/accounts:resetPassword",Aa(t,e))}async function LC(t,e){return zs(t,"POST","/v1/accounts:update",e)}async function DC(t,e){return zs(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OC(t,e){return jh(t,"POST","/v1/accounts:signInWithPassword",Aa(t,e))}async function N4(t,e){return zs(t,"POST","/v1/accounts:sendOobCode",Aa(t,e))}async function MC(t,e){return N4(t,e)}async function FC(t,e){return N4(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UC(t,e){return jh(t,"POST","/v1/accounts:signInWithEmailLink",Aa(t,e))}async function VC(t,e){return jh(t,"POST","/v1/accounts:signInWithEmailLink",Aa(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch extends ry{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new ch(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new ch(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return $m(e,n,"signInWithPassword",OC);case"emailLink":return UC(e,{email:this._email,oobCode:this._password});default:bs(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return $m(e,r,"signUpPassword",DC);case"emailLink":return VC(e,{idToken:n,email:this._email,oobCode:this._password});default:bs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lu(t,e){return jh(t,"POST","/v1/accounts:signInWithIdp",Aa(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC="http://localhost";class dc extends ry{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new dc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):bs("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=J1(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new dc(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return lu(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,lu(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,lu(e,n)}buildRequest(){const e={requestUri:BC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Sh(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $C(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function zC(t){const e=_d(Ed(t)).link,n=e?_d(Ed(e)).deep_link_id:null,r=_d(Ed(t)).deep_link_id;return(r?_d(Ed(r)).link:null)||r||n||e||t}class iy{constructor(e){var n,r,i,s,o,l;const c=_d(Ed(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,f=(r=c.oobCode)!==null&&r!==void 0?r:null,v=$C((i=c.mode)!==null&&i!==void 0?i:null);ht(u&&f&&v,"argument-error"),this.apiKey=u,this.operation=v,this.code=f,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=zC(e);try{return new iy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(){this.providerId=Ru.PROVIDER_ID}static credential(e,n){return ch._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=iy.parseLink(n);return ht(r,"argument-error"),ch._fromEmailAndCode(e,r.code,r.tenantId)}}Ru.PROVIDER_ID="password";Ru.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ru.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch extends _4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo extends Ch{constructor(){super("facebook.com")}static credential(e){return dc._fromParams({providerId:Wo.PROVIDER_ID,signInMethod:Wo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wo.credentialFromTaggedObject(e)}static credentialFromError(e){return Wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Wo.credential(e.oauthAccessToken)}catch{return null}}}Wo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Wo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go extends Ch{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return dc._fromParams({providerId:Go.PROVIDER_ID,signInMethod:Go.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Go.credentialFromTaggedObject(e)}static credentialFromError(e){return Go.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Go.credential(n,r)}catch{return null}}}Go.GOOGLE_SIGN_IN_METHOD="google.com";Go.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko extends Ch{constructor(){super("github.com")}static credential(e){return dc._fromParams({providerId:Ko.PROVIDER_ID,signInMethod:Ko.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ko.credentialFromTaggedObject(e)}static credentialFromError(e){return Ko.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ko.credential(e.oauthAccessToken)}catch{return null}}}Ko.GITHUB_SIGN_IN_METHOD="github.com";Ko.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo extends Ch{constructor(){super("twitter.com")}static credential(e,n){return dc._fromParams({providerId:Yo.PROVIDER_ID,signInMethod:Yo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Yo.credentialFromTaggedObject(e)}static credentialFromError(e){return Yo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Yo.credential(n,r)}catch{return null}}}Yo.TWITTER_SIGN_IN_METHOD="twitter.com";Yo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qC(t,e){return jh(t,"POST","/v1/accounts:signUp",Aa(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Xa._fromIdTokenResponse(e,r,i),o=hb(r);return new hc({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=hb(r);return new hc({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function hb(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm extends Ea{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,zm.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new zm(e,n,r,i)}}function E4(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?zm._fromErrorAndOperation(t,s,e,r):s})}async function HC(t,e,n=!1){const r=await Nu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return hc._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WC(t,e,n=!1){const{auth:r}=t;if(fa(r.app))return Promise.reject(eo(r));const i="reauthenticate";try{const s=await Nu(t,E4(r,i,e,t),n);ht(s.idToken,r,"internal-error");const o=ty(s.idToken);ht(o,r,"internal-error");const{sub:l}=o;return ht(t.uid===l,r,"user-mismatch"),hc._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&bs(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A4(t,e,n=!1){if(fa(t.app))return Promise.reject(eo(t));const r="signIn",i=await E4(t,r,e),s=await hc._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function GC(t,e){return A4(mo(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?ay._fromServerResponse(e,n):"totpInfo"in n?oy._fromServerResponse(e,n):bs(e,"internal-error")}}class ay extends sy{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new ay(n)}}class oy extends sy{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new oy(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KC(t,e,n){var r;ht(((r=n.url)===null||r===void 0?void 0:r.length)>0,t,"invalid-continue-uri"),ht(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(ht(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(ht(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ly(t){const e=mo(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function YC(t,e,n){const r=mo(t),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};n&&KC(r,i,n),await $m(r,i,"getOobCode",FC)}async function QC(t,e,n){await w4(bn(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&ly(t),r})}async function XC(t,e){const n=bn(t),r=await w4(n,{oobCode:e}),i=r.requestType;switch(ht(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ht(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ht(r.mfaInfo,n,"internal-error");default:ht(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=sy._fromServerResponse(mo(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function JC(t,e){const{data:n}=await XC(bn(t),e);return n.email}async function qm(t,e,n){if(fa(t.app))return Promise.reject(eo(t));const r=mo(t),o=await $m(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",qC).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&ly(t),c}),l=await hc._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function ZC(t,e,n){return fa(t.app)?Promise.reject(eo(t)):GC(bn(t),Ru.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&ly(t),r})}async function eI(t,e){const n=bn(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:s}=await MC(n.auth,i);s!==t.email&&await t.reload()}function tI(t,e){return nI(bn(t),null,e)}async function nI(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(s.password=n);const o=await Nu(t,LC(r,s));await t._updateTokensIfNecessary(o,!0)}function rI(t,e,n,r){return bn(t).onIdTokenChanged(e,n,r)}function iI(t,e,n){return bn(t).beforeAuthStateChanged(e,n)}function sI(t,e,n,r){return bn(t).onAuthStateChanged(e,n,r)}function Yl(t){return bn(t).signOut()}const Hm="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Hm,"1"),this.storage.removeItem(Hm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aI=1e3,oI=10;class k4 extends S4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=v4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);gC()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,oI):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},aI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}k4.type="LOCAL";const lI=k4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4 extends S4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}T4.type="SESSION";const j4=T4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cI(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Pp(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(o).map(async u=>u(n.origin,s)),c=await cI(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Pp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((l,c)=>{const u=cy("",20);i.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(v){const g=v;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(g.data.response);break;default:clearTimeout(f),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ya(){return window}function dI(t){ya().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C4(){return typeof ya().WorkerGlobalScope<"u"&&typeof ya().importScripts=="function"}async function hI(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function fI(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function mI(){return C4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4="firebaseLocalStorageDb",pI=1,Wm="firebaseLocalStorage",P4="fbase_key";class Ih{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Rp(t,e){return t.transaction([Wm],e?"readwrite":"readonly").objectStore(Wm)}function gI(){const t=indexedDB.deleteDatabase(I4);return new Ih(t).toPromise()}function kv(){const t=indexedDB.open(I4,pI);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Wm,{keyPath:P4})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Wm)?e(r):(r.close(),await gI(),e(await kv()))})})}async function fb(t,e,n){const r=Rp(t,!0).put({[P4]:e,value:n});return new Ih(r).toPromise()}async function vI(t,e){const n=Rp(t,!1).get(e),r=await new Ih(n).toPromise();return r===void 0?null:r.value}function mb(t,e){const n=Rp(t,!0).delete(e);return new Ih(n).toPromise()}const yI=800,xI=3;class R4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await kv(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>xI)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return C4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Pp._getInstance(mI()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await hI(),!this.activeServiceWorker)return;this.sender=new uI(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||fI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await kv();return await fb(e,Hm,"1"),await mb(e,Hm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>fb(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>vI(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>mb(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Rp(i,!1).getAll();return new Ih(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),yI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}R4.type="LOCAL";const bI=R4;new Th(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wI(t,e){return e?Ja(e):(ht(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy extends ry{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return lu(e,this._buildIdpRequest())}_linkToIdToken(e,n){return lu(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return lu(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function NI(t){return A4(t.auth,new uy(t),t.bypassAuthState)}function _I(t){const{auth:e,user:n}=t;return ht(n,e,"internal-error"),WC(n,new uy(t),t.bypassAuthState)}async function EI(t){const{auth:e,user:n}=t;return ht(n,e,"internal-error"),HC(n,new uy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return NI;case"linkViaPopup":case"linkViaRedirect":return EI;case"reauthViaPopup":case"reauthViaRedirect":return _I;default:bs(this.auth,"internal-error")}}resolve(e){lo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){lo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI=new Th(2e3,1e4);class Jc extends L4{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Jc.currentPopupAction&&Jc.currentPopupAction.cancel(),Jc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ht(e,this.auth,"internal-error"),e}async onExecution(){lo(this.filter.length===1,"Popup operations only handle one event");const e=cy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(va(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(va(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Jc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(va(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,AI.get())};e()}}Jc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SI="pendingRedirect",Zf=new Map;class kI extends L4{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Zf.get(this.auth._key());if(!e){try{const r=await TI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Zf.set(this.auth._key(),e)}return this.bypassAuthState||Zf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function TI(t,e){const n=II(e),r=CI(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function jI(t,e){Zf.set(t._key(),e)}function CI(t){return Ja(t._redirectPersistence)}function II(t){return Jf(SI,t.config.apiKey,t.name)}async function PI(t,e,n=!1){if(fa(t.app))return Promise.reject(eo(t));const r=mo(t),i=wI(r,e),o=await new kI(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI=10*60*1e3;class LI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!DI(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!D4(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(va(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=RI&&this.cachedEventUids.clear(),this.cachedEventUids.has(pb(e))}saveEventToCache(e){this.cachedEventUids.add(pb(e)),this.lastProcessedEventTime=Date.now()}}function pb(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function D4({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function DI(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return D4(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OI(t,e={}){return zs(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,FI=/^https?/;async function UI(t){if(t.config.emulator)return;const{authorizedDomains:e}=await OI(t);for(const n of e)try{if(VI(n))return}catch{}bs(t,"unauthorized-domain")}function VI(t){const e=Av(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!FI.test(n))return!1;if(MI.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI=new Th(3e4,6e4);function gb(){const t=ya().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function $I(t){return new Promise((e,n)=>{var r,i,s;function o(){gb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{gb(),n(va(t,"network-request-failed"))},timeout:BI.get()})}if(!((i=(r=ya().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ya().gapi)===null||s===void 0)&&s.load)o();else{const l=AC("iframefcb");return ya()[l]=()=>{gapi.load?o():n(va(t,"network-request-failed"))},x4(`${EC()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw em=null,e})}let em=null;function zI(t){return em=em||$I(t),em}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qI=new Th(5e3,15e3),HI="__/auth/iframe",WI="emulator/auth/iframe",GI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},KI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function YI(t){const e=t.config;ht(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ey(e,WI):`https://${t.config.authDomain}/${HI}`,r={apiKey:e.apiKey,appName:t.name,v:bc},i=KI.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Sh(r).slice(1)}`}async function QI(t){const e=await zI(t),n=ya().gapi;return ht(n,t,"internal-error"),e.open({where:document.body,url:YI(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:GI,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=va(t,"network-request-failed"),l=ya().setTimeout(()=>{s(o)},qI.get());function c(){ya().clearTimeout(l),i(r)}r.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},JI=500,ZI=600,e6="_blank",t6="http://localhost";class vb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function n6(t,e,n,r=JI,i=ZI){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},XI),{width:r.toString(),height:i.toString(),top:s,left:o}),u=oi().toLowerCase();n&&(l=h4(u)?e6:n),u4(u)&&(e=e||t6,c.scrollbars="yes");const f=Object.entries(c).reduce((g,[p,S])=>`${g}${p}=${S},`,"");if(pC(u)&&l!=="_self")return r6(e||"",l),new vb(null);const v=window.open(e||"",l,f);ht(v,t,"popup-blocked");try{v.focus()}catch{}return new vb(v)}function r6(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i6="__/auth/handler",s6="emulator/auth/handler",a6=encodeURIComponent("fac");async function yb(t,e,n,r,i,s){ht(t.config.authDomain,t,"auth-domain-config-required"),ht(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:bc,eventId:i};if(e instanceof _4){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",UT(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,v]of Object.entries({}))o[f]=v}if(e instanceof Ch){const f=e.getScopes().filter(v=>v!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const c=await t._getAppCheckToken(),u=c?`#${a6}=${encodeURIComponent(c)}`:"";return`${o6(t)}?${Sh(l).slice(1)}${u}`}function o6({config:t}){return t.emulator?ey(t,s6):`https://${t.authDomain}/${i6}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg="webStorageSupport";class l6{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=j4,this._completeRedirectFn=PI,this._overrideRedirectResult=jI}async _openPopup(e,n,r,i){var s;lo((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await yb(e,n,r,Av(),i);return n6(e,o,cy())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await yb(e,n,r,Av(),i);return dI(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(lo(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await QI(e),r=new LI(e);return n.register("authEvent",i=>(ht(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Xg,{type:Xg},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Xg];o!==void 0&&n(!!o),bs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=UI(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return v4()||d4()||ny()}}const c6=l6;var xb="@firebase/auth",bb="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ht(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d6(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function h6(t){ml(new ao("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;ht(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:y4(t)},u=new wC(r,i,s,c);return CC(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ml(new ao("auth-internal",e=>{const n=mo(e.getProvider("auth").getImmediate());return(r=>new u6(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ps(xb,bb,d6(t)),ps(xb,bb,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f6=5*60,m6=K_("authIdTokenMaxAge")||f6;let wb=null;const p6=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>m6)return;const i=n==null?void 0:n.token;wb!==i&&(wb=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function g6(t=Cp()){const e=kh(t,"auth");if(e.isInitialized())return e.getImmediate();const n=jC(t,{popupRedirectResolver:c6,persistence:[bI,lI,j4]}),r=K_("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=p6(s.toString());iI(n,o,()=>o(n.currentUser)),rI(n,l=>o(l))}}const i=W_("auth");return i&&IC(n,`http://${i}`),n}function v6(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}NC({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=va("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",v6().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});h6("Browser");var Nb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var rc,O4;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(V,T){function N(){}N.prototype=T.prototype,V.D=T.prototype,V.prototype=new N,V.prototype.constructor=V,V.C=function(U,E,L){for(var _=Array(arguments.length-2),M=2;M<arguments.length;M++)_[M-2]=arguments[M];return T.prototype[E].apply(U,_)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(V,T,N){N||(N=0);var U=Array(16);if(typeof T=="string")for(var E=0;16>E;++E)U[E]=T.charCodeAt(N++)|T.charCodeAt(N++)<<8|T.charCodeAt(N++)<<16|T.charCodeAt(N++)<<24;else for(E=0;16>E;++E)U[E]=T[N++]|T[N++]<<8|T[N++]<<16|T[N++]<<24;T=V.g[0],N=V.g[1],E=V.g[2];var L=V.g[3],_=T+(L^N&(E^L))+U[0]+3614090360&4294967295;T=N+(_<<7&4294967295|_>>>25),_=L+(E^T&(N^E))+U[1]+3905402710&4294967295,L=T+(_<<12&4294967295|_>>>20),_=E+(N^L&(T^N))+U[2]+606105819&4294967295,E=L+(_<<17&4294967295|_>>>15),_=N+(T^E&(L^T))+U[3]+3250441966&4294967295,N=E+(_<<22&4294967295|_>>>10),_=T+(L^N&(E^L))+U[4]+4118548399&4294967295,T=N+(_<<7&4294967295|_>>>25),_=L+(E^T&(N^E))+U[5]+1200080426&4294967295,L=T+(_<<12&4294967295|_>>>20),_=E+(N^L&(T^N))+U[6]+2821735955&4294967295,E=L+(_<<17&4294967295|_>>>15),_=N+(T^E&(L^T))+U[7]+4249261313&4294967295,N=E+(_<<22&4294967295|_>>>10),_=T+(L^N&(E^L))+U[8]+1770035416&4294967295,T=N+(_<<7&4294967295|_>>>25),_=L+(E^T&(N^E))+U[9]+2336552879&4294967295,L=T+(_<<12&4294967295|_>>>20),_=E+(N^L&(T^N))+U[10]+4294925233&4294967295,E=L+(_<<17&4294967295|_>>>15),_=N+(T^E&(L^T))+U[11]+2304563134&4294967295,N=E+(_<<22&4294967295|_>>>10),_=T+(L^N&(E^L))+U[12]+1804603682&4294967295,T=N+(_<<7&4294967295|_>>>25),_=L+(E^T&(N^E))+U[13]+4254626195&4294967295,L=T+(_<<12&4294967295|_>>>20),_=E+(N^L&(T^N))+U[14]+2792965006&4294967295,E=L+(_<<17&4294967295|_>>>15),_=N+(T^E&(L^T))+U[15]+1236535329&4294967295,N=E+(_<<22&4294967295|_>>>10),_=T+(E^L&(N^E))+U[1]+4129170786&4294967295,T=N+(_<<5&4294967295|_>>>27),_=L+(N^E&(T^N))+U[6]+3225465664&4294967295,L=T+(_<<9&4294967295|_>>>23),_=E+(T^N&(L^T))+U[11]+643717713&4294967295,E=L+(_<<14&4294967295|_>>>18),_=N+(L^T&(E^L))+U[0]+3921069994&4294967295,N=E+(_<<20&4294967295|_>>>12),_=T+(E^L&(N^E))+U[5]+3593408605&4294967295,T=N+(_<<5&4294967295|_>>>27),_=L+(N^E&(T^N))+U[10]+38016083&4294967295,L=T+(_<<9&4294967295|_>>>23),_=E+(T^N&(L^T))+U[15]+3634488961&4294967295,E=L+(_<<14&4294967295|_>>>18),_=N+(L^T&(E^L))+U[4]+3889429448&4294967295,N=E+(_<<20&4294967295|_>>>12),_=T+(E^L&(N^E))+U[9]+568446438&4294967295,T=N+(_<<5&4294967295|_>>>27),_=L+(N^E&(T^N))+U[14]+3275163606&4294967295,L=T+(_<<9&4294967295|_>>>23),_=E+(T^N&(L^T))+U[3]+4107603335&4294967295,E=L+(_<<14&4294967295|_>>>18),_=N+(L^T&(E^L))+U[8]+1163531501&4294967295,N=E+(_<<20&4294967295|_>>>12),_=T+(E^L&(N^E))+U[13]+2850285829&4294967295,T=N+(_<<5&4294967295|_>>>27),_=L+(N^E&(T^N))+U[2]+4243563512&4294967295,L=T+(_<<9&4294967295|_>>>23),_=E+(T^N&(L^T))+U[7]+1735328473&4294967295,E=L+(_<<14&4294967295|_>>>18),_=N+(L^T&(E^L))+U[12]+2368359562&4294967295,N=E+(_<<20&4294967295|_>>>12),_=T+(N^E^L)+U[5]+4294588738&4294967295,T=N+(_<<4&4294967295|_>>>28),_=L+(T^N^E)+U[8]+2272392833&4294967295,L=T+(_<<11&4294967295|_>>>21),_=E+(L^T^N)+U[11]+1839030562&4294967295,E=L+(_<<16&4294967295|_>>>16),_=N+(E^L^T)+U[14]+4259657740&4294967295,N=E+(_<<23&4294967295|_>>>9),_=T+(N^E^L)+U[1]+2763975236&4294967295,T=N+(_<<4&4294967295|_>>>28),_=L+(T^N^E)+U[4]+1272893353&4294967295,L=T+(_<<11&4294967295|_>>>21),_=E+(L^T^N)+U[7]+4139469664&4294967295,E=L+(_<<16&4294967295|_>>>16),_=N+(E^L^T)+U[10]+3200236656&4294967295,N=E+(_<<23&4294967295|_>>>9),_=T+(N^E^L)+U[13]+681279174&4294967295,T=N+(_<<4&4294967295|_>>>28),_=L+(T^N^E)+U[0]+3936430074&4294967295,L=T+(_<<11&4294967295|_>>>21),_=E+(L^T^N)+U[3]+3572445317&4294967295,E=L+(_<<16&4294967295|_>>>16),_=N+(E^L^T)+U[6]+76029189&4294967295,N=E+(_<<23&4294967295|_>>>9),_=T+(N^E^L)+U[9]+3654602809&4294967295,T=N+(_<<4&4294967295|_>>>28),_=L+(T^N^E)+U[12]+3873151461&4294967295,L=T+(_<<11&4294967295|_>>>21),_=E+(L^T^N)+U[15]+530742520&4294967295,E=L+(_<<16&4294967295|_>>>16),_=N+(E^L^T)+U[2]+3299628645&4294967295,N=E+(_<<23&4294967295|_>>>9),_=T+(E^(N|~L))+U[0]+4096336452&4294967295,T=N+(_<<6&4294967295|_>>>26),_=L+(N^(T|~E))+U[7]+1126891415&4294967295,L=T+(_<<10&4294967295|_>>>22),_=E+(T^(L|~N))+U[14]+2878612391&4294967295,E=L+(_<<15&4294967295|_>>>17),_=N+(L^(E|~T))+U[5]+4237533241&4294967295,N=E+(_<<21&4294967295|_>>>11),_=T+(E^(N|~L))+U[12]+1700485571&4294967295,T=N+(_<<6&4294967295|_>>>26),_=L+(N^(T|~E))+U[3]+2399980690&4294967295,L=T+(_<<10&4294967295|_>>>22),_=E+(T^(L|~N))+U[10]+4293915773&4294967295,E=L+(_<<15&4294967295|_>>>17),_=N+(L^(E|~T))+U[1]+2240044497&4294967295,N=E+(_<<21&4294967295|_>>>11),_=T+(E^(N|~L))+U[8]+1873313359&4294967295,T=N+(_<<6&4294967295|_>>>26),_=L+(N^(T|~E))+U[15]+4264355552&4294967295,L=T+(_<<10&4294967295|_>>>22),_=E+(T^(L|~N))+U[6]+2734768916&4294967295,E=L+(_<<15&4294967295|_>>>17),_=N+(L^(E|~T))+U[13]+1309151649&4294967295,N=E+(_<<21&4294967295|_>>>11),_=T+(E^(N|~L))+U[4]+4149444226&4294967295,T=N+(_<<6&4294967295|_>>>26),_=L+(N^(T|~E))+U[11]+3174756917&4294967295,L=T+(_<<10&4294967295|_>>>22),_=E+(T^(L|~N))+U[2]+718787259&4294967295,E=L+(_<<15&4294967295|_>>>17),_=N+(L^(E|~T))+U[9]+3951481745&4294967295,V.g[0]=V.g[0]+T&4294967295,V.g[1]=V.g[1]+(E+(_<<21&4294967295|_>>>11))&4294967295,V.g[2]=V.g[2]+E&4294967295,V.g[3]=V.g[3]+L&4294967295}r.prototype.u=function(V,T){T===void 0&&(T=V.length);for(var N=T-this.blockSize,U=this.B,E=this.h,L=0;L<T;){if(E==0)for(;L<=N;)i(this,V,L),L+=this.blockSize;if(typeof V=="string"){for(;L<T;)if(U[E++]=V.charCodeAt(L++),E==this.blockSize){i(this,U),E=0;break}}else for(;L<T;)if(U[E++]=V[L++],E==this.blockSize){i(this,U),E=0;break}}this.h=E,this.o+=T},r.prototype.v=function(){var V=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);V[0]=128;for(var T=1;T<V.length-8;++T)V[T]=0;var N=8*this.o;for(T=V.length-8;T<V.length;++T)V[T]=N&255,N/=256;for(this.u(V),V=Array(16),T=N=0;4>T;++T)for(var U=0;32>U;U+=8)V[N++]=this.g[T]>>>U&255;return V};function s(V,T){var N=l;return Object.prototype.hasOwnProperty.call(N,V)?N[V]:N[V]=T(V)}function o(V,T){this.h=T;for(var N=[],U=!0,E=V.length-1;0<=E;E--){var L=V[E]|0;U&&L==T||(N[E]=L,U=!1)}this.g=N}var l={};function c(V){return-128<=V&&128>V?s(V,function(T){return new o([T|0],0>T?-1:0)}):new o([V|0],0>V?-1:0)}function u(V){if(isNaN(V)||!isFinite(V))return v;if(0>V)return C(u(-V));for(var T=[],N=1,U=0;V>=N;U++)T[U]=V/N|0,N*=4294967296;return new o(T,0)}function f(V,T){if(V.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(V.charAt(0)=="-")return C(f(V.substring(1),T));if(0<=V.indexOf("-"))throw Error('number format error: interior "-" character');for(var N=u(Math.pow(T,8)),U=v,E=0;E<V.length;E+=8){var L=Math.min(8,V.length-E),_=parseInt(V.substring(E,E+L),T);8>L?(L=u(Math.pow(T,L)),U=U.j(L).add(u(_))):(U=U.j(N),U=U.add(u(_)))}return U}var v=c(0),g=c(1),p=c(16777216);t=o.prototype,t.m=function(){if(k(this))return-C(this).m();for(var V=0,T=1,N=0;N<this.g.length;N++){var U=this.i(N);V+=(0<=U?U:4294967296+U)*T,T*=4294967296}return V},t.toString=function(V){if(V=V||10,2>V||36<V)throw Error("radix out of range: "+V);if(S(this))return"0";if(k(this))return"-"+C(this).toString(V);for(var T=u(Math.pow(V,6)),N=this,U="";;){var E=D(N,T).g;N=b(N,E.j(T));var L=((0<N.g.length?N.g[0]:N.h)>>>0).toString(V);if(N=E,S(N))return L+U;for(;6>L.length;)L="0"+L;U=L+U}},t.i=function(V){return 0>V?0:V<this.g.length?this.g[V]:this.h};function S(V){if(V.h!=0)return!1;for(var T=0;T<V.g.length;T++)if(V.g[T]!=0)return!1;return!0}function k(V){return V.h==-1}t.l=function(V){return V=b(this,V),k(V)?-1:S(V)?0:1};function C(V){for(var T=V.g.length,N=[],U=0;U<T;U++)N[U]=~V.g[U];return new o(N,~V.h).add(g)}t.abs=function(){return k(this)?C(this):this},t.add=function(V){for(var T=Math.max(this.g.length,V.g.length),N=[],U=0,E=0;E<=T;E++){var L=U+(this.i(E)&65535)+(V.i(E)&65535),_=(L>>>16)+(this.i(E)>>>16)+(V.i(E)>>>16);U=_>>>16,L&=65535,_&=65535,N[E]=_<<16|L}return new o(N,N[N.length-1]&-2147483648?-1:0)};function b(V,T){return V.add(C(T))}t.j=function(V){if(S(this)||S(V))return v;if(k(this))return k(V)?C(this).j(C(V)):C(C(this).j(V));if(k(V))return C(this.j(C(V)));if(0>this.l(p)&&0>V.l(p))return u(this.m()*V.m());for(var T=this.g.length+V.g.length,N=[],U=0;U<2*T;U++)N[U]=0;for(U=0;U<this.g.length;U++)for(var E=0;E<V.g.length;E++){var L=this.i(U)>>>16,_=this.i(U)&65535,M=V.i(E)>>>16,K=V.i(E)&65535;N[2*U+2*E]+=_*K,I(N,2*U+2*E),N[2*U+2*E+1]+=L*K,I(N,2*U+2*E+1),N[2*U+2*E+1]+=_*M,I(N,2*U+2*E+1),N[2*U+2*E+2]+=L*M,I(N,2*U+2*E+2)}for(U=0;U<T;U++)N[U]=N[2*U+1]<<16|N[2*U];for(U=T;U<2*T;U++)N[U]=0;return new o(N,0)};function I(V,T){for(;(V[T]&65535)!=V[T];)V[T+1]+=V[T]>>>16,V[T]&=65535,T++}function R(V,T){this.g=V,this.h=T}function D(V,T){if(S(T))throw Error("division by zero");if(S(V))return new R(v,v);if(k(V))return T=D(C(V),T),new R(C(T.g),C(T.h));if(k(T))return T=D(V,C(T)),new R(C(T.g),T.h);if(30<V.g.length){if(k(V)||k(T))throw Error("slowDivide_ only works with positive integers.");for(var N=g,U=T;0>=U.l(V);)N=ee(N),U=ee(U);var E=oe(N,1),L=oe(U,1);for(U=oe(U,2),N=oe(N,2);!S(U);){var _=L.add(U);0>=_.l(V)&&(E=E.add(N),L=_),U=oe(U,1),N=oe(N,1)}return T=b(V,E.j(T)),new R(E,T)}for(E=v;0<=V.l(T);){for(N=Math.max(1,Math.floor(V.m()/T.m())),U=Math.ceil(Math.log(N)/Math.LN2),U=48>=U?1:Math.pow(2,U-48),L=u(N),_=L.j(T);k(_)||0<_.l(V);)N-=U,L=u(N),_=L.j(T);S(L)&&(L=g),E=E.add(L),V=b(V,_)}return new R(E,V)}t.A=function(V){return D(this,V).h},t.and=function(V){for(var T=Math.max(this.g.length,V.g.length),N=[],U=0;U<T;U++)N[U]=this.i(U)&V.i(U);return new o(N,this.h&V.h)},t.or=function(V){for(var T=Math.max(this.g.length,V.g.length),N=[],U=0;U<T;U++)N[U]=this.i(U)|V.i(U);return new o(N,this.h|V.h)},t.xor=function(V){for(var T=Math.max(this.g.length,V.g.length),N=[],U=0;U<T;U++)N[U]=this.i(U)^V.i(U);return new o(N,this.h^V.h)};function ee(V){for(var T=V.g.length+1,N=[],U=0;U<T;U++)N[U]=V.i(U)<<1|V.i(U-1)>>>31;return new o(N,V.h)}function oe(V,T){var N=T>>5;T%=32;for(var U=V.g.length-N,E=[],L=0;L<U;L++)E[L]=0<T?V.i(L+N)>>>T|V.i(L+N+1)<<32-T:V.i(L+N);return new o(E,V.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,O4=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,rc=o}).apply(typeof Nb<"u"?Nb:typeof self<"u"?self:typeof window<"u"?window:{});var Af=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var M4,Ad,F4,tm,Tv,U4,V4,B4;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,w,O){return h==Array.prototype||h==Object.prototype||(h[w]=O.value),h};function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Af=="object"&&Af];for(var w=0;w<h.length;++w){var O=h[w];if(O&&O.Math==Math)return O}throw Error("Cannot find global object")}var r=n(this);function i(h,w){if(w)e:{var O=r;h=h.split(".");for(var Z=0;Z<h.length-1;Z++){var ve=h[Z];if(!(ve in O))break e;O=O[ve]}h=h[h.length-1],Z=O[h],w=w(Z),w!=Z&&w!=null&&e(O,h,{configurable:!0,writable:!0,value:w})}}function s(h,w){h instanceof String&&(h+="");var O=0,Z=!1,ve={next:function(){if(!Z&&O<h.length){var _e=O++;return{value:w(_e,h[_e]),done:!1}}return Z=!0,{done:!0,value:void 0}}};return ve[Symbol.iterator]=function(){return ve},ve}i("Array.prototype.values",function(h){return h||function(){return s(this,function(w,O){return O})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(h){var w=typeof h;return w=w!="object"?w:h?Array.isArray(h)?"array":w:"null",w=="array"||w=="object"&&typeof h.length=="number"}function u(h){var w=typeof h;return w=="object"&&h!=null||w=="function"}function f(h,w,O){return h.call.apply(h.bind,arguments)}function v(h,w,O){if(!h)throw Error();if(2<arguments.length){var Z=Array.prototype.slice.call(arguments,2);return function(){var ve=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ve,Z),h.apply(w,ve)}}return function(){return h.apply(w,arguments)}}function g(h,w,O){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:v,g.apply(null,arguments)}function p(h,w){var O=Array.prototype.slice.call(arguments,1);return function(){var Z=O.slice();return Z.push.apply(Z,arguments),h.apply(this,Z)}}function S(h,w){function O(){}O.prototype=w.prototype,h.aa=w.prototype,h.prototype=new O,h.prototype.constructor=h,h.Qb=function(Z,ve,_e){for(var Be=Array(arguments.length-2),qt=2;qt<arguments.length;qt++)Be[qt-2]=arguments[qt];return w.prototype[ve].apply(Z,Be)}}function k(h){const w=h.length;if(0<w){const O=Array(w);for(let Z=0;Z<w;Z++)O[Z]=h[Z];return O}return[]}function C(h,w){for(let O=1;O<arguments.length;O++){const Z=arguments[O];if(c(Z)){const ve=h.length||0,_e=Z.length||0;h.length=ve+_e;for(let Be=0;Be<_e;Be++)h[ve+Be]=Z[Be]}else h.push(Z)}}class b{constructor(w,O){this.i=w,this.j=O,this.h=0,this.g=null}get(){let w;return 0<this.h?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function I(h){return/^[\s\xa0]*$/.test(h)}function R(){var h=l.navigator;return h&&(h=h.userAgent)?h:""}function D(h){return D[" "](h),h}D[" "]=function(){};var ee=R().indexOf("Gecko")!=-1&&!(R().toLowerCase().indexOf("webkit")!=-1&&R().indexOf("Edge")==-1)&&!(R().indexOf("Trident")!=-1||R().indexOf("MSIE")!=-1)&&R().indexOf("Edge")==-1;function oe(h,w,O){for(const Z in h)w.call(O,h[Z],Z,h)}function V(h,w){for(const O in h)w.call(void 0,h[O],O,h)}function T(h){const w={};for(const O in h)w[O]=h[O];return w}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U(h,w){let O,Z;for(let ve=1;ve<arguments.length;ve++){Z=arguments[ve];for(O in Z)h[O]=Z[O];for(let _e=0;_e<N.length;_e++)O=N[_e],Object.prototype.hasOwnProperty.call(Z,O)&&(h[O]=Z[O])}}function E(h){var w=1;h=h.split(":");const O=[];for(;0<w&&h.length;)O.push(h.shift()),w--;return h.length&&O.push(h.join(":")),O}function L(h){l.setTimeout(()=>{throw h},0)}function _(){var h=W;let w=null;return h.g&&(w=h.g,h.g=h.g.next,h.g||(h.h=null),w.next=null),w}class M{constructor(){this.h=this.g=null}add(w,O){const Z=K.get();Z.set(w,O),this.h?this.h.next=Z:this.g=Z,this.h=Z}}var K=new b(()=>new F,h=>h.reset());class F{constructor(){this.next=this.g=this.h=null}set(w,O){this.h=w,this.g=O,this.next=null}reset(){this.next=this.g=this.h=null}}let X,H=!1,W=new M,Y=()=>{const h=l.Promise.resolve(void 0);X=()=>{h.then(B)}};var B=()=>{for(var h;h=_();){try{h.h.call(h.g)}catch(O){L(O)}var w=K;w.j(h),100>w.h&&(w.h++,h.next=w.g,w.g=h)}H=!1};function A(){this.s=this.s,this.C=this.C}A.prototype.s=!1,A.prototype.ma=function(){this.s||(this.s=!0,this.N())},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(h,w){this.type=h,this.g=this.target=w,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var q=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var h=!1,w=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const O=()=>{};l.addEventListener("test",O,w),l.removeEventListener("test",O,w)}catch{}return h}();function te(h,w){if(P.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var O=this.type=h.type,Z=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=w,w=h.relatedTarget){if(ee){e:{try{D(w.nodeName);var ve=!0;break e}catch{}ve=!1}ve||(w=null)}}else O=="mouseover"?w=h.fromElement:O=="mouseout"&&(w=h.toElement);this.relatedTarget=w,Z?(this.clientX=Z.clientX!==void 0?Z.clientX:Z.pageX,this.clientY=Z.clientY!==void 0?Z.clientY:Z.pageY,this.screenX=Z.screenX||0,this.screenY=Z.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:le[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&te.aa.h.call(this)}}S(te,P);var le={2:"touch",3:"pen",4:"mouse"};te.prototype.h=function(){te.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var ce="closure_listenable_"+(1e6*Math.random()|0),me=0;function he(h,w,O,Z,ve){this.listener=h,this.proxy=null,this.src=w,this.type=O,this.capture=!!Z,this.ha=ve,this.key=++me,this.da=this.fa=!1}function we(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ee(h){this.src=h,this.g={},this.h=0}Ee.prototype.add=function(h,w,O,Z,ve){var _e=h.toString();h=this.g[_e],h||(h=this.g[_e]=[],this.h++);var Be=Re(h,w,Z,ve);return-1<Be?(w=h[Be],O||(w.fa=!1)):(w=new he(w,this.src,_e,!!Z,ve),w.fa=O,h.push(w)),w};function Le(h,w){var O=w.type;if(O in h.g){var Z=h.g[O],ve=Array.prototype.indexOf.call(Z,w,void 0),_e;(_e=0<=ve)&&Array.prototype.splice.call(Z,ve,1),_e&&(we(w),h.g[O].length==0&&(delete h.g[O],h.h--))}}function Re(h,w,O,Z){for(var ve=0;ve<h.length;++ve){var _e=h[ve];if(!_e.da&&_e.listener==w&&_e.capture==!!O&&_e.ha==Z)return ve}return-1}var xe="closure_lm_"+(1e6*Math.random()|0),re={};function qe(h,w,O,Z,ve){if(Array.isArray(w)){for(var _e=0;_e<w.length;_e++)qe(h,w[_e],O,Z,ve);return null}return O=At(O),h&&h[ce]?h.K(w,O,u(Z)?!!Z.capture:!1,ve):dt(h,w,O,!1,Z,ve)}function dt(h,w,O,Z,ve,_e){if(!w)throw Error("Invalid event type");var Be=u(ve)?!!ve.capture:!!ve,qt=it(h);if(qt||(h[xe]=qt=new Ee(h)),O=qt.add(w,O,Z,Be,_e),O.proxy)return O;if(Z=lt(),O.proxy=Z,Z.src=h,Z.listener=O,h.addEventListener)q||(ve=Be),ve===void 0&&(ve=!1),h.addEventListener(w.toString(),Z,ve);else if(h.attachEvent)h.attachEvent(Se(w.toString()),Z);else if(h.addListener&&h.removeListener)h.addListener(Z);else throw Error("addEventListener and attachEvent are unavailable.");return O}function lt(){function h(O){return w.call(h.src,h.listener,O)}const w=$e;return h}function Oe(h,w,O,Z,ve){if(Array.isArray(w))for(var _e=0;_e<w.length;_e++)Oe(h,w[_e],O,Z,ve);else Z=u(Z)?!!Z.capture:!!Z,O=At(O),h&&h[ce]?(h=h.i,w=String(w).toString(),w in h.g&&(_e=h.g[w],O=Re(_e,O,Z,ve),-1<O&&(we(_e[O]),Array.prototype.splice.call(_e,O,1),_e.length==0&&(delete h.g[w],h.h--)))):h&&(h=it(h))&&(w=h.g[w.toString()],h=-1,w&&(h=Re(w,O,Z,ve)),(O=-1<h?w[h]:null)&&Qe(O))}function Qe(h){if(typeof h!="number"&&h&&!h.da){var w=h.src;if(w&&w[ce])Le(w.i,h);else{var O=h.type,Z=h.proxy;w.removeEventListener?w.removeEventListener(O,Z,h.capture):w.detachEvent?w.detachEvent(Se(O),Z):w.addListener&&w.removeListener&&w.removeListener(Z),(O=it(w))?(Le(O,h),O.h==0&&(O.src=null,w[xe]=null)):we(h)}}}function Se(h){return h in re?re[h]:re[h]="on"+h}function $e(h,w){if(h.da)h=!0;else{w=new te(w,this);var O=h.listener,Z=h.ha||h.src;h.fa&&Qe(h),h=O.call(Z,w)}return h}function it(h){return h=h[xe],h instanceof Ee?h:null}var zt="__closure_events_fn_"+(1e9*Math.random()>>>0);function At(h){return typeof h=="function"?h:(h[zt]||(h[zt]=function(w){return h.handleEvent(w)}),h[zt])}function nt(){A.call(this),this.i=new Ee(this),this.M=this,this.F=null}S(nt,A),nt.prototype[ce]=!0,nt.prototype.removeEventListener=function(h,w,O,Z){Oe(this,h,w,O,Z)};function Tt(h,w){var O,Z=h.F;if(Z)for(O=[];Z;Z=Z.F)O.push(Z);if(h=h.M,Z=w.type||w,typeof w=="string")w=new P(w,h);else if(w instanceof P)w.target=w.target||h;else{var ve=w;w=new P(Z,h),U(w,ve)}if(ve=!0,O)for(var _e=O.length-1;0<=_e;_e--){var Be=w.g=O[_e];ve=wt(Be,Z,!0,w)&&ve}if(Be=w.g=h,ve=wt(Be,Z,!0,w)&&ve,ve=wt(Be,Z,!1,w)&&ve,O)for(_e=0;_e<O.length;_e++)Be=w.g=O[_e],ve=wt(Be,Z,!1,w)&&ve}nt.prototype.N=function(){if(nt.aa.N.call(this),this.i){var h=this.i,w;for(w in h.g){for(var O=h.g[w],Z=0;Z<O.length;Z++)we(O[Z]);delete h.g[w],h.h--}}this.F=null},nt.prototype.K=function(h,w,O,Z){return this.i.add(String(h),w,!1,O,Z)},nt.prototype.L=function(h,w,O,Z){return this.i.add(String(h),w,!0,O,Z)};function wt(h,w,O,Z){if(w=h.i.g[String(w)],!w)return!0;w=w.concat();for(var ve=!0,_e=0;_e<w.length;++_e){var Be=w[_e];if(Be&&!Be.da&&Be.capture==O){var qt=Be.listener,Bn=Be.ha||Be.src;Be.fa&&Le(h.i,Be),ve=qt.call(Bn,Z)!==!1&&ve}}return ve&&!Z.defaultPrevented}function st(h,w,O){if(typeof h=="function")O&&(h=g(h,O));else if(h&&typeof h.handleEvent=="function")h=g(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(w)?-1:l.setTimeout(h,w||0)}function yt(h){h.g=st(()=>{h.g=null,h.i&&(h.i=!1,yt(h))},h.l);const w=h.h;h.h=null,h.m.apply(null,w)}class ct extends A{constructor(w,O){super(),this.m=w,this.l=O,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:yt(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function en(h){A.call(this),this.h=h,this.g={}}S(en,A);var Kt=[];function Ze(h){oe(h.g,function(w,O){this.g.hasOwnProperty(O)&&Qe(w)},h),h.g={}}en.prototype.N=function(){en.aa.N.call(this),Ze(this)},en.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Nt=l.JSON.stringify,an=l.JSON.parse,gt=class{stringify(h){return l.JSON.stringify(h,void 0)}parse(h){return l.JSON.parse(h,void 0)}};function Dt(){}Dt.prototype.h=null;function St(h){return h.h||(h.h=h.i())}function Rn(){}var Sn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function nn(){P.call(this,"d")}S(nn,P);function xt(){P.call(this,"c")}S(xt,P);var Mt={},Ws=null;function Jn(){return Ws=Ws||new nt}Mt.La="serverreachability";function ns(h){P.call(this,Mt.La,h)}S(ns,P);function qr(h){const w=Jn();Tt(w,new ns(w))}Mt.STAT_EVENT="statevent";function pt(h,w){P.call(this,Mt.STAT_EVENT,h),this.stat=w}S(pt,P);function kn(h){const w=Jn();Tt(w,new pt(w,h))}Mt.Ma="timingevent";function rs(h,w){P.call(this,Mt.Ma,h),this.size=w}S(rs,P);function Er(h,w){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){h()},w)}function Ar(){this.g=!0}Ar.prototype.xa=function(){this.g=!1};function Ln(h,w,O,Z,ve,_e){h.info(function(){if(h.g)if(_e)for(var Be="",qt=_e.split("&"),Bn=0;Bn<qt.length;Bn++){var Ft=qt[Bn].split("=");if(1<Ft.length){var Ot=Ft[0];Ft=Ft[1];var Nn=Ot.split("_");Be=2<=Nn.length&&Nn[1]=="type"?Be+(Ot+"="+Ft+"&"):Be+(Ot+"=redacted&")}}else Be=null;else Be=_e;return"XMLHTTP REQ ("+Z+") [attempt "+ve+"]: "+w+`
`+O+`
`+Be})}function ur(h,w,O,Z,ve,_e,Be){h.info(function(){return"XMLHTTP RESP ("+Z+") [ attempt "+ve+"]: "+w+`
`+O+`
`+_e+" "+Be})}function Dn(h,w,O,Z){h.info(function(){return"XMLHTTP TEXT ("+w+"): "+Gs(h,O)+(Z?" "+Z:"")})}function ja(h,w){h.info(function(){return"TIMEOUT: "+w})}Ar.prototype.info=function(){};function Gs(h,w){if(!h.g)return w;if(!w)return null;try{var O=JSON.parse(w);if(O){for(h=0;h<O.length;h++)if(Array.isArray(O[h])){var Z=O[h];if(!(2>Z.length)){var ve=Z[1];if(Array.isArray(ve)&&!(1>ve.length)){var _e=ve[0];if(_e!="noop"&&_e!="stop"&&_e!="close")for(var Be=1;Be<ve.length;Be++)ve[Be]=""}}}}return Nt(O)}catch{return w}}var Hr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Pi={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},li;function Wr(){}S(Wr,Dt),Wr.prototype.g=function(){return new XMLHttpRequest},Wr.prototype.i=function(){return{}},li=new Wr;function Zn(h,w,O,Z){this.j=h,this.i=w,this.l=O,this.R=Z||1,this.U=new en(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ks}function Ks(){this.i=null,this.g="",this.h=!1}var Ri={},_s={};function Ys(h,w,O){h.L=1,h.v=Ra(ci(w)),h.m=O,h.P=!0,Ca(h,null)}function Ca(h,w){h.F=Date.now(),Qs(h),h.A=ci(h.v);var O=h.A,Z=h.R;Array.isArray(Z)||(Z=[String(Z)]),bt(O.i,"t",Z),h.C=0,O=h.j.J,h.h=new Ks,h.g=Wn(h.j,O?w:null,!h.m),0<h.O&&(h.M=new ct(g(h.Y,h,h.g),h.O)),w=h.U,O=h.g,Z=h.ca;var ve="readystatechange";Array.isArray(ve)||(ve&&(Kt[0]=ve.toString()),ve=Kt);for(var _e=0;_e<ve.length;_e++){var Be=qe(O,ve[_e],Z||w.handleEvent,!1,w.h||w);if(!Be)break;w.g[Be.key]=Be}w=h.H?T(h.H):{},h.m?(h.u||(h.u="POST"),w["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,w)):(h.u="GET",h.g.ea(h.A,h.u,null,w)),qr(),Ln(h.i,h.u,h.A,h.l,h.R,h.m)}Zn.prototype.ca=function(h){h=h.target;const w=this.M;w&&wi(h)==3?w.j():this.Y(h)},Zn.prototype.Y=function(h){try{if(h==this.g)e:{const Nn=wi(this.g);var w=this.g.Ba();const Mi=this.g.Z();if(!(3>Nn)&&(Nn!=3||this.g&&(this.h.h||this.g.oa()||Ol(this.g)))){this.J||Nn!=4||w==7||(w==8||0>=Mi?qr(3):qr(2)),go(this);var O=this.g.Z();this.X=O;t:if(Ia(this)){var Z=Ol(this.g);h="";var ve=Z.length,_e=wi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Li(this),Sr(this);var Be="";break t}this.h.i=new l.TextDecoder}for(w=0;w<ve;w++)this.h.h=!0,h+=this.h.i.decode(Z[w],{stream:!(_e&&w==ve-1)});Z.length=0,this.h.g+=h,this.C=0,Be=this.h.g}else Be=this.g.oa();if(this.o=O==200,ur(this.i,this.u,this.A,this.l,this.R,Nn,O),this.o){if(this.T&&!this.K){t:{if(this.g){var qt,Bn=this.g;if((qt=Bn.g?Bn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(qt)){var Ft=qt;break t}}Ft=null}if(O=Ft)Dn(this.i,this.l,O,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,vo(this,O);else{this.o=!1,this.s=3,kn(12),Li(this),Sr(this);break e}}if(this.P){O=!0;let Gr;for(;!this.J&&this.C<Be.length;)if(Gr=Bu(this,Be),Gr==_s){Nn==4&&(this.s=4,kn(14),O=!1),Dn(this.i,this.l,null,"[Incomplete Response]");break}else if(Gr==Ri){this.s=4,kn(15),Dn(this.i,this.l,Be,"[Invalid Chunk]"),O=!1;break}else Dn(this.i,this.l,Gr,null),vo(this,Gr);if(Ia(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Nn!=4||Be.length!=0||this.h.h||(this.s=1,kn(16),O=!1),this.o=this.o&&O,!O)Dn(this.i,this.l,Be,"[Invalid Chunked Response]"),Li(this),Sr(this);else if(0<Be.length&&!this.W){this.W=!0;var Ot=this.j;Ot.g==this&&Ot.ba&&!Ot.M&&(Ot.j.info("Great, no buffering proxy detected. Bytes received: "+Be.length),We(Ot),Ot.M=!0,kn(11))}}else Dn(this.i,this.l,Be,null),vo(this,Be);Nn==4&&Li(this),this.o&&!this.J&&(Nn==4?_t(this.j,this):(this.o=!1,Qs(this)))}else ks(this.g),O==400&&0<Be.indexOf("Unknown SID")?(this.s=3,kn(12)):(this.s=0,kn(13)),Li(this),Sr(this)}}}catch{}finally{}};function Ia(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Bu(h,w){var O=h.C,Z=w.indexOf(`
`,O);return Z==-1?_s:(O=Number(w.substring(O,Z)),isNaN(O)?Ri:(Z+=1,Z+O>w.length?_s:(w=w.slice(Z,Z+O),h.C=Z+O,w)))}Zn.prototype.cancel=function(){this.J=!0,Li(this)};function Qs(h){h.S=Date.now()+h.I,Al(h,h.I)}function Al(h,w){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Er(g(h.ba,h),w)}function go(h){h.B&&(l.clearTimeout(h.B),h.B=null)}Zn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(ja(this.i,this.A),this.L!=2&&(qr(),kn(17)),Li(this),this.s=2,Sr(this)):Al(this,this.S-h)};function Sr(h){h.j.G==0||h.J||_t(h.j,h)}function Li(h){go(h);var w=h.M;w&&typeof w.ma=="function"&&w.ma(),h.M=null,Ze(h.U),h.g&&(w=h.g,h.g=null,w.abort(),w.ma())}function vo(h,w){try{var O=h.j;if(O.G!=0&&(O.g==h||Xs(O.h,h))){if(!h.K&&Xs(O.h,h)&&O.G==3){try{var Z=O.Da.g.parse(w)}catch{Z=null}if(Array.isArray(Z)&&Z.length==3){var ve=Z;if(ve[0]==0){e:if(!O.u){if(O.g)if(O.g.F+3e3<h.F)vt(O),as(O);else break e;Ie(O),kn(18)}}else O.za=ve[1],0<O.za-O.T&&37500>ve[2]&&O.F&&O.v==0&&!O.C&&(O.C=Er(g(O.Za,O),6e3));if(1>=jl(O.h)&&O.ca){try{O.ca()}catch{}O.ca=void 0}}else rn(O,11)}else if((h.K||O.g==h)&&vt(O),!I(w))for(ve=O.Da.g.parse(w),w=0;w<ve.length;w++){let Ft=ve[w];if(O.T=Ft[0],Ft=Ft[1],O.G==2)if(Ft[0]=="c"){O.K=Ft[1],O.ia=Ft[2];const Ot=Ft[3];Ot!=null&&(O.la=Ot,O.j.info("VER="+O.la));const Nn=Ft[4];Nn!=null&&(O.Aa=Nn,O.j.info("SVER="+O.Aa));const Mi=Ft[5];Mi!=null&&typeof Mi=="number"&&0<Mi&&(Z=1.5*Mi,O.L=Z,O.j.info("backChannelRequestTimeoutMs_="+Z)),Z=O;const Gr=h.g;if(Gr){const Rr=Gr.g?Gr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Rr){var _e=Z.h;_e.g||Rr.indexOf("spdy")==-1&&Rr.indexOf("quic")==-1&&Rr.indexOf("h2")==-1||(_e.j=_e.l,_e.g=new Set,_e.h&&(Cl(_e,_e.h),_e.h=null))}if(Z.D){const Ts=Gr.g?Gr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ts&&(Z.ya=Ts,Bt(Z.I,Z.D,Ts))}}O.G=3,O.l&&O.l.ua(),O.ba&&(O.R=Date.now()-h.F,O.j.info("Handshake RTT: "+O.R+"ms")),Z=O;var Be=h;if(Z.qa=ln(Z,Z.J?Z.ia:null,Z.W),Be.K){Fn(Z.h,Be);var qt=Be,Bn=Z.L;Bn&&(qt.I=Bn),qt.B&&(go(qt),Qs(qt)),Z.g=Be}else ke(Z);0<O.i.length&&y(O)}else Ft[0]!="stop"&&Ft[0]!="close"||rn(O,7);else O.G==3&&(Ft[0]=="stop"||Ft[0]=="close"?Ft[0]=="stop"?rn(O,7):Eo(O):Ft[0]!="noop"&&O.l&&O.l.ta(Ft),O.v=0)}}qr(4)}catch{}}var Sl=class{constructor(h,w){this.g=h,this.map=w}};function kl(h){this.l=h||10,l.PerformanceNavigationTiming?(h=l.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Tl(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function jl(h){return h.h?1:h.g?h.g.size:0}function Xs(h,w){return h.h?h.h==w:h.g?h.g.has(w):!1}function Cl(h,w){h.g?h.g.add(w):h.h=w}function Fn(h,w){h.h&&h.h==w?h.h=null:h.g&&h.g.has(w)&&h.g.delete(w)}kl.prototype.cancel=function(){if(this.i=Il(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Il(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let w=h.i;for(const O of h.g.values())w=w.concat(O.D);return w}return k(h.i)}function Ac(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(c(h)){for(var w=[],O=h.length,Z=0;Z<O;Z++)w.push(h[Z]);return w}w=[],O=0;for(Z in h)w[O++]=h[Z];return w}function Es(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(c(h)||typeof h=="string"){var w=[];h=h.length;for(var O=0;O<h;O++)w.push(O);return w}w=[],O=0;for(const Z in h)w[O++]=Z;return w}}}function Js(h,w){if(h.forEach&&typeof h.forEach=="function")h.forEach(w,void 0);else if(c(h)||typeof h=="string")Array.prototype.forEach.call(h,w,void 0);else for(var O=Es(h),Z=Ac(h),ve=Z.length,_e=0;_e<ve;_e++)w.call(void 0,Z[_e],O&&O[_e],h)}var yi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pa(h,w){if(h){h=h.split("&");for(var O=0;O<h.length;O++){var Z=h[O].indexOf("="),ve=null;if(0<=Z){var _e=h[O].substring(0,Z);ve=h[O].substring(Z+1)}else _e=h[O];w(_e,ve?decodeURIComponent(ve.replace(/\+/g," ")):"")}}}function on(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof on){this.h=h.h,yo(this,h.j),this.o=h.o,this.g=h.g,xo(this,h.s),this.l=h.l;var w=h.i,O=new bi;O.i=w.i,w.g&&(O.g=new Map(w.g),O.h=w.h),Sc(this,O),this.m=h.m}else h&&(w=String(h).match(yi))?(this.h=!1,yo(this,w[1]||"",!0),this.o=Zs(w[2]||""),this.g=Zs(w[3]||"",!0),xo(this,w[4]),this.l=Zs(w[5]||"",!0),Sc(this,w[6]||"",!0),this.m=Zs(w[7]||"")):(this.h=!1,this.i=new bi(null,this.h))}on.prototype.toString=function(){var h=[],w=this.j;w&&h.push(xi(w,kc,!0),":");var O=this.g;return(O||w=="file")&&(h.push("//"),(w=this.o)&&h.push(xi(w,kc,!0),"@"),h.push(encodeURIComponent(String(O)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),O=this.s,O!=null&&h.push(":",String(O))),(O=this.l)&&(this.g&&O.charAt(0)!="/"&&h.push("/"),h.push(xi(O,O.charAt(0)=="/"?zu:$u,!0))),(O=this.i.toString())&&h.push("?",O),(O=this.m)&&h.push("#",xi(O,La)),h.join("")};function ci(h){return new on(h)}function yo(h,w,O){h.j=O?Zs(w,!0):w,h.j&&(h.j=h.j.replace(/:$/,""))}function xo(h,w){if(w){if(w=Number(w),isNaN(w)||0>w)throw Error("Bad port number "+w);h.s=w}else h.s=null}function Sc(h,w,O){w instanceof bi?(h.i=w,qu(h.i,h.h)):(O||(w=xi(w,Rl)),h.i=new bi(w,h.h))}function Bt(h,w,O){h.i.set(w,O)}function Ra(h){return Bt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Zs(h,w){return h?w?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function xi(h,w,O){return typeof h=="string"?(h=encodeURI(h).replace(w,Pl),O&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Pl(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var kc=/[#\/\?@]/g,$u=/[#\?:]/g,zu=/[#\?]/g,Rl=/[#\?@]/g,La=/#/g;function bi(h,w){this.h=this.g=null,this.i=h||null,this.j=!!w}function is(h){h.g||(h.g=new Map,h.h=0,h.i&&Pa(h.i,function(w,O){h.add(decodeURIComponent(w.replace(/\+/g," ")),O)}))}t=bi.prototype,t.add=function(h,w){is(this),this.i=null,h=ta(this,h);var O=this.g.get(h);return O||this.g.set(h,O=[]),O.push(w),this.h+=1,this};function ea(h,w){is(h),w=ta(h,w),h.g.has(w)&&(h.i=null,h.h-=h.g.get(w).length,h.g.delete(w))}function bo(h,w){return is(h),w=ta(h,w),h.g.has(w)}t.forEach=function(h,w){is(this),this.g.forEach(function(O,Z){O.forEach(function(ve){h.call(w,ve,Z,this)},this)},this)},t.na=function(){is(this);const h=Array.from(this.g.values()),w=Array.from(this.g.keys()),O=[];for(let Z=0;Z<w.length;Z++){const ve=h[Z];for(let _e=0;_e<ve.length;_e++)O.push(w[Z])}return O},t.V=function(h){is(this);let w=[];if(typeof h=="string")bo(this,h)&&(w=w.concat(this.g.get(ta(this,h))));else{h=Array.from(this.g.values());for(let O=0;O<h.length;O++)w=w.concat(h[O])}return w},t.set=function(h,w){return is(this),this.i=null,h=ta(this,h),bo(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[w]),this.h+=1,this},t.get=function(h,w){return h?(h=this.V(h),0<h.length?String(h[0]):w):w};function bt(h,w,O){ea(h,w),0<O.length&&(h.i=null,h.g.set(ta(h,w),k(O)),h.h+=O.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],w=Array.from(this.g.keys());for(var O=0;O<w.length;O++){var Z=w[O];const _e=encodeURIComponent(String(Z)),Be=this.V(Z);for(Z=0;Z<Be.length;Z++){var ve=_e;Be[Z]!==""&&(ve+="="+encodeURIComponent(String(Be[Z]))),h.push(ve)}}return this.i=h.join("&")};function ta(h,w){return w=String(w),h.j&&(w=w.toLowerCase()),w}function qu(h,w){w&&!h.j&&(is(h),h.i=null,h.g.forEach(function(O,Z){var ve=Z.toLowerCase();Z!=ve&&(ea(this,Z),bt(this,ve,O))},h)),h.j=w}function Hu(h,w){const O=new Ar;if(l.Image){const Z=new Image;Z.onload=p(kr,O,"TestLoadImage: loaded",!0,w,Z),Z.onerror=p(kr,O,"TestLoadImage: error",!1,w,Z),Z.onabort=p(kr,O,"TestLoadImage: abort",!1,w,Z),Z.ontimeout=p(kr,O,"TestLoadImage: timeout",!1,w,Z),l.setTimeout(function(){Z.ontimeout&&Z.ontimeout()},1e4),Z.src=h}else w(!1)}function Wu(h,w){const O=new Ar,Z=new AbortController,ve=setTimeout(()=>{Z.abort(),kr(O,"TestPingServer: timeout",!1,w)},1e4);fetch(h,{signal:Z.signal}).then(_e=>{clearTimeout(ve),_e.ok?kr(O,"TestPingServer: ok",!0,w):kr(O,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(ve),kr(O,"TestPingServer: error",!1,w)})}function kr(h,w,O,Z,ve){try{ve&&(ve.onload=null,ve.onerror=null,ve.onabort=null,ve.ontimeout=null),Z(O)}catch{}}function As(){this.g=new gt}function Gu(h,w,O){const Z=O||"";try{Js(h,function(ve,_e){let Be=ve;u(ve)&&(Be=Nt(ve)),w.push(Z+_e+"="+encodeURIComponent(Be))})}catch(ve){throw w.push(Z+"type="+encodeURIComponent("_badmap")),ve}}function wo(h){this.l=h.Ub||null,this.j=h.eb||!1}S(wo,Dt),wo.prototype.g=function(){return new Ss(this.l,this.j)},wo.prototype.i=function(h){return function(){return h}}({});function Ss(h,w){nt.call(this),this.D=h,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(Ss,nt),t=Ss.prototype,t.open=function(h,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=w,this.readyState=1,ss(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const w={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(w.body=h),(this.D||l).fetch(new Request(this.A,w)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Di(this)),this.readyState=0},t.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,ss(this)),this.g&&(this.readyState=3,ss(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;No(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function No(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}t.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var w=h.value?h.value:new Uint8Array(0);(w=this.v.decode(w,{stream:!h.done}))&&(this.response=this.responseText+=w)}h.done?Di(this):ss(this),this.readyState==3&&No(this)}},t.Ra=function(h){this.g&&(this.response=this.responseText=h,Di(this))},t.Qa=function(h){this.g&&(this.response=h,Di(this))},t.ga=function(){this.g&&Di(this)};function Di(h){h.readyState=4,h.l=null,h.j=null,h.v=null,ss(h)}t.setRequestHeader=function(h,w){this.u.append(h,w)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],w=this.h.entries();for(var O=w.next();!O.done;)O=O.value,h.push(O[0]+": "+O[1]),O=w.next();return h.join(`\r
`)};function ss(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Ss.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Da(h){let w="";return oe(h,function(O,Z){w+=Z,w+=":",w+=O,w+=`\r
`}),w}function Ll(h,w,O){e:{for(Z in O){var Z=!1;break e}Z=!0}Z||(O=Da(O),typeof h=="string"?O!=null&&encodeURIComponent(String(O)):Bt(h,w,O))}function gn(h){nt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(gn,nt);var Dl=/^https?$/i,Oa=["POST","PUT"];t=gn.prototype,t.Ha=function(h){this.J=h},t.ea=function(h,w,O,Z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);w=w?w.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():li.g(),this.v=this.o?St(this.o):St(li),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(w,String(h),!0),this.B=!1}catch(_e){na(this,_e);return}if(h=O||"",O=new Map(this.headers),Z)if(Object.getPrototypeOf(Z)===Object.prototype)for(var ve in Z)O.set(ve,Z[ve]);else if(typeof Z.keys=="function"&&typeof Z.get=="function")for(const _e of Z.keys())O.set(_e,Z.get(_e));else throw Error("Unknown input type for opt_headers: "+String(Z));Z=Array.from(O.keys()).find(_e=>_e.toLowerCase()=="content-type"),ve=l.FormData&&h instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Oa,w,void 0))||Z||ve||O.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[_e,Be]of O)this.g.setRequestHeader(_e,Be);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ia(this),this.u=!0,this.g.send(h),this.u=!1}catch(_e){na(this,_e)}};function na(h,w){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=w,h.m=5,_o(h),ra(h)}function _o(h){h.A||(h.A=!0,Tt(h,"complete"),Tt(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Tt(this,"complete"),Tt(this,"abort"),ra(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ra(this,!0)),gn.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ma(this):this.bb())},t.bb=function(){Ma(this)};function Ma(h){if(h.h&&typeof o<"u"&&(!h.v[1]||wi(h)!=4||h.Z()!=2)){if(h.u&&wi(h)==4)st(h.Ea,0,h);else if(Tt(h,"readystatechange"),wi(h)==4){h.h=!1;try{const Be=h.Z();e:switch(Be){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var O;if(!(O=w)){var Z;if(Z=Be===0){var ve=String(h.D).match(yi)[1]||null;!ve&&l.self&&l.self.location&&(ve=l.self.location.protocol.slice(0,-1)),Z=!Dl.test(ve?ve.toLowerCase():"")}O=Z}if(O)Tt(h,"complete"),Tt(h,"success");else{h.m=6;try{var _e=2<wi(h)?h.g.statusText:""}catch{_e=""}h.l=_e+" ["+h.Z()+"]",_o(h)}}finally{ra(h)}}}}function ra(h,w){if(h.g){ia(h);const O=h.g,Z=h.v[0]?()=>{}:null;h.g=null,h.v=null,w||Tt(h,"ready");try{O.onreadystatechange=Z}catch{}}}function ia(h){h.I&&(l.clearTimeout(h.I),h.I=null)}t.isActive=function(){return!!this.g};function wi(h){return h.g?h.g.readyState:0}t.Z=function(){try{return 2<wi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(h){if(this.g){var w=this.g.responseText;return h&&w.indexOf(h)==0&&(w=w.substring(h.length)),an(w)}};function Ol(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function ks(h){const w={};h=(h.g&&2<=wi(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let Z=0;Z<h.length;Z++){if(I(h[Z]))continue;var O=E(h[Z]);const ve=O[0];if(O=O[1],typeof O!="string")continue;O=O.trim();const _e=w[ve]||[];w[ve]=_e,_e.push(O)}V(w,function(Z){return Z.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ui(h,w,O){return O&&O.internalChannelParams&&O.internalChannelParams[h]||w}function Ml(h){this.Aa=0,this.i=[],this.j=new Ar,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ui("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ui("baseRetryDelayMs",5e3,h),this.cb=ui("retryDelaySeedMs",1e4,h),this.Wa=ui("forwardChannelMaxRetries",2,h),this.wa=ui("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new kl(h&&h.concurrentRequestLimit),this.Da=new As,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Ml.prototype,t.la=8,t.G=1,t.connect=function(h,w,O,Z){kn(0),this.W=h,this.H=w||{},O&&Z!==void 0&&(this.H.OSID=O,this.H.OAID=Z),this.F=this.X,this.I=ln(this,null,this.W),y(this)};function Eo(h){if(Fl(h),h.G==3){var w=h.U++,O=ci(h.I);if(Bt(O,"SID",h.K),Bt(O,"RID",w),Bt(O,"TYPE","terminate"),de(h,O),w=new Zn(h,h.j,w),w.L=2,w.v=Ra(ci(O)),O=!1,l.navigator&&l.navigator.sendBeacon)try{O=l.navigator.sendBeacon(w.v.toString(),"")}catch{}!O&&l.Image&&(new Image().src=w.v,O=!0),O||(w.g=Wn(w.j,null),w.g.ea(w.v)),w.F=Date.now(),Qs(w)}Un(h)}function as(h){h.g&&(We(h),h.g.cancel(),h.g=null)}function Fl(h){as(h),h.u&&(l.clearTimeout(h.u),h.u=null),vt(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&l.clearTimeout(h.s),h.s=null)}function y(h){if(!Tl(h.h)&&!h.s){h.s=!0;var w=h.Ga;X||Y(),H||(X(),H=!0),W.add(w,h),h.B=0}}function $(h,w){return jl(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=w.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Er(g(h.Ga,h,w),Yt(h,h.B)),h.B++,!0)}t.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const ve=new Zn(this,this.j,h);let _e=this.o;if(this.S&&(_e?(_e=T(_e),U(_e,this.S)):_e=this.S),this.m!==null||this.O||(ve.H=_e,_e=null),this.P)e:{for(var w=0,O=0;O<this.i.length;O++){t:{var Z=this.i[O];if("__data__"in Z.map&&(Z=Z.map.__data__,typeof Z=="string")){Z=Z.length;break t}Z=void 0}if(Z===void 0)break;if(w+=Z,4096<w){w=O;break e}if(w===4096||O===this.i.length-1){w=O+1;break e}}w=1e3}else w=1e3;w=ge(this,ve,w),O=ci(this.I),Bt(O,"RID",h),Bt(O,"CVER",22),this.D&&Bt(O,"X-HTTP-Session-Id",this.D),de(this,O),_e&&(this.O?w="headers="+encodeURIComponent(String(Da(_e)))+"&"+w:this.m&&Ll(O,this.m,_e)),Cl(this.h,ve),this.Ua&&Bt(O,"TYPE","init"),this.P?(Bt(O,"$req",w),Bt(O,"SID","null"),ve.T=!0,Ys(ve,O,null)):Ys(ve,O,w),this.G=2}}else this.G==3&&(h?ie(this,h):this.i.length==0||Tl(this.h)||ie(this))};function ie(h,w){var O;w?O=w.l:O=h.U++;const Z=ci(h.I);Bt(Z,"SID",h.K),Bt(Z,"RID",O),Bt(Z,"AID",h.T),de(h,Z),h.m&&h.o&&Ll(Z,h.m,h.o),O=new Zn(h,h.j,O,h.B+1),h.m===null&&(O.H=h.o),w&&(h.i=w.D.concat(h.i)),w=ge(h,O,1e3),O.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Cl(h.h,O),Ys(O,Z,w)}function de(h,w){h.H&&oe(h.H,function(O,Z){Bt(w,Z,O)}),h.l&&Js({},function(O,Z){Bt(w,Z,O)})}function ge(h,w,O){O=Math.min(h.i.length,O);var Z=h.l?g(h.l.Na,h.l,h):null;e:{var ve=h.i;let _e=-1;for(;;){const Be=["count="+O];_e==-1?0<O?(_e=ve[0].g,Be.push("ofs="+_e)):_e=0:Be.push("ofs="+_e);let qt=!0;for(let Bn=0;Bn<O;Bn++){let Ft=ve[Bn].g;const Ot=ve[Bn].map;if(Ft-=_e,0>Ft)_e=Math.max(0,ve[Bn].g-100),qt=!1;else try{Gu(Ot,Be,"req"+Ft+"_")}catch{Z&&Z(Ot)}}if(qt){Z=Be.join("&");break e}}}return h=h.i.splice(0,O),w.D=h,Z}function ke(h){if(!h.g&&!h.u){h.Y=1;var w=h.Fa;X||Y(),H||(X(),H=!0),W.add(w,h),h.v=0}}function Ie(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Er(g(h.Fa,h),Yt(h,h.v)),h.v++,!0)}t.Fa=function(){if(this.u=null,Xe(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Er(g(this.ab,this),h)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,kn(10),as(this),Xe(this))};function We(h){h.A!=null&&(l.clearTimeout(h.A),h.A=null)}function Xe(h){h.g=new Zn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var w=ci(h.qa);Bt(w,"RID","rpc"),Bt(w,"SID",h.K),Bt(w,"AID",h.T),Bt(w,"CI",h.F?"0":"1"),!h.F&&h.ja&&Bt(w,"TO",h.ja),Bt(w,"TYPE","xmlhttp"),de(h,w),h.m&&h.o&&Ll(w,h.m,h.o),h.L&&(h.g.I=h.L);var O=h.g;h=h.ia,O.L=1,O.v=Ra(ci(w)),O.m=null,O.P=!0,Ca(O,h)}t.Za=function(){this.C!=null&&(this.C=null,as(this),Ie(this),kn(19))};function vt(h){h.C!=null&&(l.clearTimeout(h.C),h.C=null)}function _t(h,w){var O=null;if(h.g==w){vt(h),We(h),h.g=null;var Z=2}else if(Xs(h.h,w))O=w.D,Fn(h.h,w),Z=1;else return;if(h.G!=0){if(w.o)if(Z==1){O=w.m?w.m.length:0,w=Date.now()-w.F;var ve=h.B;Z=Jn(),Tt(Z,new rs(Z,O)),y(h)}else ke(h);else if(ve=w.s,ve==3||ve==0&&0<w.X||!(Z==1&&$(h,w)||Z==2&&Ie(h)))switch(O&&0<O.length&&(w=h.h,w.i=w.i.concat(O)),ve){case 1:rn(h,5);break;case 4:rn(h,10);break;case 3:rn(h,6);break;default:rn(h,2)}}}function Yt(h,w){let O=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(O*=2),O*w}function rn(h,w){if(h.j.info("Error code "+w),w==2){var O=g(h.fb,h),Z=h.Xa;const ve=!Z;Z=new on(Z||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||yo(Z,"https"),Ra(Z),ve?Hu(Z.toString(),O):Wu(Z.toString(),O)}else kn(2);h.G=0,h.l&&h.l.sa(w),Un(h),Fl(h)}t.fb=function(h){h?(this.j.info("Successfully pinged google.com"),kn(2)):(this.j.info("Failed to ping google.com"),kn(1))};function Un(h){if(h.G=0,h.ka=[],h.l){const w=Il(h.h);(w.length!=0||h.i.length!=0)&&(C(h.ka,w),C(h.ka,h.i),h.h.i.length=0,k(h.i),h.i.length=0),h.l.ra()}}function ln(h,w,O){var Z=O instanceof on?ci(O):new on(O);if(Z.g!="")w&&(Z.g=w+"."+Z.g),xo(Z,Z.s);else{var ve=l.location;Z=ve.protocol,w=w?w+"."+ve.hostname:ve.hostname,ve=+ve.port;var _e=new on(null);Z&&yo(_e,Z),w&&(_e.g=w),ve&&xo(_e,ve),O&&(_e.l=O),Z=_e}return O=h.D,w=h.ya,O&&w&&Bt(Z,O,w),Bt(Z,"VER",h.la),de(h,Z),Z}function Wn(h,w,O){if(w&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return w=h.Ca&&!h.pa?new gn(new wo({eb:O})):new gn(h.pa),w.Ha(h.J),w}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Vn(){}t=Vn.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Gn(){}Gn.prototype.g=function(h,w){return new wn(h,w)};function wn(h,w){nt.call(this),this.g=new Ml(w),this.l=h,this.h=w&&w.messageUrlParams||null,h=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(h?h["X-WebChannel-Content-Type"]=w.messageContentType:h={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.va&&(h?h["X-WebChannel-Client-Profile"]=w.va:h={"X-WebChannel-Client-Profile":w.va}),this.g.S=h,(h=w&&w.Sb)&&!I(h)&&(this.g.m=h),this.v=w&&w.supportsCrossDomainXhr||!1,this.u=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!I(w)&&(this.g.D=w,h=this.h,h!==null&&w in h&&(h=this.h,w in h&&delete h[w])),this.j=new Oi(this)}S(wn,nt),wn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},wn.prototype.close=function(){Eo(this.g)},wn.prototype.o=function(h){var w=this.g;if(typeof h=="string"){var O={};O.__data__=h,h=O}else this.u&&(O={},O.__data__=Nt(h),h=O);w.i.push(new Sl(w.Ya++,h)),w.G==3&&y(w)},wn.prototype.N=function(){this.g.l=null,delete this.j,Eo(this.g),delete this.g,wn.aa.N.call(this)};function Pr(h){nn.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var w=h.__sm__;if(w){e:{for(const O in w){h=O;break e}h=void 0}(this.i=h)&&(h=this.i,w=w!==null&&h in w?w[h]:void 0),this.data=w}else this.data=h}S(Pr,nn);function Ul(){xt.call(this),this.status=1}S(Ul,xt);function Oi(h){this.g=h}S(Oi,Vn),Oi.prototype.ua=function(){Tt(this.g,"a")},Oi.prototype.ta=function(h){Tt(this.g,new Pr(h))},Oi.prototype.sa=function(h){Tt(this.g,new Ul)},Oi.prototype.ra=function(){Tt(this.g,"b")},Gn.prototype.createWebChannel=Gn.prototype.g,wn.prototype.send=wn.prototype.o,wn.prototype.open=wn.prototype.m,wn.prototype.close=wn.prototype.close,B4=function(){return new Gn},V4=function(){return Jn()},U4=Mt,Tv={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Hr.NO_ERROR=0,Hr.TIMEOUT=8,Hr.HTTP_ERROR=6,tm=Hr,Pi.COMPLETE="complete",F4=Pi,Rn.EventType=Sn,Sn.OPEN="a",Sn.CLOSE="b",Sn.ERROR="c",Sn.MESSAGE="d",nt.prototype.listen=nt.prototype.K,Ad=Rn,gn.prototype.listenOnce=gn.prototype.L,gn.prototype.getLastError=gn.prototype.Ka,gn.prototype.getLastErrorCode=gn.prototype.Ba,gn.prototype.getStatus=gn.prototype.Z,gn.prototype.getResponseJson=gn.prototype.Oa,gn.prototype.getResponseText=gn.prototype.oa,gn.prototype.send=gn.prototype.ea,gn.prototype.setWithCredentials=gn.prototype.Ha,M4=gn}).apply(typeof Af<"u"?Af:typeof self<"u"?self:typeof window<"u"?window:{});const _b="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ni.UNAUTHENTICATED=new ni(null),ni.GOOGLE_CREDENTIALS=new ni("google-credentials-uid"),ni.FIRST_PARTY=new ni("first-party-uid"),ni.MOCK_USER=new ni("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lu="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fc=new Q1("@firebase/firestore");function gd(){return fc.logLevel}function Je(t,...e){if(fc.logLevel<=Wt.DEBUG){const n=e.map(dy);fc.debug(`Firestore (${Lu}): ${t}`,...n)}}function co(t,...e){if(fc.logLevel<=Wt.ERROR){const n=e.map(dy);fc.error(`Firestore (${Lu}): ${t}`,...n)}}function _u(t,...e){if(fc.logLevel<=Wt.WARN){const n=e.map(dy);fc.warn(`Firestore (${Lu}): ${t}`,...n)}}function dy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kt(t="Unexpected state"){const e=`FIRESTORE (${Lu}) INTERNAL ASSERTION FAILED: `+t;throw co(e),new Error(e)}function mn(t,e){t||kt()}function It(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class He extends Ea{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class y6{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ni.UNAUTHENTICATED))}shutdown(){}}class x6{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class b6{constructor(e){this.t=e,this.currentUser=ni.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){mn(this.o===void 0);let r=this.i;const i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let s=new to;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new to,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},l=c=>{Je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Je("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new to)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(mn(typeof r.accessToken=="string"),new $4(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return mn(e===null||typeof e=="string"),new ni(e)}}class w6{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=ni.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class N6{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new w6(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(ni.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class _6{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class E6{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){mn(this.o===void 0);const r=s=>{s.error!=null&&Je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,Je("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(mn(typeof n.token=="string"),this.R=n.token,new _6(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A6(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=A6(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function tn(t,e){return t<e?-1:t>e?1:0}function Eu(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new He(Ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new He(Ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new He(Ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new He(Ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ft.fromMillis(Date.now())}static fromDate(e){return ft.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new ft(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?tn(this.nanoseconds,e.nanoseconds):tn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ct(e)}static min(){return new Ct(new ft(0,0))}static max(){return new Ct(new ft(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uh{constructor(e,n,r){n===void 0?n=0:n>e.length&&kt(),r===void 0?r=e.length-n:r>e.length-n&&kt(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return uh.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof uh?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Cn extends uh{construct(e,n,r){return new Cn(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new He(Ce.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Cn(n)}static emptyPath(){return new Cn([])}}const S6=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ur extends uh{construct(e,n,r){return new Ur(e,n,r)}static isValidIdentifier(e){return S6.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ur.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ur(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new He(Ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new He(Ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new He(Ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new He(Ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ur(n)}static emptyPath(){return new Ur([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.path=e}static fromPath(e){return new mt(Cn.fromString(e))}static fromName(e){return new mt(Cn.fromString(e).popFirst(5))}static empty(){return new mt(Cn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Cn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Cn.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new mt(new Cn(e.slice()))}}function k6(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ct.fromTimestamp(r===1e9?new ft(n+1,0):new ft(n,r));return new pl(i,mt.empty(),e)}function T6(t){return new pl(t.readTime,t.key,-1)}class pl{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new pl(Ct.min(),mt.empty(),-1)}static max(){return new pl(Ct.max(),mt.empty(),-1)}}function j6(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=mt.comparator(t.documentKey,e.documentKey),n!==0?n:tn(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class I6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ph(t){if(t.code!==Ce.FAILED_PRECONDITION||t.message!==C6)throw t;Je("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&kt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new De((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof De?n:De.resolve(n)}catch(n){return De.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):De.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):De.reject(n)}static resolve(e){return new De((n,r)=>{n(e)})}static reject(e){return new De((n,r)=>{r(e)})}static waitFor(e){return new De((n,r)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=De.resolve(!1);for(const r of e)n=n.next(i=>i?De.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new De((r,i)=>{const s=e.length,o=new Array(s);let l=0;for(let c=0;c<s;c++){const u=c;n(e[u]).next(f=>{o[u]=f,++l,l===s&&r(o)},f=>i(f))}})}static doWhile(e,n){return new De((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function P6(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Rh(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}hy.oe=-1;function Lp(t){return t==null}function Gm(t){return t===0&&1/t==-1/0}function R6(t){return typeof t=="number"&&Number.isInteger(t)&&!Gm(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eb(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function wc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function q4(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e,n){this.comparator=e,this.root=n||Fr.EMPTY}insert(e,n){return new Hn(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Fr.BLACK,null,null))}remove(e){return new Hn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Sf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Sf(this.root,e,this.comparator,!1)}getReverseIterator(){return new Sf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Sf(this.root,e,this.comparator,!0)}}class Sf{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Fr{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Fr.RED,this.left=i??Fr.EMPTY,this.right=s??Fr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Fr(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Fr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Fr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Fr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Fr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw kt();const e=this.left.check();if(e!==this.right.check())throw kt();return e+(this.isRed()?0:1)}}Fr.EMPTY=null,Fr.RED=!0,Fr.BLACK=!1;Fr.EMPTY=new class{constructor(){this.size=0}get key(){throw kt()}get value(){throw kt()}get color(){throw kt()}get left(){throw kt()}get right(){throw kt()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Fr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(e){this.comparator=e,this.data=new Hn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ab(this.data.getIterator())}getIteratorFrom(e){return new Ab(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Br)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Br(this.comparator);return n.data=e,n}}class Ab{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e){this.fields=e,e.sort(Ur.comparator)}static empty(){return new Yi([])}unionWith(e){let n=new Br(Ur.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Yi(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Eu(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new H4("Invalid base64 string: "+s):s}}(e);return new zr(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new zr(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}zr.EMPTY_BYTE_STRING=new zr("");const L6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function gl(t){if(mn(!!t),typeof t=="string"){let e=0;const n=L6.exec(t);if(mn(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ir(t.seconds),nanos:ir(t.nanos)}}function ir(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function mc(t){return typeof t=="string"?zr.fromBase64String(t):zr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fy(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function my(t){const e=t.mapValue.fields.__previous_value__;return fy(e)?my(e):e}function dh(t){const e=gl(t.mapValue.fields.__local_write_time__.timestampValue);return new ft(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D6{constructor(e,n,r,i,s,o,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class hh{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new hh("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof hh&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kf={mapValue:{}};function pc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fy(t)?4:M6(t)?9007199254740991:O6(t)?10:11:kt()}function wa(t,e){if(t===e)return!0;const n=pc(t);if(n!==pc(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return dh(t).isEqual(dh(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=gl(i.timestampValue),l=gl(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return mc(i.bytesValue).isEqual(mc(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return ir(i.geoPointValue.latitude)===ir(s.geoPointValue.latitude)&&ir(i.geoPointValue.longitude)===ir(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ir(i.integerValue)===ir(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=ir(i.doubleValue),l=ir(s.doubleValue);return o===l?Gm(o)===Gm(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Eu(t.arrayValue.values||[],e.arrayValue.values||[],wa);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(Eb(o)!==Eb(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!wa(o[c],l[c])))return!1;return!0}(t,e);default:return kt()}}function fh(t,e){return(t.values||[]).find(n=>wa(n,e))!==void 0}function Au(t,e){if(t===e)return 0;const n=pc(t),r=pc(e);if(n!==r)return tn(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return tn(t.booleanValue,e.booleanValue);case 2:return function(s,o){const l=ir(s.integerValue||s.doubleValue),c=ir(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return Sb(t.timestampValue,e.timestampValue);case 4:return Sb(dh(t),dh(e));case 5:return tn(t.stringValue,e.stringValue);case 6:return function(s,o){const l=mc(s),c=mc(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const f=tn(l[u],c[u]);if(f!==0)return f}return tn(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const l=tn(ir(s.latitude),ir(o.latitude));return l!==0?l:tn(ir(s.longitude),ir(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return kb(t.arrayValue,e.arrayValue);case 10:return function(s,o){var l,c,u,f;const v=s.fields||{},g=o.fields||{},p=(l=v.value)===null||l===void 0?void 0:l.arrayValue,S=(c=g.value)===null||c===void 0?void 0:c.arrayValue,k=tn(((u=p==null?void 0:p.values)===null||u===void 0?void 0:u.length)||0,((f=S==null?void 0:S.values)===null||f===void 0?void 0:f.length)||0);return k!==0?k:kb(p,S)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===kf.mapValue&&o===kf.mapValue)return 0;if(s===kf.mapValue)return 1;if(o===kf.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),u=o.fields||{},f=Object.keys(u);c.sort(),f.sort();for(let v=0;v<c.length&&v<f.length;++v){const g=tn(c[v],f[v]);if(g!==0)return g;const p=Au(l[c[v]],u[f[v]]);if(p!==0)return p}return tn(c.length,f.length)}(t.mapValue,e.mapValue);default:throw kt()}}function Sb(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return tn(t,e);const n=gl(t),r=gl(e),i=tn(n.seconds,r.seconds);return i!==0?i:tn(n.nanos,r.nanos)}function kb(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Au(n[i],r[i]);if(s)return s}return tn(n.length,r.length)}function Su(t){return jv(t)}function jv(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=gl(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return mc(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return mt.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=jv(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${jv(n.fields[o])}`;return i+"}"}(t.mapValue):kt()}function Tb(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Cv(t){return!!t&&"integerValue"in t}function py(t){return!!t&&"arrayValue"in t}function jb(t){return!!t&&"nullValue"in t}function Cb(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function nm(t){return!!t&&"mapValue"in t}function O6(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Ud(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return wc(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ud(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ud(t.arrayValue.values[n]);return e}return Object.assign({},t)}function M6(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e){this.value=e}static empty(){return new Ai({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!nm(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ud(n)}setAll(e){let n=Ur.emptyPath(),r={},i=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=l.popLast()}o?r[l.lastSegment()]=Ud(o):i.push(l.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());nm(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return wa(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];nm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){wc(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Ai(Ud(this.value))}}function W4(t){const e=[];return wc(t.fields,(n,r)=>{const i=new Ur([n]);if(nm(r)){const s=W4(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Yi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e,n,r,i,s,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new ii(e,0,Ct.min(),Ct.min(),Ct.min(),Ai.empty(),0)}static newFoundDocument(e,n,r,i){return new ii(e,1,n,Ct.min(),r,i,0)}static newNoDocument(e,n){return new ii(e,2,n,Ct.min(),Ct.min(),Ai.empty(),0)}static newUnknownDocument(e,n){return new ii(e,3,n,Ct.min(),Ct.min(),Ai.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ct.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ai.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ai.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ct.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ii&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ii(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(e,n){this.position=e,this.inclusive=n}}function Ib(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=mt.comparator(mt.fromName(o.referenceValue),n.key):r=Au(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Pb(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!wa(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(e,n="asc"){this.field=e,this.dir=n}}function F6(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{}class pr extends G4{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new V6(e,n,r):n==="array-contains"?new z6(e,r):n==="in"?new q6(e,r):n==="not-in"?new H6(e,r):n==="array-contains-any"?new W6(e,r):new pr(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new B6(e,r):new $6(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Au(n,this.value)):n!==null&&pc(this.value)===pc(n)&&this.matchesComparison(Au(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return kt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Bs extends G4{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Bs(e,n)}matches(e){return K4(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function K4(t){return t.op==="and"}function Y4(t){return U6(t)&&K4(t)}function U6(t){for(const e of t.filters)if(e instanceof Bs)return!1;return!0}function Iv(t){if(t instanceof pr)return t.field.canonicalString()+t.op.toString()+Su(t.value);if(Y4(t))return t.filters.map(e=>Iv(e)).join(",");{const e=t.filters.map(n=>Iv(n)).join(",");return`${t.op}(${e})`}}function Q4(t,e){return t instanceof pr?function(r,i){return i instanceof pr&&r.op===i.op&&r.field.isEqual(i.field)&&wa(r.value,i.value)}(t,e):t instanceof Bs?function(r,i){return i instanceof Bs&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,l)=>s&&Q4(o,i.filters[l]),!0):!1}(t,e):void kt()}function X4(t){return t instanceof pr?function(n){return`${n.field.canonicalString()} ${n.op} ${Su(n.value)}`}(t):t instanceof Bs?function(n){return n.op.toString()+" {"+n.getFilters().map(X4).join(" ,")+"}"}(t):"Filter"}class V6 extends pr{constructor(e,n,r){super(e,n,r),this.key=mt.fromName(r.referenceValue)}matches(e){const n=mt.comparator(e.key,this.key);return this.matchesComparison(n)}}class B6 extends pr{constructor(e,n){super(e,"in",n),this.keys=J4("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class $6 extends pr{constructor(e,n){super(e,"not-in",n),this.keys=J4("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function J4(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>mt.fromName(r.referenceValue))}class z6 extends pr{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return py(n)&&fh(n.arrayValue,this.value)}}class q6 extends pr{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&fh(this.value.arrayValue,n)}}class H6 extends pr{constructor(e,n){super(e,"not-in",n)}matches(e){if(fh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!fh(this.value.arrayValue,n)}}class W6 extends pr{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!py(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>fh(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G6{constructor(e,n=null,r=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function Rb(t,e=null,n=[],r=[],i=null,s=null,o=null){return new G6(t,e,n,r,i,s,o)}function gy(t){const e=It(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Iv(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Lp(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Su(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Su(r)).join(",")),e.ue=n}return e.ue}function vy(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!F6(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Q4(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Pb(t.startAt,e.startAt)&&Pb(t.endAt,e.endAt)}function Pv(t){return mt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,n=null,r=[],i=[],s=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function K6(t,e,n,r,i,s,o,l){return new Du(t,e,n,r,i,s,o,l)}function Dp(t){return new Du(t)}function Lb(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Z4(t){return t.collectionGroup!==null}function Vd(t){const e=It(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Br(Ur.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new mh(s,r))}),n.has(Ur.keyField().canonicalString())||e.ce.push(new mh(Ur.keyField(),r))}return e.ce}function xa(t){const e=It(t);return e.le||(e.le=Y6(e,Vd(t))),e.le}function Y6(t,e){if(t.limitType==="F")return Rb(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new mh(i.field,s)});const n=t.endAt?new Km(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Km(t.startAt.position,t.startAt.inclusive):null;return Rb(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Rv(t,e){const n=t.filters.concat([e]);return new Du(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ym(t,e,n){return new Du(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Op(t,e){return vy(xa(t),xa(e))&&t.limitType===e.limitType}function eE(t){return`${gy(xa(t))}|lt:${t.limitType}`}function Dc(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>X4(i)).join(", ")}]`),Lp(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Su(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Su(i)).join(",")),`Target(${r})`}(xa(t))}; limitType=${t.limitType})`}function Mp(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):mt.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Vd(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,l,c){const u=Ib(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,Vd(r),i)||r.endAt&&!function(o,l,c){const u=Ib(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,Vd(r),i))}(t,e)}function Q6(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function tE(t){return(e,n)=>{let r=!1;for(const i of Vd(t)){const s=X6(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function X6(t,e,n){const r=t.field.isKeyField()?mt.comparator(e.key,n.key):function(s,o,l){const c=o.data.field(s),u=l.data.field(s);return c!==null&&u!==null?Au(c,u):kt()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return kt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){wc(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return q4(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J6=new Hn(mt.comparator);function uo(){return J6}const nE=new Hn(mt.comparator);function Sd(...t){let e=nE;for(const n of t)e=e.insert(n.key,n);return e}function rE(t){let e=nE;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ec(){return Bd()}function iE(){return Bd()}function Bd(){return new Ou(t=>t.toString(),(t,e)=>t.isEqual(e))}const Z6=new Hn(mt.comparator),eP=new Br(mt.comparator);function $t(...t){let e=eP;for(const n of t)e=e.add(n);return e}const tP=new Br(tn);function nP(){return tP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Gm(e)?"-0":e}}function sE(t){return{integerValue:""+t}}function rP(t,e){return R6(e)?sE(e):yy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(){this._=void 0}}function iP(t,e,n){return t instanceof Qm?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&fy(s)&&(s=my(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof ph?oE(t,e):t instanceof gh?lE(t,e):function(i,s){const o=aE(i,s),l=Db(o)+Db(i.Pe);return Cv(o)&&Cv(i.Pe)?sE(l):yy(i.serializer,l)}(t,e)}function sP(t,e,n){return t instanceof ph?oE(t,e):t instanceof gh?lE(t,e):n}function aE(t,e){return t instanceof Xm?function(r){return Cv(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Qm extends Fp{}class ph extends Fp{constructor(e){super(),this.elements=e}}function oE(t,e){const n=cE(e);for(const r of t.elements)n.some(i=>wa(i,r))||n.push(r);return{arrayValue:{values:n}}}class gh extends Fp{constructor(e){super(),this.elements=e}}function lE(t,e){let n=cE(e);for(const r of t.elements)n=n.filter(i=>!wa(i,r));return{arrayValue:{values:n}}}class Xm extends Fp{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Db(t){return ir(t.integerValue||t.doubleValue)}function cE(t){return py(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function aP(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ph&&i instanceof ph||r instanceof gh&&i instanceof gh?Eu(r.elements,i.elements,wa):r instanceof Xm&&i instanceof Xm?wa(r.Pe,i.Pe):r instanceof Qm&&i instanceof Qm}(t.transform,e.transform)}class oP{constructor(e,n){this.version=e,this.transformResults=n}}class gs{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new gs}static exists(e){return new gs(void 0,e)}static updateTime(e){return new gs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function rm(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Up{}function uE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new xy(t.key,gs.none()):new Lh(t.key,t.data,gs.none());{const n=t.data,r=Ai.empty();let i=new Br(Ur.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new El(t.key,r,new Yi(i.toArray()),gs.none())}}function lP(t,e,n){t instanceof Lh?function(i,s,o){const l=i.value.clone(),c=Mb(i.fieldTransforms,s,o.transformResults);l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof El?function(i,s,o){if(!rm(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=Mb(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(dE(i)),c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function $d(t,e,n,r){return t instanceof Lh?function(s,o,l,c){if(!rm(s.precondition,o))return l;const u=s.value.clone(),f=Fb(s.fieldTransforms,c,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof El?function(s,o,l,c){if(!rm(s.precondition,o))return l;const u=Fb(s.fieldTransforms,c,o),f=o.data;return f.setAll(dE(s)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(v=>v.field))}(t,e,n,r):function(s,o,l){return rm(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function cP(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=aE(r.transform,i||null);s!=null&&(n===null&&(n=Ai.empty()),n.set(r.field,s))}return n||null}function Ob(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Eu(r,i,(s,o)=>aP(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Lh extends Up{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class El extends Up{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function dE(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Mb(t,e,n){const r=new Map;mn(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,l=e.data.field(s.field);r.set(s.field,sP(o,l,n[i]))}return r}function Fb(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,iP(s,o,e))}return r}class xy extends Up{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class uP extends Up{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&lP(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=$d(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=$d(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=iE();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=n.has(i.key)?null:l;const c=uE(o,l);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Ct.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),$t())}isEqual(e){return this.batchId===e.batchId&&Eu(this.mutations,e.mutations,(n,r)=>Ob(n,r))&&Eu(this.baseMutations,e.baseMutations,(n,r)=>Ob(n,r))}}class by{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){mn(e.mutations.length===r.length);let i=function(){return Z6}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new by(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dr,Xt;function mP(t){switch(t){default:return kt();case Ce.CANCELLED:case Ce.UNKNOWN:case Ce.DEADLINE_EXCEEDED:case Ce.RESOURCE_EXHAUSTED:case Ce.INTERNAL:case Ce.UNAVAILABLE:case Ce.UNAUTHENTICATED:return!1;case Ce.INVALID_ARGUMENT:case Ce.NOT_FOUND:case Ce.ALREADY_EXISTS:case Ce.PERMISSION_DENIED:case Ce.FAILED_PRECONDITION:case Ce.ABORTED:case Ce.OUT_OF_RANGE:case Ce.UNIMPLEMENTED:case Ce.DATA_LOSS:return!0}}function hE(t){if(t===void 0)return co("GRPC error has no .code"),Ce.UNKNOWN;switch(t){case dr.OK:return Ce.OK;case dr.CANCELLED:return Ce.CANCELLED;case dr.UNKNOWN:return Ce.UNKNOWN;case dr.DEADLINE_EXCEEDED:return Ce.DEADLINE_EXCEEDED;case dr.RESOURCE_EXHAUSTED:return Ce.RESOURCE_EXHAUSTED;case dr.INTERNAL:return Ce.INTERNAL;case dr.UNAVAILABLE:return Ce.UNAVAILABLE;case dr.UNAUTHENTICATED:return Ce.UNAUTHENTICATED;case dr.INVALID_ARGUMENT:return Ce.INVALID_ARGUMENT;case dr.NOT_FOUND:return Ce.NOT_FOUND;case dr.ALREADY_EXISTS:return Ce.ALREADY_EXISTS;case dr.PERMISSION_DENIED:return Ce.PERMISSION_DENIED;case dr.FAILED_PRECONDITION:return Ce.FAILED_PRECONDITION;case dr.ABORTED:return Ce.ABORTED;case dr.OUT_OF_RANGE:return Ce.OUT_OF_RANGE;case dr.UNIMPLEMENTED:return Ce.UNIMPLEMENTED;case dr.DATA_LOSS:return Ce.DATA_LOSS;default:return kt()}}(Xt=dr||(dr={}))[Xt.OK=0]="OK",Xt[Xt.CANCELLED=1]="CANCELLED",Xt[Xt.UNKNOWN=2]="UNKNOWN",Xt[Xt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xt[Xt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xt[Xt.NOT_FOUND=5]="NOT_FOUND",Xt[Xt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xt[Xt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xt[Xt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xt[Xt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xt[Xt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xt[Xt.ABORTED=10]="ABORTED",Xt[Xt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xt[Xt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xt[Xt.INTERNAL=13]="INTERNAL",Xt[Xt.UNAVAILABLE=14]="UNAVAILABLE",Xt[Xt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gP=new rc([4294967295,4294967295],0);function Ub(t){const e=pP().encode(t),n=new O4;return n.update(e),new Uint8Array(n.digest())}function Vb(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new rc([n,r],0),new rc([i,s],0)]}class wy{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new kd(`Invalid padding: ${n}`);if(r<0)throw new kd(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new kd(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new kd(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=rc.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(rc.fromNumber(r)));return i.compare(gP)===1&&(i=new rc([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Ub(e),[r,i]=Vb(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new wy(s,i,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=Ub(e),[r,i]=Vb(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class kd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Dh.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Vp(Ct.min(),i,new Hn(tn),uo(),$t())}}class Dh{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Dh(r,n,$t(),$t(),$t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class im{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class fE{constructor(e,n){this.targetId=e,this.me=n}}class mE{constructor(e,n,r=zr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class Bb{constructor(){this.fe=0,this.ge=zb(),this.pe=zr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=$t(),n=$t(),r=$t();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:kt()}}),new Dh(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=zb()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,mn(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class vP{constructor(e){this.Le=e,this.Be=new Map,this.ke=uo(),this.qe=$b(),this.Qe=new Hn(tn)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:kt()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(Pv(s))if(r===0){const o=new mt(s.path);this.Ue(n,o,ii.newNoDocument(o,Ct.min()))}else mn(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,l;try{o=mc(r).toUint8Array()}catch(c){if(c instanceof H4)return _u("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new wy(o,i,s)}catch(c){return _u(c instanceof kd?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&Pv(l.target)){const c=new mt(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,ii.newNoDocument(c,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=$t();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new Vp(e,n,this.Qe,this.ke,r);return this.ke=uo(),this.qe=$b(),this.Qe=new Hn(tn),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Bb,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Br(tn),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||Je("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Bb),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function $b(){return new Hn(mt.comparator)}function zb(){return new Hn(mt.comparator)}const yP={asc:"ASCENDING",desc:"DESCENDING"},xP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bP={and:"AND",or:"OR"};class wP{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Lv(t,e){return t.useProto3Json||Lp(e)?e:{value:e}}function Jm(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pE(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function NP(t,e){return Jm(t,e.toTimestamp())}function ba(t){return mn(!!t),Ct.fromTimestamp(function(n){const r=gl(n);return new ft(r.seconds,r.nanos)}(t))}function Ny(t,e){return Dv(t,e).canonicalString()}function Dv(t,e){const n=function(i){return new Cn(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function gE(t){const e=Cn.fromString(t);return mn(wE(e)),e}function Ov(t,e){return Ny(t.databaseId,e.path)}function Jg(t,e){const n=gE(e);if(n.get(1)!==t.databaseId.projectId)throw new He(Ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new He(Ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new mt(yE(n))}function vE(t,e){return Ny(t.databaseId,e)}function _P(t){const e=gE(t);return e.length===4?Cn.emptyPath():yE(e)}function Mv(t){return new Cn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function yE(t){return mn(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function qb(t,e,n){return{name:Ov(t,e),fields:n.value.mapValue.fields}}function EP(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:kt()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(mn(f===void 0||typeof f=="string"),zr.fromBase64String(f||"")):(mn(f===void 0||f instanceof Buffer||f instanceof Uint8Array),zr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const f=u.code===void 0?Ce.UNKNOWN:hE(u.code);return new He(f,u.message||"")}(o);n=new mE(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Jg(t,r.document.name),s=ba(r.document.updateTime),o=r.document.createTime?ba(r.document.createTime):Ct.min(),l=new Ai({mapValue:{fields:r.document.fields}}),c=ii.newFoundDocument(i,s,o,l),u=r.targetIds||[],f=r.removedTargetIds||[];n=new im(u,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Jg(t,r.document),s=r.readTime?ba(r.readTime):Ct.min(),o=ii.newNoDocument(i,s),l=r.removedTargetIds||[];n=new im([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Jg(t,r.document),s=r.removedTargetIds||[];n=new im([],s,i,null)}else{if(!("filter"in e))return kt();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new fP(i,s),l=r.targetId;n=new fE(l,o)}}return n}function AP(t,e){let n;if(e instanceof Lh)n={update:qb(t,e.key,e.value)};else if(e instanceof xy)n={delete:Ov(t,e.key)};else if(e instanceof El)n={update:qb(t,e.key,e.data),updateMask:LP(e.fieldMask)};else{if(!(e instanceof uP))return kt();n={verify:Ov(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const l=o.transform;if(l instanceof Qm)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof ph)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof gh)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Xm)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw kt()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:NP(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:kt()}(t,e.precondition)),n}function SP(t,e){return t&&t.length>0?(mn(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?ba(i.updateTime):ba(s);return o.isEqual(Ct.min())&&(o=ba(s)),new oP(o,i.transformResults||[])}(n,e))):[]}function kP(t,e){return{documents:[vE(t,e.path)]}}function TP(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=vE(t,i);const s=function(u){if(u.length!==0)return bE(Bs.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:Oc(g.field),direction:IP(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Lv(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:i}}function jP(t){let e=_P(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){mn(r===1);const f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(v){const g=xE(v);return g instanceof Bs&&Y4(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(v){return v.map(g=>function(S){return new mh(Mc(S.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(g))}(n.orderBy));let l=null;n.limit&&(l=function(v){let g;return g=typeof v=="object"?v.value:v,Lp(g)?null:g}(n.limit));let c=null;n.startAt&&(c=function(v){const g=!!v.before,p=v.values||[];return new Km(p,g)}(n.startAt));let u=null;return n.endAt&&(u=function(v){const g=!v.before,p=v.values||[];return new Km(p,g)}(n.endAt)),K6(e,i,o,s,l,"F",c,u)}function CP(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return kt()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function xE(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Mc(n.unaryFilter.field);return pr.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Mc(n.unaryFilter.field);return pr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Mc(n.unaryFilter.field);return pr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Mc(n.unaryFilter.field);return pr.create(o,"!=",{nullValue:"NULL_VALUE"});default:return kt()}}(t):t.fieldFilter!==void 0?function(n){return pr.create(Mc(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return kt()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Bs.create(n.compositeFilter.filters.map(r=>xE(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return kt()}}(n.compositeFilter.op))}(t):kt()}function IP(t){return yP[t]}function PP(t){return xP[t]}function RP(t){return bP[t]}function Oc(t){return{fieldPath:t.canonicalString()}}function Mc(t){return Ur.fromServerFormat(t.fieldPath)}function bE(t){return t instanceof pr?function(n){if(n.op==="=="){if(Cb(n.value))return{unaryFilter:{field:Oc(n.field),op:"IS_NAN"}};if(jb(n.value))return{unaryFilter:{field:Oc(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Cb(n.value))return{unaryFilter:{field:Oc(n.field),op:"IS_NOT_NAN"}};if(jb(n.value))return{unaryFilter:{field:Oc(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Oc(n.field),op:PP(n.op),value:n.value}}}(t):t instanceof Bs?function(n){const r=n.getFilters().map(i=>bE(i));return r.length===1?r[0]:{compositeFilter:{op:RP(n.op),filters:r}}}(t):kt()}function LP(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function wE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e,n,r,i,s=Ct.min(),o=Ct.min(),l=zr.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Jo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Jo(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Jo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Jo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e){this.ct=e}}function OP(t){const e=jP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ym(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(){this.un=new FP}addToCollectionParentIndex(e,n){return this.un.add(n),De.resolve()}getCollectionParents(e,n){return De.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return De.resolve()}deleteFieldIndex(e,n){return De.resolve()}deleteAllFieldIndexes(e){return De.resolve()}createTargetIndexes(e,n){return De.resolve()}getDocumentsMatchingTarget(e,n){return De.resolve(null)}getIndexType(e,n){return De.resolve(0)}getFieldIndexes(e,n){return De.resolve([])}getNextCollectionGroupToUpdate(e){return De.resolve(null)}getMinOffset(e,n){return De.resolve(pl.min())}getMinOffsetFromCollectionGroup(e,n){return De.resolve(pl.min())}updateCollectionGroup(e,n,r){return De.resolve()}updateIndexEntries(e,n){return De.resolve()}}class FP{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Br(Cn.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Br(Cn.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ku(0)}static kn(){return new ku(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(){this.changes=new Ou(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ii.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?De.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&$d(r.mutation,i,Yi.empty(),ft.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,$t()).next(()=>r))}getLocalViewOfDocuments(e,n,r=$t()){const i=ec();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Sd();return s.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ec();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,$t()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,i){let s=uo();const o=Bd(),l=function(){return Bd()}();return n.forEach((c,u)=>{const f=r.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof El)?s=s.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),$d(f.mutation,u,f.mutation.getFieldMask(),ft.now())):o.set(u.key,Yi.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,f)=>o.set(u,f)),n.forEach((u,f)=>{var v;return l.set(u,new VP(f,(v=o.get(u))!==null&&v!==void 0?v:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Bd();let i=new Hn((o,l)=>o-l),s=$t();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let f=r.get(c)||Yi.empty();f=l.applyToLocalView(u,f),r.set(c,f);const v=(i.get(l.batchId)||$t()).add(c);i=i.insert(l.batchId,v)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,f=c.value,v=iE();f.forEach(g=>{if(!s.has(g)){const p=uE(n.get(g),r.get(g));p!==null&&v.set(g,p),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,v))}return De.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return mt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Z4(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):De.resolve(ec());let l=-1,c=s;return o.next(u=>De.forEach(u,(f,v)=>(l<v.largestBatchId&&(l=v.largestBatchId),s.get(f)?De.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{c=c.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,$t())).next(f=>({batchId:l,changes:rE(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new mt(n)).next(r=>{let i=Sd();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Sd();return this.indexManager.getCollectionParents(e,s).next(l=>De.forEach(l,c=>{const u=function(v,g){return new Du(g,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(f=>{f.forEach((v,g)=>{o=o.insert(v,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,u)=>{const f=u.getKey();o.get(f)===null&&(o=o.insert(f,ii.newInvalidDocument(f)))});let l=Sd();return o.forEach((c,u)=>{const f=s.get(c);f!==void 0&&$d(f.mutation,u,Yi.empty(),ft.now()),Mp(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return De.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:ba(i.createTime)}}(n)),De.resolve()}getNamedQuery(e,n){return De.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:OP(i.bundledQuery),readTime:ba(i.readTime)}}(n)),De.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(){this.overlays=new Hn(mt.comparator),this.Ir=new Map}getOverlay(e,n){return De.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ec();return De.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),De.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),De.resolve()}getOverlaysForCollection(e,n,r){const i=ec(),s=n.length+1,o=new mt(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return De.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Hn((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let f=s.get(u.largestBatchId);f===null&&(f=ec(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const l=ec(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,f)=>l.set(u,f)),!(l.size()>=i)););return De.resolve(l)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new hP(n,r));let s=this.Ir.get(n);s===void 0&&(s=$t(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qP{constructor(){this.sessionToken=zr.EMPTY_BYTE_STRING}getSessionToken(e){return De.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,De.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(){this.Tr=new Br(Tr.Er),this.dr=new Br(Tr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Tr(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Tr(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new mt(new Cn([])),r=new Tr(n,e),i=new Tr(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new mt(new Cn([])),r=new Tr(n,e),i=new Tr(n,e+1);let s=$t();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Tr(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Tr{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return mt.comparator(e.key,n.key)||tn(e.wr,n.wr)}static Ar(e,n){return tn(e.wr,n.wr)||mt.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Br(Tr.Er)}checkEmpty(e){return De.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new dP(s,n,r,i);this.mutationQueue.push(o);for(const l of i)this.br=this.br.add(new Tr(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return De.resolve(o)}lookupMutationBatch(e,n){return De.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return De.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return De.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return De.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Tr(n,0),i=new Tr(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const l=this.Dr(o.wr);s.push(l)}),De.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Br(tn);return n.forEach(i=>{const s=new Tr(i,0),o=new Tr(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{r=r.add(l.wr)})}),De.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;mt.isDocumentKey(s)||(s=s.child(""));const o=new Tr(new mt(s),0);let l=new Br(tn);return this.br.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(l=l.add(c.wr)),!0)},o),De.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){mn(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return De.forEach(n.mutations,i=>{const s=new Tr(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Tr(n,0),i=this.br.firstAfterOrEqual(r);return De.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,De.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(e){this.Mr=e,this.docs=function(){return new Hn(mt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return De.resolve(r?r.document.mutableCopy():ii.newInvalidDocument(n))}getEntries(e,n){let r=uo();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ii.newInvalidDocument(i))}),De.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=uo();const o=n.path,l=new mt(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:f}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||j6(T6(f),r)<=0||(i.has(f.key)||Mp(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return De.resolve(s)}getAllFromCollectionGroup(e,n,r,i){kt()}Or(e,n){return De.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new GP(this)}getSize(e){return De.resolve(this.size)}}class GP extends UP{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),De.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(e){this.persistence=e,this.Nr=new Ou(n=>gy(n),vy),this.lastRemoteSnapshotVersion=Ct.min(),this.highestTargetId=0,this.Lr=0,this.Br=new _y,this.targetCount=0,this.kr=ku.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),De.resolve()}getLastRemoteSnapshotVersion(e){return De.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return De.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),De.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),De.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ku(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,De.resolve()}updateTargetData(e,n){return this.Kn(n),De.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,De.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),De.waitFor(s).next(()=>i)}getTargetCount(e){return De.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return De.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),De.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),De.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),De.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return De.resolve(r)}containsKey(e,n){return De.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e,n){this.qr={},this.overlays={},this.Qr=new hy(0),this.Kr=!1,this.Kr=!0,this.$r=new qP,this.referenceDelegate=e(this),this.Ur=new KP(this),this.indexManager=new MP,this.remoteDocumentCache=function(i){return new WP(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new DP(n),this.Gr=new $P(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new zP,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new HP(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){Je("MemoryPersistence","Starting transaction:",e);const i=new QP(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return De.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class QP extends I6{constructor(e){super(),this.currentSequenceNumber=e}}class Ey{constructor(e){this.persistence=e,this.Jr=new _y,this.Yr=null}static Zr(e){return new Ey(e)}get Xr(){if(this.Yr)return this.Yr;throw kt()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),De.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),De.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),De.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return De.forEach(this.Xr,r=>{const i=mt.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,Ct.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return De.or([()=>De.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=$t(),i=$t();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Ay(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return RT()?8:P6(oi())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new XP;return this.Xi(e,n,o).next(l=>{if(s.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(gd()<=Wt.DEBUG&&Je("QueryEngine","SDK will not create cache indexes for query:",Dc(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),De.resolve()):(gd()<=Wt.DEBUG&&Je("QueryEngine","Query:",Dc(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(gd()<=Wt.DEBUG&&Je("QueryEngine","The SDK decides to create cache indexes for query:",Dc(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,xa(n))):De.resolve())}Yi(e,n){if(Lb(n))return De.resolve(null);let r=xa(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Ym(n,null,"F"),r=xa(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=$t(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ts(n,l);return this.ns(n,u,o,c.readTime)?this.Yi(e,Ym(n,null,"F")):this.rs(e,u,n,c)}))})))}Zi(e,n,r,i){return Lb(n)||i.isEqual(Ct.min())?De.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?De.resolve(null):(gd()<=Wt.DEBUG&&Je("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Dc(n)),this.rs(e,o,n,k6(i,-1)).next(l=>l))})}ts(e,n){let r=new Br(tE(e));return n.forEach((i,s)=>{Mp(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return gd()<=Wt.DEBUG&&Je("QueryEngine","Using full collection scan to execute query:",Dc(n)),this.Ji.getDocumentsMatchingQuery(e,n,pl.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new Hn(tn),this._s=new Ou(s=>gy(s),vy),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new BP(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function eR(t,e,n,r){return new ZP(t,e,n,r)}async function NE(t,e){const n=It(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],l=[];let c=$t();for(const u of i){o.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}for(const u of s){l.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}return n.localDocuments.getDocuments(r,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function tR(t,e){const n=It(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,f){const v=u.batch,g=v.keys();let p=De.resolve();return g.forEach(S=>{p=p.next(()=>f.getEntry(c,S)).next(k=>{const C=u.docVersions.get(S);mn(C!==null),k.version.compareTo(C)<0&&(v.applyToRemoteDocument(k,u),k.isValidDocument()&&(k.setReadTime(u.commitVersion),f.addEntry(k)))})}),p.next(()=>l.mutationQueue.removeMutationBatch(c,v))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=$t();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function _E(t){const e=It(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function nR(t,e){const n=It(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const l=[];e.targetChanges.forEach((f,v)=>{const g=i.get(v);if(!g)return;l.push(n.Ur.removeMatchingKeys(s,f.removedDocuments,v).next(()=>n.Ur.addMatchingKeys(s,f.addedDocuments,v)));let p=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(v)!==null?p=p.withResumeToken(zr.EMPTY_BYTE_STRING,Ct.min()).withLastLimboFreeSnapshotVersion(Ct.min()):f.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(f.resumeToken,r)),i=i.insert(v,p),function(k,C,b){return k.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(g,p,f)&&l.push(n.Ur.updateTargetData(s,p))});let c=uo(),u=$t();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),l.push(rR(s,o,e.documentUpdates).next(f=>{c=f.Ps,u=f.Is})),!r.isEqual(Ct.min())){const f=n.Ur.getLastRemoteSnapshotVersion(s).next(v=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(f)}return De.waitFor(l).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(n.os=i,s))}function rR(t,e,n){let r=$t(),i=$t();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=uo();return n.forEach((l,c)=>{const u=s.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(Ct.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Je("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function iR(t,e){const n=It(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function sR(t,e){const n=It(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,De.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new Jo(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Fv(t,e,n){const r=It(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Rh(o))throw o;Je("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function Hb(t,e,n){const r=It(t);let i=Ct.min(),s=$t();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,f){const v=It(c),g=v._s.get(f);return g!==void 0?De.resolve(v.os.get(g)):v.Ur.getTargetData(u,f)}(r,o,xa(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:Ct.min(),n?s:$t())).next(l=>(aR(r,Q6(e),l),{documents:l,Ts:s})))}function aR(t,e,n){let r=t.us.get(e)||Ct.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}class Wb{constructor(){this.activeTargetIds=nP()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class oR{constructor(){this.so=new Wb,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Wb,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lR{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Je("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Je("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tf=null;function Zg(){return Tf===null?Tf=function(){return 268435456+Math.round(2147483648*Math.random())}():Tf++,"0x"+Tf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uR{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr="WebChannelConnection";class dR extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const l=Zg(),c=this.xo(n,r.toUriEncodedString());Je("RestConnection",`Sending RPC '${n}' ${l}:`,c,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(n,c,u,i).then(f=>(Je("RestConnection",`Received RPC '${n}' ${l}: `,f),f),f=>{throw _u("RestConnection",`RPC '${n}' ${l} failed with error: `,f,"url: ",c,"request:",i),f})}Lo(n,r,i,s,o,l){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Lu}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=cR[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=Zg();return new Promise((o,l)=>{const c=new M4;c.setWithCredentials(!0),c.listenOnce(F4.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case tm.NO_ERROR:const f=c.getResponseJson();Je(Xr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case tm.TIMEOUT:Je(Xr,`RPC '${e}' ${s} timed out`),l(new He(Ce.DEADLINE_EXCEEDED,"Request time out"));break;case tm.HTTP_ERROR:const v=c.getStatus();if(Je(Xr,`RPC '${e}' ${s} failed with status:`,v,"response text:",c.getResponseText()),v>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);const p=g==null?void 0:g.error;if(p&&p.status&&p.message){const S=function(C){const b=C.toLowerCase().replace(/_/g,"-");return Object.values(Ce).indexOf(b)>=0?b:Ce.UNKNOWN}(p.status);l(new He(S,p.message))}else l(new He(Ce.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new He(Ce.UNAVAILABLE,"Connection failed."));break;default:kt()}}finally{Je(Xr,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);Je(Xr,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",u,r,15)})}Bo(e,n,r){const i=Zg(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=B4(),l=V4(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const f=s.join("");Je(Xr,`Creating RPC '${e}' stream ${i}: ${f}`,c);const v=o.createWebChannel(f,c);let g=!1,p=!1;const S=new uR({Io:C=>{p?Je(Xr,`Not sending because RPC '${e}' stream ${i} is closed:`,C):(g||(Je(Xr,`Opening RPC '${e}' stream ${i} transport.`),v.open(),g=!0),Je(Xr,`RPC '${e}' stream ${i} sending:`,C),v.send(C))},To:()=>v.close()}),k=(C,b,I)=>{C.listen(b,R=>{try{I(R)}catch(D){setTimeout(()=>{throw D},0)}})};return k(v,Ad.EventType.OPEN,()=>{p||(Je(Xr,`RPC '${e}' stream ${i} transport opened.`),S.yo())}),k(v,Ad.EventType.CLOSE,()=>{p||(p=!0,Je(Xr,`RPC '${e}' stream ${i} transport closed`),S.So())}),k(v,Ad.EventType.ERROR,C=>{p||(p=!0,_u(Xr,`RPC '${e}' stream ${i} transport errored:`,C),S.So(new He(Ce.UNAVAILABLE,"The operation could not be completed")))}),k(v,Ad.EventType.MESSAGE,C=>{var b;if(!p){const I=C.data[0];mn(!!I);const R=I,D=R.error||((b=R[0])===null||b===void 0?void 0:b.error);if(D){Je(Xr,`RPC '${e}' stream ${i} received error:`,D);const ee=D.status;let oe=function(N){const U=dr[N];if(U!==void 0)return hE(U)}(ee),V=D.message;oe===void 0&&(oe=Ce.INTERNAL,V="Unknown error status: "+ee+" with message "+D.message),p=!0,S.So(new He(oe,V)),v.close()}else Je(Xr,`RPC '${e}' stream ${i} received:`,I),S.bo(I)}}),k(l,U4.STAT_EVENT,C=>{C.stat===Tv.PROXY?Je(Xr,`RPC '${e}' stream ${i} detected buffering proxy`):C.stat===Tv.NOPROXY&&Je(Xr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.wo()},0),S}}function e0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bp(t){return new wP(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&Je("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(e,n,r,i,s,o,l,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new EE(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===Ce.RESOURCE_EXHAUSTED?(co(n.toString()),co("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===Ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new He(Ce.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Je("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(Je("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class hR extends AE{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=EP(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ct.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ct.min():o.readTime?ba(o.readTime):Ct.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Mv(this.serializer),n.addTarget=function(s,o){let l;const c=o.target;if(l=Pv(c)?{documents:kP(s,c)}:{query:TP(s,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=pE(s,o.resumeToken);const u=Lv(s,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(Ct.min())>0){l.readTime=Jm(s,o.snapshotVersion.toTimestamp());const u=Lv(s,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=CP(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Mv(this.serializer),n.removeTarget=e,this.a_(n)}}class fR extends AE{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return mn(!!e.streamToken),this.lastStreamToken=e.streamToken,mn(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){mn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=SP(e.writeResults,e.commitTime),r=ba(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Mv(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>AP(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new He(Ce.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,Dv(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new He(Ce.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,Dv(n,r),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new He(Ce.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class pR{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(co(n),this.D_=!1):Je("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{Nc(this)&&(Je("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=It(c);u.L_.add(4),await Oh(u),u.q_.set("Unknown"),u.L_.delete(4),await $p(u)}(this))})}),this.q_=new pR(r,i)}}async function $p(t){if(Nc(t))for(const e of t.B_)await e(!0)}async function Oh(t){for(const e of t.B_)await e(!1)}function SE(t,e){const n=It(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),jy(n)?Ty(n):Mu(n).r_()&&ky(n,e))}function Sy(t,e){const n=It(t),r=Mu(n);n.N_.delete(e),r.r_()&&kE(n,e),n.N_.size===0&&(r.r_()?r.o_():Nc(n)&&n.q_.set("Unknown"))}function ky(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ct.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Mu(t).A_(e)}function kE(t,e){t.Q_.xe(e),Mu(t).R_(e)}function Ty(t){t.Q_=new vP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Mu(t).start(),t.q_.v_()}function jy(t){return Nc(t)&&!Mu(t).n_()&&t.N_.size>0}function Nc(t){return It(t).L_.size===0}function TE(t){t.Q_=void 0}async function vR(t){t.q_.set("Online")}async function yR(t){t.N_.forEach((e,n)=>{ky(t,e)})}async function xR(t,e){TE(t),jy(t)?(t.q_.M_(e),Ty(t)):t.q_.set("Unknown")}async function bR(t,e,n){if(t.q_.set("Online"),e instanceof mE&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.N_.delete(l),i.Q_.removeTarget(l))}(t,e)}catch(r){Je("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Zm(t,r)}else if(e instanceof im?t.Q_.Ke(e):e instanceof fE?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Ct.min()))try{const r=await _E(t.localStore);n.compareTo(r)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const f=s.N_.get(u);f&&s.N_.set(u,f.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const f=s.N_.get(c);if(!f)return;s.N_.set(c,f.withResumeToken(zr.EMPTY_BYTE_STRING,f.snapshotVersion)),kE(s,c);const v=new Jo(f.target,c,u,f.sequenceNumber);ky(s,v)}),s.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Je("RemoteStore","Failed to raise snapshot:",r),await Zm(t,r)}}async function Zm(t,e,n){if(!Rh(e))throw e;t.L_.add(1),await Oh(t),t.q_.set("Offline"),n||(n=()=>_E(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Je("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await $p(t)})}function jE(t,e){return e().catch(n=>Zm(t,n,e))}async function zp(t){const e=It(t),n=vl(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;wR(e);)try{const i=await iR(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,NR(e,i)}catch(i){await Zm(e,i)}CE(e)&&IE(e)}function wR(t){return Nc(t)&&t.O_.length<10}function NR(t,e){t.O_.push(e);const n=vl(t);n.r_()&&n.V_&&n.m_(e.mutations)}function CE(t){return Nc(t)&&!vl(t).n_()&&t.O_.length>0}function IE(t){vl(t).start()}async function _R(t){vl(t).p_()}async function ER(t){const e=vl(t);for(const n of t.O_)e.m_(n.mutations)}async function AR(t,e,n){const r=t.O_.shift(),i=by.from(r,e,n);await jE(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await zp(t)}async function SR(t,e){e&&vl(t).V_&&await async function(r,i){if(function(o){return mP(o)&&o!==Ce.ABORTED}(i.code)){const s=r.O_.shift();vl(r).s_(),await jE(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await zp(r)}}(t,e),CE(t)&&IE(t)}async function Kb(t,e){const n=It(t);n.asyncQueue.verifyOperationInProgress(),Je("RemoteStore","RemoteStore received new credentials");const r=Nc(n);n.L_.add(3),await Oh(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await $p(n)}async function kR(t,e){const n=It(t);e?(n.L_.delete(2),await $p(n)):e||(n.L_.add(2),await Oh(n),n.q_.set("Unknown"))}function Mu(t){return t.K_||(t.K_=function(n,r,i){const s=It(n);return s.w_(),new hR(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:vR.bind(null,t),Ro:yR.bind(null,t),mo:xR.bind(null,t),d_:bR.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),jy(t)?Ty(t):t.q_.set("Unknown")):(await t.K_.stop(),TE(t))})),t.K_}function vl(t){return t.U_||(t.U_=function(n,r,i){const s=It(n);return s.w_(),new fR(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:_R.bind(null,t),mo:SR.bind(null,t),f_:ER.bind(null,t),g_:AR.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await zp(t)):(await t.U_.stop(),t.O_.length>0&&(Je("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new to,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,l=new Cy(e,n,o,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new He(Ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Iy(t,e){if(co("AsyncQueue",`${e}: ${t}`),Rh(t))return new He(Ce.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e){this.comparator=e?(n,r)=>e(n,r)||mt.comparator(n.key,r.key):(n,r)=>mt.comparator(n.key,r.key),this.keyedMap=Sd(),this.sortedSet=new Hn(this.comparator)}static emptySet(e){return new cu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof cu)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new cu;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{constructor(){this.W_=new Hn(mt.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):kt():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Tu{constructor(e,n,r,i,s,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Tu(e,n,cu.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Op(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class jR{constructor(){this.queries=Qb(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=It(n),s=i.queries;i.queries=Qb(),s.forEach((o,l)=>{for(const c of l.j_)c.onError(r)})})(this,new He(Ce.ABORTED,"Firestore shutting down"))}}function Qb(){return new Ou(t=>eE(t),Op)}async function Py(t,e){const n=It(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new TR,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const l=Iy(o,`Initialization of query '${Dc(e.query)}' failed`);return void e.onError(l)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&Ly(n)}async function Ry(t,e){const n=It(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function CR(t,e){const n=It(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const l of o.j_)l.X_(i)&&(r=!0);o.z_=i}}r&&Ly(n)}function IR(t,e,n){const r=It(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function Ly(t){t.Y_.forEach(e=>{e.next()})}var Uv,Xb;(Xb=Uv||(Uv={})).ea="default",Xb.Cache="cache";class Dy{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Tu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Tu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Uv.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e){this.key=e}}class RE{constructor(e){this.key=e}}class PR{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=$t(),this.mutatedKeys=$t(),this.Aa=tE(e),this.Ra=new cu(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Yb,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,v)=>{const g=i.get(f),p=Mp(this.query,v)?v:null,S=!!g&&this.mutatedKeys.has(g.key),k=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let C=!1;g&&p?g.data.isEqual(p.data)?S!==k&&(r.track({type:3,doc:p}),C=!0):this.ga(g,p)||(r.track({type:2,doc:p}),C=!0,(c&&this.Aa(p,c)>0||u&&this.Aa(p,u)<0)&&(l=!0)):!g&&p?(r.track({type:0,doc:p}),C=!0):g&&!p&&(r.track({type:1,doc:g}),C=!0,(c||u)&&(l=!0)),C&&(p?(o=o.add(p),s=k?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{Ra:o,fa:r,ns:l,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((f,v)=>function(p,S){const k=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kt()}};return k(p)-k(S)}(f.type,v.type)||this.Aa(f.doc,v.doc)),this.pa(r),i=i!=null&&i;const l=n&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new Tu(this.query,e.Ra,s,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Yb,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=$t(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new RE(r))}),this.da.forEach(r=>{e.has(r)||n.push(new PE(r))}),n}ba(e){this.Ta=e.Ts,this.da=$t();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Tu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class RR{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class LR{constructor(e){this.key=e,this.va=!1}}class DR{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Ou(l=>eE(l),Op),this.Ma=new Map,this.xa=new Set,this.Oa=new Hn(mt.comparator),this.Na=new Map,this.La=new _y,this.Ba={},this.ka=new Map,this.qa=ku.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function OR(t,e,n=!0){const r=UE(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await LE(r,e,n,!0),i}async function MR(t,e){const n=UE(t);await LE(n,e,!0,!1)}async function LE(t,e,n,r){const i=await sR(t.localStore,xa(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let l;return r&&(l=await FR(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&SE(t.remoteStore,i),l}async function FR(t,e,n,r,i){t.Ka=(v,g,p)=>async function(k,C,b,I){let R=C.view.ma(b);R.ns&&(R=await Hb(k.localStore,C.query,!1).then(({documents:V})=>C.view.ma(V,R)));const D=I&&I.targetChanges.get(C.targetId),ee=I&&I.targetMismatches.get(C.targetId)!=null,oe=C.view.applyChanges(R,k.isPrimaryClient,D,ee);return Zb(k,C.targetId,oe.wa),oe.snapshot}(t,v,g,p);const s=await Hb(t.localStore,e,!0),o=new PR(e,s.Ts),l=o.ma(s.documents),c=Dh.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(l,t.isPrimaryClient,c);Zb(t,n,u.wa);const f=new RR(e,n,o);return t.Fa.set(e,f),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),u.snapshot}async function UR(t,e,n){const r=It(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Op(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Fv(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Sy(r.remoteStore,i.targetId),Vv(r,i.targetId)}).catch(Ph)):(Vv(r,i.targetId),await Fv(r.localStore,i.targetId,!0))}async function VR(t,e){const n=It(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Sy(n.remoteStore,r.targetId))}async function BR(t,e,n){const r=KR(t);try{const i=await function(o,l){const c=It(o),u=ft.now(),f=l.reduce((p,S)=>p.add(S.key),$t());let v,g;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let S=uo(),k=$t();return c.cs.getEntries(p,f).next(C=>{S=C,S.forEach((b,I)=>{I.isValidDocument()||(k=k.add(b))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,S)).next(C=>{v=C;const b=[];for(const I of l){const R=cP(I,v.get(I.key).overlayedDocument);R!=null&&b.push(new El(I.key,R,W4(R.value.mapValue),gs.exists(!0)))}return c.mutationQueue.addMutationBatch(p,u,b,l)}).next(C=>{g=C;const b=C.applyToLocalDocumentSet(v,k);return c.documentOverlayCache.saveOverlays(p,C.batchId,b)})}).then(()=>({batchId:g.batchId,changes:rE(v)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new Hn(tn)),u=u.insert(l,c),o.Ba[o.currentUser.toKey()]=u}(r,i.batchId,n),await Mh(r,i.changes),await zp(r.remoteStore)}catch(i){const s=Iy(i,"Failed to persist write");n.reject(s)}}async function DE(t,e){const n=It(t);try{const r=await nR(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&(mn(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?mn(o.va):i.removedDocuments.size>0&&(mn(o.va),o.va=!1))}),await Mh(n,r,e)}catch(r){await Ph(r)}}function Jb(t,e,n){const r=It(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const c=It(o);c.onlineState=l;let u=!1;c.queries.forEach((f,v)=>{for(const g of v.j_)g.Z_(l)&&(u=!0)}),u&&Ly(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function $R(t,e,n){const r=It(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new Hn(mt.comparator);o=o.insert(s,ii.newNoDocument(s,Ct.min()));const l=$t().add(s),c=new Vp(Ct.min(),new Map,new Hn(tn),o,l);await DE(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),Oy(r)}else await Fv(r.localStore,e,!1).then(()=>Vv(r,e,n)).catch(Ph)}async function zR(t,e){const n=It(t),r=e.batch.batchId;try{const i=await tR(n.localStore,e);ME(n,r,null),OE(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Mh(n,i)}catch(i){await Ph(i)}}async function qR(t,e,n){const r=It(t);try{const i=await function(o,l){const c=It(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return c.mutationQueue.lookupMutationBatch(u,l).next(v=>(mn(v!==null),f=v.keys(),c.mutationQueue.removeMutationBatch(u,v))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,f,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>c.localDocuments.getDocuments(u,f))})}(r.localStore,e);ME(r,e,n),OE(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Mh(r,i)}catch(i){await Ph(i)}}function OE(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function ME(t,e,n){const r=It(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Vv(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||FE(t,r)})}function FE(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Sy(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Oy(t))}function Zb(t,e,n){for(const r of n)r instanceof PE?(t.La.addReference(r.key,e),HR(t,r)):r instanceof RE?(Je("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||FE(t,r.key)):kt()}function HR(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(Je("SyncEngine","New document in limbo: "+n),t.xa.add(r),Oy(t))}function Oy(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new mt(Cn.fromString(e)),r=t.qa.next();t.Na.set(r,new LR(n)),t.Oa=t.Oa.insert(n,r),SE(t.remoteStore,new Jo(xa(Dp(n.path)),r,"TargetPurposeLimboResolution",hy.oe))}}async function Mh(t,e,n){const r=It(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{o.push(r.Ka(c,e,n).then(u=>{var f;if((u||n)&&r.isPrimaryClient){const v=u?!u.fromCache:(f=n==null?void 0:n.targetChanges.get(c.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(c.targetId,v?"current":"not-current")}if(u){i.push(u);const v=Ay.Wi(c.targetId,u);s.push(v)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(c,u){const f=It(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>De.forEach(u,g=>De.forEach(g.$i,p=>f.persistence.referenceDelegate.addReference(v,g.targetId,p)).next(()=>De.forEach(g.Ui,p=>f.persistence.referenceDelegate.removeReference(v,g.targetId,p)))))}catch(v){if(!Rh(v))throw v;Je("LocalStore","Failed to update sequence numbers: "+v)}for(const v of u){const g=v.targetId;if(!v.fromCache){const p=f.os.get(g),S=p.snapshotVersion,k=p.withLastLimboFreeSnapshotVersion(S);f.os=f.os.insert(g,k)}}}(r.localStore,s))}async function WR(t,e){const n=It(t);if(!n.currentUser.isEqual(e)){Je("SyncEngine","User change. New user:",e.toKey());const r=await NE(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(c=>{c.reject(new He(Ce.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Mh(n,r.hs)}}function GR(t,e){const n=It(t),r=n.Na.get(e);if(r&&r.va)return $t().add(r.key);{let i=$t();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const l=n.Fa.get(o);i=i.unionWith(l.view.Va)}return i}}function UE(t){const e=It(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=DE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=GR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$R.bind(null,e),e.Ca.d_=CR.bind(null,e.eventManager),e.Ca.$a=IR.bind(null,e.eventManager),e}function KR(t){const e=It(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=qR.bind(null,e),e}class ep{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Bp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return eR(this.persistence,new JP,e.initialUser,this.serializer)}Ga(e){return new YP(Ey.Zr,this.serializer)}Wa(e){return new oR}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ep.provider={build:()=>new ep};class Bv{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Jb(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=WR.bind(null,this.syncEngine),await kR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new jR}()}createDatastore(e){const n=Bp(e.databaseInfo.databaseId),r=function(s){return new dR(s)}(e.databaseInfo);return function(s,o,l,c){return new mR(s,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,l){return new gR(r,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Jb(this.syncEngine,n,0),function(){return Gb.D()?new Gb:new lR}())}createSyncEngine(e,n){return function(i,s,o,l,c,u,f){const v=new DR(i,s,o,l,c,u);return f&&(v.Qa=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=It(i);Je("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Oh(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Bv.provider={build:()=>new Bv};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class My{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):co("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=ni.UNAUTHENTICATED,this.clientId=z4.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{Je("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Je("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new to;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Iy(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function t0(t,e){t.asyncQueue.verifyOperationInProgress(),Je("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await NE(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function ew(t,e){t.asyncQueue.verifyOperationInProgress();const n=await QR(t);Je("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Kb(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Kb(e.remoteStore,i)),t._onlineComponents=e}async function QR(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Je("FirestoreClient","Using user provided OfflineComponentProvider");try{await t0(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===Ce.FAILED_PRECONDITION||i.code===Ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;_u("Error using user provided cache. Falling back to memory cache: "+n),await t0(t,new ep)}}else Je("FirestoreClient","Using default OfflineComponentProvider"),await t0(t,new ep);return t._offlineComponents}async function VE(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Je("FirestoreClient","Using user provided OnlineComponentProvider"),await ew(t,t._uninitializedComponentsProvider._online)):(Je("FirestoreClient","Using default OnlineComponentProvider"),await ew(t,new Bv))),t._onlineComponents}function XR(t){return VE(t).then(e=>e.syncEngine)}async function tp(t){const e=await VE(t),n=e.eventManager;return n.onListen=OR.bind(null,e.syncEngine),n.onUnlisten=UR.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=MR.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=VR.bind(null,e.syncEngine),n}function JR(t,e,n={}){const r=new to;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,u){const f=new My({next:g=>{f.Za(),o.enqueueAndForget(()=>Ry(s,v));const p=g.docs.has(l);!p&&g.fromCache?u.reject(new He(Ce.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&g.fromCache&&c&&c.source==="server"?u.reject(new He(Ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),v=new Dy(Dp(l.path),f,{includeMetadataChanges:!0,_a:!0});return Py(s,v)}(await tp(t),t.asyncQueue,e,n,r)),r.promise}function ZR(t,e,n={}){const r=new to;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,u){const f=new My({next:g=>{f.Za(),o.enqueueAndForget(()=>Ry(s,v)),g.fromCache&&c.source==="server"?u.reject(new He(Ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),v=new Dy(l,f,{includeMetadataChanges:!0,_a:!0});return Py(s,v)}(await tp(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BE(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $E(t,e,n){if(!n)throw new He(Ce.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function eL(t,e,n,r){if(e===!0&&r===!0)throw new He(Ce.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function nw(t){if(!mt.isDocumentKey(t))throw new He(Ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function rw(t){if(mt.isDocumentKey(t))throw new He(Ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function qp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":kt()}function Ci(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new He(Ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=qp(t);throw new He(Ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new He(Ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new He(Ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}eL("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=BE((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new He(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new He(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new He(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Hp{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new iw({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new He(Ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new He(Ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new iw(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new y6;switch(r.type){case"firstParty":return new N6(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new He(Ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=tw.get(n);r&&(Je("ComponentProvider","Removing Datastore"),tw.delete(n),r.terminate())}(this),Promise.resolve()}}function tL(t,e,n,r={}){var i;const s=(t=Ci(t,Hp))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&_u("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=ni.MOCK_USER;else{l=Y_(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new He(Ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new ni(u)}t._authCredentials=new x6(new $4(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new po(this.firestore,e,this._query)}}class si{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ul(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new si(this.firestore,e,this._key)}}class ul extends po{constructor(e,n,r){super(e,n,Dp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new si(this.firestore,null,new mt(e))}withConverter(e){return new ul(this.firestore,e,this._path)}}function Ut(t,e,...n){if(t=bn(t),$E("collection","path",e),t instanceof Hp){const r=Cn.fromString(e,...n);return rw(r),new ul(t,null,r)}{if(!(t instanceof si||t instanceof ul))throw new He(Ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Cn.fromString(e,...n));return rw(r),new ul(t.firestore,null,r)}}function ut(t,e,...n){if(t=bn(t),arguments.length===1&&(e=z4.newId()),$E("doc","path",e),t instanceof Hp){const r=Cn.fromString(e,...n);return nw(r),new si(t,null,new mt(r))}{if(!(t instanceof si||t instanceof ul))throw new He(Ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Cn.fromString(e,...n));return nw(r),new si(t.firestore,t instanceof ul?t.converter:null,new mt(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new EE(this,"async_queue_retry"),this.Vu=()=>{const r=e0();r&&Je("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=e0();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=e0();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new to;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Rh(e))throw e;Je("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw co("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=Cy.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&kt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function aw(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class ho extends Hp{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new sw,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new sw(e),this._firestoreClient=void 0,await e}}}function nL(t,e){const n=typeof t=="object"?t:Cp(),r=typeof t=="string"?t:"(default)",i=kh(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=Y1("firestore");s&&tL(i,...s)}return i}function Wp(t){if(t._terminated)throw new He(Ce.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||rL(t),t._firestoreClient}function rL(t){var e,n,r;const i=t._freezeSettings(),s=function(l,c,u,f){return new D6(l,c,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,BE(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new YR(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ju(zr.fromBase64String(e))}catch(n){throw new He(Ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ju(zr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new He(Ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ur(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new He(Ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new He(Ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return tn(this._lat,e._lat)||tn(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iL=/^__.*__$/;class sL{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new El(e,this.data,this.fieldMask,n,this.fieldTransforms):new Lh(e,this.data,n,this.fieldTransforms)}}class zE{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new El(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function qE(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw kt()}}class By{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new By(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return np(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(qE(this.Cu)&&iL.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class aL{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Bp(e)}Qu(e,n,r,i=!1){return new By({Cu:e,methodName:n,qu:r,path:Ur.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Kp(t){const e=t._freezeSettings(),n=Bp(t._databaseId);return new aL(t._databaseId,!!e.ignoreUndefinedProperties,n)}function HE(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);$y("Data must be an object, but it was:",o,r);const l=WE(r,o);let c,u;if(s.merge)c=new Yi(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const v of s.mergeFields){const g=$v(e,v,n);if(!o.contains(g))throw new He(Ce.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);KE(f,g)||f.push(g)}c=new Yi(f),u=o.fieldTransforms.filter(v=>c.covers(v.field))}else c=null,u=o.fieldTransforms;return new sL(new Ai(l),c,u)}class Yp extends Fy{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Yp}}function oL(t,e,n,r){const i=t.Qu(1,e,n);$y("Data must be an object, but it was:",i,r);const s=[],o=Ai.empty();wc(r,(c,u)=>{const f=zy(e,c,n);u=bn(u);const v=i.Nu(f);if(u instanceof Yp)s.push(f);else{const g=Fh(u,v);g!=null&&(s.push(f),o.set(f,g))}});const l=new Yi(s);return new zE(o,l,i.fieldTransforms)}function lL(t,e,n,r,i,s){const o=t.Qu(1,e,n),l=[$v(e,r,n)],c=[i];if(s.length%2!=0)throw new He(Ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)l.push($v(e,s[g])),c.push(s[g+1]);const u=[],f=Ai.empty();for(let g=l.length-1;g>=0;--g)if(!KE(u,l[g])){const p=l[g];let S=c[g];S=bn(S);const k=o.Nu(p);if(S instanceof Yp)u.push(p);else{const C=Fh(S,k);C!=null&&(u.push(p),f.set(p,C))}}const v=new Yi(u);return new zE(f,v,o.fieldTransforms)}function cL(t,e,n,r=!1){return Fh(n,t.Qu(r?4:3,e))}function Fh(t,e){if(GE(t=bn(t)))return $y("Unsupported field value:",e,t),WE(t,e);if(t instanceof Fy)return function(r,i){if(!qE(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const l of r){let c=Fh(l,i.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=bn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return rP(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=ft.fromDate(r);return{timestampValue:Jm(i.serializer,s)}}if(r instanceof ft){const s=new ft(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Jm(i.serializer,s)}}if(r instanceof Uy)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ju)return{bytesValue:pE(i.serializer,r._byteString)};if(r instanceof si){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ny(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Vy)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return yy(l.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${qp(r)}`)}(t,e)}function WE(t,e){const n={};return q4(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wc(t,(r,i)=>{const s=Fh(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function GE(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ft||t instanceof Uy||t instanceof ju||t instanceof si||t instanceof Fy||t instanceof Vy)}function $y(t,e,n){if(!GE(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=qp(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function $v(t,e,n){if((e=bn(e))instanceof Gp)return e._internalPath;if(typeof e=="string")return zy(t,e);throw np("Field path arguments must be of type string or ",t,!1,void 0,n)}const uL=new RegExp("[~\\*/\\[\\]]");function zy(t,e,n){if(e.search(uL)>=0)throw np(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Gp(...e.split("."))._internalPath}catch{throw np(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function np(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new He(Ce.INVALID_ARGUMENT,l+t+c)}function KE(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new si(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new dL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Qp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class dL extends YE{data(){return super.data()}}function Qp(t,e){return typeof e=="string"?zy(t,e):e instanceof Gp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QE(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new He(Ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class qy{}class Hy extends qy{}function An(t,e,...n){let r=[];e instanceof qy&&r.push(e),r=r.concat(n),function(s){const o=s.filter(c=>c instanceof Wy).length,l=s.filter(c=>c instanceof Xp).length;if(o>1||o>0&&l>0)throw new He(Ce.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Xp extends Hy{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Xp(e,n,r)}_apply(e){const n=this._parse(e);return XE(e._query,n),new po(e.firestore,e.converter,Rv(e._query,n))}_parse(e){const n=Kp(e.firestore);return function(s,o,l,c,u,f,v){let g;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new He(Ce.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){lw(v,f);const p=[];for(const S of v)p.push(ow(c,s,S));g={arrayValue:{values:p}}}else g=ow(c,s,v)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||lw(v,f),g=cL(l,o,v,f==="in"||f==="not-in");return pr.create(u,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function cr(t,e,n){const r=e,i=Qp("where",t);return Xp._create(i,r,n)}class Wy extends qy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Wy(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Bs.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const l=s.getFlattenedFilters();for(const c of l)XE(o,c),o=Rv(o,c)}(e._query,n),new po(e.firestore,e.converter,Rv(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Gy extends Hy{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Gy(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new He(Ce.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new He(Ce.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new mh(s,o)}(e._query,this._field,this._direction);return new po(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Du(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function Fu(t,e="asc"){const n=e,r=Qp("orderBy",t);return Gy._create(r,n)}class Ky extends Hy{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Ky(e,n,r)}_apply(e){return new po(e.firestore,e.converter,Ym(e._query,this._limit,this._limitType))}}function hL(t){return Ky._create("limit",t,"F")}function ow(t,e,n){if(typeof(n=bn(n))=="string"){if(n==="")throw new He(Ce.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Z4(e)&&n.indexOf("/")!==-1)throw new He(Ce.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Cn.fromString(n));if(!mt.isDocumentKey(r))throw new He(Ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Tb(t,new mt(r))}if(n instanceof si)return Tb(t,n._key);throw new He(Ce.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${qp(n)}.`)}function lw(t,e){if(!Array.isArray(t)||t.length===0)throw new He(Ce.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function XE(t,e){const n=function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new He(Ce.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new He(Ce.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class fL{convertValue(e,n="none"){switch(pc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ir(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(mc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw kt()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return wc(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>ir(o.doubleValue));return new Vy(s)}convertGeoPoint(e){return new Uy(ir(e.latitude),ir(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=my(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(dh(e));default:return null}}convertTimestamp(e){const n=gl(e);return new ft(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Cn.fromString(e);mn(wE(r));const i=new hh(r.get(1),r.get(3)),s=new mt(r.popFirst(5));return i.isEqual(n)||co(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JE(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ZE extends YE{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new sm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Qp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class sm extends ZE{data(e={}){return super.data(e)}}class eA{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Td(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new sm(this._firestore,this._userDataWriter,r.key,r,new Td(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new He(Ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const c=new sm(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Td(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const c=new sm(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Td(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:mL(l.type),doc:c,oldIndex:u,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function mL(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vs(t){t=Ci(t,si);const e=Ci(t.firestore,ho);return JR(Wp(e),t._key).then(n=>tA(e,t,n))}class Yy extends fL{constructor(e){super(),this.firestore=e}convertBytes(e){return new ju(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new si(this.firestore,null,n)}}function Na(t){t=Ci(t,po);const e=Ci(t.firestore,ho),n=Wp(e),r=new Yy(e);return QE(t._query),ZR(n,t._query).then(i=>new eA(e,r,t,i))}function ws(t,e,n){t=Ci(t,si);const r=Ci(t.firestore,ho),i=JE(t.converter,e,n);return Jp(r,[HE(Kp(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,gs.none())])}function gr(t,e,n,...r){t=Ci(t,si);const i=Ci(t.firestore,ho),s=Kp(i);let o;return o=typeof(e=bn(e))=="string"||e instanceof Gp?lL(s,"updateDoc",t._key,e,n,r):oL(s,"updateDoc",t._key,e),Jp(i,[o.toMutation(t._key,gs.exists(!0))])}function yl(t){return Jp(Ci(t.firestore,ho),[new xy(t._key,gs.none())])}function Sa(t,e){const n=Ci(t.firestore,ho),r=ut(t),i=JE(t.converter,e);return Jp(n,[HE(Kp(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,gs.exists(!1))]).then(()=>r)}function Gt(t,...e){var n,r,i;t=bn(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||aw(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(aw(e[o])){const v=e[o];e[o]=(n=v.next)===null||n===void 0?void 0:n.bind(v),e[o+1]=(r=v.error)===null||r===void 0?void 0:r.bind(v),e[o+2]=(i=v.complete)===null||i===void 0?void 0:i.bind(v)}let c,u,f;if(t instanceof si)u=Ci(t.firestore,ho),f=Dp(t._key.path),c={next:v=>{e[o]&&e[o](tA(u,t,v))},error:e[o+1],complete:e[o+2]};else{const v=Ci(t,po);u=Ci(v.firestore,ho),f=v._query;const g=new Yy(u);c={next:p=>{e[o]&&e[o](new eA(u,g,v,p))},error:e[o+1],complete:e[o+2]},QE(t._query)}return function(g,p,S,k){const C=new My(k),b=new Dy(p,C,S);return g.asyncQueue.enqueueAndForget(async()=>Py(await tp(g),b)),()=>{C.Za(),g.asyncQueue.enqueueAndForget(async()=>Ry(await tp(g),b))}}(Wp(u),f,l,c)}function Jp(t,e){return function(r,i){const s=new to;return r.asyncQueue.enqueueAndForget(async()=>BR(await XR(r),i,s)),s.promise}(Wp(t),e)}function tA(t,e,n){const r=n.docs.get(e._key),i=new Yy(t);return new ZE(t,i,e._key,r,new Td(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(i){Lu=i})(bc),ml(new ao("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new ho(new b6(r.getProvider("auth-internal")),new E6(r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new He(Ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hh(u.options.projectId,f)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),ps(_b,"4.7.3",e),ps(_b,"4.7.3","esm2017")})();var pL="firebase",gL="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ps(pL,gL,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nA="firebasestorage.googleapis.com",vL="storageBucket",yL=2*60*1e3,xL=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka extends Ea{constructor(e,n,r=0){super(n0(e),`Firebase Storage: ${n} (${n0(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ka.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return n0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var _a;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(_a||(_a={}));function n0(t){return"storage/"+t}function bL(){const t="An unknown error occurred, please check the error payload for server response.";return new ka(_a.UNKNOWN,t)}function wL(){return new ka(_a.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function NL(){return new ka(_a.CANCELED,"User canceled the upload/download.")}function _L(t){return new ka(_a.INVALID_URL,"Invalid URL '"+t+"'.")}function EL(t){return new ka(_a.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function cw(t){return new ka(_a.INVALID_ARGUMENT,t)}function rA(){return new ka(_a.APP_DELETED,"The Firebase app was deleted.")}function AL(t){return new ka(_a.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Ms.makeFromUrl(e,n)}catch{return new Ms(e,"")}if(r.path==="")return r;throw EL(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function u(D){D.path_=decodeURIComponent(D.path)}const f="v[A-Za-z0-9_]+",v=n.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",p=new RegExp(`^https?://${v}/${f}/b/${i}/o${g}`,"i"),S={bucket:1,path:3},k=n===nA?"(?:storage.googleapis.com|storage.cloud.google.com)":n,C="([^?#]*)",b=new RegExp(`^https?://${k}/${i}/${C}`,"i"),R=[{regex:l,indices:c,postModify:s},{regex:p,indices:S,postModify:u},{regex:b,indices:{bucket:1,path:2},postModify:u}];for(let D=0;D<R.length;D++){const ee=R[D],oe=ee.regex.exec(e);if(oe){const V=oe[ee.indices.bucket];let T=oe[ee.indices.path];T||(T=""),r=new Ms(V,T),ee.postModify(r);break}}if(r==null)throw _L(e);return r}}class SL{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kL(t,e,n){let r=1,i=null,s=null,o=!1,l=0;function c(){return l===2}let u=!1;function f(...C){u||(u=!0,e.apply(null,C))}function v(C){i=setTimeout(()=>{i=null,t(p,c())},C)}function g(){s&&clearTimeout(s)}function p(C,...b){if(u){g();return}if(C){g(),f.call(null,C,...b);return}if(c()||o){g(),f.call(null,C,...b);return}r<64&&(r*=2);let R;l===1?(l=2,R=0):R=(r+Math.random())*1e3,v(R)}let S=!1;function k(C){S||(S=!0,g(),!u&&(i!==null?(C||(l=2),clearTimeout(i),v(0)):C||(l=1)))}return v(0),s=setTimeout(()=>{o=!0,k(!0)},n),k}function TL(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jL(t){return t!==void 0}function uw(t,e,n,r){if(r<e)throw cw(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw cw(`Invalid value for '${t}'. Expected ${n} or less.`)}function CL(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var rp;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(rp||(rp={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IL(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{constructor(e,n,r,i,s,o,l,c,u,f,v,g=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=f,this.connectionFactory_=v,this.retry=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,S)=>{this.resolve_=p,this.reject_=S,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new jf(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===rp.NO_ERROR,c=s.getStatus();if(!l||IL(c,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===rp.ABORT;r(!1,new jf(!1,null,f));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new jf(u,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,l=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());jL(c)?s(c):s()}catch(c){o(c)}else if(l!==null){const c=bL();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(i.canceled){const c=this.appDelete_?rA():NL();o(c)}else{const c=wL();o(c)}};this.canceled_?n(!1,new jf(!1,null,!0)):this.backoffId_=kL(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&TL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class jf{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function RL(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function LL(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function DL(t,e){e&&(t["X-Firebase-GMPID"]=e)}function OL(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function ML(t,e,n,r,i,s,o=!0){const l=CL(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return DL(u,e),RL(u,n),LL(u,s),OL(u,r),new PL(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FL(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function UL(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(e,n){this._service=e,n instanceof Ms?this._location=n:this._location=Ms.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ip(e,n)}get root(){const e=new Ms(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return UL(this._location.path)}get storage(){return this._service}get parent(){const e=FL(this._location.path);if(e===null)return null;const n=new Ms(this._location.bucket,e);return new ip(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw AL(e)}}function dw(t,e){const n=e==null?void 0:e[vL];return n==null?null:Ms.makeFromBucketSpec(n,t)}function VL(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:Y_(i,t.app.options.projectId))}class BL{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=nA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=yL,this._maxUploadRetryTime=xL,this._requests=new Set,i!=null?this._bucket=Ms.makeFromBucketSpec(i,this._host):this._bucket=dw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ms.makeFromBucketSpec(this._url,e):this._bucket=dw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){uw("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){uw("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ip(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new SL(rA());{const o=ML(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const hw="@firebase/storage",fw="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA="storage";function $L(t=Cp(),e){t=bn(t);const r=kh(t,iA).getImmediate({identifier:e}),i=Y1("storage");return i&&zL(r,...i),r}function zL(t,e,n,r={}){VL(t,e,n,r)}function qL(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new BL(n,r,i,e,bc)}function HL(){ml(new ao(iA,qL,"PUBLIC").setMultipleInstances(!0)),ps(hw,fw,""),ps(hw,fw,"esm2017")}HL();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sA="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WL{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||n.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zv="us-central1";class GL{constructor(e,n,r,i,s=zv,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new WL(n,r,i),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(s);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=zv}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function KL(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const mw="@firebase/functions",pw="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YL="auth-internal",QL="app-check-internal",XL="messaging-internal";function JL(t,e){const n=(r,{instanceIdentifier:i})=>{const s=r.getProvider("app").getImmediate(),o=r.getProvider(YL),l=r.getProvider(XL),c=r.getProvider(QL);return new GL(s,o,l,c,i,t)};ml(new ao(sA,n,"PUBLIC").setMultipleInstances(!0)),ps(mw,pw,e),ps(mw,pw,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZL(t=Cp(),e=zv){const r=kh(bn(t),sA).getImmediate({identifier:e}),i=Y1("functions");return i&&e8(r,...i),r}function e8(t,e,n){KL(bn(t),e,n)}JL(fetch.bind(self));const t8={apiKey:"AIzaSyB1ddVOczgt5n2NkoIq3H_5x_eB0Aqw2HI",authDomain:"alojamientos-3c46b.firebaseapp.com",projectId:"alojamientos-3c46b",storageBucket:"alojamientos-3c46b.appspot.com",messagingSenderId:"858434059981",appId:"1:858434059981:web:f235cea133b874f985b384"},Fe="alojamientos-3c46b",Zp=J_(t8),hr=g6(Zp),Ve=nL(Zp);$L(Zp);ZL(Zp);const n8=async()=>{console.log(" DIAGNSTICO COMPLETO DE FIREBASE"),console.log("=====================================");try{console.log(" App ID:",Fe),console.log(`
 Verificando estructura de base de datos...`);const t=Ut(Ve,"artifacts",Fe,"public","data","users");console.log(" Ruta de usuarios:",`artifacts/${Fe}/public/data/users`);try{const e=await Na(t);if(console.log(" Total de usuarios encontrados:",e.size),e.empty)return console.log(" No hay usuarios en la coleccin"),{hasUsers:!1,users:[]};const n=[];e.docs.forEach((s,o)=>{const l=s.data(),c={id:s.id,email:l.email||"Sin email",role:l.role||"Sin rol",status:l.status||"Sin estado",createdAt:l.createdAt||"Sin fecha",fullName:l.fullName||"Sin nombre"};n.push(c),console.log(` Usuario ${o+1}:`,c)}),console.log(`
 Verificando configuracin de empresa...`);const r=ut(Ve,"artifacts",Fe,"public","data","settings","company_info"),i=await vs(r);i.exists()?(console.log(" Configuracin de empresa encontrada"),console.log(" Configuracin:",i.data())):console.log(" No hay configuracin de empresa"),console.log(`
 Verificando permisos...`);try{const s=An(t,hL(1));await Na(s),console.log(" Permisos de lectura OK")}catch(s){console.error(" Error de permisos:",s)}return{hasUsers:!0,users:n,hasSettings:i.exists(),settings:i.exists()?i.data():null}}catch(e){return console.error(" Error accediendo a usuarios:",e),{hasUsers:!1,error:e.message}}}catch(t){return console.error(" Error en diagnstico:",t),{hasUsers:!1,error:t.message}}},r8=async()=>{try{console.log(" Verificando usuarios en Authentication...");const t=hr.currentUser;return t?(console.log(" Usuario autenticado encontrado:",t.email),!0):(console.log(" No hay usuario autenticado, pero asumiendo que hay usuarios en el sistema"),!0)}catch(t){return console.error(" Error verificando Authentication:",t),!1}},aA=ue.createContext();function i8({message:t,type:e,onClose:n}){const r=e==="success"?"bg-green-500":"bg-red-500";return ue.useEffect(()=>{const i=setTimeout(n,4e3);return()=>clearTimeout(i)},[n]),a.jsx("div",{className:`fixed top-5 right-5 ${r} text-white py-2 px-4 rounded-lg shadow-lg animate-fade-in-down`,children:t})}function s8({children:t}){const[e,n]=ue.useState([]),r=(s,o="success")=>{const l=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;n(c=>[...c,{id:l,message:s,type:o}])},i=s=>{n(o=>o.filter(l=>l.id!==s))};return a.jsxs(aA.Provider,{value:{addNotification:r},children:[t,a.jsx("div",{className:"fixed top-5 right-5 z-50 space-y-2",children:e.map(s=>a.jsx(i8,{message:s.message,type:s.type,onClose:()=>i(s.id)},s.id))})]})}const pn=()=>ue.useContext(aA);function a8(t,e=10,n=!0){const r=ue.useRef(null),i=ue.useRef(Date.now()),s=ue.useCallback(()=>{if(!n||!t)return;r.current&&clearTimeout(r.current);const o=e*60*1e3;i.current=Date.now(),r.current=setTimeout(()=>{console.log(` Sesin cerrada por inactividad (${e} minutos)`),t&&t()},o)},[t,e,n]);ue.useEffect(()=>{if(!n||!t)return;const o=["mousedown","mousemove","keypress","scroll","touchstart","click","keydown"],l=()=>{Date.now()-i.current>1e3&&s()};return o.forEach(c=>{window.addEventListener(c,l,{passive:!0})}),s(),()=>{o.forEach(c=>{window.removeEventListener(c,l)}),r.current&&clearTimeout(r.current)}},[s,n,t]),ue.useEffect(()=>{n&&t&&s()},[e,n,s,t])}function o8(){if(typeof window>"u")return;const t=console.error,e=console.warn,n=["Could not establish connection","Receiving end does not exist","Promised response from onMessage listener went out of scope","Extension context invalidated","message handler closed","chrome-extension://","moz-extension://","edge-extension://"];return console.error=function(...r){let i="";try{i=r.map(o=>{if(typeof o=="string")return o;if(o instanceof Error)return o.message+" "+o.stack;try{return JSON.stringify(o)}catch{return String(o)}}).join(" ")}catch{i=String(r)}n.some(o=>i.includes(o))||t.apply(console,r)},console.warn=function(...r){let i="";try{i=r.map(o=>{if(typeof o=="string")return o;if(o instanceof Error)return o.message+" "+o.stack;try{return JSON.stringify(o)}catch{return String(o)}}).join(" ")}catch{i=String(r)}n.some(o=>i.includes(o))||e.apply(console,r)},()=>{console.error=t,console.warn=e}}const r0={nuevoUsuario:{name:"Bienvenida - Nuevo Usuario - Crear Contrasea",subject:"Bienvenido a {companyName} - Crea tu contrasea",body:`Hola {clientName},

Bienvenido a {companyName}!

Tu cuenta ha sido creada exitosamente en nuestro sistema de gestin.

 Tu email de acceso: {clientEmail}

 CREAR TU CONTRASEA - ACCESO AL SISTEMA:

Para completar tu registro y acceder al sistema, necesitas crear tu contrasea personal.

 INSTRUCCIONES PASO A PASO:

1. Haz clic en el siguiente enlace para crear tu contrasea:
   {resetPasswordUrl}

2. En la pgina de restablecimiento, ingresa una contrasea segura (mnimo 6 caracteres)

3. Confirma tu contrasea ingresndola nuevamente

4. Haz clic en "Restablecer Contrasea"

5. Una vez creada tu contrasea, sers redirigido automticamente al inicio de sesin

6. Inicia sesin con:
   - Email: {clientEmail}
   - Contrasea: La que acabas de crear

 IMPORTANTE:
- El enlace para crear tu contrasea expirar en 1 hora
- Si el enlace expira, puedes solicitar uno nuevo desde la pgina de inicio de sesin haciendo clic en "Olvidaste tu contrasea?"
- Tu cuenta est activa y lista para usar una vez que crees tu contrasea

 ENLACE DIRECTO AL SISTEMA:
{loginUrl}

Una vez que inicies sesin, podrs:
 Ver tus servicios contratados
 Crear tickets de soporte
 Gestionar tu perfil y pagos
 Acceder a todas las funcionalidades del sistema

Si tienes alguna pregunta o necesitas ayuda, no dudes en contactarnos.

Bienvenido!

Equipo de Soporte
{companyName}`,category:"client"},notificarActivacion:{name:"Notificacin de Activacin - Crear Contrasea",subject:"Cuenta Activada - {companyName} - Crea tu contrasea",body:`Hola {clientName},

Tu cuenta ha sido activada exitosamente en nuestro sistema de gestin de cobros.

 Tu email de acceso: {clientEmail}

 CREAR O CAMBIAR TU CONTRASEA:

Para acceder al sistema, necesitas crear o cambiar tu contrasea.

 INSTRUCCIONES PASO A PASO:

1. Haz clic en el siguiente enlace para crear/cambiar tu contrasea:
   {resetPasswordUrl}

2. En la pgina de restablecimiento, ingresa una contrasea segura (mnimo 6 caracteres)

3. Confirma tu contrasea ingresndola nuevamente

4. Haz clic en "Restablecer Contrasea"

5. Una vez creada tu contrasea, sers redirigido automticamente al inicio de sesin

6. Inicia sesin con:
   - Email: {clientEmail}
   - Contrasea: La que acabas de crear

 IMPORTANTE:
- El enlace para crear/cambiar tu contrasea expirar en 1 hora
- Si el enlace expira, puedes solicitar uno nuevo desde la pgina de inicio de sesin haciendo clic en "Olvidaste tu contrasea?"
- Tu cuenta est activa y lista para usar una vez que crees tu contrasea

 ENLACE DIRECTO AL SISTEMA:
{loginUrl}

Una vez que inicies sesin, podrs:
 Ver tus servicios contratados
 Crear tickets de soporte
 Gestionar tu perfil y pagos
 Acceder a todas las funcionalidades del sistema

Si tienes alguna pregunta o necesitas ayuda, no dudes en contactarnos.

Bienvenido!

Equipo de Soporte
{companyName}`,category:"client"},restablecerContrasena:{name:"Restablecer Contrasea",subject:"Restablecer tu contrasea - {companyName}",body:`Hola,

Has solicitado restablecer tu contrasea en {companyName}.

 INSTRUCCIONES:

1. Haz clic en el siguiente enlace para restablecer tu contrasea:
   {resetPasswordUrl}

2. En la pgina de restablecimiento, ingresa una contrasea segura (mnimo 6 caracteres)

3. Confirma tu contrasea ingresndola nuevamente

4. Haz clic en "Restablecer Contrasea"

5. Una vez restablecida tu contrasea, sers redirigido automticamente al inicio de sesin

 IMPORTANTE:
- El enlace expirar en 1 hora
- Si no solicitaste este restablecimiento, ignora este email
- Si tienes problemas, contacta con soporte

 ENLACE DIRECTO AL SISTEMA:
{loginUrl}

Si tienes alguna pregunta o necesitas ayuda, no dudes en contactarnos.

Equipo de Soporte
{companyName}`,category:"client"}},l8=async t=>{try{const e=Ut(Ve,"artifacts",Fe,"public","data","messageTemplates"),n=An(e,cr("name","==",t));return!(await Na(n)).empty}catch(e){return console.error("Error verificando plantilla:",e),!1}},i0=async(t,e)=>{try{if(await l8(e.name))return console.log(` Plantilla "${e.name}" ya existe`),!1;const r=Ut(Ve,"artifacts",Fe,"public","data","messageTemplates");return await Sa(r,{...e,createdAt:new Date,updatedAt:new Date}),console.log(` Plantilla "${e.name}" creada exitosamente`),!0}catch(n){return console.error(` Error creando plantilla "${e.name}":`,n),!1}},c8=async()=>{try{console.log(" Inicializando plantillas de restablecimiento de contrasea...");const e=(await Promise.all([i0("nuevoUsuario",r0.nuevoUsuario),i0("notificarActivacion",r0.notificarActivacion),i0("restablecerContrasena",r0.restablecerContrasena)])).filter(n=>n).length;return e>0?console.log(` ${e} plantilla(s) de contrasea creada(s)`):console.log(" Todas las plantillas de contrasea ya existen"),!0}catch(t){return console.error(" Error inicializando plantillas de contrasea:",t),!1}},oA=async t=>{try{const e=Ut(Ve,"artifacts",Fe,"public","data","messageTemplates"),n=An(e,cr("name","==",t)),r=await Na(n);if(!r.empty){const i=r.docs[0];return{id:i.id,...i.data()}}return null}catch(e){return console.error("Error obteniendo plantilla:",e),null}},Uh=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),lA=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),u8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),d8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M15 21a6 6 0 00-9-5.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-3-5.197m0 0A4 4 0 0112 4.354a4 4 0 013 3.249m-3 7.586a4 4 0 01-3-3.25"})}),sp=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),am=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),cA=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h7"})}),eg=()=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),ic=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),h8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),f8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})}),Uu=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})}),m8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),p8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-5 5v-5zM4.828 7l2.586 2.586a2 2 0 002.828 0L12 7H4.828zM4.828 17h5l-5-5v5zM12 7l2.586 2.586a2 2 0 002.828 0L20 7h-8z"})}),Ji=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),uu=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"})}),uA=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),ap=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),dl=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),dA=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),hs=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),xl=()=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),vh=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),op=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),g8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),v8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})});function Vh({children:t}){const[e,n]=ue.useState(!1),[r,i]=ue.useState({top:0,left:0,position:"bottom-right"}),s=ue.useRef(null),o=ue.useRef(null);ue.useEffect(()=>{const c=u=>{s.current&&!s.current.contains(u.target)&&n(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[s]),ue.useEffect(()=>{if(e&&o.current){const c=o.current.getBoundingClientRect(),u=window.innerHeight,f=window.innerWidth,v=u-c.bottom,g=c.top,p=f-c.right,S=c.left;let k=c.bottom+8,C=c.right-224,b="bottom-right";v<200&&g>v&&(k=c.top-8,b=p>224?"top-right":"top-left"),p<224&&S>224&&(C=c.left-224,b=v>200?"bottom-left":"top-left"),C<8&&(C=8),C+224>f-8&&(C=f-232),k<8&&(k=8),k+200>u-8&&(k=u-208),i({top:k,left:C,position:b})}},[e]);const l=()=>"fixed w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50";return a.jsxs("div",{className:"relative inline-block text-left",ref:s,children:[a.jsxs("button",{ref:o,onClick:()=>n(!e),className:"inline-flex justify-center w-full rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:["Acciones ",a.jsx(f8,{className:"-mr-1 ml-2 h-5 w-5"})]}),e&&a.jsx("div",{className:l(),style:{top:`${r.top}px`,left:`${r.left}px`},children:a.jsx("div",{className:"py-1",role:"menu","aria-orientation":"vertical",onClick:()=>n(!1),children:t})})]})}function y8({isOpen:t,onClose:e,onSave:n,service:r,clients:i}){var _;const{addNotification:s}=pn(),[o,l]=ue.useState({}),[c,u]=ue.useState(""),[f,v]=ue.useState(""),[g,p]=ue.useState(""),[S,k]=ue.useState(!1),[C,b]=ue.useState(""),[I,R]=ue.useState(!1),D=["Activo","Periodo de Gracia Vencido","Pendiente Pago","Pago","Cancelado"],ee=()=>{const M=new Date,K=M.getFullYear().toString().slice(-2),F=(M.getMonth()+1).toString().padStart(2,"0"),X=M.getDate().toString().padStart(2,"0"),H=M.getTime().toString().slice(-6);return`SRV-${K}${F}${X}-${H}`},oe=(M,K)=>{if(!M||M==="One-Time"||!K)return{startDate:"",endDate:""};const F=new Date(K);let X=new Date(F);switch(M){case"Monthly":X.setMonth(X.getMonth()+1);break;case"Semiannually":X.setMonth(X.getMonth()+6);break;case"Annually":X.setFullYear(X.getFullYear()+1);break;case"Biennially":X.setFullYear(X.getFullYear()+2);break;case"Triennially":X.setFullYear(X.getFullYear()+3);break;case"Custom":return{startDate:F.toISOString().split("T")[0],endDate:""};default:if(M&&M!=="Custom"&&M!=="One-Time"){const H=M.match(/(\d+)\s*mes/i),W=M.match(/(\d+)\s*ao/i);if(H){const Y=parseInt(H[1]);X.setMonth(X.getMonth()+Y)}else if(W){const Y=parseInt(W[1]);X.setFullYear(X.getFullYear()+Y)}else return{startDate:F.toISOString().split("T")[0],endDate:""}}else return{startDate:"",endDate:""};break}return{startDate:F.toISOString().split("T")[0],endDate:X.toISOString().split("T")[0]}},V=()=>[{value:"One-Time",label:"Pago nico"},{value:"Monthly",label:"Mensual"},{value:"Semiannually",label:"Semestral"},{value:"Annually",label:"Anual"},{value:"Biennially",label:"Bianual (2 aos)"},{value:"Triennially",label:"Trienal (3 aos)"},{value:"Custom",label:"Otros"}];ue.useEffect(()=>{const M={clientName:"",clientEmail:"",serviceType:"Hosting",description:"",amount:"",currency:"USD",dueDate:"",billingCycle:"One-Time",status:"Activo",clientNotes:"",adminNotes:"",assignedUserId:""};if(r){l({...r,dueDate:r.dueDate?new Date(r.dueDate.seconds*1e3).toISOString().split("T")[0]:"",assignedUserId:r.assignedUserId||""}),v(r.serviceNumber||"");const K=["Hosting","Dominio","Dominio + Hosting"];r.serviceType&&!K.includes(r.serviceType)?(b(r.serviceType),R(!0)):(b(""),R(!1));const F=["One-Time","Monthly","Semiannually","Annually","Biennially","Triennially"];if(r.billingCycle&&!F.includes(r.billingCycle)?(p(r.billingCycle),k(!0)):(p(""),k(!1)),r.assignedUserId){const X=i.find(H=>H.id===r.assignedUserId);X&&u(X.email)}}else{const K=ee();l(M),u(""),v(K),b(""),R(!1),p(""),k(!1)}},[r,i]);const T=M=>{const{name:K,value:F}=M.target;l(X=>({...X,[K]:F})),K==="billingCycle"&&(F==="Custom"?k(!0):(k(!1),p(""))),K==="serviceType"&&(F==="Otro"?R(!0):(R(!1),b("")))},N=M=>{const K=M.target.value;p(K),l(F=>({...F,billingCycle:K||"Custom"}))},U=M=>{const K=M.target.value;b(K),l(F=>({...F,serviceType:K||"Otro"}))},E=M=>{u(M);const K=i.find(F=>F.email===M);l(K?F=>({...F,clientEmail:K.email,clientName:K.fullName||K.email.split("@")[0],assignedUserId:K.id}):F=>({...F,assignedUserId:""}))},L=async M=>{M.preventDefault();try{const K={...o,amount:parseFloat(o.amount),dueDate:ft.fromDate(new Date(o.dueDate)),serviceNumber:f};await n(K),s(`Servicio ${r?"actualizado":"creado"} exitosamente.`,"success"),e()}catch(K){s("Error al guardar el servicio.","error"),console.error(K)}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:r?"Editar Servicio":"Aadir Nuevo Servicio"}),a.jsxs("form",{onSubmit:L,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nmero de Servicio"}),a.jsx("input",{type:"text",value:f,onChange:M=>v(M.target.value),className:"w-full p-2 border rounded-md bg-gray-50 font-mono",placeholder:"SRV-YYMMDD-XXXXXX",required:!0}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Identificador nico del servicio"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asignar a Cliente Existente"}),a.jsxs("select",{value:c,onChange:M=>E(M.target.value),className:"w-full p-2 border rounded-md bg-gray-50",children:[a.jsx("option",{value:"",children:"-- Opcional --"}),i.map(M=>a.jsx("option",{value:M.email,children:M.fullName||M.email},M.id))]}),c&&a.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[" Servicio asignado a: ",((_=i.find(M=>M.email===c))==null?void 0:_.fullName)||c]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"clientName",value:o.clientName||"",onChange:T,placeholder:"Nombre del Cliente",className:"w-full p-2 border rounded-md",required:!0}),a.jsx("input",{name:"clientEmail",type:"email",value:o.clientEmail||"",onChange:T,placeholder:"Email del Cliente",className:"w-full p-2 border rounded-md",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Servicio"}),a.jsxs("select",{name:"serviceType",value:o.serviceType||"Hosting",onChange:T,className:"w-full p-2 border rounded-md",children:[a.jsx("option",{children:"Hosting"}),a.jsx("option",{children:"Dominio"}),a.jsx("option",{children:"Dominio + Hosting"}),a.jsx("option",{children:"Otro"})]}),I&&a.jsxs("div",{className:"mt-2",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Especificar tipo de servicio personalizado"}),a.jsx("input",{type:"text",value:C,onChange:U,placeholder:"Ej: VPS, Cloud Storage, SSL, etc.",className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Escribe el tipo de servicio especfico que ofreces"})]})]}),a.jsx("input",{name:"description",value:o.description||"",onChange:T,placeholder:"Descripcin (ej: plan, dominio.com)",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx("input",{name:"amount",type:"number",step:"0.01",value:o.amount||"",onChange:T,placeholder:"Monto",className:"w-full p-2 border rounded-md",required:!0}),a.jsxs("select",{name:"currency",value:o.currency||"USD",onChange:T,className:"w-full p-2 border rounded-md",children:[a.jsx("option",{children:"USD"}),a.jsx("option",{children:"COP"})]}),a.jsx("input",{name:"dueDate",type:"date",value:o.dueDate||"",onChange:T,className:"w-full p-2 border rounded-md",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ciclo de Facturacin"}),a.jsx("select",{name:"billingCycle",value:o.billingCycle||"One-Time",onChange:T,className:"w-full p-2 border rounded-md",children:V().map(M=>a.jsx("option",{value:M.value,children:M.label},M.value))}),S&&a.jsxs("div",{className:"mt-2",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Especificar ciclo personalizado"}),a.jsx("input",{type:"text",value:g,onChange:N,placeholder:"Ej: 6 meses, 18 meses, 2 aos, etc.",className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Puedes escribir el perodo en meses o aos (ej: "6 meses", "2 aos")'})]})]}),a.jsx("select",{name:"status",value:o.status||"Activo",onChange:T,className:"w-full p-2 border rounded-md",children:D.map(M=>a.jsx("option",{value:M,children:M},M))})]}),o.billingCycle&&o.billingCycle!=="One-Time"&&o.dueDate&&a.jsxs("div",{className:"bg-blue-50 p-4 rounded-md",children:[a.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Perodo del Servicio"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-blue-700 mb-1",children:"Fecha de Inicio"}),a.jsx("input",{type:"date",value:oe(o.billingCycle,o.dueDate).startDate,readOnly:!0,className:"w-full p-2 border border-blue-200 rounded-md bg-blue-50 text-blue-800"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-blue-700 mb-1",children:"Fecha de Vencimiento"}),a.jsx("input",{type:"date",value:oe(o.billingCycle,o.dueDate).endDate,readOnly:!0,className:"w-full p-2 border border-blue-200 rounded-md bg-blue-50 text-blue-800"})]})]})]}),o.billingCycle==="One-Time"&&a.jsxs("div",{className:"bg-yellow-50 p-4 rounded-md",children:[a.jsx("h4",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Pago nico"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"radio",id:"activation-only",name:"oneTimeType",value:"activation-only",className:"text-yellow-600"}),a.jsx("label",{htmlFor:"activation-only",className:"text-sm text-yellow-700",children:"Solo fecha de activacin (sin expiracin)"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"radio",id:"with-expiration",name:"oneTimeType",value:"with-expiration",className:"text-yellow-600"}),a.jsx("label",{htmlFor:"with-expiration",className:"text-sm text-yellow-700",children:"Con fecha de expiracin"})]}),a.jsxs("div",{className:"ml-6",children:[a.jsx("label",{className:"block text-xs font-medium text-yellow-700 mb-1",children:"Hasta qu fecha expira"}),a.jsx("input",{type:"date",name:"expirationDate",value:o.expirationDate||"",onChange:T,className:"w-full p-2 border border-yellow-200 rounded-md"})]})]})]}),a.jsx("textarea",{name:"clientNotes",value:o.clientNotes||"",onChange:T,placeholder:"Notas para el cliente (visible en su portal)",rows:"3",className:"w-full p-2 border rounded-md"}),a.jsx("textarea",{name:"adminNotes",value:o.adminNotes||"",onChange:T,placeholder:"Notas internas (solo para administrador)",rows:"3",className:"w-full p-2 border rounded-md"}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Guardar Servicio"})]})]})]})}):null}function x8({isOpen:t,onClose:e,onSend:n,service:r,templates:i,companySettings:s}){const{addNotification:o}=pn(),[l,c]=ue.useState(""),[u,f]=ue.useState(""),[v,g]=ue.useState("");if(ue.useEffect(()=>{var S;i.length>0&&t&&c(((S=i[0])==null?void 0:S.id)||"")},[i,t]),ue.useEffect(()=>{var S;if(l&&r){const k=i.find(C=>C.id===l);if(k){const C=r.dueDate?new Date(r.dueDate.seconds*1e3).toLocaleDateString():"N/A",b={"{clientName}":r.clientName||"","{serviceType}":r.serviceType||"","{description}":r.description||"","{amount}":`$${(S=r.amount)==null?void 0:S.toFixed(2)} ${r.currency}`||"","{dueDate}":C,"{companyName}":s.companyName||"Tu Empresa"};let I=k.subject,R=k.body;for(const D in b){const ee=new RegExp(D.replace(/[-\\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g");I=I.replace(ee,b[D]),R=R.replace(ee,b[D])}f(I),g(R)}}},[l,r,i,s]),!t)return null;const p=()=>{var S;n({to:r.clientEmail,subject:u,body:v,reason:`Notificacin Manual: ${((S=i.find(k=>k.id===l))==null?void 0:S.name)||"Mensaje Personalizado"}`}),e()};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full",children:[a.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Enviar Notificacin a ",r.clientName]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Seleccionar Plantilla"}),a.jsx("select",{value:l,onChange:S=>c(S.target.value),className:"mt-1 w-full p-2 border rounded-md",children:i.map(S=>a.jsx("option",{value:S.id,children:S.name},S.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Asunto"}),a.jsx("input",{type:"text",value:u,onChange:S=>f(S.target.value),className:"mt-1 w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cuerpo del Mensaje (Editable)"}),a.jsx("textarea",{value:v,onChange:S=>g(S.target.value),rows:"10",className:"mt-1 w-full p-2 border rounded-md font-mono text-sm"})]})]}),a.jsxs("div",{className:"flex justify-end gap-4 mt-8",children:[a.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),a.jsx("button",{onClick:p,className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Enviar"})]})]})})}let rt=null;const Nr=async()=>{try{const t=ut(Ve,"artifacts",Fe,"public","data","settings","email_config"),e=await vs(t);return e.exists()?(rt=e.data(),rt):(rt={provider:"smtp",smtpHost:"",smtpPort:587,smtpSecure:!1,smtpUser:"",smtpPassword:"",zohoClientId:"",zohoClientSecret:"",zohoRefreshToken:"",zohoAccessToken:"",zohoAccessTokenExpiry:null,fromEmail:"",fromName:"",enabled:!1},rt)}catch(t){return console.error("Error loading email config:",t),null}},b8=async()=>{try{const t=ut(Ve,"artifacts",Fe,"public","data","settings","notification_settings"),e=await vs(t);return e.exists()?e.data():{admin:{payments:{approval:!0,rejection:!0,newPayment:!0},services:{expirationReminder:!0,newService:!0},users:{newUser:!0,userActivation:!0},tickets:{newTicket:!0,ticketUpdate:!0},renewals:{renewalRequest:!0}},client:{payments:{approval:!0,rejection:!0,pendingPayment:!0},services:{expirationReminder:!0,serviceActivated:!0,serviceExpired:!0},tickets:{ticketReply:!0,ticketResolved:!0},renewals:{renewalReminder:!0,renewalConfirmed:!0}}}}catch(t){return console.error("Error loading notification settings:",t),null}},w8=async(t,e,n)=>{var i,s;const r=await b8();return r?((s=(i=r[t])==null?void 0:i[e])==null?void 0:s[n])??!0:!0},fr=async({to:t,toName:e,subject:n,html:r,text:i,type:s="Notificacin",recipientType:o="Cliente",module:l="system",event:c="notification",metadata:u={}})=>{try{if(!rt||!rt.enabled){console.warn(" Email service not configured or disabled"),console.log(" Registrando mensaje como fallido en historial");const v=await ql({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Fallido",errorMessage:"Servicio de email no configurado",module:l,event:c,metadata:u});return console.log(" Mensaje registrado con ID:",v),{success:!1,error:"Email service not configured",messageId:v}}if(!await w8(o==="Cliente"?"client":"admin",l,c))return console.log(`Notification disabled: ${o}/${l}/${c}`),await ql({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Cancelado",errorMessage:"Notificacin deshabilitada por configuracin",module:l,event:c,metadata:u}),{success:!1,error:"Notification disabled"};try{if(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")return console.warn(" Modo desarrollo: El endpoint PHP no est disponible localmente. El email se registrar como simulado."),{success:!0,messageId:await ql({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Simulado",simulated:!0,errorMessage:" Email no enviado. En desarrollo local, el servidor PHP no est disponible. Despliega en produccin para envo real.",module:l,event:c,metadata:u}),simulated:!0,warning:"En desarrollo local, el email no se enva realmente. Despliega en produccin para envo real."};const g=rt.provider||"smtp";let p="/send-email.php",S={};if(g==="zoho"){if(p="/send-zoho.php",!rt.zohoClientId||!rt.zohoClientSecret||!rt.zohoRefreshToken||!rt.fromEmail)throw new Error("Configuracin de Zoho Mail incompleta. Verifica Client ID, Client Secret, Refresh Token y From Email.");S={to:t,toName:e,subject:n,html:r,text:i,zohoConfig:{clientId:rt.zohoClientId,clientSecret:rt.zohoClientSecret,refreshToken:rt.zohoRefreshToken,fromEmail:rt.fromEmail,fromName:rt.fromName}}}else S={to:t,toName:e,subject:n,html:r,text:i,smtpConfig:{smtpHost:rt.smtpHost,smtpPort:rt.smtpPort,smtpSecure:rt.smtpSecure,smtpUser:rt.smtpUser,smtpPassword:rt.smtpPassword,fromEmail:rt.fromEmail,fromName:rt.fromName}};const k=await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)}).catch(I=>{throw console.error("Error de red al llamar send-email.php:",I),new Error(`No se pudo conectar con el servidor PHP. Verifica que send-email.php est en el servidor. Error: ${I.message}`)});if(!k.ok){const I=await k.text().catch(()=>"No se pudo leer la respuesta del servidor");throw console.error("Error HTTP:",k.status,I),k.status===404?new Error("El archivo send-email.php no se encontr en el servidor (404). Verifica que est en el directorio raz."):new Error(`Error del servidor (${k.status}): ${I.substring(0,200)}`)}const C=k.headers.get("content-type");if(!C||!C.includes("application/json")){const I=await k.text().catch(()=>"No se pudo leer la respuesta");throw console.error("Respuesta no es JSON:",I.substring(0,200)),I.includes("<html")||I.includes("<!DOCTYPE")?new Error("El servidor devolvi HTML en lugar de JSON. Posiblemente PHP no est configurado o hay un error en send-email.php."):new Error(`El servidor no devolvi JSON. Respuesta: ${I.substring(0,200)}`)}let b;try{b=await k.json()}catch(I){const R=await k.text().catch(()=>"No se pudo leer la respuesta");throw console.error("Error al parsear JSON:",I,"Respuesta:",R.substring(0,200)),new Error(`Respuesta invlida del servidor (no es JSON vlido): ${R.substring(0,200)}`)}if(b.success){if(g==="zoho"&&b.accessToken&&b.expiresAt)try{const R=ut(Ve,"artifacts",Fe,"public","data","settings","email_config");await ws(R,{zohoAccessToken:b.accessToken,zohoAccessTokenExpiry:b.expiresAt},{merge:!0}),rt.zohoAccessToken=b.accessToken,rt.zohoAccessTokenExpiry=b.expiresAt}catch(R){console.warn("No se pudo actualizar el access token en Firestore:",R)}return{success:!0,messageId:await ql({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Enviado",module:l,event:c,metadata:u,provider:g,externalId:b.zohoMessageId||null}),sent:!0,provider:g}}else{const I=b.error||"Error desconocido al enviar email",R=b.details||"",D=R?`${I}

${R}`:I,ee=await ql({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Fallido",errorMessage:D,module:l,event:c,metadata:u});return{success:!1,error:I,details:R,smtpInfo:b.smtp_host?{host:b.smtp_host,port:b.smtp_port,user:b.smtp_user}:null,messageId:ee}}}catch(v){console.error("Error al llamar a send-email.php:",v);const g=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",p=g?` Servidor PHP no disponible en desarrollo local: ${v.message}`:` Error al enviar email: ${v.message}`,S=await ql({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:g?"Simulado":"Fallido",simulated:g,errorMessage:p,module:l,event:c,metadata:u});return{success:!1,error:p,messageId:S,simulated:g}}}catch(f){return console.error("Error sending email:",f),await ql({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Fallido",errorMessage:f.message,module:l,event:c,metadata:u}),{success:!1,error:f.message}}},ql=async t=>{try{console.log(" Registrando mensaje en Firestore:",{to:t.to,subject:t.subject,type:t.type,recipientType:t.recipientType,module:t.module,event:t.event});const e=Ut(Ve,"artifacts",Fe,"public","data","messages"),n=(rt==null?void 0:rt.provider)||"smtp",r={...t,channel:"email",provider:n,sentAt:ft.now(),createdAt:ft.now(),updatedAt:ft.now()};console.log(" Datos del mensaje a guardar:",r);const i=await Sa(e,r);return console.log(" Mensaje registrado exitosamente con ID:",i.id),i.id}catch(e){return console.error(" Error registering message:",e),console.error(" Detalles del error:",e.message,e.code,e.stack),null}},N8=async t=>{try{if(await Nr(),!rt||!rt.enabled)return{success:!1,error:"Email service not configured or disabled"};const e=rt.provider||"smtp";if(e==="zoho"){if(!rt.zohoClientId||!rt.zohoClientSecret||!rt.zohoRefreshToken||!rt.fromEmail)return{success:!1,error:"Configuracin de Zoho Mail incompleta. Verifica Client ID, Client Secret, Refresh Token y From Email."}}else if(!rt.smtpHost||!rt.smtpUser||!rt.fromEmail)return{success:!1,error:"Configuracin SMTP incompleta. Verifica todos los campos."};const n=" Prueba de Configuracin - Gestor de Cobros",r=new Date().toLocaleString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"}),i=`
      <!DOCTYPE html>
      <html lang="es">
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
          body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
          .container { max-width: 600px; margin: 0 auto; padding: 20px; background-color: #f9fafb; }
          .header { background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; }
          .content { background: white; padding: 30px; border-radius: 0 0 10px 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
          .success-badge { display: inline-block; background-color: #10b981; color: white; padding: 8px 16px; border-radius: 20px; font-size: 14px; font-weight: bold; margin-bottom: 20px; }
          .info-box { background-color: #eff6ff; border-left: 4px solid #2563eb; padding: 15px; margin: 20px 0; border-radius: 4px; }
          .config-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
          .config-table td { padding: 10px; border-bottom: 1px solid #e5e7eb; }
          .config-table td:first-child { font-weight: bold; color: #374151; width: 40%; }
          .config-table td:last-child { color: #6b7280; font-family: monospace; }
          .footer { text-align: center; color: #6b7280; font-size: 12px; margin-top: 30px; padding-top: 20px; border-top: 1px solid #e5e7eb; }
          .highlight { background-color: #fef3c7; padding: 2px 6px; border-radius: 3px; }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="header">
            <h1 style="margin: 0; font-size: 28px;"> Prueba de Configuracin</h1>
            <p style="margin: 10px 0 0 0; opacity: 0.9;">Gestor de Cobros - Sistema de Email</p>
          </div>
          
          <div class="content">
            <div class="success-badge"> Configuracin Exitosa</div>
            
            <h2 style="color: #1f2937; margin-top: 0;">Email de Prueba Enviado Correctamente!</h2>
            
            <p>Este es un email de prueba para verificar que tu configuracin SMTP est funcionando correctamente.</p>
            
            <div class="info-box">
              <strong> Informacin Importante:</strong><br>
              Si recibiste este email, significa que tu servidor SMTP est configurado y funcionando perfectamente.
              Los emails del sistema ahora se enviarn realmente a tus clientes y administradores.
            </div>
            
            <h3 style="color: #374151; margin-top: 30px;"> Detalles de Configuracin ${e==="zoho"?"Zoho Mail API":"SMTP"}</h3>
            
            <table class="config-table">
              ${e==="zoho"?`
              <tr>
                <td>Proveedor:</td>
                <td><span class="highlight">Zoho Mail API</span></td>
              </tr>
              <tr>
                <td>Client ID:</td>
                <td><span class="highlight">${rt.zohoClientId?rt.zohoClientId.substring(0,20)+"...":"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Email Remitente:</td>
                <td><span class="highlight">${rt.fromEmail||"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Nombre Remitente:</td>
                <td><span class="highlight">${rt.fromName||"No configurado"}</span></td>
              </tr>
              `:`
              <tr>
                <td>Proveedor:</td>
                <td><span class="highlight">SMTP</span></td>
              </tr>
              <tr>
                <td>Servidor SMTP:</td>
                <td><span class="highlight">${rt.smtpHost||"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Puerto:</td>
                <td><span class="highlight">${rt.smtpPort||"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Seguridad:</td>
                <td><span class="highlight">${rt.smtpSecure?"SSL/TLS ":"No seguro"}</span></td>
              </tr>
              <tr>
                <td>Usuario SMTP:</td>
                <td><span class="highlight">${rt.smtpUser||"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Email Remitente:</td>
                <td><span class="highlight">${rt.fromEmail||"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Nombre Remitente:</td>
                <td><span class="highlight">${rt.fromName||"No configurado"}</span></td>
              </tr>
              `}
            </table>
            
            <h3 style="color: #374151; margin-top: 30px;"> Informacin del Envo</h3>
            
            <table class="config-table">
              <tr>
                <td>Destinatario:</td>
                <td><span class="highlight">${t}</span></td>
              </tr>
              <tr>
                <td>Fecha y Hora:</td>
                <td>${r}</td>
              </tr>
              <tr>
                <td>Estado:</td>
                <td><strong style="color: #10b981;"> Enviado Exitosamente</strong></td>
              </tr>
            </table>
            
            <div class="info-box" style="background-color: #f0fdf4; border-left-color: #10b981; margin-top: 30px;">
              <strong> Prximos Pasos:</strong><br>
              <ul style="margin: 10px 0 0 20px; padding-left: 0;">
                <li>Verifica que este email lleg correctamente (revisa tambin spam)</li>
                <li>Los emails del sistema ahora se enviarn automticamente</li>
                <li>Puedes verificar el historial de mensajes en el panel de administracin</li>
                <li>Si necesitas cambiar la configuracin, ve a <strong>Mensajes  Configuracin de Email</strong></li>
              </ul>
            </div>
            
            <div class="footer">
              <p style="margin: 0;">
                <strong>Gestor de Cobros</strong><br>
                Sistema de Gestin de Servicios y Pagos<br>
                ${new Date().getFullYear()}  Todos los derechos reservados
              </p>
              <p style="margin: 10px 0 0 0; font-size: 11px; color: #9ca3af;">
                Este es un email automtico del sistema. Por favor, no respondas a este mensaje.
              </p>
            </div>
          </div>
        </div>
      </body>
      </html>
    `,s=`

  PRUEBA DE CONFIGURACIN - GESTOR DE COBROS


Email de Prueba Enviado Correctamente!

Este es un email de prueba para verificar que tu configuracin SMTP est funcionando correctamente.

 INFORMACIN IMPORTANTE:

Si recibiste este email, significa que tu servidor SMTP est configurado y funcionando perfectamente. Los emails del sistema ahora se enviarn realmente a tus clientes y administradores.

 DETALLES DE CONFIGURACIN ${e==="zoho"?"ZOHO MAIL API":"SMTP"}:

${e==="zoho"?`
Proveedor: Zoho Mail API
Client ID: ${rt.zohoClientId?rt.zohoClientId.substring(0,20)+"...":"No configurado"}
Email Remitente: ${rt.fromEmail||"No configurado"}
Nombre Remitente: ${rt.fromName||"No configurado"}
`:`
Proveedor: SMTP
Servidor SMTP: ${rt.smtpHost||"No configurado"}
Puerto: ${rt.smtpPort||"No configurado"}
Seguridad: ${rt.smtpSecure?"SSL/TLS ":"No seguro"}
Usuario SMTP: ${rt.smtpUser||"No configurado"}
Email Remitente: ${rt.fromEmail||"No configurado"}
Nombre Remitente: ${rt.fromName||"No configurado"}
`}

 INFORMACIN DEL ENVO:

Destinatario: ${t}
Fecha y Hora: ${r}
Estado:  Enviado Exitosamente

 PRXIMOS PASOS:

 Verifica que este email lleg correctamente (revisa tambin spam)
 Los emails del sistema ahora se enviarn automticamente
 Puedes verificar el historial de mensajes en el panel de administracin
 Si necesitas cambiar la configuracin, ve a Mensajes  Configuracin de Email


Gestor de Cobros
Sistema de Gestin de Servicios y Pagos
${new Date().getFullYear()}  Todos los derechos reservados

Este es un email automtico del sistema. Por favor, no respondas a este mensaje.

    `;return await fr({to:t,toName:"Usuario de Prueba",subject:n,html:i,text:s,type:"Sistema",recipientType:"Administrador",module:"system",event:"test",metadata:{isTest:!0}})}catch(e){return console.error("Error testing email:",e),{success:!1,error:e.message}}};Nr().then(t=>{rt=t});function _8({userRole:t}){const{addNotification:e}=pn(),[n,r]=ue.useState([]),[i,s]=ue.useState([]),[o,l]=ue.useState(!1),[c,u]=ue.useState(null),[f,v]=ue.useState("Todos"),[g,p]=ue.useState(""),[S,k]=ue.useState(!1),[C,b]=ue.useState([]),[I,R]=ue.useState({}),D=["Activo","Periodo de Gracia Vencido","Pendiente Pago","Pago","Cancelado"];ue.useEffect(()=>{const K=Ut(Ve,"artifacts",Fe,"public","data","services"),F=An(K,Fu("dueDate","desc")),X=Gt(F,te=>{r(te.docs.map(le=>({id:le.id,...le.data()})))}),H=Ut(Ve,"artifacts",Fe,"public","data","users"),W=An(H,cr("role","==","client")),Y=Gt(W,te=>{s(te.docs.map(le=>({id:le.id,...le.data()})))}),B=Ut(Ve,"artifacts",Fe,"public","data","messageTemplates"),A=Gt(B,te=>{b(te.docs.map(le=>({id:le.id,...le.data()})))}),P=ut(Ve,"artifacts",Fe,"public","data","settings","company"),q=Gt(P,te=>{te.exists()&&R(te.data())});return()=>{X(),Y(),A(),q()}},[]);const ee=async K=>{const F=Ut(Ve,"artifacts",Fe,"public","data","services");try{if(K.id){const{id:X,...H}=K;await gr(ut(F,X),H)}else await Sa(F,{...K,createdAt:ft.now()})}catch(X){throw X}},oe=async K=>{if(window.confirm("Seguro que quieres eliminar este servicio?"))try{await yl(ut(Ve,"artifacts",Fe,"public","data","services",K)),e("Servicio eliminado.","success")}catch{e("Error al eliminar el servicio.","error")}},V=async K=>{try{console.log(" [SERVICES] Iniciando envo de notificacin manual"),await Nr();const F=(c==null?void 0:c.clientName)||"Cliente",X=K.to,H=K.subject,W=K.body,Y=K.reason||"Notificacin Manual",B=W.replace(/\n/g,"<br>");console.log(" [SERVICES] Enviando email al cliente:",X);const A=await fr({to:X,toName:F,subject:H,html:`
          <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
            <h2 style="color: #333;">${H}</h2>
            <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
              ${B}
            </div>
            <p style="color: #666; font-size: 12px; margin-top: 20px;">
              Este es un mensaje automtico del sistema de gestin.
            </p>
          </div>
        `,text:W,type:"Notificacin",recipientType:"Cliente",module:"services",event:"expirationReminder",metadata:{serviceId:c==null?void 0:c.id,serviceType:c==null?void 0:c.serviceType,reason:Y,manualNotification:!0}});A.success?(console.log(" [SERVICES] Notificacin enviada exitosamente"),e("Notificacin enviada exitosamente","success")):(console.error(" [SERVICES] Error al enviar notificacin:",A.error),e(`Notificacin registrada pero no enviada: ${A.error}`,"warning"))}catch(F){console.error(" [SERVICES] Error sending notification:",F),e(`Error al enviar la notificacin: ${F.message}`,"error")}},T=async(K,F)=>{try{await gr(ut(Ve,"artifacts",Fe,"public","data","services",K),{status:F}),e("Estado actualizado.","success")}catch{e("Error al actualizar estado.","error")}},N=K=>K.status==="Pendiente Pago"&&K.dueDate&&K.dueDate.toDate()<new Date?"Periodo de Gracia Vencido":K.status,U=(K,F)=>{if(!F)return"text-gray-500";const X=new Date,W=(F.toDate()-X)/(1e3*60*60*24);return K==="Pago"?"text-green-600":K==="Cancelado"?"text-gray-500":K==="Periodo de Gracia Vencido"||W<0?"text-red-600 font-bold":K==="Pendiente Pago"&&W<7?"text-yellow-600 font-semibold":K==="Activo"?"text-blue-600":"text-gray-700"},E=K=>{if(!K.dueDate||!K.billingCycle||K.billingCycle==="One-Time")return K.expirationDate?K.expirationDate.toDate().toLocaleDateString():"N/A";const F=K.dueDate.toDate();let X=new Date(F);switch(K.billingCycle){case"Monthly":X.setMonth(X.getMonth()+1);break;case"Semiannually":X.setMonth(X.getMonth()+6);break;case"Annually":X.setFullYear(X.getFullYear()+1);break;case"Biennially":X.setFullYear(X.getFullYear()+2);break;case"Triennially":X.setFullYear(X.getFullYear()+3);break;default:return"N/A"}return X.toLocaleDateString()},L=K=>({"One-Time":"Pago nico",Monthly:"Mensual",Semiannually:"Semestral",Annually:"Anual",Biennially:"Bianual",Triennially:"Trienal",Custom:"Personalizado"})[K]||K,_=K=>{u(K),k(!0)},M=n.filter(K=>f==="Todos"||N(K)===f).filter(K=>{var H,W,Y,B,A,P,q,te,le,ce;if(!g)return!0;const F=g.toLowerCase(),X=N(K);return((H=K.clientName)==null?void 0:H.toLowerCase().includes(F))||((W=K.clientEmail)==null?void 0:W.toLowerCase().includes(F))||((Y=K.serviceType)==null?void 0:Y.toLowerCase().includes(F))||((B=K.description)==null?void 0:B.toLowerCase().includes(F))||((A=K.amount)==null?void 0:A.toString().includes(F))||((P=K.currency)==null?void 0:P.toLowerCase().includes(F))||((q=K.billingCycle)==null?void 0:q.toLowerCase().includes(F))||(X==null?void 0:X.toLowerCase().includes(F))||((te=K.clientNotes)==null?void 0:te.toLowerCase().includes(F))||((le=K.adminNotes)==null?void 0:le.toLowerCase().includes(F))||K.dueDate&&new Date(K.dueDate.seconds*1e3).toLocaleDateString().includes(F)||K.dueDate&&((ce=K.dueDate.seconds)==null?void 0:ce.toString().includes(F))});return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[["Todos",...D].map(K=>a.jsx("button",{onClick:()=>v(K),className:`px-4 py-2 rounded-full text-sm font-semibold transition-colors ${f===K?"bg-blue-600 text-white shadow-lg":"bg-white hover:bg-gray-100"}`,children:K},K)),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar en toda la tabla...",value:g,onChange:K=>p(K.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full sm:w-64"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Uu,{})})]})]}),a.jsxs("button",{onClick:()=>{u(null),l(!0)},className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700",children:[a.jsx(Uh,{})," ",a.jsx("span",{className:"hidden sm:inline",children:"Nuevo Servicio"})]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Nmero","Cliente","Servicio","Monto","Ciclo","Fecha de Inicio","Fecha de Vencimiento","Notas","Estado","Acciones"].map(K=>a.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:K},K))})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:M.map(K=>{var X;const F=N(K);return a.jsxs("tr",{children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:K.serviceNumber||"N/A"})}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-medium",children:K.clientName}),a.jsx("div",{className:"text-sm text-gray-500",children:K.clientEmail})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-semibold",children:K.serviceType}),a.jsx("div",{className:"text-sm text-gray-600",children:K.description})]}),a.jsxs("td",{className:"px-6 py-4 font-semibold",children:[(X=K.amount)==null?void 0:X.toFixed(2)," ",K.currency]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:L(K.billingCycle)}),K.billingCycle==="Custom"&&K.customBillingCycle&&a.jsxs("div",{className:"text-xs text-gray-500",children:["(",K.customBillingCycle,")"]})]}),a.jsxs("td",{className:`px-6 py-4 ${U(F,K.dueDate)}`,children:[a.jsx("div",{className:"text-sm",children:K.dueDate?K.dueDate.toDate().toLocaleDateString():"N/A"}),a.jsx("div",{className:"text-xs text-gray-500",children:"Inicio"})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:E(K)}),a.jsx("div",{className:"text-xs text-gray-500",children:"Vencimiento"})]}),a.jsxs("td",{className:"px-6 py-4 text-xs max-w-xs",children:[K.clientNotes&&a.jsxs("div",{className:"truncate",title:K.clientNotes,children:[a.jsx("strong",{children:"Cliente:"})," ",K.clientNotes]}),K.adminNotes&&a.jsxs("div",{className:"truncate text-purple-600 mt-1",title:K.adminNotes,children:[a.jsx("strong",{children:"Admin:"})," ",K.adminNotes]})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("select",{value:K.status,onChange:H=>T(K.id,H.target.value),className:"p-1 text-xs rounded-md border-gray-300 bg-white shadow-sm w-full",children:D.map(H=>a.jsx("option",{value:H,children:H},H))})}),a.jsx("td",{className:"px-6 py-4 text-center",children:a.jsxs(Vh,{children:[a.jsx("button",{onClick:()=>{u(K),l(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Editar"}),a.jsx("button",{onClick:()=>_(K),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Enviar Notificacin"}),a.jsx("button",{onClick:()=>oe(K.id),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"Eliminar"})]})})]},K.id)})})]})}),a.jsx(y8,{isOpen:o,onClose:()=>l(!1),onSave:ee,service:c,clients:i}),a.jsx(x8,{isOpen:S,onClose:()=>k(!1),onSend:V,service:c,templates:C,companySettings:I})]})}const lp=(t,e={},n={})=>{var u;if(!t||typeof t!="string")return t;const r=typeof window<"u"?window.location.origin:"",i=typeof window<"u"?window.location.origin:"",s=((u=n.companySettings)==null?void 0:u.companyName)||"Sistema de Gestin de Cobros",l={...{"{loginUrl}":r,"{clientPortalUrl}":i,"{clientLoginUrl}":r,"{resetPasswordUrl}":e.resetPasswordUrl||r+" (El enlace se generar automticamente)","{companyName}":s,"{clientName}":e.clientName||e.fullName||"Cliente","{clientEmail}":e.clientEmail||e.email||"","{clientPhone}":e.clientPhone||e.phone||"","{clientId}":e.clientId||e.userId||"","{serviceType}":e.serviceType||"","{description}":e.description||"","{serviceNumber}":e.serviceNumber||"","{amount}":e.amount||"0","{currency}":e.currency||"USD","{dueDate}":e.dueDate||"","{billingCycle}":e.billingCycle||"","{daysRemaining}":e.daysRemaining||e.daysUntilDue||"0","{daysOverdue}":e.daysOverdue||"0","{graceDays}":e.graceDays||"0","{remainingGraceDays}":e.remainingGraceDays||"0","{totalPending}":e.totalPending||"0","{potentialRevenue}":e.potentialRevenue||"0","{paymentHistory}":e.paymentHistory||"N/A","{clientSince}":e.clientSince||"","{previousPayments}":e.previousPayments||"0","{paymentPattern}":e.paymentPattern||"N/A","{riskLevel}":e.riskLevel||"N/A","{lastContact}":e.lastContact||"N/A","{suspensionDate}":e.suspensionDate||"","{reactivationCost}":e.reactivationCost||"0","{clientValue}":e.clientValue||"0","{recoveryProbability}":e.recoveryProbability||"0","{paymentDate}":e.paymentDate||new Date().toLocaleDateString("es-ES"),"{paymentMethod}":e.paymentMethod||"","{paymentReference}":e.paymentReference||"","{nextDueDate}":e.nextDueDate||"","{paymentTime}":e.paymentTime||"0","{collectionEfficiency}":e.collectionEfficiency||"0","{clientSatisfaction}":e.clientSatisfaction||"N/A","{monthlyRevenue}":e.monthlyRevenue||"0","{registrationDate}":e.registrationDate||"","{growthPotential}":e.growthPotential||"N/A","{clientSegment}":e.clientSegment||"N/A","{acquisitionSource}":e.acquisitionSource||"N/A","{gracePeriod}":e.gracePeriod||"0","{communicationHistory}":e.communicationHistory||"N/A","{serviceTerms}":e.serviceTerms||"N/A","{suspensionPolicy}":e.suspensionPolicy||"N/A"},...e.replacements};let c=t;return Object.entries(l).forEach(([f,v])=>{const g=new RegExp(f.replace(/[-\\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g");c=c.replace(g,String(v))}),c},E8=()=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(let n=0;n<48;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},hA=async(t,e,n=24)=>{try{const r=Ut(Ve,"artifacts",Fe,"public","data","passwordResetTokens"),i=An(r,cr("userId","==",t),cr("used","==",!1));(await Na(i)).forEach(async c=>{await yl(ut(r,c.id))});const o=E8(),l=new Date;return l.setHours(l.getHours()+n),await Sa(r,{userId:t,email:e,token:o,expiresAt:ft.fromDate(l),createdAt:ft.now(),used:!1}),o}catch(r){throw console.error("Error creating password reset token:",r),r}},A8=async t=>{try{const e=Ut(Ve,"artifacts",Fe,"public","data","passwordResetTokens"),n=An(e,cr("token","==",t)),r=await Na(n);if(r.empty)return{valid:!1,userId:null,email:null,error:"Token no encontrado"};const i=r.docs[0],s=i.data();if(s.used)return{valid:!1,userId:null,email:null,error:"Este token ya fue utilizado"};const o=s.expiresAt.toDate();return new Date>o?{valid:!1,userId:null,email:null,error:"Este token ha expirado"}:{valid:!0,userId:s.userId,email:s.email,error:null,tokenDocId:i.id}}catch(e){return console.error("Error validating password reset token:",e),{valid:!1,userId:null,email:null,error:"Error al validar el token"}}};function S8({isOpen:t,onClose:e,onSave:n,user:r}){const{addNotification:i}=pn(),[s,o]=ue.useState({});ue.useEffect(()=>{r&&o(r)},[r]);const l=u=>{const{name:f,value:v}=u.target;o(g=>({...g,[f]:v}))},c=async u=>{u.preventDefault();try{await n(s),i("Usuario actualizado.","success"),e()}catch{i("Error al actualizar usuario.","error")}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-lg w-full",children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Editar Usuario"}),a.jsxs("form",{onSubmit:c,className:"space-y-4",children:[a.jsx("input",{name:"fullName",value:s.fullName||"",onChange:l,placeholder:"Nombre Completo",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"identification",value:s.identification||"",onChange:l,placeholder:"Identificacin",className:"w-full p-2 border rounded-md"}),a.jsx("input",{type:"email",value:s.email||"",readOnly:!0,disabled:!0,className:"w-full p-2 border rounded-md bg-gray-100"}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Guardar Cambios"})]})]})]})}):null}function k8({isOpen:t,onClose:e,onSave:n}){const{addNotification:r}=pn(),[i,s]=ue.useState(""),[o,l]=ue.useState(""),[c,u]=ue.useState(""),[f,v]=ue.useState(""),[g,p]=ue.useState("client"),[S,k]=ue.useState("active"),[C,b]=ue.useState(!1),[I,R]=ue.useState(""),D=[{value:"client",label:"Cliente"},{value:"admin",label:"Administrador"},{value:"superadmin",label:"Super Administrador"}],ee=[{value:"active",label:"Activo"},{value:"inactive",label:"Inactivo"},{value:"pending",label:"Pendiente"}],oe=()=>{s(""),l(""),u(""),v(""),p("client"),k("active"),b(!1),R("")},V=()=>{oe(),e()},T=async N=>{if(N.preventDefault(),!C&&o.length<6){R("La contrasea debe tener al menos 6 caracteres.");return}if(!C&&!o){R("Debes asignar una contrasea temporal cuando no se notifica por correo.");return}R("");try{await n({email:i,password:C?null:o,notify:C,fullName:c,identification:f,role:g,status:S}),e()}catch{r("Error al crear usuario.","error")}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-md w-full",children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Crear Nuevo Usuario"}),a.jsxs("form",{onSubmit:T,className:"space-y-4",children:[a.jsx("input",{type:"email",value:i,onChange:N=>s(N.target.value),placeholder:"Email del nuevo usuario",className:"w-full p-2 border rounded-md",required:!0}),!C&&a.jsx("input",{type:"password",value:o,onChange:N=>l(N.target.value),placeholder:"Contrasea temporal",className:"w-full p-2 border rounded-md",required:!0}),C&&a.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md",children:a.jsxs("p",{className:"text-sm text-blue-800",children:[a.jsx("strong",{children:"Nota:"}),' Al marcar "Notificar al usuario por correo", el usuario recibir un enlace para crear su propia contrasea de forma segura. No es necesario asignar una contrasea temporal.']})}),a.jsx("input",{value:c,onChange:N=>u(N.target.value),placeholder:"Nombre Completo",className:"w-full p-2 border rounded-md"}),a.jsx("input",{value:f,onChange:N=>v(N.target.value),placeholder:"Identificacin",className:"w-full p-2 border rounded-md"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),a.jsx("select",{value:g,onChange:N=>p(N.target.value),className:"w-full p-2 border rounded-md",required:!0,children:D.map(N=>a.jsx("option",{value:N.value,children:N.label},N.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),a.jsx("select",{value:S,onChange:N=>k(N.target.value),className:"w-full p-2 border rounded-md",required:!0,children:ee.map(N=>a.jsx("option",{value:N.value,children:N.label},N.value))})]})]}),I&&a.jsx("p",{className:"text-red-500 text-sm",children:I}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{id:"notify",type:"checkbox",checked:C,onChange:N=>b(N.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),a.jsx("label",{htmlFor:"notify",className:"ml-2 block text-sm text-gray-900",children:"Notificar al usuario por correo"})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[a.jsx("button",{type:"button",onClick:V,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Crear Usuario"})]})]})]})}):null}function T8({isOpen:t,onClose:e,user:n,onActivate:r,companySettings:i}){var C;const{addNotification:s}=pn(),[o,l]=ue.useState(""),[c,u]=ue.useState(""),[f,v]=ue.useState([]),[g,p]=ue.useState(!1),S=`Hola ${(n==null?void 0:n.fullName)||(n==null?void 0:n.email)},

Tu cuenta ha sido activada exitosamente en nuestro sistema de gestin de cobros.

Ahora puedes:
 Ver tus servicios contratados
 Crear tickets de soporte
 Gestionar tu perfil

Para acceder, simplemente inicia sesin con tu email y contrasea.

Bienvenido!

Equipo de Soporte`;ue.useEffect(()=>{if(!t)return;const b=Ut(Ve,"artifacts",Fe,"public","data","messageTemplates"),I=An(b,Fu("name")),R=Gt(I,D=>{const oe=D.docs.map(V=>({id:V.id,...V.data()})).filter(V=>(V.category||"client")==="client");v(oe)},D=>{console.error("Error loading templates:",D),v([])});return()=>R()},[t]),ue.useEffect(()=>{if(c){const b=f.find(I=>I.id===c);if(b){let I=b.body,R=b.subject;const D={"{clientName}":(n==null?void 0:n.fullName)||(n==null?void 0:n.email)||"","{clientEmail}":(n==null?void 0:n.email)||"","{companyName}":(i==null?void 0:i.companyName)||"Sistema de Gestin de Cobros"};Object.entries(D).forEach(([ee,oe])=>{I=I.replace(new RegExp(ee,"g"),oe),R=R.replace(new RegExp(ee,"g"),oe)}),l(I)}}},[c,f,n,i]);const k=async()=>{p(!0);try{console.log(" [USUARIOS] Activando usuario y enviando notificacin"),await r(),await Nr();let b=o||S,I=`Cuenta Activada - ${(i==null?void 0:i.companyName)||"Sistema de Gestin de Cobros"}`;if(c){const R=f.find(D=>D.id===c);if(R){let D=R.subject;const ee={"{clientName}":(n==null?void 0:n.fullName)||(n==null?void 0:n.email)||"","{clientEmail}":(n==null?void 0:n.email)||"","{companyName}":(i==null?void 0:i.companyName)||"Sistema de Gestin de Cobros"};Object.entries(ee).forEach(([oe,V])=>{D=D.replace(new RegExp(oe,"g"),V)}),I=D}}await fr({to:n.email,toName:n.fullName||n.email,subject:I,html:b.replace(/\n/g,"<br>"),text:b,type:"Activacin",recipientType:"Cliente",module:"users",event:"userActivation",metadata:{userId:n.id,userEmail:n.email,userRole:n.role}}),s(`Usuario ${n.email} activado y notificado exitosamente`,"success"),e()}catch(b){console.error("Error activating user:",b),s(`Error al activar usuario: ${b.message}`,"error")}finally{p(!1)}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Activar Usuario"}),a.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"Usuario a Activar:"}),a.jsxs("p",{className:"text-blue-700",children:[a.jsx("strong",{children:"Email:"})," ",n==null?void 0:n.email,a.jsx("br",{}),a.jsx("strong",{children:"Nombre:"})," ",(n==null?void 0:n.fullName)||"Sin especificar",a.jsx("br",{}),a.jsx("strong",{children:"Rol:"})," ",(n==null?void 0:n.role)||"Cliente"]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Seleccionar Plantilla (Opcional)"}),a.jsxs("select",{value:c,onChange:b=>{u(b.target.value),b.target.value||l("")},className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500 mb-3",children:[a.jsx("option",{value:"",children:"-- Sin plantilla (usar mensaje por defecto) --"}),f.map(b=>a.jsx("option",{value:b.id,children:b.name},b.id))]}),c&&a.jsx("div",{className:"mb-3 p-3 bg-blue-50 border border-blue-200 rounded-md",children:a.jsxs("p",{className:"text-sm text-blue-800",children:[a.jsx("strong",{children:"Plantilla seleccionada:"})," ",((C=f.find(b=>b.id===c))==null?void 0:C.name)||"N/A"]})}),a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje de Notificacin"}),a.jsx("textarea",{value:o||S,onChange:b=>l(b.target.value),rows:"8",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",placeholder:S}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:c?"Puedes editar el mensaje de la plantilla seleccionada o dejarlo como est.":"Si no seleccionas una plantilla, se enviar el mensaje por defecto. Puedes personalizarlo aqu."})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:[a.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"Qu suceder?"}),a.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[a.jsx("li",{children:" El usuario ser activado inmediatamente"}),a.jsx("li",{children:" Se enviar una notificacin por email"}),a.jsx("li",{children:" El usuario podr iniciar sesin"}),a.jsx("li",{children:" Si es cliente, deber completar su perfil"})]})]}),a.jsxs("div",{className:"flex justify-end space-x-4",children:[a.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),a.jsx("button",{onClick:k,disabled:g,className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 flex items-center gap-2",children:g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Activando..."]}):"Activar y Notificar"})]})]})}):null}function j8({isOpen:t,onClose:e,user:n,companySettings:r}){var R;const{addNotification:i}=pn(),[s,o]=ue.useState(""),[l,c]=ue.useState([]),[u,f]=ue.useState(""),[v,g]=ue.useState(""),[p,S]=ue.useState(!1),C=(()=>{const D=typeof window<"u"?`${window.location.origin}${window.location.pathname}`:"";return`Hola ${(n==null?void 0:n.fullName)||(n==null?void 0:n.email)},

Tu cuenta ha sido activada exitosamente en nuestro sistema de gestin de cobros.

 CREAR O CAMBIAR TU CONTRASEA:

Para acceder al sistema, necesitas crear o cambiar tu contrasea usando el enlace que recibirs por correo.

 INSTRUCCIONES PASO A PASO:

1. Revisa tu correo electrnico (incluyendo la carpeta de spam)
2. Busca un email de Firebase con el asunto "Restablece tu contrasea" o "Reset your password"
3. Haz clic en el botn o enlace "Restablecer contrasea" dentro de ese email
4. Sers redirigido a nuestro sistema en: ${D}
5. En la pgina de restablecimiento, ingresa una contrasea segura (mnimo 6 caracteres)
6. Confirma tu contrasea ingresndola nuevamente
7. Haz clic en "Restablecer Contrasea"
8. Una vez creada tu contrasea, sers redirigido automticamente al inicio de sesin
9. Inicia sesin con:
   - Email: ${n==null?void 0:n.email}
   - Contrasea: La que acabas de crear

 ENLACE DIRECTO AL SISTEMA:
${D}

 IMPORTANTE:
- El enlace para crear/cambiar tu contrasea expirar en 1 hora
- Si el enlace expira o no recibes el email, puedes solicitar uno nuevo desde la pgina de inicio de sesin haciendo clic en "Olvidaste tu contrasea?"
- Tu cuenta est activa y lista para usar una vez que crees tu contrasea

Una vez que inicies sesin, podrs:
 Ver tus servicios contratados
 Crear tickets de soporte
 Gestionar tu perfil y pagos
 Acceder a todas las funcionalidades del sistema

Si tienes alguna pregunta o necesitas ayuda, no dudes en contactarnos.

Bienvenido!

Equipo de Soporte
${(r==null?void 0:r.companyName)||"Sistema de Gestin de Cobros"}`})(),b=`Cuenta Activada - ${(r==null?void 0:r.companyName)||"Sistema de Gestin de Cobros"}`;if(ue.useEffect(()=>{if(!t)return;const D=Ut(Ve,"artifacts",Fe,"public","data","messageTemplates"),ee=An(D,Fu("name")),oe=Gt(ee,V=>{const N=V.docs.map(U=>({id:U.id,...U.data()})).filter(U=>(U.category||"client")==="client");if(c(N),N.length>0&&!s){const U=N.find(E=>E.name.includes("Notificacin de Activacin")||E.name.includes("Activacin - Crear"));U?o(U.id):oA("Notificacin de Activacin - Crear Contrasea").then(E=>{E&&N.find(L=>L.id===E.id)?o(E.id):N.length>0&&o(N[0].id)})}},V=>{console.error("Error loading templates:",V),c([])});return()=>oe()},[t]),ue.useEffect(()=>{if(s&&l.length>0){const D=l.find(ee=>ee.id===s);if(D){let ee=D.body,oe=D.subject;const V=typeof window<"u"?`${window.location.origin}${window.location.pathname}`:"",T={clientName:(n==null?void 0:n.fullName)||(n==null?void 0:n.email)||"",clientEmail:(n==null?void 0:n.email)||"",resetPasswordUrl:V+" (El enlace se generar automticamente)",...n},N=lp(oe,T,{companySettings:r}),U=lp(ee,T,{companySettings:r});g(U),f(N)}}else s||(g(C),f(b))},[s,l,n,r]),ue.useEffect(()=>{t&&l.length===0&&(g(C),f(b),o(""))},[t,n,l.length]),!t)return null;const I=async()=>{if(!u.trim()||!v.trim()){i("Por favor, complete el asunto y el mensaje","error");return}S(!0);try{console.log(" [USUARIOS] Enviando notificacin de activacin y reset de contrasea al usuario");let D=null;try{const T=ut(Ve,"artifacts",Fe,"public","data","users",n.id);if((await vs(T)).exists()){const U=await hA(n.id,n.email,24);D=`${`${window.location.origin}${window.location.pathname}`}?token=${U}`,console.log(" Token de reset generado exitosamente")}else throw new Error("Usuario no encontrado en Firestore")}catch(T){console.error("Error generando token de reset:",T),i(" No se pudo generar el token de restablecimiento. El email de notificacin se enviar de todas formas.","warning")}await Nr();const ee=`${window.location.origin}${window.location.pathname}`;let oe=v,V=u;D?(oe=oe.replace(/\{resetPasswordUrl\}/g,D),V=V.replace(/\{resetPasswordUrl\}/g,D)):(oe=oe.replace(/\{resetPasswordUrl\}/g,ee+" (Revisa tu correo para el enlace completo)"),V=V.replace(/\{resetPasswordUrl\}/g,ee)),await fr({to:n.email,toName:n.fullName||n.email,subject:u.trim(),html:oe.replace(/\n/g,"<br>"),text:oe,type:"Activacin",recipientType:"Cliente",module:"users",event:"userActivation",metadata:{userId:n.id,userEmail:n.email,userRole:n.role,templateId:s||null}}),i(`Notificacin de activacin y creacin de contrasea enviadas a ${n.email}`,"success"),e()}catch(D){console.error("Error enviando notificacin de activacin:",D),i(`Error al enviar notificacin: ${D.message}`,"error")}finally{S(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Notificar Activacin a ",(n==null?void 0:n.fullName)||(n==null?void 0:n.email)]}),a.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"Usuario:"}),a.jsxs("p",{className:"text-blue-700",children:[a.jsx("strong",{children:"Email:"})," ",n==null?void 0:n.email,a.jsx("br",{}),a.jsx("strong",{children:"Nombre:"})," ",(n==null?void 0:n.fullName)||"Sin especificar",a.jsx("br",{}),a.jsx("strong",{children:"Rol:"})," ",(n==null?void 0:n.role)||"Cliente"]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Seleccionar Plantilla (Opcional)"}),a.jsxs("select",{value:s,onChange:D=>{o(D.target.value),D.target.value||(g(C),f(b))},className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"-- Sin plantilla (usar mensaje por defecto) --"}),l.map(D=>a.jsx("option",{value:D.id,children:D.name},D.id))]}),s&&a.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["Plantilla seleccionada: ",((R=l.find(D=>D.id===s))==null?void 0:R.name)||"N/A"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Asunto"}),a.jsx("input",{type:"text",value:u,onChange:D=>f(D.target.value),className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",placeholder:"Asunto del correo"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cuerpo del Mensaje (Editable)"}),a.jsx("textarea",{value:v,onChange:D=>g(D.target.value),rows:"12",className:"w-full p-3 border rounded-md font-mono text-sm focus:ring-2 focus:ring-blue-500",placeholder:C}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:s?"Puedes editar el mensaje de la plantilla seleccionada o dejarlo como est.":"Puedes personalizar el mensaje o usar el mensaje por defecto."})]})]}),a.jsxs("div",{className:"flex justify-end gap-4 mt-8",children:[a.jsx("button",{onClick:e,disabled:p,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 disabled:opacity-50",children:"Cancelar"}),a.jsx("button",{onClick:I,disabled:p||!u.trim()||!v.trim(),className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2",children:p?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Enviando..."]}):"Enviar Notificacin"})]})]})})}function C8({userRole:t,companySettings:e}){const{addNotification:n}=pn(),[r,i]=ue.useState([]),[s,o]=ue.useState(""),[l,c]=ue.useState(!1),[u,f]=ue.useState(!1),[v,g]=ue.useState(!1),[p,S]=ue.useState(!1),[k,C]=ue.useState(null),[b,I]=ue.useState(null),[R,D]=ue.useState(null);ue.useEffect(()=>{const M=Ut(Ve,"artifacts",Fe,"public","data","users");return Gt(An(M,Fu("email")),F=>{i(F.docs.map(X=>({id:X.id,...X.data()})))})},[]);const ee=async M=>{const{id:K,...F}=M,X=ut(Ve,"artifacts",Fe,"public","data","users",K);await gr(X,F)},oe=async M=>{var F;const K=(F=hr.currentUser)==null?void 0:F.uid;try{const X=An(Ut(Ve,"artifacts",Fe,"public","data","users"),cr("email","==",M.email));if(!(await Na(X)).empty){n("El email ya est registrado en el sistema","error");return}let W;if(M.notify&&!M.password){const P=Math.random().toString(36).slice(-12)+Math.random().toString(36).slice(-12);W=(await qm(hr,M.email,P)).user}else W=(await qm(hr,M.email,M.password)).user;const Y={email:M.email,fullName:M.fullName||"",identification:M.identification||"",role:M.role||"client",status:M.status||"active",isProfileComplete:!0,createdAt:ft.now(),requiresPasswordChange:!M.notify},B=ut(Ve,"artifacts",Fe,"public","data","users",W.uid);await ws(B,Y);const A=hr.currentUser;if(A&&A.uid===W.uid&&K&&A.uid!==K&&console.log(" Usuario actual cambi al nuevo usuario. El admin puede continuar trabajando normalmente."),M.notify)try{console.log(" [USUARIOS] Enviando email de bienvenida y reset de contrasea al nuevo usuario");let P=null;try{const me=await hA(W.uid,M.email,24);P=`${`${window.location.origin}${window.location.pathname}`}?token=${me}`,console.log(" Token de reset generado exitosamente")}catch(me){console.error("Error generando token de reset:",me),n(" No se pudo generar el token de restablecimiento. El usuario fue creado.","warning")}await Nr();const q=await oA("Bienvenida - Nuevo Usuario - Crear Contrasea"),te=`${window.location.origin}${window.location.pathname}`;let le,ce;if(q){const me={clientName:M.fullName||M.email||"Cliente",clientEmail:M.email||"",resetPasswordUrl:P||te+" (El enlace se generar automticamente)",...M};le=lp(q.subject,me,{companySettings:e}),ce=lp(q.body,me,{companySettings:e})}else le=`Bienvenido a ${(e==null?void 0:e.companyName)||"nuestro sistema"}`,ce=`Hola ${M.fullName||M.email},

Bienvenido a ${(e==null?void 0:e.companyName)||"nuestro sistema"}!

Tu cuenta ha sido creada exitosamente.

 Tu email de acceso: ${M.email}

${P?` CREAR TU CONTRASEA:

Haz clic en el siguiente enlace para crear tu contrasea:
${P}`:"Revisa tu correo para recibir el enlace de creacin de contrasea."}

Equipo de Soporte
${(e==null?void 0:e.companyName)||"Sistema de Gestin"}`;await fr({to:M.email,toName:M.fullName||M.email,subject:le,html:ce.replace(/\n/g,"<br>"),text:ce,type:"Bienvenida",recipientType:"Cliente",module:"users",event:"newUser",metadata:{userId:W.uid,userEmail:M.email,userRole:M.role}}),n(`Usuario ${M.email} creado exitosamente. Emails de bienvenida y creacin de contrasea enviados.`,"success")}catch(P){console.error("Error enviando emails:",P),n(`Usuario ${M.email} creado exitosamente, pero no se pudieron enviar los emails: ${P.message}`,"warning")}else n(`Usuario ${M.email} creado exitosamente con contrasea temporal. Puedes notificar la activacin desde el men de acciones.`,"success")}catch(X){console.error("Error creating user:",X);let H="Error al crear usuario";throw X.code==="auth/email-already-in-use"?H="El email ya est registrado en el sistema":X.code==="auth/invalid-email"?H="El email no es vlido":X.code==="auth/weak-password"?H="La contrasea es muy dbil":H=`Error al crear usuario: ${X.message}`,n(H,"error"),X}},V=async()=>{if(b)try{const M=ut(Ve,"artifacts",Fe,"public","data","users",b.id);await gr(M,{status:"active"}),n(`Usuario ${b.email} activado exitosamente.`,"success")}catch(M){n("Error al activar usuario","error"),console.error("Error activating user:",M)}},T=async(M,K)=>{if(t!=="superadmin"){n("Accin no permitida.","error");return}const F=ut(Ve,"artifacts",Fe,"public","data","users",M.id);try{switch(K){case"activate":I(M),g(!0);break;case"notify":D(M),S(!0);break;case"disable":window.confirm(`Deshabilitar a ${M.email}?`)&&(await gr(F,{status:"disabled"}),n(`Usuario ${M.email} deshabilitado.`,"success"));break;case"makeAdmin":window.confirm(`Convertir a ${M.email} en administrador?`)&&(await gr(F,{role:"admin"}),n(`${M.email} ahora es administrador.`,"success"));break;case"makeClient":window.confirm(`Convertir a ${M.email} en cliente?`)&&(await gr(F,{role:"client"}),n(`${M.email} ahora es cliente.`,"success"));break;case"delete":if(window.confirm(`Eliminar permanentemente a ${M.email}? Esta accin no se puede deshacer.`))try{await yl(F),n(`Usuario ${M.email} eliminado de la base de datos.`,"success"),n("Nota: El usuario permanece en Authentication. Contacta al administrador para eliminacin completa.","info")}catch(X){console.error("Error deleting user:",X),n("Error al eliminar el usuario: "+X.message,"error")}break;default:n("Accin no reconocida.","error")}}catch(X){n("Ocurri un error al realizar la accin.","error"),console.error("Error in user action:",X)}},N=r.filter(M=>{const K=s.toLowerCase();return!K||M.email.toLowerCase().includes(K)||M.fullName&&M.fullName.toLowerCase().includes(K)||M.identification&&M.identification.includes(K)}),U=M=>({active:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",disabled:"bg-red-100 text-red-800"})[M]||"bg-gray-100 text-gray-800",E=M=>({superadmin:"bg-red-100 text-red-800 font-bold",admin:"bg-blue-100 text-blue-800 font-semibold",client:"bg-gray-100 text-gray-800"})[M]||"bg-gray-100 text-gray-800",L=M=>({active:"Activo",pending:"Pendiente",disabled:"Deshabilitado"})[M]||M,_=M=>({superadmin:"Super Admin",admin:"Administrador",client:"Cliente"})[M]||M;return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar por email, nombre, ID...",value:s,onChange:M=>o(M.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full sm:w-64"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Uu,{})})]}),t==="superadmin"&&a.jsxs("button",{onClick:()=>c(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700",children:[a.jsx(Uh,{})," ",a.jsx("span",{className:"hidden sm:inline",children:"Crear Usuario"})]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Nombre","Email","Identificacin","Rol","Estado","Fecha Creacin","Acciones"].map(M=>a.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:M},M))})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:N.map(M=>a.jsxs("tr",{children:[a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-medium text-gray-900",children:M.fullName||"Sin nombre"}),M.fullName&&a.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",M.id.slice(0,8),"..."]})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm text-gray-900",children:M.email}),M.requiresPasswordChange&&a.jsx("div",{className:"text-xs text-orange-600",children:"Requiere cambio de contrasea"})]}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:M.identification||"--"}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${E(M.role)}`,children:_(M.role)})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${U(M.status)}`,children:L(M.status)})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:M.createdAt?new Date(M.createdAt.seconds*1e3).toLocaleDateString():"--"}),a.jsx("td",{className:"px-6 py-4",children:t==="superadmin"&&M.role!=="superadmin"&&a.jsxs(Vh,{children:[a.jsx("button",{onClick:()=>{C(M),f(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:" Editar Datos"}),a.jsx("button",{onClick:()=>T(M,"notify"),className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:" Notificar Activacin"}),M.status==="pending"&&a.jsx("button",{onClick:()=>T(M,"activate"),className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:" Activar Usuario"}),M.status==="active"&&a.jsx("button",{onClick:()=>T(M,"disable"),className:"block w-full text-left px-4 py-2 text-sm text-yellow-700 hover:bg-yellow-50",children:" Deshabilitar"}),M.status==="disabled"&&a.jsx("button",{onClick:()=>T(M,"activate"),className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:" Re-Activar"}),M.role==="client"?a.jsx("button",{onClick:()=>T(M,"makeAdmin"),className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:" Hacer Administrador"}):a.jsx("button",{onClick:()=>T(M,"makeClient"),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:" Hacer Cliente"}),a.jsx("button",{onClick:()=>T(M,"delete"),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:" Eliminar Permanentemente"})]})})]},M.id))})]})}),a.jsx(k8,{isOpen:l,onClose:()=>c(!1),onSave:oe}),a.jsx(S8,{isOpen:u,onClose:()=>f(!1),onSave:ee,user:k}),a.jsx(T8,{isOpen:v,onClose:()=>{g(!1),I(null)},onActivate:V,user:b,companySettings:e}),a.jsx(j8,{isOpen:p,onClose:()=>{S(!1),D(null)},user:R,companySettings:e})]})}function I8(){const{addNotification:t}=pn(),[e,n]=ue.useState([]),[r,i]=ue.useState(null),[s,o]=ue.useState(""),[l,c]=ue.useState(""),[u,f]=ue.useState(""),[v,g]=ue.useState("client"),[p,S]=ue.useState(!1),[k,C]=ue.useState("all"),[b,I]=ue.useState([]),[R,D]=ue.useState({preVencimiento:{enabled:!1,days:7,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]},periodoGracia:{enabled:!1,days:3,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]},vencido:{enabled:!1,days:0,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]},suspendido:{enabled:!1,days:0,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]}}),[ee,oe]=ue.useState("templates"),V={preVencimiento:{name:"Aviso de Prximo Vencimiento",subject:"Recordatorio de Renovacin de Servicio: {description}",body:`Estimado/a {clientName},

Le escribimos para recordarle que su servicio '{description}' est programado para vencer el prximo {dueDate}.

El monto correspondiente a la renovacin es de {amount} {currency}.

Para garantizar la continuidad de su servicio, le recomendamos realizar el pago antes de la fecha de vencimiento. Puede gestionarlo a travs de nuestro portal de clientes.

Si tiene alguna consulta, no dude en contactarnos.

Atentamente,
{companyName}`},vencido:{name:"Notificacin de Servicio Vencido",subject:"Importante: Su servicio {description} ha vencido",body:`Estimado/a {clientName},

Le informamos que la factura correspondiente a su servicio '{description}', con fecha de vencimiento {dueDate}, se encuentra pendiente de pago.

Su servicio ha entrado en un perodo de gracia. Para evitar la suspensin del mismo, le solicitamos regularizar su situacin a la brevedad posible. El monto pendiente es de {amount} {currency}.

Si usted ya ha realizado el pago, por favor, omita esta notificacin.

Cordialmente,
{companyName}`},suspendido:{name:"Aviso de Suspensin de Servicio",subject:"Accin Requerida: Suspensin del servicio {description}",body:`Estimado/a {clientName},

Lamentamos informarle que, debido a la falta de pago, su servicio '{description}' ha sido suspendido.

Para proceder con la reactivacin y recuperar el acceso, es necesario saldar el monto pendiente de {amount} {currency}. Por favor, contctenos para coordinar el pago y la restauracin del servicio.

Quedamos a su disposicin.

Atentamente,
{companyName}`},pagoRecibido:{name:"Confirmacin de Pago Recibido",subject:"Confirmacin: Pago recibido para {description}",body:`Estimado/a {clientName},

Hemos recibido y procesado exitosamente su pago por {amount} {currency} correspondiente al servicio '{description}'.

Su servicio est activo y funcionando correctamente. La prxima fecha de vencimiento ser {dueDate}.

Gracias por su confianza y por mantener sus pagos al da.

Atentamente,
{companyName}`},bienvenida:{name:"Bienvenida a Nuevo Cliente",subject:"Bienvenido a {companyName} - Servicio {description}",body:`Estimado/a {clientName},

Bienvenido a {companyName}!

Nos complace confirmar que su servicio '{description}' ha sido activado exitosamente.

Detalles del servicio:
- Descripcin: {description}
- Monto: {amount} {currency}
- Prximo vencimiento: {dueDate}

Puede acceder a su portal de cliente en cualquier momento para gestionar su cuenta y realizar pagos.

Si tiene alguna pregunta, no dude en contactarnos.

Gracias por elegirnos!

Atentamente,
{companyName}`},nuevoUsuario:{name:"Bienvenida - Nuevo Usuario",subject:"Bienvenido a {companyName} - Crea tu contrasea",body:`Estimado/a {clientName},

Bienvenido a {companyName}!

Tu cuenta ha sido creada exitosamente en nuestro sistema de gestin.

 Tu email de acceso: {clientEmail}

 CREAR TU CONTRASEA:

Para completar tu registro y acceder al sistema, necesitas crear tu contrasea personal.

 PASOS PARA CREAR TU CONTRASEA:

1. Revisa tu correo electrnico, recibirs un email de Firebase con el asunto "Restablece tu contrasea"
2. Haz clic en el enlace "Restablecer contrasea" de ese email
3. Ingresa una contrasea segura (mnimo 6 caracteres)
4. Confirma tu contrasea
5. Una vez creada tu contrasea, sers redirigido al inicio de sesin
6. Inicia sesin con tu email ({clientEmail}) y la contrasea que acabas de crear

 IMPORTANTE:
- El enlace para crear tu contrasea expirar en 1 hora
- Si el enlace expira, contacta con soporte para generar uno nuevo
- Tu cuenta est activa y lista para usar una vez que crees tu contrasea

Una vez que inicies sesin, podrs:
 Ver tus servicios contratados
 Crear tickets de soporte
 Gestionar tu perfil y pagos

Si tienes alguna pregunta o necesitas ayuda, no dudes en contactarnos.

Bienvenido!

Equipo de Soporte
{companyName}`},adminPreVencimiento:{name:"Alerta Admin: Prximo Vencimiento",subject:"ALERTA: Servicio prximo a vencer - {clientName}",body:`Estimado/a Administrador,

Se ha generado una alerta automtica para el siguiente servicio:

 INFORMACIN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto: {amount} {currency}
- Fecha de vencimiento: {dueDate}
- Ciclo de facturacin: {billingCycle}
- Das restantes: {daysRemaining}

 ESTADO ACTUAL:
- Estado: Prximo a vencer
- Notificacin enviada al cliente: 
- Plantilla utilizada: Aviso de Prximo Vencimiento

 ACCIONES RECOMENDADAS:
1. Verificar que el cliente haya recibido la notificacin
2. Contactar al cliente si es necesario
3. Preparar seguimiento post-vencimiento

 ESTADSTICAS:
- Total de servicios prximos a vencer: {totalPending}
- Ingresos potenciales: {potentialRevenue}

Este es un mensaje automtico del sistema de gestin de cobros.

Sistema de Gestin - {companyName}`},adminPeriodoGracia:{name:"Alerta Admin: Perodo de Gracia",subject:"URGENTE: Servicio en perodo de gracia - {clientName}",body:`Estimado/a Administrador,

 ALERTA URGENTE - Servicio en perodo de gracia:

 INFORMACIN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto pendiente: {amount} {currency}
- Fecha de vencimiento original: {dueDate}
- Das en perodo de gracia: {graceDays}
- Das restantes de gracia: {remainingGraceDays}

 ESTADO ACTUAL:
- Estado: Perodo de Gracia Vencido
- Notificacin enviada al cliente: 
- Plantilla utilizada: Notificacin de Servicio Vencido
- Riesgo de suspensin: ALTO

 ACCIONES INMEDIATAS:
1. Contactar al cliente por telfono
2. Enviar recordatorio personalizado
3. Evaluar opciones de pago flexibles
4. Preparar suspensin si no hay respuesta

 IMPACTO:
- Ingresos en riesgo: {amount} {currency}
- Tiempo de mora: {daysOverdue} das
- Historial de pagos: {paymentHistory}

 PRXIMOS PASOS:
- Si no se paga en {remainingGraceDays} das: Suspender servicio
- Seguimiento diario hasta resolucin
- Documentar todas las comunicaciones

Este es un mensaje automtico del sistema de gestin de cobros.

Sistema de Gestin - {companyName}`},adminVencido:{name:"Alerta Admin: Servicio Vencido",subject:"INMEDIATO: Servicio vencido - {clientName}",body:`Estimado/a Administrador,

 ALERTA INMEDIATA - Servicio vencido:

 INFORMACIN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto vencido: {amount} {currency}
- Fecha de vencimiento: {dueDate}
- Das de atraso: {daysOverdue}
- Ciclo de facturacin: {billingCycle}

 ESTADO ACTUAL:
- Estado: Vencido
- Notificacin enviada al cliente: 
- Plantilla utilizada: Notificacin de Servicio Vencido
- Prximo paso: Perodo de gracia

 ACCIONES REQUERIDAS:
1. Verificar recepcin de notificacin por cliente
2. Iniciar perodo de gracia ({gracePeriod} das)
3. Contacto directo con el cliente
4. Evaluar historial de pagos del cliente
5. Preparar estrategia de cobro

 ANLISIS:
- Cliente desde: {clientSince}
- Pagos anteriores: {previousPayments}
- Patrn de pago: {paymentPattern}
- Riesgo de prdida: {riskLevel}

 CONTACTOS:
- Telfono: {clientPhone}
- Email: {clientEmail}
- ltima comunicacin: {lastContact}

Este es un mensaje automtico del sistema de gestin de cobros.

Sistema de Gestin - {companyName}`},adminSuspendido:{name:"Alerta Admin: Servicio Suspendido",subject:"SUSPENDIDO: Servicio cancelado por falta de pago - {clientName}",body:`Estimado/a Administrador,

 SERVICIO SUSPENDIDO - Accin requerida:

 INFORMACIN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto pendiente: {amount} {currency}
- Fecha de vencimiento: {dueDate}
- Das de atraso: {daysOverdue}
- Perodo de gracia agotado: {gracePeriod} das

 ESTADO ACTUAL:
- Estado: Cancelado
- Motivo: Falta de pago
- Notificacin enviada al cliente: 
- Plantilla utilizada: Aviso de Suspensin de Servicio
- Fecha de suspensin: {suspensionDate}

 ACCIONES INMEDIATAS:
1. Suspender acceso del cliente al servicio
2. Documentar suspensin en el sistema
3. Enviar notificacin de suspensin
4. Iniciar proceso de recuperacin de cobros
5. Evaluar reactivacin futura

 ANLISIS FINANCIERO:
- Prdida de ingresos: {amount} {currency}
- Costo de reactivacin: {reactivationCost}
- Valor del cliente: {clientValue}
- Probabilidad de recuperacin: {recoveryProbability}%

 SEGUIMIENTO:
- Contactar para negociacin de pago
- Ofrecer planes de pago flexibles
- Documentar todas las comunicaciones
- Evaluar cancelacin definitiva

 DOCUMENTACIN:
- Historial de pagos: {paymentHistory}
- Comunicaciones previas: {communicationHistory}
- Trminos del servicio: {serviceTerms}
- Poltica de suspensin: {suspensionPolicy}

Este es un mensaje automtico del sistema de gestin de cobros.

Sistema de Gestin - {companyName}`},adminPagoRecibido:{name:"Notificacin Admin: Pago Recibido",subject:"CONFIRMADO: Pago recibido - {clientName}",body:`Estimado/a Administrador,

 PAGO CONFIRMADO - Servicio reactivado:

 INFORMACIN DEL PAGO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Monto recibido: {amount} {currency}
- Fecha de pago: {paymentDate}
- Mtodo de pago: {paymentMethod}
- Referencia: {paymentReference}

 ESTADO ACTUAL:
- Estado: Activo
- Servicio reactivado: 
- Notificacin enviada al cliente: 
- Plantilla utilizada: Confirmacin de Pago Recibido
- Prximo vencimiento: {nextDueDate}

 ACCIONES COMPLETADAS:
1. Pago procesado y verificado
2. Servicio reactivado automticamente
3. Cliente notificado del pago
4. Prxima fecha de vencimiento actualizada
5. Historial de pagos actualizado

 IMPACTO POSITIVO:
- Ingresos recuperados: {amount} {currency}
- Cliente retenido: 
- Servicio activo: 
- Prximo ciclo iniciado

 ESTADSTICAS:
- Tiempo de pago: {paymentTime} das
- Eficiencia de cobro: {collectionEfficiency}%
- Satisfaccin del cliente: {clientSatisfaction}
- Ingresos mensuales: {monthlyRevenue}

 SEGUIMIENTO:
- Monitorear estabilidad del servicio
- Preparar prximo recordatorio
- Actualizar perfil del cliente
- Documentar xito de cobro

Este es un mensaje automtico del sistema de gestin de cobros.

Sistema de Gestin - {companyName}`},adminNuevoCliente:{name:"Notificacin Admin: Nuevo Cliente",subject:"NUEVO CLIENTE: {clientName} - Servicio {description}",body:`Estimado/a Administrador,

 NUEVO CLIENTE REGISTRADO:

 INFORMACIN DEL CLIENTE:
- Nombre: {clientName}
- Email: {clientEmail}
- Identificacin: {clientId}
- Telfono: {clientPhone}
- Fecha de registro: {registrationDate}

 INFORMACIN DEL SERVICIO:
- Descripcin: {description}
- Tipo: {serviceType}
- Monto: {amount} {currency}
- Ciclo de facturacin: {billingCycle}
- Fecha de vencimiento: {dueDate}
- Estado: Activo

 CONFIGURACIN:
- Servicio activado: 
- Notificacin de bienvenida enviada: 
- Plantilla utilizada: Bienvenida a Nuevo Cliente
- Portal de cliente habilitado: 
- Mtodo de pago configurado: {paymentMethod}

 ACCIONES INICIALES:
1. Verificar activacin del servicio
2. Confirmar recepcin de bienvenida
3. Programar seguimiento inicial
4. Configurar recordatorios automticos
5. Documentar preferencias del cliente

 ANLISIS:
- Valor del cliente: {clientValue}
- Potencial de crecimiento: {growthPotential}
- Segmento: {clientSegment}
- Fuente de adquisicin: {acquisitionSource}

 PRXIMOS PASOS:
- Seguimiento en 7 das
- Verificar satisfaccin inicial
- Preparar prximo recordatorio
- Monitorear uso del servicio

Este es un mensaje automtico del sistema de gestin de cobros.

Sistema de Gestin - {companyName}`}},T=W=>{i(null),S(!1),o(W.name),c(W.subject),f(W.body);const Y=W.name.toLowerCase().includes("admin")||W.name.toLowerCase().includes("alerta");g(Y?"admin":"client"),t("Sugerencia cargada en el editor.","success")},N=k==="all"?e:e.filter(W=>(W.category||"client")===k);ue.useEffect(()=>{const W=Ut(Ve,"artifacts",Fe,"public","data","users");return Gt(An(W,cr("role","in",["admin","superadmin"])),B=>{I(B.docs.map(A=>({id:A.id,...A.data()})))})},[]),ue.useEffect(()=>{const W=ut(Ve,"artifacts",Fe,"public","data","settings","alertSettings");return Gt(W,B=>{B.exists()&&D(B.data())})},[]),ue.useEffect(()=>{const W=Ut(Ve,"artifacts",Fe,"public","data","messageTemplates");return Gt(An(W,Fu("name")),B=>{n(B.docs.map(A=>({id:A.id,...A.data()})))})},[]),ue.useEffect(()=>{r?(o(r.name),c(r.subject),f(r.body),g(r.category||"client"),S(!0)):(o(""),c(""),f(""),g("client"),S(!1))},[r]);const U=async()=>{if(!s.trim()||!l.trim()||!u.trim()){t("Por favor, complete todos los campos de la plantilla.","error");return}const W={name:s.trim(),subject:l.trim(),body:u.trim(),category:v||"client",updatedAt:new Date},Y=Ut(Ve,"artifacts",Fe,"public","data","messageTemplates");try{r?(await gr(ut(Y,r.id),W),t("Plantilla actualizada exitosamente.","success")):(await Sa(Y,{...W,createdAt:new Date}),t("Plantilla creada exitosamente.","success")),i(null)}catch(B){console.error("Error saving template:",B),t("Error al guardar la plantilla.","error")}},E=async W=>{if(window.confirm("Seguro que quieres eliminar esta plantilla?"))try{await yl(ut(Ve,"artifacts",Fe,"public","data","messageTemplates",W)),t("Plantilla eliminada.","success"),i(null)}catch(Y){console.error("Error deleting template:",Y),t("Error al eliminar la plantilla.","error")}},L=()=>{i(null),S(!1),o(""),c(""),f(""),g("client")},_=W=>{i(W),S(!0)},M=(W,Y,B)=>{D(A=>({...A,[W]:{...A[W],[Y]:B}}))},K=(W,Y,B)=>{D(A=>({...A,[W]:{...A[W],selectedAdmins:B?[...A[W].selectedAdmins,Y]:A[W].selectedAdmins.filter(P=>P!==Y)}}))},F=async()=>{try{const W=ut(Ve,"artifacts",Fe,"public","data","settings","alertSettings");await ws(W,R,{merge:!0}),t("Configuracin de alertas guardada exitosamente.","success")}catch(W){console.error("Error saving alert settings:",W),t("Error al guardar la configuracin de alertas.","error")}},X=["{clientName}","{serviceType}","{description}","{amount}","{currency}","{dueDate}","{companyName}","{billingCycle}","{clientEmail}"],H=["{clientName}","{clientEmail}","{clientPhone}","{clientId}","{serviceType}","{description}","{amount}","{currency}","{dueDate}","{billingCycle}","{companyName}","{daysRemaining}","{daysOverdue}","{graceDays}","{remainingGraceDays}","{totalPending}","{potentialRevenue}","{paymentHistory}","{clientSince}","{previousPayments}","{paymentPattern}","{riskLevel}","{lastContact}","{suspensionDate}","{reactivationCost}","{clientValue}","{recoveryProbability}","{paymentDate}","{paymentMethod}","{paymentReference}","{nextDueDate}","{paymentTime}","{collectionEfficiency}","{clientSatisfaction}","{monthlyRevenue}","{registrationDate}","{growthPotential}","{clientSegment}","{acquisitionSource}","{gracePeriod}","{communicationHistory}","{serviceTerms}","{suspensionPolicy}","{loginUrl}","{clientPortalUrl}"];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Plantillas y Alertas"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Gestiona las plantillas de correo y configura alertas automticas"})]}),a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-8",children:[a.jsxs("button",{onClick:()=>oe("templates"),className:`py-2 px-1 border-b-2 font-medium text-sm ${ee==="templates"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(cA,{}),a.jsx("span",{className:"ml-2",children:"Plantillas"})]}),a.jsxs("button",{onClick:()=>oe("alerts"),className:`py-2 px-1 border-b-2 font-medium text-sm ${ee==="alerts"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(p8,{}),a.jsx("span",{className:"ml-2",children:"Alertas Automticas"})]})]})})}),ee==="templates"&&a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Plantillas Guardadas"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Haz clic para editar una plantilla"}),a.jsx("div",{className:"mt-3",children:a.jsxs("select",{value:k,onChange:W=>C(W.target.value),className:"w-full p-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"Todas las plantillas"}),a.jsx("option",{value:"client",children:"Plantillas para Clientes"}),a.jsx("option",{value:"admin",children:"Plantillas para Administradores"})]})})]}),a.jsx("div",{className:"max-h-80 overflow-y-auto",children:N.length===0?a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx("p",{children:"No hay plantillas guardadas"}),a.jsx("p",{className:"text-sm",children:"Crea tu primera plantilla"})]}):N.map(W=>a.jsx("div",{className:"p-4 border-b hover:bg-gray-50 transition-colors",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h4",{className:"font-medium text-gray-900 truncate",children:W.name}),a.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${(W.category||"client")==="client"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:(W.category||"client")==="client"?"Cliente":"Admin"})]}),a.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:W.subject}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:W.createdAt?new Date(W.createdAt.seconds*1e3).toLocaleDateString():"Sin fecha"})]}),a.jsxs("div",{className:"flex space-x-2 ml-2",children:[a.jsx("button",{onClick:()=>_(W),className:"text-blue-600 hover:text-blue-800 p-1",title:"Editar plantilla",children:a.jsx(m8,{})}),a.jsx("button",{onClick:()=>E(W.id),className:"text-red-600 hover:text-red-800 p-1",title:"Eliminar plantilla",children:a.jsx(lA,{})})]})]})},W.id))}),a.jsx("div",{className:"p-4",children:a.jsxs("button",{onClick:L,className:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(Uh,{}),a.jsx("span",{className:"ml-2",children:"Nueva Plantilla"})]})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Plantillas para Clientes"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Mensajes dirigidos a los clientes"})]}),a.jsxs("div",{className:"p-4 space-y-2",children:[a.jsxs("button",{onClick:()=>T(V.preVencimiento),className:"w-full text-left p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-blue-900",children:"Aviso de Prximo Vencimiento"}),a.jsx("div",{className:"text-sm text-blue-700",children:"Recordatorio antes del vencimiento"})]}),a.jsxs("button",{onClick:()=>T(V.vencido),className:"w-full text-left p-3 bg-yellow-50 hover:bg-yellow-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-yellow-900",children:"Servicio Vencido"}),a.jsx("div",{className:"text-sm text-yellow-700",children:"Notificacin de perodo de gracia"})]}),a.jsxs("button",{onClick:()=>T(V.suspendido),className:"w-full text-left p-3 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-red-900",children:"Aviso de Suspensin"}),a.jsx("div",{className:"text-sm text-red-700",children:"Servicio suspendido por falta de pago"})]}),a.jsxs("button",{onClick:()=>T(V.pagoRecibido),className:"w-full text-left p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-green-900",children:"Confirmacin de Pago"}),a.jsx("div",{className:"text-sm text-green-700",children:"Confirmacin de pago recibido"})]}),a.jsxs("button",{onClick:()=>T(V.bienvenida),className:"w-full text-left p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-purple-900",children:"Bienvenida"}),a.jsx("div",{className:"text-sm text-purple-700",children:"Mensaje de bienvenida a nuevos clientes"})]}),a.jsxs("button",{onClick:()=>T(V.nuevoUsuario),className:"w-full text-left p-3 bg-indigo-50 hover:bg-indigo-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-indigo-900",children:"Nuevo Usuario"}),a.jsx("div",{className:"text-sm text-indigo-700",children:"Bienvenida con instrucciones para crear contrasea"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Plantillas para Administradores"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Alertas y notificaciones internas"})]}),a.jsxs("div",{className:"p-4 space-y-2",children:[a.jsxs("button",{onClick:()=>T(V.adminPreVencimiento),className:"w-full text-left p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-blue-900",children:" Alerta: Prximo Vencimiento"}),a.jsx("div",{className:"text-sm text-blue-700",children:"Notificacin interna de servicios prximos a vencer"})]}),a.jsxs("button",{onClick:()=>T(V.adminPeriodoGracia),className:"w-full text-left p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-orange-900",children:" Alerta: Perodo de Gracia"}),a.jsx("div",{className:"text-sm text-orange-700",children:"Alerta urgente de servicios en perodo de gracia"})]}),a.jsxs("button",{onClick:()=>T(V.adminVencido),className:"w-full text-left p-3 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-red-900",children:" Alerta: Servicio Vencido"}),a.jsx("div",{className:"text-sm text-red-700",children:"Notificacin inmediata de servicios vencidos"})]}),a.jsxs("button",{onClick:()=>T(V.adminSuspendido),className:"w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-gray-900",children:" Alerta: Servicio Suspendido"}),a.jsx("div",{className:"text-sm text-gray-700",children:"Notificacin de servicios cancelados por falta de pago"})]}),a.jsxs("button",{onClick:()=>T(V.adminPagoRecibido),className:"w-full text-left p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-green-900",children:" Notificacin: Pago Recibido"}),a.jsx("div",{className:"text-sm text-green-700",children:"Confirmacin interna de pagos procesados"})]}),a.jsxs("button",{onClick:()=>T(V.adminNuevoCliente),className:"w-full text-left p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-purple-900",children:" Notificacin: Nuevo Cliente"}),a.jsx("div",{className:"text-sm text-purple-700",children:"Alerta de nuevos clientes registrados"})]})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Variables para Clientes"}),a.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[a.jsx("p",{className:"font-medium",children:"Informacin bsica:"}),a.jsx("p",{children:X.slice(0,3).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Informacin del servicio:"}),a.jsx("p",{children:X.slice(3,6).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Informacin adicional:"}),a.jsx("p",{children:X.slice(6).join(", ")})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Variables para Administradores"}),a.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[a.jsx("p",{className:"font-medium",children:"Informacin del cliente:"}),a.jsx("p",{children:H.slice(0,4).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Informacin del servicio:"}),a.jsx("p",{children:H.slice(4,11).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Fechas y tiempos:"}),a.jsx("p",{children:H.slice(11,15).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Estadsticas:"}),a.jsx("p",{children:H.slice(15,19).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Anlisis de riesgo:"}),a.jsx("p",{children:H.slice(19,23).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Informacin de pago:"}),a.jsx("p",{children:H.slice(23,27).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Mtricas de rendimiento:"}),a.jsx("p",{children:H.slice(27,31).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Informacin de registro:"}),a.jsx("p",{children:H.slice(31,35).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Configuracin:"}),a.jsx("p",{children:H.slice(35,37).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"URLs del sistema:"}),a.jsx("p",{children:H.slice(37).join(", ")})]})]})]}),a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-6 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:p?"Editando Plantilla":"Nueva Plantilla"}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:p?"Modifica los campos de la plantilla":"Completa los campos para crear una nueva plantilla"})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de la Plantilla"}),a.jsx("input",{type:"text",value:s,onChange:W=>o(W.target.value),placeholder:"Ej: Primer Recordatorio de Pago",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categora"}),a.jsxs("select",{value:v,onChange:W=>g(W.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"client",children:"Plantilla para Clientes"}),a.jsx("option",{value:"admin",children:"Plantilla para Administradores"})]}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Selecciona si esta plantilla es para enviar a clientes o a administradores"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Asunto del Correo"}),a.jsx("input",{type:"text",value:l,onChange:W=>c(W.target.value),placeholder:"Ej: Recordatorio de Renovacin: {description}",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cuerpo del Mensaje"}),a.jsx("textarea",{value:u,onChange:W=>f(W.target.value),placeholder:"Escribe el contenido del mensaje aqu...",rows:"12",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm"})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{onClick:L,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Limpiar"}),a.jsx("button",{onClick:U,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:p?"Guardar Cambios":"Crear Plantilla"})]})]})]})})]}),ee==="alerts"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-6 border-b",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-3"}),"Alerta de Prximo Vencimiento"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Notificaciones antes del vencimiento del servicio"})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Activar alerta"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Enviar notificaciones antes del vencimiento"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:R.preVencimiento.enabled,onChange:W=>M("preVencimiento","enabled",W.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),R.preVencimiento.enabled&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Das antes del vencimiento"}),a.jsx("input",{type:"number",min:"1",max:"30",value:R.preVencimiento.days,onChange:W=>M("preVencimiento","days",parseInt(W.target.value)),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para cliente"}),a.jsxs("select",{value:R.preVencimiento.clientTemplate,onChange:W=>M("preVencimiento","clientTemplate",W.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),e.map(W=>a.jsx("option",{value:W.id,children:W.name},W.id))]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notificar administradores"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Enviar copia a administradores seleccionados"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:R.preVencimiento.notifyAdmins,onChange:W=>M("preVencimiento","notifyAdmins",W.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),R.preVencimiento.notifyAdmins&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para administradores"}),a.jsxs("select",{value:R.preVencimiento.adminTemplate,onChange:W=>M("preVencimiento","adminTemplate",W.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),e.map(W=>a.jsx("option",{value:W.id,children:W.name},W.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Administradores a notificar"}),a.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-3",children:b.map(W=>a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:R.preVencimiento.selectedAdmins.includes(W.id),onChange:Y=>K("preVencimiento",W.id,Y.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("span",{className:"text-sm text-gray-700",children:[W.fullName," (",W.email,")"]})]},W.id))})]})]})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-6 border-b",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full mr-3"}),"Perodo de Gracia"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Notificaciones durante el perodo de gracia despus del vencimiento"})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Activar perodo de gracia"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Tiempo adicional para pagar antes de suspender"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:R.periodoGracia.enabled,onChange:W=>M("periodoGracia","enabled",W.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),R.periodoGracia.enabled&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Das de gracia"}),a.jsx("input",{type:"number",min:"1",max:"30",value:R.periodoGracia.days,onChange:W=>M("periodoGracia","days",parseInt(W.target.value)),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para cliente"}),a.jsxs("select",{value:R.periodoGracia.clientTemplate,onChange:W=>M("periodoGracia","clientTemplate",W.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),e.map(W=>a.jsx("option",{value:W.id,children:W.name},W.id))]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notificar administradores"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Enviar copia a administradores seleccionados"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:R.periodoGracia.notifyAdmins,onChange:W=>M("periodoGracia","notifyAdmins",W.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),R.periodoGracia.notifyAdmins&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para administradores"}),a.jsxs("select",{value:R.periodoGracia.adminTemplate,onChange:W=>M("periodoGracia","adminTemplate",W.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),e.map(W=>a.jsx("option",{value:W.id,children:W.name},W.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Administradores a notificar"}),a.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-3",children:b.map(W=>a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:R.periodoGracia.selectedAdmins.includes(W.id),onChange:Y=>K("periodoGracia",W.id,Y.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("span",{className:"text-sm text-gray-700",children:[W.fullName," (",W.email,")"]})]},W.id))})]})]})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-6 border-b",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-3"}),"Servicio Vencido"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Notificaciones cuando el servicio ha vencido"})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Activar alerta"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Enviar notificaciones cuando el servicio vence"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:R.vencido.enabled,onChange:W=>M("vencido","enabled",W.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),R.vencido.enabled&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para cliente"}),a.jsxs("select",{value:R.vencido.clientTemplate,onChange:W=>M("vencido","clientTemplate",W.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),e.map(W=>a.jsx("option",{value:W.id,children:W.name},W.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para administradores"}),a.jsxs("select",{value:R.vencido.adminTemplate,onChange:W=>M("vencido","adminTemplate",W.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),e.map(W=>a.jsx("option",{value:W.id,children:W.name},W.id))]})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notificar administradores"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Enviar copia a administradores seleccionados"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:R.vencido.notifyAdmins,onChange:W=>M("vencido","notifyAdmins",W.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),R.vencido.notifyAdmins&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Administradores a notificar"}),a.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-3",children:b.map(W=>a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:R.vencido.selectedAdmins.includes(W.id),onChange:Y=>K("vencido",W.id,Y.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("span",{className:"text-sm text-gray-700",children:[W.fullName," (",W.email,")"]})]},W.id))})]})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{onClick:F,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center",children:[a.jsx(eg,{}),a.jsx("span",{className:"ml-2",children:"Guardar Configuracin de Alertas"})]})})]})]})}function fA(){const{addNotification:t}=pn(),[e,n]=ue.useState({bold:{enabled:!1,apiKey:"",environment:"sandbox",webhookSecret:"",autoApprove:!1},paypal:{enabled:!1,clientId:"",clientSecret:"",environment:"sandbox",autoApprove:!1},payu:{enabled:!1,merchantId:"",apiKey:"",apiLogin:"",environment:"sandbox",autoApprove:!1},bankTransfer:{enabled:!1,accounts:[],autoApprove:!1,requireConfirmation:!0},general:{currency:"USD",defaultGateway:"bold"}}),[r,i]=ue.useState(!1);ue.useEffect(()=>{const g=ut(Ve,"artifacts",Fe,"public","data","settings","paymentConfig"),p=Gt(g,S=>{S.exists()&&n(S.data())});return()=>p()},[]);const s=(g,p,S)=>{n(k=>({...k,[g]:{...k[g],[p]:S}}))},o=(g,p)=>{n(S=>({...S,general:{...S.general,[g]:p}}))},l=()=>{const g={id:Date.now().toString(),bankName:"",accountNumber:"",accountHolder:"",accountType:"Ahorros"};n(p=>({...p,bankTransfer:{...p.bankTransfer,accounts:[...p.bankTransfer.accounts,g]}}))},c=(g,p,S)=>{n(k=>({...k,bankTransfer:{...k.bankTransfer,accounts:k.bankTransfer.accounts.map(C=>C.id===g?{...C,[p]:S}:C)}}))},u=g=>{n(p=>({...p,bankTransfer:{...p.bankTransfer,accounts:p.bankTransfer.accounts.filter(S=>S.id!==g)}}))},f=async()=>{i(!0);try{const g=ut(Ve,"artifacts",Fe,"public","data","settings","paymentConfig");await ws(g,e),t("Configuracin de pagos guardada exitosamente","success")}catch(g){console.error("Error saving payment config:",g),t("Error al guardar la configuracin","error")}i(!1)},v=(g,p,S)=>a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[a.jsx(Ji,{}),p]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:e[g].enabled,onChange:k=>s(g,"enabled",k.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Habilitado"})]})]}),e[g].enabled&&a.jsxs("div",{className:"space-y-4",children:[S.map(k=>a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:k.label}),k.type==="select"?a.jsx("select",{value:e[g][k.name],onChange:C=>s(g,k.name,C.target.value),className:"w-full p-2 border rounded-md",children:k.options.map(C=>a.jsx("option",{value:C.value,children:C.label},C.value))}):a.jsx("input",{type:k.type,value:e[g][k.name],onChange:C=>s(g,k.name,C.target.value),placeholder:k.placeholder,className:"w-full p-2 border rounded-md"}),k.help&&a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:k.help})]},k.name)),a.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-md",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:e[g].autoApprove,onChange:k=>s(g,"autoApprove",k.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Aprobar pagos automticamente"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Los pagos de esta pasarela se marcarn como "Completado" automticamente'})]})]})]});return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(eg,{}),"Configuracin de Pagos"]}),a.jsx("button",{onClick:f,disabled:r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:r?"Guardando...":"Guardar Configuracin"})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuracin General"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Moneda por Defecto"}),a.jsxs("select",{value:e.general.currency,onChange:g=>o("currency",g.target.value),className:"w-full p-2 border rounded-md",children:[a.jsx("option",{value:"USD",children:"USD - Dlar Americano"}),a.jsx("option",{value:"COP",children:"COP - Peso Colombiano"}),a.jsx("option",{value:"EUR",children:"EUR - Euro"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pasarela por Defecto"}),a.jsxs("select",{value:e.general.defaultGateway,onChange:g=>o("defaultGateway",g.target.value),className:"w-full p-2 border rounded-md",children:[a.jsx("option",{value:"bold",children:"Bold"}),a.jsx("option",{value:"paypal",children:"PayPal"}),a.jsx("option",{value:"payu",children:"PayU"}),a.jsx("option",{value:"bankTransfer",children:"Transferencia Bancaria"})]})]})]}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Cada pasarela tiene su propia configuracin de auto-aprobacin independiente."})]}),v("bold","Bold",[{name:"apiKey",label:"API Key",type:"password",placeholder:"Ingresa tu API Key de Bold"},{name:"environment",label:"Ambiente",type:"select",options:[{value:"sandbox",label:"Sandbox (Pruebas)"},{value:"production",label:"Produccin"}]},{name:"webhookSecret",label:"Webhook Secret",type:"password",placeholder:"Secreto para webhooks"}]),v("paypal","PayPal",[{name:"clientId",label:"Client ID",type:"text",placeholder:"Ingresa tu Client ID de PayPal"},{name:"clientSecret",label:"Client Secret",type:"password",placeholder:"Ingresa tu Client Secret"},{name:"environment",label:"Ambiente",type:"select",options:[{value:"sandbox",label:"Sandbox (Pruebas)"},{value:"live",label:"Live (Produccin)"}]}]),v("payu","PayU",[{name:"merchantId",label:"Merchant ID",type:"text",placeholder:"ID del comerciante"},{name:"apiKey",label:"API Key",type:"password",placeholder:"API Key de PayU"},{name:"apiLogin",label:"API Login",type:"text",placeholder:"API Login de PayU"},{name:"environment",label:"Ambiente",type:"select",options:[{value:"sandbox",label:"Sandbox (Pruebas)"},{value:"production",label:"Produccin"}]}]),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[a.jsx(Ji,{}),"Transferencias Bancarias"]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:e.bankTransfer.enabled,onChange:g=>s("bankTransfer","enabled",g.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Habilitado"})]})]}),e.bankTransfer.enabled&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"p-3 bg-gray-50 rounded-md",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:e.bankTransfer.autoApprove,onChange:g=>s("bankTransfer","autoApprove",g.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Aprobar transferencias automticamente"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Las transferencias se marcarn como "Completado" automticamente'})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h4",{className:"text-md font-medium text-gray-800",children:"Cuentas Bancarias"}),a.jsx("button",{onClick:l,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700",children:"+ Agregar Cuenta"})]}),a.jsx("div",{className:"space-y-4",children:e.bankTransfer.accounts.map((g,p)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h5",{className:"font-medium text-gray-700",children:["Cuenta ",p+1]}),a.jsx("button",{onClick:()=>u(g.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Eliminar"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Banco"}),a.jsx("input",{type:"text",value:g.bankName,onChange:S=>c(g.id,"bankName",S.target.value),placeholder:"Ej: Banco Nacional",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nmero de Cuenta"}),a.jsx("input",{type:"text",value:g.accountNumber,onChange:S=>c(g.id,"accountNumber",S.target.value),placeholder:"1234567890",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titular de la Cuenta"}),a.jsx("input",{type:"text",value:g.accountHolder,onChange:S=>c(g.id,"accountHolder",S.target.value),placeholder:"Nombre del titular",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Cuenta"}),a.jsxs("select",{value:g.accountType,onChange:S=>c(g.id,"accountType",S.target.value),className:"w-full p-2 border rounded-md",children:[a.jsx("option",{value:"Ahorros",children:"Ahorros"}),a.jsx("option",{value:"Corriente",children:"Corriente"})]})]})]})]},g.id))}),e.bankTransfer.accounts.length===0&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("p",{children:"No hay cuentas bancarias configuradas"}),a.jsx("p",{className:"text-sm",children:'Haz clic en "Agregar Cuenta" para comenzar'})]})]})]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:" Informacin Importante"}),a.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[a.jsx("li",{children:" Las credenciales se almacenan de forma segura en Firestore"}),a.jsx("li",{children:" Siempre prueba en modo sandbox antes de usar en produccin"}),a.jsx("li",{children:" Mantn tus claves API seguras y no las compartas"}),a.jsx("li",{children:" Los webhooks deben configurarse en cada pasarela de pago"})]})]})]})}function P8(){const{addNotification:t}=pn(),[e,n]=ue.useState({renewalSettings:{enabled:!0,maxRenewalYears:3,autoRenewal:!0,gracePeriodDays:7,reminderDays:3},discounts:{monthly:{enabled:!1,discount:0,description:"Descuento por pago mensual"},quarterly:{enabled:!1,discount:5,description:"Descuento por pago trimestral"},semiAnnual:{enabled:!1,discount:10,description:"Descuento por pago semestral"},annual:{enabled:!1,discount:15,description:"Descuento por pago anual"},biennial:{enabled:!1,discount:25,description:"Descuento por pago bienal (2 aos)"},triennial:{enabled:!1,discount:35,description:"Descuento por pago trienal (3 aos)"}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"},documentSettings:{invoiceName:"Factura",receiptName:"Remisin",invoicePrefix:"FAC",receiptPrefix:"REM",invoiceNumberFormat:"FAC-{year}-{month}-{number}",receiptNumberFormat:"REM-{year}-{month}-{number}"},pricingSettings:{roundToNearest:100,minimumAmount:1e3,maximumAmount:1e7}}),[r,i]=ue.useState(!1);ue.useEffect(()=>{const g=ut(Ve,"artifacts",Fe,"public","data","settings","renewalConfig"),p=Gt(g,S=>{S.exists()&&n(S.data())});return()=>p()},[]);const s=(g,p,S)=>{n(k=>({...k,[g]:{...k[g],[p]:S}}))},o=(g,p,S)=>{n(k=>({...k,discounts:{...k.discounts,[g]:{...k.discounts[g],[p]:S}}}))},l=async()=>{i(!0);try{const g=ut(Ve,"artifacts",Fe,"public","data","settings","renewalConfig");await ws(g,e),t("Configuracin de renovaciones guardada exitosamente","success")}catch(g){console.error("Error saving renewal config:",g),t("Error al guardar la configuracin","error")}i(!1)},c=(g,p)=>{const S=e.discounts[p];if(!S.enabled)return g;const k=g*S.discount/100,C=g-k,b=Math.round(C/e.pricingSettings.roundToNearest)*e.pricingSettings.roundToNearest;return Math.max(b,e.pricingSettings.minimumAmount)},u=g=>{if(!e.taxSettings.ivaEnabled||e.taxSettings.ivaIncluded)return g;{const p=g*e.taxSettings.ivaPercentage/100;return g+p}},f=g=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(g),v=[{key:"monthly",label:"Mensual",months:1},{key:"quarterly",label:"Trimestral",months:3},{key:"semiAnnual",label:"Semestral",months:6},{key:"annual",label:"Anual",months:12},{key:"biennial",label:"Bienal (2 aos)",months:24},{key:"triennial",label:"Trienal (3 aos)",months:36}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(dl,{}),"Configuracin de Renovaciones"]}),a.jsx("button",{onClick:l,disabled:r,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:r?"Guardando...":"Guardar Configuracin"})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(eg,{}),"Configuracin General"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx("div",{children:a.jsxs("label",{className:"flex items-center mb-2",children:[a.jsx("input",{type:"checkbox",checked:e.renewalSettings.enabled,onChange:g=>s("renewalSettings","enabled",g.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Habilitar renovaciones automticas"})]})}),a.jsx("div",{children:a.jsxs("label",{className:"flex items-center mb-2",children:[a.jsx("input",{type:"checkbox",checked:e.renewalSettings.autoRenewal,onChange:g=>s("renewalSettings","autoRenewal",g.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Renovacin automtica"})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mximo de aos para renovacin"}),a.jsxs("select",{value:e.renewalSettings.maxRenewalYears,onChange:g=>s("renewalSettings","maxRenewalYears",parseInt(g.target.value)),className:"w-full p-2 border rounded-md",children:[a.jsx("option",{value:1,children:"1 ao"}),a.jsx("option",{value:2,children:"2 aos"}),a.jsx("option",{value:3,children:"3 aos"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Das de gracia"}),a.jsx("input",{type:"number",value:e.renewalSettings.gracePeriodDays,onChange:g=>s("renewalSettings","gracePeriodDays",parseInt(g.target.value)),className:"w-full p-2 border rounded-md",min:"0",max:"30"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Das de recordatorio"}),a.jsx("input",{type:"number",value:e.renewalSettings.reminderDays,onChange:g=>s("renewalSettings","reminderDays",parseInt(g.target.value)),className:"w-full p-2 border rounded-md",min:"1",max:"30"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(dA,{}),"Descuentos por Perodo de Renovacin"]}),a.jsx("div",{className:"space-y-4",children:v.map(g=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:g.label}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:e.discounts[g.key].enabled,onChange:p=>o(g.key,"enabled",p.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Habilitado"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descuento (%)"}),a.jsx("input",{type:"number",value:e.discounts[g.key].discount,onChange:p=>o(g.key,"discount",parseFloat(p.target.value)),className:"w-full p-2 border rounded-md",min:"0",max:"100",step:"0.1",disabled:!e.discounts[g.key].enabled})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin"}),a.jsx("input",{type:"text",value:e.discounts[g.key].description,onChange:p=>o(g.key,"description",p.target.value),className:"w-full p-2 border rounded-md",disabled:!e.discounts[g.key].enabled})]})]}),e.discounts[g.key].enabled&&a.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-md",children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Simulacin de Precio"}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsxs("div",{children:["Precio original: ",f(1e5)]}),a.jsxs("div",{children:["Descuento (",e.discounts[g.key].discount,"%): ",f(1e5-c(1e5,g.key))]}),a.jsxs("div",{className:"font-semibold text-green-600",children:["Precio final: ",f(c(1e5,g.key))]})]})]})]},g.key))})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(Ji,{}),"Configuracin de Impuestos"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx("div",{children:a.jsxs("label",{className:"flex items-center mb-2",children:[a.jsx("input",{type:"checkbox",checked:e.taxSettings.ivaEnabled,onChange:g=>s("taxSettings","ivaEnabled",g.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Habilitar IVA"})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Porcentaje de IVA (%)"}),a.jsx("input",{type:"number",value:e.taxSettings.ivaPercentage,onChange:g=>s("taxSettings","ivaPercentage",parseFloat(g.target.value)),className:"w-full p-2 border rounded-md",min:"0",max:"100",step:"0.1",disabled:!e.taxSettings.ivaEnabled})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de IVA"}),a.jsxs("select",{value:e.taxSettings.ivaIncluded?"included":"excluded",onChange:g=>s("taxSettings","ivaIncluded",g.target.value==="included"),className:"w-full p-2 border rounded-md",disabled:!e.taxSettings.ivaEnabled,children:[a.jsx("option",{value:"excluded",children:"IVA se suma al precio"}),a.jsx("option",{value:"included",children:"IVA incluido en el precio"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del impuesto"}),a.jsx("input",{type:"text",value:e.taxSettings.taxName,onChange:g=>s("taxSettings","taxName",g.target.value),className:"w-full p-2 border rounded-md",disabled:!e.taxSettings.ivaEnabled})]})]}),e.taxSettings.ivaEnabled&&a.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Simulacin de Impuestos"}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsxs("div",{children:["Precio base: ",f(1e5)]}),!e.taxSettings.ivaIncluded&&a.jsxs("div",{children:["IVA (",e.taxSettings.ivaPercentage,"%): ",f(1e5*e.taxSettings.ivaPercentage/100)]}),a.jsxs("div",{className:"font-semibold text-blue-600",children:["Precio final: ",f(u(1e5))]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuracin de Documentos"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de Factura"}),a.jsx("input",{type:"text",value:e.documentSettings.invoiceName,onChange:g=>s("documentSettings","invoiceName",g.target.value),className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de Remisin"}),a.jsx("input",{type:"text",value:e.documentSettings.receiptName,onChange:g=>s("documentSettings","receiptName",g.target.value),className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prefijo de Factura"}),a.jsx("input",{type:"text",value:e.documentSettings.invoicePrefix,onChange:g=>s("documentSettings","invoicePrefix",g.target.value),className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prefijo de Remisin"}),a.jsx("input",{type:"text",value:e.documentSettings.receiptPrefix,onChange:g=>s("documentSettings","receiptPrefix",g.target.value),className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Formato de Nmero de Factura"}),a.jsx("input",{type:"text",value:e.documentSettings.invoiceNumberFormat,onChange:g=>s("documentSettings","invoiceNumberFormat",g.target.value),className:"w-full p-2 border rounded-md",placeholder:"FAC-{year}-{month}-{number}"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables disponibles: ","{year}",", ","{month}",", ","{number}"]})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Formato de Nmero de Remisin"}),a.jsx("input",{type:"text",value:e.documentSettings.receiptNumberFormat,onChange:g=>s("documentSettings","receiptNumberFormat",g.target.value),className:"w-full p-2 border rounded-md",placeholder:"REM-{year}-{month}-{number}"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables disponibles: ","{year}",", ","{month}",", ","{number}"]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuracin de Precios"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Redondear al mltiplo ms cercano"}),a.jsx("input",{type:"number",value:e.pricingSettings.roundToNearest,onChange:g=>s("pricingSettings","roundToNearest",parseInt(g.target.value)),className:"w-full p-2 border rounded-md",min:"1"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ej: 100 para redondear a centenas"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto mnimo"}),a.jsx("input",{type:"number",value:e.pricingSettings.minimumAmount,onChange:g=>s("pricingSettings","minimumAmount",parseInt(g.target.value)),className:"w-full p-2 border rounded-md",min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto mximo"}),a.jsx("input",{type:"number",value:e.pricingSettings.maximumAmount,onChange:g=>s("pricingSettings","maximumAmount",parseInt(g.target.value)),className:"w-full p-2 border rounded-md",min:"0"})]})]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:" Informacin Importante"}),a.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[a.jsx("li",{children:" Los descuentos se aplican automticamente segn el perodo de renovacin seleccionado"}),a.jsx("li",{children:" Los precios se redondean automticamente para evitar decimales"}),a.jsx("li",{children:" El IVA se calcula segn la configuracin establecida"}),a.jsx("li",{children:" Los nombres de documentos se pueden personalizar segn las necesidades"})]})]})]})}const R8="modulepreload",L8=function(t){return"/"+t},gw={},s0=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(c=>{if(c=L8(c),c in gw)return;gw[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const v=document.createElement("link");if(v.rel=u?"stylesheet":R8,u||(v.as="script"),v.crossOrigin="",v.href=c,l&&v.setAttribute("nonce",l),document.head.appendChild(v),u)return new Promise((g,p)=>{v.addEventListener("load",g),v.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};function hn(t){"@babel/helpers - typeof";return hn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hn(t)}var $s=Uint8Array,Qi=Uint16Array,Qy=Int32Array,Xy=new $s([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Jy=new $s([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),vw=new $s([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),mA=function(t,e){for(var n=new Qi(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var i=new Qy(n[30]),r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return{b:n,r:i}},pA=mA(Xy,2),D8=pA.b,qv=pA.r;D8[28]=258,qv[258]=28;var O8=mA(Jy,0),yw=O8.r,Hv=new Qi(32768);for(var In=0;In<32768;++In){var Vo=(In&43690)>>1|(In&21845)<<1;Vo=(Vo&52428)>>2|(Vo&13107)<<2,Vo=(Vo&61680)>>4|(Vo&3855)<<4,Hv[In]=((Vo&65280)>>8|(Vo&255)<<8)>>1}var zd=function(t,e,n){for(var r=t.length,i=0,s=new Qi(e);i<r;++i)t[i]&&++s[t[i]-1];var o=new Qi(e);for(i=1;i<e;++i)o[i]=o[i-1]+s[i-1]<<1;var l;if(n){l=new Qi(1<<e);var c=15-e;for(i=0;i<r;++i)if(t[i])for(var u=i<<4|t[i],f=e-t[i],v=o[t[i]-1]++<<f,g=v|(1<<f)-1;v<=g;++v)l[Hv[v]>>c]=u}else for(l=new Qi(r),i=0;i<r;++i)t[i]&&(l[i]=Hv[o[t[i]-1]++]>>15-t[i]);return l},gc=new $s(288);for(var In=0;In<144;++In)gc[In]=8;for(var In=144;In<256;++In)gc[In]=9;for(var In=256;In<280;++In)gc[In]=7;for(var In=280;In<288;++In)gc[In]=8;var cp=new $s(32);for(var In=0;In<32;++In)cp[In]=5;var M8=zd(gc,9,0),F8=zd(cp,5,0),gA=function(t){return(t+7)/8|0},U8=function(t,e,n){return(n==null||n>t.length)&&(n=t.length),new $s(t.subarray(e,n))},za=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8},vd=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8,t[r+2]|=n>>16},a0=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var i=n.length,s=n.slice();if(!i)return{t:yA,l:0};if(i==1){var o=new $s(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort(function(ee,oe){return ee.f-oe.f}),n.push({s:-1,f:25001});var l=n[0],c=n[1],u=0,f=1,v=2;for(n[0]={s:-1,f:l.f+c.f,l,r:c};f!=i-1;)l=n[n[u].f<n[v].f?u++:v++],c=n[u!=f&&n[u].f<n[v].f?u++:v++],n[f++]={s:-1,f:l.f+c.f,l,r:c};for(var g=s[0].s,r=1;r<i;++r)s[r].s>g&&(g=s[r].s);var p=new Qi(g+1),S=Wv(n[f-1],p,0);if(S>e){var r=0,k=0,C=S-e,b=1<<C;for(s.sort(function(oe,V){return p[V.s]-p[oe.s]||oe.f-V.f});r<i;++r){var I=s[r].s;if(p[I]>e)k+=b-(1<<S-p[I]),p[I]=e;else break}for(k>>=C;k>0;){var R=s[r].s;p[R]<e?k-=1<<e-p[R]++-1:++r}for(;r>=0&&k;--r){var D=s[r].s;p[D]==e&&(--p[D],++k)}S=e}return{t:new $s(p),l:S}},Wv=function(t,e,n){return t.s==-1?Math.max(Wv(t.l,e,n+1),Wv(t.r,e,n+1)):e[t.s]=n},xw=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new Qi(++e),r=0,i=t[0],s=1,o=function(c){n[r++]=c},l=1;l<=e;++l)if(t[l]==i&&l!=e)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=t[l]}return{c:n.subarray(0,r),n:e}},yd=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},vA=function(t,e,n){var r=n.length,i=gA(e+2);t[i]=r&255,t[i+1]=r>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var s=0;s<r;++s)t[i+s+4]=n[s];return(i+4+r)*8},bw=function(t,e,n,r,i,s,o,l,c,u,f){za(e,f++,n),++i[256];for(var v=a0(i,15),g=v.t,p=v.l,S=a0(s,15),k=S.t,C=S.l,b=xw(g),I=b.c,R=b.n,D=xw(k),ee=D.c,oe=D.n,V=new Qi(19),T=0;T<I.length;++T)++V[I[T]&31];for(var T=0;T<ee.length;++T)++V[ee[T]&31];for(var N=a0(V,7),U=N.t,E=N.l,L=19;L>4&&!U[vw[L-1]];--L);var _=u+5<<3,M=yd(i,gc)+yd(s,cp)+o,K=yd(i,g)+yd(s,k)+o+14+3*L+yd(V,U)+2*V[16]+3*V[17]+7*V[18];if(c>=0&&_<=M&&_<=K)return vA(e,f,t.subarray(c,c+u));var F,X,H,W;if(za(e,f,1+(K<M)),f+=2,K<M){F=zd(g,p,0),X=g,H=zd(k,C,0),W=k;var Y=zd(U,E,0);za(e,f,R-257),za(e,f+5,oe-1),za(e,f+10,L-4),f+=14;for(var T=0;T<L;++T)za(e,f+3*T,U[vw[T]]);f+=3*L;for(var B=[I,ee],A=0;A<2;++A)for(var P=B[A],T=0;T<P.length;++T){var q=P[T]&31;za(e,f,Y[q]),f+=U[q],q>15&&(za(e,f,P[T]>>5&127),f+=P[T]>>12)}}else F=M8,X=gc,H=F8,W=cp;for(var T=0;T<l;++T){var te=r[T];if(te>255){var q=te>>18&31;vd(e,f,F[q+257]),f+=X[q+257],q>7&&(za(e,f,te>>23&31),f+=Xy[q]);var le=te&31;vd(e,f,H[le]),f+=W[le],le>3&&(vd(e,f,te>>5&8191),f+=Jy[le])}else vd(e,f,F[te]),f+=X[te]}return vd(e,f,F[256]),f+X[256]},V8=new Qy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),yA=new $s(0),B8=function(t,e,n,r,i,s){var o=s.z||t.length,l=new $s(r+o+5*(1+Math.ceil(o/7e3))+i),c=l.subarray(r,l.length-i),u=s.l,f=(s.r||0)&7;if(e){f&&(c[0]=s.r>>3);for(var v=V8[e-1],g=v>>13,p=v&8191,S=(1<<n)-1,k=s.p||new Qi(32768),C=s.h||new Qi(S+1),b=Math.ceil(n/3),I=2*b,R=function(xe){return(t[xe]^t[xe+1]<<b^t[xe+2]<<I)&S},D=new Qy(25e3),ee=new Qi(288),oe=new Qi(32),V=0,T=0,N=s.i||0,U=0,E=s.w||0,L=0;N+2<o;++N){var _=R(N),M=N&32767,K=C[_];if(k[M]=K,C[_]=M,E<=N){var F=o-N;if((V>7e3||U>24576)&&(F>423||!u)){f=bw(t,c,0,D,ee,oe,T,U,L,N-L,f),U=V=T=0,L=N;for(var X=0;X<286;++X)ee[X]=0;for(var X=0;X<30;++X)oe[X]=0}var H=2,W=0,Y=p,B=M-K&32767;if(F>2&&_==R(N-B))for(var A=Math.min(g,F)-1,P=Math.min(32767,N),q=Math.min(258,F);B<=P&&--Y&&M!=K;){if(t[N+H]==t[N+H-B]){for(var te=0;te<q&&t[N+te]==t[N+te-B];++te);if(te>H){if(H=te,W=B,te>A)break;for(var le=Math.min(B,te-2),ce=0,X=0;X<le;++X){var me=N-B+X&32767,he=k[me],we=me-he&32767;we>ce&&(ce=we,K=me)}}}M=K,K=k[M],B+=M-K&32767}if(W){D[U++]=268435456|qv[H]<<18|yw[W];var Ee=qv[H]&31,Le=yw[W]&31;T+=Xy[Ee]+Jy[Le],++ee[257+Ee],++oe[Le],E=N+H,++V}else D[U++]=t[N],++ee[t[N]]}}for(N=Math.max(N,E);N<o;++N)D[U++]=t[N],++ee[t[N]];f=bw(t,c,u,D,ee,oe,T,U,L,N-L,f),u||(s.r=f&7|c[f/8|0]<<3,f-=7,s.h=C,s.p=k,s.i=N,s.w=E)}else{for(var N=s.w||0;N<o+u;N+=65535){var Re=N+65535;Re>=o&&(c[f/8|0]=u,Re=o),f=vA(c,f+1,t.subarray(N,Re))}s.i=o}return U8(l,0,r+gA(f)+i)},xA=function(){var t=1,e=0;return{p:function(n){for(var r=t,i=e,s=n.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)i+=r+=n[o];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}t=r,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},$8=function(t,e,n,r,i){if(!i&&(i={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),o=new $s(s.length+t.length);o.set(s),o.set(t,s.length),t=o,i.w=s.length}return B8(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,r,i)},bA=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},z8=function(t,e){var n=e.level,r=n==0?0:n<6?1:n==9?3:2;if(t[0]=120,t[1]=r<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=xA();i.p(e.dictionary),bA(t,2,i.d())}};function Gv(t,e){e||(e={});var n=xA();n.p(t);var r=$8(t,e,e.dictionary?6:2,4);return z8(r,e),bA(r,r.length-4,n.d()),r}var q8=typeof TextDecoder<"u"&&new TextDecoder,H8=0;try{q8.decode(yA,{stream:!0}),H8=1}catch{}function W8(t){if(Array.isArray(t))return t}function G8(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,o,l=[],c=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(c=(r=s.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(f){u=!0,i=f}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function ww(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function K8(t,e){if(t){if(typeof t=="string")return ww(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ww(t,e):void 0}}function Y8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nw(t,e){return W8(t)||G8(t,e)||K8(t,e)||Y8()}function _w(t,e="utf8"){return new TextDecoder(e).decode(t)}const Q8=new TextEncoder;function X8(t){return Q8.encode(t)}const J8=1024*8,Z8=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),o0={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Zy{constructor(e=J8,n={}){dn(this,"buffer");dn(this,"byteLength");dn(this,"byteOffset");dn(this,"length");dn(this,"offset");dn(this,"lastWrittenByte");dn(this,"littleEndian");dn(this,"_data");dn(this,"_mark");dn(this,"_marks");let r=!1;typeof e=="number"?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);const i=n.offset?n.offset>>>0:0,s=e.byteLength-i;let o=i;(ArrayBuffer.isView(e)||e instanceof Zy)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+i),e=e.buffer),r?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const r=(this.offset+e)*2,i=new Uint8Array(r);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,n){const r=o0[n].BYTES_PER_ELEMENT*e,i=this.byteOffset+this.offset,s=this.buffer.slice(i,i+r);if(this.littleEndian===Z8&&n!=="uint8"&&n!=="int8"){const l=new Uint8Array(this.buffer.slice(i,i+r));l.reverse();const c=new o0[n](l.buffer);return this.offset+=r,c.reverse(),c}const o=new o0[n](s);return this.offset+=r,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let n="";for(let r=0;r<e;r++)n+=this.readChar();return n}readUtf8(e=1){return _w(this.readBytes(e))}decodeText(e=1,n="utf8"){return _w(this.readBytes(e),n)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let n=0;n<e.length;n++)this._data.setUint8(this.offset++,e[n]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let n=0;n<e.length;n++)this.writeUint8(e.charCodeAt(n));return this}writeUtf8(e){return this.writeBytes(X8(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Vu(t){let e=t.length;for(;--e>=0;)t[e]=0}const e7=3,t7=258,wA=29,n7=256,r7=n7+1+wA,NA=30,i7=512,s7=new Array((r7+2)*2);Vu(s7);const a7=new Array(NA*2);Vu(a7);const o7=new Array(i7);Vu(o7);const l7=new Array(t7-e7+1);Vu(l7);const c7=new Array(wA);Vu(c7);const u7=new Array(NA);Vu(u7);const d7=(t,e,n,r)=>{let i=t&65535|0,s=t>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do i=i+e[r++]|0,s=s+i|0;while(--o);i%=65521,s%=65521}return i|s<<16|0};var Kv=d7;const h7=()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e},f7=new Uint32Array(h7()),m7=(t,e,n,r)=>{const i=f7,s=r+n;t^=-1;for(let o=r;o<s;o++)t=t>>>8^i[(t^e[o])&255];return t^-1};var ca=m7,Yv={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},_A={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const p7=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var g7=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)p7(n,r)&&(t[r]=n[r])}}return t},v7=t=>{let e=0;for(let r=0,i=t.length;r<i;r++)e+=t[r].length;const n=new Uint8Array(e);for(let r=0,i=0,s=t.length;r<s;r++){let o=t[r];n.set(o,i),i+=o.length}return n},EA={assign:g7,flattenChunks:v7};let AA=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{AA=!1}const yh=new Uint8Array(256);for(let t=0;t<256;t++)yh[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;yh[254]=yh[254]=1;var y7=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,n,r,i,s,o=t.length,l=0;for(i=0;i<o;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<o&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(l),s=0,i=0;s<l;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<o&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|n&63):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|n&63):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|n&63);return e};const x7=(t,e)=>{if(e<65534&&t.subarray&&AA)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n};var b7=(t,e)=>{const n=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let r,i;const s=new Array(n*2);for(i=0,r=0;r<n;){let o=t[r++];if(o<128){s[i++]=o;continue}let l=yh[o];if(l>4){s[i++]=65533,r+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&r<n;)o=o<<6|t[r++]&63,l--;if(l>1){s[i++]=65533;continue}o<65536?s[i++]=o:(o-=65536,s[i++]=55296|o>>10&1023,s[i++]=56320|o&1023)}return x7(s,i)},w7=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let n=e-1;for(;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?e:n+yh[t[n]]>e?n:e},Qv={string2buf:y7,buf2string:b7,utf8border:w7};function N7(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var _7=N7;const Cf=16209,E7=16191;var A7=function(e,n){let r,i,s,o,l,c,u,f,v,g,p,S,k,C,b,I,R,D,ee,oe,V,T,N,U;const E=e.state;r=e.next_in,N=e.input,i=r+(e.avail_in-5),s=e.next_out,U=e.output,o=s-(n-e.avail_out),l=s+(e.avail_out-257),c=E.dmax,u=E.wsize,f=E.whave,v=E.wnext,g=E.window,p=E.hold,S=E.bits,k=E.lencode,C=E.distcode,b=(1<<E.lenbits)-1,I=(1<<E.distbits)-1;e:do{S<15&&(p+=N[r++]<<S,S+=8,p+=N[r++]<<S,S+=8),R=k[p&b];t:for(;;){if(D=R>>>24,p>>>=D,S-=D,D=R>>>16&255,D===0)U[s++]=R&65535;else if(D&16){ee=R&65535,D&=15,D&&(S<D&&(p+=N[r++]<<S,S+=8),ee+=p&(1<<D)-1,p>>>=D,S-=D),S<15&&(p+=N[r++]<<S,S+=8,p+=N[r++]<<S,S+=8),R=C[p&I];n:for(;;){if(D=R>>>24,p>>>=D,S-=D,D=R>>>16&255,D&16){if(oe=R&65535,D&=15,S<D&&(p+=N[r++]<<S,S+=8,S<D&&(p+=N[r++]<<S,S+=8)),oe+=p&(1<<D)-1,oe>c){e.msg="invalid distance too far back",E.mode=Cf;break e}if(p>>>=D,S-=D,D=s-o,oe>D){if(D=oe-D,D>f&&E.sane){e.msg="invalid distance too far back",E.mode=Cf;break e}if(V=0,T=g,v===0){if(V+=u-D,D<ee){ee-=D;do U[s++]=g[V++];while(--D);V=s-oe,T=U}}else if(v<D){if(V+=u+v-D,D-=v,D<ee){ee-=D;do U[s++]=g[V++];while(--D);if(V=0,v<ee){D=v,ee-=D;do U[s++]=g[V++];while(--D);V=s-oe,T=U}}}else if(V+=v-D,D<ee){ee-=D;do U[s++]=g[V++];while(--D);V=s-oe,T=U}for(;ee>2;)U[s++]=T[V++],U[s++]=T[V++],U[s++]=T[V++],ee-=3;ee&&(U[s++]=T[V++],ee>1&&(U[s++]=T[V++]))}else{V=s-oe;do U[s++]=U[V++],U[s++]=U[V++],U[s++]=U[V++],ee-=3;while(ee>2);ee&&(U[s++]=U[V++],ee>1&&(U[s++]=U[V++]))}}else if(D&64){e.msg="invalid distance code",E.mode=Cf;break e}else{R=C[(R&65535)+(p&(1<<D)-1)];continue n}break}}else if(D&64)if(D&32){E.mode=E7;break e}else{e.msg="invalid literal/length code",E.mode=Cf;break e}else{R=k[(R&65535)+(p&(1<<D)-1)];continue t}break}}while(r<i&&s<l);ee=S>>3,r-=ee,S-=ee<<3,p&=(1<<S)-1,e.next_in=r,e.next_out=s,e.avail_in=r<i?5+(i-r):5-(r-i),e.avail_out=s<l?257+(l-s):257-(s-l),E.hold=p,E.bits=S};const Pc=15,Ew=852,Aw=592,Sw=0,l0=1,kw=2,S7=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),k7=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),T7=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),j7=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),C7=(t,e,n,r,i,s,o,l)=>{const c=l.bits;let u=0,f=0,v=0,g=0,p=0,S=0,k=0,C=0,b=0,I=0,R,D,ee,oe,V,T=null,N;const U=new Uint16Array(Pc+1),E=new Uint16Array(Pc+1);let L=null,_,M,K;for(u=0;u<=Pc;u++)U[u]=0;for(f=0;f<r;f++)U[e[n+f]]++;for(p=c,g=Pc;g>=1&&U[g]===0;g--);if(p>g&&(p=g),g===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,l.bits=1,0;for(v=1;v<g&&U[v]===0;v++);for(p<v&&(p=v),C=1,u=1;u<=Pc;u++)if(C<<=1,C-=U[u],C<0)return-1;if(C>0&&(t===Sw||g!==1))return-1;for(E[1]=0,u=1;u<Pc;u++)E[u+1]=E[u]+U[u];for(f=0;f<r;f++)e[n+f]!==0&&(o[E[e[n+f]]++]=f);if(t===Sw?(T=L=o,N=20):t===l0?(T=S7,L=k7,N=257):(T=T7,L=j7,N=0),I=0,f=0,u=v,V=s,S=p,k=0,ee=-1,b=1<<p,oe=b-1,t===l0&&b>Ew||t===kw&&b>Aw)return 1;for(;;){_=u-k,o[f]+1<N?(M=0,K=o[f]):o[f]>=N?(M=L[o[f]-N],K=T[o[f]-N]):(M=96,K=0),R=1<<u-k,D=1<<S,v=D;do D-=R,i[V+(I>>k)+D]=_<<24|M<<16|K|0;while(D!==0);for(R=1<<u-1;I&R;)R>>=1;if(R!==0?(I&=R-1,I+=R):I=0,f++,--U[u]===0){if(u===g)break;u=e[n+o[f]]}if(u>p&&(I&oe)!==ee){for(k===0&&(k=p),V+=v,S=u-k,C=1<<S;S+k<g&&(C-=U[S+k],!(C<=0));)S++,C<<=1;if(b+=1<<S,t===l0&&b>Ew||t===kw&&b>Aw)return 1;ee=I&oe,i[ee]=p<<24|S<<16|V-s|0}}return I!==0&&(i[V+I]=u-k<<24|64<<16|0),l.bits=p,0};var qd=C7;const I7=0,SA=1,kA=2,{Z_FINISH:Tw,Z_BLOCK:P7,Z_TREES:If,Z_OK:vc,Z_STREAM_END:R7,Z_NEED_DICT:L7,Z_STREAM_ERROR:Ns,Z_DATA_ERROR:TA,Z_MEM_ERROR:jA,Z_BUF_ERROR:D7,Z_DEFLATED:jw}=_A,tg=16180,Cw=16181,Iw=16182,Pw=16183,Rw=16184,Lw=16185,Dw=16186,Ow=16187,Mw=16188,Fw=16189,up=16190,qa=16191,c0=16192,Uw=16193,u0=16194,Vw=16195,Bw=16196,$w=16197,zw=16198,Pf=16199,Rf=16200,qw=16201,Hw=16202,Ww=16203,Gw=16204,Kw=16205,d0=16206,Yw=16207,Qw=16208,On=16209,CA=16210,IA=16211,O7=852,M7=592,F7=15,U7=F7,Xw=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function V7(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const _c=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<tg||e.mode>IA?1:0},PA=t=>{if(_c(t))return Ns;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=tg,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(O7),e.distcode=e.distdyn=new Int32Array(M7),e.sane=1,e.back=-1,vc},RA=t=>{if(_c(t))return Ns;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,PA(t)},LA=(t,e)=>{let n;if(_c(t))return Ns;const r=t.state;return e<0?(n=0,e=-e):(n=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Ns:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,RA(t))},DA=(t,e)=>{if(!t)return Ns;const n=new V7;t.state=n,n.strm=t,n.window=null,n.mode=tg;const r=LA(t,e);return r!==vc&&(t.state=null),r},B7=t=>DA(t,U7);let Jw=!0,h0,f0;const $7=t=>{if(Jw){h0=new Int32Array(512),f0=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(qd(SA,t.lens,0,288,h0,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;qd(kA,t.lens,0,32,f0,0,t.work,{bits:5}),Jw=!1}t.lencode=h0,t.lenbits=9,t.distcode=f0,t.distbits=5},OA=(t,e,n,r)=>{let i;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(e.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(e.subarray(n-r,n-r+i),s.wnext),r-=i,r?(s.window.set(e.subarray(n-r,n),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},z7=(t,e)=>{let n,r,i,s,o,l,c,u,f,v,g,p,S,k,C=0,b,I,R,D,ee,oe,V,T;const N=new Uint8Array(4);let U,E;const L=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(_c(t)||!t.output||!t.input&&t.avail_in!==0)return Ns;n=t.state,n.mode===qa&&(n.mode=c0),o=t.next_out,i=t.output,c=t.avail_out,s=t.next_in,r=t.input,l=t.avail_in,u=n.hold,f=n.bits,v=l,g=c,T=vc;e:for(;;)switch(n.mode){case tg:if(n.wrap===0){n.mode=c0;break}for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.wrap&2&&u===35615){n.wbits===0&&(n.wbits=15),n.check=0,N[0]=u&255,N[1]=u>>>8&255,n.check=ca(n.check,N,2,0),u=0,f=0,n.mode=Cw;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",n.mode=On;break}if((u&15)!==jw){t.msg="unknown compression method",n.mode=On;break}if(u>>>=4,f-=4,V=(u&15)+8,n.wbits===0&&(n.wbits=V),V>15||V>n.wbits){t.msg="invalid window size",n.mode=On;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=u&512?Fw:qa,u=0,f=0;break;case Cw:for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.flags=u,(n.flags&255)!==jw){t.msg="unknown compression method",n.mode=On;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=On;break}n.head&&(n.head.text=u>>8&1),n.flags&512&&n.wrap&4&&(N[0]=u&255,N[1]=u>>>8&255,n.check=ca(n.check,N,2,0)),u=0,f=0,n.mode=Iw;case Iw:for(;f<32;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.head&&(n.head.time=u),n.flags&512&&n.wrap&4&&(N[0]=u&255,N[1]=u>>>8&255,N[2]=u>>>16&255,N[3]=u>>>24&255,n.check=ca(n.check,N,4,0)),u=0,f=0,n.mode=Pw;case Pw:for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.head&&(n.head.xflags=u&255,n.head.os=u>>8),n.flags&512&&n.wrap&4&&(N[0]=u&255,N[1]=u>>>8&255,n.check=ca(n.check,N,2,0)),u=0,f=0,n.mode=Rw;case Rw:if(n.flags&1024){for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.length=u,n.head&&(n.head.extra_len=u),n.flags&512&&n.wrap&4&&(N[0]=u&255,N[1]=u>>>8&255,n.check=ca(n.check,N,2,0)),u=0,f=0}else n.head&&(n.head.extra=null);n.mode=Lw;case Lw:if(n.flags&1024&&(p=n.length,p>l&&(p=l),p&&(n.head&&(V=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(s,s+p),V)),n.flags&512&&n.wrap&4&&(n.check=ca(n.check,r,p,s)),l-=p,s+=p,n.length-=p),n.length))break e;n.length=0,n.mode=Dw;case Dw:if(n.flags&2048){if(l===0)break e;p=0;do V=r[s+p++],n.head&&V&&n.length<65536&&(n.head.name+=String.fromCharCode(V));while(V&&p<l);if(n.flags&512&&n.wrap&4&&(n.check=ca(n.check,r,p,s)),l-=p,s+=p,V)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=Ow;case Ow:if(n.flags&4096){if(l===0)break e;p=0;do V=r[s+p++],n.head&&V&&n.length<65536&&(n.head.comment+=String.fromCharCode(V));while(V&&p<l);if(n.flags&512&&n.wrap&4&&(n.check=ca(n.check,r,p,s)),l-=p,s+=p,V)break e}else n.head&&(n.head.comment=null);n.mode=Mw;case Mw:if(n.flags&512){for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.wrap&4&&u!==(n.check&65535)){t.msg="header crc mismatch",n.mode=On;break}u=0,f=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=qa;break;case Fw:for(;f<32;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}t.adler=n.check=Xw(u),u=0,f=0,n.mode=up;case up:if(n.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,n.hold=u,n.bits=f,L7;t.adler=n.check=1,n.mode=qa;case qa:if(e===P7||e===If)break e;case c0:if(n.last){u>>>=f&7,f-=f&7,n.mode=d0;break}for(;f<3;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}switch(n.last=u&1,u>>>=1,f-=1,u&3){case 0:n.mode=Uw;break;case 1:if($7(n),n.mode=Pf,e===If){u>>>=2,f-=2;break e}break;case 2:n.mode=Bw;break;case 3:t.msg="invalid block type",n.mode=On}u>>>=2,f-=2;break;case Uw:for(u>>>=f&7,f-=f&7;f<32;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if((u&65535)!==(u>>>16^65535)){t.msg="invalid stored block lengths",n.mode=On;break}if(n.length=u&65535,u=0,f=0,n.mode=u0,e===If)break e;case u0:n.mode=Vw;case Vw:if(p=n.length,p){if(p>l&&(p=l),p>c&&(p=c),p===0)break e;i.set(r.subarray(s,s+p),o),l-=p,s+=p,c-=p,o+=p,n.length-=p;break}n.mode=qa;break;case Bw:for(;f<14;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.nlen=(u&31)+257,u>>>=5,f-=5,n.ndist=(u&31)+1,u>>>=5,f-=5,n.ncode=(u&15)+4,u>>>=4,f-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=On;break}n.have=0,n.mode=$w;case $w:for(;n.have<n.ncode;){for(;f<3;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.lens[L[n.have++]]=u&7,u>>>=3,f-=3}for(;n.have<19;)n.lens[L[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,U={bits:n.lenbits},T=qd(I7,n.lens,0,19,n.lencode,0,n.work,U),n.lenbits=U.bits,T){t.msg="invalid code lengths set",n.mode=On;break}n.have=0,n.mode=zw;case zw:for(;n.have<n.nlen+n.ndist;){for(;C=n.lencode[u&(1<<n.lenbits)-1],b=C>>>24,I=C>>>16&255,R=C&65535,!(b<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(R<16)u>>>=b,f-=b,n.lens[n.have++]=R;else{if(R===16){for(E=b+2;f<E;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(u>>>=b,f-=b,n.have===0){t.msg="invalid bit length repeat",n.mode=On;break}V=n.lens[n.have-1],p=3+(u&3),u>>>=2,f-=2}else if(R===17){for(E=b+3;f<E;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}u>>>=b,f-=b,V=0,p=3+(u&7),u>>>=3,f-=3}else{for(E=b+7;f<E;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}u>>>=b,f-=b,V=0,p=11+(u&127),u>>>=7,f-=7}if(n.have+p>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=On;break}for(;p--;)n.lens[n.have++]=V}}if(n.mode===On)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=On;break}if(n.lenbits=9,U={bits:n.lenbits},T=qd(SA,n.lens,0,n.nlen,n.lencode,0,n.work,U),n.lenbits=U.bits,T){t.msg="invalid literal/lengths set",n.mode=On;break}if(n.distbits=6,n.distcode=n.distdyn,U={bits:n.distbits},T=qd(kA,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,U),n.distbits=U.bits,T){t.msg="invalid distances set",n.mode=On;break}if(n.mode=Pf,e===If)break e;case Pf:n.mode=Rf;case Rf:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,n.hold=u,n.bits=f,A7(t,g),o=t.next_out,i=t.output,c=t.avail_out,s=t.next_in,r=t.input,l=t.avail_in,u=n.hold,f=n.bits,n.mode===qa&&(n.back=-1);break}for(n.back=0;C=n.lencode[u&(1<<n.lenbits)-1],b=C>>>24,I=C>>>16&255,R=C&65535,!(b<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(I&&!(I&240)){for(D=b,ee=I,oe=R;C=n.lencode[oe+((u&(1<<D+ee)-1)>>D)],b=C>>>24,I=C>>>16&255,R=C&65535,!(D+b<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}u>>>=D,f-=D,n.back+=D}if(u>>>=b,f-=b,n.back+=b,n.length=R,I===0){n.mode=Kw;break}if(I&32){n.back=-1,n.mode=qa;break}if(I&64){t.msg="invalid literal/length code",n.mode=On;break}n.extra=I&15,n.mode=qw;case qw:if(n.extra){for(E=n.extra;f<E;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,f-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=Hw;case Hw:for(;C=n.distcode[u&(1<<n.distbits)-1],b=C>>>24,I=C>>>16&255,R=C&65535,!(b<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(!(I&240)){for(D=b,ee=I,oe=R;C=n.distcode[oe+((u&(1<<D+ee)-1)>>D)],b=C>>>24,I=C>>>16&255,R=C&65535,!(D+b<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}u>>>=D,f-=D,n.back+=D}if(u>>>=b,f-=b,n.back+=b,I&64){t.msg="invalid distance code",n.mode=On;break}n.offset=R,n.extra=I&15,n.mode=Ww;case Ww:if(n.extra){for(E=n.extra;f<E;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,f-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=On;break}n.mode=Gw;case Gw:if(c===0)break e;if(p=g-c,n.offset>p){if(p=n.offset-p,p>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=On;break}p>n.wnext?(p-=n.wnext,S=n.wsize-p):S=n.wnext-p,p>n.length&&(p=n.length),k=n.window}else k=i,S=o-n.offset,p=n.length;p>c&&(p=c),c-=p,n.length-=p;do i[o++]=k[S++];while(--p);n.length===0&&(n.mode=Rf);break;case Kw:if(c===0)break e;i[o++]=n.length,c--,n.mode=Rf;break;case d0:if(n.wrap){for(;f<32;){if(l===0)break e;l--,u|=r[s++]<<f,f+=8}if(g-=c,t.total_out+=g,n.total+=g,n.wrap&4&&g&&(t.adler=n.check=n.flags?ca(n.check,i,g,o-g):Kv(n.check,i,g,o-g)),g=c,n.wrap&4&&(n.flags?u:Xw(u))!==n.check){t.msg="incorrect data check",n.mode=On;break}u=0,f=0}n.mode=Yw;case Yw:if(n.wrap&&n.flags){for(;f<32;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.wrap&4&&u!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=On;break}u=0,f=0}n.mode=Qw;case Qw:T=R7;break e;case On:T=TA;break e;case CA:return jA;case IA:default:return Ns}return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,n.hold=u,n.bits=f,(n.wsize||g!==t.avail_out&&n.mode<On&&(n.mode<d0||e!==Tw))&&OA(t,t.output,t.next_out,g-t.avail_out),v-=t.avail_in,g-=t.avail_out,t.total_in+=v,t.total_out+=g,n.total+=g,n.wrap&4&&g&&(t.adler=n.check=n.flags?ca(n.check,i,g,t.next_out-g):Kv(n.check,i,g,t.next_out-g)),t.data_type=n.bits+(n.last?64:0)+(n.mode===qa?128:0)+(n.mode===Pf||n.mode===u0?256:0),(v===0&&g===0||e===Tw)&&T===vc&&(T=D7),T},q7=t=>{if(_c(t))return Ns;let e=t.state;return e.window&&(e.window=null),t.state=null,vc},H7=(t,e)=>{if(_c(t))return Ns;const n=t.state;return n.wrap&2?(n.head=e,e.done=!1,vc):Ns},W7=(t,e)=>{const n=e.length;let r,i,s;return _c(t)||(r=t.state,r.wrap!==0&&r.mode!==up)?Ns:r.mode===up&&(i=1,i=Kv(i,e,n,0),i!==r.check)?TA:(s=OA(t,e,n,n),s?(r.mode=CA,jA):(r.havedict=1,vc))};var G7=RA,K7=LA,Y7=PA,Q7=B7,X7=DA,J7=z7,Z7=q7,eD=H7,tD=W7,nD="pako inflate (from Nodeca project)",Ga={inflateReset:G7,inflateReset2:K7,inflateResetKeep:Y7,inflateInit:Q7,inflateInit2:X7,inflate:J7,inflateEnd:Z7,inflateGetHeader:eD,inflateSetDictionary:tD,inflateInfo:nD};function rD(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var iD=rD;const MA=Object.prototype.toString,{Z_NO_FLUSH:sD,Z_FINISH:aD,Z_OK:xh,Z_STREAM_END:m0,Z_NEED_DICT:p0,Z_STREAM_ERROR:oD,Z_DATA_ERROR:Zw,Z_MEM_ERROR:lD}=_A;function Bh(t){this.options=EA.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _7,this.strm.avail_out=0;let n=Ga.inflateInit2(this.strm,e.windowBits);if(n!==xh)throw new Error(Yv[n]);if(this.header=new iD,Ga.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Qv.string2buf(e.dictionary):MA.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=Ga.inflateSetDictionary(this.strm,e.dictionary),n!==xh)))throw new Error(Yv[n])}Bh.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?aD:sD,MA.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),s=Ga.inflate(n,o),s===p0&&i&&(s=Ga.inflateSetDictionary(n,i),s===xh?s=Ga.inflate(n,o):s===Zw&&(s=p0));n.avail_in>0&&s===m0&&n.state.wrap>0&&t[n.next_in]!==0;)Ga.inflateReset(n),s=Ga.inflate(n,o);switch(s){case oD:case Zw:case p0:case lD:return this.onEnd(s),this.ended=!0,!1}if(l=n.avail_out,n.next_out&&(n.avail_out===0||s===m0))if(this.options.to==="string"){let c=Qv.utf8border(n.output,n.next_out),u=n.next_out-c,f=Qv.buf2string(n.output,c);n.next_out=u,n.avail_out=r-u,u&&n.output.set(n.output.subarray(c,c+u),0),this.onData(f)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(s===xh&&l===0)){if(s===m0)return s=Ga.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};Bh.prototype.onData=function(t){this.chunks.push(t)};Bh.prototype.onEnd=function(t){t===xh&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=EA.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function cD(t,e){const n=new Bh(e);if(n.push(t),n.err)throw n.msg||Yv[n.err];return n.result}var uD=Bh,dD=cD,hD={Inflate:uD,inflate:dD};const{Inflate:fD,inflate:mD}=hD;var e5=fD,pD=mD;const FA=[];for(let t=0;t<256;t++){let e=t;for(let n=0;n<8;n++)e&1?e=3988292384^e>>>1:e=e>>>1;FA[t]=e}const t5=4294967295;function gD(t,e,n){let r=t;for(let i=0;i<n;i++)r=FA[(r^e[i])&255]^r>>>8;return r}function vD(t,e){return(gD(t5,t,e)^t5)>>>0}function n5(t,e,n){const r=t.readUint32(),i=vD(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(i!==r)throw new Error(`CRC mismatch for chunk ${n}. Expected ${r}, found ${i}`)}function UA(t,e,n){for(let r=0;r<n;r++)e[r]=t[r]}function VA(t,e,n,r){let i=0;for(;i<r;i++)e[i]=t[i];for(;i<n;i++)e[i]=t[i]+e[i-r]&255}function BA(t,e,n,r){let i=0;if(n.length===0)for(;i<r;i++)e[i]=t[i];else for(;i<r;i++)e[i]=t[i]+n[i]&255}function $A(t,e,n,r,i){let s=0;if(n.length===0){for(;s<i;s++)e[s]=t[s];for(;s<r;s++)e[s]=t[s]+(e[s-i]>>1)&255}else{for(;s<i;s++)e[s]=t[s]+(n[s]>>1)&255;for(;s<r;s++)e[s]=t[s]+(e[s-i]+n[s]>>1)&255}}function zA(t,e,n,r,i){let s=0;if(n.length===0){for(;s<i;s++)e[s]=t[s];for(;s<r;s++)e[s]=t[s]+e[s-i]&255}else{for(;s<i;s++)e[s]=t[s]+n[s]&255;for(;s<r;s++)e[s]=t[s]+yD(e[s-i],n[s],n[s-i])&255}}function yD(t,e,n){const r=t+e-n,i=Math.abs(r-t),s=Math.abs(r-e),o=Math.abs(r-n);return i<=s&&i<=o?t:s<=o?e:n}function xD(t,e,n,r,i,s){switch(t){case 0:UA(e,n,i);break;case 1:VA(e,n,i,s);break;case 2:BA(e,n,r,i);break;case 3:$A(e,n,r,i,s);break;case 4:zA(e,n,r,i,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const bD=new Uint16Array([255]),wD=new Uint8Array(bD.buffer),ND=wD[0]===255;function _D(t){const{data:e,width:n,height:r,channels:i,depth:s}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*i,c=new Uint8Array(r*n*l);let u=0;for(let f=0;f<7;f++){const v=o[f],g=Math.ceil((n-v.x)/v.xStep),p=Math.ceil((r-v.y)/v.yStep);if(g<=0||p<=0)continue;const S=g*l,k=new Uint8Array(S);for(let C=0;C<p;C++){const b=e[u++],I=e.subarray(u,u+S);u+=S;const R=new Uint8Array(S);xD(b,I,R,k,S,l),k.set(R);for(let D=0;D<g;D++){const ee=v.x+D*v.xStep,oe=v.y+C*v.yStep;if(!(ee>=n||oe>=r))for(let V=0;V<l;V++)c[(oe*n+ee)*l+V]=R[D*l+V]}}}if(s===16){const f=new Uint16Array(c.buffer);if(ND)for(let v=0;v<f.length;v++)f[v]=ED(f[v]);return f}else return c}function ED(t){return(t&255)<<8|t>>8&255}const AD=new Uint16Array([255]),SD=new Uint8Array(AD.buffer),kD=SD[0]===255,TD=new Uint8Array(0);function r5(t){const{data:e,width:n,height:r,channels:i,depth:s}=t,o=Math.ceil(s/8)*i,l=Math.ceil(s/8*i*n),c=new Uint8Array(r*l);let u=TD,f=0,v,g;for(let p=0;p<r;p++){switch(v=e.subarray(f+1,f+1+l),g=c.subarray(p*l,(p+1)*l),e[f]){case 0:UA(v,g,l);break;case 1:VA(v,g,l,o);break;case 2:BA(v,g,u,l);break;case 3:$A(v,g,u,l,o);break;case 4:zA(v,g,u,l,o);break;default:throw new Error(`Unsupported filter: ${e[f]}`)}u=g,f+=l+1}if(s===16){const p=new Uint16Array(c.buffer);if(kD)for(let S=0;S<p.length;S++)p[S]=jD(p[S]);return p}else return c}function jD(t){return(t&255)<<8|t>>8&255}const om=Uint8Array.of(137,80,78,71,13,10,26,10);function i5(t){if(!CD(t.readBytes(om.length)))throw new Error("wrong PNG signature")}function CD(t){if(t.length<om.length)return!1;for(let e=0;e<om.length;e++)if(t[e]!==om[e])return!1;return!0}const ID="tEXt",PD=0,qA=new TextDecoder("latin1");function RD(t){if(DD(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const LD=/^[\u0000-\u00FF]*$/;function DD(t){if(!LD.test(t))throw new Error("invalid latin1 text")}function OD(t,e,n){const r=HA(e);t[r]=MD(e,n-r.length-1)}function HA(t){for(t.mark();t.readByte()!==PD;);const e=t.offset;t.reset();const n=qA.decode(t.readBytes(e-t.offset-1));return t.skip(1),RD(n),n}function MD(t,e){return qA.decode(t.readBytes(e))}const Wi={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},g0={UNKNOWN:-1,DEFLATE:0},s5={UNKNOWN:-1,ADAPTIVE:0},v0={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Lf={NONE:0,BACKGROUND:1,PREVIOUS:2},y0={SOURCE:0,OVER:1};class FD extends Zy{constructor(n,r={}){super(n);dn(this,"_checkCrc");dn(this,"_inflator");dn(this,"_png");dn(this,"_apng");dn(this,"_end");dn(this,"_hasPalette");dn(this,"_palette");dn(this,"_hasTransparency");dn(this,"_transparency");dn(this,"_compressionMethod");dn(this,"_filterMethod");dn(this,"_interlaceMethod");dn(this,"_colorType");dn(this,"_isAnimated");dn(this,"_numberOfFrames");dn(this,"_numberOfPlays");dn(this,"_frames");dn(this,"_writingDataChunks");const{checkCrc:i=!1}=r;this._checkCrc=i,this._inflator=new e5,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=g0.UNKNOWN,this._filterMethod=s5.UNKNOWN,this._interlaceMethod=v0.UNKNOWN,this._colorType=Wi.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(i5(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeChunk(n,r)}return this.decodeImage(),this._png}decodeApng(){for(i5(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(n,r)}return this.decodeApngImage(),this._apng}decodeChunk(n,r){const i=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(n);break;case"IDAT":this.decodeIDAT(n);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(n);break;case"iCCP":this.decodeiCCP(n);break;case ID:OD(this._png.text,this,n);break;case"pHYs":this.decodepHYs();break;default:this.skip(n);break}if(this.offset-i!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?n5(this,n+4,r):this.skip(4)}decodeApngChunk(n,r){const i=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(n);break;default:this.decodeChunk(n,r),this.offset=i+n;break}if(this.offset-i!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?n5(this,n+4,r):this.skip(4)}decodeIHDR(){const n=this._png;n.width=this.readUint32(),n.height=this.readUint32(),n.depth=UD(this.readUint8());const r=this.readUint8();this._colorType=r;let i;switch(r){case Wi.GREYSCALE:i=1;break;case Wi.TRUECOLOUR:i=3;break;case Wi.INDEXED_COLOUR:i=1;break;case Wi.GREYSCALE_ALPHA:i=2;break;case Wi.TRUECOLOUR_ALPHA:i=4;break;case Wi.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==g0.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const n={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(n)}decodePLTE(n){if(n%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${n}`);const r=n/3;this._hasPalette=!0;const i=[];this._palette=i;for(let s=0;s<r;s++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(n){this._writingDataChunks=!0;const r=n,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodeFDAT(n){this._writingDataChunks=!0;let r=n,i=this.offset+this.byteOffset;if(i+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,i,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodetRNS(n){switch(this._colorType){case Wi.GREYSCALE:case Wi.TRUECOLOUR:{if(n%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${n}`);if(n/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${n/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(n/2);for(let r=0;r<n/2;r++)this._transparency[r]=this.readUint16();break}case Wi.INDEXED_COLOUR:{if(n>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${n} vs ${this._palette.length})`);let r=0;for(;r<n;r++){const i=this.readByte();this._palette[r].push(i)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case Wi.UNKNOWN:case Wi.GREYSCALE_ALPHA:case Wi.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(n){const r=HA(this),i=this.readUint8();if(i!==g0.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const s=this.readBytes(n-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:pD(s)}}decodepHYs(){const n=this.readUint32(),r=this.readUint32(),i=this.readByte();this._png.resolution={x:n,y:r,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let n=0;n<this._numberOfFrames;n++){const r={sequenceNumber:this._frames[n].sequenceNumber,delayNumber:this._frames[n].delayNumber,delayDenominator:this._frames[n].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(n);if(i){if(i.data=r5({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),n===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)r.data=i.data;else{const s=this._apng.frames.at(n-1);this.disposeFrame(i,s,r),this.addFrameDataToCanvas(r,i)}this._apng.frames.push(r)}}return this._apng}disposeFrame(n,r,i){switch(n.disposeOp){case Lf.NONE:break;case Lf.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*n.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)i.data[l+c]=0}break;case Lf.PREVIOUS:i.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(n,r){const i=1<<this._png.depth,s=(o,l)=>{const c=((o+r.yOffset)*this._png.width+r.xOffset+l)*this._png.channels,u=(o*r.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(r.blendOp){case y0.SOURCE:for(let o=0;o<r.height;o++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let f=0;f<this._png.channels;f++)n.data[c+f]=r.data[u+f]}break;case y0.OVER:for(let o=0;o<r.height;o++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let f=0;f<this._png.channels;f++){const v=r.data[u+this._png.channels-1]/i,g=f%(this._png.channels-1)===0?1:r.data[u+f],p=Math.floor(v*g+(1-v)*n.data[c+f]);n.data[c+f]+=p}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var r;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const n=this._isAnimated?((r=this._frames)==null?void 0:r.at(0)).data:this._inflator.result;if(this._filterMethod!==s5.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===v0.NO_INTERLACE)this._png.data=r5({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===v0.ADAM7)this._png.data=_D({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const n=this._inflator.result,r=this._frames.at(-1);r?r.data=n:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Lf.NONE,blendOp:y0.SOURCE,data:n}),this._inflator=new e5,this._writingDataChunks=!1}}function UD(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var a5;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(a5||(a5={}));function VD(t,e){return new FD(t,e).decode()}var Et=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function x0(){Et.console&&typeof Et.console.log=="function"&&Et.console.log.apply(Et.console,arguments)}var xn={log:x0,warn:function(t){Et.console&&(typeof Et.console.warn=="function"?Et.console.warn.apply(Et.console,arguments):x0.call(null,arguments))},error:function(t){Et.console&&(typeof Et.console.error=="function"?Et.console.error.apply(Et.console,arguments):x0(t))}};function b0(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){Kl(r.response,e,n)},r.onerror=function(){xn.error("could not download file")},r.send()}function o5(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Df(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Kl=Et.saveAs||((typeof window>"u"?"undefined":hn(window))!=="object"||window!==Et?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var r=Et.URL||Et.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?o5(i.href)?b0(t,e,n):Df(i,i.target="_blank"):Df(i)):(i.href=r.createObjectURL(t),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){Df(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t=="string")if(o5(t))b0(t,e,n);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout(function(){Df(r)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:hn(s)!=="object"&&(xn.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(t,n),e)}:function(t,e,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof t=="string")return b0(t,e,n);var i=t.type==="application/octet-stream",s=/constructor/i.test(Et.HTMLElement)||Et.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&s)&&(typeof FileReader>"u"?"undefined":hn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var f=l.result;f=o?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=f:location=f,r=null},l.readAsDataURL(t)}else{var c=Et.URL||Et.webkitURL,u=c.createObjectURL(t);r?r.location=u:location.href=u,r=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function WA(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],r=0;r<n.length;r++){var i=n[r].re,s=n[r].process,o=i.exec(t);o&&(e=s(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var lm=Et.atob.bind(Et),l5=Et.btoa.bind(Et);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function w0(t,e){var n=t[0],r=t[1],i=t[2],s=t[3];n=Jr(n,r,i,s,e[0],7,-680876936),s=Jr(s,n,r,i,e[1],12,-389564586),i=Jr(i,s,n,r,e[2],17,606105819),r=Jr(r,i,s,n,e[3],22,-1044525330),n=Jr(n,r,i,s,e[4],7,-176418897),s=Jr(s,n,r,i,e[5],12,1200080426),i=Jr(i,s,n,r,e[6],17,-1473231341),r=Jr(r,i,s,n,e[7],22,-45705983),n=Jr(n,r,i,s,e[8],7,1770035416),s=Jr(s,n,r,i,e[9],12,-1958414417),i=Jr(i,s,n,r,e[10],17,-42063),r=Jr(r,i,s,n,e[11],22,-1990404162),n=Jr(n,r,i,s,e[12],7,1804603682),s=Jr(s,n,r,i,e[13],12,-40341101),i=Jr(i,s,n,r,e[14],17,-1502002290),n=Zr(n,r=Jr(r,i,s,n,e[15],22,1236535329),i,s,e[1],5,-165796510),s=Zr(s,n,r,i,e[6],9,-1069501632),i=Zr(i,s,n,r,e[11],14,643717713),r=Zr(r,i,s,n,e[0],20,-373897302),n=Zr(n,r,i,s,e[5],5,-701558691),s=Zr(s,n,r,i,e[10],9,38016083),i=Zr(i,s,n,r,e[15],14,-660478335),r=Zr(r,i,s,n,e[4],20,-405537848),n=Zr(n,r,i,s,e[9],5,568446438),s=Zr(s,n,r,i,e[14],9,-1019803690),i=Zr(i,s,n,r,e[3],14,-187363961),r=Zr(r,i,s,n,e[8],20,1163531501),n=Zr(n,r,i,s,e[13],5,-1444681467),s=Zr(s,n,r,i,e[2],9,-51403784),i=Zr(i,s,n,r,e[7],14,1735328473),n=ei(n,r=Zr(r,i,s,n,e[12],20,-1926607734),i,s,e[5],4,-378558),s=ei(s,n,r,i,e[8],11,-2022574463),i=ei(i,s,n,r,e[11],16,1839030562),r=ei(r,i,s,n,e[14],23,-35309556),n=ei(n,r,i,s,e[1],4,-1530992060),s=ei(s,n,r,i,e[4],11,1272893353),i=ei(i,s,n,r,e[7],16,-155497632),r=ei(r,i,s,n,e[10],23,-1094730640),n=ei(n,r,i,s,e[13],4,681279174),s=ei(s,n,r,i,e[0],11,-358537222),i=ei(i,s,n,r,e[3],16,-722521979),r=ei(r,i,s,n,e[6],23,76029189),n=ei(n,r,i,s,e[9],4,-640364487),s=ei(s,n,r,i,e[12],11,-421815835),i=ei(i,s,n,r,e[15],16,530742520),n=ti(n,r=ei(r,i,s,n,e[2],23,-995338651),i,s,e[0],6,-198630844),s=ti(s,n,r,i,e[7],10,1126891415),i=ti(i,s,n,r,e[14],15,-1416354905),r=ti(r,i,s,n,e[5],21,-57434055),n=ti(n,r,i,s,e[12],6,1700485571),s=ti(s,n,r,i,e[3],10,-1894986606),i=ti(i,s,n,r,e[10],15,-1051523),r=ti(r,i,s,n,e[1],21,-2054922799),n=ti(n,r,i,s,e[8],6,1873313359),s=ti(s,n,r,i,e[15],10,-30611744),i=ti(i,s,n,r,e[6],15,-1560198380),r=ti(r,i,s,n,e[13],21,1309151649),n=ti(n,r,i,s,e[4],6,-145523070),s=ti(s,n,r,i,e[11],10,-1120210379),i=ti(i,s,n,r,e[2],15,718787259),r=ti(r,i,s,n,e[9],21,-343485551),t[0]=Zo(n,t[0]),t[1]=Zo(r,t[1]),t[2]=Zo(i,t[2]),t[3]=Zo(s,t[3])}function ng(t,e,n,r,i,s){return e=Zo(Zo(e,t),Zo(r,s)),Zo(e<<i|e>>>32-i,n)}function Jr(t,e,n,r,i,s,o){return ng(e&n|~e&r,t,e,i,s,o)}function Zr(t,e,n,r,i,s,o){return ng(e&r|n&~r,t,e,i,s,o)}function ei(t,e,n,r,i,s,o){return ng(e^n^r,t,e,i,s,o)}function ti(t,e,n,r,i,s,o){return ng(n^(e|~r),t,e,i,s,o)}function GA(t){var e,n=t.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)w0(r,BD(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(w0(r,i),e=0;e<16;e++)i[e]=0;return i[14]=8*n,w0(r,i),r}function BD(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}var c5="0123456789abcdef".split("");function $D(t){for(var e="",n=0;n<4;n++)e+=c5[t>>8*n+4&15]+c5[t>>8*n&15];return e}function zD(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Xv(t){return GA(t).map(zD).join("")}var qD=function(t){for(var e=0;e<t.length;e++)t[e]=$D(t[e]);return t.join("")}(GA("hello"))!="5d41402abc4b2a76b9719d911017c592";function Zo(t,e){if(qD){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Jv(t,e){var n,r,i,s;if(t!==n){for(var o=(i=t,s=1+(256/t.length|0),new Array(s+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var f=l[c];u=(u+f+o.charCodeAt(c))%256,l[c]=l[u],l[u]=f}n=t,r=l}else l=r;var v=e.length,g=0,p=0,S="";for(c=0;c<v;c++)p=(p+(f=l[g=(g+1)%256]))%256,l[g]=l[p],l[p]=f,o=l[(l[g]+l[p])%256],S+=String.fromCharCode(e.charCodeAt(c)^o);return S}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var u5={print:4,modify:8,copy:16,"annot-forms":32};function Fc(t,e,n,r){this.v=1,this.r=2;var i=192;t.forEach(function(l){if(u5.perm!==void 0)throw new Error("Invalid permission: "+l);i+=u5[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),o=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^i)),this.encryptionKey=Xv(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Jv(this.encryptionKey,this.padding)}function Uc(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,r=0;r<n;r++){var i=t.charCodeAt(r);e+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):t[r]}return e}function d5(t){if(hn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(n,r,i){if(i=i||!1,typeof n!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(n)||(e[n]={});var s=Math.random().toString(35);return e[n][s]=[r,!!i],s},this.unsubscribe=function(n){for(var r in e)if(e[r][n])return delete e[r][n],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var s in e[n]){var o=e[n][s];try{o[0].apply(t,r)}catch(l){Et.console&&xn.error("jsPDF PubSub Error",l.message,l)}o[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function dp(t){if(!(this instanceof dp))return new dp(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function KA(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Ql(t,e,n,r,i){if(!(this instanceof Ql))return new Ql(t,e,n,r,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=n,KA.call(this,r,i)}function Zc(t,e,n,r,i){if(!(this instanceof Zc))return new Zc(t,e,n,r,i);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,KA.call(this,r,i)}function ot(t){var e,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],s=arguments[3],o=[],l=1,c=16,u="S",f=null;hn(t=t||{})==="object"&&(n=t.orientation,r=t.unit||r,i=t.format||i,s=t.compress||t.compressPdf||s,(f=t.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),o=t.filters||(s===!0?["FlateEncode"]:o),r=r||"mm",n=(""+(n||"P")).toLowerCase();var v=t.putOnlyUsedFonts||!1,g={},p={internal:{},__private__:{}};p.__private__.PubSub=d5;var S="1.3",k=p.__private__.getPdfVersion=function(){return S};p.__private__.setPdfVersion=function(y){S=y};var C={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return C};var b=p.__private__.getPageFormat=function(y){return C[y]};i=i||"a4";var I="compat",R="advanced",D=I;function ee(){this.saveGraphicsState(),re(new pt(yt,0,0,-yt,0,as()*yt).toString()+" cm"),this.setFontSize(this.getFontSize()/yt),u="n",D=R}function oe(){this.restoreGraphicsState(),u="S",D=I}var V=p.__private__.combineFontStyleAndFontWeight=function(y,$){if(y=="bold"&&$=="normal"||y=="bold"&&$==400||y=="normal"&&$=="italic"||y=="bold"&&$=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return $&&(y=$==400||$==="normal"?y==="italic"?"italic":"normal":$!=700&&$!=="bold"||y!=="normal"?($==700?"bold":$)+""+y:"bold"),y};p.advancedAPI=function(y){var $=D===I;return $&&ee.call(this),typeof y!="function"||(y(this),$&&oe.call(this)),this},p.compatAPI=function(y){var $=D===R;return $&&oe.call(this),typeof y!="function"||(y(this),$&&ee.call(this)),this},p.isAdvancedAPI=function(){return D===R};var T,N=function(y){if(D!==R)throw new Error(y+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},U=p.roundToPrecision=p.__private__.roundToPrecision=function(y,$){var ie=e||$;if(isNaN(y)||isNaN(ie))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return y.toFixed(ie).replace(/0+$/,"")};T=p.hpf=p.__private__.hpf=typeof c=="number"?function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return U(y,c)}:c==="smart"?function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return U(y,y>-1&&y<1?16:5)}:function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return U(y,16)};var E=p.f2=p.__private__.f2=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.f2");return U(y,2)},L=p.__private__.f3=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.f3");return U(y,3)},_=p.scale=p.__private__.scale=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.scale");return D===I?y*yt:D===R?y:void 0},M=function(y){return _(function($){return D===I?as()-$:D===R?$:void 0}(y))};p.__private__.setPrecision=p.setPrecision=function(y){typeof parseInt(y,10)=="number"&&(e=parseInt(y,10))};var K,F="00000000000000000000000000000000",X=p.__private__.getFileId=function(){return F},H=p.__private__.setFileId=function(y){return F=y!==void 0&&/^[a-fA-F0-9]{32}$/.test(y)?y.toUpperCase():F.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(on=new Fc(f.userPermissions,f.userPassword,f.ownerPassword,F)),F};p.setFileId=function(y){return H(y),this},p.getFileId=function(){return X()};var W=p.__private__.convertDateToPDFDate=function(y){var $=y.getTimezoneOffset(),ie=$<0?"+":"-",de=Math.floor(Math.abs($/60)),ge=Math.abs($%60),ke=[ie,q(de),"'",q(ge),"'"].join("");return["D:",y.getFullYear(),q(y.getMonth()+1),q(y.getDate()),q(y.getHours()),q(y.getMinutes()),q(y.getSeconds()),ke].join("")},Y=p.__private__.convertPDFDateToDate=function(y){var $=parseInt(y.substr(2,4),10),ie=parseInt(y.substr(6,2),10)-1,de=parseInt(y.substr(8,2),10),ge=parseInt(y.substr(10,2),10),ke=parseInt(y.substr(12,2),10),Ie=parseInt(y.substr(14,2),10);return new Date($,ie,de,ge,ke,Ie,0)},B=p.__private__.setCreationDate=function(y){var $;if(y===void 0&&(y=new Date),y instanceof Date)$=W(y);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(y))throw new Error("Invalid argument passed to jsPDF.setCreationDate");$=y}return K=$},A=p.__private__.getCreationDate=function(y){var $=K;return y==="jsDate"&&($=Y(K)),$};p.setCreationDate=function(y){return B(y),this},p.getCreationDate=function(y){return A(y)};var P,q=p.__private__.padd2=function(y){return("0"+parseInt(y)).slice(-2)},te=p.__private__.padd2Hex=function(y){return("00"+(y=y.toString())).substr(y.length)},le=0,ce=[],me=[],he=0,we=[],Ee=[],Le=!1,Re=me;p.__private__.setCustomOutputDestination=function(y){Le=!0,Re=y};var xe=function(y){Le||(Re=y)};p.__private__.resetCustomOutputDestination=function(){Le=!1,Re=me};var re=p.__private__.out=function(y){return y=y.toString(),he+=y.length+1,Re.push(y),Re},qe=p.__private__.write=function(y){return re(arguments.length===1?y.toString():Array.prototype.join.call(arguments," "))},dt=p.__private__.getArrayBuffer=function(y){for(var $=y.length,ie=new ArrayBuffer($),de=new Uint8Array(ie);$--;)de[$]=y.charCodeAt($);return ie},lt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return lt};var Oe=t.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(y){return Oe=D===R?y/yt:y,this};var Qe,Se=p.__private__.getFontSize=p.getFontSize=function(){return D===I?Oe:Oe*yt},$e=t.R2L||!1;p.__private__.setR2L=p.setR2L=function(y){return $e=y,this},p.__private__.getR2L=p.getR2L=function(){return $e};var it,zt=p.__private__.setZoomMode=function(y){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(y))Qe=y;else if(isNaN(y)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(y)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+y+'" is not recognized.');Qe=y}else Qe=parseInt(y,10)};p.__private__.getZoomMode=function(){return Qe};var At,nt=p.__private__.setPageMode=function(y){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(y)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+y+'" is not recognized.');it=y};p.__private__.getPageMode=function(){return it};var Tt=p.__private__.setLayoutMode=function(y){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(y)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+y+'" is not recognized.');At=y};p.__private__.getLayoutMode=function(){return At},p.__private__.setDisplayMode=p.setDisplayMode=function(y,$,ie){return zt(y),Tt($),nt(ie),this};var wt={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(y){if(Object.keys(wt).indexOf(y)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return wt[y]},p.__private__.getDocumentProperties=function(){return wt},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(y){for(var $ in wt)wt.hasOwnProperty($)&&y[$]&&(wt[$]=y[$]);return this},p.__private__.setDocumentProperty=function(y,$){if(Object.keys(wt).indexOf(y)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return wt[y]=$};var st,yt,ct,en,Kt,Ze={},Nt={},an=[],gt={},Dt={},St={},Rn={},Sn=null,nn=0,xt=[],Mt=new d5(p),Ws=t.hotfixes||[],Jn={},ns={},qr=[],pt=function y($,ie,de,ge,ke,Ie){if(!(this instanceof y))return new y($,ie,de,ge,ke,Ie);isNaN($)&&($=1),isNaN(ie)&&(ie=0),isNaN(de)&&(de=0),isNaN(ge)&&(ge=1),isNaN(ke)&&(ke=0),isNaN(Ie)&&(Ie=0),this._matrix=[$,ie,de,ge,ke,Ie]};Object.defineProperty(pt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(y){this._matrix[0]=y}}),Object.defineProperty(pt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(y){this._matrix[1]=y}}),Object.defineProperty(pt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(y){this._matrix[2]=y}}),Object.defineProperty(pt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(y){this._matrix[3]=y}}),Object.defineProperty(pt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(y){this._matrix[4]=y}}),Object.defineProperty(pt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(y){this._matrix[5]=y}}),Object.defineProperty(pt.prototype,"a",{get:function(){return this._matrix[0]},set:function(y){this._matrix[0]=y}}),Object.defineProperty(pt.prototype,"b",{get:function(){return this._matrix[1]},set:function(y){this._matrix[1]=y}}),Object.defineProperty(pt.prototype,"c",{get:function(){return this._matrix[2]},set:function(y){this._matrix[2]=y}}),Object.defineProperty(pt.prototype,"d",{get:function(){return this._matrix[3]},set:function(y){this._matrix[3]=y}}),Object.defineProperty(pt.prototype,"e",{get:function(){return this._matrix[4]},set:function(y){this._matrix[4]=y}}),Object.defineProperty(pt.prototype,"f",{get:function(){return this._matrix[5]},set:function(y){this._matrix[5]=y}}),Object.defineProperty(pt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(pt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(pt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(pt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),pt.prototype.join=function(y){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(T).join(y)},pt.prototype.multiply=function(y){var $=y.sx*this.sx+y.shy*this.shx,ie=y.sx*this.shy+y.shy*this.sy,de=y.shx*this.sx+y.sy*this.shx,ge=y.shx*this.shy+y.sy*this.sy,ke=y.tx*this.sx+y.ty*this.shx+this.tx,Ie=y.tx*this.shy+y.ty*this.sy+this.ty;return new pt($,ie,de,ge,ke,Ie)},pt.prototype.decompose=function(){var y=this.sx,$=this.shy,ie=this.shx,de=this.sy,ge=this.tx,ke=this.ty,Ie=Math.sqrt(y*y+$*$),We=(y/=Ie)*ie+($/=Ie)*de;ie-=y*We,de-=$*We;var Xe=Math.sqrt(ie*ie+de*de);return We/=Xe,y*(de/=Xe)<$*(ie/=Xe)&&(y=-y,$=-$,We=-We,Ie=-Ie),{scale:new pt(Ie,0,0,Xe,0,0),translate:new pt(1,0,0,1,ge,ke),rotate:new pt(y,$,-$,y,0,0),skew:new pt(1,0,We,1,0,0)}},pt.prototype.toString=function(y){return this.join(" ")},pt.prototype.inversed=function(){var y=this.sx,$=this.shy,ie=this.shx,de=this.sy,ge=this.tx,ke=this.ty,Ie=1/(y*de-$*ie),We=de*Ie,Xe=-$*Ie,vt=-ie*Ie,_t=y*Ie;return new pt(We,Xe,vt,_t,-We*ge-vt*ke,-Xe*ge-_t*ke)},pt.prototype.applyToPoint=function(y){var $=y.x*this.sx+y.y*this.shx+this.tx,ie=y.x*this.shy+y.y*this.sy+this.ty;return new na($,ie)},pt.prototype.applyToRectangle=function(y){var $=this.applyToPoint(y),ie=this.applyToPoint(new na(y.x+y.w,y.y+y.h));return new _o($.x,$.y,ie.x-$.x,ie.y-$.y)},pt.prototype.clone=function(){var y=this.sx,$=this.shy,ie=this.shx,de=this.sy,ge=this.tx,ke=this.ty;return new pt(y,$,ie,de,ge,ke)},p.Matrix=pt;var kn=p.matrixMult=function(y,$){return $.multiply(y)},rs=new pt(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=rs;var Er=function(y,$){if(!Dt[y]){var ie=($ instanceof Ql?"Sh":"P")+(Object.keys(gt).length+1).toString(10);$.id=ie,Dt[y]=ie,gt[ie]=$,Mt.publish("addPattern",$)}};p.ShadingPattern=Ql,p.TilingPattern=Zc,p.addShadingPattern=function(y,$){return N("addShadingPattern()"),Er(y,$),this},p.beginTilingPattern=function(y){N("beginTilingPattern()"),ra(y.boundingBox[0],y.boundingBox[1],y.boundingBox[2]-y.boundingBox[0],y.boundingBox[3]-y.boundingBox[1],y.matrix)},p.endTilingPattern=function(y,$){N("endTilingPattern()"),$.stream=Ee[P].join(`
`),Er(y,$),Mt.publish("endTilingPattern",$),qr.pop().restore()};var Ar,Ln=p.__private__.newObject=function(){var y=ur();return Dn(y,!0),y},ur=p.__private__.newObjectDeferred=function(){return le++,ce[le]=function(){return he},le},Dn=function(y,$){return $=typeof $=="boolean"&&$,ce[y]=he,$&&re(y+" 0 obj"),y},ja=p.__private__.newAdditionalObject=function(){var y={objId:ur(),content:""};return we.push(y),y},Gs=ur(),Hr=ur(),Pi=p.__private__.decodeColorString=function(y){var $=y.split(" ");if($.length!==2||$[1]!=="g"&&$[1]!=="G")$.length!==5||$[4]!=="k"&&$[4]!=="K"||($=[(1-$[0])*(1-$[3]),(1-$[1])*(1-$[3]),(1-$[2])*(1-$[3]),"r"]);else{var ie=parseFloat($[0]);$=[ie,ie,ie,"r"]}for(var de="#",ge=0;ge<3;ge++)de+=("0"+Math.floor(255*parseFloat($[ge])).toString(16)).slice(-2);return de},li=p.__private__.encodeColorString=function(y){var $;typeof y=="string"&&(y={ch1:y});var ie=y.ch1,de=y.ch2,ge=y.ch3,ke=y.ch4,Ie=y.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ie=="string"&&ie.charAt(0)!=="#"){var We=new WA(ie);if(We.ok)ie=We.toHex();else if(!/^\d*\.?\d*$/.test(ie))throw new Error('Invalid color "'+ie+'" passed to jsPDF.encodeColorString.')}if(typeof ie=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ie)&&(ie="#"+ie[1]+ie[1]+ie[2]+ie[2]+ie[3]+ie[3]),typeof ie=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ie)){var Xe=parseInt(ie.substr(1),16);ie=Xe>>16&255,de=Xe>>8&255,ge=255&Xe}if(de===void 0||ke===void 0&&ie===de&&de===ge)$=typeof ie=="string"?ie+" "+Ie[0]:y.precision===2?E(ie/255)+" "+Ie[0]:L(ie/255)+" "+Ie[0];else if(ke===void 0||hn(ke)==="object"){if(ke&&!isNaN(ke.a)&&ke.a===0)return["1.","1.","1.",Ie[1]].join(" ");$=typeof ie=="string"?[ie,de,ge,Ie[1]].join(" "):y.precision===2?[E(ie/255),E(de/255),E(ge/255),Ie[1]].join(" "):[L(ie/255),L(de/255),L(ge/255),Ie[1]].join(" ")}else $=typeof ie=="string"?[ie,de,ge,ke,Ie[2]].join(" "):y.precision===2?[E(ie),E(de),E(ge),E(ke),Ie[2]].join(" "):[L(ie),L(de),L(ge),L(ke),Ie[2]].join(" ");return $},Wr=p.__private__.getFilters=function(){return o},Zn=p.__private__.putStream=function(y){var $=(y=y||{}).data||"",ie=y.filters||Wr(),de=y.alreadyAppliedFilters||[],ge=y.addLength1||!1,ke=$.length,Ie=y.objectId,We=function(Wn){return Wn};if(f!==null&&Ie===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(We=on.encryptor(Ie,0));var Xe={};ie===!0&&(ie=["FlateEncode"]);var vt=y.additionalKeyValues||[],_t=(Xe=ot.API.processDataByFilters!==void 0?ot.API.processDataByFilters($,ie):{data:$,reverseChain:[]}).reverseChain+(Array.isArray(de)?de.join(" "):de.toString());if(Xe.data.length!==0&&(vt.push({key:"Length",value:Xe.data.length}),ge===!0&&vt.push({key:"Length1",value:ke})),_t.length!=0)if(_t.split("/").length-1==1)vt.push({key:"Filter",value:_t});else{vt.push({key:"Filter",value:"["+_t+"]"});for(var Yt=0;Yt<vt.length;Yt+=1)if(vt[Yt].key==="DecodeParms"){for(var rn=[],Un=0;Un<Xe.reverseChain.split("/").length-1;Un+=1)rn.push("null");rn.push(vt[Yt].value),vt[Yt].value="["+rn.join(" ")+"]"}}re("<<");for(var ln=0;ln<vt.length;ln++)re("/"+vt[ln].key+" "+vt[ln].value);re(">>"),Xe.data.length!==0&&(re("stream"),re(We(Xe.data)),re("endstream"))},Ks=p.__private__.putPage=function(y){var $=y.number,ie=y.data,de=y.objId,ge=y.contentsObjId;Dn(de,!0),re("<</Type /Page"),re("/Parent "+y.rootDictionaryObjId+" 0 R"),re("/Resources "+y.resourceDictionaryObjId+" 0 R"),re("/MediaBox ["+parseFloat(T(y.mediaBox.bottomLeftX))+" "+parseFloat(T(y.mediaBox.bottomLeftY))+" "+T(y.mediaBox.topRightX)+" "+T(y.mediaBox.topRightY)+"]"),y.cropBox!==null&&re("/CropBox ["+T(y.cropBox.bottomLeftX)+" "+T(y.cropBox.bottomLeftY)+" "+T(y.cropBox.topRightX)+" "+T(y.cropBox.topRightY)+"]"),y.bleedBox!==null&&re("/BleedBox ["+T(y.bleedBox.bottomLeftX)+" "+T(y.bleedBox.bottomLeftY)+" "+T(y.bleedBox.topRightX)+" "+T(y.bleedBox.topRightY)+"]"),y.trimBox!==null&&re("/TrimBox ["+T(y.trimBox.bottomLeftX)+" "+T(y.trimBox.bottomLeftY)+" "+T(y.trimBox.topRightX)+" "+T(y.trimBox.topRightY)+"]"),y.artBox!==null&&re("/ArtBox ["+T(y.artBox.bottomLeftX)+" "+T(y.artBox.bottomLeftY)+" "+T(y.artBox.topRightX)+" "+T(y.artBox.topRightY)+"]"),typeof y.userUnit=="number"&&y.userUnit!==1&&re("/UserUnit "+y.userUnit),Mt.publish("putPage",{objId:de,pageContext:xt[$],pageNumber:$,page:ie}),re("/Contents "+ge+" 0 R"),re(">>"),re("endobj");var ke=ie.join(`
`);return D===R&&(ke+=`
Q`),Dn(ge,!0),Zn({data:ke,filters:Wr(),objectId:ge}),re("endobj"),de},Ri=p.__private__.putPages=function(){var y,$,ie=[];for(y=1;y<=nn;y++)xt[y].objId=ur(),xt[y].contentsObjId=ur();for(y=1;y<=nn;y++)ie.push(Ks({number:y,data:Ee[y],objId:xt[y].objId,contentsObjId:xt[y].contentsObjId,mediaBox:xt[y].mediaBox,cropBox:xt[y].cropBox,bleedBox:xt[y].bleedBox,trimBox:xt[y].trimBox,artBox:xt[y].artBox,userUnit:xt[y].userUnit,rootDictionaryObjId:Gs,resourceDictionaryObjId:Hr}));Dn(Gs,!0),re("<</Type /Pages");var de="/Kids [";for($=0;$<nn;$++)de+=ie[$]+" 0 R ";re(de+"]"),re("/Count "+nn),re(">>"),re("endobj"),Mt.publish("postPutPages")},_s=function(y){Mt.publish("putFont",{font:y,out:re,newObject:Ln,putStream:Zn}),y.isAlreadyPutted!==!0&&(y.objectNumber=Ln(),re("<<"),re("/Type /Font"),re("/BaseFont /"+Uc(y.postScriptName)),re("/Subtype /Type1"),typeof y.encoding=="string"&&re("/Encoding /"+y.encoding),re("/FirstChar 32"),re("/LastChar 255"),re(">>"),re("endobj"))},Ys=function(y){y.objectNumber=Ln();var $=[];$.push({key:"Type",value:"/XObject"}),$.push({key:"Subtype",value:"/Form"}),$.push({key:"BBox",value:"["+[T(y.x),T(y.y),T(y.x+y.width),T(y.y+y.height)].join(" ")+"]"}),$.push({key:"Matrix",value:"["+y.matrix.toString()+"]"});var ie=y.pages[1].join(`
`);Zn({data:ie,additionalKeyValues:$,objectId:y.objectNumber}),re("endobj")},Ca=function(y,$){$||($=21);var ie=Ln(),de=function(Ie,We){var Xe,vt=[],_t=1/(We-1);for(Xe=0;Xe<1;Xe+=_t)vt.push(Xe);if(vt.push(1),Ie[0].offset!=0){var Yt={offset:0,color:Ie[0].color};Ie.unshift(Yt)}if(Ie[Ie.length-1].offset!=1){var rn={offset:1,color:Ie[Ie.length-1].color};Ie.push(rn)}for(var Un="",ln=0,Wn=0;Wn<vt.length;Wn++){for(Xe=vt[Wn];Xe>Ie[ln+1].offset;)ln++;var Vn=Ie[ln].offset,Gn=(Xe-Vn)/(Ie[ln+1].offset-Vn),wn=Ie[ln].color,Pr=Ie[ln+1].color;Un+=te(Math.round((1-Gn)*wn[0]+Gn*Pr[0]).toString(16))+te(Math.round((1-Gn)*wn[1]+Gn*Pr[1]).toString(16))+te(Math.round((1-Gn)*wn[2]+Gn*Pr[2]).toString(16))}return Un.trim()}(y.colors,$),ge=[];ge.push({key:"FunctionType",value:"0"}),ge.push({key:"Domain",value:"[0.0 1.0]"}),ge.push({key:"Size",value:"["+$+"]"}),ge.push({key:"BitsPerSample",value:"8"}),ge.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ge.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Zn({data:de,additionalKeyValues:ge,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ie}),re("endobj"),y.objectNumber=Ln(),re("<< /ShadingType "+y.type),re("/ColorSpace /DeviceRGB");var ke="/Coords ["+T(parseFloat(y.coords[0]))+" "+T(parseFloat(y.coords[1]))+" ";y.type===2?ke+=T(parseFloat(y.coords[2]))+" "+T(parseFloat(y.coords[3])):ke+=T(parseFloat(y.coords[2]))+" "+T(parseFloat(y.coords[3]))+" "+T(parseFloat(y.coords[4]))+" "+T(parseFloat(y.coords[5])),re(ke+="]"),y.matrix&&re("/Matrix ["+y.matrix.toString()+"]"),re("/Function "+ie+" 0 R"),re("/Extend [true true]"),re(">>"),re("endobj")},Ia=function(y,$){var ie=ur(),de=Ln();$.push({resourcesOid:ie,objectOid:de}),y.objectNumber=de;var ge=[];ge.push({key:"Type",value:"/Pattern"}),ge.push({key:"PatternType",value:"1"}),ge.push({key:"PaintType",value:"1"}),ge.push({key:"TilingType",value:"1"}),ge.push({key:"BBox",value:"["+y.boundingBox.map(T).join(" ")+"]"}),ge.push({key:"XStep",value:T(y.xStep)}),ge.push({key:"YStep",value:T(y.yStep)}),ge.push({key:"Resources",value:ie+" 0 R"}),y.matrix&&ge.push({key:"Matrix",value:"["+y.matrix.toString()+"]"}),Zn({data:y.stream,additionalKeyValues:ge,objectId:y.objectNumber}),re("endobj")},Bu=function(y){for(var $ in y.objectNumber=Ln(),re("<<"),y)switch($){case"opacity":re("/ca "+E(y[$]));break;case"stroke-opacity":re("/CA "+E(y[$]))}re(">>"),re("endobj")},Qs=function(y){Dn(y.resourcesOid,!0),re("<<"),re("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var $ in re("/Font <<"),Ze)Ze.hasOwnProperty($)&&(v===!1||v===!0&&g.hasOwnProperty($))&&re("/"+$+" "+Ze[$].objectNumber+" 0 R");re(">>")}(),function(){if(Object.keys(gt).length>0){for(var $ in re("/Shading <<"),gt)gt.hasOwnProperty($)&&gt[$]instanceof Ql&&gt[$].objectNumber>=0&&re("/"+$+" "+gt[$].objectNumber+" 0 R");Mt.publish("putShadingPatternDict"),re(">>")}}(),function($){if(Object.keys(gt).length>0){for(var ie in re("/Pattern <<"),gt)gt.hasOwnProperty(ie)&&gt[ie]instanceof p.TilingPattern&&gt[ie].objectNumber>=0&&gt[ie].objectNumber<$&&re("/"+ie+" "+gt[ie].objectNumber+" 0 R");Mt.publish("putTilingPatternDict"),re(">>")}}(y.objectOid),function(){if(Object.keys(St).length>0){var $;for($ in re("/ExtGState <<"),St)St.hasOwnProperty($)&&St[$].objectNumber>=0&&re("/"+$+" "+St[$].objectNumber+" 0 R");Mt.publish("putGStateDict"),re(">>")}}(),function(){for(var $ in re("/XObject <<"),Jn)Jn.hasOwnProperty($)&&Jn[$].objectNumber>=0&&re("/"+$+" "+Jn[$].objectNumber+" 0 R");Mt.publish("putXobjectDict"),re(">>")}(),re(">>"),re("endobj")},Al=function(y){Nt[y.fontName]=Nt[y.fontName]||{},Nt[y.fontName][y.fontStyle]=y.id},go=function(y,$,ie,de,ge){var ke={id:"F"+(Object.keys(Ze).length+1).toString(10),postScriptName:y,fontName:$,fontStyle:ie,encoding:de,isStandardFont:ge||!1,metadata:{}};return Mt.publish("addFont",{font:ke,instance:this}),Ze[ke.id]=ke,Al(ke),ke.id},Sr=p.__private__.pdfEscape=p.pdfEscape=function(y,$){return function(ie,de){var ge,ke,Ie,We,Xe,vt,_t,Yt,rn;if(Ie=(de=de||{}).sourceEncoding||"Unicode",Xe=de.outputEncoding,(de.autoencode||Xe)&&Ze[st].metadata&&Ze[st].metadata[Ie]&&Ze[st].metadata[Ie].encoding&&(We=Ze[st].metadata[Ie].encoding,!Xe&&Ze[st].encoding&&(Xe=Ze[st].encoding),!Xe&&We.codePages&&(Xe=We.codePages[0]),typeof Xe=="string"&&(Xe=We[Xe]),Xe)){for(_t=!1,vt=[],ge=0,ke=ie.length;ge<ke;ge++)(Yt=Xe[ie.charCodeAt(ge)])?vt.push(String.fromCharCode(Yt)):vt.push(ie[ge]),vt[ge].charCodeAt(0)>>8&&(_t=!0);ie=vt.join("")}for(ge=ie.length;_t===void 0&&ge!==0;)ie.charCodeAt(ge-1)>>8&&(_t=!0),ge--;if(!_t)return ie;for(vt=de.noBOM?[]:[254,255],ge=0,ke=ie.length;ge<ke;ge++){if((rn=(Yt=ie.charCodeAt(ge))>>8)>>8)throw new Error("Character at position "+ge+" of string '"+ie+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");vt.push(rn),vt.push(Yt-(rn<<8))}return String.fromCharCode.apply(void 0,vt)}(y,$).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Li=p.__private__.beginPage=function(y){Ee[++nn]=[],xt[nn]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(y[0]),topRightY:Number(y[1])}},kl(nn),xe(Ee[P])},vo=function(y,$){var ie,de,ge;switch(n=$||n,typeof y=="string"&&(ie=b(y.toLowerCase()),Array.isArray(ie)&&(de=ie[0],ge=ie[1])),Array.isArray(y)&&(de=y[0]*yt,ge=y[1]*yt),isNaN(de)&&(de=i[0],ge=i[1]),(de>14400||ge>14400)&&(xn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),de=Math.min(14400,de),ge=Math.min(14400,ge)),i=[de,ge],n.substr(0,1)){case"l":ge>de&&(i=[ge,de]);break;case"p":de>ge&&(i=[ge,de])}Li(i),ta(bo),re(Ss),gn!==0&&re(gn+" J"),Dl!==0&&re(Dl+" j"),Mt.publish("addPage",{pageNumber:nn})},Sl=function(y){y>0&&y<=nn&&(Ee.splice(y,1),xt.splice(y,1),nn--,P>nn&&(P=nn),this.setPage(P))},kl=function(y){y>0&&y<=nn&&(P=y)},Tl=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return Ee.length-1},jl=function(y,$,ie){var de,ge=void 0;return ie=ie||{},y=y!==void 0?y:Ze[st].fontName,$=$!==void 0?$:Ze[st].fontStyle,de=y.toLowerCase(),Nt[de]!==void 0&&Nt[de][$]!==void 0?ge=Nt[de][$]:Nt[y]!==void 0&&Nt[y][$]!==void 0?ge=Nt[y][$]:ie.disableWarning===!1&&xn.warn("Unable to look up font label for font '"+y+"', '"+$+"'. Refer to getFontList() for available fonts."),ge||ie.noFallback||(ge=Nt.times[$])==null&&(ge=Nt.times.normal),ge},Xs=p.__private__.putInfo=function(){var y=Ln(),$=function(de){return de};for(var ie in f!==null&&($=on.encryptor(y,0)),re("<<"),re("/Producer ("+Sr($("jsPDF "+ot.version))+")"),wt)wt.hasOwnProperty(ie)&&wt[ie]&&re("/"+ie.substr(0,1).toUpperCase()+ie.substr(1)+" ("+Sr($(wt[ie]))+")");re("/CreationDate ("+Sr($(K))+")"),re(">>"),re("endobj")},Cl=p.__private__.putCatalog=function(y){var $=(y=y||{}).rootDictionaryObjId||Gs;switch(Ln(),re("<<"),re("/Type /Catalog"),re("/Pages "+$+" 0 R"),Qe||(Qe="fullwidth"),Qe){case"fullwidth":re("/OpenAction [3 0 R /FitH null]");break;case"fullheight":re("/OpenAction [3 0 R /FitV null]");break;case"fullpage":re("/OpenAction [3 0 R /Fit]");break;case"original":re("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ie=""+Qe;ie.substr(ie.length-1)==="%"&&(Qe=parseInt(Qe)/100),typeof Qe=="number"&&re("/OpenAction [3 0 R /XYZ null null "+E(Qe)+"]")}switch(At||(At="continuous"),At){case"continuous":re("/PageLayout /OneColumn");break;case"single":re("/PageLayout /SinglePage");break;case"two":case"twoleft":re("/PageLayout /TwoColumnLeft");break;case"tworight":re("/PageLayout /TwoColumnRight")}it&&re("/PageMode /"+it),Mt.publish("putCatalog"),re(">>"),re("endobj")},Fn=p.__private__.putTrailer=function(){re("trailer"),re("<<"),re("/Size "+(le+1)),re("/Root "+le+" 0 R"),re("/Info "+(le-1)+" 0 R"),f!==null&&re("/Encrypt "+on.oid+" 0 R"),re("/ID [ <"+F+"> <"+F+"> ]"),re(">>")},Il=p.__private__.putHeader=function(){re("%PDF-"+S),re("%")},Ac=p.__private__.putXRef=function(){var y="0000000000";re("xref"),re("0 "+(le+1)),re("0000000000 65535 f ");for(var $=1;$<=le;$++)typeof ce[$]=="function"?re((y+ce[$]()).slice(-10)+" 00000 n "):ce[$]!==void 0?re((y+ce[$]).slice(-10)+" 00000 n "):re("0000000000 00000 n ")},Es=p.__private__.buildDocument=function(){var y;le=0,he=0,me=[],ce=[],we=[],Gs=ur(),Hr=ur(),xe(me),Mt.publish("buildDocument"),Il(),Ri(),function(){Mt.publish("putAdditionalObjects");for(var ie=0;ie<we.length;ie++){var de=we[ie];Dn(de.objId,!0),re(de.content),re("endobj")}Mt.publish("postPutAdditionalObjects")}(),y=[],function(){for(var ie in Ze)Ze.hasOwnProperty(ie)&&(v===!1||v===!0&&g.hasOwnProperty(ie))&&_s(Ze[ie])}(),function(){var ie;for(ie in St)St.hasOwnProperty(ie)&&Bu(St[ie])}(),function(){for(var ie in Jn)Jn.hasOwnProperty(ie)&&Ys(Jn[ie])}(),function(ie){var de;for(de in gt)gt.hasOwnProperty(de)&&(gt[de]instanceof Ql?Ca(gt[de]):gt[de]instanceof Zc&&Ia(gt[de],ie))}(y),Mt.publish("putResources"),y.forEach(Qs),Qs({resourcesOid:Hr,objectOid:Number.MAX_SAFE_INTEGER}),Mt.publish("postPutResources"),f!==null&&(on.oid=Ln(),re("<<"),re("/Filter /Standard"),re("/V "+on.v),re("/R "+on.r),re("/U <"+on.toHexString(on.U)+">"),re("/O <"+on.toHexString(on.O)+">"),re("/P "+on.P),re(">>"),re("endobj")),Xs(),Cl();var $=he;return Ac(),Fn(),re("startxref"),re(""+$),re("%%EOF"),xe(Ee[P]),me.join(`
`)},Js=p.__private__.getBlob=function(y){return new Blob([dt(y)],{type:"application/pdf"})},yi=p.output=p.__private__.output=(Ar=function(y,$){switch(typeof($=$||{})=="string"?$={filename:$}:$.filename=$.filename||"generated.pdf",y){case void 0:return Es();case"save":p.save($.filename);break;case"arraybuffer":return dt(Es());case"blob":return Js(Es());case"bloburi":case"bloburl":if(Et.URL!==void 0&&typeof Et.URL.createObjectURL=="function")return Et.URL&&Et.URL.createObjectURL(Js(Es()))||void 0;xn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ie="",de=Es();try{ie=l5(de)}catch{ie=l5(unescape(encodeURIComponent(de)))}return"data:application/pdf;filename="+$.filename+";base64,"+ie;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Et)==="[object Window]"){var ge="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ke=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';$.pdfObjectUrl&&(ge=$.pdfObjectUrl,ke="");var Ie='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ge+'"'+ke+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify($)+");<\/script></body></html>",We=Et.open();return We!==null&&We.document.write(Ie),We}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Et)==="[object Window]"){var Xe='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+($.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+$.filename+'" width="500px" height="400px" /></body></html>',vt=Et.open();if(vt!==null){vt.document.write(Xe);var _t=this;vt.document.documentElement.querySelector("#pdfViewer").onload=function(){vt.document.title=$.filename,vt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(_t.output("bloburl"))}}return vt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Et)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Yt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",$)+'"></iframe></body></html>',rn=Et.open();if(rn!==null&&(rn.document.write(Yt),rn.document.title=$.filename),rn||typeof safari>"u")return rn;break;case"datauri":case"dataurl":return Et.document.location.href=this.output("datauristring",$);default:return null}},Ar.foo=function(){try{return Ar.apply(this,arguments)}catch(ie){var y=ie.stack||"";~y.indexOf(" at ")&&(y=y.split(" at ")[1]);var $="Error in function "+y.split(`
`)[0].split("<")[0]+": "+ie.message;if(!Et.console)throw new Error($);Et.console.error($,ie),Et.alert&&alert($)}},Ar.foo.bar=Ar,Ar.foo),Pa=function(y){return Array.isArray(Ws)===!0&&Ws.indexOf(y)>-1};switch(r){case"pt":yt=1;break;case"mm":yt=72/25.4;break;case"cm":yt=72/2.54;break;case"in":yt=72;break;case"px":yt=Pa("px_scaling")==1?.75:96/72;break;case"pc":case"em":yt=12;break;case"ex":yt=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);yt=r}var on=null;B(),H();var ci=p.__private__.getPageInfo=p.getPageInfo=function(y){if(isNaN(y)||y%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:xt[y].objId,pageNumber:y,pageContext:xt[y]}},yo=p.__private__.getPageInfoByObjId=function(y){if(isNaN(y)||y%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var $ in xt)if(xt[$].objId===y)break;return ci($)},xo=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:xt[P].objId,pageNumber:P,pageContext:xt[P]}};p.addPage=function(){return vo.apply(this,arguments),this},p.setPage=function(){return kl.apply(this,arguments),xe.call(this,Ee[P]),this},p.insertPage=function(y){return this.addPage(),this.movePage(P,y),this},p.movePage=function(y,$){var ie,de;if(y>$){ie=Ee[y],de=xt[y];for(var ge=y;ge>$;ge--)Ee[ge]=Ee[ge-1],xt[ge]=xt[ge-1];Ee[$]=ie,xt[$]=de,this.setPage($)}else if(y<$){ie=Ee[y],de=xt[y];for(var ke=y;ke<$;ke++)Ee[ke]=Ee[ke+1],xt[ke]=xt[ke+1];Ee[$]=ie,xt[$]=de,this.setPage($)}return this},p.deletePage=function(){return Sl.apply(this,arguments),this},p.__private__.text=p.text=function(y,$,ie,de,ge){var ke,Ie,We,Xe,vt,_t,Yt,rn,Un,ln=(de=de||{}).scope||this;if(typeof y=="number"&&typeof $=="number"&&(typeof ie=="string"||Array.isArray(ie))){var Wn=ie;ie=$,$=y,y=Wn}if(arguments[3]instanceof pt==0?(We=arguments[4],Xe=arguments[5],hn(Yt=arguments[3])==="object"&&Yt!==null||(typeof We=="string"&&(Xe=We,We=null),typeof Yt=="string"&&(Xe=Yt,Yt=null),typeof Yt=="number"&&(We=Yt,Yt=null),de={flags:Yt,angle:We,align:Xe})):(N("The transform parameter of text() with a Matrix value"),Un=ge),isNaN($)||isNaN(ie)||y==null)throw new Error("Invalid arguments passed to jsPDF.text");if(y.length===0)return ln;var Vn,Gn="",wn=typeof de.lineHeightFactor=="number"?de.lineHeightFactor:ea,Pr=ln.internal.scaleFactor;function Ul(sn){return sn=sn.split("	").join(Array(de.TabLen||9).join(" ")),Sr(sn,Yt)}function Oi(sn){for(var vn,tr=sn.concat(),vr=[],Ua=tr.length;Ua--;)typeof(vn=tr.shift())=="string"?vr.push(vn):Array.isArray(sn)&&(vn.length===1||vn[1]===void 0&&vn[2]===void 0)?vr.push(vn[0]):vr.push([vn[0],vn[1],vn[2]]);return vr}function h(sn,vn){var tr;if(typeof sn=="string")tr=vn(sn)[0];else if(Array.isArray(sn)){for(var vr,Ua,td=sn.concat(),jc=[],zh=td.length;zh--;)typeof(vr=td.shift())=="string"?jc.push(vn(vr)[0]):Array.isArray(vr)&&typeof vr[0]=="string"&&(Ua=vn(vr[0],vr[1],vr[2]),jc.push([Ua[0],Ua[1],Ua[2]]));tr=jc}return tr}var w=!1,O=!0;if(typeof y=="string")w=!0;else if(Array.isArray(y)){var Z=y.concat();Ie=[];for(var ve,_e=Z.length;_e--;)(typeof(ve=Z.shift())!="string"||Array.isArray(ve)&&typeof ve[0]!="string")&&(O=!1);w=O}if(w===!1)throw new Error('Type of text must be string or Array. "'+y+'" is not recognized.');typeof y=="string"&&(y=y.match(/[\r?\n]/)?y.split(/\r\n|\r|\n/g):[y]);var Be=Oe/ln.internal.scaleFactor,qt=Be*(wn-1);switch(de.baseline){case"bottom":ie-=qt;break;case"top":ie+=Be-qt;break;case"hanging":ie+=Be-2*qt;break;case"middle":ie+=Be/2-qt}if((_t=de.maxWidth||0)>0&&(typeof y=="string"?y=ln.splitTextToSize(y,_t):Object.prototype.toString.call(y)==="[object Array]"&&(y=y.reduce(function(sn,vn){return sn.concat(ln.splitTextToSize(vn,_t))},[]))),ke={text:y,x:$,y:ie,options:de,mutex:{pdfEscape:Sr,activeFontKey:st,fonts:Ze,activeFontSize:Oe}},Mt.publish("preProcessText",ke),y=ke.text,We=(de=ke.options).angle,Un instanceof pt==0&&We&&typeof We=="number"){We*=Math.PI/180,de.rotationDirection===0&&(We=-We),D===R&&(We=-We);var Bn=Math.cos(We),Ft=Math.sin(We);Un=new pt(Bn,Ft,-Ft,Bn,0,0)}else We&&We instanceof pt&&(Un=We);D!==R||Un||(Un=rs),(vt=de.charSpace||Da)!==void 0&&(Gn+=T(_(vt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(rn=de.horizontalScale)!==void 0&&(Gn+=T(100*rn)+` Tz
`),de.lang;var Ot=-1,Nn=de.renderingMode!==void 0?de.renderingMode:de.stroke,Mi=ln.internal.getCurrentPageInfo().pageContext;switch(Nn){case 0:case!1:case"fill":Ot=0;break;case 1:case!0:case"stroke":Ot=1;break;case 2:case"fillThenStroke":Ot=2;break;case 3:case"invisible":Ot=3;break;case 4:case"fillAndAddForClipping":Ot=4;break;case 5:case"strokeAndAddPathForClipping":Ot=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ot=6;break;case 7:case"addToPathForClipping":Ot=7}var Gr=Mi.usedRenderingMode!==void 0?Mi.usedRenderingMode:-1;Ot!==-1?Gn+=Ot+` Tr
`:Gr!==-1&&(Gn+=`0 Tr
`),Ot!==-1&&(Mi.usedRenderingMode=Ot),Xe=de.align||"left";var Rr,Ts=Oe*wn,Ku=ln.internal.pageSize.getWidth(),Yu=Ze[st];vt=de.charSpace||Da,_t=de.maxWidth||0,Yt=Object.assign({autoencode:!0,noBOM:!0},de.flags);var Ao=[],Vl=function(sn){return ln.getStringUnitWidth(sn,{font:Yu,charSpace:vt,fontSize:Oe,doKerning:!1})*Oe/Pr};if(Object.prototype.toString.call(y)==="[object Array]"){var Fi;Ie=Oi(y),Xe!=="left"&&(Rr=Ie.map(Vl));var Ui,So=0;if(Xe==="right"){$-=Rr[0],y=[],_e=Ie.length;for(var Fa=0;Fa<_e;Fa++)Fa===0?(Ui=kr($),Fi=As(ie)):(Ui=_(So-Rr[Fa]),Fi=-Ts),y.push([Ie[Fa],Ui,Fi]),So=Rr[Fa]}else if(Xe==="center"){$-=Rr[0]/2,y=[],_e=Ie.length;for(var ko=0;ko<_e;ko++)ko===0?(Ui=kr($),Fi=As(ie)):(Ui=_((So-Rr[ko])/2),Fi=-Ts),y.push([Ie[ko],Ui,Fi]),So=Rr[ko]}else if(Xe==="left"){y=[],_e=Ie.length;for(var Qu=0;Qu<_e;Qu++)y.push(Ie[Qu])}else if(Xe==="justify"&&Yu.encoding==="Identity-H"){y=[],_e=Ie.length,_t=_t!==0?_t:Ku;for(var Tc=0,er=0;er<_e;er++)if(Fi=er===0?As(ie):-Ts,Ui=er===0?kr($):Tc,er<_e-1){var $h=_((_t-Rr[er])/(Ie[er].split(" ").length-1)),sa=Ie[er].split(" ");y.push([sa[0]+" ",Ui,Fi]),Tc=0;for(var aa=1;aa<sa.length;aa++){var Xu=(Vl(sa[aa-1]+" "+sa[aa])-Vl(sa[aa]))*Pr+$h;aa==sa.length-1?y.push([sa[aa],Xu,0]):y.push([sa[aa]+" ",Xu,0]),Tc-=Xu}}else y.push([Ie[er],Ui,Fi]);y.push(["",Tc,0])}else{if(Xe!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(y=[],_e=Ie.length,_t=_t!==0?_t:Ku,er=0;er<_e;er++){Fi=er===0?As(ie):-Ts,Ui=er===0?kr($):0;var Ju=Ie[er].split(" ").length-1,Zu=Ju>0?(_t-Rr[er])/Ju:0;er<_e-1?Ao.push(T(_(Zu))):Ao.push(0),y.push([Ie[er],Ui,Fi])}}}(typeof de.R2L=="boolean"?de.R2L:$e)===!0&&(y=h(y,function(sn,vn,tr){return[sn.split("").reverse().join(""),vn,tr]})),ke={text:y,x:$,y:ie,options:de,mutex:{pdfEscape:Sr,activeFontKey:st,fonts:Ze,activeFontSize:Oe}},Mt.publish("postProcessText",ke),y=ke.text,Vn=ke.mutex.isHex||!1;var ed=Ze[st].encoding;ed!=="WinAnsiEncoding"&&ed!=="StandardEncoding"||(y=h(y,function(sn,vn,tr){return[Ul(sn),vn,tr]})),Ie=Oi(y),y=[];for(var To,jo,Co,Bl=Array.isArray(Ie[0])?1:0,Io="",$l=function(sn,vn,tr){var vr="";return tr instanceof pt?(tr=typeof de.angle=="number"?kn(tr,new pt(1,0,0,1,sn,vn)):kn(new pt(1,0,0,1,sn,vn),tr),D===R&&(tr=kn(new pt(1,0,0,-1,0,0),tr)),vr=tr.join(" ")+` Tm
`):vr=T(sn)+" "+T(vn)+` Td
`,vr},os=0;os<Ie.length;os++){switch(Io="",Bl){case 1:Co=(Vn?"<":"(")+Ie[os][0]+(Vn?">":")"),To=parseFloat(Ie[os][1]),jo=parseFloat(Ie[os][2]);break;case 0:Co=(Vn?"<":"(")+Ie[os]+(Vn?">":")"),To=kr($),jo=As(ie)}Ao!==void 0&&Ao[os]!==void 0&&(Io=Ao[os]+` Tw
`),os===0?y.push(Io+$l(To,jo,Un)+Co):Bl===0?y.push(Io+Co):Bl===1&&y.push(Io+$l(To,jo,Un)+Co)}y=Bl===0?y.join(` Tj
T* `):y.join(` Tj
`),y+=` Tj
`;var oa=`BT
/`;return oa+=st+" "+Oe+` Tf
`,oa+=T(Oe*wn)+` TL
`,oa+=Di+`
`,oa+=Gn,oa+=y,re(oa+="ET"),g[st]=!0,ln};var Sc=p.__private__.clip=p.clip=function(y){return re(y==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return Sc("evenodd")},p.__private__.discardPath=p.discardPath=function(){return re("n"),this};var Bt=p.__private__.isValidStyle=function(y){var $=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(y)!==-1&&($=!0),$};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(y){return Bt(y)&&(u=y),this};var Ra=p.__private__.getStyle=p.getStyle=function(y){var $=u;switch(y){case"D":case"S":$="S";break;case"F":$="f";break;case"FD":case"DF":$="B";break;case"f":case"f*":case"B":case"B*":$=y}return $},Zs=p.close=function(){return re("h"),this};p.stroke=function(){return re("S"),this},p.fill=function(y){return xi("f",y),this},p.fillEvenOdd=function(y){return xi("f*",y),this},p.fillStroke=function(y){return xi("B",y),this},p.fillStrokeEvenOdd=function(y){return xi("B*",y),this};var xi=function(y,$){hn($)==="object"?$u($,y):re(y)},Pl=function(y){y===null||D===R&&y===void 0||(y=Ra(y),re(y))};function kc(y,$,ie,de,ge){var ke=new Zc($||this.boundingBox,ie||this.xStep,de||this.yStep,this.gState,ge||this.matrix);ke.stream=this.stream;var Ie=y+"$$"+this.cloneIndex+++"$$";return Er(Ie,ke),ke}var $u=function(y,$){var ie=Dt[y.key],de=gt[ie];if(de instanceof Ql)re("q"),re(zu($)),de.gState&&p.setGState(de.gState),re(y.matrix.toString()+" cm"),re("/"+ie+" sh"),re("Q");else if(de instanceof Zc){var ge=new pt(1,0,0,-1,0,as());y.matrix&&(ge=ge.multiply(y.matrix||rs),ie=kc.call(de,y.key,y.boundingBox,y.xStep,y.yStep,ge).id),re("q"),re("/Pattern cs"),re("/"+ie+" scn"),de.gState&&p.setGState(de.gState),re($),re("Q")}},zu=function(y){switch(y){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Rl=p.moveTo=function(y,$){return re(T(_(y))+" "+T(M($))+" m"),this},La=p.lineTo=function(y,$){return re(T(_(y))+" "+T(M($))+" l"),this},bi=p.curveTo=function(y,$,ie,de,ge,ke){return re([T(_(y)),T(M($)),T(_(ie)),T(M(de)),T(_(ge)),T(M(ke)),"c"].join(" ")),this};p.__private__.line=p.line=function(y,$,ie,de,ge){if(isNaN(y)||isNaN($)||isNaN(ie)||isNaN(de)||!Bt(ge))throw new Error("Invalid arguments passed to jsPDF.line");return D===I?this.lines([[ie-y,de-$]],y,$,[1,1],ge||"S"):this.lines([[ie-y,de-$]],y,$,[1,1]).stroke()},p.__private__.lines=p.lines=function(y,$,ie,de,ge,ke){var Ie,We,Xe,vt,_t,Yt,rn,Un,ln,Wn,Vn,Gn;if(typeof y=="number"&&(Gn=ie,ie=$,$=y,y=Gn),de=de||[1,1],ke=ke||!1,isNaN($)||isNaN(ie)||!Array.isArray(y)||!Array.isArray(de)||!Bt(ge)||typeof ke!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Rl($,ie),Ie=de[0],We=de[1],vt=y.length,Wn=$,Vn=ie,Xe=0;Xe<vt;Xe++)(_t=y[Xe]).length===2?(Wn=_t[0]*Ie+Wn,Vn=_t[1]*We+Vn,La(Wn,Vn)):(Yt=_t[0]*Ie+Wn,rn=_t[1]*We+Vn,Un=_t[2]*Ie+Wn,ln=_t[3]*We+Vn,Wn=_t[4]*Ie+Wn,Vn=_t[5]*We+Vn,bi(Yt,rn,Un,ln,Wn,Vn));return ke&&Zs(),Pl(ge),this},p.path=function(y){for(var $=0;$<y.length;$++){var ie=y[$],de=ie.c;switch(ie.op){case"m":Rl(de[0],de[1]);break;case"l":La(de[0],de[1]);break;case"c":bi.apply(this,de);break;case"h":Zs()}}return this},p.__private__.rect=p.rect=function(y,$,ie,de,ge){if(isNaN(y)||isNaN($)||isNaN(ie)||isNaN(de)||!Bt(ge))throw new Error("Invalid arguments passed to jsPDF.rect");return D===I&&(de=-de),re([T(_(y)),T(M($)),T(_(ie)),T(_(de)),"re"].join(" ")),Pl(ge),this},p.__private__.triangle=p.triangle=function(y,$,ie,de,ge,ke,Ie){if(isNaN(y)||isNaN($)||isNaN(ie)||isNaN(de)||isNaN(ge)||isNaN(ke)||!Bt(Ie))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ie-y,de-$],[ge-ie,ke-de],[y-ge,$-ke]],y,$,[1,1],Ie,!0),this},p.__private__.roundedRect=p.roundedRect=function(y,$,ie,de,ge,ke,Ie){if(isNaN(y)||isNaN($)||isNaN(ie)||isNaN(de)||isNaN(ge)||isNaN(ke)||!Bt(Ie))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var We=4/3*(Math.SQRT2-1);return ge=Math.min(ge,.5*ie),ke=Math.min(ke,.5*de),this.lines([[ie-2*ge,0],[ge*We,0,ge,ke-ke*We,ge,ke],[0,de-2*ke],[0,ke*We,-ge*We,ke,-ge,ke],[2*ge-ie,0],[-ge*We,0,-ge,-ke*We,-ge,-ke],[0,2*ke-de],[0,-ke*We,ge*We,-ke,ge,-ke]],y+ge,$,[1,1],Ie,!0),this},p.__private__.ellipse=p.ellipse=function(y,$,ie,de,ge){if(isNaN(y)||isNaN($)||isNaN(ie)||isNaN(de)||!Bt(ge))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ke=4/3*(Math.SQRT2-1)*ie,Ie=4/3*(Math.SQRT2-1)*de;return Rl(y+ie,$),bi(y+ie,$-Ie,y+ke,$-de,y,$-de),bi(y-ke,$-de,y-ie,$-Ie,y-ie,$),bi(y-ie,$+Ie,y-ke,$+de,y,$+de),bi(y+ke,$+de,y+ie,$+Ie,y+ie,$),Pl(ge),this},p.__private__.circle=p.circle=function(y,$,ie,de){if(isNaN(y)||isNaN($)||isNaN(ie)||!Bt(de))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(y,$,ie,ie,de)},p.setFont=function(y,$,ie){return ie&&($=V($,ie)),st=jl(y,$,{disableWarning:!1}),this};var is=p.__private__.getFont=p.getFont=function(){return Ze[jl.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var y,$,ie={};for(y in Nt)if(Nt.hasOwnProperty(y))for($ in ie[y]=[],Nt[y])Nt[y].hasOwnProperty($)&&ie[y].push($);return ie},p.addFont=function(y,$,ie,de,ge){var ke=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ke.indexOf(arguments[3])!==-1?ge=arguments[3]:arguments[3]&&ke.indexOf(arguments[3])==-1&&(ie=V(ie,de)),go.call(this,y,$,ie,ge=ge||"Identity-H")};var ea,bo=t.lineWidth||.200025,bt=p.__private__.getLineWidth=p.getLineWidth=function(){return bo},ta=p.__private__.setLineWidth=p.setLineWidth=function(y){return bo=y,re(T(_(y))+" w"),this};p.__private__.setLineDash=ot.API.setLineDash=ot.API.setLineDashPattern=function(y,$){if(y=y||[],$=$||0,isNaN($)||!Array.isArray(y))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return y=y.map(function(ie){return T(_(ie))}).join(" "),$=T(_($)),re("["+y+"] "+$+" d"),this};var qu=p.__private__.getLineHeight=p.getLineHeight=function(){return Oe*ea};p.__private__.getLineHeight=p.getLineHeight=function(){return Oe*ea};var Hu=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(y){return typeof(y=y||1.15)=="number"&&(ea=y),this},Wu=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return ea};Hu(t.lineHeight);var kr=p.__private__.getHorizontalCoordinate=function(y){return _(y)},As=p.__private__.getVerticalCoordinate=function(y){return D===R?y:xt[P].mediaBox.topRightY-xt[P].mediaBox.bottomLeftY-_(y)},Gu=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(y){return T(kr(y))},wo=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(y){return T(As(y))},Ss=t.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return Pi(Ss)},p.__private__.setStrokeColor=p.setDrawColor=function(y,$,ie,de){return Ss=li({ch1:y,ch2:$,ch3:ie,ch4:de,pdfColorType:"draw",precision:2}),re(Ss),this};var No=t.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return Pi(No)},p.__private__.setFillColor=p.setFillColor=function(y,$,ie,de){return No=li({ch1:y,ch2:$,ch3:ie,ch4:de,pdfColorType:"fill",precision:2}),re(No),this};var Di=t.textColor||"0 g",ss=p.__private__.getTextColor=p.getTextColor=function(){return Pi(Di)};p.__private__.setTextColor=p.setTextColor=function(y,$,ie,de){return Di=li({ch1:y,ch2:$,ch3:ie,ch4:de,pdfColorType:"text",precision:3}),this};var Da=t.charSpace,Ll=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(Da||0)};p.__private__.setCharSpace=p.setCharSpace=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Da=y,this};var gn=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(y){var $=p.CapJoinStyles[y];if($===void 0)throw new Error("Line cap style of '"+y+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return gn=$,re($+" J"),this};var Dl=0;p.__private__.setLineJoin=p.setLineJoin=function(y){var $=p.CapJoinStyles[y];if($===void 0)throw new Error("Line join style of '"+y+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Dl=$,re($+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(y){if(y=y||0,isNaN(y))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return re(T(_(y))+" M"),this},p.GState=dp,p.setGState=function(y){(y=typeof y=="string"?St[Rn[y]]:Oa(null,y)).equals(Sn)||(re("/"+y.id+" gs"),Sn=y)};var Oa=function(y,$){if(!y||!Rn[y]){var ie=!1;for(var de in St)if(St.hasOwnProperty(de)&&St[de].equals($)){ie=!0;break}if(ie)$=St[de];else{var ge="GS"+(Object.keys(St).length+1).toString(10);St[ge]=$,$.id=ge}return y&&(Rn[y]=$.id),Mt.publish("addGState",$),$}};p.addGState=function(y,$){return Oa(y,$),this},p.saveGraphicsState=function(){return re("q"),an.push({key:st,size:Oe,color:Di}),this},p.restoreGraphicsState=function(){re("Q");var y=an.pop();return st=y.key,Oe=y.size,Di=y.color,Sn=null,this},p.setCurrentTransformationMatrix=function(y){return re(y.toString()+" cm"),this},p.comment=function(y){return re("#"+y),this};var na=function(y,$){var ie=y||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ie},set:function(ke){isNaN(ke)||(ie=parseFloat(ke))}});var de=$||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return de},set:function(ke){isNaN(ke)||(de=parseFloat(ke))}});var ge="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ge},set:function(ke){ge=ke.toString()}}),this},_o=function(y,$,ie,de){na.call(this,y,$),this.type="rect";var ge=ie||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ge},set:function(Ie){isNaN(Ie)||(ge=parseFloat(Ie))}});var ke=de||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ke},set:function(Ie){isNaN(Ie)||(ke=parseFloat(Ie))}}),this},Ma=function(){this.page=nn,this.currentPage=P,this.pages=Ee.slice(0),this.pagesContext=xt.slice(0),this.x=ct,this.y=en,this.matrix=Kt,this.width=wi(P),this.height=ks(P),this.outputDestination=Re,this.id="",this.objectNumber=-1};Ma.prototype.restore=function(){nn=this.page,P=this.currentPage,xt=this.pagesContext,Ee=this.pages,ct=this.x,en=this.y,Kt=this.matrix,Ol(P,this.width),ui(P,this.height),Re=this.outputDestination};var ra=function(y,$,ie,de,ge){qr.push(new Ma),nn=P=0,Ee=[],ct=y,en=$,Kt=ge,Li([ie,de])};for(var ia in p.beginFormObject=function(y,$,ie,de,ge){return ra(y,$,ie,de,ge),this},p.endFormObject=function(y){return function($){if(ns[$])qr.pop().restore();else{var ie=new Ma,de="Xo"+(Object.keys(Jn).length+1).toString(10);ie.id=de,ns[$]=de,Jn[de]=ie,Mt.publish("addFormObject",ie),qr.pop().restore()}}(y),this},p.doFormObject=function(y,$){var ie=Jn[ns[y]];return re("q"),re($.toString()+" cm"),re("/"+ie.id+" Do"),re("Q"),this},p.getFormObject=function(y){var $=Jn[ns[y]];return{x:$.x,y:$.y,width:$.width,height:$.height,matrix:$.matrix}},p.save=function(y,$){return y=y||"generated.pdf",($=$||{}).returnPromise=$.returnPromise||!1,$.returnPromise===!1?(Kl(Js(Es()),y),typeof Kl.unload=="function"&&Et.setTimeout&&setTimeout(Kl.unload,911),this):new Promise(function(ie,de){try{var ge=Kl(Js(Es()),y);typeof Kl.unload=="function"&&Et.setTimeout&&setTimeout(Kl.unload,911),ie(ge)}catch(ke){de(ke.message)}})},ot.API)ot.API.hasOwnProperty(ia)&&(ia==="events"&&ot.API.events.length?function(y,$){var ie,de,ge;for(ge=$.length-1;ge!==-1;ge--)ie=$[ge][0],de=$[ge][1],y.subscribe.apply(y,[ie].concat(typeof de=="function"?[de]:de))}(Mt,ot.API.events):p[ia]=ot.API[ia]);function wi(y){return xt[y].mediaBox.topRightX-xt[y].mediaBox.bottomLeftX}function Ol(y,$){xt[y].mediaBox.topRightX=$+xt[y].mediaBox.bottomLeftX}function ks(y){return xt[y].mediaBox.topRightY-xt[y].mediaBox.bottomLeftY}function ui(y,$){xt[y].mediaBox.topRightY=$+xt[y].mediaBox.bottomLeftY}var Ml=p.getPageWidth=function(y){return wi(y=y||P)/yt},Eo=p.setPageWidth=function(y,$){Ol(y,$*yt)},as=p.getPageHeight=function(y){return ks(y=y||P)/yt},Fl=p.setPageHeight=function(y,$){ui(y,$*yt)};return p.internal={pdfEscape:Sr,getStyle:Ra,getFont:is,getFontSize:Se,getCharSpace:Ll,getTextColor:ss,getLineHeight:qu,getLineHeightFactor:Wu,getLineWidth:bt,write:qe,getHorizontalCoordinate:kr,getVerticalCoordinate:As,getCoordinateString:Gu,getVerticalCoordinateString:wo,collections:{},newObject:Ln,newAdditionalObject:ja,newObjectDeferred:ur,newObjectDeferredBegin:Dn,getFilters:Wr,putStream:Zn,events:Mt,scaleFactor:yt,pageSize:{getWidth:function(){return Ml(P)},setWidth:function(y){Eo(P,y)},getHeight:function(){return as(P)},setHeight:function(y){Fl(P,y)}},encryptionOptions:f,encryption:on,getEncryptor:function(y){return f!==null?on.encryptor(y,0):function($){return $}},output:yi,getNumberOfPages:Tl,pages:Ee,out:re,f2:E,f3:L,getPageInfo:ci,getPageInfoByObjId:yo,getCurrentPageInfo:xo,getPDFVersion:k,Point:na,Rectangle:_o,Matrix:pt,hasHotfix:Pa},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return Ml(P)},set:function(y){Eo(P,y)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return as(P)},set:function(y){Fl(P,y)},enumerable:!0,configurable:!0}),(function(y){for(var $=0,ie=lt.length;$<ie;$++){var de=go.call(this,y[$][0],y[$][1],y[$][2],lt[$][3],!0);v===!1&&(g[de]=!0);var ge=y[$][0].split("-");Al({id:de,fontName:ge[0],fontStyle:ge[1]||""})}Mt.publish("addFonts",{fonts:Ze,dictionary:Nt})}).call(p,lt),st="F1",vo(i,n),Mt.publish("initialized"),p}Fc.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Fc.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Fc.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},Fc.prototype.processOwnerPassword=function(t,e){return Jv(Xv(e).substr(0,5),t)},Fc.prototype.encryptor=function(t,e){var n=Xv(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return Jv(n,r)}},dp.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||hn(t)!==hn(this))return!1;var r=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;r++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&r--;return r===0},ot.API={events:[]},ot.version="3.0.3";var Qn=ot.API,e2=1,Ec=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Rc=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},jt=function(t){return t.toFixed(2)},Bo=function(t){return t.toFixed(5)};Qn.__acroform__={};var Ii=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},h5=function(t){return t*e2},ua=function(t){var e=new QA,n=Ye.internal.getHeight(t)||0,r=Ye.internal.getWidth(t)||0;return e.BBox=[0,0,Number(jt(r)),Number(jt(n))],e},HD=Qn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},WD=Qn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},GD=Qn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},ar=Qn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return GD(t,e-1)},or=Qn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return HD(t,e-1)},lr=Qn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return WD(t,e-1)},KD=Qn.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,i=t[0],s=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=n(i)||0,c.lowerLeft_Y=r(s+l)||0,c.upperRight_X=n(i+o)||0,c.upperRight_Y=r(s)||0,[Number(jt(c.lowerLeft_X)),Number(jt(c.lowerLeft_Y)),Number(jt(c.upperRight_X)),Number(jt(c.upperRight_Y))]},YD=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,r=Zv(t,n),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+jt(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=ua(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},Zv=function(t,e){var n=t.fontSize===0?t.maxFontSize:t.fontSize,r={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(E){return E.split(`
`)}):i.map(function(E){return[E]});var s=n,o=Ye.internal.getHeight(t)||0;o=o<0?-o:o;var l=Ye.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(E,L,_){if(E+1<i.length){var M=L+" "+i[E+1][0];return Of(M,t,_).width<=l-4}return!1};s++;e:for(;s>0;){e="",s--;var u,f,v=Of("3",t,s).height,g=t.multiline?o-s:(o-v)/2,p=g+=2,S=0,k=0,C=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+Of(e,t,s=12).width+", FieldWidth:"+l+`
`;break}for(var b="",I=0,R=0;R<i.length;R++)if(i.hasOwnProperty(R)){var D=!1;if(i[R].length!==1&&C!==i[R].length-1){if((v+2)*(I+2)+2>o)continue e;b+=i[R][C],D=!0,k=R,R--}else{b=(b+=i[R][C]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var ee=parseInt(R),oe=c(ee,b,s),V=R>=i.length-1;if(oe&&!V){b+=" ",C=0;continue}if(oe||V){if(V)k=ee;else if(t.multiline&&(v+2)*(I+2)+2>o)continue e}else{if(!t.multiline||(v+2)*(I+2)+2>o)continue e;k=ee}}for(var T="",N=S;N<=k;N++){var U=i[N];if(t.multiline){if(N===k){T+=U[C]+" ",C=(C+1)%U.length;continue}if(N===S){T+=U[U.length-1]+" ";continue}}T+=U[0]+" "}switch(T=T.substr(T.length-1)==" "?T.substr(0,T.length-1):T,f=Of(T,t,s).width,t.textAlign){case"right":u=l-f-2;break;case"center":u=(l-f)/2;break;default:u=2}e+=jt(u)+" "+jt(p)+` Td
`,e+="("+Ec(T)+`) Tj
`,e+=-jt(u)+` 0 Td
`,p=-(s+2),f=0,S=D?k:k+1,I++,b=""}break}return r.text=e,r.fontSize=s,r},Of=function(t,e,n){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:i}},QD={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},XD=function(t,e){var n={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},JD=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(qs.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(QD)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");e2=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new XA,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var s=r[i];s.objId=void 0,s.hasAnnotation&&XD(s,n)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(n){(function(r,i){var s=!r;for(var o in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(o)){var l=r[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=KD(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Ye.createDefaultAppearanceStream(l),hn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var f=YD(l);c.push({key:"AP",value:"<</N "+f+">>"}),i.internal.acroformPlugin.xForms.push(f)}if(l.appearanceStreamContent){var v="";for(var g in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(g)){var p=l.appearanceStreamContent[g];if(v+="/"+g+" ",v+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var o in p)if(p.hasOwnProperty(o)){var S=p[o];typeof S=="function"&&(S=S.call(i,l)),v+="/"+o+" "+S+" ",i.internal.acroformPlugin.xForms.indexOf(S)>=0||i.internal.acroformPlugin.xForms.push(S)}}else typeof(S=p)=="function"&&(S=S.call(i,l)),v+="/"+o+" "+S,i.internal.acroformPlugin.xForms.indexOf(S)>=0||i.internal.acroformPlugin.xForms.push(S);v+=">>"}c.push({key:"AP",value:`<<
`+v+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}s&&function(k,C){for(var b in k)if(k.hasOwnProperty(b)){var I=b,R=k[b];C.internal.newObjectDeferredBegin(R.objId,!0),hn(R)==="object"&&typeof R.putStream=="function"&&R.putStream(),delete k[I]}}(i.internal.acroformPlugin.xForms,i)})(n,t)}),t.internal.acroformPlugin.isInitialized=!0}},YA=Qn.__acroform__.arrayToPdfArray=function(t,e,n){var r=function(o){return o};if(Array.isArray(t)){for(var i="[",s=0;s<t.length;s++)switch(s!==0&&(i+=" "),hn(t[s])){case"boolean":case"number":case"object":i+=t[s].toString();break;case"string":t[s].substr(0,1)!=="/"?(e!==void 0&&n&&(r=n.internal.getEncryptor(e)),i+="("+Ec(r(t[s].toString()))+")"):i+=t[s].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},N0=function(t,e,n){var r=function(i){return i};return e!==void 0&&n&&(r=n.internal.getEncryptor(e)),(t=t||"").toString(),"("+Ec(r(t))+")"},ma=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ma.prototype.toString=function(){return this.objId+" 0 R"},ma.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},ma.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var r=e[n],i=this[r];i&&(Array.isArray(i)?t.push({key:r,value:YA(i,this.objId,this.scope)}):i instanceof ma?(i.scope=this.scope,t.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:r,value:i}))}return t};var QA=function(){ma.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){t=n.trim()},get:function(){return t||null}})};Ii(QA,ma);var XA=function(){ma.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Ec(n(t))+")"}},set:function(n){t=n}})};Ii(XA,ma);var qs=function t(){ma.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');e=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!ar(e,3)},set:function(b){b?this.F=or(e,3):this.F=lr(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');n=b}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(b){r=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(b){r[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(b){r[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(b){r[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(b){r[3]=b}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof hp)return;s="FieldObject"+t.FieldNum++}var b=function(I){return I};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+Ec(b(s))+")"},set:function(b){s=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(b){s=b}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(b){o=b}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(b){l=b}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(b){c=b}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/e2:u},set:function(b){u=b}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(b){f=b}});var v="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!v||this instanceof hp||this instanceof sc))return N0(v,this.objId,this.scope)},set:function(b){b=b.toString(),v=b}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof Cr==0?N0(g,this.objId,this.scope):g},set:function(b){b=b.toString(),g=this instanceof Cr==0?b.substr(0,1)==="("?Rc(b.substr(1,b.length-2)):Rc(b):b}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Cr==1?Rc(g.substr(1,g.length-1)):g},set:function(b){b=b.toString(),g=this instanceof Cr==1?"/"+b:b}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Cr==0?N0(p,this.objId,this.scope):p},set:function(b){b=b.toString(),p=this instanceof Cr==0?b.substr(0,1)==="("?Rc(b.substr(1,b.length-2)):Rc(b):b}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Cr==1?Rc(p.substr(1,p.length-1)):p},set:function(b){b=b.toString(),p=this instanceof Cr==1?"/"+b:b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var S,k=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return k},set:function(b){b=!!b,k=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(S)return S},set:function(b){S=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,1)},set:function(b){b?this.Ff=or(this.Ff,1):this.Ff=lr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,2)},set:function(b){b?this.Ff=or(this.Ff,2):this.Ff=lr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,3)},set:function(b){b?this.Ff=or(this.Ff,3):this.Ff=lr(this.Ff,3)}});var C=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(C!==null)return C},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');C=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(C){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:C=2;break;case"center":case 1:C=1;break;default:C=0}}})};Ii(qs,ma);var du=function(){qs.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){t=n}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return YA(e,this.objId,this.scope)},set:function(n){var r,i;i=[],typeof(r=n)=="string"&&(i=function(s,o,l){l||(l=1);for(var c,u=[];c=o.exec(s);)u.push(c[l]);return u}(r,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(n){e=n,this.sort&&e.sort()},this.addOption=function(n){n=(n=n||"").toString(),e.push(n),this.sort&&e.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();e.indexOf(n)!==-1&&(e.splice(e.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,18)},set:function(n){n?this.Ff=or(this.Ff,18):this.Ff=lr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=or(this.Ff,19):this.Ff=lr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,20)},set:function(n){n?(this.Ff=or(this.Ff,20),e.sort()):this.Ff=lr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,22)},set:function(n){n?this.Ff=or(this.Ff,22):this.Ff=lr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,23)},set:function(n){n?this.Ff=or(this.Ff,23):this.Ff=lr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,27)},set:function(n){n?this.Ff=or(this.Ff,27):this.Ff=lr(this.Ff,27)}}),this.hasAppearanceStream=!1};Ii(du,qs);var hu=function(){du.call(this),this.fontName="helvetica",this.combo=!1};Ii(hu,du);var fu=function(){hu.call(this),this.combo=!0};Ii(fu,hu);var cm=function(){fu.call(this),this.edit=!0};Ii(cm,fu);var Cr=function(){qs.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,15)},set:function(n){n?this.Ff=or(this.Ff,15):this.Ff=lr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,16)},set:function(n){n?this.Ff=or(this.Ff,16):this.Ff=lr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,17)},set:function(n){n?this.Ff=or(this.Ff,17):this.Ff=lr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,26)},set:function(n){n?this.Ff=or(this.Ff,26):this.Ff=lr(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(s){return s};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,i=[];for(r in i.push("<<"),e)i.push("/"+r+" ("+Ec(n(e[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(n){hn(n)==="object"&&(e=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(n){typeof n=="string"&&(e.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+n}})};Ii(Cr,qs);var um=function(){Cr.call(this),this.pushButton=!0};Ii(um,Cr);var mu=function(){Cr.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Ii(mu,Cr);var hp=function(){var t,e;qs.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),r)o.push("/"+s+" ("+Ec(i(r[s]))+")");return o.push(">>"),o.join(`
`)},set:function(i){hn(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(i){n=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(i){n="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Ye.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ii(hp,qs),mu.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},mu.prototype.createOption=function(t){var e=new hp;return e.Parent=this,e.optionName=t,this.Kids.push(e),ZD.call(this.scope,e),e};var dm=function(){Cr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Ye.CheckBox.createAppearanceStream()};Ii(dm,Cr);var sc=function(){qs.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,13)},set:function(e){e?this.Ff=or(this.Ff,13):this.Ff=lr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,21)},set:function(e){e?this.Ff=or(this.Ff,21):this.Ff=lr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,23)},set:function(e){e?this.Ff=or(this.Ff,23):this.Ff=lr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,24)},set:function(e){e?this.Ff=or(this.Ff,24):this.Ff=lr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,25)},set:function(e){e?this.Ff=or(this.Ff,25):this.Ff=lr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,26)},set:function(e){e?this.Ff=or(this.Ff,26):this.Ff=lr(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ii(sc,qs);var hm=function(){sc.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!ar(this.Ff,14)},set:function(t){t?this.Ff=or(this.Ff,14):this.Ff=lr(this.Ff,14)}}),this.password=!0};Ii(hm,sc);var Ye={CheckBox:{createAppearanceStream:function(){return{N:{On:Ye.CheckBox.YesNormal},D:{On:Ye.CheckBox.YesPushDown,Off:Ye.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=ua(t);e.scope=t.scope;var n=[],r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),s=Zv(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+jt(Ye.internal.getWidth(t))+" "+jt(Ye.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+jt(s.fontSize)+" Tf "+i),n.push("BT"),n.push(s.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(t){var e=ua(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),i=[],s=Ye.internal.getHeight(t),o=Ye.internal.getWidth(t),l=Zv(t,t.caption);return i.push("1 g"),i.push("0 0 "+jt(o)+" "+jt(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+jt(o-1)+" "+jt(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+n+" "+jt(l.fontSize)+" Tf "+r),i.push(l.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=ua(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+jt(Ye.internal.getWidth(t))+" "+jt(Ye.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Ye.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Ye.RadioButton.Circle.YesNormal,e.D[t]=Ye.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=ua(t);e.scope=t.scope;var n=[],r=Ye.internal.getWidth(t)<=Ye.internal.getHeight(t)?Ye.internal.getWidth(t)/4:Ye.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Ye.internal.Bezier_C,s=Number((r*i).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Bo(Ye.internal.getWidth(t)/2)+" "+Bo(Ye.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),n.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),n.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),n.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=ua(t);e.scope=t.scope;var n=[],r=Ye.internal.getWidth(t)<=Ye.internal.getHeight(t)?Ye.internal.getWidth(t)/4:Ye.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Ye.internal.Bezier_C).toFixed(5)),o=Number((r*Ye.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Bo(Ye.internal.getWidth(t)/2)+" "+Bo(Ye.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Bo(Ye.internal.getWidth(t)/2)+" "+Bo(Ye.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),n.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),n.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),n.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=ua(t);e.scope=t.scope;var n=[],r=Ye.internal.getWidth(t)<=Ye.internal.getHeight(t)?Ye.internal.getWidth(t)/4:Ye.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Ye.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Bo(Ye.internal.getWidth(t)/2)+" "+Bo(Ye.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Ye.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Ye.RadioButton.Cross.YesNormal,e.D[t]=Ye.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=ua(t);e.scope=t.scope;var n=[],r=Ye.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+jt(Ye.internal.getWidth(t)-2)+" "+jt(Ye.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(jt(r.x1.x)+" "+jt(r.x1.y)+" m"),n.push(jt(r.x2.x)+" "+jt(r.x2.y)+" l"),n.push(jt(r.x4.x)+" "+jt(r.x4.y)+" m"),n.push(jt(r.x3.x)+" "+jt(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=ua(t);e.scope=t.scope;var n=Ye.internal.calculateCross(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+jt(Ye.internal.getWidth(t))+" "+jt(Ye.internal.getHeight(t))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+jt(Ye.internal.getWidth(t)-2)+" "+jt(Ye.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(jt(n.x1.x)+" "+jt(n.x1.y)+" m"),r.push(jt(n.x2.x)+" "+jt(n.x2.y)+" l"),r.push(jt(n.x4.x)+" "+jt(n.x4.y)+" m"),r.push(jt(n.x3.x)+" "+jt(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=ua(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+jt(Ye.internal.getWidth(t))+" "+jt(Ye.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};Ye.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Ye.internal.getWidth(t),n=Ye.internal.getHeight(t),r=Math.min(e,n);return{x1:{x:(e-r)/2,y:(n-r)/2+r},x2:{x:(e-r)/2+r,y:(n-r)/2},x3:{x:(e-r)/2,y:(n-r)/2},x4:{x:(e-r)/2+r,y:(n-r)/2+r}}}},Ye.internal.getWidth=function(t){var e=0;return hn(t)==="object"&&(e=h5(t.Rect[2])),e},Ye.internal.getHeight=function(t){var e=0;return hn(t)==="object"&&(e=h5(t.Rect[3])),e};var ZD=Qn.addField=function(t){if(JD(this,t),!(t instanceof qs))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Qn.AcroFormChoiceField=du,Qn.AcroFormListBox=hu,Qn.AcroFormComboBox=fu,Qn.AcroFormEditBox=cm,Qn.AcroFormButton=Cr,Qn.AcroFormPushButton=um,Qn.AcroFormRadioButton=mu,Qn.AcroFormCheckBox=dm,Qn.AcroFormTextField=sc,Qn.AcroFormPasswordField=hm,Qn.AcroFormAppearance=Ye,Qn.AcroForm={ChoiceField:du,ListBox:hu,ComboBox:fu,EditBox:cm,Button:Cr,PushButton:um,RadioButton:mu,CheckBox:dm,TextField:sc,PasswordField:hm,Appearance:Ye},ot.AcroForm={ChoiceField:du,ListBox:hu,ComboBox:fu,EditBox:cm,Button:Cr,PushButton:um,RadioButton:mu,CheckBox:dm,TextField:sc,PasswordField:hm,Appearance:Ye};ot.AcroForm;function JA(t){return t.reduce(function(e,n,r){return e[n]=r,e},{})}(function(t){var e="addImage_";t.__addimage__={};var n="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=t.__addimage__.getImageFileTypeByImageData=function(E,L){var _,M,K,F,X,H=n;if((L=L||n)==="RGBA"||E.data!==void 0&&E.data instanceof Uint8ClampedArray&&"height"in E&&"width"in E)return"RGBA";if(oe(E))for(X in r)for(K=r[X],_=0;_<K.length;_+=1){for(F=!0,M=0;M<K[_].length;M+=1)if(K[_][M]!==void 0&&K[_][M]!==E[M]){F=!1;break}if(F===!0){H=X;break}}else for(X in r)for(K=r[X],_=0;_<K.length;_+=1){for(F=!0,M=0;M<K[_].length;M+=1)if(K[_][M]!==void 0&&K[_][M]!==E.charCodeAt(M)){F=!1;break}if(F===!0){H=X;break}}return H===n&&L!==n&&(H=L),H},s=function E(L){for(var _=this.internal.write,M=this.internal.putStream,K=(0,this.internal.getFilters)();K.indexOf("FlateEncode")!==-1;)K.splice(K.indexOf("FlateEncode"),1);L.objectId=this.internal.newObject();var F=[];if(F.push({key:"Type",value:"/XObject"}),F.push({key:"Subtype",value:"/Image"}),F.push({key:"Width",value:L.width}),F.push({key:"Height",value:L.height}),L.colorSpace===b.INDEXED?F.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(L.palette.length/3-1)+" "+("sMask"in L&&L.sMask!==void 0?L.objectId+2:L.objectId+1)+" 0 R]"}):(F.push({key:"ColorSpace",value:"/"+L.colorSpace}),L.colorSpace===b.DEVICE_CMYK&&F.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),F.push({key:"BitsPerComponent",value:L.bitsPerComponent}),"decodeParameters"in L&&L.decodeParameters!==void 0&&F.push({key:"DecodeParms",value:"<<"+L.decodeParameters+">>"}),"transparency"in L&&Array.isArray(L.transparency)&&L.transparency.length>0){for(var X="",H=0,W=L.transparency.length;H<W;H++)X+=L.transparency[H]+" "+L.transparency[H]+" ";F.push({key:"Mask",value:"["+X+"]"})}L.sMask!==void 0&&F.push({key:"SMask",value:L.objectId+1+" 0 R"});var Y=L.filter!==void 0?["/"+L.filter]:void 0;if(M({data:L.data,additionalKeyValues:F,alreadyAppliedFilters:Y,objectId:L.objectId}),_("endobj"),"sMask"in L&&L.sMask!==void 0){var B,A=(B=L.sMaskBitsPerComponent)!==null&&B!==void 0?B:L.bitsPerComponent,P={width:L.width,height:L.height,colorSpace:"DeviceGray",bitsPerComponent:A,data:L.sMask};"filter"in L&&(P.decodeParameters="/Predictor ".concat(L.predictor," /Colors 1 /BitsPerComponent ").concat(A," /Columns ").concat(L.width),P.filter=L.filter),E.call(this,P)}if(L.colorSpace===b.INDEXED){var q=this.internal.newObject();M({data:T(new Uint8Array(L.palette)),objectId:q}),_("endobj")}},o=function(){var E=this.internal.collections[e+"images"];for(var L in E)s.call(this,E[L])},l=function(){var E,L=this.internal.collections[e+"images"],_=this.internal.write;for(var M in L)_("/I"+(E=L[M]).index,E.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var E=this.internal.collections[e+"images"];return c.call(this),E},f=function(){return Object.keys(this.internal.collections[e+"images"]).length},v=function(E){return typeof t["process"+E.toUpperCase()]=="function"},g=function(E){return hn(E)==="object"&&E.nodeType===1},p=function(E,L){if(E.nodeName==="IMG"&&E.hasAttribute("src")){var _=""+E.getAttribute("src");if(_.indexOf("data:image/")===0)return lm(unescape(_).split("base64,").pop());var M=t.loadFile(_,!0);if(M!==void 0)return M}if(E.nodeName==="CANVAS"){if(E.width===0||E.height===0)throw new Error("Given canvas must have data. Canvas width: "+E.width+", height: "+E.height);var K;switch(L){case"PNG":K="image/png";break;case"WEBP":K="image/webp";break;default:K="image/jpeg"}return lm(E.toDataURL(K,1).split("base64,").pop())}},S=function(E){var L=this.internal.collections[e+"images"];if(L){for(var _ in L)if(E===L[_].alias)return L[_]}},k=function(E,L,_){return E||L||(E=-96,L=-96),E<0&&(E=-1*_.width*72/E/this.internal.scaleFactor),L<0&&(L=-1*_.height*72/L/this.internal.scaleFactor),E===0&&(E=L*_.width/_.height),L===0&&(L=E*_.height/_.width),[E,L]},C=function(E,L,_,M,K,F){var X=k.call(this,_,M,K),H=this.internal.getCoordinateString,W=this.internal.getVerticalCoordinateString,Y=u.call(this);if(_=X[0],M=X[1],Y[K.index]=K,F){F*=Math.PI/180;var B=Math.cos(F),A=Math.sin(F),P=function(te){return te.toFixed(4)},q=[P(B),P(A),P(-1*A),P(B),0,0,"cm"]}this.internal.write("q"),F?(this.internal.write([1,"0","0",1,H(E),W(L+M),"cm"].join(" ")),this.internal.write(q.join(" ")),this.internal.write([H(_),"0","0",H(M),"0","0","cm"].join(" "))):this.internal.write([H(_),"0","0",H(M),H(E),W(L+M),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+K.index+" Do"),this.internal.write("Q")},b=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var I=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},R=t.__addimage__.sHashCode=function(E){var L,_,M=0;if(typeof E=="string")for(_=E.length,L=0;L<_;L++)M=(M<<5)-M+E.charCodeAt(L),M|=0;else if(oe(E))for(_=E.byteLength/2,L=0;L<_;L++)M=(M<<5)-M+E[L],M|=0;return M},D=t.__addimage__.validateStringAsBase64=function(E){(E=E||"").toString().trim();var L=!0;return E.length===0&&(L=!1),E.length%4!=0&&(L=!1),/^[A-Za-z0-9+/]+$/.test(E.substr(0,E.length-2))===!1&&(L=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(E.substr(-2))===!1&&(L=!1),L},ee=t.__addimage__.extractImageFromDataUrl=function(E){if(E==null||!(E=E.trim()).startsWith("data:"))return null;var L=E.indexOf(",");return L<0?null:E.substring(0,L).trim().endsWith("base64")?E.substring(L+1):null};t.__addimage__.isArrayBuffer=function(E){return E instanceof ArrayBuffer};var oe=t.__addimage__.isArrayBufferView=function(E){return E instanceof Int8Array||E instanceof Uint8Array||E instanceof Uint8ClampedArray||E instanceof Int16Array||E instanceof Uint16Array||E instanceof Int32Array||E instanceof Uint32Array||E instanceof Float32Array||E instanceof Float64Array},V=t.__addimage__.binaryStringToUint8Array=function(E){for(var L=E.length,_=new Uint8Array(L),M=0;M<L;M++)_[M]=E.charCodeAt(M);return _},T=t.__addimage__.arrayBufferToBinaryString=function(E){for(var L="",_=oe(E)?E:new Uint8Array(E),M=0;M<_.length;M+=8192)L+=String.fromCharCode.apply(null,_.subarray(M,M+8192));return L};t.addImage=function(){var E,L,_,M,K,F,X,H,W;if(typeof arguments[1]=="number"?(L=n,_=arguments[1],M=arguments[2],K=arguments[3],F=arguments[4],X=arguments[5],H=arguments[6],W=arguments[7]):(L=arguments[1],_=arguments[2],M=arguments[3],K=arguments[4],F=arguments[5],X=arguments[6],H=arguments[7],W=arguments[8]),hn(E=arguments[0])==="object"&&!g(E)&&"imageData"in E){var Y=E;E=Y.imageData,L=Y.format||L||n,_=Y.x||_||0,M=Y.y||M||0,K=Y.w||Y.width||K,F=Y.h||Y.height||F,X=Y.alias||X,H=Y.compression||H,W=Y.rotation||Y.angle||W}var B=this.internal.getFilters();if(H===void 0&&B.indexOf("FlateEncode")!==-1&&(H="SLOW"),isNaN(_)||isNaN(M))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var A=N.call(this,E,L,X,H);return C.call(this,_,M,K,F,A,W),this};var N=function(E,L,_,M){var K,F,X;if(typeof E=="string"&&i(E)===n){E=unescape(E);var H=U(E,!1);(H!==""||(H=t.loadFile(E,!0))!==void 0)&&(E=H)}if(g(E)&&(E=p(E,L)),L=i(E,L),!v(L))throw new Error("addImage does not support files of type '"+L+"', please ensure that a plugin for '"+L+"' support is added.");if(((X=_)==null||X.length===0)&&(_=function(W){return typeof W=="string"||oe(W)?R(W):oe(W.data)?R(W.data):null}(E)),(K=S.call(this,_))||(E instanceof Uint8Array||L==="RGBA"||(F=E,E=V(E)),K=this["process"+L.toUpperCase()](E,f.call(this),_,function(W){return W&&typeof W=="string"&&(W=W.toUpperCase()),W in t.image_compression?W:I.NONE}(M),F)),!K)throw new Error("An unknown error occurred whilst processing the image.");return K},U=t.__addimage__.convertBase64ToBinaryString=function(E,L){L=typeof L!="boolean"||L;var _,M="";if(typeof E=="string"){var K;_=(K=ee(E))!==null&&K!==void 0?K:E;try{M=lm(_)}catch(F){if(L)throw D(_)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+F.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return M};t.getImageProperties=function(E){var L,_,M="";if(g(E)&&(E=p(E)),typeof E=="string"&&i(E)===n&&((M=U(E,!1))===""&&(M=t.loadFile(E)||""),E=M),_=i(E),!v(_))throw new Error("addImage does not support files of type '"+_+"', please ensure that a plugin for '"+_+"' support is added.");if(E instanceof Uint8Array||(E=V(E)),!(L=this["process"+_.toUpperCase()](E)))throw new Error("An unknown error occurred whilst processing the image");return L.fileType=_,L}})(ot.API),function(t){var e=function(n){if(n!==void 0&&n!="")return!0};ot.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(n){for(var r,i,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(n.objId),u=n.pageContext.annotations,f=!1,v=0;v<u.length&&!f;v++)switch((r=u[v]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var g=0;g<u.length;g++){r=u[g];var p=this.internal.pdfEscape,S=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var k=this.internal.newAdditionalObject(),C=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(k.objId),I=r.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(r.bounds.x)+" "+l(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y)+"] ")+"/Contents ("+p(b(r.contents))+")",s+=" /Popup "+C.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+p(b(I))+") >>",k.content=s;var R=k.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(r.bounds.x+30)+" "+l(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w+30)+" "+l(r.bounds.y)+"] ")+" /Parent "+R,r.open&&(s+=" /Open true"),s+=" >>",C.content=s,this.internal.write(k.objId,"0 R",C.objId,"0 R");break;case"freetext":i="/Rect ["+o(r.bounds.x)+" "+l(r.bounds.y)+" "+o(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y+r.bounds.h)+"] ";var D=r.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+p(S(r.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+D+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(r.options.name){var ee=this.annotations._nameMap[r.options.name];r.options.pageNumber=ee.page,r.options.top=ee.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",s="",r.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+p(S(r.options.url))+") >>";else if(r.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,s+=" /FitV "+r.options.left+"]";break;default:var oe=l(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),s+=" /XYZ "+r.options.left+" "+oe+" "+r.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},t.link=function(n,r,i,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(n),y:u(r),w:c(n+i),h:u(r+s)},options:o,type:"link"})},t.textWithLink=function(n,r,i,s){var o,l,c=this.getTextWidth(n),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var f=this.splitTextToSize(n,l).length;o=Math.ceil(u*f)}else l=c,o=u;return this.text(n,r,i,s),i+=.2*u,s.align==="center"&&(r-=c/2),s.align==="right"&&(r-=c),this.link(r,i-u,l,o,s),c},t.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}}(ot.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(k){return e[k.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(k){return typeof k=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(k)},l=t.__arabicParser__.isArabicEndLetter=function(k){return o(k)&&s(k)&&e[k.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(k){return o(k)&&i.indexOf(k.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(k){return o(k)&&s(k)&&e[k.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(k){return o(k)&&s(k)&&e[k.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(k){return o(k)&&s(k)&&e[k.charCodeAt(0)].length>=3};var f=t.__arabicParser__.arabicLetterHasMedialForm=function(k){return o(k)&&s(k)&&e[k.charCodeAt(0)].length==4},v=t.__arabicParser__.resolveLigatures=function(k){var C=0,b=n,I="",R=0;for(C=0;C<k.length;C+=1)b[k.charCodeAt(C)]!==void 0?(R++,typeof(b=b[k.charCodeAt(C)])=="number"&&(I+=String.fromCharCode(b),b=n,R=0),C===k.length-1&&(b=n,I+=k.charAt(C-(R-1)),C-=R-1,R=0)):(b=n,I+=k.charAt(C-R),C-=R,R=0);return I};t.__arabicParser__.isArabicDiacritic=function(k){return k!==void 0&&r[k.charCodeAt(0)]!==void 0};var g=t.__arabicParser__.getCorrectForm=function(k,C,b){return o(k)?s(k)===!1?-1:!u(k)||!o(C)&&!o(b)||!o(b)&&l(C)||l(k)&&!o(C)||l(k)&&c(C)||l(k)&&l(C)?0:f(k)&&o(C)&&!l(C)&&o(b)&&u(b)?3:l(k)||!o(b)?1:2:-1},p=function(k){var C=0,b=0,I=0,R="",D="",ee="",oe=(k=k||"").split("\\s+"),V=[];for(C=0;C<oe.length;C+=1){for(V.push(""),b=0;b<oe[C].length;b+=1)R=oe[C][b],D=oe[C][b-1],ee=oe[C][b+1],o(R)?(I=g(R,D,ee),V[C]+=I!==-1?String.fromCharCode(e[R.charCodeAt(0)][I]):R):V[C]+=R;V[C]=v(V[C])}return V.join(" ")},S=t.__arabicParser__.processArabic=t.processArabic=function(){var k,C=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(C)){var I=0;for(b=[],I=0;I<C.length;I+=1)Array.isArray(C[I])?b.push([p(C[I][0]),C[I][1],C[I][2]]):b.push([p(C[I])]);k=b}else k=p(C);return typeof arguments[0]=="string"?k:(arguments[0].text=k,arguments[0])};t.events.push(["preProcessText",S])}(ot.API),ot.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(t){var e=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(l){n=l}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(l){r=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(n,r){var i;if((n=n||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(ot.API),function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(k){c=k}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(k){u=k}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(k){f=k}});var v=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return v},set:function(k){v=k}});var g=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return g},set:function(k){g=k}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(k){p=k}});var S=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return S},set:function(k){S=k}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return r.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){r.call(this);var f=(u=u||{}).fontSize||this.getFontSize(),v=u.font||this.getFont(),g=u.scaleFactor||this.internal.scaleFactor,p=0,S=0,k=0,C=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var b=u.maxWidth;b>0?typeof c=="string"?c=this.splitTextToSize(c,b):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(R,D){return R.concat(C.splitTextToSize(D,b))},[])):c=Array.isArray(c)?c:[c];for(var I=0;I<c.length;I++)p<(k=this.getStringUnitWidth(c[I],{font:v})*f)&&(p=k);return p!==0&&(S=c.length),{w:p/=g,h:Math.max((S*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/g,0)}},t.cellAddPage=function(){r.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var u=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,v=this.internal.__cell__.margins||e,g=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+v.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=v.top,p&&g&&(this.printHeaderRow(c.lineNumber,!0),c.y+=g[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,n===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-f,c.y+f,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+f,{align:"center",baseline:"top",maxWidth:c.width-f-f}):this.text(c.text,c.x+f,c.y+f,{align:"left",baseline:"top",maxWidth:c.width-f-f})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,f,v,g){if(r.call(this),!f)throw new Error("No data for PDF table.");var p,S,k,C,b=[],I=[],R=[],D={},ee={},oe=[],V=[],T=(g=g||{}).autoSize||!1,N=g.printHeaders!==!1,U=g.css&&g.css["font-size"]!==void 0?16*g.css["font-size"]:g.fontSize||12,E=g.margins||Object.assign({width:this.getPageWidth()},e),L=typeof g.padding=="number"?g.padding:3,_=g.headerBackgroundColor||"#c8c8c8",M=g.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=N,this.internal.__cell__.margins=E,this.internal.__cell__.table_font_size=U,this.internal.__cell__.padding=L,this.internal.__cell__.headerBackgroundColor=_,this.internal.__cell__.headerTextColor=M,this.setFontSize(U),v==null)I=b=Object.keys(f[0]),R=b.map(function(){return"left"});else if(Array.isArray(v)&&hn(v[0])==="object")for(b=v.map(function(Y){return Y.name}),I=v.map(function(Y){return Y.prompt||Y.name||""}),R=v.map(function(Y){return Y.align||"left"}),p=0;p<v.length;p+=1)ee[v[p].name]=.7499990551181103*v[p].width;else Array.isArray(v)&&typeof v[0]=="string"&&(I=b=v,R=b.map(function(){return"left"}));if(T||Array.isArray(v)&&typeof v[0]=="string")for(p=0;p<b.length;p+=1){for(D[C=b[p]]=f.map(function(Y){return Y[C]}),this.setFont(void 0,"bold"),oe.push(this.getTextDimensions(I[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),S=D[C],this.setFont(void 0,"normal"),k=0;k<S.length;k+=1)oe.push(this.getTextDimensions(S[k],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);ee[C]=Math.max.apply(null,oe)+L+L,oe=[]}if(N){var K={};for(p=0;p<b.length;p+=1)K[b[p]]={},K[b[p]].text=I[p],K[b[p]].align=R[p];var F=l.call(this,K,ee);V=b.map(function(Y){return new s(c,u,ee[Y],F,K[Y].text,void 0,K[Y].align)}),this.setTableHeaderRow(V),this.printHeaderRow(1,!1)}var X=v.reduce(function(Y,B){return Y[B.name]=B.align,Y},{});for(p=0;p<f.length;p+=1){"rowStart"in g&&g.rowStart instanceof Function&&g.rowStart({row:p,data:f[p]},this);var H=l.call(this,f[p],ee);for(k=0;k<b.length;k+=1){var W=f[p][b[k]];"cellStart"in g&&g.cellStart instanceof Function&&g.cellStart({row:p,col:k,data:W},this),o.call(this,new s(c,u,ee[b[k]],H,W,p+2,X[b[k]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var f=this.internal.__cell__.padding,v=this.internal.__cell__.table_font_size,g=this.internal.scaleFactor;return Object.keys(c).map(function(p){var S=c[p];return this.splitTextToSize(S.hasOwnProperty("text")?S.text:S,u[p]-f-f)},this).map(function(p){return this.getLineHeightFactor()*p.length*v/g+f+f},this).reduce(function(p,S){return Math.max(p,S)},0)};t.setTableHeaderRow=function(c){r.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var v=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(v[0],v[1],v[2],v[3],void 0,-1)}this.setFont(void 0,"bold");for(var g=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){f=this.internal.__cell__.tableHeaderRow[p].clone(),u&&(f.y=this.internal.__cell__.margins.top||0,g.push(f)),f.lineNumber=c;var S=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,f),this.setTextColor(S)}g.length>0&&this.setTableHeaderRow(g),this.setFont(void 0,"normal"),n=!1}}(ot.API);var ZA={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},eS=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],e1=JA(eS),tS=[100,200,300,400,500,600,700,800,900],eO=JA(tS);function _0(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=function(s){return ZA[s=s||"normal"]?s:"normal"}(t.style),r=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(t.weight),i=function(s){return typeof e1[s=s||"normal"]=="number"?s:"normal"}(t.stretch);return{family:e,style:n,weight:r,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,n,r].join(" ")}}}function f5(t,e,n,r){var i;for(i=n;i>=0&&i<e.length;i+=r)if(t[e[i]])return t[e[i]];for(i=n;i>=0&&i<e.length;i-=r)if(t[e[i]])return t[e[i]]}var tO={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},m5={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function p5(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function g5(t){return t.trimLeft()}function nO(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function rO(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Mf,v5,y5,Lc,Ff,x5,b5,w5,E0=["times"];function N5(t,e,n,r,i){var s=4,o=E5;switch(i){case ot.API.image_compression.FAST:s=1,o=_5;break;case ot.API.image_compression.MEDIUM:s=6,o=A5;break;case ot.API.image_compression.SLOW:s=9,o=S5}t=function(c,u,f,v){for(var g,p=c.length/u,S=new Uint8Array(c.length+p),k=[iO,_5,E5,A5,S5],C=0;C<p;C+=1){var b=C*u,I=c.subarray(b,b+u);if(v)S.set(v(I,f,g),b+C);else{for(var R=k.length,D=[],ee=0;ee<R;ee+=1)D[ee]=k[ee](I,f,g);var oe=aO(D.concat());S.set(D[oe],b+C)}g=I}return S}(t,e,Math.ceil(n*r/8),o);var l=Gv(t,{level:s});return ot.API.__addimage__.arrayBufferToBinaryString(l)}function iO(t){var e=Array.apply([],t);return e.unshift(0),e}function _5(t,e){var n=t.length,r=[];r[0]=1;for(var i=0;i<n;i+=1){var s=t[i-e]||0;r[i+1]=t[i]-s+256&255}return r}function E5(t,e,n){var r=t.length,i=[];i[0]=2;for(var s=0;s<r;s+=1){var o=n&&n[s]||0;i[s+1]=t[s]-o+256&255}return i}function A5(t,e,n){var r=t.length,i=[];i[0]=3;for(var s=0;s<r;s+=1){var o=t[s-e]||0,l=n&&n[s]||0;i[s+1]=t[s]+256-(o+l>>>1)&255}return i}function S5(t,e,n){var r=t.length,i=[];i[0]=4;for(var s=0;s<r;s+=1){var o=sO(t[s-e]||0,n&&n[s]||0,n&&n[s-e]||0);i[s+1]=t[s]-o+256&255}return i}function sO(t,e,n){if(t===e&&e===n)return t;var r=Math.abs(e-n),i=Math.abs(t-n),s=Math.abs(t+e-n-n);return r<=i&&r<=s?t:i<=s?e:n}function aO(t){var e=t.map(function(n){return n.reduce(function(r,i){return r+Math.abs(i)},0)});return e.indexOf(Math.min.apply(null,e))}function A0(t,e,n){var r=e*n,i=Math.floor(r/8),s=16-(r-8*i+n),o=(1<<n)-1;return nS(t,i)>>s&o}function k5(t,e,n,r){var i=n*r,s=Math.floor(i/8),o=16-(i-8*s+r),l=(1<<r)-1,c=(e&l)<<o;(function(u,f,v){if(f+1<u.byteLength)u.setUint16(f,v,!1);else{var g=v>>8&255;u.setUint8(f,g)}})(t,s,nS(t,s)&~(l<<o)&65535|c)}function nS(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function oO(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,r=t[e++]|t[e++]<<8,i=t[e++],s=i>>7,o=1<<1+(7&i);t[e++],t[e++];var l=null,c=null;s&&(l=e,c=o,e+=3*o);var u=!0,f=[],v=0,g=null,p=0,S=null;for(this.width=n,this.height=r;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,S=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((E=t[e++])>=0))throw Error("Invalid block size");if(E===0)break;e+=E}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var k=t[e++];v=t[e++]|t[e++]<<8,g=t[e++],1&k||(g=null),p=k>>2&7,e++;break;case 254:for(;;){if(!((E=t[e++])>=0))throw Error("Invalid block size");if(E===0)break;e+=E}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var C=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,I=t[e++]|t[e++]<<8,R=t[e++]|t[e++]<<8,D=t[e++],ee=D>>6&1,oe=1<<1+(7&D),V=l,T=c,N=!1;D>>7&&(N=!0,V=e,T=oe,e+=3*oe);var U=e;for(e++;;){var E;if(!((E=t[e++])>=0))throw Error("Invalid block size");if(E===0)break;e+=E}f.push({x:C,y:b,width:I,height:R,has_local_palette:N,palette_offset:V,palette_size:T,data_offset:U,data_length:e-U,transparent_index:g,interlaced:!!ee,delay:v,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return S},this.frameInfo=function(L){if(L<0||L>=f.length)throw new Error("Frame index out of range.");return f[L]},this.decodeAndBlitFrameBGRA=function(L,_){var M=this.frameInfo(L),K=M.width*M.height,F=new Uint8Array(K);T5(t,M.data_offset,F,K);var X=M.palette_offset,H=M.transparent_index;H===null&&(H=256);var W=M.width,Y=n-W,B=W,A=4*(M.y*n+M.x),P=4*((M.y+M.height)*n+M.x),q=A,te=4*Y;M.interlaced===!0&&(te+=4*n*7);for(var le=8,ce=0,me=F.length;ce<me;++ce){var he=F[ce];if(B===0&&(B=W,(q+=te)>=P&&(te=4*Y+4*n*(le-1),q=A+(W+Y)*(le<<1),le>>=1)),he===H)q+=4;else{var we=t[X+3*he],Ee=t[X+3*he+1],Le=t[X+3*he+2];_[q++]=Le,_[q++]=Ee,_[q++]=we,_[q++]=255}--B}},this.decodeAndBlitFrameRGBA=function(L,_){var M=this.frameInfo(L),K=M.width*M.height,F=new Uint8Array(K);T5(t,M.data_offset,F,K);var X=M.palette_offset,H=M.transparent_index;H===null&&(H=256);var W=M.width,Y=n-W,B=W,A=4*(M.y*n+M.x),P=4*((M.y+M.height)*n+M.x),q=A,te=4*Y;M.interlaced===!0&&(te+=4*n*7);for(var le=8,ce=0,me=F.length;ce<me;++ce){var he=F[ce];if(B===0&&(B=W,(q+=te)>=P&&(te=4*Y+4*n*(le-1),q=A+(W+Y)*(le<<1),le>>=1)),he===H)q+=4;else{var we=t[X+3*he],Ee=t[X+3*he+1],Le=t[X+3*he+2];_[q++]=we,_[q++]=Ee,_[q++]=Le,_[q++]=255}--B}}}function T5(t,e,n,r){for(var i=t[e++],s=1<<i,o=s+1,l=o+1,c=i+1,u=(1<<c)-1,f=0,v=0,g=0,p=t[e++],S=new Int32Array(4096),k=null;;){for(;f<16&&p!==0;)v|=t[e++]<<f,f+=8,p===1?p=t[e++]:--p;if(f<c)break;var C=v&u;if(v>>=c,f-=c,C!==s){if(C===o)break;for(var b=C<l?C:k,I=0,R=b;R>s;)R=S[R]>>8,++I;var D=R;if(g+I+(b!==C?1:0)>r)return void xn.log("Warning, gif stream longer than expected.");n[g++]=D;var ee=g+=I;for(b!==C&&(n[g++]=D),R=b;I--;)R=S[R],n[--ee]=255&R,R>>=8;k!==null&&l<4096&&(S[l++]=k<<8|D,l>=u+1&&c<12&&(++c,u=u<<1|1)),k=C}else l=o+1,u=(1<<(c=i+1))-1,k=null}return g!==r&&xn.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function S0(t){var e,n,r,i,s,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),f=new Array(64),v=new Array(65535),g=new Array(65535),p=new Array(64),S=new Array(64),k=[],C=0,b=7,I=new Array(64),R=new Array(64),D=new Array(64),ee=new Array(256),oe=new Array(2048),V=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],T=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],N=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],E=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],L=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],_=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],K=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function F(A,P){for(var q=0,te=0,le=new Array,ce=1;ce<=16;ce++){for(var me=1;me<=A[ce];me++)le[P[te]]=[],le[P[te]][0]=q,le[P[te]][1]=ce,te++,q++;q*=2}return le}function X(A){for(var P=A[0],q=A[1]-1;q>=0;)P&1<<q&&(C|=1<<b),q--,--b<0&&(C==255?(H(255),H(0)):H(C),b=7,C=0)}function H(A){k.push(A)}function W(A){H(A>>8&255),H(255&A)}function Y(A,P,q,te,le){for(var ce,me=le[0],he=le[240],we=function(Oe,Qe){var Se,$e,it,zt,At,nt,Tt,wt,st,yt,ct=0;for(st=0;st<8;++st){Se=Oe[ct],$e=Oe[ct+1],it=Oe[ct+2],zt=Oe[ct+3],At=Oe[ct+4],nt=Oe[ct+5],Tt=Oe[ct+6];var en=Se+(wt=Oe[ct+7]),Kt=Se-wt,Ze=$e+Tt,Nt=$e-Tt,an=it+nt,gt=it-nt,Dt=zt+At,St=zt-At,Rn=en+Dt,Sn=en-Dt,nn=Ze+an,xt=Ze-an;Oe[ct]=Rn+nn,Oe[ct+4]=Rn-nn;var Mt=.707106781*(xt+Sn);Oe[ct+2]=Sn+Mt,Oe[ct+6]=Sn-Mt;var Ws=.382683433*((Rn=St+gt)-(xt=Nt+Kt)),Jn=.5411961*Rn+Ws,ns=1.306562965*xt+Ws,qr=.707106781*(nn=gt+Nt),pt=Kt+qr,kn=Kt-qr;Oe[ct+5]=kn+Jn,Oe[ct+3]=kn-Jn,Oe[ct+1]=pt+ns,Oe[ct+7]=pt-ns,ct+=8}for(ct=0,st=0;st<8;++st){Se=Oe[ct],$e=Oe[ct+8],it=Oe[ct+16],zt=Oe[ct+24],At=Oe[ct+32],nt=Oe[ct+40],Tt=Oe[ct+48];var rs=Se+(wt=Oe[ct+56]),Er=Se-wt,Ar=$e+Tt,Ln=$e-Tt,ur=it+nt,Dn=it-nt,ja=zt+At,Gs=zt-At,Hr=rs+ja,Pi=rs-ja,li=Ar+ur,Wr=Ar-ur;Oe[ct]=Hr+li,Oe[ct+32]=Hr-li;var Zn=.707106781*(Wr+Pi);Oe[ct+16]=Pi+Zn,Oe[ct+48]=Pi-Zn;var Ks=.382683433*((Hr=Gs+Dn)-(Wr=Ln+Er)),Ri=.5411961*Hr+Ks,_s=1.306562965*Wr+Ks,Ys=.707106781*(li=Dn+Ln),Ca=Er+Ys,Ia=Er-Ys;Oe[ct+40]=Ia+Ri,Oe[ct+24]=Ia-Ri,Oe[ct+8]=Ca+_s,Oe[ct+56]=Ca-_s,ct++}for(st=0;st<64;++st)yt=Oe[st]*Qe[st],p[st]=yt>0?yt+.5|0:yt-.5|0;return p}(A,P),Ee=0;Ee<64;++Ee)S[V[Ee]]=we[Ee];var Le=S[0]-q;q=S[0],Le==0?X(te[0]):(X(te[g[ce=32767+Le]]),X(v[ce]));for(var Re=63;Re>0&&S[Re]==0;)Re--;if(Re==0)return X(me),q;for(var xe,re=1;re<=Re;){for(var qe=re;S[re]==0&&re<=Re;)++re;var dt=re-qe;if(dt>=16){xe=dt>>4;for(var lt=1;lt<=xe;++lt)X(he);dt&=15}ce=32767+S[re],X(le[(dt<<4)+g[ce]]),X(v[ce]),re++}return Re!=63&&X(me),q}function B(A){A=Math.min(Math.max(A,1),100),s!=A&&(function(P){for(var q=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],te=0;te<64;te++){var le=o((q[te]*P+50)/100);le=Math.min(Math.max(le,1),255),l[V[te]]=le}for(var ce=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],me=0;me<64;me++){var he=o((ce[me]*P+50)/100);he=Math.min(Math.max(he,1),255),c[V[me]]=he}for(var we=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ee=0,Le=0;Le<8;Le++)for(var Re=0;Re<8;Re++)u[Ee]=1/(l[V[Ee]]*we[Le]*we[Re]*8),f[Ee]=1/(c[V[Ee]]*we[Le]*we[Re]*8),Ee++}(A<50?Math.floor(5e3/A):Math.floor(200-2*A)),s=A)}this.encode=function(A,P){P&&B(P),k=new Array,C=0,b=7,W(65496),W(65504),W(16),H(74),H(70),H(73),H(70),H(0),H(1),H(1),H(0),W(1),W(1),H(0),H(0),function(){W(65499),W(132),H(0);for(var $e=0;$e<64;$e++)H(l[$e]);H(1);for(var it=0;it<64;it++)H(c[it])}(),function($e,it){W(65472),W(17),H(8),W(it),W($e),H(3),H(1),H(17),H(0),H(2),H(17),H(1),H(3),H(17),H(1)}(A.width,A.height),function(){W(65476),W(418),H(0);for(var $e=0;$e<16;$e++)H(T[$e+1]);for(var it=0;it<=11;it++)H(N[it]);H(16);for(var zt=0;zt<16;zt++)H(U[zt+1]);for(var At=0;At<=161;At++)H(E[At]);H(1);for(var nt=0;nt<16;nt++)H(L[nt+1]);for(var Tt=0;Tt<=11;Tt++)H(_[Tt]);H(17);for(var wt=0;wt<16;wt++)H(M[wt+1]);for(var st=0;st<=161;st++)H(K[st])}(),W(65498),W(12),H(3),H(1),H(0),H(2),H(17),H(3),H(17),H(0),H(63),H(0);var q=0,te=0,le=0;C=0,b=7,this.encode.displayName="_encode_";for(var ce,me,he,we,Ee,Le,Re,xe,re,qe=A.data,dt=A.width,lt=A.height,Oe=4*dt,Qe=0;Qe<lt;){for(ce=0;ce<Oe;){for(Ee=Oe*Qe+ce,Re=-1,xe=0,re=0;re<64;re++)Le=Ee+(xe=re>>3)*Oe+(Re=4*(7&re)),Qe+xe>=lt&&(Le-=Oe*(Qe+1+xe-lt)),ce+Re>=Oe&&(Le-=ce+Re-Oe+4),me=qe[Le++],he=qe[Le++],we=qe[Le++],I[re]=(oe[me]+oe[he+256|0]+oe[we+512|0]>>16)-128,R[re]=(oe[me+768|0]+oe[he+1024|0]+oe[we+1280|0]>>16)-128,D[re]=(oe[me+1280|0]+oe[he+1536|0]+oe[we+1792|0]>>16)-128;q=Y(I,u,q,e,r),te=Y(R,f,te,n,i),le=Y(D,f,le,n,i),ce+=32}Qe+=8}if(b>=0){var Se=[];Se[1]=b+1,Se[0]=(1<<b+1)-1,X(Se)}return W(65497),new Uint8Array(k)},t=t||50,function(){for(var A=String.fromCharCode,P=0;P<256;P++)ee[P]=A(P)}(),e=F(T,N),n=F(L,_),r=F(U,E),i=F(M,K),function(){for(var A=1,P=2,q=1;q<=15;q++){for(var te=A;te<P;te++)g[32767+te]=q,v[32767+te]=[],v[32767+te][1]=q,v[32767+te][0]=te;for(var le=-(P-1);le<=-A;le++)g[32767+le]=q,v[32767+le]=[],v[32767+le][1]=q,v[32767+le][0]=P-1+le;A<<=1,P<<=1}}(),function(){for(var A=0;A<256;A++)oe[A]=19595*A,oe[A+256|0]=38470*A,oe[A+512|0]=7471*A+32768,oe[A+768|0]=-11059*A,oe[A+1024|0]=-21709*A,oe[A+1280|0]=32768*A+8421375,oe[A+1536|0]=-27439*A,oe[A+1792|0]=-5329*A}(),B(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Rs(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function j5(t){function e(N){if(!N)throw Error("assert :P")}function n(N,U,E){for(var L=0;4>L;L++)if(N[U+L]!=E.charCodeAt(L))return!0;return!1}function r(N,U,E,L,_){for(var M=0;M<_;M++)N[U+M]=E[L+M]}function i(N,U,E,L){for(var _=0;_<L;_++)N[U+_]=E}function s(N){return new Int32Array(N)}function o(N,U){for(var E=[],L=0;L<N;L++)E.push(new U);return E}function l(N,U){var E=[];return function L(_,M,K){for(var F=K[M],X=0;X<F&&(_.push(K.length>M+1?[]:new U),!(K.length<M+1));X++)L(_[X],M+1,K)}(E,0,N),E}var c=function(){var N=this;function U(d,m){for(var x=1<<m-1>>>0;d&x;)x>>>=1;return x?(d&x-1)+x:d}function E(d,m,x,j,z){e(!(j%x));do d[m+(j-=x)]=z;while(0<j)}function L(d,m,x,j,z){if(e(2328>=z),512>=z)var G=s(512);else if((G=s(z))==null)return 0;return function(Q,J,ne,se,fe,Ne){var ae,pe,ye=J,Ae=1<<ne,be=s(16),Te=s(16);for(e(fe!=0),e(se!=null),e(Q!=null),e(0<ne),pe=0;pe<fe;++pe){if(15<se[pe])return 0;++be[se[pe]]}if(be[0]==fe)return 0;for(Te[1]=0,ae=1;15>ae;++ae){if(be[ae]>1<<ae)return 0;Te[ae+1]=Te[ae]+be[ae]}for(pe=0;pe<fe;++pe)ae=se[pe],0<se[pe]&&(Ne[Te[ae]++]=pe);if(Te[15]==1)return(se=new _).g=0,se.value=Ne[0],E(Q,ye,1,Ae,se),Ae;var je,Me=-1,Pe=Ae-1,at=0,Ke=1,Rt=1,et=1<<ne;for(pe=0,ae=1,fe=2;ae<=ne;++ae,fe<<=1){if(Ke+=Rt<<=1,0>(Rt-=be[ae]))return 0;for(;0<be[ae];--be[ae])(se=new _).g=ae,se.value=Ne[pe++],E(Q,ye+at,fe,et,se),at=U(at,ae)}for(ae=ne+1,fe=2;15>=ae;++ae,fe<<=1){if(Ke+=Rt<<=1,0>(Rt-=be[ae]))return 0;for(;0<be[ae];--be[ae]){if(se=new _,(at&Pe)!=Me){for(ye+=et,je=1<<(Me=ae)-ne;15>Me&&!(0>=(je-=be[Me]));)++Me,je<<=1;Ae+=et=1<<(je=Me-ne),Q[J+(Me=at&Pe)].g=je+ne,Q[J+Me].value=ye-J-Me}se.g=ae-ne,se.value=Ne[pe++],E(Q,ye+(at>>ne),fe,et,se),at=U(at,ae)}}return Ke!=2*Te[15]-1?0:Ae}(d,m,x,j,z,G)}function _(){this.value=this.g=0}function M(){this.value=this.g=0}function K(){this.G=o(5,_),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Vl,M)}function F(d,m,x,j){e(d!=null),e(m!=null),e(2147483648>j),d.Ca=254,d.I=0,d.b=-8,d.Ka=0,d.oa=m,d.pa=x,d.Jd=m,d.Yc=x+j,d.Zc=4<=j?x+j-4+1:x,me(d)}function X(d,m){for(var x=0;0<m--;)x|=we(d,128)<<m;return x}function H(d,m){var x=X(d,m);return he(d)?-x:x}function W(d,m,x,j){var z,G=0;for(e(d!=null),e(m!=null),e(4294967288>j),d.Sb=j,d.Ra=0,d.u=0,d.h=0,4<j&&(j=4),z=0;z<j;++z)G+=m[x+z]<<8*z;d.Ra=G,d.bb=j,d.oa=m,d.pa=x}function Y(d){for(;8<=d.u&&d.bb<d.Sb;)d.Ra>>>=8,d.Ra+=d.oa[d.pa+d.bb]<<So-8>>>0,++d.bb,d.u-=8;te(d)&&(d.h=1,d.u=0)}function B(d,m){if(e(0<=m),!d.h&&m<=Ui){var x=q(d)&Fi[m];return d.u+=m,Y(d),x}return d.h=1,d.u=0}function A(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function P(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function q(d){return d.Ra>>>(d.u&So-1)>>>0}function te(d){return e(d.bb<=d.Sb),d.h||d.bb==d.Sb&&d.u>So}function le(d,m){d.u=m,d.h=te(d)}function ce(d){d.u>=Fa&&(e(d.u>=Fa),Y(d))}function me(d){e(d!=null&&d.oa!=null),d.pa<d.Zc?(d.I=(d.oa[d.pa++]|d.I<<8)>>>0,d.b+=8):(e(d!=null&&d.oa!=null),d.pa<d.Yc?(d.b+=8,d.I=d.oa[d.pa++]|d.I<<8):d.Ka?d.b=0:(d.I<<=8,d.b+=8,d.Ka=1))}function he(d){return X(d,1)}function we(d,m){var x=d.Ca;0>d.b&&me(d);var j=d.b,z=x*m>>>8,G=(d.I>>>j>z)+0;for(G?(x-=z,d.I-=z+1<<j>>>0):x=z+1,j=x,z=0;256<=j;)z+=8,j>>=8;return j=7^z+ko[j],d.b-=j,d.Ca=(x<<j)-1,G}function Ee(d,m,x){d[m+0]=x>>24&255,d[m+1]=x>>16&255,d[m+2]=x>>8&255,d[m+3]=255&x}function Le(d,m){return d[m+0]|d[m+1]<<8}function Re(d,m){return Le(d,m)|d[m+2]<<16}function xe(d,m){return Le(d,m)|Le(d,m+2)<<16}function re(d,m){var x=1<<m;return e(d!=null),e(0<m),d.X=s(x),d.X==null?0:(d.Mb=32-m,d.Xa=m,1)}function qe(d,m){e(d!=null),e(m!=null),e(d.Xa==m.Xa),r(m.X,0,d.X,0,1<<m.Xa)}function dt(){this.X=[],this.Xa=this.Mb=0}function lt(d,m,x,j){e(x!=null),e(j!=null);var z=x[0],G=j[0];return z==0&&(z=(d*G+m/2)/m),G==0&&(G=(m*z+d/2)/d),0>=z||0>=G?0:(x[0]=z,j[0]=G,1)}function Oe(d,m){return d+(1<<m)-1>>>m}function Qe(d,m){return((4278255360&d)+(4278255360&m)>>>0&4278255360)+((16711935&d)+(16711935&m)>>>0&16711935)>>>0}function Se(d,m){N[m]=function(x,j,z,G,Q,J,ne){var se;for(se=0;se<Q;++se){var fe=N[d](J[ne+se-1],z,G+se);J[ne+se]=Qe(x[j+se],fe)}}}function $e(){this.ud=this.hd=this.jd=0}function it(d,m){return((4278124286&(d^m))>>>1)+(d&m)>>>0}function zt(d){return 0<=d&&256>d?d:0>d?0:255<d?255:void 0}function At(d,m){return zt(d+(d-m+.5>>1))}function nt(d,m,x){return Math.abs(m-x)-Math.abs(d-x)}function Tt(d,m,x,j,z,G,Q){for(j=G[Q-1],x=0;x<z;++x)G[Q+x]=j=Qe(d[m+x],j)}function wt(d,m,x,j,z){var G;for(G=0;G<x;++G){var Q=d[m+G],J=Q>>8&255,ne=16711935&(ne=(ne=16711935&Q)+((J<<16)+J));j[z+G]=(4278255360&Q)+ne>>>0}}function st(d,m){m.jd=255&d,m.hd=d>>8&255,m.ud=d>>16&255}function yt(d,m,x,j,z,G){var Q;for(Q=0;Q<j;++Q){var J=m[x+Q],ne=J>>>8,se=J,fe=255&(fe=(fe=J>>>16)+((d.jd<<24>>24)*(ne<<24>>24)>>>5));se=255&(se=(se+=(d.hd<<24>>24)*(ne<<24>>24)>>>5)+((d.ud<<24>>24)*(fe<<24>>24)>>>5)),z[G+Q]=(4278255360&J)+(fe<<16)+se}}function ct(d,m,x,j,z){N[m]=function(G,Q,J,ne,se,fe,Ne,ae,pe){for(ne=Ne;ne<ae;++ne)for(Ne=0;Ne<pe;++Ne)se[fe++]=z(J[j(G[Q++])])},N[d]=function(G,Q,J,ne,se,fe,Ne){var ae=8>>G.b,pe=G.Ea,ye=G.K[0],Ae=G.w;if(8>ae)for(G=(1<<G.b)-1,Ae=(1<<ae)-1;Q<J;++Q){var be,Te=0;for(be=0;be<pe;++be)be&G||(Te=j(ne[se++])),fe[Ne++]=z(ye[Te&Ae]),Te>>=ae}else N["VP8LMapColor"+x](ne,se,ye,Ae,fe,Ne,Q,J,pe)}}function en(d,m,x,j,z){for(x=m+x;m<x;){var G=d[m++];j[z++]=G>>16&255,j[z++]=G>>8&255,j[z++]=255&G}}function Kt(d,m,x,j,z){for(x=m+x;m<x;){var G=d[m++];j[z++]=G>>16&255,j[z++]=G>>8&255,j[z++]=255&G,j[z++]=G>>24&255}}function Ze(d,m,x,j,z){for(x=m+x;m<x;){var G=(Q=d[m++])>>16&240|Q>>12&15,Q=240&Q|Q>>28&15;j[z++]=G,j[z++]=Q}}function Nt(d,m,x,j,z){for(x=m+x;m<x;){var G=(Q=d[m++])>>16&248|Q>>13&7,Q=Q>>5&224|Q>>3&31;j[z++]=G,j[z++]=Q}}function an(d,m,x,j,z){for(x=m+x;m<x;){var G=d[m++];j[z++]=255&G,j[z++]=G>>8&255,j[z++]=G>>16&255}}function gt(d,m,x,j,z,G){if(G==0)for(x=m+x;m<x;)Ee(j,((G=d[m++])[0]>>24|G[1]>>8&65280|G[2]<<8&16711680|G[3]<<24)>>>0),z+=32;else r(j,z,d,m,x)}function Dt(d,m){N[m][0]=N[d+"0"],N[m][1]=N[d+"1"],N[m][2]=N[d+"2"],N[m][3]=N[d+"3"],N[m][4]=N[d+"4"],N[m][5]=N[d+"5"],N[m][6]=N[d+"6"],N[m][7]=N[d+"7"],N[m][8]=N[d+"8"],N[m][9]=N[d+"9"],N[m][10]=N[d+"10"],N[m][11]=N[d+"11"],N[m][12]=N[d+"12"],N[m][13]=N[d+"13"],N[m][14]=N[d+"0"],N[m][15]=N[d+"0"]}function St(d){return d==sg||d==ag||d==Yh||d==og}function Rn(){this.eb=[],this.size=this.A=this.fb=0}function Sn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function nn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Rn,this.f.kb=new Sn,this.sd=null}function xt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Mt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ws(d){return alert("todo:WebPSamplerProcessPlane"),d.T}function Jn(d,m){var x=d.T,j=m.ba.f.RGBA,z=j.eb,G=j.fb+d.ka*j.A,Q=cs[m.ba.S],J=d.y,ne=d.O,se=d.f,fe=d.N,Ne=d.ea,ae=d.W,pe=m.cc,ye=m.dc,Ae=m.Mc,be=m.Nc,Te=d.ka,je=d.ka+d.T,Me=d.U,Pe=Me+1>>1;for(Te==0?Q(J,ne,null,null,se,fe,Ne,ae,se,fe,Ne,ae,z,G,null,null,Me):(Q(m.ec,m.fc,J,ne,pe,ye,Ae,be,se,fe,Ne,ae,z,G-j.A,z,G,Me),++x);Te+2<je;Te+=2)pe=se,ye=fe,Ae=Ne,be=ae,fe+=d.Rc,ae+=d.Rc,G+=2*j.A,Q(J,(ne+=2*d.fa)-d.fa,J,ne,pe,ye,Ae,be,se,fe,Ne,ae,z,G-j.A,z,G,Me);return ne+=d.fa,d.j+je<d.o?(r(m.ec,m.fc,J,ne,Me),r(m.cc,m.dc,se,fe,Pe),r(m.Mc,m.Nc,Ne,ae,Pe),x--):1&je||Q(J,ne,null,null,se,fe,Ne,ae,se,fe,Ne,ae,z,G+j.A,null,null,Me),x}function ns(d,m,x){var j=d.F,z=[d.J];if(j!=null){var G=d.U,Q=m.ba.S,J=Q==Kh||Q==Yh;m=m.ba.f.RGBA;var ne=[0],se=d.ka;ne[0]=d.T,d.Kb&&(se==0?--ne[0]:(--se,z[0]-=d.width),d.j+d.ka+d.T==d.o&&(ne[0]=d.o-d.j-se));var fe=m.eb;se=m.fb+se*m.A,d=l2(j,z[0],d.width,G,ne,fe,se+(J?0:3),m.A),e(x==ne),d&&St(Q)&&nd(fe,se,J,G,ne,m.A)}return 0}function qr(d){var m=d.ma,x=m.ba.S,j=11>x,z=x==Wh||x==Gh||x==Kh||x==ig||x==12||St(x);if(m.memory=null,m.Ib=null,m.Jb=null,m.Nd=null,!Ku(m.Oa,d,z?11:12))return 0;if(z&&St(x)&&Ul(),d.da)alert("todo:use_scaling");else{if(j){if(m.Ib=Ws,d.Kb){if(x=d.U+1>>1,m.memory=s(d.U+2*x),m.memory==null)return 0;m.ec=m.memory,m.fc=0,m.cc=m.ec,m.dc=m.fc+d.U,m.Mc=m.cc,m.Nc=m.dc+x,m.Ib=Jn,Ul()}}else alert("todo:EmitYUV");z&&(m.Jb=ns,j&&wn())}if(j&&!E2){for(d=0;256>d;++d)ES[d]=89858*(d-128)+Xh>>Qh,kS[d]=-22014*(d-128)+Xh,SS[d]=-45773*(d-128),AS[d]=113618*(d-128)+Xh>>Qh;for(d=id;d<ug;++d)m=76283*(d-16)+Xh>>Qh,TS[d-id]=Ot(m,255),jS[d-id]=Ot(m+8>>4,15);E2=1}return 1}function pt(d){var m=d.ma,x=d.U,j=d.T;return e(!(1&d.ka)),0>=x||0>=j?0:(x=m.Ib(d,m),m.Jb!=null&&m.Jb(d,m,x),m.Dc+=x,1)}function kn(d){d.ma.memory=null}function rs(d,m,x,j){return B(d,8)!=47?0:(m[0]=B(d,14)+1,x[0]=B(d,14)+1,j[0]=B(d,1),B(d,3)!=0?0:!d.h)}function Er(d,m){if(4>d)return d+1;var x=d-2>>1;return(2+(1&d)<<x)+B(m,x)+1}function Ar(d,m){return 120<m?m-120:1<=(x=((x=uS[m-1])>>4)*d+(8-(15&x)))?x:1;var x}function Ln(d,m,x){var j=q(x),z=d[m+=255&j].g-8;return 0<z&&(le(x,x.u+8),j=q(x),m+=d[m].value,m+=j&(1<<z)-1),le(x,x.u+d[m].g),d[m].value}function ur(d,m,x){return x.g+=d.g,x.value+=d.value<<m>>>0,e(8>=x.g),d.g}function Dn(d,m,x){var j=d.xc;return e((m=j==0?0:d.vc[d.md*(x>>j)+(m>>j)])<d.Wb),d.Ya[m]}function ja(d,m,x,j){var z=d.ab,G=d.c*m,Q=d.C;m=Q+m;var J=x,ne=j;for(j=d.Ta,x=d.Ua;0<z--;){var se=d.gc[z],fe=Q,Ne=m,ae=J,pe=ne,ye=(ne=j,J=x,se.Ea);switch(e(fe<Ne),e(Ne<=se.nc),se.hc){case 2:er(ae,pe,(Ne-fe)*ye,ne,J);break;case 0:var Ae=fe,be=Ne,Te=ne,je=J,Me=(et=se).Ea;Ae==0&&(Qu(ae,pe,null,null,1,Te,je),Tt(ae,pe+1,0,0,Me-1,Te,je+1),pe+=Me,je+=Me,++Ae);for(var Pe=1<<et.b,at=Pe-1,Ke=Oe(Me,et.b),Rt=et.K,et=et.w+(Ae>>et.b)*Ke;Ae<be;){var Ht=Rt,yr=et,Lt=1;for(Tc(ae,pe,Te,je-Me,1,Te,je);Lt<Me;){var tt=(Lt&~at)+Pe;tt>Me&&(tt=Me),(0,Ju[Ht[yr++]>>8&15])(ae,pe+ +Lt,Te,je+Lt-Me,tt-Lt,Te,je+Lt),Lt=tt}pe+=Me,je+=Me,++Ae&at||(et+=Ke)}Ne!=se.nc&&r(ne,J-ye,ne,J+(Ne-fe-1)*ye,ye);break;case 1:for(ye=ae,be=pe,Me=(ae=se.Ea)-(je=ae&~(Te=(pe=1<<se.b)-1)),Ae=Oe(ae,se.b),Pe=se.K,se=se.w+(fe>>se.b)*Ae;fe<Ne;){for(at=Pe,Ke=se,Rt=new $e,et=be+je,Ht=be+ae;be<et;)st(at[Ke++],Rt),Zu(Rt,ye,be,pe,ne,J),be+=pe,J+=pe;be<Ht&&(st(at[Ke++],Rt),Zu(Rt,ye,be,Me,ne,J),be+=Me,J+=Me),++fe&Te||(se+=Ae)}break;case 3:if(ae==ne&&pe==J&&0<se.b){for(be=ne,ae=ye=J+(Ne-fe)*ye-(je=(Ne-fe)*Oe(se.Ea,se.b)),pe=ne,Te=J,Ae=[],je=(Me=je)-1;0<=je;--je)Ae[je]=pe[Te+je];for(je=Me-1;0<=je;--je)be[ae+je]=Ae[je];$h(se,fe,Ne,ne,ye,ne,J)}else $h(se,fe,Ne,ae,pe,ne,J)}J=j,ne=x}ne!=x&&r(j,x,J,ne,G)}function Gs(d,m){var x=d.V,j=d.Ba+d.c*d.C,z=m-d.C;if(e(m<=d.l.o),e(16>=z),0<z){var G=d.l,Q=d.Ta,J=d.Ua,ne=G.width;if(ja(d,z,x,j),z=J=[J],e((x=d.C)<(j=m)),e(G.v<G.va),j>G.o&&(j=G.o),x<G.j){var se=G.j-x;x=G.j,z[0]+=se*ne}if(x>=j?x=0:(z[0]+=4*G.v,G.ka=x-G.j,G.U=G.va-G.v,G.T=j-x,x=1),x){if(J=J[0],11>(x=d.ca).S){var fe=x.f.RGBA,Ne=(j=x.S,z=G.U,G=G.T,se=fe.eb,fe.A),ae=G;for(fe=fe.fb+d.Ma*fe.A;0<ae--;){var pe=Q,ye=J,Ae=z,be=se,Te=fe;switch(j){case Hh:ed(pe,ye,Ae,be,Te);break;case Wh:To(pe,ye,Ae,be,Te);break;case sg:To(pe,ye,Ae,be,Te),nd(be,Te,0,Ae,1,0);break;case p2:Bl(pe,ye,Ae,be,Te);break;case Gh:gt(pe,ye,Ae,be,Te,1);break;case ag:gt(pe,ye,Ae,be,Te,1),nd(be,Te,0,Ae,1,0);break;case Kh:gt(pe,ye,Ae,be,Te,0);break;case Yh:gt(pe,ye,Ae,be,Te,0),nd(be,Te,1,Ae,1,0);break;case ig:jo(pe,ye,Ae,be,Te);break;case og:jo(pe,ye,Ae,be,Te),o2(be,Te,Ae,1,0);break;case g2:Co(pe,ye,Ae,be,Te);break;default:e(0)}J+=ne,fe+=Ne}d.Ma+=G}else alert("todo:EmitRescaledRowsYUVA");e(d.Ma<=x.height)}}d.C=m,e(d.C<=d.i)}function Hr(d){var m;if(0<d.ua)return 0;for(m=0;m<d.Wb;++m){var x=d.Ya[m].G,j=d.Ya[m].H;if(0<x[1][j[1]+0].g||0<x[2][j[2]+0].g||0<x[3][j[3]+0].g)return 0}return 1}function Pi(d,m,x,j,z,G){if(d.Z!=0){var Q=d.qd,J=d.rd;for(e(Ro[d.Z]!=null);m<x;++m)Ro[d.Z](Q,J,j,z,j,z,G),Q=j,J=z,z+=G;d.qd=Q,d.rd=J}}function li(d,m){var x=d.l.ma,j=x.Z==0||x.Z==1?d.l.j:d.C;if(j=d.C<j?j:d.C,e(m<=d.l.o),m>j){var z=d.l.width,G=x.ca,Q=x.tb+z*j,J=d.V,ne=d.Ba+d.c*j,se=d.gc;e(d.ab==1),e(se[0].hc==3),aa(se[0],j,m,J,ne,G,Q),Pi(x,j,m,G,Q,z)}d.C=d.Ma=m}function Wr(d,m,x,j,z,G,Q){var J=d.$/j,ne=d.$%j,se=d.m,fe=d.s,Ne=x+d.$,ae=Ne;z=x+j*z;var pe=x+j*G,ye=280+fe.ua,Ae=d.Pb?J:16777216,be=0<fe.ua?fe.Wa:null,Te=fe.wc,je=Ne<pe?Dn(fe,ne,J):null;e(d.C<G),e(pe<=z);var Me=!1;e:for(;;){for(;Me||Ne<pe;){var Pe=0;if(J>=Ae){var at=Ne-x;e((Ae=d).Pb),Ae.wd=Ae.m,Ae.xd=at,0<Ae.s.ua&&qe(Ae.s.Wa,Ae.s.vb),Ae=J+hS}if(ne&Te||(je=Dn(fe,ne,J)),e(je!=null),je.Qb&&(m[Ne]=je.qb,Me=!0),!Me)if(ce(se),je.jc){Pe=se,at=m;var Ke=Ne,Rt=je.pd[q(Pe)&Vl-1];e(je.jc),256>Rt.g?(le(Pe,Pe.u+Rt.g),at[Ke]=Rt.value,Pe=0):(le(Pe,Pe.u+Rt.g-256),e(256<=Rt.value),Pe=Rt.value),Pe==0&&(Me=!0)}else Pe=Ln(je.G[0],je.H[0],se);if(se.h)break;if(Me||256>Pe){if(!Me)if(je.nd)m[Ne]=(je.qb|Pe<<8)>>>0;else{if(ce(se),Me=Ln(je.G[1],je.H[1],se),ce(se),at=Ln(je.G[2],je.H[2],se),Ke=Ln(je.G[3],je.H[3],se),se.h)break;m[Ne]=(Ke<<24|Me<<16|Pe<<8|at)>>>0}if(Me=!1,++Ne,++ne>=j&&(ne=0,++J,Q!=null&&J<=G&&!(J%16)&&Q(d,J),be!=null))for(;ae<Ne;)Pe=m[ae++],be.X[(506832829*Pe&4294967295)>>>be.Mb]=Pe}else if(280>Pe){if(Pe=Er(Pe-256,se),at=Ln(je.G[4],je.H[4],se),ce(se),at=Ar(j,at=Er(at,se)),se.h)break;if(Ne-x<at||z-Ne<Pe)break e;for(Ke=0;Ke<Pe;++Ke)m[Ne+Ke]=m[Ne+Ke-at];for(Ne+=Pe,ne+=Pe;ne>=j;)ne-=j,++J,Q!=null&&J<=G&&!(J%16)&&Q(d,J);if(e(Ne<=z),ne&Te&&(je=Dn(fe,ne,J)),be!=null)for(;ae<Ne;)Pe=m[ae++],be.X[(506832829*Pe&4294967295)>>>be.Mb]=Pe}else{if(!(Pe<ye))break e;for(Me=Pe-280,e(be!=null);ae<Ne;)Pe=m[ae++],be.X[(506832829*Pe&4294967295)>>>be.Mb]=Pe;Pe=Ne,e(!(Me>>>(at=be).Xa)),m[Pe]=at.X[Me],Me=!0}Me||e(se.h==te(se))}if(d.Pb&&se.h&&Ne<z)e(d.m.h),d.a=5,d.m=d.wd,d.$=d.xd,0<d.s.ua&&qe(d.s.vb,d.s.Wa);else{if(se.h)break e;Q!=null&&Q(d,J>G?G:J),d.a=0,d.$=Ne-x}return 1}return d.a=3,0}function Zn(d){e(d!=null),d.vc=null,d.yc=null,d.Ya=null;var m=d.Wa;m!=null&&(m.X=null),d.vb=null,e(d!=null)}function Ks(){var d=new Xe;return d==null?null:(d.a=0,d.xb=x2,Dt("Predictor","VP8LPredictors"),Dt("Predictor","VP8LPredictors_C"),Dt("PredictorAdd","VP8LPredictorsAdd"),Dt("PredictorAdd","VP8LPredictorsAdd_C"),er=wt,Zu=yt,ed=en,To=Kt,jo=Ze,Co=Nt,Bl=an,N.VP8LMapColor32b=sa,N.VP8LMapColor8b=Xu,d)}function Ri(d,m,x,j,z){var G=1,Q=[d],J=[m],ne=j.m,se=j.s,fe=null,Ne=0;e:for(;;){if(x)for(;G&&B(ne,1);){var ae=Q,pe=J,ye=j,Ae=1,be=ye.m,Te=ye.gc[ye.ab],je=B(be,2);if(ye.Oc&1<<je)G=0;else{switch(ye.Oc|=1<<je,Te.hc=je,Te.Ea=ae[0],Te.nc=pe[0],Te.K=[null],++ye.ab,e(4>=ye.ab),je){case 0:case 1:Te.b=B(be,3)+2,Ae=Ri(Oe(Te.Ea,Te.b),Oe(Te.nc,Te.b),0,ye,Te.K),Te.K=Te.K[0];break;case 3:var Me,Pe=B(be,8)+1,at=16<Pe?0:4<Pe?1:2<Pe?2:3;if(ae[0]=Oe(Te.Ea,at),Te.b=at,Me=Ae=Ri(Pe,1,0,ye,Te.K)){var Ke,Rt=Pe,et=Te,Ht=1<<(8>>et.b),yr=s(Ht);if(yr==null)Me=0;else{var Lt=et.K[0],tt=et.w;for(yr[0]=et.K[0][0],Ke=1;Ke<1*Rt;++Ke)yr[Ke]=Qe(Lt[tt+Ke],yr[Ke-1]);for(;Ke<4*Ht;++Ke)yr[Ke]=0;et.K[0]=null,et.K[0]=yr,Me=1}}Ae=Me;break;case 2:break;default:e(0)}G=Ae}}if(Q=Q[0],J=J[0],G&&B(ne,1)&&!(G=1<=(Ne=B(ne,4))&&11>=Ne)){j.a=3;break e}var ze;if(ze=G)t:{var nr,Pt,Qt,Tn=j,Lr=Q,di=J,Kn=Ne,Kr=x,hi=Tn.m,xr=Tn.s,Jt=[null],cn=1,Yn=0,un=dS[Kn];n:for(;;){if(Kr&&B(hi,1)){var Dr=B(hi,3)+2,Cs=Oe(Lr,Dr),rr=Oe(di,Dr),Ni=Cs*rr;if(!Ri(Cs,rr,0,Tn,Jt))break n;for(Jt=Jt[0],xr.xc=Dr,nr=0;nr<Ni;++nr){var yn=Jt[nr]>>8&65535;Jt[nr]=yn,yn>=cn&&(cn=yn+1)}}if(hi.h)break n;for(Pt=0;5>Pt;++Pt){var br=v2[Pt];!Pt&&0<Kn&&(br+=1<<Kn),Yn<br&&(Yn=br)}var Bi=o(cn*un,_),fi=cn,$i=o(fi,K);if($i==null)var zi=null;else e(65536>=fi),zi=$i;var _i=s(Yn);if(zi==null||_i==null||Bi==null){Tn.a=1;break n}var qi=Bi;for(nr=Qt=0;nr<cn;++nr){var _n=zi[nr],Hi=_n.G,Is=_n.H,zl=0,Ba=1,Or=0;for(Pt=0;5>Pt;++Pt){br=v2[Pt],Hi[Pt]=qi,Is[Pt]=Qt,!Pt&&0<Kn&&(br+=1<<Kn);i:{var Zh,dg=br,ef=Tn,sd=_i,PS=qi,RS=Qt,hg=0,Lo=ef.m,LS=B(Lo,1);if(i(sd,0,0,dg),LS){var DS=B(Lo,1)+1,OS=B(Lo,1),k2=B(Lo,OS==0?1:8);sd[k2]=1,DS==2&&(sd[k2=B(Lo,8)]=1);var tf=1}else{var T2=s(19),j2=B(Lo,4)+4;if(19<j2){ef.a=3;var nf=0;break i}for(Zh=0;Zh<j2;++Zh)T2[cS[Zh]]=B(Lo,3);var fg=void 0,ad=void 0,C2=ef,MS=T2,rf=dg,I2=sd,mg=0,Do=C2.m,P2=8,R2=o(128,_);r:for(;L(R2,0,7,MS,19);){if(B(Do,1)){var FS=2+2*B(Do,3);if((fg=2+B(Do,FS))>rf)break r}else fg=rf;for(ad=0;ad<rf&&fg--;){ce(Do);var L2=R2[0+(127&q(Do))];le(Do,Do.u+L2.g);var Cc=L2.value;if(16>Cc)I2[ad++]=Cc,Cc!=0&&(P2=Cc);else{var US=Cc==16,D2=Cc-16,VS=oS[D2],O2=B(Do,aS[D2])+VS;if(ad+O2>rf)break r;for(var BS=US?P2:0;0<O2--;)I2[ad++]=BS}}mg=1;break r}mg||(C2.a=3),tf=mg}(tf=tf&&!Lo.h)&&(hg=L(PS,RS,8,sd,dg)),tf&&hg!=0?nf=hg:(ef.a=3,nf=0)}if(nf==0)break n;if(Ba&&lS[Pt]==1&&(Ba=qi[Qt].g==0),zl+=qi[Qt].g,Qt+=nf,3>=Pt){var od,pg=_i[0];for(od=1;od<br;++od)_i[od]>pg&&(pg=_i[od]);Or+=pg}}if(_n.nd=Ba,_n.Qb=0,Ba&&(_n.qb=(Hi[3][Is[3]+0].value<<24|Hi[1][Is[1]+0].value<<16|Hi[2][Is[2]+0].value)>>>0,zl==0&&256>Hi[0][Is[0]+0].value&&(_n.Qb=1,_n.qb+=Hi[0][Is[0]+0].value<<8)),_n.jc=!_n.Qb&&6>Or,_n.jc){var sf,$a=_n;for(sf=0;sf<Vl;++sf){var Oo=sf,Mo=$a.pd[Oo],af=$a.G[0][$a.H[0]+Oo];256<=af.value?(Mo.g=af.g+256,Mo.value=af.value):(Mo.g=0,Mo.value=0,Oo>>=ur(af,8,Mo),Oo>>=ur($a.G[1][$a.H[1]+Oo],16,Mo),Oo>>=ur($a.G[2][$a.H[2]+Oo],0,Mo),ur($a.G[3][$a.H[3]+Oo],24,Mo))}}}xr.vc=Jt,xr.Wb=cn,xr.Ya=zi,xr.yc=Bi,ze=1;break t}ze=0}if(!(G=ze)){j.a=3;break e}if(0<Ne){if(se.ua=1<<Ne,!re(se.Wa,Ne)){j.a=1,G=0;break e}}else se.ua=0;var gg=j,M2=Q,$S=J,vg=gg.s,yg=vg.xc;if(gg.c=M2,gg.i=$S,vg.md=Oe(M2,yg),vg.wc=yg==0?-1:(1<<yg)-1,x){j.xb=xS;break e}if((fe=s(Q*J))==null){j.a=1,G=0;break e}G=(G=Wr(j,fe,0,Q,J,J,null))&&!ne.h;break e}return G?(z!=null?z[0]=fe:(e(fe==null),e(x)),j.$=0,x||Zn(se)):Zn(se),G}function _s(d,m){var x=d.c*d.i,j=x+m+16*m;return e(d.c<=m),d.V=s(j),d.V==null?(d.Ta=null,d.Ua=0,d.a=1,0):(d.Ta=d.V,d.Ua=d.Ba+x+m,1)}function Ys(d,m){var x=d.C,j=m-x,z=d.V,G=d.Ba+d.c*x;for(e(m<=d.l.o);0<j;){var Q=16<j?16:j,J=d.l.ma,ne=d.l.width,se=ne*Q,fe=J.ca,Ne=J.tb+ne*x,ae=d.Ta,pe=d.Ua;ja(d,Q,z,G),c2(ae,pe,fe,Ne,se),Pi(J,x,x+Q,fe,Ne,ne),j-=Q,z+=Q*d.c,x+=Q}e(x==m),d.C=d.Ma=m}function Ca(){this.ub=this.yd=this.td=this.Rb=0}function Ia(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Bu(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Qs(){this.Yb=function(){var d=[];return function m(x,j,z){for(var G=z[j],Q=0;Q<G&&(x.push(z.length>j+1?[]:0),!(z.length<j+1));Q++)m(x[Q],j+1,z)}(d,0,[3,11]),d}()}function Al(){this.jb=s(3),this.Wc=l([4,8],Qs),this.Xc=l([4,17],Qs)}function go(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Sr(){this.ld=this.La=this.dd=this.tc=0}function Li(){this.Na=this.la=0}function vo(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Sl(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function kl(){this.uc=this.M=this.Nb=0,this.wa=Array(new Sr),this.Y=0,this.ya=Array(new Sl),this.aa=0,this.l=new Xs}function Tl(){this.y=s(16),this.f=s(8),this.ea=s(8)}function jl(){this.cb=this.a=0,this.sc="",this.m=new A,this.Od=new Ca,this.Kc=new Ia,this.ed=new go,this.Qa=new Bu,this.Ic=this.$c=this.Aa=0,this.D=new kl,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,A),this.ia=0,this.pb=o(4,vo),this.Pa=new Al,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Tl),this.Hd=0,this.rb=Array(new Li),this.sb=0,this.wa=Array(new Sr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Sl),this.L=this.aa=0,this.gd=l([4,2],Sr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Xs(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Cl(){var d=new jl;return d!=null&&(d.a=0,d.sc="OK",d.cb=0,d.Xb=0,rd||(rd=Es)),d}function Fn(d,m,x){return d.a==0&&(d.a=m,d.sc=x,d.cb=0),0}function Il(d,m,x){return 3<=x&&d[m+0]==157&&d[m+1]==1&&d[m+2]==42}function Ac(d,m){if(d==null)return 0;if(d.a=0,d.sc="OK",m==null)return Fn(d,2,"null VP8Io passed to VP8GetHeaders()");var x=m.data,j=m.w,z=m.ha;if(4>z)return Fn(d,7,"Truncated header.");var G=x[j+0]|x[j+1]<<8|x[j+2]<<16,Q=d.Od;if(Q.Rb=!(1&G),Q.td=G>>1&7,Q.yd=G>>4&1,Q.ub=G>>5,3<Q.td)return Fn(d,3,"Incorrect keyframe parameters.");if(!Q.yd)return Fn(d,4,"Frame not displayable.");j+=3,z-=3;var J=d.Kc;if(Q.Rb){if(7>z)return Fn(d,7,"cannot parse picture header");if(!Il(x,j,z))return Fn(d,3,"Bad code word");J.c=16383&(x[j+4]<<8|x[j+3]),J.Td=x[j+4]>>6,J.i=16383&(x[j+6]<<8|x[j+5]),J.Ud=x[j+6]>>6,j+=7,z-=7,d.za=J.c+15>>4,d.Ub=J.i+15>>4,m.width=J.c,m.height=J.i,m.Da=0,m.j=0,m.v=0,m.va=m.width,m.o=m.height,m.da=0,m.ib=m.width,m.hb=m.height,m.U=m.width,m.T=m.height,i((G=d.Pa).jb,0,255,G.jb.length),e((G=d.Qa)!=null),G.Cb=0,G.Bb=0,G.Fb=1,i(G.Zb,0,0,G.Zb.length),i(G.Lb,0,0,G.Lb)}if(Q.ub>z)return Fn(d,7,"bad partition length");F(G=d.m,x,j,Q.ub),j+=Q.ub,z-=Q.ub,Q.Rb&&(J.Ld=he(G),J.Kd=he(G)),J=d.Qa;var ne,se=d.Pa;if(e(G!=null),e(J!=null),J.Cb=he(G),J.Cb){if(J.Bb=he(G),he(G)){for(J.Fb=he(G),ne=0;4>ne;++ne)J.Zb[ne]=he(G)?H(G,7):0;for(ne=0;4>ne;++ne)J.Lb[ne]=he(G)?H(G,6):0}if(J.Bb)for(ne=0;3>ne;++ne)se.jb[ne]=he(G)?X(G,8):255}else J.Bb=0;if(G.Ka)return Fn(d,3,"cannot parse segment header");if((J=d.ed).zd=he(G),J.Tb=X(G,6),J.wb=X(G,3),J.Pc=he(G),J.Pc&&he(G)){for(se=0;4>se;++se)he(G)&&(J.vd[se]=H(G,6));for(se=0;4>se;++se)he(G)&&(J.od[se]=H(G,6))}if(d.L=J.Tb==0?0:J.zd?1:2,G.Ka)return Fn(d,3,"cannot parse filter header");var fe=z;if(z=ne=j,j=ne+fe,J=fe,d.Xb=(1<<X(d.m,2))-1,fe<3*(se=d.Xb))x=7;else{for(ne+=3*se,J-=3*se,fe=0;fe<se;++fe){var Ne=x[z+0]|x[z+1]<<8|x[z+2]<<16;Ne>J&&(Ne=J),F(d.Jc[+fe],x,ne,Ne),ne+=Ne,J-=Ne,z+=3}F(d.Jc[+se],x,ne,J),x=ne<j?0:5}if(x!=0)return Fn(d,x,"cannot parse partitions");for(x=X(ne=d.m,7),z=he(ne)?H(ne,4):0,j=he(ne)?H(ne,4):0,J=he(ne)?H(ne,4):0,se=he(ne)?H(ne,4):0,ne=he(ne)?H(ne,4):0,fe=d.Qa,Ne=0;4>Ne;++Ne){if(fe.Cb){var ae=fe.Zb[Ne];fe.Fb||(ae+=x)}else{if(0<Ne){d.pb[Ne]=d.pb[0];continue}ae=x}var pe=d.pb[Ne];pe.Sc[0]=lg[Ot(ae+z,127)],pe.Sc[1]=cg[Ot(ae+0,127)],pe.Eb[0]=2*lg[Ot(ae+j,127)],pe.Eb[1]=101581*cg[Ot(ae+J,127)]>>16,8>pe.Eb[1]&&(pe.Eb[1]=8),pe.Qc[0]=lg[Ot(ae+se,117)],pe.Qc[1]=cg[Ot(ae+ne,127)],pe.lc=ae+ne}if(!Q.Rb)return Fn(d,4,"Not a key frame.");for(he(G),Q=d.Pa,x=0;4>x;++x){for(z=0;8>z;++z)for(j=0;3>j;++j)for(J=0;11>J;++J)se=we(G,vS[x][z][j][J])?X(G,8):pS[x][z][j][J],Q.Wc[x][z].Yb[j][J]=se;for(z=0;17>z;++z)Q.Xc[x][z]=Q.Wc[x][yS[z]]}return d.kc=he(G),d.kc&&(d.Bd=X(G,8)),d.cb=1}function Es(d,m,x,j,z,G,Q){var J=m[z].Yb[x];for(x=0;16>z;++z){if(!we(d,J[x+0]))return z;for(;!we(d,J[x+1]);)if(J=m[++z].Yb[0],x=0,z==16)return 16;var ne=m[z+1].Yb;if(we(d,J[x+2])){var se=d,fe=0;if(we(se,(ae=J)[(Ne=x)+3]))if(we(se,ae[Ne+6])){for(J=0,Ne=2*(fe=we(se,ae[Ne+8]))+(ae=we(se,ae[Ne+9+fe])),fe=0,ae=fS[Ne];ae[J];++J)fe+=fe+we(se,ae[J]);fe+=3+(8<<Ne)}else we(se,ae[Ne+7])?(fe=7+2*we(se,165),fe+=we(se,145)):fe=5+we(se,159);else fe=we(se,ae[Ne+4])?3+we(se,ae[Ne+5]):2;J=ne[2]}else fe=1,J=ne[1];ne=Q+mS[z],0>(se=d).b&&me(se);var Ne,ae=se.b,pe=(Ne=se.Ca>>1)-(se.I>>ae)>>31;--se.b,se.Ca+=pe,se.Ca|=1,se.I-=(Ne+1&pe)<<ae,G[ne]=((fe^pe)-pe)*j[(0<z)+0]}return 16}function Js(d){var m=d.rb[d.sb-1];m.la=0,m.Na=0,i(d.zc,0,0,d.zc.length),d.ja=0}function yi(d,m,x,j,z){z=d[m+x+32*j]+(z>>3),d[m+x+32*j]=-256&z?0>z?0:255:z}function Pa(d,m,x,j,z,G){yi(d,m,0,x,j+z),yi(d,m,1,x,j+G),yi(d,m,2,x,j-G),yi(d,m,3,x,j-z)}function on(d){return(20091*d>>16)+d}function ci(d,m,x,j){var z,G=0,Q=s(16);for(z=0;4>z;++z){var J=d[m+0]+d[m+8],ne=d[m+0]-d[m+8],se=(35468*d[m+4]>>16)-on(d[m+12]),fe=on(d[m+4])+(35468*d[m+12]>>16);Q[G+0]=J+fe,Q[G+1]=ne+se,Q[G+2]=ne-se,Q[G+3]=J-fe,G+=4,m++}for(z=G=0;4>z;++z)J=(d=Q[G+0]+4)+Q[G+8],ne=d-Q[G+8],se=(35468*Q[G+4]>>16)-on(Q[G+12]),yi(x,j,0,0,J+(fe=on(Q[G+4])+(35468*Q[G+12]>>16))),yi(x,j,1,0,ne+se),yi(x,j,2,0,ne-se),yi(x,j,3,0,J-fe),G++,j+=32}function yo(d,m,x,j){var z=d[m+0]+4,G=35468*d[m+4]>>16,Q=on(d[m+4]),J=35468*d[m+1]>>16;Pa(x,j,0,z+Q,d=on(d[m+1]),J),Pa(x,j,1,z+G,d,J),Pa(x,j,2,z-G,d,J),Pa(x,j,3,z-Q,d,J)}function xo(d,m,x,j,z){ci(d,m,x,j),z&&ci(d,m+16,x,j+4)}function Sc(d,m,x,j){$l(d,m+0,x,j,1),$l(d,m+32,x,j+128,1)}function Bt(d,m,x,j){var z;for(d=d[m+0]+4,z=0;4>z;++z)for(m=0;4>m;++m)yi(x,j,m,z,d)}function Ra(d,m,x,j){d[m+0]&&sn(d,m+0,x,j),d[m+16]&&sn(d,m+16,x,j+4),d[m+32]&&sn(d,m+32,x,j+128),d[m+48]&&sn(d,m+48,x,j+128+4)}function Zs(d,m,x,j){var z,G=s(16);for(z=0;4>z;++z){var Q=d[m+0+z]+d[m+12+z],J=d[m+4+z]+d[m+8+z],ne=d[m+4+z]-d[m+8+z],se=d[m+0+z]-d[m+12+z];G[0+z]=Q+J,G[8+z]=Q-J,G[4+z]=se+ne,G[12+z]=se-ne}for(z=0;4>z;++z)Q=(d=G[0+4*z]+3)+G[3+4*z],J=G[1+4*z]+G[2+4*z],ne=G[1+4*z]-G[2+4*z],se=d-G[3+4*z],x[j+0]=Q+J>>3,x[j+16]=se+ne>>3,x[j+32]=Q-J>>3,x[j+48]=se-ne>>3,j+=64}function xi(d,m,x){var j,z=m-32,G=Vi,Q=255-d[z-1];for(j=0;j<x;++j){var J,ne=G,se=Q+d[m-1];for(J=0;J<x;++J)d[m+J]=ne[se+d[z+J]];m+=32}}function Pl(d,m){xi(d,m,4)}function kc(d,m){xi(d,m,8)}function $u(d,m){xi(d,m,16)}function zu(d,m){var x;for(x=0;16>x;++x)r(d,m+32*x,d,m-32,16)}function Rl(d,m){var x;for(x=16;0<x;--x)i(d,m,d[m-1],16),m+=32}function La(d,m,x){var j;for(j=0;16>j;++j)i(m,x+32*j,d,16)}function bi(d,m){var x,j=16;for(x=0;16>x;++x)j+=d[m-1+32*x]+d[m+x-32];La(j>>5,d,m)}function is(d,m){var x,j=8;for(x=0;16>x;++x)j+=d[m-1+32*x];La(j>>4,d,m)}function ea(d,m){var x,j=8;for(x=0;16>x;++x)j+=d[m+x-32];La(j>>4,d,m)}function bo(d,m){La(128,d,m)}function bt(d,m,x){return d+2*m+x+2>>2}function ta(d,m){var x,j=m-32;for(j=new Uint8Array([bt(d[j-1],d[j+0],d[j+1]),bt(d[j+0],d[j+1],d[j+2]),bt(d[j+1],d[j+2],d[j+3]),bt(d[j+2],d[j+3],d[j+4])]),x=0;4>x;++x)r(d,m+32*x,j,0,j.length)}function qu(d,m){var x=d[m-1],j=d[m-1+32],z=d[m-1+64],G=d[m-1+96];Ee(d,m+0,16843009*bt(d[m-1-32],x,j)),Ee(d,m+32,16843009*bt(x,j,z)),Ee(d,m+64,16843009*bt(j,z,G)),Ee(d,m+96,16843009*bt(z,G,G))}function Hu(d,m){var x,j=4;for(x=0;4>x;++x)j+=d[m+x-32]+d[m-1+32*x];for(j>>=3,x=0;4>x;++x)i(d,m+32*x,j,4)}function Wu(d,m){var x=d[m-1+0],j=d[m-1+32],z=d[m-1+64],G=d[m-1-32],Q=d[m+0-32],J=d[m+1-32],ne=d[m+2-32],se=d[m+3-32];d[m+0+96]=bt(j,z,d[m-1+96]),d[m+1+96]=d[m+0+64]=bt(x,j,z),d[m+2+96]=d[m+1+64]=d[m+0+32]=bt(G,x,j),d[m+3+96]=d[m+2+64]=d[m+1+32]=d[m+0+0]=bt(Q,G,x),d[m+3+64]=d[m+2+32]=d[m+1+0]=bt(J,Q,G),d[m+3+32]=d[m+2+0]=bt(ne,J,Q),d[m+3+0]=bt(se,ne,J)}function kr(d,m){var x=d[m+1-32],j=d[m+2-32],z=d[m+3-32],G=d[m+4-32],Q=d[m+5-32],J=d[m+6-32],ne=d[m+7-32];d[m+0+0]=bt(d[m+0-32],x,j),d[m+1+0]=d[m+0+32]=bt(x,j,z),d[m+2+0]=d[m+1+32]=d[m+0+64]=bt(j,z,G),d[m+3+0]=d[m+2+32]=d[m+1+64]=d[m+0+96]=bt(z,G,Q),d[m+3+32]=d[m+2+64]=d[m+1+96]=bt(G,Q,J),d[m+3+64]=d[m+2+96]=bt(Q,J,ne),d[m+3+96]=bt(J,ne,ne)}function As(d,m){var x=d[m-1+0],j=d[m-1+32],z=d[m-1+64],G=d[m-1-32],Q=d[m+0-32],J=d[m+1-32],ne=d[m+2-32],se=d[m+3-32];d[m+0+0]=d[m+1+64]=G+Q+1>>1,d[m+1+0]=d[m+2+64]=Q+J+1>>1,d[m+2+0]=d[m+3+64]=J+ne+1>>1,d[m+3+0]=ne+se+1>>1,d[m+0+96]=bt(z,j,x),d[m+0+64]=bt(j,x,G),d[m+0+32]=d[m+1+96]=bt(x,G,Q),d[m+1+32]=d[m+2+96]=bt(G,Q,J),d[m+2+32]=d[m+3+96]=bt(Q,J,ne),d[m+3+32]=bt(J,ne,se)}function Gu(d,m){var x=d[m+0-32],j=d[m+1-32],z=d[m+2-32],G=d[m+3-32],Q=d[m+4-32],J=d[m+5-32],ne=d[m+6-32],se=d[m+7-32];d[m+0+0]=x+j+1>>1,d[m+1+0]=d[m+0+64]=j+z+1>>1,d[m+2+0]=d[m+1+64]=z+G+1>>1,d[m+3+0]=d[m+2+64]=G+Q+1>>1,d[m+0+32]=bt(x,j,z),d[m+1+32]=d[m+0+96]=bt(j,z,G),d[m+2+32]=d[m+1+96]=bt(z,G,Q),d[m+3+32]=d[m+2+96]=bt(G,Q,J),d[m+3+64]=bt(Q,J,ne),d[m+3+96]=bt(J,ne,se)}function wo(d,m){var x=d[m-1+0],j=d[m-1+32],z=d[m-1+64],G=d[m-1+96];d[m+0+0]=x+j+1>>1,d[m+2+0]=d[m+0+32]=j+z+1>>1,d[m+2+32]=d[m+0+64]=z+G+1>>1,d[m+1+0]=bt(x,j,z),d[m+3+0]=d[m+1+32]=bt(j,z,G),d[m+3+32]=d[m+1+64]=bt(z,G,G),d[m+3+64]=d[m+2+64]=d[m+0+96]=d[m+1+96]=d[m+2+96]=d[m+3+96]=G}function Ss(d,m){var x=d[m-1+0],j=d[m-1+32],z=d[m-1+64],G=d[m-1+96],Q=d[m-1-32],J=d[m+0-32],ne=d[m+1-32],se=d[m+2-32];d[m+0+0]=d[m+2+32]=x+Q+1>>1,d[m+0+32]=d[m+2+64]=j+x+1>>1,d[m+0+64]=d[m+2+96]=z+j+1>>1,d[m+0+96]=G+z+1>>1,d[m+3+0]=bt(J,ne,se),d[m+2+0]=bt(Q,J,ne),d[m+1+0]=d[m+3+32]=bt(x,Q,J),d[m+1+32]=d[m+3+64]=bt(j,x,Q),d[m+1+64]=d[m+3+96]=bt(z,j,x),d[m+1+96]=bt(G,z,j)}function No(d,m){var x;for(x=0;8>x;++x)r(d,m+32*x,d,m-32,8)}function Di(d,m){var x;for(x=0;8>x;++x)i(d,m,d[m-1],8),m+=32}function ss(d,m,x){var j;for(j=0;8>j;++j)i(m,x+32*j,d,8)}function Da(d,m){var x,j=8;for(x=0;8>x;++x)j+=d[m+x-32]+d[m-1+32*x];ss(j>>4,d,m)}function Ll(d,m){var x,j=4;for(x=0;8>x;++x)j+=d[m+x-32];ss(j>>3,d,m)}function gn(d,m){var x,j=4;for(x=0;8>x;++x)j+=d[m-1+32*x];ss(j>>3,d,m)}function Dl(d,m){ss(128,d,m)}function Oa(d,m,x){var j=d[m-x],z=d[m+0],G=3*(z-j)+rg[1020+d[m-2*x]-d[m+x]],Q=qh[112+(G+4>>3)];d[m-x]=Vi[255+j+qh[112+(G+3>>3)]],d[m+0]=Vi[255+z-Q]}function na(d,m,x,j){var z=d[m+0],G=d[m+x];return ls[255+d[m-2*x]-d[m-x]]>j||ls[255+G-z]>j}function _o(d,m,x,j){return 4*ls[255+d[m-x]-d[m+0]]+ls[255+d[m-2*x]-d[m+x]]<=j}function Ma(d,m,x,j,z){var G=d[m-3*x],Q=d[m-2*x],J=d[m-x],ne=d[m+0],se=d[m+x],fe=d[m+2*x],Ne=d[m+3*x];return 4*ls[255+J-ne]+ls[255+Q-se]>j?0:ls[255+d[m-4*x]-G]<=z&&ls[255+G-Q]<=z&&ls[255+Q-J]<=z&&ls[255+Ne-fe]<=z&&ls[255+fe-se]<=z&&ls[255+se-ne]<=z}function ra(d,m,x,j){var z=2*j+1;for(j=0;16>j;++j)_o(d,m+j,x,z)&&Oa(d,m+j,x)}function ia(d,m,x,j){var z=2*j+1;for(j=0;16>j;++j)_o(d,m+j*x,1,z)&&Oa(d,m+j*x,1)}function wi(d,m,x,j){var z;for(z=3;0<z;--z)ra(d,m+=4*x,x,j)}function Ol(d,m,x,j){var z;for(z=3;0<z;--z)ia(d,m+=4,x,j)}function ks(d,m,x,j,z,G,Q,J){for(G=2*G+1;0<z--;){if(Ma(d,m,x,G,Q))if(na(d,m,x,J))Oa(d,m,x);else{var ne=d,se=m,fe=x,Ne=ne[se-2*fe],ae=ne[se-fe],pe=ne[se+0],ye=ne[se+fe],Ae=ne[se+2*fe],be=27*(je=rg[1020+3*(pe-ae)+rg[1020+Ne-ye]])+63>>7,Te=18*je+63>>7,je=9*je+63>>7;ne[se-3*fe]=Vi[255+ne[se-3*fe]+je],ne[se-2*fe]=Vi[255+Ne+Te],ne[se-fe]=Vi[255+ae+be],ne[se+0]=Vi[255+pe-be],ne[se+fe]=Vi[255+ye-Te],ne[se+2*fe]=Vi[255+Ae-je]}m+=j}}function ui(d,m,x,j,z,G,Q,J){for(G=2*G+1;0<z--;){if(Ma(d,m,x,G,Q))if(na(d,m,x,J))Oa(d,m,x);else{var ne=d,se=m,fe=x,Ne=ne[se-fe],ae=ne[se+0],pe=ne[se+fe],ye=qh[112+(4+(Ae=3*(ae-Ne))>>3)],Ae=qh[112+(Ae+3>>3)],be=ye+1>>1;ne[se-2*fe]=Vi[255+ne[se-2*fe]+be],ne[se-fe]=Vi[255+Ne+Ae],ne[se+0]=Vi[255+ae-ye],ne[se+fe]=Vi[255+pe-be]}m+=j}}function Ml(d,m,x,j,z,G){ks(d,m,x,1,16,j,z,G)}function Eo(d,m,x,j,z,G){ks(d,m,1,x,16,j,z,G)}function as(d,m,x,j,z,G){var Q;for(Q=3;0<Q;--Q)ui(d,m+=4*x,x,1,16,j,z,G)}function Fl(d,m,x,j,z,G){var Q;for(Q=3;0<Q;--Q)ui(d,m+=4,1,x,16,j,z,G)}function y(d,m,x,j,z,G,Q,J){ks(d,m,z,1,8,G,Q,J),ks(x,j,z,1,8,G,Q,J)}function $(d,m,x,j,z,G,Q,J){ks(d,m,1,z,8,G,Q,J),ks(x,j,1,z,8,G,Q,J)}function ie(d,m,x,j,z,G,Q,J){ui(d,m+4*z,z,1,8,G,Q,J),ui(x,j+4*z,z,1,8,G,Q,J)}function de(d,m,x,j,z,G,Q,J){ui(d,m+4,1,z,8,G,Q,J),ui(x,j+4,1,z,8,G,Q,J)}function ge(){this.ba=new nn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Mt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ke(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ie(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function We(){this.ua=0,this.Wa=new dt,this.vb=new dt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new K,this.yc=new _}function Xe(){this.xb=this.a=0,this.l=new Xs,this.ca=new nn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new P,this.Pb=0,this.wd=new P,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new We,this.ab=0,this.gc=o(4,Ie),this.Oc=0}function vt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Xs,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function _t(d,m,x,j,z,G,Q){for(d=d==null?0:d[m+0],m=0;m<Q;++m)z[G+m]=d+x[j+m]&255,d=z[G+m]}function Yt(d,m,x,j,z,G,Q){var J;if(d==null)_t(null,null,x,j,z,G,Q);else for(J=0;J<Q;++J)z[G+J]=d[m+J]+x[j+J]&255}function rn(d,m,x,j,z,G,Q){if(d==null)_t(null,null,x,j,z,G,Q);else{var J,ne=d[m+0],se=ne,fe=ne;for(J=0;J<Q;++J)se=fe+(ne=d[m+J])-se,fe=x[j+J]+(-256&se?0>se?0:255:se)&255,se=ne,z[G+J]=fe}}function Un(d,m,x,j){var z=m.width,G=m.o;if(e(d!=null&&m!=null),0>x||0>=j||x+j>G)return null;if(!d.Cc){if(d.ga==null){var Q;if(d.ga=new vt,(Q=d.ga==null)||(Q=m.width*m.o,e(d.Gb.length==0),d.Gb=s(Q),d.Uc=0,d.Gb==null?Q=0:(d.mb=d.Gb,d.nb=d.Uc,d.rc=null,Q=1),Q=!Q),!Q){Q=d.ga;var J=d.Fa,ne=d.P,se=d.qc,fe=d.mb,Ne=d.nb,ae=ne+1,pe=se-1,ye=Q.l;if(e(J!=null&&fe!=null&&m!=null),Ro[0]=null,Ro[1]=_t,Ro[2]=Yt,Ro[3]=rn,Q.ca=fe,Q.tb=Ne,Q.c=m.width,Q.i=m.height,e(0<Q.c&&0<Q.i),1>=se)m=0;else if(Q.$a=3&J[ne+0],Q.Z=J[ne+0]>>2&3,Q.Lc=J[ne+0]>>4&3,ne=J[ne+0]>>6&3,0>Q.$a||1<Q.$a||4<=Q.Z||1<Q.Lc||ne)m=0;else if(ye.put=pt,ye.ac=qr,ye.bc=kn,ye.ma=Q,ye.width=m.width,ye.height=m.height,ye.Da=m.Da,ye.v=m.v,ye.va=m.va,ye.j=m.j,ye.o=m.o,Q.$a)e:{e(Q.$a==1),m=Ks();t:for(;;){if(m==null){m=0;break e}if(e(Q!=null),Q.mc=m,m.c=Q.c,m.i=Q.i,m.l=Q.l,m.l.ma=Q,m.l.width=Q.c,m.l.height=Q.i,m.a=0,W(m.m,J,ae,pe),!Ri(Q.c,Q.i,1,m,null)||(m.ab==1&&m.gc[0].hc==3&&Hr(m.s)?(Q.ic=1,J=m.c*m.i,m.Ta=null,m.Ua=0,m.V=s(J),m.Ba=0,m.V==null?(m.a=1,m=0):m=1):(Q.ic=0,m=_s(m,Q.c)),!m))break t;m=1;break e}Q.mc=null,m=0}else m=pe>=Q.c*Q.i;Q=!m}if(Q)return null;d.ga.Lc!=1?d.Ga=0:j=G-x}e(d.ga!=null),e(x+j<=G);e:{if(m=(J=d.ga).c,G=J.l.o,J.$a==0){if(ae=d.rc,pe=d.Vc,ye=d.Fa,ne=d.P+1+x*m,se=d.mb,fe=d.nb+x*m,e(ne<=d.P+d.qc),J.Z!=0)for(e(Ro[J.Z]!=null),Q=0;Q<j;++Q)Ro[J.Z](ae,pe,ye,ne,se,fe,m),ae=se,pe=fe,fe+=m,ne+=m;else for(Q=0;Q<j;++Q)r(se,fe,ye,ne,m),ae=se,pe=fe,fe+=m,ne+=m;d.rc=ae,d.Vc=pe}else{if(e(J.mc!=null),m=x+j,e((Q=J.mc)!=null),e(m<=Q.i),Q.C>=m)m=1;else if(J.ic||wn(),J.ic){J=Q.V,ae=Q.Ba,pe=Q.c;var Ae=Q.i,be=(ye=1,ne=Q.$/pe,se=Q.$%pe,fe=Q.m,Ne=Q.s,Q.$),Te=pe*Ae,je=pe*m,Me=Ne.wc,Pe=be<je?Dn(Ne,se,ne):null;e(be<=Te),e(m<=Ae),e(Hr(Ne));t:for(;;){for(;!fe.h&&be<je;){if(se&Me||(Pe=Dn(Ne,se,ne)),e(Pe!=null),ce(fe),256>(Ae=Ln(Pe.G[0],Pe.H[0],fe)))J[ae+be]=Ae,++be,++se>=pe&&(se=0,++ne<=m&&!(ne%16)&&li(Q,ne));else{if(!(280>Ae)){ye=0;break t}Ae=Er(Ae-256,fe);var at,Ke=Ln(Pe.G[4],Pe.H[4],fe);if(ce(fe),!(be>=(Ke=Ar(pe,Ke=Er(Ke,fe)))&&Te-be>=Ae)){ye=0;break t}for(at=0;at<Ae;++at)J[ae+be+at]=J[ae+be+at-Ke];for(be+=Ae,se+=Ae;se>=pe;)se-=pe,++ne<=m&&!(ne%16)&&li(Q,ne);be<je&&se&Me&&(Pe=Dn(Ne,se,ne))}e(fe.h==te(fe))}li(Q,ne>m?m:ne);break t}!ye||fe.h&&be<Te?(ye=0,Q.a=fe.h?5:3):Q.$=be,m=ye}else m=Wr(Q,Q.V,Q.Ba,Q.c,Q.i,m,Ys);if(!m){j=0;break e}}x+j>=G&&(d.Cc=1),j=1}if(!j)return null;if(d.Cc&&((j=d.ga)!=null&&(j.mc=null),d.ga=null,0<d.Ga))return alert("todo:WebPDequantizeLevels"),null}return d.nb+x*z}function ln(d,m,x,j,z,G){for(;0<z--;){var Q,J=d,ne=m+(x?1:0),se=d,fe=m+(x?0:3);for(Q=0;Q<j;++Q){var Ne=se[fe+4*Q];Ne!=255&&(Ne*=32897,J[ne+4*Q+0]=J[ne+4*Q+0]*Ne>>23,J[ne+4*Q+1]=J[ne+4*Q+1]*Ne>>23,J[ne+4*Q+2]=J[ne+4*Q+2]*Ne>>23)}m+=G}}function Wn(d,m,x,j,z){for(;0<j--;){var G;for(G=0;G<x;++G){var Q=d[m+2*G+0],J=15&(se=d[m+2*G+1]),ne=4369*J,se=(240&se|se>>4)*ne>>16;d[m+2*G+0]=(240&Q|Q>>4)*ne>>16&240|(15&Q|Q<<4)*ne>>16>>4&15,d[m+2*G+1]=240&se|J}m+=z}}function Vn(d,m,x,j,z,G,Q,J){var ne,se,fe=255;for(se=0;se<z;++se){for(ne=0;ne<j;++ne){var Ne=d[m+ne];G[Q+4*ne]=Ne,fe&=Ne}m+=x,Q+=J}return fe!=255}function Gn(d,m,x,j,z){var G;for(G=0;G<z;++G)x[j+G]=d[m+G]>>8}function wn(){nd=ln,o2=Wn,l2=Vn,c2=Gn}function Pr(d,m,x){N[d]=function(j,z,G,Q,J,ne,se,fe,Ne,ae,pe,ye,Ae,be,Te,je,Me){var Pe,at=Me-1>>1,Ke=J[ne+0]|se[fe+0]<<16,Rt=Ne[ae+0]|pe[ye+0]<<16;e(j!=null);var et=3*Ke+Rt+131074>>2;for(m(j[z+0],255&et,et>>16,Ae,be),G!=null&&(et=3*Rt+Ke+131074>>2,m(G[Q+0],255&et,et>>16,Te,je)),Pe=1;Pe<=at;++Pe){var Ht=J[ne+Pe]|se[fe+Pe]<<16,yr=Ne[ae+Pe]|pe[ye+Pe]<<16,Lt=Ke+Ht+Rt+yr+524296,tt=Lt+2*(Ht+Rt)>>3;et=tt+Ke>>1,Ke=(Lt=Lt+2*(Ke+yr)>>3)+Ht>>1,m(j[z+2*Pe-1],255&et,et>>16,Ae,be+(2*Pe-1)*x),m(j[z+2*Pe-0],255&Ke,Ke>>16,Ae,be+(2*Pe-0)*x),G!=null&&(et=Lt+Rt>>1,Ke=tt+yr>>1,m(G[Q+2*Pe-1],255&et,et>>16,Te,je+(2*Pe-1)*x),m(G[Q+2*Pe+0],255&Ke,Ke>>16,Te,je+(2*Pe+0)*x)),Ke=Ht,Rt=yr}1&Me||(et=3*Ke+Rt+131074>>2,m(j[z+Me-1],255&et,et>>16,Ae,be+(Me-1)*x),G!=null&&(et=3*Rt+Ke+131074>>2,m(G[Q+Me-1],255&et,et>>16,Te,je+(Me-1)*x)))}}function Ul(){cs[Hh]=bS,cs[Wh]=b2,cs[p2]=wS,cs[Gh]=w2,cs[Kh]=N2,cs[ig]=_2,cs[g2]=NS,cs[sg]=b2,cs[ag]=w2,cs[Yh]=N2,cs[og]=_2}function Oi(d){return d&-16384?0>d?0:255:d>>_S}function h(d,m){return Oi((19077*d>>8)+(26149*m>>8)-14234)}function w(d,m,x){return Oi((19077*d>>8)-(6419*m>>8)-(13320*x>>8)+8708)}function O(d,m){return Oi((19077*d>>8)+(33050*m>>8)-17685)}function Z(d,m,x,j,z){j[z+0]=h(d,x),j[z+1]=w(d,m,x),j[z+2]=O(d,m)}function ve(d,m,x,j,z){j[z+0]=O(d,m),j[z+1]=w(d,m,x),j[z+2]=h(d,x)}function _e(d,m,x,j,z){var G=w(d,m,x);m=G<<3&224|O(d,m)>>3,j[z+0]=248&h(d,x)|G>>5,j[z+1]=m}function Be(d,m,x,j,z){var G=240&O(d,m)|15;j[z+0]=240&h(d,x)|w(d,m,x)>>4,j[z+1]=G}function qt(d,m,x,j,z){j[z+0]=255,Z(d,m,x,j,z+1)}function Bn(d,m,x,j,z){ve(d,m,x,j,z),j[z+3]=255}function Ft(d,m,x,j,z){Z(d,m,x,j,z),j[z+3]=255}function Ot(d,m){return 0>d?0:d>m?m:d}function Nn(d,m,x){N[d]=function(j,z,G,Q,J,ne,se,fe,Ne){for(var ae=fe+(-2&Ne)*x;fe!=ae;)m(j[z+0],G[Q+0],J[ne+0],se,fe),m(j[z+1],G[Q+0],J[ne+0],se,fe+x),z+=2,++Q,++ne,fe+=2*x;1&Ne&&m(j[z+0],G[Q+0],J[ne+0],se,fe)}}function Mi(d,m,x){return x==0?d==0?m==0?6:5:m==0?4:0:x}function Gr(d,m,x,j,z){switch(d>>>30){case 3:$l(m,x,j,z,0);break;case 2:os(m,x,j,z);break;case 1:sn(m,x,j,z)}}function Rr(d,m){var x,j,z=m.M,G=m.Nb,Q=d.oc,J=d.pc+40,ne=d.oc,se=d.pc+584,fe=d.oc,Ne=d.pc+600;for(x=0;16>x;++x)Q[J+32*x-1]=129;for(x=0;8>x;++x)ne[se+32*x-1]=129,fe[Ne+32*x-1]=129;for(0<z?Q[J-1-32]=ne[se-1-32]=fe[Ne-1-32]=129:(i(Q,J-32-1,127,21),i(ne,se-32-1,127,9),i(fe,Ne-32-1,127,9)),j=0;j<d.za;++j){var ae=m.ya[m.aa+j];if(0<j){for(x=-1;16>x;++x)r(Q,J+32*x-4,Q,J+32*x+12,4);for(x=-1;8>x;++x)r(ne,se+32*x-4,ne,se+32*x+4,4),r(fe,Ne+32*x-4,fe,Ne+32*x+4,4)}var pe=d.Gd,ye=d.Hd+j,Ae=ae.ad,be=ae.Hc;if(0<z&&(r(Q,J-32,pe[ye].y,0,16),r(ne,se-32,pe[ye].f,0,8),r(fe,Ne-32,pe[ye].ea,0,8)),ae.Za){var Te=Q,je=J-32+16;for(0<z&&(j>=d.za-1?i(Te,je,pe[ye].y[15],4):r(Te,je,pe[ye+1].y,0,4)),x=0;4>x;x++)Te[je+128+x]=Te[je+256+x]=Te[je+384+x]=Te[je+0+x];for(x=0;16>x;++x,be<<=2)Te=Q,je=J+A2[x],js[ae.Ob[x]](Te,je),Gr(be,Ae,16*+x,Te,je)}else if(Te=Mi(j,z,ae.Ob[0]),Po[Te](Q,J),be!=0)for(x=0;16>x;++x,be<<=2)Gr(be,Ae,16*+x,Q,J+A2[x]);for(x=ae.Gc,Te=Mi(j,z,ae.Dd),Va[Te](ne,se),Va[Te](fe,Ne),be=Ae,Te=ne,je=se,255&(ae=0|x)&&(170&ae?oa(be,256,Te,je):vn(be,256,Te,je)),ae=fe,be=Ne,255&(x>>=8)&&(170&x?oa(Ae,320,ae,be):vn(Ae,320,ae,be)),z<d.Ub-1&&(r(pe[ye].y,0,Q,J+480,16),r(pe[ye].f,0,ne,se+224,8),r(pe[ye].ea,0,fe,Ne+224,8)),x=8*G*d.B,pe=d.sa,ye=d.ta+16*j+16*G*d.R,Ae=d.qa,ae=d.ra+8*j+x,be=d.Ha,Te=d.Ia+8*j+x,x=0;16>x;++x)r(pe,ye+x*d.R,Q,J+32*x,16);for(x=0;8>x;++x)r(Ae,ae+x*d.B,ne,se+32*x,8),r(be,Te+x*d.B,fe,Ne+32*x,8)}}function Ts(d,m,x,j,z,G,Q,J,ne){var se=[0],fe=[0],Ne=0,ae=ne!=null?ne.kd:0,pe=ne??new ke;if(d==null||12>x)return 7;pe.data=d,pe.w=m,pe.ha=x,m=[m],x=[x],pe.gb=[pe.gb];e:{var ye=m,Ae=x,be=pe.gb;if(e(d!=null),e(Ae!=null),e(be!=null),be[0]=0,12<=Ae[0]&&!n(d,ye[0],"RIFF")){if(n(d,ye[0]+8,"WEBP")){be=3;break e}var Te=xe(d,ye[0]+4);if(12>Te||4294967286<Te){be=3;break e}if(ae&&Te>Ae[0]-8){be=7;break e}be[0]=Te,ye[0]+=12,Ae[0]-=12}be=0}if(be!=0)return be;for(Te=0<pe.gb[0],x=x[0];;){e:{var je=d;Ae=m,be=x;var Me=se,Pe=fe,at=ye=[0];if((et=Ne=[Ne])[0]=0,8>be[0])be=7;else{if(!n(je,Ae[0],"VP8X")){if(xe(je,Ae[0]+4)!=10){be=3;break e}if(18>be[0]){be=7;break e}var Ke=xe(je,Ae[0]+8),Rt=1+Re(je,Ae[0]+12);if(2147483648<=Rt*(je=1+Re(je,Ae[0]+15))){be=3;break e}at!=null&&(at[0]=Ke),Me!=null&&(Me[0]=Rt),Pe!=null&&(Pe[0]=je),Ae[0]+=18,be[0]-=18,et[0]=1}be=0}}if(Ne=Ne[0],ye=ye[0],be!=0)return be;if(Ae=!!(2&ye),!Te&&Ne)return 3;if(G!=null&&(G[0]=!!(16&ye)),Q!=null&&(Q[0]=Ae),J!=null&&(J[0]=0),Q=se[0],ye=fe[0],Ne&&Ae&&ne==null){be=0;break}if(4>x){be=7;break}if(Te&&Ne||!Te&&!Ne&&!n(d,m[0],"ALPH")){x=[x],pe.na=[pe.na],pe.P=[pe.P],pe.Sa=[pe.Sa];e:{Ke=d,be=m,Te=x;var et=pe.gb;Me=pe.na,Pe=pe.P,at=pe.Sa,Rt=22,e(Ke!=null),e(Te!=null),je=be[0];var Ht=Te[0];for(e(Me!=null),e(at!=null),Me[0]=null,Pe[0]=null,at[0]=0;;){if(be[0]=je,Te[0]=Ht,8>Ht){be=7;break e}var yr=xe(Ke,je+4);if(4294967286<yr){be=3;break e}var Lt=8+yr+1&-2;if(Rt+=Lt,0<et&&Rt>et){be=3;break e}if(!n(Ke,je,"VP8 ")||!n(Ke,je,"VP8L")){be=0;break e}if(Ht[0]<Lt){be=7;break e}n(Ke,je,"ALPH")||(Me[0]=Ke,Pe[0]=je+8,at[0]=yr),je+=Lt,Ht-=Lt}}if(x=x[0],pe.na=pe.na[0],pe.P=pe.P[0],pe.Sa=pe.Sa[0],be!=0)break}x=[x],pe.Ja=[pe.Ja],pe.xa=[pe.xa];e:if(et=d,be=m,Te=x,Me=pe.gb[0],Pe=pe.Ja,at=pe.xa,Ke=be[0],je=!n(et,Ke,"VP8 "),Rt=!n(et,Ke,"VP8L"),e(et!=null),e(Te!=null),e(Pe!=null),e(at!=null),8>Te[0])be=7;else{if(je||Rt){if(et=xe(et,Ke+4),12<=Me&&et>Me-12){be=3;break e}if(ae&&et>Te[0]-8){be=7;break e}Pe[0]=et,be[0]+=8,Te[0]-=8,at[0]=Rt}else at[0]=5<=Te[0]&&et[Ke+0]==47&&!(et[Ke+4]>>5),Pe[0]=Te[0];be=0}if(x=x[0],pe.Ja=pe.Ja[0],pe.xa=pe.xa[0],m=m[0],be!=0)break;if(4294967286<pe.Ja)return 3;if(J==null||Ae||(J[0]=pe.xa?2:1),Q=[Q],ye=[ye],pe.xa){if(5>x){be=7;break}J=Q,ae=ye,Ae=G,d==null||5>x?d=0:5<=x&&d[m+0]==47&&!(d[m+4]>>5)?(Te=[0],et=[0],Me=[0],W(Pe=new P,d,m,x),rs(Pe,Te,et,Me)?(J!=null&&(J[0]=Te[0]),ae!=null&&(ae[0]=et[0]),Ae!=null&&(Ae[0]=Me[0]),d=1):d=0):d=0}else{if(10>x){be=7;break}J=ye,d==null||10>x||!Il(d,m+3,x-3)?d=0:(ae=d[m+0]|d[m+1]<<8|d[m+2]<<16,Ae=16383&(d[m+7]<<8|d[m+6]),d=16383&(d[m+9]<<8|d[m+8]),1&ae||3<(ae>>1&7)||!(ae>>4&1)||ae>>5>=pe.Ja||!Ae||!d?d=0:(Q&&(Q[0]=Ae),J&&(J[0]=d),d=1))}if(!d||(Q=Q[0],ye=ye[0],Ne&&(se[0]!=Q||fe[0]!=ye)))return 3;ne!=null&&(ne[0]=pe,ne.offset=m-ne.w,e(4294967286>m-ne.w),e(ne.offset==ne.ha-x));break}return be==0||be==7&&Ne&&ne==null?(G!=null&&(G[0]|=pe.na!=null&&0<pe.na.length),j!=null&&(j[0]=Q),z!=null&&(z[0]=ye),0):be}function Ku(d,m,x){var j=m.width,z=m.height,G=0,Q=0,J=j,ne=z;if(m.Da=d!=null&&0<d.Da,m.Da&&(J=d.cd,ne=d.bd,G=d.v,Q=d.j,11>x||(G&=-2,Q&=-2),0>G||0>Q||0>=J||0>=ne||G+J>j||Q+ne>z))return 0;if(m.v=G,m.j=Q,m.va=G+J,m.o=Q+ne,m.U=J,m.T=ne,m.da=d!=null&&0<d.da,m.da){if(!lt(J,ne,x=[d.ib],G=[d.hb]))return 0;m.ib=x[0],m.hb=G[0]}return m.ob=d!=null&&d.ob,m.Kb=d==null||!d.Sd,m.da&&(m.ob=m.ib<3*j/4&&m.hb<3*z/4,m.Kb=0),1}function Yu(d){if(d==null)return 2;if(11>d.S){var m=d.f.RGBA;m.fb+=(d.height-1)*m.A,m.A=-m.A}else m=d.f.kb,d=d.height,m.O+=(d-1)*m.fa,m.fa=-m.fa,m.N+=(d-1>>1)*m.Ab,m.Ab=-m.Ab,m.W+=(d-1>>1)*m.Db,m.Db=-m.Db,m.F!=null&&(m.J+=(d-1)*m.lb,m.lb=-m.lb);return 0}function Ao(d,m,x,j){if(j==null||0>=d||0>=m)return 2;if(x!=null){if(x.Da){var z=x.cd,G=x.bd,Q=-2&x.v,J=-2&x.j;if(0>Q||0>J||0>=z||0>=G||Q+z>d||J+G>m)return 2;d=z,m=G}if(x.da){if(!lt(d,m,z=[x.ib],G=[x.hb]))return 2;d=z[0],m=G[0]}}j.width=d,j.height=m;e:{var ne=j.width,se=j.height;if(d=j.S,0>=ne||0>=se||!(d>=Hh&&13>d))d=2;else{if(0>=j.Rd&&j.sd==null){Q=G=z=m=0;var fe=(J=ne*S2[d])*se;if(11>d||(G=(se+1)/2*(m=(ne+1)/2),d==12&&(Q=(z=ne)*se)),(se=s(fe+2*G+Q))==null){d=1;break e}j.sd=se,11>d?((ne=j.f.RGBA).eb=se,ne.fb=0,ne.A=J,ne.size=fe):((ne=j.f.kb).y=se,ne.O=0,ne.fa=J,ne.Fd=fe,ne.f=se,ne.N=0+fe,ne.Ab=m,ne.Cd=G,ne.ea=se,ne.W=0+fe+G,ne.Db=m,ne.Ed=G,d==12&&(ne.F=se,ne.J=0+fe+2*G),ne.Tc=Q,ne.lb=z)}if(m=1,z=j.S,G=j.width,Q=j.height,z>=Hh&&13>z)if(11>z)d=j.f.RGBA,m&=(J=Math.abs(d.A))*(Q-1)+G<=d.size,m&=J>=G*S2[z],m&=d.eb!=null;else{d=j.f.kb,J=(G+1)/2,fe=(Q+1)/2,ne=Math.abs(d.fa),se=Math.abs(d.Ab);var Ne=Math.abs(d.Db),ae=Math.abs(d.lb),pe=ae*(Q-1)+G;m&=ne*(Q-1)+G<=d.Fd,m&=se*(fe-1)+J<=d.Cd,m=(m&=Ne*(fe-1)+J<=d.Ed)&ne>=G&se>=J&Ne>=J,m&=d.y!=null,m&=d.f!=null,m&=d.ea!=null,z==12&&(m&=ae>=G,m&=pe<=d.Tc,m&=d.F!=null)}else m=0;d=m?0:2}}return d!=0||x!=null&&x.fd&&(d=Yu(j)),d}var Vl=64,Fi=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ui=24,So=32,Fa=8,ko=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Se("Predictor0","PredictorAdd0"),N.Predictor0=function(){return 4278190080},N.Predictor1=function(d){return d},N.Predictor2=function(d,m,x){return m[x+0]},N.Predictor3=function(d,m,x){return m[x+1]},N.Predictor4=function(d,m,x){return m[x-1]},N.Predictor5=function(d,m,x){return it(it(d,m[x+1]),m[x+0])},N.Predictor6=function(d,m,x){return it(d,m[x-1])},N.Predictor7=function(d,m,x){return it(d,m[x+0])},N.Predictor8=function(d,m,x){return it(m[x-1],m[x+0])},N.Predictor9=function(d,m,x){return it(m[x+0],m[x+1])},N.Predictor10=function(d,m,x){return it(it(d,m[x-1]),it(m[x+0],m[x+1]))},N.Predictor11=function(d,m,x){var j=m[x+0];return 0>=nt(j>>24&255,d>>24&255,(m=m[x-1])>>24&255)+nt(j>>16&255,d>>16&255,m>>16&255)+nt(j>>8&255,d>>8&255,m>>8&255)+nt(255&j,255&d,255&m)?j:d},N.Predictor12=function(d,m,x){var j=m[x+0];return(zt((d>>24&255)+(j>>24&255)-((m=m[x-1])>>24&255))<<24|zt((d>>16&255)+(j>>16&255)-(m>>16&255))<<16|zt((d>>8&255)+(j>>8&255)-(m>>8&255))<<8|zt((255&d)+(255&j)-(255&m)))>>>0},N.Predictor13=function(d,m,x){var j=m[x-1];return(At((d=it(d,m[x+0]))>>24&255,j>>24&255)<<24|At(d>>16&255,j>>16&255)<<16|At(d>>8&255,j>>8&255)<<8|At(255&d,255&j))>>>0};var Qu=N.PredictorAdd0;N.PredictorAdd1=Tt,Se("Predictor2","PredictorAdd2"),Se("Predictor3","PredictorAdd3"),Se("Predictor4","PredictorAdd4"),Se("Predictor5","PredictorAdd5"),Se("Predictor6","PredictorAdd6"),Se("Predictor7","PredictorAdd7"),Se("Predictor8","PredictorAdd8"),Se("Predictor9","PredictorAdd9"),Se("Predictor10","PredictorAdd10"),Se("Predictor11","PredictorAdd11"),Se("Predictor12","PredictorAdd12"),Se("Predictor13","PredictorAdd13");var Tc=N.PredictorAdd2;ct("ColorIndexInverseTransform","MapARGB","32b",function(d){return d>>8&255},function(d){return d}),ct("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(d){return d},function(d){return d>>8&255});var er,$h=N.ColorIndexInverseTransform,sa=N.MapARGB,aa=N.VP8LColorIndexInverseTransformAlpha,Xu=N.MapAlpha,Ju=N.VP8LPredictorsAdd=[];Ju.length=16,(N.VP8LPredictors=[]).length=16,(N.VP8LPredictorsAdd_C=[]).length=16,(N.VP8LPredictors_C=[]).length=16;var Zu,ed,To,jo,Co,Bl,Io,$l,os,oa,sn,vn,tr,vr,Ua,td,jc,zh,t2,n2,r2,i2,s2,a2,nd,o2,l2,c2,u2=s(511),d2=s(2041),h2=s(225),f2=s(767),m2=0,rg=d2,qh=h2,Vi=f2,ls=u2,Hh=0,Wh=1,p2=2,Gh=3,Kh=4,ig=5,g2=6,sg=7,ag=8,Yh=9,og=10,aS=[2,3,7],oS=[3,3,11],v2=[280,256,256,256,40],lS=[0,1,1,1,0],cS=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],uS=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],dS=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],hS=8,lg=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],cg=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],rd=null,fS=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],mS=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],y2=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],pS=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],gS=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],vS=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],yS=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Po=[],js=[],Va=[],xS=1,x2=2,Ro=[],cs=[];Pr("UpsampleRgbLinePair",Z,3),Pr("UpsampleBgrLinePair",ve,3),Pr("UpsampleRgbaLinePair",Ft,4),Pr("UpsampleBgraLinePair",Bn,4),Pr("UpsampleArgbLinePair",qt,4),Pr("UpsampleRgba4444LinePair",Be,2),Pr("UpsampleRgb565LinePair",_e,2);var bS=N.UpsampleRgbLinePair,wS=N.UpsampleBgrLinePair,b2=N.UpsampleRgbaLinePair,w2=N.UpsampleBgraLinePair,N2=N.UpsampleArgbLinePair,_2=N.UpsampleRgba4444LinePair,NS=N.UpsampleRgb565LinePair,Qh=16,Xh=1<<Qh-1,id=-227,ug=482,_S=6,E2=0,ES=s(256),AS=s(256),SS=s(256),kS=s(256),TS=s(ug-id),jS=s(ug-id);Nn("YuvToRgbRow",Z,3),Nn("YuvToBgrRow",ve,3),Nn("YuvToRgbaRow",Ft,4),Nn("YuvToBgraRow",Bn,4),Nn("YuvToArgbRow",qt,4),Nn("YuvToRgba4444Row",Be,2),Nn("YuvToRgb565Row",_e,2);var A2=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Jh=[0,2,8],CS=[8,7,6,4,4,2,2,2,1,1,1,1],IS=1;this.WebPDecodeRGBA=function(d,m,x,j,z){var G=Wh,Q=new ge,J=new nn;Q.ba=J,J.S=G,J.width=[J.width],J.height=[J.height];var ne=J.width,se=J.height,fe=new xt;if(fe==null||d==null)var Ne=2;else e(fe!=null),Ne=Ts(d,m,x,fe.width,fe.height,fe.Pd,fe.Qd,fe.format,null);if(Ne!=0?ne=0:(ne!=null&&(ne[0]=fe.width[0]),se!=null&&(se[0]=fe.height[0]),ne=1),ne){J.width=J.width[0],J.height=J.height[0],j!=null&&(j[0]=J.width),z!=null&&(z[0]=J.height);e:{if(j=new Xs,(z=new ke).data=d,z.w=m,z.ha=x,z.kd=1,m=[0],e(z!=null),((d=Ts(z.data,z.w,z.ha,null,null,null,m,null,z))==0||d==7)&&m[0]&&(d=4),(m=d)==0){if(e(Q!=null),j.data=z.data,j.w=z.w+z.offset,j.ha=z.ha-z.offset,j.put=pt,j.ac=qr,j.bc=kn,j.ma=Q,z.xa){if((d=Ks())==null){Q=1;break e}if(function(ae,pe){var ye=[0],Ae=[0],be=[0];t:for(;;){if(ae==null)return 0;if(pe==null)return ae.a=2,0;if(ae.l=pe,ae.a=0,W(ae.m,pe.data,pe.w,pe.ha),!rs(ae.m,ye,Ae,be)){ae.a=3;break t}if(ae.xb=x2,pe.width=ye[0],pe.height=Ae[0],!Ri(ye[0],Ae[0],1,ae,null))break t;return 1}return e(ae.a!=0),0}(d,j)){if(j=(m=Ao(j.width,j.height,Q.Oa,Q.ba))==0){t:{j=d;n:for(;;){if(j==null){j=0;break t}if(e(j.s.yc!=null),e(j.s.Ya!=null),e(0<j.s.Wb),e((x=j.l)!=null),e((z=x.ma)!=null),j.xb!=0){if(j.ca=z.ba,j.tb=z.tb,e(j.ca!=null),!Ku(z.Oa,x,Gh)){j.a=2;break n}if(!_s(j,x.width)||x.da)break n;if((x.da||St(j.ca.S))&&wn(),11>j.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),j.ca.f.kb.F!=null&&wn()),j.Pb&&0<j.s.ua&&j.s.vb.X==null&&!re(j.s.vb,j.s.Wa.Xa)){j.a=1;break n}j.xb=0}if(!Wr(j,j.V,j.Ba,j.c,j.i,x.o,Gs))break n;z.Dc=j.Ma,j=1;break t}e(j.a!=0),j=0}j=!j}j&&(m=d.a)}else m=d.a}else{if((d=new Cl)==null){Q=1;break e}if(d.Fa=z.na,d.P=z.P,d.qc=z.Sa,Ac(d,j)){if((m=Ao(j.width,j.height,Q.Oa,Q.ba))==0){if(d.Aa=0,x=Q.Oa,e((z=d)!=null),x!=null){if(0<(ne=0>(ne=x.Md)?0:100<ne?255:255*ne/100)){for(se=fe=0;4>se;++se)12>(Ne=z.pb[se]).lc&&(Ne.ia=ne*CS[0>Ne.lc?0:Ne.lc]>>3),fe|=Ne.ia;fe&&(alert("todo:VP8InitRandom"),z.ia=1)}z.Ga=x.Id,100<z.Ga?z.Ga=100:0>z.Ga&&(z.Ga=0)}(function(ae,pe){if(ae==null)return 0;if(pe==null)return Fn(ae,2,"NULL VP8Io parameter in VP8Decode().");if(!ae.cb&&!Ac(ae,pe))return 0;if(e(ae.cb),pe.ac==null||pe.ac(pe)){pe.ob&&(ae.L=0);var ye=Jh[ae.L];if(ae.L==2?(ae.yb=0,ae.zb=0):(ae.yb=pe.v-ye>>4,ae.zb=pe.j-ye>>4,0>ae.yb&&(ae.yb=0),0>ae.zb&&(ae.zb=0)),ae.Va=pe.o+15+ye>>4,ae.Hb=pe.va+15+ye>>4,ae.Hb>ae.za&&(ae.Hb=ae.za),ae.Va>ae.Ub&&(ae.Va=ae.Ub),0<ae.L){var Ae=ae.ed;for(ye=0;4>ye;++ye){var be;if(ae.Qa.Cb){var Te=ae.Qa.Lb[ye];ae.Qa.Fb||(Te+=Ae.Tb)}else Te=Ae.Tb;for(be=0;1>=be;++be){var je=ae.gd[ye][be],Me=Te;if(Ae.Pc&&(Me+=Ae.vd[0],be&&(Me+=Ae.od[0])),0<(Me=0>Me?0:63<Me?63:Me)){var Pe=Me;0<Ae.wb&&(Pe=4<Ae.wb?Pe>>2:Pe>>1)>9-Ae.wb&&(Pe=9-Ae.wb),1>Pe&&(Pe=1),je.dd=Pe,je.tc=2*Me+Pe,je.ld=40<=Me?2:15<=Me?1:0}else je.tc=0;je.La=be}}}ye=0}else Fn(ae,6,"Frame setup failed"),ye=ae.a;if(ye=ye==0){if(ye){ae.$c=0,0<ae.Aa||(ae.Ic=IS);t:{ye=ae.Ic,Ae=4*(Pe=ae.za);var at=32*Pe,Ke=Pe+1,Rt=0<ae.L?Pe*(0<ae.Aa?2:1):0,et=(ae.Aa==2?2:1)*Pe;if((je=Ae+832+(be=3*(16*ye+Jh[ae.L])/2*at)+(Te=ae.Fa!=null&&0<ae.Fa.length?ae.Kc.c*ae.Kc.i:0))!=je)ye=0;else{if(je>ae.Vb){if(ae.Vb=0,ae.Ec=s(je),ae.Fc=0,ae.Ec==null){ye=Fn(ae,1,"no memory during frame initialization.");break t}ae.Vb=je}je=ae.Ec,Me=ae.Fc,ae.Ac=je,ae.Bc=Me,Me+=Ae,ae.Gd=o(at,Tl),ae.Hd=0,ae.rb=o(Ke+1,Li),ae.sb=1,ae.wa=Rt?o(Rt,Sr):null,ae.Y=0,ae.D.Nb=0,ae.D.wa=ae.wa,ae.D.Y=ae.Y,0<ae.Aa&&(ae.D.Y+=Pe),e(!0),ae.oc=je,ae.pc=Me,Me+=832,ae.ya=o(et,Sl),ae.aa=0,ae.D.ya=ae.ya,ae.D.aa=ae.aa,ae.Aa==2&&(ae.D.aa+=Pe),ae.R=16*Pe,ae.B=8*Pe,Pe=(at=Jh[ae.L])*ae.R,at=at/2*ae.B,ae.sa=je,ae.ta=Me+Pe,ae.qa=ae.sa,ae.ra=ae.ta+16*ye*ae.R+at,ae.Ha=ae.qa,ae.Ia=ae.ra+8*ye*ae.B+at,ae.$c=0,Me+=be,ae.mb=Te?je:null,ae.nb=Te?Me:null,e(Me+Te<=ae.Fc+ae.Vb),Js(ae),i(ae.Ac,ae.Bc,0,Ae),ye=1}}if(ye){if(pe.ka=0,pe.y=ae.sa,pe.O=ae.ta,pe.f=ae.qa,pe.N=ae.ra,pe.ea=ae.Ha,pe.Vd=ae.Ia,pe.fa=ae.R,pe.Rc=ae.B,pe.F=null,pe.J=0,!m2){for(ye=-255;255>=ye;++ye)u2[255+ye]=0>ye?-ye:ye;for(ye=-1020;1020>=ye;++ye)d2[1020+ye]=-128>ye?-128:127<ye?127:ye;for(ye=-112;112>=ye;++ye)h2[112+ye]=-16>ye?-16:15<ye?15:ye;for(ye=-255;510>=ye;++ye)f2[255+ye]=0>ye?0:255<ye?255:ye;m2=1}Io=Zs,$l=xo,oa=Sc,sn=Bt,vn=Ra,os=yo,tr=Ml,vr=Eo,Ua=y,td=$,jc=as,zh=Fl,t2=ie,n2=de,r2=ra,i2=ia,s2=wi,a2=Ol,js[0]=Hu,js[1]=Pl,js[2]=ta,js[3]=qu,js[4]=Wu,js[5]=As,js[6]=kr,js[7]=Gu,js[8]=Ss,js[9]=wo,Po[0]=bi,Po[1]=$u,Po[2]=zu,Po[3]=Rl,Po[4]=is,Po[5]=ea,Po[6]=bo,Va[0]=Da,Va[1]=kc,Va[2]=No,Va[3]=Di,Va[4]=gn,Va[5]=Ll,Va[6]=Dl,ye=1}else ye=0}ye&&(ye=function(Ht,yr){for(Ht.M=0;Ht.M<Ht.Va;++Ht.M){var Lt,tt=Ht.Jc[Ht.M&Ht.Xb],ze=Ht.m,nr=Ht;for(Lt=0;Lt<nr.za;++Lt){var Pt=ze,Qt=nr,Tn=Qt.Ac,Lr=Qt.Bc+4*Lt,di=Qt.zc,Kn=Qt.ya[Qt.aa+Lt];if(Qt.Qa.Bb?Kn.$b=we(Pt,Qt.Pa.jb[0])?2+we(Pt,Qt.Pa.jb[2]):we(Pt,Qt.Pa.jb[1]):Kn.$b=0,Qt.kc&&(Kn.Ad=we(Pt,Qt.Bd)),Kn.Za=!we(Pt,145)+0,Kn.Za){var Kr=Kn.Ob,hi=0;for(Qt=0;4>Qt;++Qt){var xr,Jt=di[0+Qt];for(xr=0;4>xr;++xr){Jt=gS[Tn[Lr+xr]][Jt];for(var cn=y2[we(Pt,Jt[0])];0<cn;)cn=y2[2*cn+we(Pt,Jt[cn])];Jt=-cn,Tn[Lr+xr]=Jt}r(Kr,hi,Tn,Lr,4),hi+=4,di[0+Qt]=Jt}}else Jt=we(Pt,156)?we(Pt,128)?1:3:we(Pt,163)?2:0,Kn.Ob[0]=Jt,i(Tn,Lr,Jt,4),i(di,0,Jt,4);Kn.Dd=we(Pt,142)?we(Pt,114)?we(Pt,183)?1:3:2:0}if(nr.m.Ka)return Fn(Ht,7,"Premature end-of-partition0 encountered.");for(;Ht.ja<Ht.za;++Ht.ja){if(nr=tt,Pt=(ze=Ht).rb[ze.sb-1],Tn=ze.rb[ze.sb+ze.ja],Lt=ze.ya[ze.aa+ze.ja],Lr=ze.kc?Lt.Ad:0)Pt.la=Tn.la=0,Lt.Za||(Pt.Na=Tn.Na=0),Lt.Hc=0,Lt.Gc=0,Lt.ia=0;else{var Yn,un;if(Pt=Tn,Tn=nr,Lr=ze.Pa.Xc,di=ze.ya[ze.aa+ze.ja],Kn=ze.pb[di.$b],Qt=di.ad,Kr=0,hi=ze.rb[ze.sb-1],Jt=xr=0,i(Qt,Kr,0,384),di.Za)var Dr=0,Cs=Lr[3];else{cn=s(16);var rr=Pt.Na+hi.Na;if(rr=rd(Tn,Lr[1],rr,Kn.Eb,0,cn,0),Pt.Na=hi.Na=(0<rr)+0,1<rr)Io(cn,0,Qt,Kr);else{var Ni=cn[0]+3>>3;for(cn=0;256>cn;cn+=16)Qt[Kr+cn]=Ni}Dr=1,Cs=Lr[0]}var yn=15&Pt.la,br=15&hi.la;for(cn=0;4>cn;++cn){var Bi=1&br;for(Ni=un=0;4>Ni;++Ni)yn=yn>>1|(Bi=(rr=rd(Tn,Cs,rr=Bi+(1&yn),Kn.Sc,Dr,Qt,Kr))>Dr)<<7,un=un<<2|(3<rr?3:1<rr?2:Qt[Kr+0]!=0),Kr+=16;yn>>=4,br=br>>1|Bi<<7,xr=(xr<<8|un)>>>0}for(Cs=yn,Dr=br>>4,Yn=0;4>Yn;Yn+=2){for(un=0,yn=Pt.la>>4+Yn,br=hi.la>>4+Yn,cn=0;2>cn;++cn){for(Bi=1&br,Ni=0;2>Ni;++Ni)rr=Bi+(1&yn),yn=yn>>1|(Bi=0<(rr=rd(Tn,Lr[2],rr,Kn.Qc,0,Qt,Kr)))<<3,un=un<<2|(3<rr?3:1<rr?2:Qt[Kr+0]!=0),Kr+=16;yn>>=2,br=br>>1|Bi<<5}Jt|=un<<4*Yn,Cs|=yn<<4<<Yn,Dr|=(240&br)<<Yn}Pt.la=Cs,hi.la=Dr,di.Hc=xr,di.Gc=Jt,di.ia=43690&Jt?0:Kn.ia,Lr=!(xr|Jt)}if(0<ze.L&&(ze.wa[ze.Y+ze.ja]=ze.gd[Lt.$b][Lt.Za],ze.wa[ze.Y+ze.ja].La|=!Lr),nr.Ka)return Fn(Ht,7,"Premature end-of-file encountered.")}if(Js(Ht),ze=yr,nr=1,Lt=(tt=Ht).D,Pt=0<tt.L&&tt.M>=tt.zb&&tt.M<=tt.Va,tt.Aa==0)t:{if(Lt.M=tt.M,Lt.uc=Pt,Rr(tt,Lt),nr=1,Lt=(un=tt.D).Nb,Pt=(Jt=Jh[tt.L])*tt.R,Tn=Jt/2*tt.B,cn=16*Lt*tt.R,Ni=8*Lt*tt.B,Lr=tt.sa,di=tt.ta-Pt+cn,Kn=tt.qa,Qt=tt.ra-Tn+Ni,Kr=tt.Ha,hi=tt.Ia-Tn+Ni,br=(yn=un.M)==0,xr=yn>=tt.Va-1,tt.Aa==2&&Rr(tt,un),un.uc)for(Bi=(rr=tt).D.M,e(rr.D.uc),un=rr.yb;un<rr.Hb;++un){Dr=un,Cs=Bi;var fi=($i=(Or=rr).D).Nb;Yn=Or.R;var $i=$i.wa[$i.Y+Dr],zi=Or.sa,_i=Or.ta+16*fi*Yn+16*Dr,qi=$i.dd,_n=$i.tc;if(_n!=0)if(e(3<=_n),Or.L==1)0<Dr&&i2(zi,_i,Yn,_n+4),$i.La&&a2(zi,_i,Yn,_n),0<Cs&&r2(zi,_i,Yn,_n+4),$i.La&&s2(zi,_i,Yn,_n);else{var Hi=Or.B,Is=Or.qa,zl=Or.ra+8*fi*Hi+8*Dr,Ba=Or.Ha,Or=Or.Ia+8*fi*Hi+8*Dr;fi=$i.ld,0<Dr&&(vr(zi,_i,Yn,_n+4,qi,fi),td(Is,zl,Ba,Or,Hi,_n+4,qi,fi)),$i.La&&(zh(zi,_i,Yn,_n,qi,fi),n2(Is,zl,Ba,Or,Hi,_n,qi,fi)),0<Cs&&(tr(zi,_i,Yn,_n+4,qi,fi),Ua(Is,zl,Ba,Or,Hi,_n+4,qi,fi)),$i.La&&(jc(zi,_i,Yn,_n,qi,fi),t2(Is,zl,Ba,Or,Hi,_n,qi,fi))}}if(tt.ia&&alert("todo:DitherRow"),ze.put!=null){if(un=16*yn,yn=16*(yn+1),br?(ze.y=tt.sa,ze.O=tt.ta+cn,ze.f=tt.qa,ze.N=tt.ra+Ni,ze.ea=tt.Ha,ze.W=tt.Ia+Ni):(un-=Jt,ze.y=Lr,ze.O=di,ze.f=Kn,ze.N=Qt,ze.ea=Kr,ze.W=hi),xr||(yn-=Jt),yn>ze.o&&(yn=ze.o),ze.F=null,ze.J=null,tt.Fa!=null&&0<tt.Fa.length&&un<yn&&(ze.J=Un(tt,ze,un,yn-un),ze.F=tt.mb,ze.F==null&&ze.F.length==0)){nr=Fn(tt,3,"Could not decode alpha data.");break t}un<ze.j&&(Jt=ze.j-un,un=ze.j,e(!(1&Jt)),ze.O+=tt.R*Jt,ze.N+=tt.B*(Jt>>1),ze.W+=tt.B*(Jt>>1),ze.F!=null&&(ze.J+=ze.width*Jt)),un<yn&&(ze.O+=ze.v,ze.N+=ze.v>>1,ze.W+=ze.v>>1,ze.F!=null&&(ze.J+=ze.v),ze.ka=un-ze.j,ze.U=ze.va-ze.v,ze.T=yn-un,nr=ze.put(ze))}Lt+1!=tt.Ic||xr||(r(tt.sa,tt.ta-Pt,Lr,di+16*tt.R,Pt),r(tt.qa,tt.ra-Tn,Kn,Qt+8*tt.B,Tn),r(tt.Ha,tt.Ia-Tn,Kr,hi+8*tt.B,Tn))}if(!nr)return Fn(Ht,6,"Output aborted.")}return 1}(ae,pe)),pe.bc!=null&&pe.bc(pe),ye&=1}return ye?(ae.cb=0,ye):0})(d,j)||(m=d.a)}}else m=d.a}m==0&&Q.Oa!=null&&Q.Oa.fd&&(m=Yu(Q.ba))}Q=m}G=Q!=0?null:11>G?J.f.RGBA.eb:J.f.kb.y}else G=null;return G};var S2=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(N,U){for(var E="",L=0;L<4;L++)E+=String.fromCharCode(N[U++]);return E}function f(N,U){return N[U+0]|N[U+1]<<8}function v(N,U){return(N[U+0]|N[U+1]<<8|N[U+2]<<16)>>>0}function g(N,U){return(N[U+0]|N[U+1]<<8|N[U+2]<<16|N[U+3]<<24)>>>0}new c;var p=[0],S=[0],k=[],C=new c,b=t,I=function(N,U){var E={},L=0,_=!1,M=0,K=0;if(E.frames=[],!function(A,P){for(var q=0;q<4;q++)if(A[P+q]!="RIFF".charCodeAt(q))return!0;return!1}(N,U)){for(g(N,U+=4),U+=8;U<N.length;){var F=u(N,U),X=g(N,U+=4);U+=4;var H=X+(1&X);switch(F){case"VP8 ":case"VP8L":E.frames[L]===void 0&&(E.frames[L]={}),(B=E.frames[L]).src_off=_?K:U-8,B.src_size=M+X+8,L++,_&&(_=!1,M=0,K=0);break;case"VP8X":(B=E.header={}).feature_flags=N[U];var W=U+4;B.canvas_width=1+v(N,W),W+=3,B.canvas_height=1+v(N,W),W+=3;break;case"ALPH":_=!0,M=H+8,K=U-8;break;case"ANIM":(B=E.header).bgcolor=g(N,U),W=U+4,B.loop_count=f(N,W),W+=2;break;case"ANMF":var Y,B;(B=E.frames[L]={}).offset_x=2*v(N,U),U+=3,B.offset_y=2*v(N,U),U+=3,B.width=1+v(N,U),U+=3,B.height=1+v(N,U),U+=3,B.duration=v(N,U),U+=3,Y=N[U++],B.dispose=1&Y,B.blend=Y>>1&1}F!="ANMF"&&(U+=H)}return E}}(b,0);I.response=b,I.rgbaoutput=!0,I.dataurl=!1;var R=I.header?I.header:null,D=I.frames?I.frames:null;if(R){R.loop_counter=R.loop_count,p=[R.canvas_height],S=[R.canvas_width];for(var ee=0;ee<D.length&&D[ee].blend!=0;ee++);}var oe=D[0],V=C.WebPDecodeRGBA(b,oe.src_off,oe.src_size,S,p);oe.rgba=V,oe.imgwidth=S[0],oe.imgheight=p[0];for(var T=0;T<S[0]*p[0]*4;T++)k[T]=V[T];return this.width=S,this.height=p,this.data=k,this}(function(t){var e,n,r,i,s,o,l,c,u,f=function(A){return A=A||{},this.isStrokeTransparent=A.isStrokeTransparent||!1,this.strokeOpacity=A.strokeOpacity||1,this.strokeStyle=A.strokeStyle||"#000000",this.fillStyle=A.fillStyle||"#000000",this.isFillTransparent=A.isFillTransparent||!1,this.fillOpacity=A.fillOpacity||1,this.font=A.font||"10px sans-serif",this.textBaseline=A.textBaseline||"alphabetic",this.textAlign=A.textAlign||"left",this.lineWidth=A.lineWidth||1,this.lineJoin=A.lineJoin||"miter",this.lineCap=A.lineCap||"butt",this.path=A.path||[],this.transform=A.transform!==void 0?A.transform.clone():new c,this.globalCompositeOperation=A.globalCompositeOperation||"normal",this.globalAlpha=A.globalAlpha||1,this.clip_path=A.clip_path||[],this.currentPoint=A.currentPoint||new o,this.miterLimit=A.miterLimit||10,this.lastPoint=A.lastPoint||new o,this.lineDashOffset=A.lineDashOffset||0,this.lineDash=A.lineDash||[],this.margin=A.margin||[0,0,0,0],this.prevPageLastElemOffset=A.prevPageLastElemOffset||0,this.ignoreClearRect=typeof A.ignoreClearRect!="boolean"||A.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new v(this),e=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new f}]);var v=function(A){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var P=A;Object.defineProperty(this,"pdf",{get:function(){return P}});var q=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return q},set:function(xe){q=!!xe}});var te=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return te},set:function(xe){te=!!xe}});var le=0;Object.defineProperty(this,"posX",{get:function(){return le},set:function(xe){isNaN(xe)||(le=xe)}});var ce=0;Object.defineProperty(this,"posY",{get:function(){return ce},set:function(xe){isNaN(xe)||(ce=xe)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(xe){var re;typeof xe=="number"?re=[xe,xe,xe,xe]:((re=new Array(4))[0]=xe[0],re[1]=xe.length>=2?xe[1]:re[0],re[2]=xe.length>=3?xe[2]:re[0],re[3]=xe.length>=4?xe[3]:re[1]),u.margin=re}});var me=!1;Object.defineProperty(this,"autoPaging",{get:function(){return me},set:function(xe){me=xe}});var he=0;Object.defineProperty(this,"lastBreak",{get:function(){return he},set:function(xe){he=xe}});var we=[];Object.defineProperty(this,"pageBreaks",{get:function(){return we},set:function(xe){we=xe}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(xe){xe instanceof f&&(u=xe)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(xe){u.path=xe}});var Ee=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ee},set:function(xe){Ee=xe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(xe){var re;re=g(xe),this.ctx.fillStyle=re.style,this.ctx.isFillTransparent=re.a===0,this.ctx.fillOpacity=re.a,this.pdf.setFillColor(re.r,re.g,re.b,{a:re.a}),this.pdf.setTextColor(re.r,re.g,re.b,{a:re.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(xe){var re=g(xe);this.ctx.strokeStyle=re.style,this.ctx.isStrokeTransparent=re.a===0,this.ctx.strokeOpacity=re.a,re.a===0?this.pdf.setDrawColor(255,255,255):(re.a,this.pdf.setDrawColor(re.r,re.g,re.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(xe){["butt","round","square"].indexOf(xe)!==-1&&(this.ctx.lineCap=xe,this.pdf.setLineCap(xe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(xe){isNaN(xe)||(this.ctx.lineWidth=xe,this.pdf.setLineWidth(xe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(xe){["bevel","round","miter"].indexOf(xe)!==-1&&(this.ctx.lineJoin=xe,this.pdf.setLineJoin(xe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(xe){isNaN(xe)||(this.ctx.miterLimit=xe,this.pdf.setMiterLimit(xe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(xe){this.ctx.textBaseline=xe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(xe){["right","end","center","left","start"].indexOf(xe)!==-1&&(this.ctx.textAlign=xe)}});var Le=null,Re=null;Object.defineProperty(this,"fontFaces",{get:function(){return Re},set:function(xe){Le=null,Re=xe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(xe){var re;if(this.ctx.font=xe,(re=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(xe))!==null){var qe=re[1];re[2];var dt=re[3],lt=re[4];re[5];var Oe=re[6],Qe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(lt)[2];lt=Math.floor(Qe==="px"?parseFloat(lt)*this.pdf.internal.scaleFactor:Qe==="em"?parseFloat(lt)*this.pdf.getFontSize():parseFloat(lt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(lt);var Se=function(yt){var ct,en,Kt=[],Ze=yt.trim();if(Ze==="")return E0;if(Ze in m5)return[m5[Ze]];for(;Ze!=="";){switch(en=null,ct=(Ze=g5(Ze)).charAt(0)){case'"':case"'":en=nO(Ze.substring(1),ct);break;default:en=rO(Ze)}if(en===null||(Kt.push(en[0]),(Ze=g5(en[1]))!==""&&Ze.charAt(0)!==","))return E0;Ze=Ze.replace(/^,/,"")}return Kt}(Oe);if(this.fontFaces){var $e=function(yt,ct){if(Le===null){var en=function(Kt){var Ze=[];return Object.keys(Kt).forEach(function(Nt){Kt[Nt].forEach(function(an){var gt=null;switch(an){case"bold":gt={family:Nt,weight:"bold"};break;case"italic":gt={family:Nt,style:"italic"};break;case"bolditalic":gt={family:Nt,weight:"bold",style:"italic"};break;case"":case"normal":gt={family:Nt}}gt!==null&&(gt.ref={name:Nt,style:an},Ze.push(gt))})}),Ze}(yt.getFontList());Le=function(Kt){for(var Ze={},Nt=0;Nt<Kt.length;++Nt){var an=_0(Kt[Nt]),gt=an.family,Dt=an.stretch,St=an.style,Rn=an.weight;Ze[gt]=Ze[gt]||{},Ze[gt][Dt]=Ze[gt][Dt]||{},Ze[gt][Dt][St]=Ze[gt][Dt][St]||{},Ze[gt][Dt][St][Rn]=an}return Ze}(en.concat(ct))}return Le}(this.pdf,this.fontFaces),it=Se.map(function(yt){return{family:yt,stretch:"normal",weight:dt,style:qe}}),zt=function(yt,ct,en){for(var Kt=(en=en||{}).defaultFontFamily||"times",Ze=Object.assign({},tO,en.genericFontFamilies||{}),Nt=null,an=null,gt=0;gt<ct.length;++gt)if(Ze[(Nt=_0(ct[gt])).family]&&(Nt.family=Ze[Nt.family]),yt.hasOwnProperty(Nt.family)){an=yt[Nt.family];break}if(!(an=an||yt[Kt]))throw new Error("Could not find a font-family for the rule '"+p5(Nt)+"' and default family '"+Kt+"'.");if(an=function(Dt,St){if(St[Dt])return St[Dt];var Rn=e1[Dt],Sn=Rn<=e1.normal?-1:1,nn=f5(St,eS,Rn,Sn);if(!nn)throw new Error("Could not find a matching font-stretch value for "+Dt);return nn}(Nt.stretch,an),an=function(Dt,St){if(St[Dt])return St[Dt];for(var Rn=ZA[Dt],Sn=0;Sn<Rn.length;++Sn)if(St[Rn[Sn]])return St[Rn[Sn]];throw new Error("Could not find a matching font-style for "+Dt)}(Nt.style,an),!(an=function(Dt,St){if(St[Dt])return St[Dt];if(Dt===400&&St[500])return St[500];if(Dt===500&&St[400])return St[400];var Rn=eO[Dt],Sn=f5(St,tS,Rn,Dt<400?-1:1);if(!Sn)throw new Error("Could not find a matching font-weight for value "+Dt);return Sn}(Nt.weight,an)))throw new Error("Failed to resolve a font for the rule '"+p5(Nt)+"'.");return an}($e,it);this.pdf.setFont(zt.ref.name,zt.ref.style)}else{var At="";(dt==="bold"||parseInt(dt,10)>=700||qe==="bold")&&(At="bold"),qe==="italic"&&(At+="italic"),At.length===0&&(At="normal");for(var nt="",Tt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},wt=0;wt<Se.length;wt++){if(this.pdf.internal.getFont(Se[wt],At,{noFallback:!0,disableWarning:!0})!==void 0){nt=Se[wt];break}if(At==="bolditalic"&&this.pdf.internal.getFont(Se[wt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)nt=Se[wt],At="bold";else if(this.pdf.internal.getFont(Se[wt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){nt=Se[wt],At="normal";break}}if(nt===""){for(var st=0;st<Se.length;st++)if(Tt[Se[st]]){nt=Tt[Se[st]];break}}nt=nt===""?"Times":nt,this.pdf.setFont(nt,At)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(xe){this.ctx.globalCompositeOperation=xe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(xe){this.ctx.globalAlpha=xe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(xe){this.ctx.lineDashOffset=xe,B.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(xe){this.ctx.lineDash=xe,B.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(xe){this.ctx.ignoreClearRect=!!xe}})};v.prototype.setLineDash=function(A){this.lineDash=A},v.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},v.prototype.fill=function(){D.call(this,"fill",!1)},v.prototype.stroke=function(){D.call(this,"stroke",!1)},v.prototype.beginPath=function(){this.path=[{type:"begin"}]},v.prototype.moveTo=function(A,P){if(isNaN(A)||isNaN(P))throw xn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var q=this.ctx.transform.applyToPoint(new o(A,P));this.path.push({type:"mt",x:q.x,y:q.y}),this.ctx.lastPoint=new o(A,P)},v.prototype.closePath=function(){var A=new o(0,0),P=0;for(P=this.path.length-1;P!==-1;P--)if(this.path[P].type==="begin"&&hn(this.path[P+1])==="object"&&typeof this.path[P+1].x=="number"){A=new o(this.path[P+1].x,this.path[P+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(A.x,A.y)},v.prototype.lineTo=function(A,P){if(isNaN(A)||isNaN(P))throw xn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var q=this.ctx.transform.applyToPoint(new o(A,P));this.path.push({type:"lt",x:q.x,y:q.y}),this.ctx.lastPoint=new o(q.x,q.y)},v.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),D.call(this,null,!0)},v.prototype.quadraticCurveTo=function(A,P,q,te){if(isNaN(q)||isNaN(te)||isNaN(A)||isNaN(P))throw xn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var le=this.ctx.transform.applyToPoint(new o(q,te)),ce=this.ctx.transform.applyToPoint(new o(A,P));this.path.push({type:"qct",x1:ce.x,y1:ce.y,x:le.x,y:le.y}),this.ctx.lastPoint=new o(le.x,le.y)},v.prototype.bezierCurveTo=function(A,P,q,te,le,ce){if(isNaN(le)||isNaN(ce)||isNaN(A)||isNaN(P)||isNaN(q)||isNaN(te))throw xn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var me=this.ctx.transform.applyToPoint(new o(le,ce)),he=this.ctx.transform.applyToPoint(new o(A,P)),we=this.ctx.transform.applyToPoint(new o(q,te));this.path.push({type:"bct",x1:he.x,y1:he.y,x2:we.x,y2:we.y,x:me.x,y:me.y}),this.ctx.lastPoint=new o(me.x,me.y)},v.prototype.arc=function(A,P,q,te,le,ce){if(isNaN(A)||isNaN(P)||isNaN(q)||isNaN(te)||isNaN(le))throw xn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ce=!!ce,!this.ctx.transform.isIdentity){var me=this.ctx.transform.applyToPoint(new o(A,P));A=me.x,P=me.y;var he=this.ctx.transform.applyToPoint(new o(0,q)),we=this.ctx.transform.applyToPoint(new o(0,0));q=Math.sqrt(Math.pow(he.x-we.x,2)+Math.pow(he.y-we.y,2))}Math.abs(le-te)>=2*Math.PI&&(te=0,le=2*Math.PI),this.path.push({type:"arc",x:A,y:P,radius:q,startAngle:te,endAngle:le,counterclockwise:ce})},v.prototype.arcTo=function(A,P,q,te,le){throw new Error("arcTo not implemented.")},v.prototype.rect=function(A,P,q,te){if(isNaN(A)||isNaN(P)||isNaN(q)||isNaN(te))throw xn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(A,P),this.lineTo(A+q,P),this.lineTo(A+q,P+te),this.lineTo(A,P+te),this.lineTo(A,P),this.lineTo(A+q,P),this.lineTo(A,P)},v.prototype.fillRect=function(A,P,q,te){if(isNaN(A)||isNaN(P)||isNaN(q)||isNaN(te))throw xn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var le={};this.lineCap!=="butt"&&(le.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(le.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(A,P,q,te),this.fill(),le.hasOwnProperty("lineCap")&&(this.lineCap=le.lineCap),le.hasOwnProperty("lineJoin")&&(this.lineJoin=le.lineJoin)}},v.prototype.strokeRect=function(A,P,q,te){if(isNaN(A)||isNaN(P)||isNaN(q)||isNaN(te))throw xn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");S.call(this)||(this.beginPath(),this.rect(A,P,q,te),this.stroke())},v.prototype.clearRect=function(A,P,q,te){if(isNaN(A)||isNaN(P)||isNaN(q)||isNaN(te))throw xn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(A,P,q,te))},v.prototype.save=function(A){A=typeof A!="boolean"||A;for(var P=this.pdf.internal.getCurrentPageInfo().pageNumber,q=0;q<this.pdf.internal.getNumberOfPages();q++)this.pdf.setPage(q+1),this.pdf.internal.out("q");if(this.pdf.setPage(P),A){this.ctx.fontSize=this.pdf.internal.getFontSize();var te=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=te}},v.prototype.restore=function(A){A=typeof A!="boolean"||A;for(var P=this.pdf.internal.getCurrentPageInfo().pageNumber,q=0;q<this.pdf.internal.getNumberOfPages();q++)this.pdf.setPage(q+1),this.pdf.internal.out("Q");this.pdf.setPage(P),A&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},v.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g=function(A){var P,q,te,le;if(A.isCanvasGradient===!0&&(A=A.getColor()),!A)return{r:0,g:0,b:0,a:0,style:A};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(A))P=0,q=0,te=0,le=0;else{var ce=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(A);if(ce!==null)P=parseInt(ce[1]),q=parseInt(ce[2]),te=parseInt(ce[3]),le=1;else if((ce=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(A))!==null)P=parseInt(ce[1]),q=parseInt(ce[2]),te=parseInt(ce[3]),le=parseFloat(ce[4]);else{if(le=1,typeof A=="string"&&A.charAt(0)!=="#"){var me=new WA(A);A=me.ok?me.toHex():"#000000"}A.length===4?(P=A.substring(1,2),P+=P,q=A.substring(2,3),q+=q,te=A.substring(3,4),te+=te):(P=A.substring(1,3),q=A.substring(3,5),te=A.substring(5,7)),P=parseInt(P,16),q=parseInt(q,16),te=parseInt(te,16)}}return{r:P,g:q,b:te,a:le,style:A}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},S=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};v.prototype.fillText=function(A,P,q,te){if(isNaN(P)||isNaN(q)||typeof A!="string")throw xn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(te=isNaN(te)?void 0:te,!p.call(this)){var le=H(this.ctx.transform.rotation),ce=this.ctx.transform.scaleX;L.call(this,{text:A,x:P,y:q,scale:ce,angle:le,align:this.textAlign,maxWidth:te})}},v.prototype.strokeText=function(A,P,q,te){if(isNaN(P)||isNaN(q)||typeof A!="string")throw xn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!S.call(this)){te=isNaN(te)?void 0:te;var le=H(this.ctx.transform.rotation),ce=this.ctx.transform.scaleX;L.call(this,{text:A,x:P,y:q,scale:ce,renderingMode:"stroke",angle:le,align:this.textAlign,maxWidth:te})}},v.prototype.measureText=function(A){if(typeof A!="string")throw xn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var P=this.pdf,q=this.pdf.internal.scaleFactor,te=P.internal.getFontSize(),le=P.getStringUnitWidth(A)*te/P.internal.scaleFactor;return new function(ce){var me=(ce=ce||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return me}}),this}({width:le*=Math.round(96*q/72*1e4)/1e4})},v.prototype.scale=function(A,P){if(isNaN(A)||isNaN(P))throw xn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var q=new c(A,0,0,P,0,0);this.ctx.transform=this.ctx.transform.multiply(q)},v.prototype.rotate=function(A){if(isNaN(A))throw xn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var P=new c(Math.cos(A),Math.sin(A),-Math.sin(A),Math.cos(A),0,0);this.ctx.transform=this.ctx.transform.multiply(P)},v.prototype.translate=function(A,P){if(isNaN(A)||isNaN(P))throw xn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var q=new c(1,0,0,1,A,P);this.ctx.transform=this.ctx.transform.multiply(q)},v.prototype.transform=function(A,P,q,te,le,ce){if(isNaN(A)||isNaN(P)||isNaN(q)||isNaN(te)||isNaN(le)||isNaN(ce))throw xn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var me=new c(A,P,q,te,le,ce);this.ctx.transform=this.ctx.transform.multiply(me)},v.prototype.setTransform=function(A,P,q,te,le,ce){A=isNaN(A)?1:A,P=isNaN(P)?0:P,q=isNaN(q)?0:q,te=isNaN(te)?1:te,le=isNaN(le)?0:le,ce=isNaN(ce)?0:ce,this.ctx.transform=new c(A,P,q,te,le,ce)};var k=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};v.prototype.drawImage=function(A,P,q,te,le,ce,me,he,we){var Ee=this.pdf.getImageProperties(A),Le=1,Re=1,xe=1,re=1;te!==void 0&&he!==void 0&&(xe=he/te,re=we/le,Le=Ee.width/te*he/te,Re=Ee.height/le*we/le),ce===void 0&&(ce=P,me=q,P=0,q=0),te!==void 0&&he===void 0&&(he=te,we=le),te===void 0&&he===void 0&&(he=Ee.width,we=Ee.height);for(var qe,dt=this.ctx.transform.decompose(),lt=H(dt.rotate.shx),Oe=new c,Qe=(Oe=(Oe=(Oe=Oe.multiply(dt.translate)).multiply(dt.skew)).multiply(dt.scale)).applyToRectangle(new l(ce-P*xe,me-q*re,te*Le,le*Re)),Se=C.call(this,Qe),$e=[],it=0;it<Se.length;it+=1)$e.indexOf(Se[it])===-1&&$e.push(Se[it]);if(R($e),this.autoPaging)for(var zt=$e[0],At=$e[$e.length-1],nt=zt;nt<At+1;nt++){this.pdf.setPage(nt);var Tt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],wt=nt===1?this.posY+this.margin[0]:this.margin[0],st=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],yt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ct=nt===1?0:st+(nt-2)*yt;if(this.ctx.clip_path.length!==0){var en=this.path;qe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=I(qe,this.posX+this.margin[3],-ct+wt+this.ctx.prevPageLastElemOffset),ee.call(this,"fill",!0),this.path=en}var Kt=JSON.parse(JSON.stringify(Qe));Kt=I([Kt],this.posX+this.margin[3],-ct+wt+this.ctx.prevPageLastElemOffset)[0];var Ze=(nt>zt||nt<At)&&k.call(this);Ze&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Tt,yt,null).clip().discardPath()),this.pdf.addImage(A,"JPEG",Kt.x,Kt.y,Kt.w,Kt.h,null,null,lt),Ze&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(A,"JPEG",Qe.x,Qe.y,Qe.w,Qe.h,null,null,lt)};var C=function(A,P,q){var te=[];P=P||this.pdf.internal.pageSize.width,q=q||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var le=this.posY+this.ctx.prevPageLastElemOffset;switch(A.type){default:case"mt":case"lt":te.push(Math.floor((A.y+le)/q)+1);break;case"arc":te.push(Math.floor((A.y+le-A.radius)/q)+1),te.push(Math.floor((A.y+le+A.radius)/q)+1);break;case"qct":var ce=W(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x,A.y);te.push(Math.floor((ce.y+le)/q)+1),te.push(Math.floor((ce.y+ce.h+le)/q)+1);break;case"bct":var me=Y(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x2,A.y2,A.x,A.y);te.push(Math.floor((me.y+le)/q)+1),te.push(Math.floor((me.y+me.h+le)/q)+1);break;case"rect":te.push(Math.floor((A.y+le)/q)+1),te.push(Math.floor((A.y+A.h+le)/q)+1)}for(var he=0;he<te.length;he+=1)for(;this.pdf.internal.getNumberOfPages()<te[he];)b.call(this);return te},b=function(){var A=this.fillStyle,P=this.strokeStyle,q=this.font,te=this.lineCap,le=this.lineWidth,ce=this.lineJoin;this.pdf.addPage(),this.fillStyle=A,this.strokeStyle=P,this.font=q,this.lineCap=te,this.lineWidth=le,this.lineJoin=ce},I=function(A,P,q){for(var te=0;te<A.length;te++)switch(A[te].type){case"bct":A[te].x2+=P,A[te].y2+=q;case"qct":A[te].x1+=P,A[te].y1+=q;default:A[te].x+=P,A[te].y+=q}return A},R=function(A){return A.sort(function(P,q){return P-q})},D=function(A,P){for(var q,te,le=this.fillStyle,ce=this.strokeStyle,me=this.lineCap,he=this.lineWidth,we=Math.abs(he*this.ctx.transform.scaleX),Ee=this.lineJoin,Le=JSON.parse(JSON.stringify(this.path)),Re=JSON.parse(JSON.stringify(this.path)),xe=[],re=0;re<Re.length;re++)if(Re[re].x!==void 0)for(var qe=C.call(this,Re[re]),dt=0;dt<qe.length;dt+=1)xe.indexOf(qe[dt])===-1&&xe.push(qe[dt]);for(var lt=0;lt<xe.length;lt++)for(;this.pdf.internal.getNumberOfPages()<xe[lt];)b.call(this);if(R(xe),this.autoPaging)for(var Oe=xe[0],Qe=xe[xe.length-1],Se=Oe;Se<Qe+1;Se++){this.pdf.setPage(Se),this.fillStyle=le,this.strokeStyle=ce,this.lineCap=me,this.lineWidth=we,this.lineJoin=Ee;var $e=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],it=Se===1?this.posY+this.margin[0]:this.margin[0],zt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],At=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],nt=Se===1?0:zt+(Se-2)*At;if(this.ctx.clip_path.length!==0){var Tt=this.path;q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=I(q,this.posX+this.margin[3],-nt+it+this.ctx.prevPageLastElemOffset),ee.call(this,A,!0),this.path=Tt}if(te=JSON.parse(JSON.stringify(Le)),this.path=I(te,this.posX+this.margin[3],-nt+it+this.ctx.prevPageLastElemOffset),P===!1||Se===0){var wt=(Se>Oe||Se<Qe)&&k.call(this);wt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],$e,At,null).clip().discardPath()),ee.call(this,A,P),wt&&this.pdf.restoreGraphicsState()}this.lineWidth=he}else this.lineWidth=we,ee.call(this,A,P),this.lineWidth=he;this.path=Le},ee=function(A,P){if((A!=="stroke"||P||!S.call(this))&&(A==="stroke"||P||!p.call(this))){for(var q,te,le=[],ce=this.path,me=0;me<ce.length;me++){var he=ce[me];switch(he.type){case"begin":le.push({begin:!0});break;case"close":le.push({close:!0});break;case"mt":le.push({start:he,deltas:[],abs:[]});break;case"lt":var we=le.length;if(ce[me-1]&&!isNaN(ce[me-1].x)&&(q=[he.x-ce[me-1].x,he.y-ce[me-1].y],we>0)){for(;we>=0;we--)if(le[we-1].close!==!0&&le[we-1].begin!==!0){le[we-1].deltas.push(q),le[we-1].abs.push(he);break}}break;case"bct":q=[he.x1-ce[me-1].x,he.y1-ce[me-1].y,he.x2-ce[me-1].x,he.y2-ce[me-1].y,he.x-ce[me-1].x,he.y-ce[me-1].y],le[le.length-1].deltas.push(q);break;case"qct":var Ee=ce[me-1].x+2/3*(he.x1-ce[me-1].x),Le=ce[me-1].y+2/3*(he.y1-ce[me-1].y),Re=he.x+2/3*(he.x1-he.x),xe=he.y+2/3*(he.y1-he.y),re=he.x,qe=he.y;q=[Ee-ce[me-1].x,Le-ce[me-1].y,Re-ce[me-1].x,xe-ce[me-1].y,re-ce[me-1].x,qe-ce[me-1].y],le[le.length-1].deltas.push(q);break;case"arc":le.push({deltas:[],abs:[],arc:!0}),Array.isArray(le[le.length-1].abs)&&le[le.length-1].abs.push(he)}}te=P?null:A==="stroke"?"stroke":"fill";for(var dt=!1,lt=0;lt<le.length;lt++)if(le[lt].arc)for(var Oe=le[lt].abs,Qe=0;Qe<Oe.length;Qe++){var Se=Oe[Qe];Se.type==="arc"?T.call(this,Se.x,Se.y,Se.radius,Se.startAngle,Se.endAngle,Se.counterclockwise,void 0,P,!dt):_.call(this,Se.x,Se.y),dt=!0}else if(le[lt].close===!0)this.pdf.internal.out("h"),dt=!1;else if(le[lt].begin!==!0){var $e=le[lt].start.x,it=le[lt].start.y;M.call(this,le[lt].deltas,$e,it),dt=!0}te&&N.call(this,te),P&&U.call(this)}},oe=function(A){var P=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,q=P*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return A-q;case"top":return A+P-q;case"hanging":return A+P-2*q;case"middle":return A+P/2-q;default:return A}},V=function(A){return A+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};v.prototype.createLinearGradient=function(){var A=function(){};return A.colorStops=[],A.addColorStop=function(P,q){this.colorStops.push([P,q])},A.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},A.isCanvasGradient=!0,A},v.prototype.createPattern=function(){return this.createLinearGradient()},v.prototype.createRadialGradient=function(){return this.createLinearGradient()};var T=function(A,P,q,te,le,ce,me,he,we){for(var Ee=F.call(this,q,te,le,ce),Le=0;Le<Ee.length;Le++){var Re=Ee[Le];Le===0&&(we?E.call(this,Re.x1+A,Re.y1+P):_.call(this,Re.x1+A,Re.y1+P)),K.call(this,A,P,Re.x2,Re.y2,Re.x3,Re.y3,Re.x4,Re.y4)}he?U.call(this):N.call(this,me)},N=function(A){switch(A){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},U=function(){this.pdf.clip(),this.pdf.discardPath()},E=function(A,P){this.pdf.internal.out(n(A)+" "+r(P)+" m")},L=function(A){var P;switch(A.align){case"right":case"end":P="right";break;case"center":P="center";break;default:P="left"}var q=this.pdf.getTextDimensions(A.text),te=oe.call(this,A.y),le=V.call(this,te)-q.h,ce=this.ctx.transform.applyToPoint(new o(A.x,te)),me=this.ctx.transform.decompose(),he=new c;he=(he=(he=he.multiply(me.translate)).multiply(me.skew)).multiply(me.scale);for(var we,Ee,Le,Re=this.ctx.transform.applyToRectangle(new l(A.x,te,q.w,q.h)),xe=he.applyToRectangle(new l(A.x,le,q.w,q.h)),re=C.call(this,xe),qe=[],dt=0;dt<re.length;dt+=1)qe.indexOf(re[dt])===-1&&qe.push(re[dt]);if(R(qe),this.autoPaging)for(var lt=qe[0],Oe=qe[qe.length-1],Qe=lt;Qe<Oe+1;Qe++){this.pdf.setPage(Qe);var Se=Qe===1?this.posY+this.margin[0]:this.margin[0],$e=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],it=this.pdf.internal.pageSize.height-this.margin[2],zt=it-this.margin[0],At=this.pdf.internal.pageSize.width-this.margin[1],nt=At-this.margin[3],Tt=Qe===1?0:$e+(Qe-2)*zt;if(this.ctx.clip_path.length!==0){var wt=this.path;we=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=I(we,this.posX+this.margin[3],-1*Tt+Se),ee.call(this,"fill",!0),this.path=wt}var st=I([JSON.parse(JSON.stringify(xe))],this.posX+this.margin[3],-Tt+Se+this.ctx.prevPageLastElemOffset)[0];A.scale>=.01&&(Ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ee*A.scale),Le=this.lineWidth,this.lineWidth=Le*A.scale);var yt=this.autoPaging!=="text";if(yt||st.y+st.h<=it){if(yt||st.y>=Se&&st.x<=At){var ct=yt?A.text:this.pdf.splitTextToSize(A.text,A.maxWidth||At-st.x)[0],en=I([JSON.parse(JSON.stringify(Re))],this.posX+this.margin[3],-Tt+Se+this.ctx.prevPageLastElemOffset)[0],Kt=yt&&(Qe>lt||Qe<Oe)&&k.call(this);Kt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],nt,zt,null).clip().discardPath()),this.pdf.text(ct,en.x,en.y,{angle:A.angle,align:P,renderingMode:A.renderingMode}),Kt&&this.pdf.restoreGraphicsState()}}else st.y<it&&(this.ctx.prevPageLastElemOffset+=it-st.y);A.scale>=.01&&(this.pdf.setFontSize(Ee),this.lineWidth=Le)}else A.scale>=.01&&(Ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ee*A.scale),Le=this.lineWidth,this.lineWidth=Le*A.scale),this.pdf.text(A.text,ce.x+this.posX,ce.y+this.posY,{angle:A.angle,align:P,renderingMode:A.renderingMode,maxWidth:A.maxWidth}),A.scale>=.01&&(this.pdf.setFontSize(Ee),this.lineWidth=Le)},_=function(A,P,q,te){q=q||0,te=te||0,this.pdf.internal.out(n(A+q)+" "+r(P+te)+" l")},M=function(A,P,q){return this.pdf.lines(A,P,q,null,null)},K=function(A,P,q,te,le,ce,me,he){this.pdf.internal.out([e(i(q+A)),e(s(te+P)),e(i(le+A)),e(s(ce+P)),e(i(me+A)),e(s(he+P)),"c"].join(" "))},F=function(A,P,q,te){for(var le=2*Math.PI,ce=Math.PI/2;P>q;)P-=le;var me=Math.abs(q-P);me<le&&te&&(me=le-me);for(var he=[],we=te?-1:1,Ee=P;me>1e-5;){var Le=Ee+we*Math.min(me,ce);he.push(X.call(this,A,Ee,Le)),me-=Math.abs(Le-Ee),Ee=Le}return he},X=function(A,P,q){var te=(q-P)/2,le=A*Math.cos(te),ce=A*Math.sin(te),me=le,he=-ce,we=me*me+he*he,Ee=we+me*le+he*ce,Le=4/3*(Math.sqrt(2*we*Ee)-Ee)/(me*ce-he*le),Re=me-Le*he,xe=he+Le*me,re=Re,qe=-xe,dt=te+P,lt=Math.cos(dt),Oe=Math.sin(dt);return{x1:A*Math.cos(P),y1:A*Math.sin(P),x2:Re*lt-xe*Oe,y2:Re*Oe+xe*lt,x3:re*lt-qe*Oe,y3:re*Oe+qe*lt,x4:A*Math.cos(q),y4:A*Math.sin(q)}},H=function(A){return 180*A/Math.PI},W=function(A,P,q,te,le,ce){var me=A+.5*(q-A),he=P+.5*(te-P),we=le+.5*(q-le),Ee=ce+.5*(te-ce),Le=Math.min(A,le,me,we),Re=Math.max(A,le,me,we),xe=Math.min(P,ce,he,Ee),re=Math.max(P,ce,he,Ee);return new l(Le,xe,Re-Le,re-xe)},Y=function(A,P,q,te,le,ce,me,he){var we,Ee,Le,Re,xe,re,qe,dt,lt,Oe,Qe,Se,$e,it,zt=q-A,At=te-P,nt=le-q,Tt=ce-te,wt=me-le,st=he-ce;for(Ee=0;Ee<41;Ee++)lt=(qe=(Le=A+(we=Ee/40)*zt)+we*((xe=q+we*nt)-Le))+we*(xe+we*(le+we*wt-xe)-qe),Oe=(dt=(Re=P+we*At)+we*((re=te+we*Tt)-Re))+we*(re+we*(ce+we*st-re)-dt),Ee==0?(Qe=lt,Se=Oe,$e=lt,it=Oe):(Qe=Math.min(Qe,lt),Se=Math.min(Se,Oe),$e=Math.max($e,lt),it=Math.max(it,Oe));return new l(Math.round(Qe),Math.round(Se),Math.round($e-Qe),Math.round(it-Se))},B=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var A,P,q=(A=this.ctx.lineDash,P=this.ctx.lineDashOffset,JSON.stringify({lineDash:A,lineDashOffset:P}));this.prevLineDash!==q&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=q)}}})(ot.API),function(t){var e=function(o){var l,c,u,f,v,g,p,S,k,C;for(c=[],u=0,f=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;f>u;u+=4)(v=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(g=(v=((v=((v=((v=(v-(C=v%85))/85)-(k=v%85))/85)-(S=v%85))/85)-(p=v%85))/85)%85,c.push(g+33,p+33,S+33,k+33,C+33)):c.push(122);return function(b,I){for(var R=I;R>0;R--)b.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},n=function(o){var l,c,u,f,v,g=String,p="length",S=255,k="charCodeAt",C="slice",b="replace";for(o[C](-2),o=o[C](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),u=[],f=0,v=(o+=l="uuuuu"[C](o[p]%5||5))[p];v>f;f+=5)c=52200625*(o[k](f)-33)+614125*(o[k](f+1)-33)+7225*(o[k](f+2)-33)+85*(o[k](f+3)-33)+(o[k](f+4)-33),u.push(S&c>>24,S&c>>16,S&c>>8,S&c);return function(I,R){for(var D=R;D>0;D--)I.pop()}(u,l[p]),g.fromCharCode.apply(g,u)},r=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=Gv(l)).reduce(function(u,f){return u+String.fromCharCode(f)},"")};t.processDataByFilters=function(o,l){var c=0,u=o||"",f=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=n(u),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=i(u),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=r(u),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:f.reverse().join(" ")}}}(ot.API),function(t){t.loadFile=function(e,n,r){return function(i,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,f){var v=new XMLHttpRequest,g=0,p=function(S){var k=S.length,C=[],b=String.fromCharCode;for(g=0;g<k;g+=1)C.push(b(255&S.charCodeAt(g)));return C.join("")};if(v.open("GET",c,!u),v.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(v.onload=function(){v.status===200?f(p(this.responseText)):f(void 0)}),v.send(null),u&&v.status===200)return p(v.responseText)}(i,s,o)}catch{}return l}(e,n,r)},t.loadImageFile=t.loadFile}(ot.API),function(t){function e(){return(Et.html2canvas?Promise.resolve(Et.html2canvas):s0(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function n(){return(Et.DOMPurify?Promise.resolve(Et.DOMPurify):s0(()=>import("./purify.es-B6FQ9oRL.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var r=function(l){var c=hn(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},i=function(l,c){var u=document.createElement(l);for(var f in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[f]=c.style[f];return u},s=function l(c,u){for(var f=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),v=c.firstChild;v;v=v.nextSibling)u!==!0&&v.nodeType===1&&v.nodeName==="SCRIPT"||f.appendChild(l(v,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(f.value=c.value),f.addEventListener("load",function(){f.scrollTop=c.scrollTop,f.scrollLeft=c.scrollLeft},!0)),f},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),f=l.convert(Promise.resolve(),u);return(f=f.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(r(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(n).then(function(u){return this.set({src:i("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=this.opt.jsPDF,f=this.opt.fontFaces,v=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,g=Object.assign({async:!0,allowTaint:!0,scale:v,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete g.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=f,f)for(var p=0;p<f.length;++p){var S=f[p],k=S.src.find(function(C){return C.format==="truetype"});k&&u.addFont(k.url,S.ref.name,S.ref.style)}return g.windowHeight=g.windowHeight||0,g.windowHeight=g.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):g.windowHeight,u.context2d.save(!0),c(this.prop.container,g)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(r(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(r(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,f){return Math.floor(u*f/72*96)}return this.then(function(){(l=l||ot.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,f){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,f){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,f?this.progress.stack.concat(f):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(f,v){return u.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(g){return u.updateProgress(null,f),g}).then(f,v).then(function(g){return u.updateProgress(1),g})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var f=this;l&&(l=l.bind(f)),c&&(c=c.bind(f));var v=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:o.convert(Object.assign({},f),Promise.prototype),g=u.call(v,l,c);return o.convert(g,f.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,ot.getPageSize=function(l,c,u){if(hn(l)==="object"){var f=l;l=f.orientation,c=f.unit||c,u=f.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var v,g=(""+u).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":v=1;break;case"mm":v=72/25.4;break;case"cm":v=72/2.54;break;case"in":v=72;break;case"px":v=.75;break;case"pc":case"em":v=12;break;case"ex":v=6;break;default:throw"Invalid unit: "+c}var S,k=0,C=0;if(p.hasOwnProperty(g))k=p[g][1]/v,C=p[g][0]/v;else try{k=u[1],C=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",C>k&&(S=C,C=k,k=S);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",k>C&&(S=C,C=k,k=S)}return{width:C,height:k,unit:c,k:v,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(_0):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(ot.API),ot.API.addJS=function(t){return y5=t,this.internal.events.subscribe("postPutResources",function(){Mf=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Mf+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),v5=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+y5+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Mf!==void 0&&v5!==void 0&&this.internal.out("/Names <</JavaScript "+Mf+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=n.outline.render().split(/\r\n/),s=0;s<i.length;s++){var o=i[s],l=r.exec(o);if(l!=null){var c=l[1];n.internal.newObjectDeferredBegin(c,!1)}n.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,f=[];for(s=0;s<u;s++){var v=n.internal.newObject();f.push(v);var g=n.internal.getPageInfo(s+1);n.internal.write("<< /D["+g.objId+" 0 R /XYZ null null null]>> endobj")}var p=n.internal.newObject();for(n.internal.write("<< /Names [ "),s=0;s<f.length;s++)n.internal.write("(page_"+(s+1)+")"+f[s]+" 0 R");n.internal.write(" ] >>","endobj"),e=n.internal.newObject(),n.internal.write("<< /Dests "+p+" 0 R"),n.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,i,s){var o={title:i,options:s,children:[]};return r==null&&(r=this.root),r.children.push(o),o},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<r.children.length;s++){var o=r.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(r)),s>0&&this.line("/Prev "+this.makeRef(r.children[s-1])),s<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=n.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<r.children.length;u++)this.renderItems(r.children[u])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,i){for(var s=0;s<i.children.length;s++)r.count++,this.count_r(r,i.children[s]);return r.count}}])}(ot.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(n,r,i,s,o,l){var c,u=this.decode.DCT_DECODE,f=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=o||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,c=function(v){for(var g,p=256*v.charCodeAt(4)+v.charCodeAt(5),S=v.length,k={width:0,height:0,numcomponents:1},C=4;C<S;C+=2){if(C+=p,e.indexOf(v.charCodeAt(C+1))!==-1){g=256*v.charCodeAt(C+5)+v.charCodeAt(C+6),k={width:256*v.charCodeAt(C+7)+v.charCodeAt(C+8),height:g,numcomponents:v.charCodeAt(C+9)};break}p=256*v.charCodeAt(C+2)+v.charCodeAt(C+3)}return k}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}f={data:n,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:r,alias:i}}return f}}(ot.API),ot.API.processPNG=function(t,e,n,r){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var i,s=VD(t,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,u=s.palette,f=s.depth;i=u&&c===1?function(T){for(var N=T.width,U=T.height,E=T.data,L=T.palette,_=T.depth,M=!1,K=[],F=[],X=void 0,H=!1,W=0,Y=0;Y<L.length;Y++){var B=Nw(L[Y],4),A=B[0],P=B[1],q=B[2],te=B[3];K.push(A,P,q),te!=null&&(te===0?(W++,F.length<1&&F.push(Y)):te<255&&(H=!0))}if(H||W>1){M=!0,F=void 0;var le=N*U;X=new Uint8Array(le);for(var ce=new DataView(E.buffer),me=0;me<le;me++){var he=A0(ce,me,_),we=Nw(L[he],4)[3];X[me]=we}}else W===0&&(F=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:M?8:void 0,colorBytes:E,alphaBytes:X,needSMask:M,palette:K,mask:F}}(s):c===2||c===4?function(T){for(var N=T.data,U=T.width,E=T.height,L=T.channels,_=T.depth,M=L===2?"DeviceGray":"DeviceRGB",K=L-1,F=U*E,X=K,H=F*X,W=1*F,Y=Math.ceil(H*_/8),B=Math.ceil(W*_/8),A=new Uint8Array(Y),P=new Uint8Array(B),q=new DataView(N.buffer),te=new DataView(A.buffer),le=new DataView(P.buffer),ce=!1,me=0;me<F;me++){for(var he=me*L,we=0;we<X;we++)k5(te,A0(q,he+we,_),me*X+we,_);var Ee=A0(q,he+X,_);Ee<(1<<_)-1&&(ce=!0),k5(le,Ee,1*me,_)}return{colorSpace:M,colorsPerPixel:K,sMaskBitsPerComponent:ce?_:void 0,colorBytes:A,alphaBytes:P,needSMask:ce}}(s):function(T){var N=T.data,U=T.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:U,colorsPerPixel:U==="DeviceGray"?1:3,colorBytes:N instanceof Uint16Array?function(E){for(var L=E.length,_=new Uint8Array(2*L),M=new DataView(_.buffer,_.byteOffset,_.byteLength),K=0;K<L;K++)M.setUint16(2*K,E[K],!1);return _}(N):N,needSMask:!1}}(s);var v,g,p,S=i,k=S.colorSpace,C=S.colorsPerPixel,b=S.sMaskBitsPerComponent,I=S.colorBytes,R=S.alphaBytes,D=S.needSMask,ee=S.palette,oe=S.mask,V=null;return r!==ot.API.image_compression.NONE&&typeof Gv=="function"?(V=function(T){var N;switch(T){case ot.API.image_compression.FAST:N=11;break;case ot.API.image_compression.MEDIUM:N=13;break;case ot.API.image_compression.SLOW:N=14;break;default:N=12}return N}(r),v=this.decode.FLATE_DECODE,g="/Predictor ".concat(V," /Colors ").concat(C," /BitsPerComponent ").concat(f," /Columns ").concat(o),t=N5(I,Math.ceil(o*C*f/8),C,f,r),D&&(p=N5(R,Math.ceil(o*b/8),1,b,r))):(v=void 0,g=void 0,t=I,D&&(p=R)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(p&&this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),{alias:n,data:t,index:e,filter:v,decodeParameters:g,transparency:oe,palette:ee,sMask:p,predictor:V,width:o,height:l,bitsPerComponent:f,sMaskBitsPerComponent:b,colorSpace:k}}},function(t){t.processGIF89A=function(e,n,r,i){var s=new oO(e),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},f=new S0(100).encode(u,100);return t.processJPEG.call(this,f,n,r,i)},t.processGIF87A=t.processGIF89A}(ot.API),Rs.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:r,blue:n,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Rs.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(n){xn.log("bit decode error:"+n)}},Rs.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}n!==0&&(this.pos+=4-n)}},Rs.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<t;i++){var s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+2*i*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*i+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Rs.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+4*r;if(i<this.palette.length){var o=this.palette[i];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},Rs.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,l=(s>>5&e)/e*255|0,c=(s>>10&e)/e*255|0,u=s>>15?255:0,f=r*this.width*4+4*i;this.data[f]=c,this.data[f+1]=l,this.data[f+2]=o,this.data[f+3]=u}this.pos+=t}},Rs.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&n)/n*255|0,u=(o>>11)/e*255|0,f=i*this.width*4+4*s;this.data[f]=u,this.data[f+1]=c,this.data[f+2]=l,this.data[f+3]=255}this.pos+=t}},Rs.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*n;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=r,this.data[o+3]=255}this.pos+=this.width%4}},Rs.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*n;this.data[l]=s,this.data[l+1]=i,this.data[l+2]=r,this.data[l+3]=o}},Rs.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,n,r,i){var s=new Rs(e,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new S0(100).encode(c,100);return t.processJPEG.call(this,u,n,r,i)}}(ot.API),j5.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,n,r,i){var s=new j5(e),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new S0(100).encode(c,100);return t.processJPEG.call(this,u,n,r,i)}}(ot.API),ot.API.processRGBA=function(t,e,n){for(var r=t.data,i=r.length,s=new Uint8Array(i/4*3),o=new Uint8Array(i/4),l=0,c=0,u=0;u<i;u+=4){var f=r[u],v=r[u+1],g=r[u+2],p=r[u+3];s[l++]=f,s[l++]=v,s[l++]=g,o[c++]=p}var S=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:S,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},ot.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Lc=ot.API,Ff=Lc.getCharWidthsArray=function(t,e){var n,r,i=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:i.metadata.Unicode.kerning,f=u.fof?u.fof:1,v=e.doKerning!==!1,g=0,p=t.length,S=0,k=l[0]||c,C=[];for(n=0;n<p;n++)r=t.charCodeAt(n),typeof i.metadata.widthOfString=="function"?C.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+o*(1e3/s)||0)/1e3):(g=v&&hn(u[r])==="object"&&!isNaN(parseInt(u[r][S],10))?u[r][S]/f:0,C.push((l[r]||k)/c+g)),S=r;return C},x5=Lc.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return Lc.processArabic&&(t=Lc.processArabic(t)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(t,n,i)/n:Ff.apply(this,arguments).reduce(function(s,o){return s+o},0)},b5=function(t,e,n,r){for(var i=[],s=0,o=t.length,l=0;s!==o&&l+e[s]<n;)l+=e[s],s++;i.push(t.slice(0,s));var c=s;for(l=0;s!==o;)l+e[s]>r&&(i.push(t.slice(c,s)),l=0,c=s),l+=e[s],s++;return c!==s&&i.push(t.slice(c,s)),i},w5=function(t,e,n){n||(n={});var r,i,s,o,l,c,u,f=[],v=[f],g=n.textIndent||0,p=0,S=0,k=t.split(" "),C=Ff.apply(this,[" ",n])[0];if(c=n.lineIndent===-1?k[0].length+2:n.lineIndent||0){var b=Array(c).join(" "),I=[];k.map(function(D){(D=D.split(/\s*\n/)).length>1?I=I.concat(D.map(function(ee,oe){return(oe&&ee.length?`
`:"")+ee})):I.push(D[0])}),k=I,c=x5.apply(this,[b,n])}for(s=0,o=k.length;s<o;s++){var R=0;if(r=k[s],c&&r[0]==`
`&&(r=r.substr(1),R=1),g+p+(S=(i=Ff.apply(this,[r,n])).reduce(function(D,ee){return D+ee},0))>e||R){if(S>e){for(l=b5.apply(this,[r,i,e-(g+p),e]),f.push(l.shift()),f=[l.pop()];l.length;)v.push([l.shift()]);S=i.slice(r.length-(f[0]?f[0].length:0)).reduce(function(D,ee){return D+ee},0)}else f=[r];v.push(f),g=S+c,p=C}else f.push(r),g+=p+S,p=C}return u=c?function(D,ee){return(ee?b:"")+D.join(" ")}:function(D){return D.join(" ")},v.map(u)},Lc.splitTextToSize=function(t,e,n){var r,i=(n=n||{}).fontSize||this.internal.getFontSize(),s=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var v=this.internal.getFont(f.fontName,f.fontStyle),g="Unicode";return v.metadata[g]?{widths:v.metadata[g].widths||{0:1},kerning:v.metadata[g].kerning||{}}:{font:v.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/i;s.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=n.lineIndent;var l,c,u=[];for(l=0,c=r.length;l<c;l++)u=u.concat(w5.apply(this,[r[l],o,s]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",n="klmnopqrstuvwxyz",r={},i={},s=0;s<16;s++)r[n[s]]=e[s],i[e[s]]=n[s];var o=function(g){return"0x"+parseInt(g,10).toString(16)},l=t.__fontmetrics__.compress=function(g){var p,S,k,C,b=["{"];for(var I in g){if(p=g[I],isNaN(parseInt(I,10))?S="'"+I+"'":(I=parseInt(I,10),S=(S=o(I).slice(2)).slice(0,-1)+i[S.slice(-1)]),typeof p=="number")p<0?(k=o(p).slice(3),C="-"):(k=o(p).slice(2),C=""),k=C+k.slice(0,-1)+i[k.slice(-1)];else{if(hn(p)!=="object")throw new Error("Don't know what to do with value type "+hn(p)+".");k=l(p)}b.push(S+k)}return b.push("}"),b.join("")},c=t.__fontmetrics__.uncompress=function(g){if(typeof g!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,S,k,C,b={},I=1,R=b,D=[],ee="",oe="",V=g.length-1,T=1;T<V;T+=1)(C=g[T])=="'"?p?(k=p.join(""),p=void 0):p=[]:p?p.push(C):C=="{"?(D.push([R,k]),R={},k=void 0):C=="}"?((S=D.pop())[0][S[1]]=R,k=void 0,R=S[0]):C=="-"?I=-1:k===void 0?r.hasOwnProperty(C)?(ee+=r[C],k=parseInt(ee,16)*I,I=1,ee=""):ee+=C:r.hasOwnProperty(C)?(oe+=r[C],R[k]=parseInt(oe,16)*I,I=1,k=void 0,oe=""):oe+=C;return b},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},v={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(g){var p=g.font,S=v.Unicode[p.postScriptName];S&&(p.metadata.Unicode={},p.metadata.Unicode.widths=S.widths,p.metadata.Unicode.kerning=S.kerning);var k=f.Unicode[p.postScriptName];k&&(p.metadata.Unicode.encoding=k,p.encoding=k.codePages[0])}])}(ot.API),function(t){var e=function(n){for(var r=n.length,i=new Uint8Array(r),s=0;s<r;s++)i[s]=n.charCodeAt(s);return i};t.API.events.push(["addFont",function(n){var r=void 0,i=n.font,s=n.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(lm(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,r)}}])}(ot),ot.API.addSvgAsImage=function(t,e,n,r,i,s,o,l){if(isNaN(e)||isNaN(n))throw xn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(i))throw xn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=r,c.height=i;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},v=this;return(Et.canvg?Promise.resolve(Et.canvg):s0(()=>import("./index.es-B4HegyJc.js"),[])).catch(function(g){return Promise.reject(new Error("Could not load canvg: "+g))}).then(function(g){return g.default?g.default:g}).then(function(g){return g.fromString(u,t,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(f)}).then(function(){v.addImage(c.toDataURL("image/jpeg",1),e,n,r,i,o,l)})},ot.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(e,n);return this},ot.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var r,i,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,f=0,v=0;function g(S,k){var C,b=!1;for(C=0;C<S.length;C+=1)S[C]===k&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var p=l.length;for(v=0;v<p;v+=1)n[l[v]].value=n[l[v]].defaultValue,n[l[v]].explicitSet=!1}if(hn(t)==="object"){for(i in t)if(s=t[i],g(l,i)&&s!==void 0){if(n[i].type==="boolean"&&typeof s=="boolean")n[i].value=s;else if(n[i].type==="name"&&g(n[i].valueSet,s))n[i].value=s;else if(n[i].type==="integer"&&Number.isInteger(s))n[i].value=s;else if(n[i].type==="array"){for(u=0;u<s.length;u+=1)if(r=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(f=0;f<s[u].length;f+=1)typeof s[u][f]!="number"&&(r=!1);r===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}n[i].value="["+c.join(" ")+"]"}else n[i].value=n[i].defaultValue;n[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var S,k=[];for(S in n)n[S].explicitSet===!0&&(n[S].type==="name"?k.push("/"+S+" /"+n[S].value):k.push("/"+S+" "+n[S].value));k.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+k.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(t){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(r)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+o.length+l.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(i+s+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(r,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",e)),this}}(ot.API),function(t){var e=t.API,n=e.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],f=[""],v=0,g=s.length;v<g;++v){if(l=o.metadata.characterToGlyph(s.charCodeAt(v)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(v),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return f.join("");l=l.toString(16),f.push(u[4-l.length],l)}return f.join("")},r=function(s){var o,l,c,u,f,v,g;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],v=0,g=(l=Object.keys(s).sort(function(p,S){return p-S})).length;v<g;v++)o=l[v],c.length>=100&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,f=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var v=l.metadata.Unicode.widths,g=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),p="",S=0;S<g.length;S++)p+=String.fromCharCode(g[S]);var k=u();f({data:p,addLength1:!0,objectId:k}),c("endobj");var C=u();f({data:r(l.metadata.toUnicode),addLength1:!0,objectId:C}),c("endobj");var b=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Uc(l.fontName)),c("/FontFile2 "+k+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var I=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Uc(l.fontName)),c("/FontDescriptor "+b+" 0 R"),c("/W "+t.API.PDFObject.convert(v)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+C+" 0 R"),c("/BaseFont /"+Uc(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+I+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,f=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var v=l.metadata.rawData,g="",p=0;p<v.length;p++)g+=String.fromCharCode(v[p]);var S=u();f({data:g,addLength1:!0,objectId:S}),c("endobj");var k=u();f({data:r(l.metadata.toUnicode),addLength1:!0,objectId:k}),c("endobj");var C=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+S+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Uc(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var b=0;b<l.metadata.hmtx.widths.length;b++)l.metadata.hmtx.widths[b]=parseInt(l.metadata.hmtx.widths[b]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+k+" 0 R/BaseFont/"+Uc(l.fontName)+"/FontDescriptor "+C+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var i=function(s){var o,l=s.text||"",c=s.x,u=s.y,f=s.options||{},v=s.mutex||{},g=v.pdfEscape,p=v.activeFontKey,S=v.fonts,k=p,C="",b=0,I="",R=S[k].encoding;if(S[k].encoding!=="Identity-H")return{text:l,x:c,y:u,options:f,mutex:v};for(I=l,k=p,Array.isArray(l)&&(I=l[0]),b=0;b<I.length;b+=1)S[k].metadata.hasOwnProperty("cmap")&&(o=S[k].metadata.cmap.unicode.codeMap[I[b].charCodeAt(0)]),o||I[b].charCodeAt(0)<256&&S[k].metadata.hasOwnProperty("Unicode")?C+=I[b]:C+="";var D="";return parseInt(k.slice(1))<14||R==="WinAnsiEncoding"?D=g(C,k).split("").map(function(ee){return ee.charCodeAt(0).toString(16)}).join(""):R==="Identity-H"&&(D=n(C,S[k])),v.isHex=!0,{text:D,x:c,y:u,options:f,mutex:v}};e.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([i(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(i(Object.assign({},c,{text:o[u]})).text);s.text=l}else s.text=i(Object.assign({},c,{text:o})).text}])}(ot),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0},t.addFileToVFS=function(n,r){return e.call(this),this.internal.vFS[n]=r,this},t.getFileFromVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(ot.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(r){var i,s,o,l,c,u,f,v=e,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],S={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},k={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},C=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),I=!1,R=0;this.__bidiEngine__={};var D=function(E){var L=E.charCodeAt(),_=L>>8,M=k[_];return M!==void 0?v[256*M+(255&L)]:_===252||_===253?"AL":b.test(_)?"L":_===8?"R":"N"},ee=function(E){for(var L,_=0;_<E.length;_++){if((L=D(E.charAt(_)))==="L")return!1;if(L==="R")return!0}return!1},oe=function(E,L,_,M){var K,F,X,H,W=L[M];switch(W){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":I=!1;break;case"N":case"AN":break;case"EN":I&&(W="AN");break;case"AL":I=!0,W="R";break;case"WS":case"BN":W="N";break;case"CS":M<1||M+1>=L.length||(K=_[M-1])!=="EN"&&K!=="AN"||(F=L[M+1])!=="EN"&&F!=="AN"?W="N":I&&(F="AN"),W=F===K?F:"N";break;case"ES":W=(K=M>0?_[M-1]:"B")==="EN"&&M+1<L.length&&L[M+1]==="EN"?"EN":"N";break;case"ET":if(M>0&&_[M-1]==="EN"){W="EN";break}if(I){W="N";break}for(X=M+1,H=L.length;X<H&&L[X]==="ET";)X++;W=X<H&&L[X]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(H=L.length,X=M+1;X<H&&L[X]==="NSM";)X++;if(X<H){var Y=E[M],B=Y>=1425&&Y<=2303||Y===64286;if(K=L[X],B&&(K==="R"||K==="AL")){W="R";break}}}W=M<1||(K=L[M-1])==="B"?"N":_[M-1];break;case"B":I=!1,i=!0,W=R;break;case"S":s=!0,W="N"}return W},V=function(E,L,_){var M=E.split("");return _&&T(M,_,{hiLevel:R}),M.reverse(),L&&L.reverse(),M.join("")},T=function(E,L,_){var M,K,F,X,H,W=-1,Y=E.length,B=0,A=[],P=R?p:g,q=[];for(I=!1,i=!1,s=!1,K=0;K<Y;K++)q[K]=D(E[K]);for(F=0;F<Y;F++){if(H=B,A[F]=oe(E,q,A,F),M=240&(B=P[H][S[A[F]]]),B&=15,L[F]=X=P[B][5],M>0)if(M===16){for(K=W;K<F;K++)L[K]=1;W=-1}else W=-1;if(P[B][6])W===-1&&(W=F);else if(W>-1){for(K=W;K<F;K++)L[K]=X;W=-1}q[F]==="B"&&(L[F]=0),_.hiLevel|=X}s&&function(te,le,ce){for(var me=0;me<ce;me++)if(te[me]==="S"){le[me]=R;for(var he=me-1;he>=0&&te[he]==="WS";he--)le[he]=R}}(q,L,Y)},N=function(E,L,_,M,K){if(!(K.hiLevel<E)){if(E===1&&R===1&&!i)return L.reverse(),void(_&&_.reverse());for(var F,X,H,W,Y=L.length,B=0;B<Y;){if(M[B]>=E){for(H=B+1;H<Y&&M[H]>=E;)H++;for(W=B,X=H-1;W<X;W++,X--)F=L[W],L[W]=L[X],L[X]=F,_&&(F=_[W],_[W]=_[X],_[X]=F);B=H}B++}}},U=function(E,L,_){var M=E.split(""),K={hiLevel:R};return _||(_=[]),T(M,_,K),function(F,X,H){if(H.hiLevel!==0&&f)for(var W,Y=0;Y<F.length;Y++)X[Y]===1&&(W=C.indexOf(F[Y]))>=0&&(F[Y]=C[W+1])}(M,_,K),N(2,M,L,_,K),N(1,M,L,_,K),M.join("")};return this.__bidiEngine__.doBidiReorder=function(E,L,_){if(function(K,F){if(F)for(var X=0;X<K.length;X++)F[X]=X;l===void 0&&(l=ee(K)),u===void 0&&(u=ee(K))}(E,L),o||!c||u)if(o&&c&&l^u)R=l?1:0,E=V(E,L,_);else if(!o&&c&&u)R=l?1:0,E=U(E,L,_),E=V(E,L);else if(!o||l||c||u){if(o&&!c&&l^u)E=V(E,L),l?(R=0,E=U(E,L,_)):(R=1,E=U(E,L,_),E=V(E,L));else if(o&&l&&!c&&u)R=1,E=U(E,L,_),E=V(E,L);else if(!o&&!c&&l^u){var M=f;l?(R=1,E=U(E,L,_),R=0,f=!1,E=U(E,L,_),f=M):(R=0,E=U(E,L,_),E=V(E,L),R=1,f=!1,E=U(E,L,_),f=M,E=V(E,L))}}else R=0,E=U(E,L,_);else R=l?1:0,E=U(E,L,_);return E},this.__bidiEngine__.setOptions=function(E){E&&(o=E.isInputVisual,c=E.isOutputVisual,l=E.isInputRtl,u=E.isOutputRtl,f=E.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(r){var i=r.text;r.x,r.y;var s=r.options||{};r.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,n.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(o=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?o.push([n.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):o.push([n.doBidiReorder(i[l])]);r.text=o}else r.text=n.doBidiReorder(i);n.setOptions({isInputVisual:!0})}])}(ot),ot.API.TTFFont=function(){function t(e){var n;if(this.rawData=e,n=this.contents=new bl(e),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new NO(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new lO(this.contents),this.head=new uO(this),this.name=new pO(this),this.cmap=new rS(this),this.toUnicode={},this.hhea=new dO(this),this.maxp=new gO(this),this.hmtx=new vO(this),this.post=new fO(this),this.os2=new hO(this),this.loca=new wO(this),this.glyf=new yO(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,n,r,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),32768&(n=i>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var n;return((n=this.cmap.unicode)!=null?n.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*n},t.prototype.widthOfString=function(e,n,r){var i,s,o,l;for(o=0,s=0,l=(e=""+e).length;0<=l?s<l:s>l;s=0<=l?++s:--s)i=e.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/n)||0;return o*(n/1e3)},t.prototype.lineHeight=function(e,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},t}();var Hs,bl=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var n,r;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},t.prototype.writeString=function(e){var n,r,i;for(i=[],n=0,r=e.length;0<=r?n<r:n>r;n=0<=r?++n:--n)i.push(this.writeByte(e.charCodeAt(n)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,n,r,i,s,o,l,c;return e=this.readByte(),n=this.readByte(),r=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*n+1099511627776*r+4294967296*i+16777216*s+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var n,r;return n=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var n,r;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n.push(this.readByte());return n},t.prototype.write=function(e){var n,r,i,s;for(s=[],r=0,i=e.length;r<i;r++)n=e[r],s.push(this.writeByte(n));return s},t}(),lO=function(){var t;function e(n){var r,i,s;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(n){var r,i,s,o,l,c,u,f,v,g,p,S,k;for(k in p=Object.keys(n).length,c=Math.log(2),v=16*Math.floor(Math.log(p)/c),o=Math.floor(v/c),f=16*p-v,(i=new bl).writeInt(this.scalarType),i.writeShort(p),i.writeShort(v),i.writeShort(o),i.writeShort(f),s=16*p,u=i.pos+s,l=null,S=[],n)for(g=n[k],i.writeString(k),i.writeInt(t(g)),i.writeInt(u),i.writeInt(g.length),S=S.concat(g),k==="head"&&(l=u),u+=g.length;u%4;)S.push(0),u++;return i.write(S),r=2981146554-t(i.data),i.pos=l+8,i.writeUInt32(r),i.data},t=function(n){var r,i,s,o;for(n=iS.call(n);n.length%4;)n.push(0);for(s=new bl(n),i=0,r=0,o=n.length;r<o;r=r+=4)i+=s.readUInt32();return 4294967295&i},e}(),cO={}.hasOwnProperty,Ta=function(t,e){for(var n in e)cO.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Hs=function(){function t(e){var n;this.file=e,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var uO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new bl).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t}(),C5=function(){function t(e,n){var r,i,s,o,l,c,u,f,v,g,p,S,k,C,b,I,R;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=n+e.readInt(),v=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(p=e.readUInt16(),g=p/2,e.pos+=6,s=function(){var D,ee;for(ee=[],c=D=0;0<=g?D<g:D>g;c=0<=g?++D:--D)ee.push(e.readUInt16());return ee}(),e.pos+=2,k=function(){var D,ee;for(ee=[],c=D=0;0<=g?D<g:D>g;c=0<=g?++D:--D)ee.push(e.readUInt16());return ee}(),u=function(){var D,ee;for(ee=[],c=D=0;0<=g?D<g:D>g;c=0<=g?++D:--D)ee.push(e.readUInt16());return ee}(),f=function(){var D,ee;for(ee=[],c=D=0;0<=g?D<g:D>g;c=0<=g?++D:--D)ee.push(e.readUInt16());return ee}(),i=(this.length-e.pos+this.offset)/2,l=function(){var D,ee;for(ee=[],c=D=0;0<=i?D<i:D>i;c=0<=i?++D:--D)ee.push(e.readUInt16());return ee}(),c=b=0,R=s.length;b<R;c=++b)for(C=s[c],r=I=S=k[c];S<=C?I<=C:I>=C;r=S<=C?++I:--I)f[c]===0?o=r+u[c]:(o=l[f[c]/2+(r-S)-(g-c)]||0)!==0&&(o+=u[c]),this.codeMap[r]=65535&o}e.pos=v}return t.encode=function(e,n){var r,i,s,o,l,c,u,f,v,g,p,S,k,C,b,I,R,D,ee,oe,V,T,N,U,E,L,_,M,K,F,X,H,W,Y,B,A,P,q,te,le,ce,me,he,we,Ee,Le;switch(M=new bl,o=Object.keys(e).sort(function(Re,xe){return Re-xe}),n){case"macroman":for(k=0,C=function(){var Re=[];for(S=0;S<256;++S)Re.push(0);return Re}(),I={0:0},s={},K=0,W=o.length;K<W;K++)I[he=e[i=o[K]]]==null&&(I[he]=++k),s[i]={old:e[i],new:I[e[i]]},C[i]=I[e[i]];return M.writeUInt16(1),M.writeUInt16(0),M.writeUInt32(12),M.writeUInt16(0),M.writeUInt16(262),M.writeUInt16(0),M.write(C),{charMap:s,subtable:M.data,maxGlyphID:k+1};case"unicode":for(L=[],v=[],R=0,I={},r={},b=u=null,F=0,Y=o.length;F<Y;F++)I[ee=e[i=o[F]]]==null&&(I[ee]=++R),r[i]={old:ee,new:I[ee]},l=I[ee]-i,b!=null&&l===u||(b&&v.push(b),L.push(i),u=l),b=i;for(b&&v.push(b),v.push(65535),L.push(65535),U=2*(N=L.length),T=2*Math.pow(Math.log(N)/Math.LN2,2),g=Math.log(T/2)/Math.LN2,V=2*N-T,c=[],oe=[],p=[],S=X=0,B=L.length;X<B;S=++X){if(E=L[S],f=v[S],E===65535){c.push(0),oe.push(0);break}if(E-(_=r[E].new)>=32768)for(c.push(0),oe.push(2*(p.length+N-S)),i=H=E;E<=f?H<=f:H>=f;i=E<=f?++H:--H)p.push(r[i].new);else c.push(_-E),oe.push(0)}for(M.writeUInt16(3),M.writeUInt16(1),M.writeUInt32(12),M.writeUInt16(4),M.writeUInt16(16+8*N+2*p.length),M.writeUInt16(0),M.writeUInt16(U),M.writeUInt16(T),M.writeUInt16(g),M.writeUInt16(V),ce=0,A=v.length;ce<A;ce++)i=v[ce],M.writeUInt16(i);for(M.writeUInt16(0),me=0,P=L.length;me<P;me++)i=L[me],M.writeUInt16(i);for(we=0,q=c.length;we<q;we++)l=c[we],M.writeUInt16(l);for(Ee=0,te=oe.length;Ee<te;Ee++)D=oe[Ee],M.writeUInt16(D);for(Le=0,le=p.length;Le<le;Le++)k=p[Le],M.writeUInt16(k);return{charMap:r,subtable:M.data,maxGlyphID:R+1}}},t}(),rS=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,r,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=i?r<i:r>i;r=0<=i?++r:--r)n=new C5(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var r,i;return n==null&&(n="macroman"),r=C5.encode(e,n),(i=new bl).writeUInt16(0),i.writeUInt16(1),r.table=i.data.concat(r.subtable),r},t}(),dO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),hO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var n,r;for(r=[],n=0;n<10;++n)r.push(e.readByte());return r}(),this.charRange=function(){var n,r;for(r=[],n=0;n<4;++n)r.push(e.readInt());return r}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var n,r;for(r=[],n=0;n<2;n=++n)r.push(e.readInt());return r}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),fO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="post",t.prototype.parse=function(e){var n,r,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(r=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)n=e.readByte(),i.push(this.names.push(e.readString(n)));return i;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t}(),mO=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},pO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="name",t.prototype.parse=function(e){var n,r,i,s,o,l,c,u,f,v,g;for(e.pos=this.offset,e.readShort(),n=e.readShort(),l=e.readShort(),r=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},s=f=0,v=r.length;f<v;s=++f)i=r[s],e.pos=i.offset,u=e.readString(i.length),o=new mO(u,i),c[g=i.nameID]==null&&(c[g]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),gO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),vO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,r,i,s,o,l,c;for(e.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,f;for(f=[],n=u=0;0<=i?u<i:u>i;n=0<=i?++u:--u)f.push(e.readInt16());return f}(),this.widths=(function(){var u,f,v,g;for(g=[],u=0,f=(v=this.metrics).length;u<f;u++)s=v[u],g.push(s.advance);return g}).call(this),r=this.widths[this.widths.length-1],c=[],n=o=0;0<=i?o<i:o>i;n=0<=i?++o:--o)c.push(this.widths.push(r));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),iS=[].slice,yO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,r,i,s,o,l,c,u,f,v;return e in this.cache?this.cache[e]:(s=this.file.loca,n=this.file.contents,r=s.indexOf(e),(i=s.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+r,o=(l=new bl(n.read(i))).readShort(),u=l.readShort(),v=l.readShort(),c=l.readShort(),f=l.readShort(),this.cache[e]=o===-1?new bO(l,u,v,c,f):new xO(l,o,u,v,c,f),this.cache[e]))},t.prototype.encode=function(e,n,r){var i,s,o,l,c;for(o=[],s=[],l=0,c=n.length;l<c;l++)i=e[n[l]],s.push(o.length),i&&(o=o.concat(i.encode(r)));return s.push(o.length),{table:o,offsets:s}},t}(),xO=function(){function t(e,n,r,i,s,o){this.raw=e,this.numberOfContours=n,this.xMin=r,this.yMin=i,this.xMax=s,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),bO=function(){function t(e,n,r,i,s){var o,l;for(this.raw=e,this.xMin=n,this.yMin=r,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,n,r;for(n=new bl(iS.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)n.pos=this.glyphOffsets[e];return n.data},t}(),wO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="loca",t.prototype.parse=function(e){var n,r;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,s;for(s=[],r=0,i=this.length;r<i;r+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],r=0,i=this.length;r<i;r+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var r=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<r.length;++o)if(r[o]=i,s<n.length&&n[s]==o){++s,r[o]=i;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(i+=c)}for(var u=new Array(4*r.length),f=0;f<r.length;++f)u[4*f+3]=255&r[f],u[4*f+2]=(65280&r[f])>>8,u[4*f+1]=(16711680&r[f])>>16,u[4*f]=(4278190080&r[f])>>24;return u},t}(),NO=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,n,r,i,s;for(n in i=this.font.cmap.tables[0].codeMap,e={},s=this.subset)r=s[n],e[n]=i[r];return e},t.prototype.glyphsFor=function(e){var n,r,i,s,o,l,c;for(i={},o=0,l=e.length;o<l;o++)i[s=e[o]]=this.font.glyf.glyphFor(s);for(s in n=[],i)(r=i[s])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(s in c=this.glyphsFor(n))r=c[s],i[s]=r;return i},t.prototype.encode=function(e,n){var r,i,s,o,l,c,u,f,v,g,p,S,k,C,b;for(i in r=rS.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),p={0:0},b=r.charMap)p[(c=b[i]).old]=c.new;for(S in g=r.maxGlyphID,o)S in p||(p[S]=g++);return f=function(I){var R,D;for(R in D={},I)D[I[R]]=R;return D}(p),v=Object.keys(f).sort(function(I,R){return I-R}),k=function(){var I,R,D;for(D=[],I=0,R=v.length;I<R;I++)l=v[I],D.push(f[l]);return D}(),s=this.font.glyf.encode(o,k,p),u=this.font.loca.encode(s.offsets,k),C={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(C["OS/2"]=this.font.os2.raw()),this.font.directory.encode(C)},t}();ot.API.PDFObject=function(){var t;function e(){}return t=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},e.convert=function(n){var r,i,s,o;if(Array.isArray(n))return"["+function(){var l,c,u;for(u=[],l=0,c=n.length;l<c;l++)r=n[l],u.push(e.convert(r));return u}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(i in s=["<<"],n)o=n[i],s.push("/"+i+" "+e.convert(o));return s.push(">>"),s.join(`
`)}return""+n},e}();function _O({userRole:t}){const{addNotification:e}=pn(),[n,r]=ue.useState([]),[i,s]=ue.useState([]),[o,l]=ue.useState(""),[c,u]=ue.useState("Todos"),[f,v]=ue.useState("Todos"),[g,p]=ue.useState(!0),[S,k]=ue.useState("history"),[C,b]=ue.useState(null),[I,R]=ue.useState(!1),D=["Todos","Pendiente","Procesando","Completado","Fallido","Cancelado","Reembolsado"],ee=["Todos","Bold","PayPal","PayU","Transferencia Bancaria","Manual"];ue.useEffect(()=>{const F=Ut(Ve,"artifacts",Fe,"public","data","payments"),X=Gt(F,Y=>{console.log("Admin payments snapshot:",Y.size,"documents");const B=Y.docs.map(A=>{const P=A.data();return console.log("Payment doc:",A.id,P),{id:A.id,...P}});B.sort((A,P)=>{var le,ce;const q=((le=A.createdAt)==null?void 0:le.seconds)||0;return(((ce=P.createdAt)==null?void 0:ce.seconds)||0)-q}),console.log("Admin payments loaded:",B.length,B),r(B),p(!1)},Y=>{console.error("Error loading payments:",Y),e("Error al cargar los pagos","error"),p(!1)}),H=An(Ut(Ve,"artifacts",Fe,"public","data","users"),cr("role","==","client")),W=Gt(H,Y=>{const B=Y.docs.map(A=>({id:A.id,...A.data()}));s(B)});return()=>{X(),W()}},[e]);const oe=n.filter(F=>{var Y,B,A,P;const X=((Y=F.serviceNumber)==null?void 0:Y.toLowerCase().includes(o.toLowerCase()))||((B=F.clientName)==null?void 0:B.toLowerCase().includes(o.toLowerCase()))||((A=F.clientEmail)==null?void 0:A.toLowerCase().includes(o.toLowerCase()))||((P=F.transactionId)==null?void 0:P.toLowerCase().includes(o.toLowerCase())),H=c==="Todos"||F.status===c,W=f==="Todos"||F.gateway===f;return X&&H&&W}),V=async(F,X=null)=>{try{if(X!=null&&X.exchangeRate)return Number(X.exchangeRate);const H=F instanceof Date?F:new Date(F),W=H.toISOString().split("T")[0];try{if(Math.floor((new Date-H)/(1e3*60*60*24))<=7){const A=await fetch("https://api.exchangerate.host/latest?base=USD&symbols=COP");if(A.ok){const P=await A.json();if(P.success&&P.rates&&P.rates.COP)return Number(P.rates.COP)}}else{const A=await fetch(`https://api.exchangerate.host/${W}?base=USD&symbols=COP`);if(A.ok){const P=await A.json();if(P.success&&P.rates&&P.rates.COP)return Number(P.rates.COP)}}}catch(Y){console.warn("Error obteniendo tasa de cambio de API:",Y)}return console.warn("Usando tasa de cambio predeterminada (4000 COP/USD). Para tasas histricas precisas, configure una API key."),4e3}catch(H){return console.error("Error en getExchangeRate:",H),4e3}},T=async F=>{var X;try{if(!F||!F.id){console.error("Payment invlido para generar invoice:",F);return}const W="INV-"+String(F.id||"").slice(-8).toUpperCase(),Y=(X=F.createdAt)!=null&&X.seconds?new Date(F.createdAt.seconds*1e3):new Date,B=Y.toLocaleDateString("es-ES"),A=F.dueDate?new Date(F.dueDate.seconds*1e3).toLocaleDateString("es-ES"):"N/A",P=String(F.clientName||"Cliente"),q=String(F.clientEmail||"N/A"),te=String(F.serviceNumber||"N/A"),le=String(F.serviceType||"Servicio"),ce=String(F.description||"Descripcin del servicio"),me=Number(F.amount||0),he=String(F.currency||"USD"),we=String(F.gateway||"N/A"),Ee=String(F.transactionId||"N/A"),Le=String(F.paymentMethod||"N/A");let Re=me,xe=he,re=null,qe=null,dt=null;he&&he.toUpperCase()==="USD"?(qe=await V(Y,F),dt=Y.toLocaleDateString("es-ES"),re=me,Re=me*qe,xe="COP"):(he&&he.toUpperCase()==="COP"||(console.warn("Pago sin moneda definida, asumiendo USD"),qe=await V(Y,F),dt=Y.toLocaleDateString("es-ES"),re=me,Re=me*qe),xe="COP");const lt=Re.toLocaleString("es-CO",{minimumFractionDigits:2,maximumFractionDigits:2}),Oe=re?re.toFixed(2):null,Qe=qe?qe.toLocaleString("es-CO",{minimumFractionDigits:2,maximumFractionDigits:2}):null,Se=new ot;let $e=20;return Se.setFontSize(24),Se.setTextColor(37,99,235),Se.text("Gestor de Cobros",105,$e,{align:"center"}),$e+=10,Se.setFontSize(18),Se.setTextColor(102,102,102),Se.text("FACTURA",105,$e,{align:"center"}),$e+=20,Se.setFontSize(12),Se.setTextColor(0,0,0),Se.setFont(void 0,"bold"),Se.text("Cliente:",20,$e),Se.setFont(void 0,"normal"),Se.text(P,60,$e),$e+=7,Se.text(q,60,$e),$e+=15,Se.setFont(void 0,"bold"),Se.text("Detalles de la Factura:",20,$e),$e+=7,Se.setFont(void 0,"normal"),Se.text("Nmero: "+W,20,$e),$e+=7,Se.text("Fecha: "+B,20,$e),$e+=7,Se.text("Vencimiento: "+A,20,$e),$e+=7,Se.text("Estado: Completado",20,$e),$e+=15,Se.setFont(void 0,"bold"),Se.text("Detalles del Servicio:",20,$e),$e+=10,Se.setFillColor(248,249,250),Se.rect(20,$e-5,170,8,"F"),Se.setFont(void 0,"bold"),Se.text("Servicio",25,$e),Se.text("Descripcin",70,$e),Se.text("Monto",165,$e,{align:"right"}),$e+=10,Se.setFont(void 0,"normal"),Se.text(le,25,$e),Se.text(ce.substring(0,35),70,$e),Se.text(xe+" "+lt,165,$e,{align:"right"}),$e+=10,re&&qe&&(Se.setFontSize(8),Se.setTextColor(102,102,102),Se.text("Equivale a USD "+Oe+" (Tasa: "+Qe+" COP/USD del "+dt+")",165,$e,{align:"right"}),$e+=10),$e+=5,Se.setFontSize(16),Se.setFont(void 0,"bold"),Se.setTextColor(37,99,235),Se.text("Total: "+xe+" "+lt,165,$e,{align:"right"}),$e+=20,Se.setFontSize(10),Se.setTextColor(102,102,102),Se.setFont(void 0,"normal"),Se.text("Mtodo de Pago: "+Le,20,$e),$e+=6,Se.text("Gateway: "+we,20,$e),$e+=6,Ee!=="N/A"&&(Se.text("ID de Transaccin: "+Ee,20,$e),$e+=6),Se.text("Gracias por su negocio",105,$e,{align:"center"}),Se.save("invoice-"+W+".pdf"),Se}catch(H){return console.error("Error generando PDF:",H),e("Error al generar el PDF del invoice","error"),null}},N=async(F,X)=>{try{const H=ut(Ve,"artifacts",Fe,"public","data","payments",F),W=await vs(H);if(!W.exists()){e("No se encontr el pago","error");return}const Y={id:F,...W.data()};if(await gr(H,{status:X,updatedAt:ft.now(),...X==="Completado"?{completedAt:ft.now()}:{}}),X==="Completado"){const B=await vs(H),A={id:F,...B.data(),clientName:B.data().clientName||Y.clientName||"Cliente",clientEmail:B.data().clientEmail||Y.clientEmail||"N/A",serviceNumber:B.data().serviceNumber||Y.serviceNumber||"N/A",serviceType:B.data().serviceType||Y.serviceType||"Servicio",description:B.data().description||Y.description||"Descripcin del servicio",amount:B.data().amount||Y.amount||0,currency:B.data().currency||Y.currency||"USD",gateway:B.data().gateway||Y.gateway||"N/A",transactionId:B.data().transactionId||Y.transactionId||"N/A",paymentMethod:B.data().paymentMethod||Y.paymentMethod||"N/A",createdAt:B.data().createdAt||Y.createdAt,dueDate:B.data().dueDate||Y.dueDate};await T(A);try{const q=A.clientEmail||A.userEmail,te=A.clientName||"Cliente";if(q&&q!=="N/A"){const le="INV-"+F.slice(-8).toUpperCase(),ce=A.currency==="COP"?new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(A.amount):new Intl.NumberFormat("es-ES",{style:"currency",currency:"USD"}).format(A.amount),me=`Pago Aprobado - ${A.serviceNumber||"N/A"}`,he=`
              <div style="font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: 0 auto;">
                <h2 style="color: #059669;"> Pago Aprobado</h2>
                <p>Estimado/a <strong>${te}</strong>,</p>
                <p>Su pago por el servicio <strong>${A.serviceNumber||"N/A"}</strong> ha sido aprobado exitosamente.</p>
                <div style="background-color: #f3f4f6; padding: 15px; border-radius: 8px; margin: 20px 0;">
                  <h3 style="margin-top: 0;">Detalles del Pago:</h3>
                  <ul style="list-style: none; padding: 0;">
                    <li><strong>Servicio:</strong> ${A.serviceType||"N/A"}</li>
                    <li><strong>Monto:</strong> ${ce}</li>
                    <li><strong>Mtodo:</strong> ${A.gateway||A.paymentMethod||"N/A"}</li>
                    <li><strong>Factura:</strong> ${le}</li>
                    <li><strong>Fecha:</strong> ${new Date().toLocaleDateString("es-ES")}</li>
                  </ul>
                </div>
                <p>Su servicio est ahora activo. Puede descargar la factura desde su panel de pagos.</p>
                <p style="margin-top: 30px;">Gracias por su pago.</p>
                <p style="color: #6b7280; font-size: 12px; margin-top: 20px;">
                  Este es un email automtico, por favor no responda.
                </p>
              </div>
            `,we=`
Pago Aprobado

Estimado/a ${te},

Su pago por el servicio ${A.serviceNumber||"N/A"} ha sido aprobado exitosamente.

Detalles del Pago:
- Servicio: ${A.serviceType||"N/A"}
- Monto: ${ce}
- Mtodo: ${A.gateway||A.paymentMethod||"N/A"}
- Factura: ${le}
- Fecha: ${new Date().toLocaleDateString("es-ES")}

Su servicio est ahora activo. Puede descargar la factura desde su panel de pagos.

Gracias por su pago.
            `;await fr({to:q,toName:te,subject:me,html:he,text:we,type:"Aprobacin",recipientType:"Cliente",module:"payments",event:"approval",metadata:{paymentId:F,serviceId:A.serviceId,invoiceNumber:le}})}}catch(q){console.error("Error enviando email de aprobacin:",q)}const P=A.serviceId;if(P)try{const q=ut(Ve,"artifacts",Fe,"public","data","services",P),te=await vs(q);if(te.exists()){const le=te.data(),ce={updatedAt:ft.now()};A.isRenewal||A.paymentType==="Renovacin"?(A.startDate&&(ce.dueDate=A.startDate),A.endDate&&(ce.expirationDate=A.endDate),ce.status="Activo"):(le.billingCycle==="One-Time"||A.paymentType==="Pago nico")&&(ce.paidDate=ft.now(),ce.status="Completado"),Object.keys(ce).length>1&&await gr(q,ce)}}catch(q){console.error("Error actualizando servicio despus de completar pago:",q)}e("Pago completado, servicio actualizado e invoice generado","success")}else if(X==="Fallido"||X==="Cancelado"){try{const B=Y.clientEmail||Y.userEmail,A=Y.clientName||"Cliente";if(B&&B!=="N/A"){const P=`Actualizacin de Pago - ${Y.serviceNumber||"N/A"}`,q=`
              <div style="font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: 0 auto;">
                <h2 style="color: #dc2626;"> ${X==="Fallido"?"Pago Fallido":"Pago Cancelado"}</h2>
                <p>Estimado/a <strong>${A}</strong>,</p>
                <p>Lamentamos informarle que su pago por el servicio <strong>${Y.serviceNumber||"N/A"}</strong> ha sido ${X==="Fallido"?"rechazado":"cancelado"}.</p>
                <div style="background-color: #fef2f2; padding: 15px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #dc2626;">
                  <p style="margin: 0;"><strong>Por favor, verifique:</strong></p>
                  <ul style="list-style: none; padding: 0; margin: 10px 0 0 0;">
                    <li> Los datos de su mtodo de pago</li>
                    <li> Que tenga fondos suficientes</li>
                    <li> Que su mtodo de pago est activo</li>
                  </ul>
                </div>
                <p>Si necesita ayuda, por favor contacte a nuestro equipo de soporte.</p>
                <p style="margin-top: 30px;">Gracias por su comprensin.</p>
                <p style="color: #6b7280; font-size: 12px; margin-top: 20px;">
                  Este es un email automtico, por favor no responda.
                </p>
              </div>
            `,te=`
${X==="Fallido"?"Pago Fallido":"Pago Cancelado"}

Estimado/a ${A},

Lamentamos informarle que su pago por el servicio ${Y.serviceNumber||"N/A"} ha sido ${X==="Fallido"?"rechazado":"cancelado"}.

Por favor, verifique:
- Los datos de su mtodo de pago
- Que tenga fondos suficientes
- Que su mtodo de pago est activo

Si necesita ayuda, por favor contacte a nuestro equipo de soporte.

Gracias por su comprensin.
            `;await fr({to:B,toName:A,subject:P,html:q,text:te,type:"Rechazo",recipientType:"Cliente",module:"payments",event:"rejection",metadata:{paymentId:F,serviceId:Y.serviceId,status:X}})}}catch(B){console.error("Error enviando email de rechazo:",B)}e(`Estado del pago actualizado a ${X}`,"success")}else e(`Estado del pago actualizado a ${X}`,"success")}catch(H){console.error("Error updating payment status:",H),e("Error al actualizar el estado del pago","error")}},U=async F=>{try{await T(F),e("Invoice PDF descargado exitosamente","success")}catch(X){console.error("Error descargando invoice:",X),e("Error al generar el invoice PDF","error")}},E=async F=>{if(window.confirm("Ests seguro de que quieres eliminar este pago? Esta accin no se puede deshacer."))try{await yl(ut(Ve,"artifacts",Fe,"public","data","payments",F)),e("Pago eliminado exitosamente","success")}catch(X){console.error("Error deleting payment:",X),e("Error al eliminar el pago","error")}},L=F=>({Pendiente:"bg-yellow-100 text-yellow-800",Procesando:"bg-blue-100 text-blue-800",Completado:"bg-green-100 text-green-800",Fallido:"bg-red-100 text-red-800",Cancelado:"bg-gray-100 text-gray-800",Reembolsado:"bg-purple-100 text-purple-800"})[F]||"bg-gray-100 text-gray-800",_=F=>({Bold:"bg-blue-100 text-blue-800",PayPal:"bg-yellow-100 text-yellow-800",PayU:"bg-green-100 text-green-800","Transferencia Bancaria":"bg-purple-100 text-purple-800",Manual:"bg-gray-100 text-gray-800"})[F]||"bg-gray-100 text-gray-800",M=F=>F?new Date(F.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",K=(F,X)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:X||"USD"}).format(F);return g?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsx("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(Ji,{}),"Gestin de Pagos"]})}),a.jsx("div",{className:"border-b border-gray-200 mb-6",children:a.jsxs("nav",{className:"-mb-px flex space-x-8",children:[a.jsxs("button",{onClick:()=>k("history"),className:`${S==="history"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(Ji,{}),"Historial de Pagos"]}),a.jsxs("button",{onClick:()=>k("renewal"),className:`${S==="renewal"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(dl,{}),"Renovaciones"]}),t==="superadmin"&&a.jsxs("button",{onClick:()=>k("config"),className:`${S==="config"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(eg,{}),"Configuracin"]})]})}),S==="renewal"?a.jsxs("div",{className:"p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Configuracin de Renovaciones"}),a.jsx(P8,{})]}):S==="config"?a.jsx(fA,{}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:a.jsxs("div",{className:"text-sm text-gray-500",children:[oe.length," pago",oe.length!==1?"s":""," encontrado",oe.length!==1?"s":""]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar por servicio, cliente, email o transaccin...",value:o,onChange:F=>l(F.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Uu,{})})]}),a.jsx("select",{value:c,onChange:F=>u(F.target.value),className:"w-full p-2 border rounded-md",children:D.map(F=>a.jsx("option",{value:F,children:F},F))}),a.jsx("select",{value:f,onChange:F=>v(F.target.value),className:"w-full p-2 border rounded-md",children:ee.map(F=>a.jsx("option",{value:F,children:F},F))}),a.jsxs("button",{className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:[a.jsx(uu,{}),"Filtros"]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Servicio","Cliente","Monto","Estado","Pasarela","Transaccin","Fecha","Acciones"].map(F=>a.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:F},F))})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:oe.map(F=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:F.serviceNumber||F.id}),a.jsx("div",{className:"text-sm text-gray-600",children:F.serviceName||F.serviceType||"N/A"}),F.serviceDescription&&a.jsx("div",{className:"text-xs text-gray-500 truncate max-w-xs",children:F.serviceDescription}),F.isRenewal&&a.jsxs("div",{className:"text-xs text-green-600 font-medium",children:["Renovacin: ",F.renewalPeriod||"N/A"]})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-medium text-gray-900",children:F.clientName}),a.jsx("div",{className:"text-sm text-gray-500",children:F.clientEmail})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"font-semibold text-gray-900",children:K(F.amount,F.currency)})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${L(F.status)}`,children:F.status})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${_(F.gateway)}`,children:F.gateway})}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-mono text-sm text-gray-600",children:F.transactionId||"N/A"}),F.proofUrl&&a.jsx("div",{className:"mt-2",children:a.jsx("button",{onClick:()=>{b(F),R(!0)},className:"px-2 py-1 text-xs bg-purple-100 text-purple-700 rounded hover:bg-purple-200",children:"Ver Comprobante"})})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsxs("div",{className:"text-sm text-gray-900 flex items-center gap-2",children:[M(F.createdAt),F.proofUrl&&a.jsx("span",{className:"ml-2 inline-flex px-2 py-0.5 text-xs rounded-full bg-purple-100 text-purple-700",title:"Comprobante adjunto",children:"Comprobante"})]}),F.completedAt&&a.jsxs("div",{className:"text-xs text-gray-500",children:["Completado: ",M(F.completedAt)]}),F.startDate&&F.endDate&&a.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[a.jsxs("div",{children:["Inicio: ",M(F.startDate)]}),a.jsxs("div",{children:["Fin: ",M(F.endDate)]})]})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[F.proofUrl&&a.jsx("button",{onClick:()=>{b(F),R(!0)},className:"p-2 text-purple-600 hover:bg-purple-50 rounded-md",title:"Ver comprobante de pago",children:a.jsx(xl,{})}),t==="superadmin"&&a.jsx(a.Fragment,{children:a.jsxs(Vh,{children:[a.jsx("select",{value:F.status,onChange:X=>N(F.id,X.target.value),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 border-none bg-transparent",children:D.filter(X=>X!=="Todos").map(X=>a.jsx("option",{value:X,children:X},X))}),a.jsxs("button",{onClick:()=>U(F),className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50 flex items-center",children:[a.jsx(xl,{className:"h-4 w-4 mr-2"}),"Descargar Invoice"]}),a.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:"Ver Detalles"}),a.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-yellow-700 hover:bg-yellow-50",children:"Reembolsar"}),a.jsxs("button",{onClick:()=>E(F.id),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50 flex items-center",children:[a.jsx(lA,{className:"h-4 w-4 mr-2"}),"Eliminar Pago"]})]})})]})})]},F.id))})]})}),oe.length===0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(Ji,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron pagos"}),a.jsx("p",{className:"text-gray-500",children:"No hay pagos que coincidan con los filtros seleccionados."})]})]}),I&&(C==null?void 0:C.proofUrl)&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-4 flex justify-between items-center border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Comprobante de Pago"}),a.jsx("button",{onClick:()=>{R(!1),b(null)},className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsx("div",{className:"p-4",children:a.jsx("img",{src:C.proofUrl,alt:"Comprobante",className:"max-w-full h-auto rounded"})})]})})]})}function EO(){const{addNotification:t}=pn(),[e,n]=ue.useState({provider:"smtp",smtpHost:"",smtpPort:587,smtpSecure:!1,smtpUser:"",smtpPassword:"",zohoClientId:"",zohoClientSecret:"",zohoRefreshToken:"",zohoAccessToken:"",zohoAccessTokenExpiry:null,fromEmail:"",fromName:"",enabled:!1}),[r,i]=ue.useState(!1),[s,o]=ue.useState("");ue.useEffect(()=>{const f=ut(Ve,"artifacts",Fe,"public","data","settings","email_config"),v=Gt(f,g=>{if(g.exists()){const p=g.data();n({...p,smtpUser:p.smtpUser?p.smtpUser.trim():"",smtpHost:p.smtpHost?p.smtpHost.trim():"",fromEmail:p.fromEmail?p.fromEmail.trim():""})}},g=>{console.error("Error loading email config:",g),g.code==="permission-denied"&&t("Error de permisos al cargar configuracin de email. Verifica las reglas de Firestore.","error")});return()=>v()},[]);const l=f=>{const{name:v,value:g,type:p,checked:S}=f.target;let k=g;p==="text"&&(v==="smtpUser"||v==="smtpHost"||v==="fromEmail")&&(k=g.trim()),n(C=>({...C,[v]:p==="checkbox"?S:p==="number"?parseInt(g)||0:k}))},c=async()=>{try{const f=ut(Ve,"artifacts",Fe,"public","data","settings","email_config");await ws(f,{...e,updatedAt:new Date},{merge:!0}),t("Configuracin de email guardada exitosamente","success")}catch(f){console.error("Error saving email config:",f),t("Error al guardar la configuracin","error")}},u=async()=>{if(!s||!s.includes("@")){t("Ingresa un email vlido para probar","error");return}i(!0);try{const f=ut(Ve,"artifacts",Fe,"public","data","settings","email_config");await ws(f,e,{merge:!0}),await new Promise(g=>setTimeout(g,500));const v=await N8(s);if(v.success)if(v.sent)t(` Email de prueba enviado exitosamente a ${s}. Revisa tu bandeja de entrada (y spam).`,"success");else if(v.simulated){const g=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";t(g?" Modo desarrollo: El email se registr pero no se envi (servidor PHP no disponible localmente). Despliega en produccin para envo real.":" Email de prueba registrado en historial. Verifica la configuracin SMTP si no se envi.","warning")}else t(" Email de prueba procesado. Revisa el historial de mensajes para ver el estado.","info");else{const g=v.error||"Error desconocido",p=v.details||"";let S="";g.includes("send-email.php")||g.includes("404")||g.includes("no se encontr")?S=" Verifica que send-email.php est en el servidor y que PHPMailer est instalado. Consulta VERIFICAR-PHP.md":g.includes("PHPMailer")||g.includes("Class")?S=" PHPMailer no est instalado. Ejecuta: composer require phpmailer/phpmailer":g.includes("Could not authenticate")||g.includes("authentication")?S=p||" Verifica: 1) Usuario SMTP debe ser el email completo (ej: noreply@dominio.com), 2) Contrasea correcta, 3) Puerto y conexin segura (587 con TLS o 465 con SSL), 4) Servidor SMTP correcto":(g.includes("SMTP")||g.includes("connect"))&&(S=p||" Verifica la configuracin SMTP (servidor, puerto, usuario, contrasea)");const k=p?` Error al enviar email: ${g}

${p}`:` Error al enviar email: ${g}${S}`;t(k,"error")}}catch(f){console.error("Error testing email:",f),t("Error al enviar email de prueba: "+f.message,"error")}finally{i(!1)}};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Configuracin de Email"}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Proveedor de Email"}),a.jsxs("select",{name:"provider",value:e.provider||"smtp",onChange:l,className:"w-full p-2 border rounded-md",children:[a.jsx("option",{value:"smtp",children:"SMTP (Servidor de Correo)"}),a.jsx("option",{value:"zoho",children:"Zoho Mail API"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.provider==="zoho"?"Zoho Mail API: Envo directo va API REST, mejor deliverability, sin necesidad de servidor SMTP.":"SMTP: Mtodo tradicional, requiere servidor SMTP configurado (cPanel, Gmail, etc.)."})]}),e.provider==="zoho"?a.jsxs("div",{className:"space-y-4 border-t pt-4",children:[a.jsx("h4",{className:"font-semibold text-gray-800",children:"Configuracin Zoho Mail API"}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[a.jsx("p",{className:"text-sm font-medium text-blue-800 mb-2",children:" Pasos para Configurar Zoho Mail API:"}),a.jsxs("ol",{className:"text-sm text-blue-700 space-y-1 list-decimal list-inside",children:[a.jsxs("li",{children:["Registra tu aplicacin en ",a.jsx("a",{href:"https://api-console.zoho.com",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Zoho API Console"})]}),a.jsx("li",{children:"Obtn tu Client ID y Client Secret"}),a.jsx("li",{children:"Genera un Refresh Token (una vez, no expira)"}),a.jsx("li",{children:"Configura los permisos de Zoho Mail API"}),a.jsx("li",{children:"Ingresa las credenciales a continuacin"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client ID (Zoho)"}),a.jsx("input",{type:"text",name:"zohoClientId",value:e.zohoClientId,onChange:l,placeholder:"1000.XXXXXXXXXX",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Obtn esto desde Zoho API Console"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Secret (Zoho)"}),a.jsx("input",{type:"password",name:"zohoClientSecret",value:e.zohoClientSecret,onChange:l,placeholder:"",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Secreto de tu aplicacin Zoho"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Refresh Token (Zoho)"}),a.jsx("input",{type:"password",name:"zohoRefreshToken",value:e.zohoRefreshToken,onChange:l,placeholder:"1000.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Genera este token una vez desde Zoho API Console. No expira hasta que lo revoques."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Remitente (Zoho)"}),a.jsx("input",{type:"email",name:"fromEmail",value:e.fromEmail,onChange:l,placeholder:"noreply@tudominio.com",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Debe ser un email configurado en tu cuenta Zoho Mail"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Remitente"}),a.jsx("input",{type:"text",name:"fromName",value:e.fromName,onChange:l,placeholder:"Gestor de Cobros",className:"w-full p-2 border rounded-md"})]})]})]}):a.jsxs("div",{className:"space-y-4 border-t pt-4",children:[a.jsx("h4",{className:"font-semibold text-gray-800",children:"Configuracin SMTP"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Servidor SMTP"}),a.jsx("input",{type:"text",name:"smtpHost",value:e.smtpHost,onChange:l,placeholder:"smtp.gmail.com",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ejemplo: smtp.gmail.com, smtp.outlook.com"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Puerto SMTP"}),a.jsx("input",{type:"number",name:"smtpPort",value:e.smtpPort,onChange:l,placeholder:"587",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Puerto comn: 587 (TLS) o 465 (SSL)"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Usuario SMTP"}),a.jsx("input",{type:"text",name:"smtpUser",value:e.smtpUser,onChange:l,placeholder:"tu-email@dominio.com",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrasea SMTP"}),a.jsx("input",{type:"password",name:"smtpPassword",value:e.smtpPassword,onChange:l,placeholder:"",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Para Gmail: usa una "Contrasea de aplicacin"'})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Remitente"}),a.jsx("input",{type:"email",name:"fromEmail",value:e.fromEmail,onChange:l,placeholder:"noreply@tuempresa.com",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Remitente"}),a.jsx("input",{type:"text",name:"fromName",value:e.fromName,onChange:l,placeholder:"Gestor de Cobros",className:"w-full p-2 border rounded-md"})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"smtpSecure",name:"smtpSecure",checked:e.smtpSecure,onChange:l,className:"w-4 h-4 text-blue-600 border-gray-300 rounded"}),a.jsx("label",{htmlFor:"smtpSecure",className:"text-sm font-medium text-gray-700",children:"Usar conexin segura (SSL/TLS)"})]}),a.jsxs("div",{className:"flex items-center space-x-2 pt-4 border-t",children:[a.jsx("input",{type:"checkbox",id:"enabled",name:"enabled",checked:e.enabled,onChange:l,className:"w-4 h-4 text-blue-600 border-gray-300 rounded"}),a.jsx("label",{htmlFor:"enabled",className:"text-sm font-medium text-gray-700",children:"Habilitar servicio de email"})]}),a.jsx("div",{className:"flex justify-end space-x-4 pt-4",children:a.jsx("button",{onClick:c,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Guardar Configuracin"})})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Probar Configuracin"}),window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:[a.jsx("p",{className:"text-sm font-medium text-yellow-800 mb-2",children:" Modo Desarrollo Local:"}),a.jsxs("p",{className:"text-sm text-yellow-700",children:["Ests en desarrollo local. El servidor PHP no est disponible, por lo que los emails se registrarn en el historial pero ",a.jsx("strong",{children:"NO se enviarn realmente"}),". Para probar el envo real, despliega la aplicacin en produccin (Dockge o cPanel)."]})]}):a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:[a.jsx("p",{className:"text-sm font-medium text-green-800 mb-2",children:" Emails Reales Activados:"}),a.jsx("p",{className:"text-sm text-green-700",children:"Los emails se estn enviando realmente usando el servidor SMTP configurado. El email de prueba se enviar a la direccin que especifiques."})]}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"El email de prueba se registrar en el historial (modo desarrollo). En produccin se enviar realmente.":"El email de prueba se enviar realmente usando tu configuracin SMTP. Verifica tu bandeja de entrada."}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("input",{type:"email",value:s,onChange:f=>o(f.target.value),placeholder:"email@ejemplo.com",className:"flex-1 p-2 border rounded-md"}),a.jsx("button",{onClick:u,disabled:r||!e.enabled,className:`px-6 py-2 rounded-md ${r||!e.enabled?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:r?"Enviando...":"Enviar Email de Prueba"})]}),!e.enabled&&a.jsx("p",{className:"text-sm text-yellow-600 mt-2",children:" Debes habilitar el servicio de email primero para poder enviar pruebas."})]})]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.provider==="zoho"?a.jsxs(a.Fragment,{children:[a.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Configuracin de Zoho Mail API"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:" Ventajas de Zoho Mail API"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc list-inside mb-2",children:[a.jsx("li",{children:"No requiere servidor SMTP configurado"}),a.jsx("li",{children:"Mejor deliverability (Zoho maneja la reputacin)"}),a.jsx("li",{children:"Tracking y analytics de emails"}),a.jsx("li",{children:"Sin lmites de conexiones SMTP"}),a.jsx("li",{children:"Respuestas de error ms detalladas"})]})]}),a.jsxs("div",{className:"border-t border-blue-300 pt-3 mt-3",children:[a.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:" Enlaces tiles:"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[a.jsxs("li",{children:[a.jsx("a",{href:"https://api-console.zoho.com",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Zoho API Console"})," - Registra tu aplicacin"]}),a.jsx("li",{children:a.jsx("a",{href:"https://www.zoho.com/mail/help/api/",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Documentacin Zoho Mail API"})}),a.jsx("li",{children:a.jsx("a",{href:"https://www.zoho.com/mail/help/dev-platform/connectors.html",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Gua de OAuth 2.0"})})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Configuracin de SMTP"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:" Usar cPanel (Recomendado si tienes hosting con cPanel)"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc list-inside mb-2",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Servidor SMTP:"})," ",a.jsx("code",{children:"mail.tu-dominio.com"})," o ",a.jsx("code",{children:"smtp.tu-dominio.com"})]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Puerto:"})," ",a.jsx("code",{children:"587"})," (TLS) o ",a.jsx("code",{children:"465"}),' (SSL) - Marca "Usar conexin segura"']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Usuario:"})," Email completo (ej: ",a.jsx("code",{children:"noreply@tu-dominio.com"}),")"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Contrasea:"})," La contrasea del email creado en cPanel"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Email Remitente:"})," El mismo email (ej: ",a.jsx("code",{children:"noreply@tu-dominio.com"}),")"]})]}),a.jsxs("p",{className:"text-xs text-blue-600 mt-2",children:[" ",a.jsx("strong",{children:"Ventaja:"})," No necesitas servicios externos, emails ilimitados desde tu propio dominio."]})]}),a.jsxs("div",{className:"border-t border-blue-300 pt-3 mt-3",children:[a.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:"Otros Servicios:"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc list-inside",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Gmail:"}),' smtp.gmail.com:587, usa "Contrasea de aplicacin"']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Outlook:"})," smtp-mail.outlook.com:587"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Yahoo:"})," smtp.mail.yahoo.com:587"]})]})]})]})})]})}function AO(){const{addNotification:t}=pn(),e={admin:{payments:{approval:!0,rejection:!0,newPayment:!0},services:{expirationReminder:!0,newService:!0},users:{newUser:!0,userActivation:!0},tickets:{newTicket:!0,ticketUpdate:!0},renewals:{renewalRequest:!0}},client:{payments:{approval:!0,rejection:!0,pendingPayment:!0},services:{expirationReminder:!0,serviceActivated:!0,serviceExpired:!0},tickets:{ticketReply:!0,ticketResolved:!0},renewals:{renewalReminder:!0,renewalConfirmed:!0}}},[n,r]=ue.useState(e),[i,s]=ue.useState(!0);ue.useEffect(()=>{const u=ut(Ve,"artifacts",Fe,"public","data","settings","notification_settings"),f=Gt(u,v=>{if(v.exists()){const g=v.data();r({admin:{...e.admin,...g.admin},client:{...e.client,...g.client}})}s(!1)});return()=>f()},[]);const o=(u,f,v)=>{r(g=>{var p;return{...g,[u]:{...g[u],[f]:{...g[u][f],[v]:!((p=g[u][f])!=null&&p[v])}}}})},l=async()=>{try{const u=ut(Ve,"artifacts",Fe,"public","data","settings","notification_settings");await ws(u,{...n,updatedAt:new Date},{merge:!0}),t("Configuracin de notificaciones guardada exitosamente","success")}catch(u){console.error("Error saving notification settings:",u),t("Error al guardar la configuracin","error")}},c={payments:{label:"Pagos",icon:"",admin:[{key:"approval",label:"Aprobacin de pago"},{key:"rejection",label:"Rechazo de pago"},{key:"newPayment",label:"Nuevo pago recibido"}],client:[{key:"approval",label:"Pago aprobado"},{key:"rejection",label:"Pago rechazado"},{key:"pendingPayment",label:"Recordatorio de pago pendiente"}]},services:{label:"Servicios",icon:"",admin:[{key:"expirationReminder",label:"Recordatorio de vencimiento"},{key:"newService",label:"Nuevo servicio creado"}],client:[{key:"expirationReminder",label:"Recordatorio de vencimiento"},{key:"serviceActivated",label:"Servicio activado"},{key:"serviceExpired",label:"Servicio vencido"}]},users:{label:"Usuarios",icon:"",admin:[{key:"newUser",label:"Nuevo usuario registrado"},{key:"userActivation",label:"Activacin de usuario"}],client:[]},tickets:{label:"Tickets",icon:"",admin:[{key:"newTicket",label:"Nuevo ticket creado"},{key:"ticketUpdate",label:"Actualizacin de ticket"}],client:[{key:"ticketReply",label:"Respuesta a ticket"},{key:"ticketResolved",label:"Ticket resuelto"}]},renewals:{label:"Renovaciones",icon:"",admin:[{key:"renewalRequest",label:"Solicitud de renovacin"}],client:[{key:"renewalReminder",label:"Recordatorio de renovacin"},{key:"renewalConfirmed",label:"Renovacin confirmada"}]}};return i?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Configuracin de Notificaciones"}),a.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Activa o desactiva las notificaciones por email segn el mdulo y el tipo de usuario."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold mb-4 bg-purple-100 text-purple-800 px-4 py-2 rounded-lg",children:" Notificaciones para Administradores"}),a.jsx("div",{className:"space-y-6",children:Object.entries(c).map(([u,f])=>!f.admin||f.admin.length===0?null:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[a.jsxs("h5",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx("span",{className:"text-2xl",children:f.icon}),f.label]}),a.jsx("div",{className:"space-y-3",children:f.admin.map(({key:v,label:g})=>{var p;return a.jsxs("div",{className:"flex items-center justify-between py-2 border-b",children:[a.jsx("span",{className:"text-sm text-gray-700",children:g}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:((p=n.admin[u])==null?void 0:p[v])??!1,onChange:()=>o("admin",u,v),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},v)})})]},u))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold mb-4 bg-blue-100 text-blue-800 px-4 py-2 rounded-lg",children:" Notificaciones para Clientes"}),a.jsx("div",{className:"space-y-6",children:Object.entries(c).map(([u,f])=>!f.client||f.client.length===0?null:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[a.jsxs("h5",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx("span",{className:"text-2xl",children:f.icon}),f.label]}),a.jsx("div",{className:"space-y-3",children:f.client.map(({key:v,label:g})=>{var p;return a.jsxs("div",{className:"flex items-center justify-between py-2 border-b",children:[a.jsx("span",{className:"text-sm text-gray-700",children:g}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:((p=n.client[u])==null?void 0:p[v])??!1,onChange:()=>o("client",u,v),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},v)})})]},u))})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx("button",{onClick:l,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium",children:"Guardar Configuracin"})})]})}function SO({userRole:t}){const[e,n]=ue.useState("history"),{addNotification:r}=pn(),[i,s]=ue.useState([]),[o,l]=ue.useState(""),[c,u]=ue.useState("Todos"),[f,v]=ue.useState("Todos"),[g,p]=ue.useState("Todos"),[S,k]=ue.useState(!0),[C,b]=ue.useState(null),[I,R]=ue.useState(!1),[D,ee]=ue.useState(null),oe=["Todos","Enviado","Entregado","Simulado","Ledo","Fallido","Cancelado","Pendiente"],V=["Todos","Aprobacin","Rechazo","Recordatorio","Notificacin","Activacin","Sistema"],T=["Todos","Cliente","Administrador","Sistema"];ue.useEffect(()=>{const Y=An(Ut(Ve,"artifacts",Fe,"public","data","messages"),Fu("sentAt","desc")),B=Gt(Y,A=>{const P=A.docs.map(q=>({id:q.id,...q.data()}));s(P),k(!1)},A=>{console.error("Error loading messages:",A),r("Error al cargar los mensajes.","error"),k(!1)});return()=>B()},[r]);const N=async(Y,B)=>{try{const A=ut(Ve,"artifacts",Fe,"public","data","messages",Y);await gr(A,{status:B,updatedAt:new Date}),r(`Estado del mensaje actualizado a ${B}`,"success")}catch(A){console.error("Error updating message status:",A),r("Error al actualizar el estado del mensaje","error")}},U=Y=>{b(Y),R(!0)},E=async(Y,B)=>{if(B&&B.stopPropagation(),D!==Y.id){ee(Y.id);try{await Nr();const A=Y.recipientEmail||Y.to,P=Y.recipientName||"",q=Y.subject||"Sin asunto",te=Y.message||Y.content||"",le=te.includes("<")&&te.includes(">"),ce=le?te:te.replace(/\n/g,"<br>"),me=le?te.replace(/<[^>]*>/g,""):te;await fr({to:A,toName:P,subject:`[Reenvo] ${q}`,html:ce,text:me,type:Y.type||"Notificacin",recipientType:Y.recipientType||"Cliente",module:Y.module||"system",event:Y.event||"resend",metadata:{originalMessageId:Y.id,originalSentAt:Y.sentAt,resendAt:new Date().toISOString()}}),r(`Mensaje reenviado exitosamente a ${A}`,"success"),I&&(C==null?void 0:C.id)===Y.id&&R(!1)}catch(A){console.error("Error resending message:",A),r(`Error al reenviar mensaje: ${A.message}`,"error")}finally{ee(null)}}},L=async(Y,B)=>{B&&B.stopPropagation();const A=Y.recipientEmail||Y.to||"este mensaje",P=Y.subject||"Sin asunto";if(window.confirm(`Eliminar permanentemente el mensaje "${P}" enviado a ${A}?

Esta accin no se puede deshacer.`))try{const q=ut(Ve,"artifacts",Fe,"public","data","messages",Y.id);await yl(q),r("Mensaje eliminado exitosamente","success"),I&&(C==null?void 0:C.id)===Y.id&&(R(!1),b(null))}catch(q){console.error("Error deleting message:",q),r(`Error al eliminar mensaje: ${q.message}`,"error")}},_=Y=>({Enviado:"bg-blue-100 text-blue-800",Entregado:"bg-green-100 text-green-800",Simulado:"bg-orange-100 text-orange-800",Ledo:"bg-purple-100 text-purple-800",Fallido:"bg-red-100 text-red-800",Cancelado:"bg-gray-100 text-gray-800",Pendiente:"bg-yellow-100 text-yellow-800"})[Y]||"bg-gray-100 text-gray-800",M=Y=>({Aprobacin:"bg-green-100 text-green-800",Rechazo:"bg-red-100 text-red-800",Recordatorio:"bg-yellow-100 text-yellow-800",Notificacin:"bg-blue-100 text-blue-800",Activacin:"bg-purple-100 text-purple-800",Sistema:"bg-gray-100 text-gray-800"})[Y]||"bg-gray-100 text-gray-800",K=Y=>({Cliente:"bg-blue-100 text-blue-800",Administrador:"bg-purple-100 text-purple-800",Sistema:"bg-gray-100 text-gray-800"})[Y]||"bg-gray-100 text-gray-800",F=Y=>Y?new Date(Y.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",X=Y=>{switch(Y){case"Enviado":return a.jsx(hs,{});case"Entregado":return a.jsx(uA,{});case"Simulado":return a.jsx("span",{title:" No enviado realmente",children:""});case"Ledo":return a.jsx(xl,{});case"Fallido":return a.jsx(ap,{});case"Pendiente":return a.jsx(hs,{});default:return a.jsx(hs,{})}},H=i.filter(Y=>{const B=o===""||Y.recipientName.toLowerCase().includes(o.toLowerCase())||Y.recipientEmail.toLowerCase().includes(o.toLowerCase())||Y.subject.toLowerCase().includes(o.toLowerCase())||Y.message.toLowerCase().includes(o.toLowerCase()),A=c==="Todos"||Y.status===c,P=f==="Todos"||Y.type===f,q=g==="Todos"||Y.recipientType===g;return B&&A&&P&&q});if(S)return a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const W=()=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Historial de Mensajes"}),a.jsxs("div",{className:"text-sm text-gray-500",children:[H.length," mensaje",H.length!==1?"s":""," encontrado",H.length!==1?"s":""]})]}),a.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6 rounded",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("span",{className:"text-blue-400 text-2xl",children:""})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Emails Reales Activados"}),a.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["Los emails se estn enviando realmente usando el servidor SMTP configurado. El historial muestra el estado de cada envo: ",a.jsx("span",{className:"font-semibold",children:'"Enviado"'}),", ",a.jsx("span",{className:"font-semibold",children:'"Fallido"'})," o ",a.jsx("span",{className:"font-semibold",children:'"Cancelado"'}),"."]})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar por destinatario, asunto o contenido...",value:o,onChange:Y=>l(Y.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Uu,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:c,onChange:Y=>u(Y.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:oe.map(Y=>a.jsx("option",{value:Y,children:Y},Y))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(uu,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:f,onChange:Y=>v(Y.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:V.map(Y=>a.jsx("option",{value:Y,children:Y},Y))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(am,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:g,onChange:Y=>p(Y.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:T.map(Y=>a.jsx("option",{value:Y,children:Y},Y))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(uu,{})})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Tipo","Mdulo","Destinatario","Asunto","Estado","Enviado","Entregado","Ledo","Acciones"].map(Y=>a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:Y},Y))})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:H.map(Y=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${M(Y.type)}`,children:Y.type}),a.jsx("span",{className:`ml-2 px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${K(Y.recipientType)}`,children:Y.recipientType})]})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900 capitalize",children:Y.module||"Sistema"}),Y.event&&a.jsx("div",{className:"text-xs text-gray-500 capitalize",children:Y.event.replace(/([A-Z])/g," $1").trim()}),Y.provider&&a.jsx("div",{className:"text-xs text-blue-600 font-medium mt-1",children:Y.provider==="zoho"?" Zoho Mail API":" SMTP"})]}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:Y.recipientName||"N/A"}),a.jsx("div",{className:"text-sm text-gray-500",children:Y.recipientEmail||Y.to||"N/A"})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",title:Y.subject,children:Y.subject})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${_(Y.status)}`,children:Y.status}),a.jsx("div",{className:"ml-2 text-gray-400",children:X(Y.status)}),Y.status==="Simulado"&&a.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-orange-200 text-orange-800 rounded-full",title:"Email histrico - antes de implementar envo real",children:" Histrico"})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:F(Y.sentAt)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Y.deliveredAt?F(Y.deliveredAt):"--"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Y.readAt?F(Y.readAt):"--"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("button",{onClick:()=>U(Y),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md",title:"Ver mensaje completo",children:a.jsx(xl,{})}),t==="superadmin"&&a.jsxs(Vh,{children:[a.jsx("select",{value:Y.status,onChange:B=>N(Y.id,B.target.value),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 border-none bg-transparent",children:oe.filter(B=>B!=="Todos").map(B=>a.jsx("option",{value:B,children:B},B))}),a.jsx("button",{onClick:B=>E(Y,B),disabled:D===Y.id,className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed",children:D===Y.id?"Reenviando...":"Reenviar"}),a.jsx("button",{onClick:B=>L(Y,B),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"Eliminar"})]})]})})]},Y.id))})]})}),H.length===0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(am,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron mensajes"}),a.jsx("p",{className:"text-gray-500",children:"No hay mensajes que coincidan con los filtros seleccionados."})]}),I&&C&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Detalles del Mensaje"}),a.jsx("button",{onClick:()=>R(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tipo"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${M(C.type)}`,children:C.type})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${_(C.status)}`,children:C.status})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Destinatario"}),a.jsx("div",{className:"text-sm text-gray-900",children:C.recipientName}),a.jsx("div",{className:"text-sm text-gray-500",children:C.recipientEmail})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Canal"}),a.jsx("div",{className:"text-sm text-gray-900",children:C.channel||"Email"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto"}),a.jsx("div",{className:"text-sm text-gray-900 p-3 bg-gray-50 rounded-md",children:C.subject})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contenido del Mensaje"}),a.jsx("div",{className:"text-sm text-gray-900 p-4 bg-gray-50 rounded-md whitespace-pre-wrap max-h-64 overflow-y-auto",children:C.html||C.text||C.body||C.message||"Sin contenido"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Enviado"}),a.jsx("div",{className:"text-gray-900",children:F(C.sentAt)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Entregado"}),a.jsx("div",{className:"text-gray-900",children:C.deliveredAt?F(C.deliveredAt):"No entregado"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ledo"}),a.jsx("div",{className:"text-gray-900",children:C.readAt?F(C.readAt):"No ledo"})]})]}),C.status==="Simulado"&&a.jsxs("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-md",children:[a.jsx("label",{className:"block text-sm font-medium text-orange-700 mb-1",children:" Email Simulado (Histrico)"}),a.jsx("div",{className:"text-sm text-orange-600",children:"Este email fue registrado antes de implementar el envo real. Los nuevos emails se envan realmente."})]}),C.status==="Enviado"&&a.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md",children:[a.jsx("label",{className:"block text-sm font-medium text-green-700 mb-1",children:" Email Enviado"}),a.jsx("div",{className:"text-sm text-green-600",children:"Este email fue enviado exitosamente usando el servidor SMTP configurado."})]}),C.errorMessage&&!C.simulated&&a.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:[a.jsx("label",{className:"block text-sm font-medium text-red-700 mb-1",children:"Error"}),a.jsx("div",{className:"text-sm text-red-600",children:C.errorMessage})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{onClick:()=>R(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cerrar"}),t==="superadmin"&&a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:Y=>{Y.stopPropagation(),E(C,Y)},disabled:D===C.id,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:D===C.id?"Reenviando...":"Reenviar Mensaje"}),a.jsx("button",{onClick:Y=>{Y.stopPropagation(),L(C,Y)},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Eliminar Mensaje"})]})]})]})]})})]});return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2 mb-4",children:[a.jsx(am,{}),"Mensajera y Notificaciones"]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"flex space-x-8",children:[a.jsx("button",{onClick:()=>n("history"),className:`py-4 px-1 border-b-2 font-medium text-sm ${e==="history"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:" Historial de Mensajes"}),a.jsx("button",{onClick:()=>n("email"),className:`py-4 px-1 border-b-2 font-medium text-sm ${e==="email"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:" Configuracin de Email"}),a.jsx("button",{onClick:()=>n("notifications"),className:`py-4 px-1 border-b-2 font-medium text-sm ${e==="notifications"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:" Notificaciones por Mdulo"})]})})]}),e==="history"&&a.jsx(W,{}),e==="email"&&a.jsx(EO,{}),e==="notifications"&&a.jsx(AO,{})]})}function sS({ticketId:t,userRole:e,currentUser:n}){const{addNotification:r}=pn(),[i,s]=ue.useState([]),[o,l]=ue.useState(""),[c,u]=ue.useState(!1),[f,v]=ue.useState(!0),[g,p]=ue.useState(!1);ue.useEffect(()=>{if(!t){v(!1);return}const C=An(Ut(Ve,"artifacts",Fe,"public","data","ticketMessages"),cr("ticketId","==",t)),b=Gt(C,I=>{const R=I.docs.map(D=>({id:D.id,...D.data()}));R.sort((D,ee)=>{var T,N;const oe=((T=D.createdAt)==null?void 0:T.seconds)||0,V=((N=ee.createdAt)==null?void 0:N.seconds)||0;return oe-V}),s(R),v(!1)},I=>{console.error("Error loading messages:",I),r("Error al cargar los mensajes","error"),v(!1)});return()=>b()},[t,r]);const S=async C=>{if(C.preventDefault(),!!o.trim()){p(!0);try{const b={ticketId:t,content:o.trim(),senderId:n.uid,senderName:n.displayName||n.email,senderRole:e,senderEmail:n.email,isInternal:c&&(e==="admin"||e==="superadmin"),createdAt:ft.now(),attachments:[]};await Sa(Ut(Ve,"artifacts",Fe,"public","data","ticketMessages"),b);const I=ut(Ve,"artifacts",Fe,"public","data","tickets",t),R=await vs(I),D=R.exists()?{id:R.id,...R.data()}:null;if(await gr(I,{replyCount:i.length+1,lastReplyAt:ft.now(),lastReplyBy:n.displayName||n.email,updatedAt:ft.now(),...e==="admin"||e==="superadmin"?{status:"Respondido"}:{}}),D&&!b.isInternal)try{console.log(" [TICKET] Iniciando envo de notificaciones por respuesta"),await Nr();const ee=D.ticketNumber,oe=D.subject,V=o.trim(),T=n.displayName||n.email,N=n.email,U=await Nr();if(e==="client"){const E=U==null?void 0:U.fromEmail;if(E){console.log(" [TICKET] Enviando email al administrador por respuesta del cliente:",E);const L=`
                <h2>Nueva Respuesta - Ticket ${ee}</h2>
                <p>El cliente ha respondido a su ticket de soporte.</p>
                <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
                  <p><strong>Nmero de Ticket:</strong> ${ee}</p>
                  <p><strong>Cliente:</strong> ${D.clientName||T}${D.clientEmail?` (${D.clientEmail})`:""}</p>
                  <p><strong>Asunto:</strong> ${oe}</p>
                  <p><strong>Respuesta:</strong></p>
                  <p style="white-space: pre-wrap; background-color: #ffffff; padding: 10px; border-radius: 3px; margin-top: 10px;">${V}</p>
                </div>
                <p>Por favor, revisa y responde desde el panel de administracin.</p>
              `;await fr({to:E,toName:(U==null?void 0:U.fromName)||"Administrador",subject:`Nueva Respuesta - Ticket ${ee}`,html:L,text:`Nueva Respuesta - Ticket ${ee}

El cliente ha respondido a su ticket de soporte.

Nmero de Ticket: ${ee}
Cliente: ${D.clientName||T}${D.clientEmail?` (${D.clientEmail})`:""}
Asunto: ${oe}

Respuesta:
${V}

Por favor, revisa y responde desde el panel de administracin.`,type:"Notificacin",recipientType:"Administrador",module:"tickets",event:"ticketReply",metadata:{ticketId:t,ticketNumber:ee,senderEmail:N,senderName:T}})}}else{const E=D.clientEmail;if(E){console.log(" [TICKET] Enviando email al cliente por respuesta del administrador:",E);const L=`
                <h2>Nueva Respuesta - Ticket ${ee}</h2>
                <p>Estimado/a <strong>${D.clientName||"Cliente"}</strong>,</p>
                <p>Hemos respondido a tu ticket de soporte.</p>
                <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
                  <p><strong>Nmero de Ticket:</strong> ${ee}</p>
                  <p><strong>Asunto:</strong> ${oe}</p>
                  <p><strong>Respuesta:</strong></p>
                  <p style="white-space: pre-wrap; background-color: #ffffff; padding: 10px; border-radius: 3px; margin-top: 10px;">${V}</p>
                </div>
                <p>Puedes ver la respuesta completa y responder desde tu panel de cliente.</p>
                <p>Saludos cordiales,<br>Equipo de Soporte</p>
              `;await fr({to:E,toName:D.clientName||"Cliente",subject:`Respuesta a Ticket ${ee} - ${oe}`,html:L,text:`Nueva Respuesta - Ticket ${ee}

Estimado/a ${D.clientName||"Cliente"},

Hemos respondido a tu ticket de soporte.

Nmero de Ticket: ${ee}
Asunto: ${oe}

Respuesta:
${V}

Puedes ver la respuesta completa y responder desde tu panel de cliente.

Saludos cordiales,
Equipo de Soporte`,type:"Notificacin",recipientType:"Cliente",module:"tickets",event:"ticketReply",metadata:{ticketId:t,ticketNumber:ee,senderEmail:N,senderName:T}})}}console.log(" [TICKET] Notificaciones por respuesta completadas")}catch(ee){console.error(" [TICKET] Error sending reply notification emails:",ee)}l(""),u(!1),r(b.isInternal?"Nota interna agregada":"Mensaje enviado","success")}catch(b){console.error("Error sending message:",b),r("Error al enviar el mensaje","error")}finally{p(!1)}}},k=C=>{if(!C)return"--";const b=new Date,I=new Date(C.seconds*1e3),R=b.getTime()-I.getTime(),D=Math.floor(R/(1e3*60*60*24)),ee=Math.floor(R/(1e3*60*60)),oe=Math.floor(R/(1e3*60));return D>0?`hace ${D} da${D>1?"s":""}`:ee>0?`hace ${ee} hora${ee>1?"s":""}`:oe>0?`hace ${oe} minuto${oe>1?"s":""}`:"hace unos segundos"};return f?a.jsx("div",{className:"flex justify-center items-center h-32",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:i.length===0?a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(op,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),a.jsx("p",{children:"No hay mensajes en este ticket"})]}):i.map(C=>a.jsx("div",{className:`flex ${C.senderRole==="client"?"justify-start":"justify-end"}`,children:a.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${C.senderRole==="client"?"bg-gray-100 text-gray-900":C.isInternal?"bg-yellow-100 text-yellow-900 border border-yellow-300":"bg-blue-100 text-blue-900"}`,children:[C.isInternal&&a.jsx("div",{className:"text-xs font-semibold text-yellow-700 mb-1",children:"NOTA INTERNA"}),a.jsx("div",{className:"text-sm whitespace-pre-wrap",children:C.content}),a.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-gray-500",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(vh,{}),a.jsx("span",{children:C.senderName})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(hs,{}),a.jsx("span",{children:k(C.createdAt)})]})]}),C.attachments&&C.attachments.length>0&&a.jsx("div",{className:"mt-2 pt-2 border-t border-gray-300",children:a.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[a.jsx(g8,{}),a.jsxs("span",{children:[C.attachments.length," archivo",C.attachments.length!==1?"s":""]})]})})]})},C.id))}),a.jsx("div",{className:"border-t pt-4",children:a.jsxs("form",{onSubmit:S,className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e==="client"?"Responder al ticket":"Responder al cliente"}),a.jsx("textarea",{value:o,onChange:C=>l(C.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:e==="client"?"Escribe tu respuesta aqu...":"Escribe tu respuesta al cliente aqu...",required:!0})]}),e==="admin"||e==="superadmin"?a.jsx("div",{className:"flex items-center gap-4",children:a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:c,onChange:C=>u(C.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Nota interna (solo visible para administradores)"})]})}):null,a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{type:"submit",disabled:g||!o.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Enviando..."]}):a.jsxs(a.Fragment,{children:[a.jsx(op,{}),"Enviar Mensaje"]})})})]})})]})}function kO({userRole:t}){const{addNotification:e}=pn(),[n,r]=ue.useState([]),[i,s]=ue.useState([]),[o,l]=ue.useState(""),[c,u]=ue.useState("Todos"),[f,v]=ue.useState("Todos"),[g,p]=ue.useState("Todos"),[S,k]=ue.useState(!0),[C,b]=ue.useState(null),[I,R]=ue.useState(!1),[D,ee]=ue.useState(!1),[oe,V]=ue.useState({subject:"",department:"Soporte Tcnico",priority:"Media",description:"",clientId:"",clientName:"",clientEmail:""}),T=["Todos","Abierto","En Progreso","Respondido","Cerrado","Esperando Cliente"],N=["Todos","Baja","Media","Alta","Crtica"],U=["Todos","Soporte Tcnico","Facturacin","Ventas","General"];ue.useEffect(()=>{const P=An(Ut(Ve,"artifacts",Fe,"public","data","tickets")),q=Gt(P,ce=>{const me=ce.docs.map(he=>({id:he.id,...he.data()}));me.sort((he,we)=>{var Re,xe;const Ee=((Re=he.createdAt)==null?void 0:Re.seconds)||0;return(((xe=we.createdAt)==null?void 0:xe.seconds)||0)-Ee}),r(me),k(!1)},ce=>{console.error("Error loading tickets:",ce),e("Error al cargar los tickets.","error"),k(!1)}),te=An(Ut(Ve,"artifacts",Fe,"public","data","users"),cr("role","==","client")),le=Gt(te,ce=>{const me=ce.docs.map(he=>({id:he.id,...he.data()}));s(me)},ce=>{console.error("Error loading clients:",ce)});return()=>{q(),le()}},[e]);const E=async(P,q)=>{try{const te=ut(Ve,"artifacts",Fe,"public","data","tickets",P),le=await vs(te);if(!le.exists()){e("Ticket no encontrado","error");return}const ce={id:le.id,...le.data()},me=ce.status;await gr(te,{status:q,updatedAt:ft.now()});try{console.log(" [ADMIN] Iniciando envo de notificaciones por cambio de estado"),await Nr();const he=ce.ticketNumber,we=ce.subject,Ee=ce.clientName||"Cliente",Le=ce.clientEmail,Re=await Nr(),xe=Re==null?void 0:Re.fromEmail;if(Le&&me!==q){console.log(" [ADMIN] Enviando email al cliente por cambio de estado:",Le);const re=`
            <h2>Actualizacin de Ticket ${he}</h2>
            <p>Estimado/a <strong>${Ee}</strong>,</p>
            <p>El estado de tu ticket ha sido actualizado.</p>
            <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
              <p><strong>Nmero de Ticket:</strong> ${he}</p>
              <p><strong>Asunto:</strong> ${we}</p>
              <p><strong>Estado Anterior:</strong> ${me}</p>
              <p><strong>Estado Nuevo:</strong> <strong style="color: #2563eb;">${q}</strong></p>
            </div>
            <p>Puedes revisar el estado actualizado de tu ticket desde tu panel de cliente.</p>
            <p>Saludos cordiales,<br>Equipo de Soporte</p>
          `;await fr({to:Le,toName:Ee,subject:`Ticket ${he} - Estado Actualizado a ${q}`,html:re,text:`Actualizacin de Ticket ${he}

Estimado/a ${Ee},

El estado de tu ticket ha sido actualizado.

Nmero de Ticket: ${he}
Asunto: ${we}
Estado Anterior: ${me}
Estado Nuevo: ${q}

Puedes revisar el estado actualizado de tu ticket desde tu panel de cliente.

Saludos cordiales,
Equipo de Soporte`,type:"Notificacin",recipientType:"Cliente",module:"tickets",event:"ticketUpdate",metadata:{ticketId:P,ticketNumber:he,oldStatus:me,newStatus:q}})}if(xe&&ce.priority==="Crtica"&&me!==q){console.log(" [ADMIN] Enviando email al administrador por cambio de estado crtico");const re=`
            <h2>Cambio de Estado - Ticket ${he}</h2>
            <p>Se ha actualizado el estado de un ticket crtico.</p>
            <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
              <p><strong>Nmero de Ticket:</strong> ${he}</p>
              <p><strong>Cliente:</strong> ${Ee}${Le?` (${Le})`:""}</p>
              <p><strong>Asunto:</strong> ${we}</p>
              <p><strong>Prioridad:</strong> ${ce.priority}</p>
              <p><strong>Estado Anterior:</strong> ${me}</p>
              <p><strong>Estado Nuevo:</strong> ${q}</p>
            </div>
          `;await fr({to:xe,toName:(Re==null?void 0:Re.fromName)||"Administrador",subject:`Ticket ${he} - Estado Actualizado`,html:re,text:`Cambio de Estado - Ticket ${he}

Se ha actualizado el estado de un ticket crtico.

Nmero de Ticket: ${he}
Cliente: ${Ee}${Le?` (${Le})`:""}
Asunto: ${we}
Prioridad: ${ce.priority}
Estado Anterior: ${me}
Estado Nuevo: ${q}`,type:"Notificacin",recipientType:"Administrador",module:"tickets",event:"ticketUpdate",metadata:{ticketId:P,ticketNumber:he,oldStatus:me,newStatus:q,priority:ce.priority}})}console.log(" [ADMIN] Notificaciones por cambio de estado completadas")}catch(he){console.error(" [ADMIN] Error sending status change notification emails:",he)}e(`Estado del ticket actualizado a ${q}`,"success")}catch(te){console.error("Error updating ticket status:",te),e("Error al actualizar el estado del ticket","error")}},L=async(P,q)=>{try{const te=ut(Ve,"artifacts",Fe,"public","data","tickets",P),le=await vs(te);if(!le.exists()){e("Ticket no encontrado","error");return}const ce={id:le.id,...le.data()},me=ce.assignedTo,he=ce.assignedToName,we=q?"Admin Actual":null;await gr(te,{assignedTo:q,assignedToName:we,updatedAt:ft.now()});try{console.log(" [ADMIN] Iniciando envo de notificaciones por asignacin de ticket"),await Nr();const Ee=ce.ticketNumber,Le=ce.subject,Re=ce.clientName||"Cliente",xe=ce.clientEmail,re=await Nr(),qe=re==null?void 0:re.fromEmail;if(xe&&q&&!me){console.log(" [ADMIN] Enviando email al cliente por asignacin:",xe);const dt=`
            <h2>Ticket ${Ee} Asignado</h2>
            <p>Estimado/a <strong>${Re}</strong>,</p>
            <p>Tu ticket ha sido asignado a un agente de soporte que se encargar de resolver tu consulta.</p>
            <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
              <p><strong>Nmero de Ticket:</strong> ${Ee}</p>
              <p><strong>Asunto:</strong> ${Le}</p>
              <p><strong>Asignado a:</strong> ${we||"Agente de Soporte"}</p>
            </div>
            <p>Recibirs una respuesta pronto. Puedes hacer seguimiento desde tu panel de cliente.</p>
            <p>Saludos cordiales,<br>Equipo de Soporte</p>
          `;await fr({to:xe,toName:Re,subject:`Ticket ${Ee} - Asignado a Agente`,html:dt,text:`Ticket ${Ee} Asignado

Estimado/a ${Re},

Tu ticket ha sido asignado a un agente de soporte que se encargar de resolver tu consulta.

Nmero de Ticket: ${Ee}
Asunto: ${Le}
Asignado a: ${we||"Agente de Soporte"}

Recibirs una respuesta pronto. Puedes hacer seguimiento desde tu panel de cliente.

Saludos cordiales,
Equipo de Soporte`,type:"Notificacin",recipientType:"Cliente",module:"tickets",event:"ticketUpdate",metadata:{ticketId:P,ticketNumber:Ee,action:"assigned",assignedTo:we}})}if(qe&&!q&&me){console.log(" [ADMIN] Enviando email al administrador por desasignacin");const dt=`
            <h2>Ticket ${Ee} Desasignado</h2>
            <p>Se ha desasignado un ticket que requiere atencin.</p>
            <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
              <p><strong>Nmero de Ticket:</strong> ${Ee}</p>
              <p><strong>Cliente:</strong> ${Re}${xe?` (${xe})`:""}</p>
              <p><strong>Asunto:</strong> ${Le}</p>
              <p><strong>Estado:</strong> ${ce.status}</p>
              <p><strong>Prioridad:</strong> ${ce.priority}</p>
            </div>
            <p>Por favor, asigna el ticket a un agente desde el panel de administracin.</p>
          `;await fr({to:qe,toName:(re==null?void 0:re.fromName)||"Administrador",subject:`Ticket ${Ee} - Desasignado`,html:dt,text:`Ticket ${Ee} Desasignado

Se ha desasignado un ticket que requiere atencin.

Nmero de Ticket: ${Ee}
Cliente: ${Re}${xe?` (${xe})`:""}
Asunto: ${Le}
Estado: ${ce.status}
Prioridad: ${ce.priority}

Por favor, asigna el ticket a un agente desde el panel de administracin.`,type:"Notificacin",recipientType:"Administrador",module:"tickets",event:"ticketUpdate",metadata:{ticketId:P,ticketNumber:Ee,action:"unassigned"}})}console.log(" [ADMIN] Notificaciones por asignacin completadas")}catch(Ee){console.error(" [ADMIN] Error sending assignment notification emails:",Ee)}e(q?"Ticket asignado correctamente":"Ticket desasignado correctamente","success")}catch(te){console.error("Error assigning ticket:",te),e("Error al asignar el ticket","error")}},_=P=>{b(P),R(!0)},M=async P=>{try{await yl(ut(Ve,"artifacts",Fe,"public","data","tickets",P));const q=An(Ut(Ve,"artifacts",Fe,"public","data","ticketMessages"),cr("ticketId","==",P)),le=(await Na(q)).docs.map(ce=>yl(ce.ref));await Promise.all(le),e("Ticket eliminado exitosamente","success")}catch(q){console.error("Error deleting ticket:",q),e("Error al eliminar el ticket","error")}},K=async P=>{P.preventDefault(),console.log(" [ADMIN] handleCreateTicket llamado - Iniciando creacin de ticket");try{console.log(" [ADMIN] Creando ticket en Firestore...");const q={...oe,ticketNumber:`TKT-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,status:"Abierto",assignedTo:null,assignedToName:null,createdAt:ft.now(),updatedAt:ft.now(),lastReplyAt:ft.now(),lastReplyBy:"Cliente",replyCount:0,attachments:[]},le=(await Sa(Ut(Ve,"artifacts",Fe,"public","data","tickets"),q)).id;console.log(" [ADMIN] Ticket creado con ID:",le);try{console.log(" [ADMIN] Iniciando envo de notificaciones por email para ticket:",le),await Nr(),console.log(" [ADMIN] Configuracin de email cargada");const ce=q.clientName||"Cliente",me=q.clientEmail,he=q.ticketNumber,we=q.subject,Ee=q.description,Le=q.department,Re=q.priority;if(me){console.log(" [ADMIN] Enviando email al cliente:",me);const qe=`
            <h2>Ticket Creado Exitosamente</h2>
            <p>Estimado/a <strong>${ce}</strong>,</p>
            <p>Hemos recibido tu ticket de soporte. Nuestro equipo lo revisar y te responder pronto.</p>
            <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
              <p><strong>Nmero de Ticket:</strong> ${he}</p>
              <p><strong>Asunto:</strong> ${we}</p>
              <p><strong>Departamento:</strong> ${Le}</p>
              <p><strong>Prioridad:</strong> ${Re}</p>
              <p><strong>Descripcin:</strong></p>
              <p style="white-space: pre-wrap;">${Ee}</p>
            </div>
            <p>Puedes hacer seguimiento a tu ticket desde tu panel de cliente.</p>
            <p>Saludos cordiales,<br>Equipo de Soporte</p>
          `,dt=await fr({to:me,toName:ce,subject:`Ticket Creado - ${he}`,html:qe,text:`Ticket Creado Exitosamente

Estimado/a ${ce},

Hemos recibido tu ticket de soporte. Nuestro equipo lo revisar y te responder pronto.

Nmero de Ticket: ${he}
Asunto: ${we}
Departamento: ${Le}
Prioridad: ${Re}

Descripcin:
${Ee}

Puedes hacer seguimiento a tu ticket desde tu panel de cliente.

Saludos cordiales,
Equipo de Soporte`,type:"Notificacin",recipientType:"Cliente",module:"tickets",event:"ticketReply",metadata:{ticketId:le,ticketNumber:he}});console.log(" [ADMIN] Resultado email cliente:",dt)}else console.log(" [ADMIN] No se envi email al cliente - no hay email configurado");const xe=await Nr(),re=xe==null?void 0:xe.fromEmail;if(console.log(" [ADMIN] Email del administrador desde config:",re),re){console.log(" [ADMIN] Enviando email al administrador:",re);const qe=`
            <h2>Nuevo Ticket Creado</h2>
            <p>Se ha creado un nuevo ticket de soporte que requiere atencin.</p>
            <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
              <p><strong>Nmero de Ticket:</strong> ${he}</p>
              <p><strong>Cliente:</strong> ${ce}${me?` (${me})`:""}</p>
              <p><strong>Asunto:</strong> ${we}</p>
              <p><strong>Departamento:</strong> ${Le}</p>
              <p><strong>Prioridad:</strong> ${Re}</p>
              <p><strong>Descripcin:</strong></p>
              <p style="white-space: pre-wrap;">${Ee}</p>
            </div>
            <p>Por favor, revisa y asigna el ticket desde el panel de administracin.</p>
          `,dt=await fr({to:re,toName:(xe==null?void 0:xe.fromName)||"Administrador",subject:`Nuevo Ticket - ${he} - ${we}`,html:qe,text:`Nuevo Ticket Creado

Se ha creado un nuevo ticket de soporte que requiere atencin.

Nmero de Ticket: ${he}
Cliente: ${ce}${me?` (${me})`:""}
Asunto: ${we}
Departamento: ${Le}
Prioridad: ${Re}

Descripcin:
${Ee}

Por favor, revisa y asigna el ticket desde el panel de administracin.`,type:"Notificacin",recipientType:"Administrador",module:"tickets",event:"newTicket",metadata:{ticketId:le,ticketNumber:he,clientEmail:me,clientName:ce}});console.log(" [ADMIN] Resultado email administrador:",dt),console.log(" [ADMIN] Notificaciones por email completadas")}else console.log(" [ADMIN] No se envi email al administrador - no hay email configurado en fromEmail")}catch(ce){console.error(" [ADMIN] Error sending ticket notification emails:",ce),console.error(" [ADMIN] Detalles del error:",ce.message,ce.stack)}e("Ticket creado exitosamente","success"),ee(!1),V({subject:"",department:"Soporte Tcnico",priority:"Media",description:"",clientId:"",clientName:"",clientEmail:""})}catch(q){console.error("Error creating ticket:",q),e("Error al crear el ticket","error")}},F=P=>({Abierto:"bg-red-100 text-red-800","En Progreso":"bg-yellow-100 text-yellow-800",Respondido:"bg-blue-100 text-blue-800",Cerrado:"bg-gray-100 text-gray-800","Esperando Cliente":"bg-orange-100 text-orange-800"})[P]||"bg-gray-100 text-gray-800",X=P=>({Baja:"bg-green-100 text-green-800",Media:"bg-yellow-100 text-yellow-800",Alta:"bg-orange-100 text-orange-800",Crtica:"bg-red-100 text-red-800"})[P]||"bg-gray-100 text-gray-800",H=P=>({"Soporte Tcnico":"bg-blue-100 text-blue-800",Facturacin:"bg-green-100 text-green-800",Ventas:"bg-purple-100 text-purple-800",General:"bg-gray-100 text-gray-800"})[P]||"bg-gray-100 text-gray-800",W=P=>P?new Date(P.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",Y=P=>{switch(P){case"Abierto":return a.jsx(hs,{});case"En Progreso":return a.jsx(hs,{});case"Respondido":return a.jsx(uA,{});case"Cerrado":return a.jsx(ap,{});case"Esperando Cliente":return a.jsx(vh,{});default:return a.jsx(hs,{})}},B=P=>{if(!P)return"--";const q=new Date,te=new Date(P.seconds*1e3),le=q.getTime()-te.getTime(),ce=Math.floor(le/(1e3*60*60*24)),me=Math.floor(le/(1e3*60*60)),he=Math.floor(le/(1e3*60));return ce>0?`hace ${ce} da${ce>1?"s":""}`:me>0?`hace ${me} hora${me>1?"s":""}`:he>0?`hace ${he} minuto${he>1?"s":""}`:"hace unos segundos"},A=n.filter(P=>{const q=o===""||P.ticketNumber.toLowerCase().includes(o.toLowerCase())||P.subject.toLowerCase().includes(o.toLowerCase())||P.clientName.toLowerCase().includes(o.toLowerCase())||P.clientEmail.toLowerCase().includes(o.toLowerCase())||P.description.toLowerCase().includes(o.toLowerCase()),te=c==="Todos"||P.status===c,le=f==="Todos"||P.priority===f,ce=g==="Todos"||P.department===g;return q&&te&&le&&ce});return S?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(ic,{}),"Sistema de Tickets"]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"text-sm text-gray-500",children:[A.length," ticket",A.length!==1?"s":""," encontrado",A.length!==1?"s":""]}),a.jsxs("button",{onClick:()=>ee(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[a.jsx(Uh,{}),"Nuevo Ticket"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:a.jsx(hs,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Abiertos"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.filter(P=>P.status==="Abierto").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:a.jsx(hs,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"En Progreso"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.filter(P=>P.status==="En Progreso").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:a.jsx(vh,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Esperando Cliente"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.filter(P=>P.status==="Esperando Cliente").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:a.jsx(ap,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Crticos"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.filter(P=>P.priority==="Crtica").length})]})]})})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar por nmero, asunto, cliente...",value:o,onChange:P=>l(P.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Uu,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:c,onChange:P=>u(P.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:T.map(P=>a.jsx("option",{value:P,children:P},P))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(uu,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:f,onChange:P=>v(P.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:N.map(P=>a.jsx("option",{value:P,children:P},P))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(uu,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:g,onChange:P=>p(P.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:U.map(P=>a.jsx("option",{value:P,children:P},P))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(uu,{})})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Ticket","Cliente","Asunto","Estado","Prioridad","Departamento","Asignado","ltima Actividad","Respuestas","Acciones"].map(P=>a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:P},P))})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.map(P=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:P.ticketNumber}),a.jsx("div",{className:"text-xs text-gray-500",children:W(P.createdAt)})]}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:P.clientName}),a.jsx("div",{className:"text-sm text-gray-500",children:P.clientEmail})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",title:P.subject,children:P.subject}),a.jsx("div",{className:"text-xs text-gray-500 max-w-xs truncate",title:P.description,children:P.description})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${F(P.status)}`,children:P.status}),a.jsx("div",{className:"ml-2 text-gray-400",children:Y(P.status)})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${X(P.priority)}`,children:P.priority})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${H(P.department)}`,children:P.department})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:P.assignedToName||"Sin asignar"}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[a.jsx("div",{children:B(P.lastReplyAt)}),a.jsxs("div",{className:"text-xs text-gray-400",children:["por ",P.lastReplyBy]})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(op,{}),a.jsx("span",{className:"ml-1",children:P.replyCount})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("button",{onClick:()=>_(P),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md",title:"Ver ticket completo",children:a.jsx(xl,{})}),t==="superadmin"&&a.jsxs(Vh,{children:[a.jsx("select",{value:P.status,onChange:q=>E(P.id,q.target.value),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 border-none bg-transparent",children:T.filter(q=>q!=="Todos").map(q=>a.jsx("option",{value:q,children:q},q))}),a.jsx("button",{onClick:()=>L(P.id,P.assignedTo?null:"admin"),className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:P.assignedTo?"Desasignar":"Asignar"}),a.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:"Responder"}),a.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-orange-700 hover:bg-orange-50",children:"Cerrar Ticket"}),a.jsx("button",{onClick:()=>{window.confirm("Ests seguro de que quieres eliminar este ticket? Esta accin no se puede deshacer.")&&M(P.id)},className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"Eliminar Ticket"})]})]})})]},P.id))})]})}),A.length===0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(ic,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron tickets"}),a.jsx("p",{className:"text-gray-500",children:"No hay tickets que coincidan con los filtros seleccionados."})]}),I&&C&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:["Ticket ",C.ticketNumber]}),a.jsx("button",{onClick:()=>R(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cliente"}),a.jsx("div",{className:"text-sm text-gray-900",children:C.clientName}),a.jsx("div",{className:"text-sm text-gray-500",children:C.clientEmail})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Asignado a"}),a.jsx("div",{className:"text-sm text-gray-900",children:C.assignedToName||"Sin asignar"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${F(C.status)}`,children:C.status})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prioridad"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${X(C.priority)}`,children:C.priority})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Departamento"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${H(C.department)}`,children:C.department})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Creado"}),a.jsx("div",{className:"text-sm text-gray-900",children:W(C.createdAt)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto"}),a.jsx("div",{className:"text-sm text-gray-900 p-3 bg-gray-50 rounded-md",children:C.subject})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin"}),a.jsx("div",{className:"text-sm text-gray-900 p-4 bg-gray-50 rounded-md whitespace-pre-wrap",children:C.description})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Historial de Mensajes"}),a.jsx("div",{className:"border border-gray-200 rounded-md p-4",children:a.jsx(sS,{ticketId:C.id,userRole:t,currentUser:{uid:"admin",displayName:"Admin",email:"admin@empresa.com"}})})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{onClick:()=>R(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cerrar"}),t==="superadmin"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Responder"}),a.jsx("button",{onClick:()=>{window.confirm("Ests seguro de que quieres eliminar este ticket? Esta accin no se puede deshacer.")&&(M(C.id),R(!1))},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Eliminar Ticket"})]})]})]})]})}),D&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Crear Nuevo Ticket"}),a.jsx("button",{onClick:()=>ee(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("form",{onSubmit:K,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cliente"}),a.jsxs("select",{value:oe.clientId,onChange:P=>{const q=i.find(te=>te.id===P.target.value);V(te=>({...te,clientId:P.target.value,clientName:(q==null?void 0:q.fullName)||"",clientEmail:(q==null?void 0:q.email)||""}))},className:"w-full p-2 border rounded-md",required:!0,children:[a.jsx("option",{value:"",children:"Seleccionar cliente"}),i.map(P=>a.jsxs("option",{value:P.id,children:[P.fullName," (",P.email,")"]},P.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento"}),a.jsx("select",{value:oe.department,onChange:P=>V(q=>({...q,department:P.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:U.filter(P=>P!=="Todos").map(P=>a.jsx("option",{value:P,children:P},P))})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridad"}),a.jsx("select",{value:oe.priority,onChange:P=>V(q=>({...q,priority:P.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:N.filter(P=>P!=="Todos").map(P=>a.jsx("option",{value:P,children:P},P))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email del Cliente"}),a.jsx("input",{type:"email",value:oe.clientEmail,onChange:P=>V(q=>({...q,clientEmail:P.target.value})),className:"w-full p-2 border rounded-md",placeholder:"email@ejemplo.com",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto *"}),a.jsx("input",{type:"text",value:oe.subject,onChange:P=>V(q=>({...q,subject:P.target.value})),className:"w-full p-2 border rounded-md",placeholder:"Describe brevemente el problema o consulta",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin *"}),a.jsx("textarea",{value:oe.description,onChange:P=>V(q=>({...q,description:P.target.value})),className:"w-full p-2 border rounded-md",rows:6,placeholder:"Describe el problema o consulta en detalle...",required:!0})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>ee(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Crear Ticket"})]})]})]})})]})}function TO({onLogout:t}){const{addNotification:e}=pn(),[n,r]=ue.useState({}),i="company_info";ue.useEffect(()=>{const l=ut(Ve,"artifacts",Fe,"public","data","settings",i);return Gt(l,u=>{u.exists()&&r(u.data())})},[]);const s=l=>{const{name:c,value:u}=l.target;r(f=>({...f,[c]:u}))},o=async()=>{try{const l=ut(Ve,"artifacts",Fe,"public","data","settings",i);await ws(l,n,{merge:!0}),e("Configuracin de la empresa guardada.","success")}catch{e("Error al guardar la configuracin.","error")}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Configuracin"}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md max-w-4xl mx-auto space-y-8",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Informacin de Facturacin y Contacto"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx("input",{name:"companyName",value:n.companyName||"",onChange:s,placeholder:"Nombre de la Empresa",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"identification",value:n.identification||"",onChange:s,placeholder:"NIT / Identificacin Fiscal",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"address",value:n.address||"",onChange:s,placeholder:"Direccin",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"phone",value:n.phone||"",onChange:s,placeholder:"Telfono",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"email",type:"email",value:n.email||"",onChange:s,placeholder:"Email de Contacto",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"website",value:n.website||"",onChange:s,placeholder:"Sitio Web",className:"w-full p-2 border rounded-md"})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mt-8 mb-4",children:"Seguridad"}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-[300px]",children:[a.jsx("p",{className:"font-medium text-gray-800 mb-2",children:"Tiempo de Inactividad (minutos)"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Tiempo mximo de inactividad antes de cerrar sesin automticamente. Mnimo: 1 minuto, Mximo: 120 minutos."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",name:"inactivityTimeoutMinutes",value:n.inactivityTimeoutMinutes||10,onChange:s,min:"1",max:"120",className:"w-24 p-2 border border-gray-300 rounded-md text-center focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"10"}),a.jsx("span",{className:"text-gray-600 font-medium",children:"min"})]})]}),a.jsxs("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded",children:[a.jsxs("p",{className:"text-sm text-blue-800 font-medium",children:[a.jsx("strong",{children:" Configuracin Actual:"})," ",n.inactivityTimeoutMinutes||10," minutos de inactividad"]}),a.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"La sesin se cerrar automticamente si no hay actividad del usuario (movimiento del mouse, teclado, clics, scroll)."})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mt-8 mb-4",children:"Branding"}),a.jsx("input",{name:"logoUrl",value:n.logoUrl||"",onChange:s,placeholder:"URL del Logo (enlace a la imagen)",className:"w-full p-2 border rounded-md"}),n.logoUrl&&a.jsx("img",{src:n.logoUrl,alt:"Vista previa del logo",className:"mt-4 max-h-20 bg-gray-100 p-2 rounded"})]}),a.jsx("button",{onClick:o,className:"mt-4 px-5 py-2 bg-blue-600 text-white font-semibold rounded-md shadow-sm hover:bg-blue-700",children:"Guardar Configuracin"})]})]})}function jO({user:t,userRole:e,companySettings:n,onLogout:r}){const[i,s]=ue.useState("services");ue.useEffect(()=>{const l=["services","users","templates","messages","payments","tickets","payment-config","settings"],c=()=>{const f=(window.location.hash||"").replace("#","");l.includes(f)&&s(f)},u=(window.location.hash||"").replace("#","");return l.includes(u)?s(u):(!window.location.hash||window.location.hash==="#")&&(window.history.replaceState(null,"","#services"),s("services")),window.addEventListener("hashchange",c),()=>window.removeEventListener("hashchange",c)},[]),ue.useEffect(()=>{const l=(window.location.hash||"").replace("#","");i&&l!==i&&window.history.pushState(null,"",`#${i}`)},[i]),ue.useEffect(()=>{const l=c=>{const u=(window.location.hash||"").replace("#","");["services","users","templates","messages","payments","tickets","payment-config","settings"].includes(u)?s(u):s("services")};return window.addEventListener("popstate",l),()=>window.removeEventListener("popstate",l)},[]);const o=()=>{switch(i){case"users":return a.jsx(C8,{userRole:e,companySettings:n});case"templates":return a.jsx(I8,{});case"messages":return a.jsx(SO,{userRole:e});case"tickets":return a.jsx(kO,{userRole:e});case"payments":return a.jsx(_O,{userRole:e});case"payment-config":return a.jsx(fA,{});case"settings":return a.jsx(TO,{onLogout:r});case"services":default:return a.jsx(_8,{userRole:e})}};return a.jsxs("main",{className:"container mx-auto",children:[a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-8 px-4 sm:px-6 lg:px-8","aria-label":"Tabs",children:[a.jsxs("button",{onClick:()=>s("services"),className:`${i==="services"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(sp,{})," Servicios"]}),e==="superadmin"&&a.jsxs("button",{onClick:()=>s("users"),className:`${i==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(d8,{})," Usuarios"]}),a.jsxs("button",{onClick:()=>s("templates"),className:`${i==="templates"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(cA,{})," Plantillas"]}),a.jsxs("button",{onClick:()=>s("messages"),className:`${i==="messages"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(am,{})," Mensajes"]}),a.jsxs("button",{onClick:()=>s("payments"),className:`${i==="payments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(Ji,{})," Pagos"]}),a.jsxs("button",{onClick:()=>s("tickets"),className:`${i==="tickets"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(ic,{})," Tickets"]}),e==="superadmin"&&a.jsxs("button",{onClick:()=>s("settings"),className:`${i==="settings"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(h8,{})," Empresa"]})]})}),o()]})}function CO({isOpen:t,onClose:e,onConfirm:n,service:r,paymentType:i,warningMessage:s}){if(!t)return null;const o=()=>i==="One-Time"?a.jsx(Ji,{className:"h-8 w-8 text-blue-600"}):a.jsx(dl,{className:"h-8 w-8 text-green-600"}),l=()=>i==="One-Time"?"Solicitar Pago nico":"Solicitar Pago de Renovacin",c=()=>i==="One-Time"?"Esta es una solicitud de pago nico que no se renovar automticamente":"Esta solicitud renovar tu servicio por el perodo seleccionado",u=()=>i==="One-Time"?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"bg-green-600 hover:bg-green-700 focus:ring-green-500";return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 transform transition-all",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"flex-shrink-0",children:o()}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:l()}),a.jsx("p",{className:"text-sm text-gray-500",children:c()})]})]})}),a.jsxs("div",{className:"px-6 py-4",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:r.serviceType}),a.jsxs("span",{className:"text-sm font-semibold text-gray-600",children:[r.currency," ",r.amount.toFixed(2)]})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:r.description}),a.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[a.jsxs("span",{children:["Nmero: ",r.serviceNumber]}),i!=="One-Time"&&a.jsxs("span",{children:["Ciclo: ",r.billingCycle]})]})]}),a.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(v8,{className:"h-5 w-5 text-amber-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-medium text-amber-800 mb-1",children:"Informacin Importante"}),a.jsx("p",{className:"text-sm text-amber-700",children:s})]})]})}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Tipo de Pago:"}),a.jsx("span",{className:"font-medium text-gray-900",children:i==="One-Time"?"Pago nico":"Renovacin"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Monto:"}),a.jsxs("span",{className:"font-medium text-gray-900",children:[r.currency," ",r.amount.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Mtodo de Pago:"}),a.jsx("span",{className:"font-medium text-gray-900",children:"Transferencia Bancaria"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Estado Inicial:"}),a.jsx("span",{className:"font-medium text-amber-600",children:"Pendiente"})]})]})]}),a.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-2xl flex justify-end space-x-3",children:[a.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors",children:"Cancelar"}),a.jsx("button",{onClick:n,className:`px-6 py-2 text-sm font-medium text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors ${u()}`,children:i==="One-Time"?"Solicitar Pago nico":"Solicitar Renovacin"})]})]})})}function IO({user:t,userProfile:e}){const{addNotification:n}=pn(),[r,i]=ue.useState([]),[s,o]=ue.useState(!0),[l,c]=ue.useState(new Set),[u,f]=ue.useState(new Set),[v,g]=ue.useState({}),[p,S]=ue.useState(null),[k,C]=ue.useState({isOpen:!1,service:null}),[b,I]=ue.useState(null),R=_=>{if(!_.dueDate||!_.billingCycle||_.billingCycle==="One-Time")return _.expirationDate?new Date(_.expirationDate.seconds*1e3):null;const M=new Date(_.dueDate.seconds*1e3);let K=new Date(M);switch(_.billingCycle){case"Monthly":K.setMonth(K.getMonth()+1);break;case"Semiannually":K.setMonth(K.getMonth()+6);break;case"Annually":K.setFullYear(K.getFullYear()+1);break;case"Biennially":K.setFullYear(K.getFullYear()+2);break;case"Triennially":K.setFullYear(K.getFullYear()+3);break;default:return null}return K},D=_=>{const M=R(_);return M?M.toLocaleDateString():"N/A"},ee=_=>({"One-Time":"Pago nico",Monthly:"Mensual",Semiannually:"Semestral",Annually:"Anual",Biennially:"Bianual",Triennially:"Trienal",Custom:"Personalizado"})[_]||_,oe=_=>{if(l.has(_.id)){n("Ya se est solicitando un pago para este servicio","warning");return}if(u.has(_.id)){n("Ya existe una solicitud de pago pendiente para este servicio","warning");return}C({isOpen:!0,service:_})},V=async _=>{c(M=>new Set(M).add(_.id));try{let M;if(_.billingCycle==="One-Time")M=_.dueDate?new Date(_.dueDate.seconds*1e3):new Date,M.setDate(M.getDate()+30);else{const B=R(_);B?M=B:M=new Date(Date.now()+30*24*60*60*1e3)}let F=b?(B=>{if(!B)return null;if(B.gateways)return B.gateways;const{bold:A,paypal:P,payu:q,bankTransfer:te}=B,le={};return A&&(le.bold={name:"Bold",...A}),P&&(le.paypal={name:"PayPal",...P}),q&&(le.payu={name:"PayU",...q}),te&&(le.bankTransfer={name:"Transferencia Bancaria",...te}),le})(b):null;F||(F={bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}});const X=F?Object.values(F).filter(B=>B.enabled):[];let H="Transferencia Bancaria",W="Transferencia Bancaria";X.length===1?(H=X[0].name,W=X[0].name):X.length>1&&(H="Pendiente de Seleccin",W=_.billingCycle==="One-Time"?"Pago nico":"Renovacin");const Y={serviceId:_.id,serviceNumber:_.serviceNumber,serviceType:_.serviceType,description:_.description,amount:_.amount,currency:_.currency,status:"Pendiente",gateway:H,userId:t.uid,clientName:(e==null?void 0:e.fullName)||"Cliente",clientEmail:t.email,dueDate:ft.fromDate(M),createdAt:ft.now(),paymentMethod:W,notes:`Solicitud de pago automtica para servicio ${_.serviceNumber} - Ciclo: ${ee(_.billingCycle)}`,billingCycle:_.billingCycle,isAutoGenerated:!0,originalServiceDueDate:_.dueDate?_.dueDate.toDate?_.dueDate:ft.fromDate(new Date(_.dueDate)):null,paymentType:_.billingCycle==="One-Time"?"Pago nico":"Renovacin"};await Sa(Ut(Ve,"artifacts",Fe,"public","data","payments"),Y),n("Solicitud de pago creada exitosamente. Revisa la seccin de pagos.","success"),C({isOpen:!1,service:null})}catch(M){console.error("Error generating payment:",M),n("Error al crear la solicitud de pago. Intenta nuevamente.","error")}finally{c(M=>{const K=new Set(M);return K.delete(_.id),K})}},T=_=>{localStorage.setItem("selectedServiceForRenewal",JSON.stringify({id:_.id,serviceNumber:_.serviceNumber,serviceType:_.serviceType,description:_.description,amount:_.amount,currency:_.currency,billingCycle:_.billingCycle,dueDate:_.dueDate})),window.location.hash==="#renewals"?(window.location.hash="",setTimeout(()=>{window.location.hash="renewals"},50)):window.location.hash="renewals",n("Redirigiendo a renovaciones para este servicio","success")};ue.useEffect(()=>{if(!(t!=null&&t.uid))return;const _=An(Ut(Ve,"artifacts",Fe,"public","data","payments"),cr("userId","==",t.uid)),M=Gt(_,K=>{const F=new Set,X={},H=new Set(["Pendiente","Procesando"]);K.docs.forEach(W=>{const Y=W.data();Y.serviceId&&H.has(Y.status)&&(F.add(Y.serviceId),X[Y.serviceId]={id:W.id,...Y})}),f(F),g(X)});return()=>M()},[t==null?void 0:t.uid]),ue.useEffect(()=>{const _=ut(Ve,"artifacts",Fe,"public","data","settings","paymentConfig"),M=Gt(_,K=>{K.exists()?I(K.data()):I({gateways:{bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}}})});return()=>M()},[]),ue.useEffect(()=>{const _=ut(Ve,"artifacts",Fe,"public","data","settings","renewalConfig"),M=Gt(_,K=>{K.exists()&&S(K.data())});return()=>M()},[]);const N=_=>{if(!_||_.billingCycle==="One-Time")return null;const M=R(_);if(!M)return null;const K=new Date;return Math.ceil((M.getTime()-K.getTime())/(1e3*60*60*24))};ue.useEffect(()=>{if(!(p!=null&&p.renewalSettings)||!(t!=null&&t.uid))return;const _=Number(p.renewalSettings.reminderDays??0),M=Number(p.renewalSettings.gracePeriodDays??0);(async()=>{for(const F of r){if(!F||F.billingCycle==="One-Time")continue;const X=N(F);if(X!=null){if(X<=_&&X>=-M&&!u.has(F.id))try{await V(F)}catch(H){console.error("Auto-generate payment failed:",H)}if(X<-M){const H=v[F.id];if(H!=null&&H.id)try{await gr(ut(Ve,"artifacts",Fe,"public","data","payments",H.id),{status:"Cancelado",updatedAt:new Date,cancelReason:"Periodo de gracia agotado"}),n(`Solicitud de pago cancelada por perodo de gracia (${F.serviceNumber})`,"warning")}catch(W){console.error("Auto-cancel payment failed:",W)}}}}})()},[r,p,u,v,t==null?void 0:t.uid]),ue.useEffect(()=>{if(!(t!=null&&t.uid)){o(!1);return}const _=An(Ut(Ve,"artifacts",Fe,"public","data","services"),cr("assignedUserId","==",t.uid)),M=Gt(_,K=>{const F=K.docs.map(X=>({id:X.id,...X.data()}));F.sort((X,H)=>{var B,A;const W=((B=X.createdAt)==null?void 0:B.seconds)||0;return(((A=H.createdAt)==null?void 0:A.seconds)||0)-W}),i(F),o(!1)},K=>{console.error("Error loading services:",K),n("Error al cargar los servicios","error"),o(!1)});return()=>M()},[t==null?void 0:t.uid,n]);const U=_=>({Activo:"bg-green-100 text-green-800","Periodo de Gracia Vencido":"bg-yellow-100 text-yellow-800","Pendiente Pago":"bg-red-100 text-red-800",Pago:"bg-blue-100 text-blue-800",Cancelado:"bg-gray-100 text-gray-800"})[_]||"bg-gray-100 text-gray-800",E=_=>_?new Date(_.seconds*1e3).toLocaleDateString("es-ES"):"--",L=(_,M)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:M||"USD"}).format(_);return s?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(sp,{}),"Mis Servicios Contratados"]}),a.jsxs("div",{className:"text-sm text-gray-500",children:[r.length," servicio",r.length!==1?"s":""," encontrado",r.length!==1?"s":""]})]}),r.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(sp,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes servicios asignados"}),a.jsx("p",{className:"text-gray-500",children:"Contacta al administrador para que te asigne servicios."})]}):a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Nmero","Servicio","Descripcin","Monto","Estado","Ciclo","Fecha de Inicio","Fecha de Vencimiento","Notas","Acciones"].map(_=>a.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:_},_))})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(_=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:_.serviceNumber||"N/A"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"font-medium text-gray-900",children:_.serviceType})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"text-gray-900",children:_.description})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"font-medium text-gray-900",children:L(_.amount,_.currency)})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${U(_.status)}`,children:_.status})}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:ee(_.billingCycle)}),_.billingCycle==="Custom"&&_.customBillingCycle&&a.jsxs("div",{className:"text-xs text-gray-500",children:["(",_.customBillingCycle,")"]})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm text-gray-900",children:E(_.dueDate)}),a.jsx("div",{className:"text-xs text-gray-500",children:"Inicio"})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:D(_)}),a.jsx("div",{className:"text-xs text-gray-500",children:"Vencimiento"})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"text-gray-600 text-sm max-w-xs truncate",children:_.clientNotes||"--"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"flex items-center space-x-2",children:u.has(_.id)?a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-xs text-orange-600 font-medium mb-1",children:"Por pagar"}),a.jsxs("button",{onClick:()=>window.location.href="#payments",className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700",title:"Ir a Pago",children:[a.jsx(xl,{className:"h-4 w-4 mr-1"}),"Ir a Pago"]})]}):a.jsxs("div",{className:"flex flex-col space-y-2",children:[a.jsxs("button",{onClick:()=>{const M=N(_);if(_.billingCycle!=="One-Time"&&(M==null||p!=null&&p.renewalSettings&&M>(p.renewalSettings.reminderDays??0))){T(_);return}oe(_)},disabled:l.has(_.id),className:`inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${l.has(_.id)?"text-gray-400 bg-gray-200 cursor-not-allowed":"text-white bg-blue-600 hover:bg-blue-700"}`,title:l.has(_.id)?"Creando solicitud...":_.billingCycle==="One-Time"?"Solicitar de Nuevo":"Solicitar de Nuevo (ir a Renovaciones fuera de ventana)",children:[a.jsx(Ji,{className:"h-4 w-4 mr-1"}),l.has(_.id)?"Creando...":u.has(_.id)?"Ir a Pago":"Solicitar de Nuevo"]}),_.billingCycle!=="One-Time"&&a.jsxs("button",{onClick:()=>T(_),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",title:"Aumentar ciclo de este servicio",children:[a.jsx(dl,{className:"h-4 w-4 mr-1"}),"Aumentar Ciclo"]})]})})})]},_.id))})]})}),k.isOpen&&k.service&&a.jsx(CO,{isOpen:k.isOpen,onClose:()=>C({isOpen:!1,service:null}),onConfirm:()=>V(k.service),service:k.service,paymentType:k.service.billingCycle,warningMessage:k.service.billingCycle==="One-Time"?`Se crear una solicitud de pago nico para el servicio "${k.service.serviceType}". La solicitud vencer en 30 das desde la fecha actual.`:`Se crear una solicitud de pago de renovacin para el servicio "${k.service.serviceType}" con ciclo ${ee(k.service.billingCycle)}. La solicitud vencer en la fecha de vencimiento del servicio.`})]})}function PO({bankAccounts:t,serviceNumber:e,amount:n,currency:r,onUpload:i}){const s=(o,l)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:l||"USD"}).format(o);return!t||t.length===0?a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:a.jsx("p",{className:"text-yellow-800",children:"No hay cuentas bancarias configuradas. Contacta al administrador."})}):a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Ji,{}),a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Instrucciones para Transferencia Bancaria"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Informacin del Pago"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Nmero de Servicio:"}),a.jsx("span",{className:"ml-2 font-mono text-blue-600",children:e})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Monto a Pagar:"}),a.jsx("span",{className:"ml-2 font-semibold text-green-600",children:s(n,r)})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Cuentas Disponibles para Transferencia"}),a.jsx("div",{className:"space-y-4",children:t.map((o,l)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h5",{className:"font-medium text-gray-700",children:["Opcin ",l+1]}),a.jsx("span",{className:"text-sm text-gray-500",children:o.accountType})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-600",children:"Banco:"}),a.jsx("span",{className:"ml-2 text-gray-800",children:o.bankName})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-600",children:"Nmero de Cuenta:"}),a.jsx("span",{className:"ml-2 font-mono text-blue-600",children:o.accountNumber})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("span",{className:"font-medium text-gray-600",children:"Titular:"}),a.jsx("span",{className:"ml-2 text-gray-800",children:o.accountHolder})]})]})]},o.id))})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Instrucciones Paso a Paso"}),a.jsxs("ol",{className:"space-y-2 text-sm text-gray-700",children:[a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"1"}),a.jsx("span",{children:"Realiza una transferencia bancaria a cualquiera de las cuentas mostradas arriba"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"2"}),a.jsxs("span",{children:["Usa el ",a.jsx("strong",{children:"Nmero de Servicio"})," como referencia en la transferencia"]})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"3"}),a.jsxs("span",{children:["Transfiere el monto exacto: ",a.jsx("strong",{children:s(n,r)})]})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"4"}),a.jsx("span",{children:"Guarda el comprobante de transferencia"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"5"}),a.jsx("span",{children:"Enva el comprobante por email o sube una foto en el sistema"})]})]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:" Informacin Importante"}),a.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[a.jsx("li",{children:" El pago puede tardar hasta 24 horas en ser procesado"}),a.jsx("li",{children:" Asegrate de incluir el nmero de servicio como referencia"}),a.jsx("li",{children:" El monto debe ser exacto para evitar retrasos"}),a.jsx("li",{children:" Contacta al administrador si tienes alguna duda"})]})]}),a.jsx("div",{className:"text-center",children:a.jsxs("label",{className:"inline-block px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium cursor-pointer",children:["Subir Comprobante de Transferencia",a.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:o=>{var l;return i&&((l=o.target.files)==null?void 0:l[0])&&i(o.target.files[0])}})]})})]})]})}function RO({user:t,userProfile:e}){const{addNotification:n}=pn(),[r,i]=ue.useState([]),[s,o]=ue.useState(""),[l,c]=ue.useState("Todos"),[u,f]=ue.useState(!0),[v,g]=ue.useState([]),[p,S]=ue.useState(!1),[k,C]=ue.useState(null),[b,I]=ue.useState(null),[R,D]=ue.useState({}),[ee,oe]=ue.useState(!1),[V,T]=ue.useState(null),N=()=>{if(!b)return null;if(b.gateways)return b.gateways;const{bold:B,paypal:A,payu:P,bankTransfer:q}=b,te={};return B&&(te.bold={name:"Bold",...B}),A&&(te.paypal={name:"PayPal",...A}),P&&(te.payu={name:"PayU",...P}),q&&(te.bankTransfer={name:"Transferencia Bancaria",...q}),te},U=["Todos","Pendiente","Procesando","Completado","Fallido","Cancelado","Reembolsado"];ue.useEffect(()=>{const B=ut(Ve,"artifacts",Fe,"public","data","settings","paymentConfig"),A=Gt(B,P=>{P.exists()?(I(P.data()),console.log("Payment config loaded:",P.data())):(console.log("No payment config found, using defaults"),I({gateways:{bold:{enabled:!0,name:"Bold",autoApprove:!1},paypal:{enabled:!0,name:"PayPal",autoApprove:!1},payu:{enabled:!0,name:"PayU",autoApprove:!1},bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}},bankAccounts:[]}))},P=>{console.error("Error loading payment config:",P)});return()=>A()},[]),ue.useEffect(()=>{if(!(t!=null&&t.uid)){f(!1);return}const B=An(Ut(Ve,"artifacts",Fe,"public","data","payments"),cr("userId","==",t.uid)),A=Gt(B,P=>{const q=P.docs.map(te=>({id:te.id,...te.data()}));console.log("Payments loaded:",q.length,q),q.sort((te,le)=>{var he,we;const ce=((he=te.createdAt)==null?void 0:he.seconds)||0;return(((we=le.createdAt)==null?void 0:we.seconds)||0)-ce}),i(q),f(!1)},P=>{console.error("Error loading payments:",P),n("Error al cargar los pagos","error"),f(!1)});return()=>A()},[t==null?void 0:t.uid,n]),ue.useEffect(()=>{const B=ut(Ve,"artifacts",Fe,"public","data","settings","paymentConfig"),A=Gt(B,P=>{var q;if(P.exists()){const te=P.data();(q=te.bankTransfer)!=null&&q.accounts&&g(te.bankTransfer.accounts)}});return()=>A()},[]);const E=r.filter(B=>{const A=s===""||B.serviceNumber&&B.serviceNumber.toLowerCase().includes(s.toLowerCase())||B.serviceType&&B.serviceType.toLowerCase().includes(s.toLowerCase())||B.serviceName&&B.serviceName.toLowerCase().includes(s.toLowerCase())||B.transactionId&&B.transactionId.toLowerCase().includes(s.toLowerCase()),P=l==="Todos"||B.status===l,q=A&&P;return console.log("Payment filter:",{payment:B.id,serviceType:B.serviceType,serviceName:B.serviceName,status:B.status,searchTerm:s,statusFilter:l,matchesSearch:A,matchesStatus:P,result:q}),q}),L=B=>({Pendiente:"bg-yellow-100 text-yellow-800",Procesando:"bg-blue-100 text-blue-800",Completado:"bg-green-100 text-green-800",Fallido:"bg-red-100 text-red-800",Cancelado:"bg-gray-100 text-gray-800",Reembolsado:"bg-purple-100 text-purple-800"})[B]||"bg-gray-100 text-gray-800",_=B=>({Bold:"bg-blue-100 text-blue-800",PayPal:"bg-yellow-100 text-yellow-800",PayU:"bg-green-100 text-green-800","Transferencia Bancaria":"bg-purple-100 text-purple-800",Manual:"bg-gray-100 text-gray-800"})[B]||"bg-gray-100 text-gray-800",M=B=>{const A={invoiceNumber:`INV-${B.id.slice(-8).toUpperCase()}`,date:new Date(B.createdAt.seconds*1e3).toLocaleDateString(),dueDate:B.dueDate?new Date(B.dueDate.seconds*1e3).toLocaleDateString():"N/A",clientName:B.clientName||(e==null?void 0:e.fullName)||"Cliente",clientEmail:B.clientEmail||(t==null?void 0:t.email)||"N/A",serviceNumber:B.serviceNumber||"N/A",serviceType:B.serviceType||"Servicio",description:B.description||"Descripcin del servicio",amount:B.amount||0,currency:B.currency||"USD",status:B.status||"Pendiente",gateway:B.gateway||"N/A",transactionId:B.transactionId||"N/A",paymentMethod:B.paymentMethod||"N/A"},P=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>Invoice ${A.invoiceNumber}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
          .invoice { background: white; max-width: 800px; margin: 0 auto; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
          .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #e5e5e5; padding-bottom: 20px; }
          .company-name { font-size: 24px; font-weight: bold; color: #2563eb; margin-bottom: 5px; }
          .invoice-title { font-size: 18px; color: #666; }
          .invoice-details { display: flex; justify-content: space-between; margin-bottom: 30px; }
          .client-info, .invoice-info { flex: 1; }
          .client-info h3, .invoice-info h3 { margin: 0 0 10px 0; color: #333; font-size: 16px; }
          .client-info p, .invoice-info p { margin: 5px 0; color: #666; font-size: 14px; }
          .service-details { margin-bottom: 30px; }
          .service-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
          .service-table th, .service-table td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e5e5; }
          .service-table th { background: #f8f9fa; font-weight: bold; color: #333; }
          .service-table .amount { text-align: right; font-weight: bold; }
          .total { text-align: right; margin-top: 20px; }
          .total-amount { font-size: 20px; font-weight: bold; color: #2563eb; }
          .status { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; }
          .status.completado { background: #d1fae5; color: #065f46; }
          .status.pendiente { background: #fef3c7; color: #92400e; }
          .status.fallido { background: #fee2e2; color: #991b1b; }
          .status.cancelado { background: #f3f4f6; color: #374151; }
          .footer { margin-top: 40px; text-align: center; color: #666; font-size: 12px; border-top: 1px solid #e5e5e5; padding-top: 20px; }
        </style>
      </head>
      <body>
        <div class="invoice">
          <div class="header">
            <div class="company-name">Gestor de Cobros</div>
            <div class="invoice-title">FACTURA</div>
          </div>
          
          <div class="invoice-details">
            <div class="client-info">
              <h3>Cliente</h3>
              <p><strong>${A.clientName}</strong></p>
              <p>${A.clientEmail}</p>
            </div>
            <div class="invoice-info">
              <h3>Detalles de la Factura</h3>
              <p><strong>Nmero:</strong> ${A.invoiceNumber}</p>
              <p><strong>Fecha:</strong> ${A.date}</p>
              <p><strong>Vencimiento:</strong> ${A.dueDate}</p>
              <p><strong>Estado:</strong> <span class="status ${A.status.toLowerCase()}">${A.status}</span></p>
            </div>
          </div>
          
          <div class="service-details">
            <h3>Detalles del Servicio</h3>
            <table class="service-table">
              <thead>
                <tr>
                  <th>Servicio</th>
                  <th>Descripcin</th>
                  <th>Monto</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>${A.serviceType}</td>
                  <td>${A.description}</td>
                  <td class="amount">${A.currency} ${A.amount.toFixed(2)}</td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <div class="total">
            <div class="total-amount">Total: ${A.currency} ${A.amount.toFixed(2)}</div>
          </div>
          
          <div class="footer">
            <p>Mtodo de Pago: ${A.paymentMethod}</p>
            <p>Gateway: ${A.gateway}</p>
            ${A.transactionId!=="N/A"?`<p>ID de Transaccin: ${A.transactionId}</p>`:""}
            <p>Gracias por su negocio</p>
          </div>
        </div>
      </body>
      </html>
    `,q=new Blob([P],{type:"text/html"}),te=URL.createObjectURL(q),le=document.createElement("a");le.href=te,le.download=`invoice-${A.invoiceNumber}.html`,document.body.appendChild(le),le.click(),document.body.removeChild(le),URL.revokeObjectURL(te),n("Invoice descargado exitosamente","success")},K=B=>B?new Date(B.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",F=(B,A)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:A||"USD"}).format(B),X=B=>{switch(B){case"Completado":return"";case"Pendiente":return"";case"Procesando":return"";case"Fallido":return"";case"Cancelado":return"";case"Reembolsado":return"";default:return""}},H=B=>{C(B),S(!0)},W=async(B,A)=>{const P=N(),q=P==null?void 0:P[A];if(q)if(A==="bankTransfer"){if(B.gateway!=="Transferencia Bancaria")try{const te=ut(Ve,"artifacts",Fe,"public","data","payments",B.id);await gr(te,{gateway:"Transferencia Bancaria",updatedAt:new Date}),n("Pasarela cambiada a Transferencia Bancaria","success")}catch{n("No se pudo actualizar la pasarela del pago","error")}H({...B,gateway:"Transferencia Bancaria"})}else n(`Redirigiendo a ${q.name} para procesar el pago`,"info")},Y=async(B,A)=>{if(!A||!(B!=null&&B.id)){n("Selecciona una imagen vlida","warning");return}try{D(he=>({...he,[B.id]:!0})),console.log(" Iniciando subida de comprobante va PHP...");const P=new FormData;P.append("file",A);const q=window.location.origin+"/upload.php";console.log(" Enviando a:",q);const te=await fetch(q,{method:"POST",body:P});if(console.log(" Respuesta recibida:",te.status,te.statusText),!te.ok){const he=await te.text();throw console.error(" Error del servidor:",he),new Error(`upload_failed_${te.status}: ${he}`)}const le=await te.json();console.log(" Respuesta JSON:",le);const ce=le==null?void 0:le.url;if(!ce)throw console.error(" No se recibi URL en la respuesta:",le),new Error("missing_url");const me=ut(Ve,"artifacts",Fe,"public","data","payments",B.id);await gr(me,{proofUrl:ce,proofUploadedAt:new Date,status:"Procesando"}),console.log(" Comprobante guardado en Firestore:",ce),C(he=>he&&he.id===B.id?{...he,proofUrl:ce,status:"Procesando"}:he),i(he=>he.map(we=>we.id===B.id?{...we,proofUrl:ce,status:"Procesando"}:we)),S(!1),n("Comprobante subido correctamente","success")}catch(P){console.error(" Upload proof failed:",P),n(`No se pudo subir el comprobante: ${P.message}`,"error")}finally{D(P=>({...P,[B.id]:!1}))}};return u?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(Ji,{}),"Mis Pagos"]}),a.jsxs("div",{className:"text-sm text-gray-500",children:[E.length," pago",E.length!==1?"s":""," encontrado",E.length!==1?"s":""]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar por servicio o transaccin...",value:s,onChange:B=>o(B.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Uu,{})})]}),a.jsx("select",{value:l,onChange:B=>c(B.target.value),className:"w-full p-2 border rounded-md",children:U.map(B=>a.jsx("option",{value:B,children:B},B))})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Total Pagado"}),a.jsx("div",{className:"text-2xl font-bold text-green-600",children:F(r.filter(B=>B.status==="Completado").reduce((B,A)=>B+(A.amount||0),0),"USD")})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Pendientes"}),a.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:r.filter(B=>B.status==="Pendiente").length})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Completados"}),a.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.filter(B=>B.status==="Completado").length})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Fallidos"}),a.jsx("div",{className:"text-2xl font-bold text-red-600",children:r.filter(B=>B.status==="Fallido").length})]})]}),E.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(Ji,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes pagos registrados"}),a.jsx("p",{className:"text-gray-500",children:"Los pagos aparecern aqu una vez que realices una transaccin."})]}):a.jsx("div",{className:"space-y-4",children:E.map(B=>a.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("span",{className:"text-2xl",children:X(B.status)}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:B.serviceName||B.serviceType||"Servicio"}),a.jsx("p",{className:"text-sm text-gray-500 font-mono",children:B.serviceNumber||B.id}),B.serviceDescription&&a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:B.serviceDescription}),B.isRenewal&&a.jsxs("div",{className:"text-xs text-green-600 font-medium mt-1",children:["Renovacin: ",B.renewalPeriod||"N/A"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Monto:"}),a.jsx("div",{className:"font-semibold text-lg text-gray-900",children:F(B.amount,B.currency)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Estado:"}),a.jsx("div",{className:"mt-1",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${L(B.status)}`,children:B.status})})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Pasarela:"}),a.jsx("div",{className:"mt-1",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${_(B.gateway)}`,children:B.gateway})})]})]}),a.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:[a.jsxs("div",{children:["Fecha: ",K(B.createdAt)]}),B.completedAt&&a.jsxs("div",{children:["Completado: ",K(B.completedAt)]}),B.startDate&&B.endDate&&a.jsx("div",{className:"text-blue-600 mt-2",children:a.jsxs("div",{children:["Perodo: ",K(B.startDate)," - ",K(B.endDate)]})}),B.transactionId&&a.jsxs("div",{className:"font-mono",children:["ID: ",B.transactionId]}),B.isRenewal&&B.renewalMonths&&a.jsxs("div",{className:"text-green-600",children:["Duracin: ",B.renewalMonths," meses"]})]})]}),a.jsxs("div",{className:"mt-4 md:mt-0 md:ml-4 flex flex-wrap gap-2",children:[(B.status==="Completado"||B.status==="Fallido"||B.status==="Cancelado")&&a.jsxs("button",{onClick:()=>M(B),className:"inline-flex items-center px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm",children:[a.jsx(xl,{className:"h-4 w-4 mr-1"}),"Descargar Invoice"]}),B.status==="Pendiente"&&a.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{const A=N();return A?Object.entries(A).map(([P,q])=>q.enabled?a.jsxs("button",{onClick:()=>W(B,P),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:["Pagar con ",q.name]},P):null):null})()}),B.gateway==="Transferencia Bancaria"&&a.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[B.status==="Pendiente"&&a.jsxs("label",{className:`px-4 py-2 ${R[B.id]?"bg-gray-200 text-gray-400 cursor-wait":"bg-gray-100 text-gray-800 hover:bg-gray-200 cursor-pointer"} rounded-lg text-sm`,children:[R[B.id]?"Subiendo...":"Subir Comprobante",a.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:A=>{var P;return((P=A.target.files)==null?void 0:P[0])&&Y(B,A.target.files[0])}})]}),B.proofUrl&&a.jsx("button",{onClick:()=>{T(B.proofUrl),oe(!0)},className:"px-4 py-2 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 text-sm",children:"Ver Comprobante"}),B.status==="Procesando"&&a.jsx("span",{className:"text-sm text-blue-600 font-medium",children:"Comprobante en revisin"})]})]})]})},B.id))}),p&&k&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsx("div",{className:"bg-white rounded-lg shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Instrucciones de Transferencia"}),a.jsx("button",{onClick:()=>S(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsx(PO,{bankAccounts:v,serviceNumber:k.serviceNumber,amount:k.amount,currency:k.currency,onUpload:B=>Y(k,B)})]})})}),ee&&V&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-50 flex justify-center items-center p-4",onClick:()=>oe(!1),children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-5xl w-full max-h-[95vh] overflow-hidden flex flex-col",onClick:B=>B.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b bg-gray-50",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Comprobante de Pago"}),a.jsx("button",{onClick:()=>oe(!1),className:"text-gray-400 hover:text-gray-600 text-2xl font-bold w-8 h-8 flex items-center justify-center","aria-label":"Cerrar",children:""})]}),a.jsx("div",{className:"flex-1 overflow-auto p-4 bg-gray-100 flex justify-center items-center min-h-[400px]",children:a.jsx("img",{src:V,alt:"Comprobante de pago",className:"max-w-full max-h-[80vh] object-contain rounded-lg shadow-lg",onError:B=>{B.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="%23999"%3ENo se pudo cargar la imagen%3C/text%3E%3C/svg%3E'}})}),a.jsxs("div",{className:"p-4 border-t bg-gray-50 flex justify-end gap-2",children:[a.jsx("a",{href:V,target:"_blank",rel:"noreferrer",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:"Abrir en Nueva Pestaa"}),a.jsx("button",{onClick:()=>{const B=document.createElement("a");B.href=V,B.download=`comprobante-${Date.now()}.${V.split(".").pop().split("?")[0]}`,document.body.appendChild(B),B.click(),document.body.removeChild(B)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm",children:"Descargar"}),a.jsx("button",{onClick:()=>oe(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 text-sm",children:"Cerrar"})]})]})})]})}function LO({user:t,userProfile:e}){const{addNotification:n}=pn(),[r,i]=ue.useState([]),[s,o]=ue.useState(null),[l,c]=ue.useState(!0),[u,f]=ue.useState(null),[v,g]=ue.useState(new Set),[p,S]=ue.useState(!1),k=[{key:"monthly",label:"Mensual",months:1},{key:"quarterly",label:"Trimestral",months:3},{key:"semiAnnual",label:"Semestral",months:6},{key:"annual",label:"Anual",months:12},{key:"biennial",label:"Bienal (2 aos)",months:24},{key:"triennial",label:"Trienal (3 aos)",months:36}];ue.useEffect(()=>{const F=ut(Ve,"artifacts",Fe,"public","data","settings","renewalConfig"),X=Gt(F,H=>{H.exists()?(o(H.data()),console.log("Renewal config loaded:",H.data())):(console.log("No renewal config found, using defaults"),o({discounts:{monthly:{enabled:!1,percentage:0},quarterly:{enabled:!0,percentage:5},semiAnnual:{enabled:!0,percentage:10},annual:{enabled:!0,percentage:15},biennial:{enabled:!0,percentage:25},triennial:{enabled:!0,percentage:35}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"}}))},H=>{console.error("Error loading renewal config:",H)});return()=>X()},[]),ue.useEffect(()=>{const F=localStorage.getItem("selectedServiceForRenewal");if(F)try{const X=JSON.parse(F);f(X),n(`Servicio "${X.serviceType}" seleccionado para renovacin`,"success"),localStorage.removeItem("selectedServiceForRenewal")}catch(X){console.error("Error parsing selected service:",X)}},[]),ue.useEffect(()=>{if(!u||r.length===0)return;const F=document.getElementById(`service-${u.id}`);F&&F.scrollIntoView({behavior:"smooth",block:"start"})},[u,r]),ue.useEffect(()=>{if(!(t!=null&&t.uid))return;const F=An(Ut(Ve,"artifacts",Fe,"public","data","payments"),cr("userId","==",t.uid),cr("status","==","Pendiente"),cr("isRenewal","==",!0)),X=Gt(F,H=>{const W=new Set;H.docs.forEach(Y=>{const B=Y.data();B.serviceId&&W.add(B.serviceId)}),g(W)},H=>{console.error("Error loading pending renewals:",H)});return()=>X()},[t==null?void 0:t.uid]);const C=F=>{if(!F.dueDate||!F.billingCycle||F.billingCycle==="One-Time")return F.expirationDate?new Date(F.expirationDate.seconds*1e3):null;const X=new Date(F.dueDate.seconds*1e3);let H=new Date(X);switch(F.billingCycle){case"Monthly":H.setMonth(H.getMonth()+1);break;case"Semiannually":H.setMonth(H.getMonth()+6);break;case"Annually":H.setFullYear(H.getFullYear()+1);break;case"Biennially":H.setFullYear(H.getFullYear()+2);break;case"Triennially":H.setFullYear(H.getFullYear()+3);break;default:return null}return H},b=F=>F.billingCycle==="One-Time"?F.dueDate?new Date(F.dueDate.seconds*1e3):null:C(F);ue.useEffect(()=>{if(!(t!=null&&t.uid)){c(!1);return}const F=An(Ut(Ve,"artifacts",Fe,"public","data","services"),cr("assignedUserId","==",t.uid)),X=Gt(F,Y=>{const B=Y.docs.map(A=>({id:A.id,...A.data()}));i(B)},Y=>{console.error("Error loading services:",Y),n("Error al cargar los servicios","error")}),H=ut(Ve,"artifacts",Fe,"public","data","settings","renewalConfig"),W=Gt(H,Y=>{Y.exists()&&o(Y.data()),c(!1)});return()=>{X(),W()}},[t==null?void 0:t.uid,n]);const I=(F,X)=>{var A,P;if(!((P=(A=s==null?void 0:s.discounts)==null?void 0:A[X])!=null&&P.enabled))return F;const H=s.discounts[X],W=F*H.discount/100,Y=F-W,B=Math.round(Y/s.pricingSettings.roundToNearest)*s.pricingSettings.roundToNearest;return Math.max(B,s.pricingSettings.minimumAmount)},R=F=>{var X;if(!((X=s==null?void 0:s.taxSettings)!=null&&X.ivaEnabled)||s.taxSettings.ivaIncluded)return F;{const H=F*s.taxSettings.ivaPercentage/100;return F+H}},D=F=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(F),ee=F=>{const X=b(F);if(!X)return 0;const H=new Date,W=X.getTime()-H.getTime();return Math.ceil(W/(1e3*60*60*24))},oe=F=>{switch(F){case"Activo":return"bg-green-100 text-green-800";case"Periodo de Gracia Vencido":return"bg-yellow-100 text-yellow-800";case"Pendiente Pago":return"bg-orange-100 text-orange-800";case"Pago":return"bg-blue-100 text-blue-800";case"Cancelado":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},V=F=>{switch(F){case"Monthly":return 1;case"Quarterly":return 3;case"Semi-Annual":return 6;case"Annually":return 12;case"Biennial":return 24;case"Triennial":return 36;case"One-Time":return 0;default:return 1}},T=(F,X)=>{var Y;const H=V(F.billingCycle),W=((Y=k.find(B=>B.key===X))==null?void 0:Y.months)||0;return H===0?!1:W>=H},N=(F,X)=>{var A;const H=b(F);if(!H)return{startDate:null,endDate:null};const W=((A=k.find(P=>P.key===X))==null?void 0:A.months)||0,Y=new Date(H),B=new Date(Y);return B.setMonth(B.getMonth()+W),{startDate:Y,endDate:B}},U=(F,X)=>{var Y;const H=V(F.billingCycle);return H===0?"Volver a Comprar":(((Y=k.find(B=>B.key===X))==null?void 0:Y.months)||0)<H?"Perodo Insuficiente":"Renovar"},E=()=>{window.location.href="#payments"},L=F=>{if(!F)return null;if(F.gateways)return F.gateways;const{bold:X,paypal:H,payu:W,bankTransfer:Y}=F,B={};return X&&(B.bold={name:"Bold",...X}),H&&(B.paypal={name:"PayPal",...H}),W&&(B.payu={name:"PayU",...W}),Y&&(B.bankTransfer={name:"Transferencia Bancaria",...Y}),B},[_,M]=ue.useState(null);ue.useEffect(()=>{const F=ut(Ve,"artifacts",Fe,"public","data","settings","paymentConfig"),X=Gt(F,H=>{H.exists()&&M(H.data())});return()=>X()},[]);const K=async(F,X)=>{var H,W,Y,B;if(v.has(F.id)){n("Ya tienes una solicitud de renovacin pendiente para este servicio","warning");return}if(p){n("Ya se est procesando una solicitud de renovacin","warning");return}S(!0);try{const{startDate:A,endDate:P}=N(F,X),q=F.amount,te=I(q,X),le=R(te);let ce=_&&L(_);const me=ce?Object.values(ce).filter(qe=>qe.enabled):[];let he="Pendiente de Seleccin",we="Renovacin";me.length===1&&(he=me[0].name,we=me[0].name);const Ee=F.currency||"USD",Le={userId:t.uid,serviceId:F.id,serviceName:F.serviceType,serviceType:F.serviceType,serviceDescription:F.description,serviceNumber:F.serviceNumber,amount:le,originalAmount:q,discount:q-te,currency:Ee,status:"Pendiente",paymentMethod:we,paymentType:"Renovacin",gateway:he,transactionId:null,dueDate:ft.fromDate(new Date(A)),renewalPeriod:((H=k.find(qe=>qe.key===X))==null?void 0:H.label)||X,renewalMonths:((W=k.find(qe=>qe.key===X))==null?void 0:W.months)||0,startDate:ft.fromDate(new Date(A)),endDate:ft.fromDate(new Date(P)),createdAt:ft.now(),updatedAt:ft.now(),notes:`Renovacin de ${(Y=k.find(qe=>qe.key===X))==null?void 0:Y.label} para el servicio ${F.serviceType}`,isRenewal:!0},Re=Ut(Ve,`artifacts/${Fe}/public/data/payments`);await Sa(Re,Le);const xe={service:F,period:X,startDate:A,endDate:P,originalPrice:q,discountedPrice:te,finalPrice:le};localStorage.setItem("renewalData",JSON.stringify(xe));const re=U(F,X);n(`${re} ${(B=k.find(qe=>qe.key===X))==null?void 0:B.label} - Redirigiendo a pagos`,"success"),g(qe=>new Set([...qe,F.id])),setTimeout(()=>{window.location.href="#payments"},1500)}catch(A){console.error("Error creating renewal payment:",A),n("Error al crear la solicitud de renovacin. Intenta nuevamente.","error")}finally{S(!1)}};return l?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("main",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(dl,{}),"Renovaciones de Servicios"]})}),r.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(dl,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes servicios para renovar"}),a.jsx("p",{className:"text-gray-500",children:"Contacta al administrador para que te asigne servicios."})]}):a.jsx("div",{className:"space-y-6",children:r.map(F=>{const X=ee(F),H=X<=30&&X>0,W=X<=0,Y=u&&u.id===F.id;return a.jsxs("div",{id:`service-${F.id}`,className:`bg-white rounded-xl shadow-lg p-6 ${Y?"ring-2 ring-blue-500 border-blue-200":""}`,children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:F.serviceType}),Y&&a.jsx("span",{className:"px-2 py-1 text-xs font-semibold text-blue-700 bg-blue-100 rounded-full",children:"Seleccionado"})]}),a.jsx("p",{className:"text-sm text-gray-500 font-mono",children:F.serviceNumber}),a.jsx("p",{className:"text-sm text-gray-600",children:F.description})]}),a.jsx("div",{className:"mt-2 md:mt-0",children:a.jsx("span",{className:`px-3 py-1 text-sm font-semibold rounded-full ${oe(F.status)}`,children:F.status})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Precio Actual:"}),a.jsx("div",{className:"font-semibold text-lg text-gray-900",children:D(F.amount)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:F.billingCycle==="One-Time"?"Fecha de Inicio:":"Fecha de Vencimiento:"}),a.jsx("div",{className:`font-semibold ${W?"text-red-600":H?"text-orange-600":"text-gray-900"}`,children:(()=>{const B=b(F);return B?B.toLocaleDateString():"N/A"})()}),a.jsx("div",{className:"text-xs text-gray-500",children:W?"Vencido":H?`${X} das restantes`:`${X} das restantes`})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Ciclo Actual:"}),a.jsx("div",{className:"font-semibold text-gray-900",children:F.billingCycle})]})]}),a.jsxs("div",{className:"border-t pt-6",children:[a.jsxs("h4",{className:"text-md font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(dA,{}),V(F.billingCycle)===0?"Opciones de Compra":"Opciones de Renovacin"]}),V(F.billingCycle)===0?a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.725-1.36 3.49 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Servicio de Pago nico"}),a.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:a.jsx("p",{children:'Este servicio es de pago nico. Para volver a adquirirlo, contacta al administrador o selecciona "Volver a Comprar" si est disponible.'})})]})]})}):a.jsxs("div",{className:"space-y-4",children:[(()=>{var A,P;const B=k.find(q=>V(F.billingCycle)===q.months);if(B){const q=F.amount,te=I(q,B.key),le=R(te),ce=(A=s==null?void 0:s.discounts)==null?void 0:A[B.key],me=q-te,{startDate:he,endDate:we}=N(F,B.key);return a.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h5",{className:"font-semibold text-blue-900 flex items-center gap-2",children:[a.jsx(dl,{className:"h-4 w-4"}),"Renovacin de Perodo Actual"]}),a.jsx("span",{className:"px-3 py-1 bg-blue-200 text-blue-800 text-sm font-semibold rounded-full",children:B.label})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[a.jsxs("div",{children:["Precio base: ",D(q)]}),(ce==null?void 0:ce.enabled)&&me>0&&a.jsxs("div",{className:"text-green-600",children:["Ahorras: ",D(me)]})]}),a.jsx("div",{className:"font-bold text-xl text-blue-600",children:D(le)}),((P=s==null?void 0:s.taxSettings)==null?void 0:P.ivaEnabled)&&a.jsx("div",{className:"text-xs text-gray-500",children:s.taxSettings.ivaIncluded?"IVA incluido":`+ ${s.taxSettings.taxName} ${s.taxSettings.ivaPercentage}%`})]}),a.jsx("div",{children:he&&we&&a.jsxs("div",{className:"p-3 bg-white border border-blue-200 rounded-lg",children:[a.jsx("div",{className:"text-xs font-medium text-blue-800 mb-2",children:"Fechas de Renovacin:"}),a.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[a.jsxs("div",{children:["Fecha de Vencimiento: ",he.toLocaleDateString()]}),a.jsxs("div",{children:["Fecha Nueva Renovacin: ",we.toLocaleDateString()]})]})]})})]}),v.has(F.id)?a.jsx("button",{onClick:E,className:"w-full mt-4 px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-colors",children:"Ver Solicitud Pendiente"}):a.jsx("button",{onClick:()=>K(F,B.key),disabled:p,className:`w-full mt-4 px-6 py-3 font-semibold rounded-lg transition-colors ${p?"bg-gray-400 text-white cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:p?"Creando...":`Renovar ${B.label}`})]})}return null})(),a.jsxs("div",{children:[a.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-3",children:"Otras Opciones de Renovacin:"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(B=>{var Le,Re,xe;const A=F.amount,P=I(A,B.key),q=R(P),te=(Le=s==null?void 0:s.discounts)==null?void 0:Le[B.key],le=A-P,ce=T(F,B),me=U(F,B),he=V(F.billingCycle)===B.months,we=!((Re=s==null?void 0:s.discounts)!=null&&Re[B.key])||s.discounts[B.key].enabled,Ee=ce&&!he&&we;return Ee?a.jsxs("div",{className:"border rounded-lg p-4 transition-shadow border-gray-200 hover:shadow-md",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h5",{className:"font-medium text-gray-800",children:B.label}),(te==null?void 0:te.enabled)&&Ee&&a.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-semibold rounded-full",children:["-",te.discount,"%"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsxs("div",{children:["Precio base: ",D(A)]}),(te==null?void 0:te.enabled)&&le>0&&a.jsxs("div",{className:"text-green-600",children:["Ahorras: ",D(le)]})]}),a.jsx("div",{className:"font-semibold text-lg text-blue-600",children:D(q)}),((xe=s==null?void 0:s.taxSettings)==null?void 0:xe.ivaEnabled)&&a.jsx("div",{className:"text-xs text-gray-500",children:s.taxSettings.ivaIncluded?"IVA incluido":`+ ${s.taxSettings.taxName} ${s.taxSettings.ivaPercentage}%`}),(()=>{const{startDate:re,endDate:qe}=N(F,B);return re&&qe?a.jsxs("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx("div",{className:"text-xs font-medium text-blue-800 mb-2",children:"Fechas de Renovacin:"}),a.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[a.jsxs("div",{children:["Fecha de Vencimiento: ",re.toLocaleDateString()]}),a.jsxs("div",{children:["Fecha Nueva Renovacin: ",qe.toLocaleDateString()]})]})]}):null})(),v.has(F.id)?a.jsx("button",{onClick:E,className:"w-full px-4 py-2 rounded-md text-sm font-medium bg-green-600 text-white hover:bg-green-700",children:"Ver Solicitud"}):a.jsx("button",{onClick:()=>K(F,B.key),disabled:p,className:`w-full px-4 py-2 rounded-md text-sm font-medium ${p?"bg-gray-400 text-white cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:p?"Creando...":`${me} ${B.label}`})]})]},B.key):null})})]})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h5",{className:"font-medium text-gray-800 mb-2",children:"Informacin Importante"}),a.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[a.jsxs("li",{children:[" ",a.jsx("strong",{children:'La "Renovacin de Perodo Actual" siempre est disponible y destacada'})]}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"Fecha de Vencimiento"}),": Fecha actual de vencimiento del servicio"]}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"Fecha Nueva Renovacin"}),": Fecha calculada despus de sumar el perodo"]}),a.jsx("li",{children:" Los descuentos se aplican automticamente segn el perodo seleccionado (si estn configurados)"}),a.jsx("li",{children:" Los precios se redondean para evitar decimales"}),a.jsx("li",{children:" El IVA se calcula segn la configuracin actual"}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"La renovacin extiende el servicio desde la fecha de vencimiento actual"})]}),a.jsx("li",{children:" El perodo de renovacin no puede ser inferior al ciclo actual del servicio"}),a.jsx("li",{children:' Los servicios de pago nico requieren "Volver a Comprar" en lugar de renovar'}),a.jsx("li",{children:" Al seleccionar una renovacin, sers redirigido a la seccin de pagos para proceder"})]})]})]},F.id)})})]})}function DO({user:t,userProfile:e}){const{addNotification:n}=pn(),[r,i]=ue.useState([]),[s,o]=ue.useState(!0),[l,c]=ue.useState(!1),[u,f]=ue.useState(null),[v,g]=ue.useState(!1),[p,S]=ue.useState({subject:"",department:"Soporte Tcnico",priority:"Media",description:""}),k=["Soporte Tcnico","Facturacin","Ventas","General"],C=["Baja","Media","Alta","Crtica"];ue.useEffect(()=>{if(!(t!=null&&t.uid)){o(!1);return}const N=An(Ut(Ve,"artifacts",Fe,"public","data","tickets"),cr("clientId","==",t.uid)),U=Gt(N,E=>{const L=E.docs.map(_=>({id:_.id,..._.data()}));L.sort((_,M)=>{var X,H;const K=((X=_.createdAt)==null?void 0:X.seconds)||0;return(((H=M.createdAt)==null?void 0:H.seconds)||0)-K}),i(L),o(!1)},E=>{console.error("Error loading tickets:",E),n("Error al cargar los tickets","error"),o(!1)});return()=>U()},[t==null?void 0:t.uid,n,e]);const b=async N=>{N.preventDefault(),console.log(" handleCreateTicket llamado - Iniciando creacin de ticket");try{console.log(" Creando ticket en Firestore...");const U={...p,ticketNumber:`TKT-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,status:"Abierto",clientId:t.uid,clientName:(e==null?void 0:e.fullName)||t.email,clientEmail:t.email,assignedTo:null,assignedToName:null,createdAt:ft.now(),updatedAt:ft.now(),lastReplyAt:ft.now(),lastReplyBy:"Cliente",replyCount:0,attachments:[]},L=(await Sa(Ut(Ve,"artifacts",Fe,"public","data","tickets"),U)).id;try{console.log(" Iniciando envo de notificaciones por email para ticket:",L),await Nr(),console.log(" Configuracin de email cargada");const _=(e==null?void 0:e.fullName)||t.email,M=U.ticketNumber,K=U.subject,F=U.description,X=U.department,H=U.priority,W=`
          <h2>Ticket Creado Exitosamente</h2>
          <p>Estimado/a <strong>${_}</strong>,</p>
          <p>Hemos recibido tu ticket de soporte. Nuestro equipo lo revisar y te responder pronto.</p>
          <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
            <p><strong>Nmero de Ticket:</strong> ${M}</p>
            <p><strong>Asunto:</strong> ${K}</p>
            <p><strong>Departamento:</strong> ${X}</p>
            <p><strong>Prioridad:</strong> ${H}</p>
            <p><strong>Descripcin:</strong></p>
            <p style="white-space: pre-wrap;">${F}</p>
          </div>
          <p>Puedes hacer seguimiento a tu ticket desde tu panel de cliente.</p>
          <p>Saludos cordiales,<br>Equipo de Soporte</p>
        `;console.log(" Enviando email al cliente:",t.email);const Y=await fr({to:t.email,toName:_,subject:`Ticket Creado - ${M}`,html:W,text:`Ticket Creado Exitosamente

Estimado/a ${_},

Hemos recibido tu ticket de soporte. Nuestro equipo lo revisar y te responder pronto.

Nmero de Ticket: ${M}
Asunto: ${K}
Departamento: ${X}
Prioridad: ${H}

Descripcin:
${F}

Puedes hacer seguimiento a tu ticket desde tu panel de cliente.

Saludos cordiales,
Equipo de Soporte`,type:"Notificacin",recipientType:"Cliente",module:"tickets",event:"ticketReply",metadata:{ticketId:L,ticketNumber:M}});console.log(" Resultado email cliente:",Y);const B=`
          <h2>Nuevo Ticket Creado</h2>
          <p>Se ha creado un nuevo ticket de soporte que requiere atencin.</p>
          <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
            <p><strong>Nmero de Ticket:</strong> ${M}</p>
            <p><strong>Cliente:</strong> ${_} (${t.email})</p>
            <p><strong>Asunto:</strong> ${K}</p>
            <p><strong>Departamento:</strong> ${X}</p>
            <p><strong>Prioridad:</strong> ${H}</p>
            <p><strong>Descripcin:</strong></p>
            <p style="white-space: pre-wrap;">${F}</p>
          </div>
          <p>Por favor, revisa y asigna el ticket desde el panel de administracin.</p>
        `,A=await Nr(),P=(A==null?void 0:A.fromEmail)||t.email;console.log(" Enviando email al administrador:",P);const q=await fr({to:P,toName:(A==null?void 0:A.fromName)||"Administrador",subject:`Nuevo Ticket - ${M} - ${K}`,html:B,text:`Nuevo Ticket Creado

Se ha creado un nuevo ticket de soporte que requiere atencin.

Nmero de Ticket: ${M}
Cliente: ${_} (${t.email})
Asunto: ${K}
Departamento: ${X}
Prioridad: ${H}

Descripcin:
${F}

Por favor, revisa y asigna el ticket desde el panel de administracin.`,type:"Notificacin",recipientType:"Administrador",module:"tickets",event:"newTicket",metadata:{ticketId:L,ticketNumber:M,clientEmail:t.email,clientName:_}});console.log(" Resultado email administrador:",q),console.log(" Notificaciones por email completadas")}catch(_){console.error(" Error sending ticket notification emails:",_),console.error(" Detalles del error:",_.message,_.stack)}n("Ticket creado exitosamente","success"),c(!1),S({subject:"",department:"Soporte Tcnico",priority:"Media",description:""})}catch(U){console.error("Error creating ticket:",U),n("Error al crear el ticket","error")}},I=N=>{f(N),g(!0)},R=async N=>{try{const U=ut(Ve,"artifacts",Fe,"public","data","tickets",N),E=await vs(U);if(!E.exists()){n("Ticket no encontrado","error");return}const L={id:E.id,...E.data()};await gr(U,{status:"Cerrado",updatedAt:ft.now()});try{console.log(" [CLIENT] Iniciando envo de notificaciones por cierre de ticket"),await Nr();const _=L.ticketNumber,M=L.subject,K=(e==null?void 0:e.fullName)||t.email,F=await Nr(),X=F==null?void 0:F.fromEmail;console.log(" [CLIENT] Enviando email al cliente por cierre:",t.email);const H=`
          <h2>Ticket ${_} Cerrado</h2>
          <p>Estimado/a <strong>${K}</strong>,</p>
          <p>Has cerrado tu ticket de soporte. Si necesitas ayuda adicional, puedes crear un nuevo ticket.</p>
          <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
            <p><strong>Nmero de Ticket:</strong> ${_}</p>
            <p><strong>Asunto:</strong> ${M}</p>
            <p><strong>Estado:</strong> Cerrado</p>
          </div>
          <p>Gracias por usar nuestro servicio de soporte.</p>
          <p>Saludos cordiales,<br>Equipo de Soporte</p>
        `;if(await fr({to:t.email,toName:K,subject:`Ticket ${_} - Cerrado`,html:H,text:`Ticket ${_} Cerrado

Estimado/a ${K},

Has cerrado tu ticket de soporte. Si necesitas ayuda adicional, puedes crear un nuevo ticket.

Nmero de Ticket: ${_}
Asunto: ${M}
Estado: Cerrado

Gracias por usar nuestro servicio de soporte.

Saludos cordiales,
Equipo de Soporte`,type:"Notificacin",recipientType:"Cliente",module:"tickets",event:"ticketResolved",metadata:{ticketId:N,ticketNumber:_,action:"closed_by_client"}}),X){console.log(" [CLIENT] Enviando email al administrador por cierre:",X);const W=`
            <h2>Ticket ${_} Cerrado por Cliente</h2>
            <p>Un cliente ha cerrado su ticket de soporte.</p>
            <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
              <p><strong>Nmero de Ticket:</strong> ${_}</p>
              <p><strong>Cliente:</strong> ${K} (${t.email})</p>
              <p><strong>Asunto:</strong> ${M}</p>
              <p><strong>Estado:</strong> Cerrado</p>
            </div>
          `;await fr({to:X,toName:(F==null?void 0:F.fromName)||"Administrador",subject:`Ticket ${_} - Cerrado por Cliente`,html:W,text:`Ticket ${_} Cerrado por Cliente

Un cliente ha cerrado su ticket de soporte.

Nmero de Ticket: ${_}
Cliente: ${K} (${t.email})
Asunto: ${M}
Estado: Cerrado`,type:"Notificacin",recipientType:"Administrador",module:"tickets",event:"ticketUpdate",metadata:{ticketId:N,ticketNumber:_,action:"closed_by_client",clientEmail:t.email}})}console.log(" [CLIENT] Notificaciones por cierre completadas")}catch(_){console.error(" [CLIENT] Error sending close ticket notification emails:",_)}n("Ticket cerrado exitosamente","success")}catch(U){console.error("Error closing ticket:",U),n("Error al cerrar el ticket","error")}},D=N=>({Abierto:"bg-red-100 text-red-800","En Progreso":"bg-yellow-100 text-yellow-800",Respondido:"bg-blue-100 text-blue-800",Cerrado:"bg-gray-100 text-gray-800","Esperando Cliente":"bg-orange-100 text-orange-800"})[N]||"bg-gray-100 text-gray-800",ee=N=>({Baja:"bg-green-100 text-green-800",Media:"bg-yellow-100 text-yellow-800",Alta:"bg-orange-100 text-orange-800",Crtica:"bg-red-100 text-red-800"})[N]||"bg-gray-100 text-gray-800",oe=N=>({"Soporte Tcnico":"bg-blue-100 text-blue-800",Facturacin:"bg-green-100 text-green-800",Ventas:"bg-purple-100 text-purple-800",General:"bg-gray-100 text-gray-800"})[N]||"bg-gray-100 text-gray-800",V=N=>N?new Date(N.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",T=N=>{if(!N)return"--";const U=new Date,E=new Date(N.seconds*1e3),L=U.getTime()-E.getTime(),_=Math.floor(L/(1e3*60*60*24)),M=Math.floor(L/(1e3*60*60)),K=Math.floor(L/(1e3*60));return _>0?`hace ${_} da${_>1?"s":""}`:M>0?`hace ${M} hora${M>1?"s":""}`:K>0?`hace ${K} minuto${K>1?"s":""}`:"hace unos segundos"};return s?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("main",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(ic,{}),"Mis Tickets de Soporte"]}),a.jsxs("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[a.jsx(Uh,{}),"Nuevo Ticket"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:a.jsx(hs,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Abiertos"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(N=>N.status==="Abierto").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(vh,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Respondidos"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(N=>N.status==="Respondido").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:a.jsx(hs,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"En Progreso"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(N=>N.status==="En Progreso").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:a.jsx(ic,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Cerrados"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(N=>N.status==="Cerrado").length})]})]})})]}),r.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(ic,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes tickets"}),a.jsx("p",{className:"text-gray-500 mb-4",children:"Crea tu primer ticket para obtener soporte."}),a.jsx("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Crear Primer Ticket"})]}):a.jsx("div",{className:"space-y-4",children:r.map(N=>a.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("span",{className:"font-mono text-sm font-medium text-blue-600",children:N.ticketNumber}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${D(N.status)}`,children:N.status}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ee(N.priority)}`,children:N.priority}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${oe(N.department)}`,children:N.department})]}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:N.subject}),a.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:N.description}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(hs,{}),a.jsxs("span",{children:["Creado ",T(N.createdAt)]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(op,{}),a.jsxs("span",{children:[N.replyCount," respuesta",N.replyCount!==1?"s":""]})]}),N.assignedToName&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(vh,{}),a.jsxs("span",{children:["Asignado a ",N.assignedToName]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>I(N),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md",title:"Ver ticket completo",children:a.jsx(xl,{})}),N.status!=="Cerrado"&&a.jsx("button",{onClick:()=>R(N.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-md",title:"Cerrar ticket",children:a.jsx(ap,{})})]})]})},N.id))}),l&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Crear Nuevo Ticket"}),a.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("form",{onSubmit:b,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto *"}),a.jsx("input",{type:"text",value:p.subject,onChange:N=>S(U=>({...U,subject:N.target.value})),className:"w-full p-2 border rounded-md",placeholder:"Describe brevemente tu problema o consulta",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento *"}),a.jsx("select",{value:p.department,onChange:N=>S(U=>({...U,department:N.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:k.map(N=>a.jsx("option",{value:N,children:N},N))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridad *"}),a.jsx("select",{value:p.priority,onChange:N=>S(U=>({...U,priority:N.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:C.map(N=>a.jsx("option",{value:N,children:N},N))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin *"}),a.jsx("textarea",{value:p.description,onChange:N=>S(U=>({...U,description:N.target.value})),className:"w-full p-2 border rounded-md",rows:6,placeholder:"Describe tu problema o consulta en detalle. Incluye cualquier informacin relevante que pueda ayudar a resolver tu ticket ms rpidamente.",required:!0})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>c(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Crear Ticket"})]})]})]})}),v&&u&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:["Ticket ",u.ticketNumber]}),a.jsx("button",{onClick:()=>g(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${D(u.status)}`,children:u.status})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prioridad"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ee(u.priority)}`,children:u.priority})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Departamento"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${oe(u.department)}`,children:u.department})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Asignado a"}),a.jsx("div",{className:"text-sm text-gray-900",children:u.assignedToName||"Sin asignar"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Creado"}),a.jsx("div",{className:"text-sm text-gray-900",children:V(u.createdAt)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"ltima actividad"}),a.jsx("div",{className:"text-sm text-gray-900",children:T(u.lastReplyAt)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto"}),a.jsx("div",{className:"text-sm text-gray-900 p-3 bg-gray-50 rounded-md",children:u.subject})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin"}),a.jsx("div",{className:"text-sm text-gray-900 p-4 bg-gray-50 rounded-md whitespace-pre-wrap",children:u.description})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Historial de Mensajes"}),a.jsx("div",{className:"border border-gray-200 rounded-md p-4",children:a.jsx(sS,{ticketId:u.id,userRole:"client",currentUser:t})})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cerrar"}),u.status!=="Cerrado"&&a.jsx("button",{onClick:()=>{R(u.id),g(!1)},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Cerrar Ticket"}),a.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Responder"})]})]})]})})]})}function OO({user:t,userProfile:e}){const[n,r]=ue.useState("services");ue.useEffect(()=>{const s=()=>{const o=(window.location.hash||"").replace("#","");(o==="services"||o==="payments"||o==="renewals"||o==="tickets")&&r(o)};return s(),window.addEventListener("hashchange",s),()=>window.removeEventListener("hashchange",s)},[]);const i=()=>{switch(n){case"tickets":return a.jsx(DO,{user:t,userProfile:e});case"payments":return a.jsx(RO,{user:t,userProfile:e});case"renewals":return a.jsx(LO,{user:t,userProfile:e});case"services":default:return a.jsx(IO,{user:t,userProfile:e})}};return a.jsxs("main",{className:"container mx-auto",children:[a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-8 px-4 sm:px-6 lg:px-8","aria-label":"Tabs",children:[a.jsxs("button",{onClick:()=>r("services"),className:`${n==="services"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(sp,{})," Mis Servicios"]}),a.jsxs("button",{onClick:()=>r("payments"),className:`${n==="payments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(Ji,{})," Mis Pagos"]}),a.jsxs("button",{onClick:()=>r("renewals"),className:`${n==="renewals"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(dl,{})," Renovaciones"]}),a.jsxs("button",{onClick:()=>r("tickets"),className:`${n==="tickets"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(ic,{})," Tickets de Soporte"]})]})}),i()]})}function MO({companySettings:t}){const{addNotification:e}=pn(),[n,r]=ue.useState(!0),[i,s]=ue.useState(""),[o,l]=ue.useState(""),[c,u]=ue.useState(!1),[f,v]=ue.useState(""),[g,p]=ue.useState(!1),S=async C=>{C.preventDefault();try{if(n){const b=await ZC(hr,i,o),I=await Na(An(Ut(Ve,"artifacts",Fe,"public","data","users"),cr("__name__","==",b.user.uid)));if(I.docs.length===0)throw new Error("No se encontr el perfil de usuario.");const R=I.docs[0].data();if(R.status==="pending"||R.status==="disabled")throw await Yl(hr),new Error("Tu cuenta est pendiente de activacin o ha sido deshabilitada.")}else{const b=await qm(hr,i,o);await eI(b.user);const I=Ut(Ve,"artifacts",Fe,"public","data","users");let D=(await Na(I)).empty?"superadmin":"client";const ee=D==="superadmin"?"active":"pending",oe=D!=="superadmin";await ws(ut(Ve,"artifacts",Fe,"public","data","users",b.user.uid),{email:i,role:D,status:ee,isProfileComplete:!1,createdAt:ft.now(),fullName:"",identification:"",requiresPasswordChange:oe}),D==="superadmin"?e("Registro exitoso! Eres el primer usuario y tienes permisos de superadministrador.","success"):(e("Registro exitoso! Revisa tu correo para verificar la cuenta. Un administrador debe activar tu usuario.","success"),await Yl(hr))}}catch(b){e(b.message,"error")}},k=async C=>{if(C.preventDefault(),!f){e("Por favor, ingresa tu email","error");return}p(!0);try{await YC(hr,f,{url:`${window.location.origin}${window.location.pathname}`,handleCodeInApp:!0}),e(`Se ha enviado un enlace de restablecimiento a ${f}. Revisa tu correo.`,"success"),u(!1),v("")}catch(b){console.error("Error enviando email de reset:",b);let I="Error al enviar el email de restablecimiento.";b.code==="auth/user-not-found"?I="No se encontr una cuenta con ese email.":b.code==="auth/invalid-email"?I="El email proporcionado no es vlido.":b.code==="auth/unauthorized-continue-uri"&&(I="El dominio no est autorizado en Firebase. Contacta al administrador para configurar el dominio en Firebase Console.",console.error(" IMPORTANTE: El dominio debe estar autorizado en Firebase Console:"),console.error("1. Ve a Firebase Console  Authentication  Settings  Authorized domains"),console.error(`2. Agrega el dominio: ${window.location.hostname}`)),e(I,"error")}finally{p(!1)}};return a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-sm w-full",children:[a.jsx("div",{className:"flex justify-center mb-6",children:t.logoUrl?a.jsx("img",{src:t.logoUrl,alt:"Logo de la Empresa",className:"max-h-16"}):a.jsx("h1",{className:"text-3xl font-bold",children:t.companyName||"Gestor de Pagos"})}),a.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:n?"Iniciar Sesin":"Crear Cuenta"}),a.jsxs("form",{onSubmit:S,children:[a.jsx("input",{type:"email",value:i,onChange:C=>s(C.target.value),placeholder:"Email",className:"w-full p-2 mb-4 border rounded",required:!0}),a.jsx("input",{type:"password",value:o,onChange:C=>l(C.target.value),placeholder:"Contrasea",className:"w-full p-2 mb-4 border rounded",required:!0}),n&&a.jsx("button",{type:"button",onClick:()=>u(!0),className:"w-full text-sm text-blue-600 hover:underline mb-2 text-right",children:"Olvidaste tu contrasea?"}),a.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700",children:n?"Entrar":"Registrarse"})]}),a.jsx("button",{onClick:()=>r(!n),className:"w-full mt-4 text-sm text-blue-600 hover:underline",children:n?"No tienes cuenta? Regstrate":"Ya tienes cuenta? Inicia sesin"}),c&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Restablecer Contrasea"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Ingresa tu email y te enviaremos un enlace para restablecer tu contrasea."}),a.jsxs("form",{onSubmit:k,children:[a.jsx("input",{type:"email",value:f,onChange:C=>v(C.target.value),placeholder:"Email",className:"w-full p-2 mb-4 border rounded",required:!0}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:()=>{u(!1),v("")},className:"flex-1 bg-gray-200 text-gray-800 p-2 rounded hover:bg-gray-300",children:"Cancelar"}),a.jsx("button",{type:"submit",disabled:g,className:"flex-1 bg-blue-600 text-white p-2 rounded hover:bg-blue-700 disabled:opacity-50",children:g?"Enviando...":"Enviar Enlace"})]})]})]})})]})})}function FO({isOpen:t,onSave:e}){const{addNotification:n}=pn(),[r,i]=ue.useState(""),[s,o]=ue.useState(""),[l,c]=ue.useState(""),u=async f=>{if(f.preventDefault(),r.length<6){c("La contrasea debe tener al menos 6 caracteres.");return}if(r!==s){c("Las contraseas no coinciden.");return}c("");try{await e(r),n("Contrasea cambiada exitosamente.","success")}catch{n("Error al cambiar la contrasea.","error")}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-md w-full",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Cambio de Contrasea Requerido"}),a.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Por seguridad, debes establecer una nueva contrasea para continuar."}),a.jsxs("form",{onSubmit:u,className:"space-y-4",children:[a.jsx("input",{type:"password",value:r,onChange:f=>i(f.target.value),placeholder:"Nueva Contrasea",className:"w-full p-2 border rounded-md",required:!0}),a.jsx("input",{type:"password",value:s,onChange:f=>o(f.target.value),placeholder:"Confirmar Nueva Contrasea",className:"w-full p-2 border rounded-md",required:!0}),l&&a.jsx("p",{className:"text-red-500 text-sm",children:l}),a.jsx("button",{type:"submit",className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md",children:"Guardar Contrasea"})]})]})}):null}function UO({companySettings:t,onResetComplete:e}){const{addNotification:n}=pn(),[r,i]=ue.useState(""),[s,o]=ue.useState(""),[l,c]=ue.useState(!1),[u,f]=ue.useState(!0),[v,g]=ue.useState(""),[p,S]=ue.useState("");ue.useEffect(()=>{(async()=>{const b=new URLSearchParams(window.location.search),I=b.get("oobCode"),R=b.get("mode");if(!I||R!=="resetPassword"){g("Enlace invlido o expirado. Por favor, solicita un nuevo enlace de restablecimiento."),f(!1);return}try{const D=await JC(hr,I);S(D),f(!1)}catch(D){console.error("Error verificando cdigo de reset:",D);let ee="El enlace de restablecimiento es invlido o ha expirado.";D.code==="auth/expired-action-code"?ee="El enlace de restablecimiento ha expirado. Por favor, solicita uno nuevo.":D.code==="auth/invalid-action-code"&&(ee="El enlace de restablecimiento es invlido. Por favor, solicita uno nuevo."),g(ee),f(!1)}})()},[searchParams]);const k=async C=>{if(C.preventDefault(),g(""),r.length<6){g("La contrasea debe tener al menos 6 caracteres.");return}if(r!==s){g("Las contraseas no coinciden.");return}const b=searchParams.get("oobCode");if(!b){g("Cdigo de restablecimiento no encontrado.");return}c(!0);try{await QC(hr,b,r),n("Contrasea restablecida exitosamente. Ahora puedes iniciar sesin.","success"),window.history.replaceState({},document.title,window.location.pathname),e&&setTimeout(()=>{e()},2e3)}catch(I){console.error("Error al restablecer contrasea:",I);let R="Error al restablecer la contrasea.";I.code==="auth/expired-action-code"?R="El enlace ha expirado. Por favor, solicita uno nuevo.":I.code==="auth/invalid-action-code"?R="El enlace es invlido. Por favor, solicita uno nuevo.":I.code==="auth/weak-password"&&(R="La contrasea es muy dbil. Por favor, usa una contrasea ms segura."),g(R)}finally{c(!1)}};return u?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-md w-full text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Verificando enlace de restablecimiento..."})]})}):v&&!p?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-md w-full",children:[a.jsx("div",{className:"text-center mb-6",children:t!=null&&t.logoUrl?a.jsx("img",{src:t.logoUrl,alt:"Logo",className:"max-h-16 mx-auto mb-4"}):a.jsx("h1",{className:"text-2xl font-bold mb-4",children:(t==null?void 0:t.companyName)||"Gestor de Pagos"})}),a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:a.jsx("p",{className:"text-red-800",children:v})}),a.jsx("button",{onClick:()=>{window.history.replaceState({},document.title,window.location.pathname),e&&e()},className:"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700",children:"Volver al Inicio de Sesin"})]})}):a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-md w-full",children:[a.jsxs("div",{className:"text-center mb-6",children:[t!=null&&t.logoUrl?a.jsx("img",{src:t.logoUrl,alt:"Logo",className:"max-h-16 mx-auto mb-4"}):a.jsx("h1",{className:"text-2xl font-bold mb-4",children:(t==null?void 0:t.companyName)||"Gestor de Pagos"}),a.jsx("h2",{className:"text-2xl font-bold",children:"Restablecer Contrasea"}),a.jsxs("p",{className:"text-gray-600 mt-2",children:["Ingresa tu nueva contrasea para ",p]})]}),v&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:a.jsx("p",{className:"text-red-800 text-sm",children:v})}),a.jsxs("form",{onSubmit:k,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nueva Contrasea"}),a.jsx("input",{type:"password",value:r,onChange:C=>i(C.target.value),placeholder:"Mnimo 6 caracteres",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0,minLength:6})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Nueva Contrasea"}),a.jsx("input",{type:"password",value:s,onChange:C=>o(C.target.value),placeholder:"Repite la contrasea",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0,minLength:6})]}),a.jsx("button",{type:"submit",disabled:l||!r||!s,className:"w-full bg-blue-600 text-white p-3 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:l?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Restableciendo..."]}):"Restablecer Contrasea"})]}),a.jsx("button",{onClick:()=>{window.history.replaceState({},document.title,window.location.pathname),e&&e()},className:"w-full mt-4 text-sm text-blue-600 hover:underline",children:"Volver al Inicio de Sesin"})]})})}function VO({companySettings:t,onResetComplete:e}){const{addNotification:n}=pn(),[r,i]=ue.useState(""),[s,o]=ue.useState(""),[l,c]=ue.useState(!1),[u,f]=ue.useState(!0),[v,g]=ue.useState(""),[p,S]=ue.useState(""),[k,C]=ue.useState(""),[b,I]=ue.useState(!1);ue.useEffect(()=>{(async()=>{const oe=new URLSearchParams(window.location.search).get("token");if(!oe){g("Token no encontrado en la URL. Por favor, usa el enlace completo que recibiste por correo."),f(!1);return}C(oe);try{const V=await A8(oe);if(!V.valid){g(V.error||"Token invlido o expirado"),f(!1);return}S(V.email),I(!0),f(!1)}catch(V){console.error("Error validando token:",V),g("Error al validar el token. Por favor, intenta nuevamente."),f(!1)}})()},[]);const R=async D=>{if(D.preventDefault(),g(""),r.length<6){g("La contrasea debe tener al menos 6 caracteres.");return}if(r!==s){g("Las contraseas no coinciden.");return}if(!k){g("Token no encontrado.");return}c(!0);try{const ee=await fetch("/reset-password-with-token.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:k,newPassword:r})}),oe=await ee.json();if(!ee.ok||!oe.success)throw new Error(oe.error||"Error al restablecer la contrasea");n("Contrasea restablecida exitosamente. Ahora puedes iniciar sesin.","success"),window.history.replaceState({},document.title,window.location.pathname),e&&setTimeout(()=>{e()},2e3)}catch(ee){console.error("Error al restablecer contrasea:",ee),g(ee.message||"Error al restablecer la contrasea. Por favor, intenta nuevamente.")}finally{c(!1)}};return u?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-md w-full text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Verificando token de restablecimiento..."})]})}):v&&!b?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-md w-full",children:[a.jsx("div",{className:"text-center mb-6",children:t!=null&&t.logoUrl?a.jsx("img",{src:t.logoUrl,alt:"Logo",className:"max-h-16 mx-auto mb-4"}):a.jsx("h1",{className:"text-2xl font-bold mb-4",children:(t==null?void 0:t.companyName)||"Gestor de Pagos"})}),a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:a.jsx("p",{className:"text-red-800",children:v})}),a.jsx("button",{onClick:()=>{window.history.replaceState({},document.title,window.location.pathname),e&&e()},className:"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700",children:"Volver al Inicio de Sesin"})]})}):a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-md w-full",children:[a.jsxs("div",{className:"text-center mb-6",children:[t!=null&&t.logoUrl?a.jsx("img",{src:t.logoUrl,alt:"Logo",className:"max-h-16 mx-auto mb-4"}):a.jsx("h1",{className:"text-2xl font-bold mb-4",children:(t==null?void 0:t.companyName)||"Gestor de Pagos"}),a.jsx("h2",{className:"text-2xl font-bold",children:"Restablecer Contrasea"}),a.jsxs("p",{className:"text-gray-600 mt-2",children:["Ingresa tu nueva contrasea para ",p]})]}),v&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:a.jsx("p",{className:"text-red-800 text-sm",children:v})}),a.jsxs("form",{onSubmit:R,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nueva Contrasea"}),a.jsx("input",{type:"password",value:r,onChange:D=>i(D.target.value),placeholder:"Mnimo 6 caracteres",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0,minLength:6})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Nueva Contrasea"}),a.jsx("input",{type:"password",value:s,onChange:D=>o(D.target.value),placeholder:"Repite la contrasea",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0,minLength:6})]}),a.jsx("button",{type:"submit",disabled:l||!r||!s,className:"w-full bg-blue-600 text-white p-3 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:l?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Restableciendo..."]}):"Restablecer Contrasea"})]}),a.jsx("button",{onClick:()=>{window.history.replaceState({},document.title,window.location.pathname),e&&e()},className:"w-full mt-4 text-sm text-blue-600 hover:underline",children:"Volver al Inicio de Sesin"})]})})}function BO({isOpen:t,onComplete:e,user:n,userProfile:r}){const{addNotification:i}=pn(),[s,o]=ue.useState({fullName:(r==null?void 0:r.fullName)||"",identification:(r==null?void 0:r.identification)||"",phone:(r==null?void 0:r.phone)||"",address:(r==null?void 0:r.address)||""}),[l,c]=ue.useState(!1);ue.useEffect(()=>{const v=new URLSearchParams(window.location.search),g=v.get("uid");v.get("email");const p=v.get("name"),S=v.get("id");g&&g===(n==null?void 0:n.uid)&&(p||S)&&o(k=>({...k,fullName:p?decodeURIComponent(p):k.fullName,identification:S?decodeURIComponent(S):k.identification}))},[n==null?void 0:n.uid]);const u=v=>{const{name:g,value:p}=v.target;o(S=>({...S,[g]:p}))},f=async v=>{if(v.preventDefault(),!s.fullName.trim()){i("El nombre completo es obligatorio","error");return}c(!0);try{const g=ut(Ve,"artifacts",Fe,"public","data","users",n.uid);await gr(g,{fullName:s.fullName.trim(),identification:s.identification.trim(),phone:s.phone.trim(),address:s.address.trim(),isProfileComplete:!0,profileCompletedAt:new Date}),i("Perfil completado exitosamente","success"),e()}catch(g){console.error("Error completing profile:",g),i("Error al completar el perfil","error")}finally{c(!1)}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Completar Perfil"}),a.jsxs("p",{className:"text-gray-600 mt-2",children:["Bienvenido ",n.email,"! Confirma o actualiza tu informacin para continuar."]})]}),a.jsxs("form",{onSubmit:f,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Completo *"}),a.jsx("input",{name:"fullName",value:s.fullName,onChange:u,placeholder:"Tu nombre completo",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Identificacin"}),a.jsx("input",{name:"identification",value:s.identification,onChange:u,placeholder:"Cdula, DNI, etc.",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telfono"}),a.jsx("input",{name:"phone",value:s.phone,onChange:u,placeholder:"+57 300 123 4567",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Direccin"}),a.jsx("input",{name:"address",value:s.address,onChange:u,placeholder:"Tu direccin",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]})]}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Informacin Importante"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[a.jsx("li",{children:" Los datos mostrados fueron configurados por el administrador"}),a.jsx("li",{children:" Puedes confirmar o modificar la informacin"}),a.jsx("li",{children:" Esta informacin se usar para la facturacin"}),a.jsx("li",{children:" Puedes actualizar estos datos ms tarde"})]})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx("button",{type:"submit",disabled:l,className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold disabled:opacity-50 flex items-center gap-2",children:l?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Completando..."]}):"Completar Perfil"})})]})]})}):null}function $O({onComplete:t}){const{addNotification:e}=pn(),[n,r]=ue.useState(1),[i,s]=ue.useState({companyName:"",identification:"",address:"",phone:"",email:"",website:""}),[o,l]=ue.useState({email:"",password:"",confirmPassword:"",fullName:"",identification:""}),[c,u]=ue.useState(!1),f=S=>{const{name:k,value:C}=S.target;s(b=>({...b,[k]:C}))},v=S=>{const{name:k,value:C}=S.target;l(b=>({...b,[k]:C}))},g=S=>{if(S.preventDefault(),!i.companyName){e("El nombre de la empresa es obligatorio","error");return}r(2)},p=async S=>{if(S.preventDefault(),o.password!==o.confirmPassword){e("Las contraseas no coinciden","error");return}if(o.password.length<6){e("La contrasea debe tener al menos 6 caracteres","error");return}u(!0);try{const k=await qm(hr,o.email,o.password);await ws(ut(Ve,"artifacts",Fe,"public","data","users",k.user.uid),{email:o.email,fullName:o.fullName,identification:o.identification,role:"superadmin",status:"active",isProfileComplete:!0,createdAt:ft.now(),requiresPasswordChange:!1}),await ws(ut(Ve,"artifacts",Fe,"public","data","settings","company_info"),{...i,isDemoMode:!1,createdAt:ft.now()}),e("Configuracin inicial completada exitosamente!","success"),r(3),setTimeout(()=>{t()},2e3)}catch(k){console.error("Error en configuracin inicial:",k),e(`Error: ${k.message}`,"error")}finally{u(!1)}};return n===1?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Configuracin Inicial"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Paso 1 de 2: Informacin de la Empresa"})]}),a.jsxs("form",{onSubmit:g,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"companyName",value:i.companyName,onChange:f,placeholder:"Nombre de la Empresa *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),a.jsx("input",{name:"identification",value:i.identification,onChange:f,placeholder:"NIT / Identificacin Fiscal",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"address",value:i.address,onChange:f,placeholder:"Direccin",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"}),a.jsx("input",{name:"phone",value:i.phone,onChange:f,placeholder:"Telfono",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"email",type:"email",value:i.email,onChange:f,placeholder:"Email de Contacto",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"}),a.jsx("input",{name:"website",value:i.website,onChange:f,placeholder:"Sitio Web",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold",children:"Continuar"})})]})]})}):n===2?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Crear Superadministrador"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Paso 2 de 2: Cuenta de Administrador Principal"})]}),a.jsxs("form",{onSubmit:p,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"fullName",value:o.fullName,onChange:v,placeholder:"Nombre Completo *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),a.jsx("input",{name:"identification",value:o.identification,onChange:v,placeholder:"Identificacin",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),a.jsx("input",{name:"email",type:"email",value:o.email,onChange:v,placeholder:"Email del Administrador *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"password",type:"password",value:o.password,onChange:v,placeholder:"Contrasea *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),a.jsx("input",{name:"confirmPassword",type:"password",value:o.confirmPassword,onChange:v,placeholder:"Confirmar Contrasea *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{className:"flex justify-between pt-4",children:[a.jsx("button",{type:"button",onClick:()=>r(1),className:"px-6 py-3 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 font-semibold",children:"Atrs"}),a.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold disabled:opacity-50",children:c?"Creando...":"Completar Configuracin"})]})]})]})}):n===3?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-md w-full text-center",children:[a.jsx("div",{className:"text-green-500 text-6xl mb-4",children:""}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Configuracin Completada!"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"El sistema est listo para usar. Sers redirigido al dashboard en unos segundos..."}),a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"})]})}):null}if(typeof window<"u")try{o8()}catch(t){console.warn("No se pudo configurar el filtro de errores:",t)}function zO(){const{addNotification:t}=pn(),[e,n]=ue.useState(null),[r,i]=ue.useState(null),[s,o]=ue.useState(!0),[l,c]=ue.useState({companyName:"Gestor de Cobros"}),[u,f]=ue.useState(!1),[v,g]=ue.useState(!1),p=async()=>{try{console.log(" Verificando si el sistema est configurado...");try{if((await n8()).hasUsers)return console.log(" Usuarios encontrados en Firestore"),!0}catch(L){console.warn(" Error accediendo a Firestore:",L.message)}return await r8()?(console.log(" Usuarios encontrados en Authentication"),!0):(console.log(" Asumiendo que el sistema est configurado (hay errores de permisos)"),!0)}catch(E){return console.error(" Error verificando configuracin:",E),!0}};ue.useEffect(()=>{(async()=>{try{console.log(" Iniciando verificacin de configuracin..."),console.log(" Verificando configuracin de empresa...");const L=ut(Ve,"artifacts",Fe,"public","data","settings","company_info"),_=await vs(L);if(_.exists()){console.log(" Configuracin de empresa encontrada");const K=_.data();console.log(" Configuracin:",K),c(K),g(!0),f(!1),console.log(" Sistema configurado con configuracin existente");return}console.log(" No hay configuracin, verificando si hay usuarios..."),await p()?(console.log(" Sistema ya configurado, saltando setup inicial"),c({companyName:"Gestor de Cobros"}),g(!0),f(!1)):(console.log(" Sistema no configurado, mostrando setup inicial"),f(!0))}catch(L){console.error(" Error checking configuration:",L),L.code==="permission-denied"&&(console.error(" Error de permisos de Firestore. Verifica que las reglas estn configuradas correctamente."),console.error(" Consulta firebase-rules.txt para las reglas necesarias.")),console.log(" Error en verificacin, asumiendo que el sistema est configurado"),c({companyName:"Gestor de Cobros"}),g(!0),f(!1)}})()},[]),ue.useEffect(()=>{if(!v)return;c8().catch(L=>{console.error("Error inicializando plantillas de contrasea:",L)});const E=sI(hr,L=>{if(L){const _=ut(Ve,"artifacts",Fe,"public","data","users",L.uid),M=Gt(_,async K=>{if(K.exists()){const F=K.data();F.status==="active"||F.role==="superadmin"?(i(F),n(L)):(console.warn("Usuario inactivo o sin permisos:",F),t("Tu cuenta no est activa. Contacta al administrador.","error"),Yl(hr))}else console.warn("No se encontr el perfil de usuario en la base de datos"),console.log("Usuario no tiene perfil en Firestore, cerrando sesin..."),t("Usuario no encontrado en el sistema. Contacta al administrador.","error"),Yl(hr);o(!1)},K=>{if(console.error("Error fetching user data:",K),K.code==="permission-denied"){console.warn(" Error de permisos al obtener datos del usuario. Cerrando sesin..."),Yl(hr).catch(F=>{console.error("Error al cerrar sesin:",F)}),o(!1);return}L&&(console.error(" Verifica que las reglas de Firestore permitan lectura/escritura para usuarios autenticados."),t("Error al cargar el perfil de usuario. Intenta nuevamente.","error")),o(!1)});return()=>M()}else n(null),i(null),o(!1)});return()=>{E()}},[v]);const S=async E=>{const L=hr.currentUser;if(L)try{await tI(L,E);const _=ut(Ve,"artifacts",Fe,"public","data","users",L.uid);await gr(_,{requiresPasswordChange:!1})}catch(_){console.error("Error updating password:",_),t("Hubo un error al cambiar la contrasea.","error"),Yl(hr)}},k=()=>{Yl(hr)},C=(l==null?void 0:l.inactivityTimeoutMinutes)||10;a8(()=>{t(`Sesin cerrada por inactividad (${C} minutos sin actividad)`,"warning"),setTimeout(()=>{k()},1e3)},C,!!e);const I=()=>{f(!1),g(!0),window.location.reload()};if(u)return a.jsx($O,{onComplete:I});if(s)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"Cargando..."});const R=new URLSearchParams(window.location.search),D=R.get("token"),ee=R.get("oobCode"),oe=R.get("mode"),V=D&&!ee,T=ee&&oe==="resetPassword";if(V)return a.jsx(VO,{companySettings:l,onResetComplete:()=>{window.history.replaceState({},document.title,window.location.pathname),window.location.reload()}});if(T)return a.jsx(UO,{companySettings:l,onResetComplete:()=>{window.history.replaceState({},document.title,window.location.pathname),window.location.reload()}});if(r!=null&&r.requiresPasswordChange&&(r==null?void 0:r.role)!=="superadmin"&&(r==null?void 0:r.role)!=="admin")return a.jsx(FO,{isOpen:!0,onSave:S});const N=R.get("uid"),U=N&&N===(e==null?void 0:e.uid);return(r==null?void 0:r.role)==="client"&&(!(r!=null&&r.isProfileComplete)&&(r==null?void 0:r.requiresPasswordChange)===!1||U)?a.jsx(BO,{isOpen:!0,onComplete:()=>{i(E=>({...E,isProfileComplete:!0})),U&&window.history.replaceState({},document.title,window.location.pathname)},user:e,userProfile:r}):a.jsx("div",{className:"bg-gray-50 min-h-screen font-sans text-gray-800",children:e?a.jsxs(a.Fragment,{children:[a.jsx("header",{className:"bg-white shadow-md",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center",children:[l.logoUrl?a.jsx("img",{src:l.logoUrl,alt:l.companyName,className:"max-h-10"}):a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:l.companyName}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("span",{className:"text-sm text-gray-600 hidden sm:block",children:e.email}),a.jsx("button",{onClick:k,className:"text-gray-500 hover:text-red-600",children:a.jsx(u8,{})})]})]})}),(r==null?void 0:r.role)==="superadmin"||(r==null?void 0:r.role)==="admin"?a.jsx(jO,{user:e,userRole:r==null?void 0:r.role,companySettings:l,onLogout:k}):a.jsx(OO,{user:e,userProfile:r})]}):a.jsx("div",{className:"flex flex-col min-h-screen",children:a.jsx("div",{className:"flex-grow",children:a.jsx(MO,{companySettings:l})})})})}function qO(){return a.jsx(s8,{children:a.jsx(zO,{})})}k0.createRoot(document.getElementById("root")).render(a.jsx(o3.StrictMode,{children:a.jsx(qO,{})}));export{hn as _,WO as c,HS as g};
