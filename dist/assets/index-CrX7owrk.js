(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();function Y_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var w0={exports:{}},Pc={},_0={exports:{}},fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ao=Symbol.for("react.element"),X_=Symbol.for("react.portal"),J_=Symbol.for("react.fragment"),Z_=Symbol.for("react.strict_mode"),eN=Symbol.for("react.profiler"),tN=Symbol.for("react.provider"),nN=Symbol.for("react.context"),rN=Symbol.for("react.forward_ref"),sN=Symbol.for("react.suspense"),iN=Symbol.for("react.memo"),aN=Symbol.for("react.lazy"),$p=Symbol.iterator;function oN(t){return t===null||typeof t!="object"?null:(t=$p&&t[$p]||t["@@iterator"],typeof t=="function"?t:null)}var N0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E0=Object.assign,T0={};function Ii(t,e,n){this.props=t,this.context=e,this.refs=T0,this.updater=n||N0}Ii.prototype.isReactComponent={};Ii.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ii.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function j0(){}j0.prototype=Ii.prototype;function Wh(t,e,n){this.props=t,this.context=e,this.refs=T0,this.updater=n||N0}var Kh=Wh.prototype=new j0;Kh.constructor=Wh;E0(Kh,Ii.prototype);Kh.isPureReactComponent=!0;var zp=Array.isArray,S0=Object.prototype.hasOwnProperty,Qh={current:null},C0={key:!0,ref:!0,__self:!0,__source:!0};function I0(t,e,n){var r,s={},a=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)S0.call(e,r)&&!C0.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:ao,type:t,key:a,ref:o,props:s,_owner:Qh.current}}function lN(t,e){return{$$typeof:ao,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Yh(t){return typeof t=="object"&&t!==null&&t.$$typeof===ao}function cN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var qp=/\/+/g;function $u(t,e){return typeof t=="object"&&t!==null&&t.key!=null?cN(""+t.key):e.toString(36)}function xl(t,e,n,r,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ao:case X_:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+$u(o,0):r,zp(s)?(n="",t!=null&&(n=t.replace(qp,"$&/")+"/"),xl(s,e,n,"",function(d){return d})):s!=null&&(Yh(s)&&(s=lN(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(qp,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",zp(t))for(var c=0;c<t.length;c++){a=t[c];var u=r+$u(a,c);o+=xl(a,e,n,u,s)}else if(u=oN(t),typeof u=="function")for(t=u.call(t),c=0;!(a=t.next()).done;)a=a.value,u=r+$u(a,c++),o+=xl(a,e,n,u,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ko(t,e,n){if(t==null)return t;var r=[],s=0;return xl(t,r,"","",function(a){return e.call(n,a,s++)}),r}function uN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var kt={current:null},vl={transition:null},dN={ReactCurrentDispatcher:kt,ReactCurrentBatchConfig:vl,ReactCurrentOwner:Qh};function A0(){throw Error("act(...) is not supported in production builds of React.")}fe.Children={map:Ko,forEach:function(t,e,n){Ko(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ko(t,function(){e++}),e},toArray:function(t){return Ko(t,function(e){return e})||[]},only:function(t){if(!Yh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};fe.Component=Ii;fe.Fragment=J_;fe.Profiler=eN;fe.PureComponent=Wh;fe.StrictMode=Z_;fe.Suspense=sN;fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dN;fe.act=A0;fe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=E0({},t.props),s=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=Qh.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)S0.call(e,u)&&!C0.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:ao,type:t.type,key:s,ref:a,props:r,_owner:o}};fe.createContext=function(t){return t={$$typeof:nN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:tN,_context:t},t.Consumer=t};fe.createElement=I0;fe.createFactory=function(t){var e=I0.bind(null,t);return e.type=t,e};fe.createRef=function(){return{current:null}};fe.forwardRef=function(t){return{$$typeof:rN,render:t}};fe.isValidElement=Yh;fe.lazy=function(t){return{$$typeof:aN,_payload:{_status:-1,_result:t},_init:uN}};fe.memo=function(t,e){return{$$typeof:iN,type:t,compare:e===void 0?null:e}};fe.startTransition=function(t){var e=vl.transition;vl.transition={};try{t()}finally{vl.transition=e}};fe.unstable_act=A0;fe.useCallback=function(t,e){return kt.current.useCallback(t,e)};fe.useContext=function(t){return kt.current.useContext(t)};fe.useDebugValue=function(){};fe.useDeferredValue=function(t){return kt.current.useDeferredValue(t)};fe.useEffect=function(t,e){return kt.current.useEffect(t,e)};fe.useId=function(){return kt.current.useId()};fe.useImperativeHandle=function(t,e,n){return kt.current.useImperativeHandle(t,e,n)};fe.useInsertionEffect=function(t,e){return kt.current.useInsertionEffect(t,e)};fe.useLayoutEffect=function(t,e){return kt.current.useLayoutEffect(t,e)};fe.useMemo=function(t,e){return kt.current.useMemo(t,e)};fe.useReducer=function(t,e,n){return kt.current.useReducer(t,e,n)};fe.useRef=function(t){return kt.current.useRef(t)};fe.useState=function(t){return kt.current.useState(t)};fe.useSyncExternalStore=function(t,e,n){return kt.current.useSyncExternalStore(t,e,n)};fe.useTransition=function(){return kt.current.useTransition()};fe.version="18.3.1";_0.exports=fe;var L=_0.exports;const hN=Y_(L);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mN=L,fN=Symbol.for("react.element"),pN=Symbol.for("react.fragment"),gN=Object.prototype.hasOwnProperty,yN=mN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xN={key:!0,ref:!0,__self:!0,__source:!0};function k0(t,e,n){var r,s={},a=null,o=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)gN.call(e,r)&&!xN.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:fN,type:t,key:a,ref:o,props:s,_owner:yN.current}}Pc.Fragment=pN;Pc.jsx=k0;Pc.jsxs=k0;w0.exports=Pc;var i=w0.exports,Cd={},P0={exports:{}},Yt={},R0={exports:{}},D0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(v,A){var F=v.length;v.push(A);e:for(;0<F;){var K=F-1>>>1,G=v[K];if(0<s(G,A))v[K]=A,v[F]=G,F=K;else break e}}function n(v){return v.length===0?null:v[0]}function r(v){if(v.length===0)return null;var A=v[0],F=v.pop();if(F!==A){v[0]=F;e:for(var K=0,G=v.length,Z=G>>>1;K<Z;){var U=2*(K+1)-1,Q=v[U],X=U+1,ae=v[X];if(0>s(Q,F))X<G&&0>s(ae,Q)?(v[K]=ae,v[X]=F,K=X):(v[K]=Q,v[U]=F,K=U);else if(X<G&&0>s(ae,F))v[K]=ae,v[X]=F,K=X;else break e}}return A}function s(v,A){var F=v.sortIndex-A.sortIndex;return F!==0?F:v.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],d=[],m=1,g=null,y=3,x=!1,S=!1,E=!1,P=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(v){for(var A=n(d);A!==null;){if(A.callback===null)r(d);else if(A.startTime<=v)r(d),A.sortIndex=A.expirationTime,e(u,A);else break;A=n(d)}}function M(v){if(E=!1,R(v),!S)if(n(u)!==null)S=!0,V(q);else{var A=n(d);A!==null&&O(M,A.startTime-v)}}function q(v,A){S=!1,E&&(E=!1,T(b),b=-1),x=!0;var F=y;try{for(R(A),g=n(u);g!==null&&(!(g.expirationTime>A)||v&&!k());){var K=g.callback;if(typeof K=="function"){g.callback=null,y=g.priorityLevel;var G=K(g.expirationTime<=A);A=t.unstable_now(),typeof G=="function"?g.callback=G:g===n(u)&&r(u),R(A)}else r(u);g=n(u)}if(g!==null)var Z=!0;else{var U=n(d);U!==null&&O(M,U.startTime-A),Z=!1}return Z}finally{g=null,y=F,x=!1}}var z=!1,I=null,b=-1,C=5,p=-1;function k(){return!(t.unstable_now()-p<C)}function w(){if(I!==null){var v=t.unstable_now();p=v;var A=!0;try{A=I(!0,v)}finally{A?N():(z=!1,I=null)}}else z=!1}var N;if(typeof j=="function")N=function(){j(w)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,D=$.port2;$.port1.onmessage=w,N=function(){D.postMessage(null)}}else N=function(){P(w,0)};function V(v){I=v,z||(z=!0,N())}function O(v,A){b=P(function(){v(t.unstable_now())},A)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(v){v.callback=null},t.unstable_continueExecution=function(){S||x||(S=!0,V(q))},t.unstable_forceFrameRate=function(v){0>v||125<v?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<v?Math.floor(1e3/v):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(v){switch(y){case 1:case 2:case 3:var A=3;break;default:A=y}var F=y;y=A;try{return v()}finally{y=F}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(v,A){switch(v){case 1:case 2:case 3:case 4:case 5:break;default:v=3}var F=y;y=v;try{return A()}finally{y=F}},t.unstable_scheduleCallback=function(v,A,F){var K=t.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?K+F:K):F=K,v){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=F+G,v={id:m++,callback:A,priorityLevel:v,startTime:F,expirationTime:G,sortIndex:-1},F>K?(v.sortIndex=F,e(d,v),n(u)===null&&v===n(d)&&(E?(T(b),b=-1):E=!0,O(M,F-K))):(v.sortIndex=G,e(u,v),S||x||(S=!0,V(q))),v},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(v){var A=y;return function(){var F=y;y=A;try{return v.apply(this,arguments)}finally{y=F}}}})(D0);R0.exports=D0;var vN=R0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bN=L,Qt=vN;function J(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var M0=new Set,Ra={};function js(t,e){hi(t,e),hi(t+"Capture",e)}function hi(t,e){for(Ra[t]=e,t=0;t<e.length;t++)M0.add(e[t])}var Xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Id=Object.prototype.hasOwnProperty,wN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Hp={},Gp={};function _N(t){return Id.call(Gp,t)?!0:Id.call(Hp,t)?!1:wN.test(t)?Gp[t]=!0:(Hp[t]=!0,!1)}function NN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function EN(t,e,n,r){if(e===null||typeof e>"u"||NN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Pt(t,e,n,r,s,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var dt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){dt[t]=new Pt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];dt[e]=new Pt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){dt[t]=new Pt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){dt[t]=new Pt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){dt[t]=new Pt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){dt[t]=new Pt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){dt[t]=new Pt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){dt[t]=new Pt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){dt[t]=new Pt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Xh=/[\-:]([a-z])/g;function Jh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Xh,Jh);dt[e]=new Pt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Xh,Jh);dt[e]=new Pt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Xh,Jh);dt[e]=new Pt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){dt[t]=new Pt(t,1,!1,t.toLowerCase(),null,!1,!1)});dt.xlinkHref=new Pt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){dt[t]=new Pt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Zh(t,e,n,r){var s=dt.hasOwnProperty(e)?dt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(EN(e,n,s,r)&&(n=null),r||s===null?_N(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var lr=bN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qo=Symbol.for("react.element"),$s=Symbol.for("react.portal"),zs=Symbol.for("react.fragment"),em=Symbol.for("react.strict_mode"),Ad=Symbol.for("react.profiler"),O0=Symbol.for("react.provider"),L0=Symbol.for("react.context"),tm=Symbol.for("react.forward_ref"),kd=Symbol.for("react.suspense"),Pd=Symbol.for("react.suspense_list"),nm=Symbol.for("react.memo"),gr=Symbol.for("react.lazy"),V0=Symbol.for("react.offscreen"),Wp=Symbol.iterator;function Ji(t){return t===null||typeof t!="object"?null:(t=Wp&&t[Wp]||t["@@iterator"],typeof t=="function"?t:null)}var Ue=Object.assign,zu;function la(t){if(zu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);zu=e&&e[1]||""}return`
`+zu+t}var qu=!1;function Hu(t,e){if(!t||qu)return"";qu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),a=r.stack.split(`
`),o=s.length-1,c=a.length-1;1<=o&&0<=c&&s[o]!==a[c];)c--;for(;1<=o&&0<=c;o--,c--)if(s[o]!==a[c]){if(o!==1||c!==1)do if(o--,c--,0>c||s[o]!==a[c]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=c);break}}}finally{qu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?la(t):""}function TN(t){switch(t.tag){case 5:return la(t.type);case 16:return la("Lazy");case 13:return la("Suspense");case 19:return la("SuspenseList");case 0:case 2:case 15:return t=Hu(t.type,!1),t;case 11:return t=Hu(t.type.render,!1),t;case 1:return t=Hu(t.type,!0),t;default:return""}}function Rd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case zs:return"Fragment";case $s:return"Portal";case Ad:return"Profiler";case em:return"StrictMode";case kd:return"Suspense";case Pd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case L0:return(t.displayName||"Context")+".Consumer";case O0:return(t._context.displayName||"Context")+".Provider";case tm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case nm:return e=t.displayName||null,e!==null?e:Rd(t.type)||"Memo";case gr:e=t._payload,t=t._init;try{return Rd(t(e))}catch{}}return null}function jN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Rd(e);case 8:return e===em?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Fr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function U0(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function SN(t){var e=U0(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Yo(t){t._valueTracker||(t._valueTracker=SN(t))}function F0(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=U0(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Fl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Dd(t,e){var n=e.checked;return Ue({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Kp(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Fr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function B0(t,e){e=e.checked,e!=null&&Zh(t,"checked",e,!1)}function Md(t,e){B0(t,e);var n=Fr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Od(t,e.type,n):e.hasOwnProperty("defaultValue")&&Od(t,e.type,Fr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Qp(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Od(t,e,n){(e!=="number"||Fl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ca=Array.isArray;function ti(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Fr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Ld(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(J(91));return Ue({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Yp(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(J(92));if(ca(n)){if(1<n.length)throw Error(J(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Fr(n)}}function $0(t,e){var n=Fr(e.value),r=Fr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Xp(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function z0(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?z0(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Xo,q0=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Xo=Xo||document.createElement("div"),Xo.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Xo.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Da(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var xa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},CN=["Webkit","ms","Moz","O"];Object.keys(xa).forEach(function(t){CN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),xa[e]=xa[t]})});function H0(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||xa.hasOwnProperty(t)&&xa[t]?(""+e).trim():e+"px"}function G0(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=H0(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var IN=Ue({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ud(t,e){if(e){if(IN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(J(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(J(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(J(61))}if(e.style!=null&&typeof e.style!="object")throw Error(J(62))}}function Fd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bd=null;function rm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var $d=null,ni=null,ri=null;function Jp(t){if(t=co(t)){if(typeof $d!="function")throw Error(J(280));var e=t.stateNode;e&&(e=Lc(e),$d(t.stateNode,t.type,e))}}function W0(t){ni?ri?ri.push(t):ri=[t]:ni=t}function K0(){if(ni){var t=ni,e=ri;if(ri=ni=null,Jp(t),e)for(t=0;t<e.length;t++)Jp(e[t])}}function Q0(t,e){return t(e)}function Y0(){}var Gu=!1;function X0(t,e,n){if(Gu)return t(e,n);Gu=!0;try{return Q0(t,e,n)}finally{Gu=!1,(ni!==null||ri!==null)&&(Y0(),K0())}}function Ma(t,e){var n=t.stateNode;if(n===null)return null;var r=Lc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(J(231,e,typeof n));return n}var zd=!1;if(Xn)try{var Zi={};Object.defineProperty(Zi,"passive",{get:function(){zd=!0}}),window.addEventListener("test",Zi,Zi),window.removeEventListener("test",Zi,Zi)}catch{zd=!1}function AN(t,e,n,r,s,a,o,c,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(m){this.onError(m)}}var va=!1,Bl=null,$l=!1,qd=null,kN={onError:function(t){va=!0,Bl=t}};function PN(t,e,n,r,s,a,o,c,u){va=!1,Bl=null,AN.apply(kN,arguments)}function RN(t,e,n,r,s,a,o,c,u){if(PN.apply(this,arguments),va){if(va){var d=Bl;va=!1,Bl=null}else throw Error(J(198));$l||($l=!0,qd=d)}}function Ss(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function J0(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Zp(t){if(Ss(t)!==t)throw Error(J(188))}function DN(t){var e=t.alternate;if(!e){if(e=Ss(t),e===null)throw Error(J(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var a=s.alternate;if(a===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===n)return Zp(s),t;if(a===r)return Zp(s),e;a=a.sibling}throw Error(J(188))}if(n.return!==r.return)n=s,r=a;else{for(var o=!1,c=s.child;c;){if(c===n){o=!0,n=s,r=a;break}if(c===r){o=!0,r=s,n=a;break}c=c.sibling}if(!o){for(c=a.child;c;){if(c===n){o=!0,n=a,r=s;break}if(c===r){o=!0,r=a,n=s;break}c=c.sibling}if(!o)throw Error(J(189))}}if(n.alternate!==r)throw Error(J(190))}if(n.tag!==3)throw Error(J(188));return n.stateNode.current===n?t:e}function Z0(t){return t=DN(t),t!==null?ex(t):null}function ex(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=ex(t);if(e!==null)return e;t=t.sibling}return null}var tx=Qt.unstable_scheduleCallback,eg=Qt.unstable_cancelCallback,MN=Qt.unstable_shouldYield,ON=Qt.unstable_requestPaint,We=Qt.unstable_now,LN=Qt.unstable_getCurrentPriorityLevel,sm=Qt.unstable_ImmediatePriority,nx=Qt.unstable_UserBlockingPriority,zl=Qt.unstable_NormalPriority,VN=Qt.unstable_LowPriority,rx=Qt.unstable_IdlePriority,Rc=null,jn=null;function UN(t){if(jn&&typeof jn.onCommitFiberRoot=="function")try{jn.onCommitFiberRoot(Rc,t,void 0,(t.current.flags&128)===128)}catch{}}var gn=Math.clz32?Math.clz32:$N,FN=Math.log,BN=Math.LN2;function $N(t){return t>>>=0,t===0?32:31-(FN(t)/BN|0)|0}var Jo=64,Zo=4194304;function ua(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ql(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,a=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~s;c!==0?r=ua(c):(a&=o,a!==0&&(r=ua(a)))}else o=n&~s,o!==0?r=ua(o):a!==0&&(r=ua(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-gn(e),s=1<<n,r|=t[n],e&=~s;return r}function zN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qN(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-gn(a),c=1<<o,u=s[o];u===-1?(!(c&n)||c&r)&&(s[o]=zN(c,e)):u<=e&&(t.expiredLanes|=c),a&=~c}}function Hd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function sx(){var t=Jo;return Jo<<=1,!(Jo&4194240)&&(Jo=64),t}function Wu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function oo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-gn(e),t[e]=n}function HN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-gn(n),a=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~a}}function im(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-gn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ee=0;function ix(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ax,am,ox,lx,cx,Gd=!1,el=[],Cr=null,Ir=null,Ar=null,Oa=new Map,La=new Map,xr=[],GN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tg(t,e){switch(t){case"focusin":case"focusout":Cr=null;break;case"dragenter":case"dragleave":Ir=null;break;case"mouseover":case"mouseout":Ar=null;break;case"pointerover":case"pointerout":Oa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":La.delete(e.pointerId)}}function ea(t,e,n,r,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[s]},e!==null&&(e=co(e),e!==null&&am(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function WN(t,e,n,r,s){switch(e){case"focusin":return Cr=ea(Cr,t,e,n,r,s),!0;case"dragenter":return Ir=ea(Ir,t,e,n,r,s),!0;case"mouseover":return Ar=ea(Ar,t,e,n,r,s),!0;case"pointerover":var a=s.pointerId;return Oa.set(a,ea(Oa.get(a)||null,t,e,n,r,s)),!0;case"gotpointercapture":return a=s.pointerId,La.set(a,ea(La.get(a)||null,t,e,n,r,s)),!0}return!1}function ux(t){var e=is(t.target);if(e!==null){var n=Ss(e);if(n!==null){if(e=n.tag,e===13){if(e=J0(n),e!==null){t.blockedOn=e,cx(t.priority,function(){ox(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function bl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Wd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Bd=r,n.target.dispatchEvent(r),Bd=null}else return e=co(n),e!==null&&am(e),t.blockedOn=n,!1;e.shift()}return!0}function ng(t,e,n){bl(t)&&n.delete(e)}function KN(){Gd=!1,Cr!==null&&bl(Cr)&&(Cr=null),Ir!==null&&bl(Ir)&&(Ir=null),Ar!==null&&bl(Ar)&&(Ar=null),Oa.forEach(ng),La.forEach(ng)}function ta(t,e){t.blockedOn===e&&(t.blockedOn=null,Gd||(Gd=!0,Qt.unstable_scheduleCallback(Qt.unstable_NormalPriority,KN)))}function Va(t){function e(s){return ta(s,t)}if(0<el.length){ta(el[0],t);for(var n=1;n<el.length;n++){var r=el[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Cr!==null&&ta(Cr,t),Ir!==null&&ta(Ir,t),Ar!==null&&ta(Ar,t),Oa.forEach(e),La.forEach(e),n=0;n<xr.length;n++)r=xr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<xr.length&&(n=xr[0],n.blockedOn===null);)ux(n),n.blockedOn===null&&xr.shift()}var si=lr.ReactCurrentBatchConfig,Hl=!0;function QN(t,e,n,r){var s=Ee,a=si.transition;si.transition=null;try{Ee=1,om(t,e,n,r)}finally{Ee=s,si.transition=a}}function YN(t,e,n,r){var s=Ee,a=si.transition;si.transition=null;try{Ee=4,om(t,e,n,r)}finally{Ee=s,si.transition=a}}function om(t,e,n,r){if(Hl){var s=Wd(t,e,n,r);if(s===null)rd(t,e,r,Gl,n),tg(t,r);else if(WN(s,t,e,n,r))r.stopPropagation();else if(tg(t,r),e&4&&-1<GN.indexOf(t)){for(;s!==null;){var a=co(s);if(a!==null&&ax(a),a=Wd(t,e,n,r),a===null&&rd(t,e,r,Gl,n),a===s)break;s=a}s!==null&&r.stopPropagation()}else rd(t,e,r,null,n)}}var Gl=null;function Wd(t,e,n,r){if(Gl=null,t=rm(r),t=is(t),t!==null)if(e=Ss(t),e===null)t=null;else if(n=e.tag,n===13){if(t=J0(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Gl=t,null}function dx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(LN()){case sm:return 1;case nx:return 4;case zl:case VN:return 16;case rx:return 536870912;default:return 16}default:return 16}}var Tr=null,lm=null,wl=null;function hx(){if(wl)return wl;var t,e=lm,n=e.length,r,s="value"in Tr?Tr.value:Tr.textContent,a=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[a-r];r++);return wl=s.slice(t,1<r?1-r:void 0)}function _l(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function tl(){return!0}function rg(){return!1}function Xt(t){function e(n,r,s,a,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(a):a[c]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?tl:rg,this.isPropagationStopped=rg,this}return Ue(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=tl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=tl)},persist:function(){},isPersistent:tl}),e}var Ai={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cm=Xt(Ai),lo=Ue({},Ai,{view:0,detail:0}),XN=Xt(lo),Ku,Qu,na,Dc=Ue({},lo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:um,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==na&&(na&&t.type==="mousemove"?(Ku=t.screenX-na.screenX,Qu=t.screenY-na.screenY):Qu=Ku=0,na=t),Ku)},movementY:function(t){return"movementY"in t?t.movementY:Qu}}),sg=Xt(Dc),JN=Ue({},Dc,{dataTransfer:0}),ZN=Xt(JN),eE=Ue({},lo,{relatedTarget:0}),Yu=Xt(eE),tE=Ue({},Ai,{animationName:0,elapsedTime:0,pseudoElement:0}),nE=Xt(tE),rE=Ue({},Ai,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),sE=Xt(rE),iE=Ue({},Ai,{data:0}),ig=Xt(iE),aE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=lE[t])?!!e[t]:!1}function um(){return cE}var uE=Ue({},lo,{key:function(t){if(t.key){var e=aE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=_l(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?oE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:um,charCode:function(t){return t.type==="keypress"?_l(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?_l(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),dE=Xt(uE),hE=Ue({},Dc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ag=Xt(hE),mE=Ue({},lo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:um}),fE=Xt(mE),pE=Ue({},Ai,{propertyName:0,elapsedTime:0,pseudoElement:0}),gE=Xt(pE),yE=Ue({},Dc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),xE=Xt(yE),vE=[9,13,27,32],dm=Xn&&"CompositionEvent"in window,ba=null;Xn&&"documentMode"in document&&(ba=document.documentMode);var bE=Xn&&"TextEvent"in window&&!ba,mx=Xn&&(!dm||ba&&8<ba&&11>=ba),og=" ",lg=!1;function fx(t,e){switch(t){case"keyup":return vE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function px(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var qs=!1;function wE(t,e){switch(t){case"compositionend":return px(e);case"keypress":return e.which!==32?null:(lg=!0,og);case"textInput":return t=e.data,t===og&&lg?null:t;default:return null}}function _E(t,e){if(qs)return t==="compositionend"||!dm&&fx(t,e)?(t=hx(),wl=lm=Tr=null,qs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return mx&&e.locale!=="ko"?null:e.data;default:return null}}var NE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!NE[t.type]:e==="textarea"}function gx(t,e,n,r){W0(r),e=Wl(e,"onChange"),0<e.length&&(n=new cm("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var wa=null,Ua=null;function EE(t){Sx(t,0)}function Mc(t){var e=Ws(t);if(F0(e))return t}function TE(t,e){if(t==="change")return e}var yx=!1;if(Xn){var Xu;if(Xn){var Ju="oninput"in document;if(!Ju){var ug=document.createElement("div");ug.setAttribute("oninput","return;"),Ju=typeof ug.oninput=="function"}Xu=Ju}else Xu=!1;yx=Xu&&(!document.documentMode||9<document.documentMode)}function dg(){wa&&(wa.detachEvent("onpropertychange",xx),Ua=wa=null)}function xx(t){if(t.propertyName==="value"&&Mc(Ua)){var e=[];gx(e,Ua,t,rm(t)),X0(EE,e)}}function jE(t,e,n){t==="focusin"?(dg(),wa=e,Ua=n,wa.attachEvent("onpropertychange",xx)):t==="focusout"&&dg()}function SE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Mc(Ua)}function CE(t,e){if(t==="click")return Mc(e)}function IE(t,e){if(t==="input"||t==="change")return Mc(e)}function AE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var xn=typeof Object.is=="function"?Object.is:AE;function Fa(t,e){if(xn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Id.call(e,s)||!xn(t[s],e[s]))return!1}return!0}function hg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function mg(t,e){var n=hg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=hg(n)}}function vx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?vx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function bx(){for(var t=window,e=Fl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Fl(t.document)}return e}function hm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function kE(t){var e=bx(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&vx(n.ownerDocument.documentElement,n)){if(r!==null&&hm(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,a=Math.min(r.start,s);r=r.end===void 0?a:Math.min(r.end,s),!t.extend&&a>r&&(s=r,r=a,a=s),s=mg(n,a);var o=mg(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var PE=Xn&&"documentMode"in document&&11>=document.documentMode,Hs=null,Kd=null,_a=null,Qd=!1;function fg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Qd||Hs==null||Hs!==Fl(r)||(r=Hs,"selectionStart"in r&&hm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),_a&&Fa(_a,r)||(_a=r,r=Wl(Kd,"onSelect"),0<r.length&&(e=new cm("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Hs)))}function nl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Gs={animationend:nl("Animation","AnimationEnd"),animationiteration:nl("Animation","AnimationIteration"),animationstart:nl("Animation","AnimationStart"),transitionend:nl("Transition","TransitionEnd")},Zu={},wx={};Xn&&(wx=document.createElement("div").style,"AnimationEvent"in window||(delete Gs.animationend.animation,delete Gs.animationiteration.animation,delete Gs.animationstart.animation),"TransitionEvent"in window||delete Gs.transitionend.transition);function Oc(t){if(Zu[t])return Zu[t];if(!Gs[t])return t;var e=Gs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in wx)return Zu[t]=e[n];return t}var _x=Oc("animationend"),Nx=Oc("animationiteration"),Ex=Oc("animationstart"),Tx=Oc("transitionend"),jx=new Map,pg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Wr(t,e){jx.set(t,e),js(e,[t])}for(var ed=0;ed<pg.length;ed++){var td=pg[ed],RE=td.toLowerCase(),DE=td[0].toUpperCase()+td.slice(1);Wr(RE,"on"+DE)}Wr(_x,"onAnimationEnd");Wr(Nx,"onAnimationIteration");Wr(Ex,"onAnimationStart");Wr("dblclick","onDoubleClick");Wr("focusin","onFocus");Wr("focusout","onBlur");Wr(Tx,"onTransitionEnd");hi("onMouseEnter",["mouseout","mouseover"]);hi("onMouseLeave",["mouseout","mouseover"]);hi("onPointerEnter",["pointerout","pointerover"]);hi("onPointerLeave",["pointerout","pointerover"]);js("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));js("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));js("onBeforeInput",["compositionend","keypress","textInput","paste"]);js("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));js("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));js("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var da="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ME=new Set("cancel close invalid load scroll toggle".split(" ").concat(da));function gg(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,RN(r,e,void 0,t),t.currentTarget=null}function Sx(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var o=r.length-1;0<=o;o--){var c=r[o],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==a&&s.isPropagationStopped())break e;gg(s,c,d),a=u}else for(o=0;o<r.length;o++){if(c=r[o],u=c.instance,d=c.currentTarget,c=c.listener,u!==a&&s.isPropagationStopped())break e;gg(s,c,d),a=u}}}if($l)throw t=qd,$l=!1,qd=null,t}function Pe(t,e){var n=e[eh];n===void 0&&(n=e[eh]=new Set);var r=t+"__bubble";n.has(r)||(Cx(e,t,2,!1),n.add(r))}function nd(t,e,n){var r=0;e&&(r|=4),Cx(n,t,r,e)}var rl="_reactListening"+Math.random().toString(36).slice(2);function Ba(t){if(!t[rl]){t[rl]=!0,M0.forEach(function(n){n!=="selectionchange"&&(ME.has(n)||nd(n,!1,t),nd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[rl]||(e[rl]=!0,nd("selectionchange",!1,e))}}function Cx(t,e,n,r){switch(dx(e)){case 1:var s=QN;break;case 4:s=YN;break;default:s=om}n=s.bind(null,e,n,t),s=void 0,!zd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function rd(t,e,n,r,s){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;c!==null;){if(o=is(c),o===null)return;if(u=o.tag,u===5||u===6){r=a=o;continue e}c=c.parentNode}}r=r.return}X0(function(){var d=a,m=rm(n),g=[];e:{var y=jx.get(t);if(y!==void 0){var x=cm,S=t;switch(t){case"keypress":if(_l(n)===0)break e;case"keydown":case"keyup":x=dE;break;case"focusin":S="focus",x=Yu;break;case"focusout":S="blur",x=Yu;break;case"beforeblur":case"afterblur":x=Yu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=sg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=ZN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=fE;break;case _x:case Nx:case Ex:x=nE;break;case Tx:x=gE;break;case"scroll":x=XN;break;case"wheel":x=xE;break;case"copy":case"cut":case"paste":x=sE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=ag}var E=(e&4)!==0,P=!E&&t==="scroll",T=E?y!==null?y+"Capture":null:y;E=[];for(var j=d,R;j!==null;){R=j;var M=R.stateNode;if(R.tag===5&&M!==null&&(R=M,T!==null&&(M=Ma(j,T),M!=null&&E.push($a(j,M,R)))),P)break;j=j.return}0<E.length&&(y=new x(y,S,null,n,m),g.push({event:y,listeners:E}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",y&&n!==Bd&&(S=n.relatedTarget||n.fromElement)&&(is(S)||S[Jn]))break e;if((x||y)&&(y=m.window===m?m:(y=m.ownerDocument)?y.defaultView||y.parentWindow:window,x?(S=n.relatedTarget||n.toElement,x=d,S=S?is(S):null,S!==null&&(P=Ss(S),S!==P||S.tag!==5&&S.tag!==6)&&(S=null)):(x=null,S=d),x!==S)){if(E=sg,M="onMouseLeave",T="onMouseEnter",j="mouse",(t==="pointerout"||t==="pointerover")&&(E=ag,M="onPointerLeave",T="onPointerEnter",j="pointer"),P=x==null?y:Ws(x),R=S==null?y:Ws(S),y=new E(M,j+"leave",x,n,m),y.target=P,y.relatedTarget=R,M=null,is(m)===d&&(E=new E(T,j+"enter",S,n,m),E.target=R,E.relatedTarget=P,M=E),P=M,x&&S)t:{for(E=x,T=S,j=0,R=E;R;R=Os(R))j++;for(R=0,M=T;M;M=Os(M))R++;for(;0<j-R;)E=Os(E),j--;for(;0<R-j;)T=Os(T),R--;for(;j--;){if(E===T||T!==null&&E===T.alternate)break t;E=Os(E),T=Os(T)}E=null}else E=null;x!==null&&yg(g,y,x,E,!1),S!==null&&P!==null&&yg(g,P,S,E,!0)}}e:{if(y=d?Ws(d):window,x=y.nodeName&&y.nodeName.toLowerCase(),x==="select"||x==="input"&&y.type==="file")var q=TE;else if(cg(y))if(yx)q=IE;else{q=SE;var z=jE}else(x=y.nodeName)&&x.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(q=CE);if(q&&(q=q(t,d))){gx(g,q,n,m);break e}z&&z(t,y,d),t==="focusout"&&(z=y._wrapperState)&&z.controlled&&y.type==="number"&&Od(y,"number",y.value)}switch(z=d?Ws(d):window,t){case"focusin":(cg(z)||z.contentEditable==="true")&&(Hs=z,Kd=d,_a=null);break;case"focusout":_a=Kd=Hs=null;break;case"mousedown":Qd=!0;break;case"contextmenu":case"mouseup":case"dragend":Qd=!1,fg(g,n,m);break;case"selectionchange":if(PE)break;case"keydown":case"keyup":fg(g,n,m)}var I;if(dm)e:{switch(t){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else qs?fx(t,n)&&(b="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(b="onCompositionStart");b&&(mx&&n.locale!=="ko"&&(qs||b!=="onCompositionStart"?b==="onCompositionEnd"&&qs&&(I=hx()):(Tr=m,lm="value"in Tr?Tr.value:Tr.textContent,qs=!0)),z=Wl(d,b),0<z.length&&(b=new ig(b,t,null,n,m),g.push({event:b,listeners:z}),I?b.data=I:(I=px(n),I!==null&&(b.data=I)))),(I=bE?wE(t,n):_E(t,n))&&(d=Wl(d,"onBeforeInput"),0<d.length&&(m=new ig("onBeforeInput","beforeinput",null,n,m),g.push({event:m,listeners:d}),m.data=I))}Sx(g,e)})}function $a(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Wl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Ma(t,n),a!=null&&r.unshift($a(t,a,s)),a=Ma(t,e),a!=null&&r.push($a(t,a,s))),t=t.return}return r}function Os(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function yg(t,e,n,r,s){for(var a=e._reactName,o=[];n!==null&&n!==r;){var c=n,u=c.alternate,d=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&d!==null&&(c=d,s?(u=Ma(n,a),u!=null&&o.unshift($a(n,u,c))):s||(u=Ma(n,a),u!=null&&o.push($a(n,u,c)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var OE=/\r\n?/g,LE=/\u0000|\uFFFD/g;function xg(t){return(typeof t=="string"?t:""+t).replace(OE,`
`).replace(LE,"")}function sl(t,e,n){if(e=xg(e),xg(t)!==e&&n)throw Error(J(425))}function Kl(){}var Yd=null,Xd=null;function Jd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Zd=typeof setTimeout=="function"?setTimeout:void 0,VE=typeof clearTimeout=="function"?clearTimeout:void 0,vg=typeof Promise=="function"?Promise:void 0,UE=typeof queueMicrotask=="function"?queueMicrotask:typeof vg<"u"?function(t){return vg.resolve(null).then(t).catch(FE)}:Zd;function FE(t){setTimeout(function(){throw t})}function sd(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Va(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Va(e)}function kr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function bg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ki=Math.random().toString(36).slice(2),Nn="__reactFiber$"+ki,za="__reactProps$"+ki,Jn="__reactContainer$"+ki,eh="__reactEvents$"+ki,BE="__reactListeners$"+ki,$E="__reactHandles$"+ki;function is(t){var e=t[Nn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Jn]||n[Nn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=bg(t);t!==null;){if(n=t[Nn])return n;t=bg(t)}return e}t=n,n=t.parentNode}return null}function co(t){return t=t[Nn]||t[Jn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ws(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(J(33))}function Lc(t){return t[za]||null}var th=[],Ks=-1;function Kr(t){return{current:t}}function De(t){0>Ks||(t.current=th[Ks],th[Ks]=null,Ks--)}function Ie(t,e){Ks++,th[Ks]=t.current,t.current=e}var Br={},Et=Kr(Br),Vt=Kr(!1),ps=Br;function mi(t,e){var n=t.type.contextTypes;if(!n)return Br;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in n)s[a]=e[a];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ut(t){return t=t.childContextTypes,t!=null}function Ql(){De(Vt),De(Et)}function wg(t,e,n){if(Et.current!==Br)throw Error(J(168));Ie(Et,e),Ie(Vt,n)}function Ix(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(J(108,jN(t)||"Unknown",s));return Ue({},n,r)}function Yl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Br,ps=Et.current,Ie(Et,t),Ie(Vt,Vt.current),!0}function _g(t,e,n){var r=t.stateNode;if(!r)throw Error(J(169));n?(t=Ix(t,e,ps),r.__reactInternalMemoizedMergedChildContext=t,De(Vt),De(Et),Ie(Et,t)):De(Vt),Ie(Vt,n)}var Bn=null,Vc=!1,id=!1;function Ax(t){Bn===null?Bn=[t]:Bn.push(t)}function zE(t){Vc=!0,Ax(t)}function Qr(){if(!id&&Bn!==null){id=!0;var t=0,e=Ee;try{var n=Bn;for(Ee=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Bn=null,Vc=!1}catch(s){throw Bn!==null&&(Bn=Bn.slice(t+1)),tx(sm,Qr),s}finally{Ee=e,id=!1}}return null}var Qs=[],Ys=0,Xl=null,Jl=0,Jt=[],Zt=0,gs=null,$n=1,zn="";function ns(t,e){Qs[Ys++]=Jl,Qs[Ys++]=Xl,Xl=t,Jl=e}function kx(t,e,n){Jt[Zt++]=$n,Jt[Zt++]=zn,Jt[Zt++]=gs,gs=t;var r=$n;t=zn;var s=32-gn(r)-1;r&=~(1<<s),n+=1;var a=32-gn(e)+s;if(30<a){var o=s-s%5;a=(r&(1<<o)-1).toString(32),r>>=o,s-=o,$n=1<<32-gn(e)+s|n<<s|r,zn=a+t}else $n=1<<a|n<<s|r,zn=t}function mm(t){t.return!==null&&(ns(t,1),kx(t,1,0))}function fm(t){for(;t===Xl;)Xl=Qs[--Ys],Qs[Ys]=null,Jl=Qs[--Ys],Qs[Ys]=null;for(;t===gs;)gs=Jt[--Zt],Jt[Zt]=null,zn=Jt[--Zt],Jt[Zt]=null,$n=Jt[--Zt],Jt[Zt]=null}var Kt=null,Ht=null,Oe=!1,pn=null;function Px(t,e){var n=tn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ng(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Kt=t,Ht=kr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Kt=t,Ht=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=gs!==null?{id:$n,overflow:zn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=tn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Kt=t,Ht=null,!0):!1;default:return!1}}function nh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function rh(t){if(Oe){var e=Ht;if(e){var n=e;if(!Ng(t,e)){if(nh(t))throw Error(J(418));e=kr(n.nextSibling);var r=Kt;e&&Ng(t,e)?Px(r,n):(t.flags=t.flags&-4097|2,Oe=!1,Kt=t)}}else{if(nh(t))throw Error(J(418));t.flags=t.flags&-4097|2,Oe=!1,Kt=t}}}function Eg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Kt=t}function il(t){if(t!==Kt)return!1;if(!Oe)return Eg(t),Oe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Jd(t.type,t.memoizedProps)),e&&(e=Ht)){if(nh(t))throw Rx(),Error(J(418));for(;e;)Px(t,e),e=kr(e.nextSibling)}if(Eg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(J(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ht=kr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ht=null}}else Ht=Kt?kr(t.stateNode.nextSibling):null;return!0}function Rx(){for(var t=Ht;t;)t=kr(t.nextSibling)}function fi(){Ht=Kt=null,Oe=!1}function pm(t){pn===null?pn=[t]:pn.push(t)}var qE=lr.ReactCurrentBatchConfig;function ra(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(J(309));var r=n.stateNode}if(!r)throw Error(J(147,t));var s=r,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var c=s.refs;o===null?delete c[a]:c[a]=o},e._stringRef=a,e)}if(typeof t!="string")throw Error(J(284));if(!n._owner)throw Error(J(290,t))}return t}function al(t,e){throw t=Object.prototype.toString.call(e),Error(J(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Tg(t){var e=t._init;return e(t._payload)}function Dx(t){function e(T,j){if(t){var R=T.deletions;R===null?(T.deletions=[j],T.flags|=16):R.push(j)}}function n(T,j){if(!t)return null;for(;j!==null;)e(T,j),j=j.sibling;return null}function r(T,j){for(T=new Map;j!==null;)j.key!==null?T.set(j.key,j):T.set(j.index,j),j=j.sibling;return T}function s(T,j){return T=Mr(T,j),T.index=0,T.sibling=null,T}function a(T,j,R){return T.index=R,t?(R=T.alternate,R!==null?(R=R.index,R<j?(T.flags|=2,j):R):(T.flags|=2,j)):(T.flags|=1048576,j)}function o(T){return t&&T.alternate===null&&(T.flags|=2),T}function c(T,j,R,M){return j===null||j.tag!==6?(j=hd(R,T.mode,M),j.return=T,j):(j=s(j,R),j.return=T,j)}function u(T,j,R,M){var q=R.type;return q===zs?m(T,j,R.props.children,M,R.key):j!==null&&(j.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===gr&&Tg(q)===j.type)?(M=s(j,R.props),M.ref=ra(T,j,R),M.return=T,M):(M=Il(R.type,R.key,R.props,null,T.mode,M),M.ref=ra(T,j,R),M.return=T,M)}function d(T,j,R,M){return j===null||j.tag!==4||j.stateNode.containerInfo!==R.containerInfo||j.stateNode.implementation!==R.implementation?(j=md(R,T.mode,M),j.return=T,j):(j=s(j,R.children||[]),j.return=T,j)}function m(T,j,R,M,q){return j===null||j.tag!==7?(j=ds(R,T.mode,M,q),j.return=T,j):(j=s(j,R),j.return=T,j)}function g(T,j,R){if(typeof j=="string"&&j!==""||typeof j=="number")return j=hd(""+j,T.mode,R),j.return=T,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Qo:return R=Il(j.type,j.key,j.props,null,T.mode,R),R.ref=ra(T,null,j),R.return=T,R;case $s:return j=md(j,T.mode,R),j.return=T,j;case gr:var M=j._init;return g(T,M(j._payload),R)}if(ca(j)||Ji(j))return j=ds(j,T.mode,R,null),j.return=T,j;al(T,j)}return null}function y(T,j,R,M){var q=j!==null?j.key:null;if(typeof R=="string"&&R!==""||typeof R=="number")return q!==null?null:c(T,j,""+R,M);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Qo:return R.key===q?u(T,j,R,M):null;case $s:return R.key===q?d(T,j,R,M):null;case gr:return q=R._init,y(T,j,q(R._payload),M)}if(ca(R)||Ji(R))return q!==null?null:m(T,j,R,M,null);al(T,R)}return null}function x(T,j,R,M,q){if(typeof M=="string"&&M!==""||typeof M=="number")return T=T.get(R)||null,c(j,T,""+M,q);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case Qo:return T=T.get(M.key===null?R:M.key)||null,u(j,T,M,q);case $s:return T=T.get(M.key===null?R:M.key)||null,d(j,T,M,q);case gr:var z=M._init;return x(T,j,R,z(M._payload),q)}if(ca(M)||Ji(M))return T=T.get(R)||null,m(j,T,M,q,null);al(j,M)}return null}function S(T,j,R,M){for(var q=null,z=null,I=j,b=j=0,C=null;I!==null&&b<R.length;b++){I.index>b?(C=I,I=null):C=I.sibling;var p=y(T,I,R[b],M);if(p===null){I===null&&(I=C);break}t&&I&&p.alternate===null&&e(T,I),j=a(p,j,b),z===null?q=p:z.sibling=p,z=p,I=C}if(b===R.length)return n(T,I),Oe&&ns(T,b),q;if(I===null){for(;b<R.length;b++)I=g(T,R[b],M),I!==null&&(j=a(I,j,b),z===null?q=I:z.sibling=I,z=I);return Oe&&ns(T,b),q}for(I=r(T,I);b<R.length;b++)C=x(I,T,b,R[b],M),C!==null&&(t&&C.alternate!==null&&I.delete(C.key===null?b:C.key),j=a(C,j,b),z===null?q=C:z.sibling=C,z=C);return t&&I.forEach(function(k){return e(T,k)}),Oe&&ns(T,b),q}function E(T,j,R,M){var q=Ji(R);if(typeof q!="function")throw Error(J(150));if(R=q.call(R),R==null)throw Error(J(151));for(var z=q=null,I=j,b=j=0,C=null,p=R.next();I!==null&&!p.done;b++,p=R.next()){I.index>b?(C=I,I=null):C=I.sibling;var k=y(T,I,p.value,M);if(k===null){I===null&&(I=C);break}t&&I&&k.alternate===null&&e(T,I),j=a(k,j,b),z===null?q=k:z.sibling=k,z=k,I=C}if(p.done)return n(T,I),Oe&&ns(T,b),q;if(I===null){for(;!p.done;b++,p=R.next())p=g(T,p.value,M),p!==null&&(j=a(p,j,b),z===null?q=p:z.sibling=p,z=p);return Oe&&ns(T,b),q}for(I=r(T,I);!p.done;b++,p=R.next())p=x(I,T,b,p.value,M),p!==null&&(t&&p.alternate!==null&&I.delete(p.key===null?b:p.key),j=a(p,j,b),z===null?q=p:z.sibling=p,z=p);return t&&I.forEach(function(w){return e(T,w)}),Oe&&ns(T,b),q}function P(T,j,R,M){if(typeof R=="object"&&R!==null&&R.type===zs&&R.key===null&&(R=R.props.children),typeof R=="object"&&R!==null){switch(R.$$typeof){case Qo:e:{for(var q=R.key,z=j;z!==null;){if(z.key===q){if(q=R.type,q===zs){if(z.tag===7){n(T,z.sibling),j=s(z,R.props.children),j.return=T,T=j;break e}}else if(z.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===gr&&Tg(q)===z.type){n(T,z.sibling),j=s(z,R.props),j.ref=ra(T,z,R),j.return=T,T=j;break e}n(T,z);break}else e(T,z);z=z.sibling}R.type===zs?(j=ds(R.props.children,T.mode,M,R.key),j.return=T,T=j):(M=Il(R.type,R.key,R.props,null,T.mode,M),M.ref=ra(T,j,R),M.return=T,T=M)}return o(T);case $s:e:{for(z=R.key;j!==null;){if(j.key===z)if(j.tag===4&&j.stateNode.containerInfo===R.containerInfo&&j.stateNode.implementation===R.implementation){n(T,j.sibling),j=s(j,R.children||[]),j.return=T,T=j;break e}else{n(T,j);break}else e(T,j);j=j.sibling}j=md(R,T.mode,M),j.return=T,T=j}return o(T);case gr:return z=R._init,P(T,j,z(R._payload),M)}if(ca(R))return S(T,j,R,M);if(Ji(R))return E(T,j,R,M);al(T,R)}return typeof R=="string"&&R!==""||typeof R=="number"?(R=""+R,j!==null&&j.tag===6?(n(T,j.sibling),j=s(j,R),j.return=T,T=j):(n(T,j),j=hd(R,T.mode,M),j.return=T,T=j),o(T)):n(T,j)}return P}var pi=Dx(!0),Mx=Dx(!1),Zl=Kr(null),ec=null,Xs=null,gm=null;function ym(){gm=Xs=ec=null}function xm(t){var e=Zl.current;De(Zl),t._currentValue=e}function sh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ii(t,e){ec=t,gm=Xs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Lt=!0),t.firstContext=null)}function an(t){var e=t._currentValue;if(gm!==t)if(t={context:t,memoizedValue:e,next:null},Xs===null){if(ec===null)throw Error(J(308));Xs=t,ec.dependencies={lanes:0,firstContext:t}}else Xs=Xs.next=t;return e}var as=null;function vm(t){as===null?as=[t]:as.push(t)}function Ox(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,vm(e)):(n.next=s.next,s.next=n),e.interleaved=n,Zn(t,r)}function Zn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var yr=!1;function bm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lx(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Wn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Pr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ve&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Zn(t,n)}return s=r.interleaved,s===null?(e.next=e,vm(r)):(e.next=s.next,s.next=e),r.interleaved=e,Zn(t,n)}function Nl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,im(t,n)}}function jg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?s=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?s=a=e:a=a.next=e}else s=a=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function tc(t,e,n,r){var s=t.updateQueue;yr=!1;var a=s.firstBaseUpdate,o=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,d=u.next;u.next=null,o===null?a=d:o.next=d,o=u;var m=t.alternate;m!==null&&(m=m.updateQueue,c=m.lastBaseUpdate,c!==o&&(c===null?m.firstBaseUpdate=d:c.next=d,m.lastBaseUpdate=u))}if(a!==null){var g=s.baseState;o=0,m=d=u=null,c=a;do{var y=c.lane,x=c.eventTime;if((r&y)===y){m!==null&&(m=m.next={eventTime:x,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var S=t,E=c;switch(y=e,x=n,E.tag){case 1:if(S=E.payload,typeof S=="function"){g=S.call(x,g,y);break e}g=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=E.payload,y=typeof S=="function"?S.call(x,g,y):S,y==null)break e;g=Ue({},g,y);break e;case 2:yr=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,y=s.effects,y===null?s.effects=[c]:y.push(c))}else x={eventTime:x,lane:y,tag:c.tag,payload:c.payload,callback:c.callback,next:null},m===null?(d=m=x,u=g):m=m.next=x,o|=y;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;y=c,c=y.next,y.next=null,s.lastBaseUpdate=y,s.shared.pending=null}}while(!0);if(m===null&&(u=g),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=m,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);xs|=o,t.lanes=o,t.memoizedState=g}}function Sg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(J(191,s));s.call(r)}}}var uo={},Sn=Kr(uo),qa=Kr(uo),Ha=Kr(uo);function os(t){if(t===uo)throw Error(J(174));return t}function wm(t,e){switch(Ie(Ha,e),Ie(qa,t),Ie(Sn,uo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Vd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Vd(e,t)}De(Sn),Ie(Sn,e)}function gi(){De(Sn),De(qa),De(Ha)}function Vx(t){os(Ha.current);var e=os(Sn.current),n=Vd(e,t.type);e!==n&&(Ie(qa,t),Ie(Sn,n))}function _m(t){qa.current===t&&(De(Sn),De(qa))}var Le=Kr(0);function nc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ad=[];function Nm(){for(var t=0;t<ad.length;t++)ad[t]._workInProgressVersionPrimary=null;ad.length=0}var El=lr.ReactCurrentDispatcher,od=lr.ReactCurrentBatchConfig,ys=0,Ve=null,Je=null,nt=null,rc=!1,Na=!1,Ga=0,HE=0;function yt(){throw Error(J(321))}function Em(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!xn(t[n],e[n]))return!1;return!0}function Tm(t,e,n,r,s,a){if(ys=a,Ve=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,El.current=t===null||t.memoizedState===null?QE:YE,t=n(r,s),Na){a=0;do{if(Na=!1,Ga=0,25<=a)throw Error(J(301));a+=1,nt=Je=null,e.updateQueue=null,El.current=XE,t=n(r,s)}while(Na)}if(El.current=sc,e=Je!==null&&Je.next!==null,ys=0,nt=Je=Ve=null,rc=!1,e)throw Error(J(300));return t}function jm(){var t=Ga!==0;return Ga=0,t}function _n(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return nt===null?Ve.memoizedState=nt=t:nt=nt.next=t,nt}function on(){if(Je===null){var t=Ve.alternate;t=t!==null?t.memoizedState:null}else t=Je.next;var e=nt===null?Ve.memoizedState:nt.next;if(e!==null)nt=e,Je=t;else{if(t===null)throw Error(J(310));Je=t,t={memoizedState:Je.memoizedState,baseState:Je.baseState,baseQueue:Je.baseQueue,queue:Je.queue,next:null},nt===null?Ve.memoizedState=nt=t:nt=nt.next=t}return nt}function Wa(t,e){return typeof e=="function"?e(t):e}function ld(t){var e=on(),n=e.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=t;var r=Je,s=r.baseQueue,a=n.pending;if(a!==null){if(s!==null){var o=s.next;s.next=a.next,a.next=o}r.baseQueue=s=a,n.pending=null}if(s!==null){a=s.next,r=r.baseState;var c=o=null,u=null,d=a;do{var m=d.lane;if((ys&m)===m)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var g={lane:m,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=g,o=r):u=u.next=g,Ve.lanes|=m,xs|=m}d=d.next}while(d!==null&&d!==a);u===null?o=r:u.next=c,xn(r,e.memoizedState)||(Lt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do a=s.lane,Ve.lanes|=a,xs|=a,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function cd(t){var e=on(),n=e.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,a=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do a=t(a,o.action),o=o.next;while(o!==s);xn(a,e.memoizedState)||(Lt=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,r]}function Ux(){}function Fx(t,e){var n=Ve,r=on(),s=e(),a=!xn(r.memoizedState,s);if(a&&(r.memoizedState=s,Lt=!0),r=r.queue,Sm(zx.bind(null,n,r,t),[t]),r.getSnapshot!==e||a||nt!==null&&nt.memoizedState.tag&1){if(n.flags|=2048,Ka(9,$x.bind(null,n,r,s,e),void 0,null),st===null)throw Error(J(349));ys&30||Bx(n,e,s)}return s}function Bx(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ve.updateQueue,e===null?(e={lastEffect:null,stores:null},Ve.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function $x(t,e,n,r){e.value=n,e.getSnapshot=r,qx(e)&&Hx(t)}function zx(t,e,n){return n(function(){qx(e)&&Hx(t)})}function qx(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!xn(t,n)}catch{return!0}}function Hx(t){var e=Zn(t,1);e!==null&&yn(e,t,1,-1)}function Cg(t){var e=_n();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wa,lastRenderedState:t},e.queue=t,t=t.dispatch=KE.bind(null,Ve,t),[e.memoizedState,t]}function Ka(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ve.updateQueue,e===null?(e={lastEffect:null,stores:null},Ve.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Gx(){return on().memoizedState}function Tl(t,e,n,r){var s=_n();Ve.flags|=t,s.memoizedState=Ka(1|e,n,void 0,r===void 0?null:r)}function Uc(t,e,n,r){var s=on();r=r===void 0?null:r;var a=void 0;if(Je!==null){var o=Je.memoizedState;if(a=o.destroy,r!==null&&Em(r,o.deps)){s.memoizedState=Ka(e,n,a,r);return}}Ve.flags|=t,s.memoizedState=Ka(1|e,n,a,r)}function Ig(t,e){return Tl(8390656,8,t,e)}function Sm(t,e){return Uc(2048,8,t,e)}function Wx(t,e){return Uc(4,2,t,e)}function Kx(t,e){return Uc(4,4,t,e)}function Qx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Yx(t,e,n){return n=n!=null?n.concat([t]):null,Uc(4,4,Qx.bind(null,e,t),n)}function Cm(){}function Xx(t,e){var n=on();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Em(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Jx(t,e){var n=on();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Em(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Zx(t,e,n){return ys&21?(xn(n,e)||(n=sx(),Ve.lanes|=n,xs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Lt=!0),t.memoizedState=n)}function GE(t,e){var n=Ee;Ee=n!==0&&4>n?n:4,t(!0);var r=od.transition;od.transition={};try{t(!1),e()}finally{Ee=n,od.transition=r}}function ev(){return on().memoizedState}function WE(t,e,n){var r=Dr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},tv(t))nv(e,n);else if(n=Ox(t,e,n,r),n!==null){var s=At();yn(n,t,r,s),rv(n,e,r)}}function KE(t,e,n){var r=Dr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(tv(t))nv(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,c=a(o,n);if(s.hasEagerState=!0,s.eagerState=c,xn(c,o)){var u=e.interleaved;u===null?(s.next=s,vm(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=Ox(t,e,s,r),n!==null&&(s=At(),yn(n,t,r,s),rv(n,e,r))}}function tv(t){var e=t.alternate;return t===Ve||e!==null&&e===Ve}function nv(t,e){Na=rc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function rv(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,im(t,n)}}var sc={readContext:an,useCallback:yt,useContext:yt,useEffect:yt,useImperativeHandle:yt,useInsertionEffect:yt,useLayoutEffect:yt,useMemo:yt,useReducer:yt,useRef:yt,useState:yt,useDebugValue:yt,useDeferredValue:yt,useTransition:yt,useMutableSource:yt,useSyncExternalStore:yt,useId:yt,unstable_isNewReconciler:!1},QE={readContext:an,useCallback:function(t,e){return _n().memoizedState=[t,e===void 0?null:e],t},useContext:an,useEffect:Ig,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Tl(4194308,4,Qx.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Tl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Tl(4,2,t,e)},useMemo:function(t,e){var n=_n();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=_n();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=WE.bind(null,Ve,t),[r.memoizedState,t]},useRef:function(t){var e=_n();return t={current:t},e.memoizedState=t},useState:Cg,useDebugValue:Cm,useDeferredValue:function(t){return _n().memoizedState=t},useTransition:function(){var t=Cg(!1),e=t[0];return t=GE.bind(null,t[1]),_n().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ve,s=_n();if(Oe){if(n===void 0)throw Error(J(407));n=n()}else{if(n=e(),st===null)throw Error(J(349));ys&30||Bx(r,e,n)}s.memoizedState=n;var a={value:n,getSnapshot:e};return s.queue=a,Ig(zx.bind(null,r,a,t),[t]),r.flags|=2048,Ka(9,$x.bind(null,r,a,n,e),void 0,null),n},useId:function(){var t=_n(),e=st.identifierPrefix;if(Oe){var n=zn,r=$n;n=(r&~(1<<32-gn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ga++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=HE++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},YE={readContext:an,useCallback:Xx,useContext:an,useEffect:Sm,useImperativeHandle:Yx,useInsertionEffect:Wx,useLayoutEffect:Kx,useMemo:Jx,useReducer:ld,useRef:Gx,useState:function(){return ld(Wa)},useDebugValue:Cm,useDeferredValue:function(t){var e=on();return Zx(e,Je.memoizedState,t)},useTransition:function(){var t=ld(Wa)[0],e=on().memoizedState;return[t,e]},useMutableSource:Ux,useSyncExternalStore:Fx,useId:ev,unstable_isNewReconciler:!1},XE={readContext:an,useCallback:Xx,useContext:an,useEffect:Sm,useImperativeHandle:Yx,useInsertionEffect:Wx,useLayoutEffect:Kx,useMemo:Jx,useReducer:cd,useRef:Gx,useState:function(){return cd(Wa)},useDebugValue:Cm,useDeferredValue:function(t){var e=on();return Je===null?e.memoizedState=t:Zx(e,Je.memoizedState,t)},useTransition:function(){var t=cd(Wa)[0],e=on().memoizedState;return[t,e]},useMutableSource:Ux,useSyncExternalStore:Fx,useId:ev,unstable_isNewReconciler:!1};function mn(t,e){if(t&&t.defaultProps){e=Ue({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ih(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ue({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Fc={isMounted:function(t){return(t=t._reactInternals)?Ss(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=At(),s=Dr(t),a=Wn(r,s);a.payload=e,n!=null&&(a.callback=n),e=Pr(t,a,s),e!==null&&(yn(e,t,s,r),Nl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=At(),s=Dr(t),a=Wn(r,s);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=Pr(t,a,s),e!==null&&(yn(e,t,s,r),Nl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=At(),r=Dr(t),s=Wn(n,r);s.tag=2,e!=null&&(s.callback=e),e=Pr(t,s,r),e!==null&&(yn(e,t,r,n),Nl(e,t,r))}};function Ag(t,e,n,r,s,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,a,o):e.prototype&&e.prototype.isPureReactComponent?!Fa(n,r)||!Fa(s,a):!0}function sv(t,e,n){var r=!1,s=Br,a=e.contextType;return typeof a=="object"&&a!==null?a=an(a):(s=Ut(e)?ps:Et.current,r=e.contextTypes,a=(r=r!=null)?mi(t,s):Br),e=new e(n,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Fc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function kg(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Fc.enqueueReplaceState(e,e.state,null)}function ah(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},bm(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=an(a):(a=Ut(e)?ps:Et.current,s.context=mi(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(ih(t,e,a,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Fc.enqueueReplaceState(s,s.state,null),tc(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function yi(t,e){try{var n="",r=e;do n+=TN(r),r=r.return;while(r);var s=n}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function ud(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function oh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var JE=typeof WeakMap=="function"?WeakMap:Map;function iv(t,e,n){n=Wn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ac||(ac=!0,yh=r),oh(t,e)},n}function av(t,e,n){n=Wn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){oh(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){oh(t,e),typeof r!="function"&&(Rr===null?Rr=new Set([this]):Rr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Pg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new JE;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=hT.bind(null,t,e,n),e.then(t,t))}function Rg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Dg(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Wn(-1,1),e.tag=2,Pr(n,e,1))),n.lanes|=1),t)}var ZE=lr.ReactCurrentOwner,Lt=!1;function It(t,e,n,r){e.child=t===null?Mx(e,null,n,r):pi(e,t.child,n,r)}function Mg(t,e,n,r,s){n=n.render;var a=e.ref;return ii(e,s),r=Tm(t,e,n,r,a,s),n=jm(),t!==null&&!Lt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,er(t,e,s)):(Oe&&n&&mm(e),e.flags|=1,It(t,e,r,s),e.child)}function Og(t,e,n,r,s){if(t===null){var a=n.type;return typeof a=="function"&&!Om(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,ov(t,e,a,r,s)):(t=Il(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:Fa,n(o,r)&&t.ref===e.ref)return er(t,e,s)}return e.flags|=1,t=Mr(a,r),t.ref=e.ref,t.return=e,e.child=t}function ov(t,e,n,r,s){if(t!==null){var a=t.memoizedProps;if(Fa(a,r)&&t.ref===e.ref)if(Lt=!1,e.pendingProps=r=a,(t.lanes&s)!==0)t.flags&131072&&(Lt=!0);else return e.lanes=t.lanes,er(t,e,s)}return lh(t,e,n,r,s)}function lv(t,e,n){var r=e.pendingProps,s=r.children,a=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ie(Zs,qt),qt|=n;else{if(!(n&1073741824))return t=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ie(Zs,qt),qt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,Ie(Zs,qt),qt|=r}else a!==null?(r=a.baseLanes|n,e.memoizedState=null):r=n,Ie(Zs,qt),qt|=r;return It(t,e,s,n),e.child}function cv(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function lh(t,e,n,r,s){var a=Ut(n)?ps:Et.current;return a=mi(e,a),ii(e,s),n=Tm(t,e,n,r,a,s),r=jm(),t!==null&&!Lt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,er(t,e,s)):(Oe&&r&&mm(e),e.flags|=1,It(t,e,n,s),e.child)}function Lg(t,e,n,r,s){if(Ut(n)){var a=!0;Yl(e)}else a=!1;if(ii(e,s),e.stateNode===null)jl(t,e),sv(e,n,r),ah(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=an(d):(d=Ut(n)?ps:Et.current,d=mi(e,d));var m=n.getDerivedStateFromProps,g=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function";g||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||u!==d)&&kg(e,o,r,d),yr=!1;var y=e.memoizedState;o.state=y,tc(e,r,o,s),u=e.memoizedState,c!==r||y!==u||Vt.current||yr?(typeof m=="function"&&(ih(e,n,m,r),u=e.memoizedState),(c=yr||Ag(e,n,c,r,y,u,d))?(g||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Lx(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:mn(e.type,c),o.props=d,g=e.pendingProps,y=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=an(u):(u=Ut(n)?ps:Et.current,u=mi(e,u));var x=n.getDerivedStateFromProps;(m=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==g||y!==u)&&kg(e,o,r,u),yr=!1,y=e.memoizedState,o.state=y,tc(e,r,o,s);var S=e.memoizedState;c!==g||y!==S||Vt.current||yr?(typeof x=="function"&&(ih(e,n,x,r),S=e.memoizedState),(d=yr||Ag(e,n,d,r,y,S,u)||!1)?(m||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,S,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,S,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=S),o.props=r,o.state=S,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),r=!1)}return ch(t,e,n,r,a,s)}function ch(t,e,n,r,s,a){cv(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&_g(e,n,!1),er(t,e,a);r=e.stateNode,ZE.current=e;var c=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=pi(e,t.child,null,a),e.child=pi(e,null,c,a)):It(t,e,c,a),e.memoizedState=r.state,s&&_g(e,n,!0),e.child}function uv(t){var e=t.stateNode;e.pendingContext?wg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&wg(t,e.context,!1),wm(t,e.containerInfo)}function Vg(t,e,n,r,s){return fi(),pm(s),e.flags|=256,It(t,e,n,r),e.child}var uh={dehydrated:null,treeContext:null,retryLane:0};function dh(t){return{baseLanes:t,cachePool:null,transitions:null}}function dv(t,e,n){var r=e.pendingProps,s=Le.current,a=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ie(Le,s&1),t===null)return rh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,a?(r=e.mode,a=e.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=zc(o,r,0,null),t=ds(t,r,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=dh(n),e.memoizedState=uh,t):Im(e,o));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return eT(t,e,o,r,c,s,n);if(a){a=r.fallback,o=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Mr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?a=Mr(c,a):(a=ds(a,o,n,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,o=t.child.memoizedState,o=o===null?dh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=t.childLanes&~n,e.memoizedState=uh,r}return a=t.child,t=a.sibling,r=Mr(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Im(t,e){return e=zc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ol(t,e,n,r){return r!==null&&pm(r),pi(e,t.child,null,n),t=Im(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function eT(t,e,n,r,s,a,o){if(n)return e.flags&256?(e.flags&=-257,r=ud(Error(J(422))),ol(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=r.fallback,s=e.mode,r=zc({mode:"visible",children:r.children},s,0,null),a=ds(a,s,o,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&pi(e,t.child,null,o),e.child.memoizedState=dh(o),e.memoizedState=uh,a);if(!(e.mode&1))return ol(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,a=Error(J(419)),r=ud(a,r,void 0),ol(t,e,o,r)}if(c=(o&t.childLanes)!==0,Lt||c){if(r=st,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Zn(t,s),yn(r,t,s,-1))}return Mm(),r=ud(Error(J(421))),ol(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=mT.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,Ht=kr(s.nextSibling),Kt=e,Oe=!0,pn=null,t!==null&&(Jt[Zt++]=$n,Jt[Zt++]=zn,Jt[Zt++]=gs,$n=t.id,zn=t.overflow,gs=e),e=Im(e,r.children),e.flags|=4096,e)}function Ug(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),sh(t.return,e,n)}function dd(t,e,n,r,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=s)}function hv(t,e,n){var r=e.pendingProps,s=r.revealOrder,a=r.tail;if(It(t,e,r.children,n),r=Le.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ug(t,n,e);else if(t.tag===19)Ug(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ie(Le,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&nc(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),dd(e,!1,s,n,a);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&nc(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}dd(e,!0,n,null,a);break;case"together":dd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function jl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function er(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),xs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(J(153));if(e.child!==null){for(t=e.child,n=Mr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Mr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function tT(t,e,n){switch(e.tag){case 3:uv(e),fi();break;case 5:Vx(e);break;case 1:Ut(e.type)&&Yl(e);break;case 4:wm(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ie(Zl,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ie(Le,Le.current&1),e.flags|=128,null):n&e.child.childLanes?dv(t,e,n):(Ie(Le,Le.current&1),t=er(t,e,n),t!==null?t.sibling:null);Ie(Le,Le.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return hv(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ie(Le,Le.current),r)break;return null;case 22:case 23:return e.lanes=0,lv(t,e,n)}return er(t,e,n)}var mv,hh,fv,pv;mv=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};hh=function(){};fv=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,os(Sn.current);var a=null;switch(n){case"input":s=Dd(t,s),r=Dd(t,r),a=[];break;case"select":s=Ue({},s,{value:void 0}),r=Ue({},r,{value:void 0}),a=[];break;case"textarea":s=Ld(t,s),r=Ld(t,r),a=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Kl)}Ud(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ra.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in r){var u=r[d];if(c=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(o in c)!c.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&c[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(a||(a=[]),a.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(a=a||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ra.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Pe("scroll",t),a||c===u||(a=[])):(a=a||[]).push(d,u))}n&&(a=a||[]).push("style",n);var d=a;(e.updateQueue=d)&&(e.flags|=4)}};pv=function(t,e,n,r){n!==r&&(e.flags|=4)};function sa(t,e){if(!Oe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function xt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function nT(t,e,n){var r=e.pendingProps;switch(fm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xt(e),null;case 1:return Ut(e.type)&&Ql(),xt(e),null;case 3:return r=e.stateNode,gi(),De(Vt),De(Et),Nm(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(il(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,pn!==null&&(bh(pn),pn=null))),hh(t,e),xt(e),null;case 5:_m(e);var s=os(Ha.current);if(n=e.type,t!==null&&e.stateNode!=null)fv(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(J(166));return xt(e),null}if(t=os(Sn.current),il(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[Nn]=e,r[za]=a,t=(e.mode&1)!==0,n){case"dialog":Pe("cancel",r),Pe("close",r);break;case"iframe":case"object":case"embed":Pe("load",r);break;case"video":case"audio":for(s=0;s<da.length;s++)Pe(da[s],r);break;case"source":Pe("error",r);break;case"img":case"image":case"link":Pe("error",r),Pe("load",r);break;case"details":Pe("toggle",r);break;case"input":Kp(r,a),Pe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Pe("invalid",r);break;case"textarea":Yp(r,a),Pe("invalid",r)}Ud(n,a),s=null;for(var o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="children"?typeof c=="string"?r.textContent!==c&&(a.suppressHydrationWarning!==!0&&sl(r.textContent,c,t),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(a.suppressHydrationWarning!==!0&&sl(r.textContent,c,t),s=["children",""+c]):Ra.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&Pe("scroll",r)}switch(n){case"input":Yo(r),Qp(r,a,!0);break;case"textarea":Yo(r),Xp(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=Kl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=z0(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Nn]=e,t[za]=r,mv(t,e,!1,!1),e.stateNode=t;e:{switch(o=Fd(n,r),n){case"dialog":Pe("cancel",t),Pe("close",t),s=r;break;case"iframe":case"object":case"embed":Pe("load",t),s=r;break;case"video":case"audio":for(s=0;s<da.length;s++)Pe(da[s],t);s=r;break;case"source":Pe("error",t),s=r;break;case"img":case"image":case"link":Pe("error",t),Pe("load",t),s=r;break;case"details":Pe("toggle",t),s=r;break;case"input":Kp(t,r),s=Dd(t,r),Pe("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ue({},r,{value:void 0}),Pe("invalid",t);break;case"textarea":Yp(t,r),s=Ld(t,r),Pe("invalid",t);break;default:s=r}Ud(n,s),c=s;for(a in c)if(c.hasOwnProperty(a)){var u=c[a];a==="style"?G0(t,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&q0(t,u)):a==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Da(t,u):typeof u=="number"&&Da(t,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Ra.hasOwnProperty(a)?u!=null&&a==="onScroll"&&Pe("scroll",t):u!=null&&Zh(t,a,u,o))}switch(n){case"input":Yo(t),Qp(t,r,!1);break;case"textarea":Yo(t),Xp(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Fr(r.value));break;case"select":t.multiple=!!r.multiple,a=r.value,a!=null?ti(t,!!r.multiple,a,!1):r.defaultValue!=null&&ti(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Kl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return xt(e),null;case 6:if(t&&e.stateNode!=null)pv(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(J(166));if(n=os(Ha.current),os(Sn.current),il(e)){if(r=e.stateNode,n=e.memoizedProps,r[Nn]=e,(a=r.nodeValue!==n)&&(t=Kt,t!==null))switch(t.tag){case 3:sl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&sl(r.nodeValue,n,(t.mode&1)!==0)}a&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Nn]=e,e.stateNode=r}return xt(e),null;case 13:if(De(Le),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Oe&&Ht!==null&&e.mode&1&&!(e.flags&128))Rx(),fi(),e.flags|=98560,a=!1;else if(a=il(e),r!==null&&r.dehydrated!==null){if(t===null){if(!a)throw Error(J(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(J(317));a[Nn]=e}else fi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;xt(e),a=!1}else pn!==null&&(bh(pn),pn=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Le.current&1?et===0&&(et=3):Mm())),e.updateQueue!==null&&(e.flags|=4),xt(e),null);case 4:return gi(),hh(t,e),t===null&&Ba(e.stateNode.containerInfo),xt(e),null;case 10:return xm(e.type._context),xt(e),null;case 17:return Ut(e.type)&&Ql(),xt(e),null;case 19:if(De(Le),a=e.memoizedState,a===null)return xt(e),null;if(r=(e.flags&128)!==0,o=a.rendering,o===null)if(r)sa(a,!1);else{if(et!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=nc(t),o!==null){for(e.flags|=128,sa(a,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)a=n,t=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,t=o.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ie(Le,Le.current&1|2),e.child}t=t.sibling}a.tail!==null&&We()>xi&&(e.flags|=128,r=!0,sa(a,!1),e.lanes=4194304)}else{if(!r)if(t=nc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),sa(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!Oe)return xt(e),null}else 2*We()-a.renderingStartTime>xi&&n!==1073741824&&(e.flags|=128,r=!0,sa(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(n=a.last,n!==null?n.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=We(),e.sibling=null,n=Le.current,Ie(Le,r?n&1|2:n&1),e):(xt(e),null);case 22:case 23:return Dm(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?qt&1073741824&&(xt(e),e.subtreeFlags&6&&(e.flags|=8192)):xt(e),null;case 24:return null;case 25:return null}throw Error(J(156,e.tag))}function rT(t,e){switch(fm(e),e.tag){case 1:return Ut(e.type)&&Ql(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return gi(),De(Vt),De(Et),Nm(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return _m(e),null;case 13:if(De(Le),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(J(340));fi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return De(Le),null;case 4:return gi(),null;case 10:return xm(e.type._context),null;case 22:case 23:return Dm(),null;case 24:return null;default:return null}}var ll=!1,wt=!1,sT=typeof WeakSet=="function"?WeakSet:Set,se=null;function Js(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ze(t,e,r)}else n.current=null}function mh(t,e,n){try{n()}catch(r){ze(t,e,r)}}var Fg=!1;function iT(t,e){if(Yd=Hl,t=bx(),hm(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,c=-1,u=-1,d=0,m=0,g=t,y=null;t:for(;;){for(var x;g!==n||s!==0&&g.nodeType!==3||(c=o+s),g!==a||r!==0&&g.nodeType!==3||(u=o+r),g.nodeType===3&&(o+=g.nodeValue.length),(x=g.firstChild)!==null;)y=g,g=x;for(;;){if(g===t)break t;if(y===n&&++d===s&&(c=o),y===a&&++m===r&&(u=o),(x=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=x}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Xd={focusedElem:t,selectionRange:n},Hl=!1,se=e;se!==null;)if(e=se,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,se=t;else for(;se!==null;){e=se;try{var S=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var E=S.memoizedProps,P=S.memoizedState,T=e.stateNode,j=T.getSnapshotBeforeUpdate(e.elementType===e.type?E:mn(e.type,E),P);T.__reactInternalSnapshotBeforeUpdate=j}break;case 3:var R=e.stateNode.containerInfo;R.nodeType===1?R.textContent="":R.nodeType===9&&R.documentElement&&R.removeChild(R.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(M){ze(e,e.return,M)}if(t=e.sibling,t!==null){t.return=e.return,se=t;break}se=e.return}return S=Fg,Fg=!1,S}function Ea(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&mh(e,n,a)}s=s.next}while(s!==r)}}function Bc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function fh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function gv(t){var e=t.alternate;e!==null&&(t.alternate=null,gv(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Nn],delete e[za],delete e[eh],delete e[BE],delete e[$E])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function yv(t){return t.tag===5||t.tag===3||t.tag===4}function Bg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||yv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ph(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Kl));else if(r!==4&&(t=t.child,t!==null))for(ph(t,e,n),t=t.sibling;t!==null;)ph(t,e,n),t=t.sibling}function gh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(gh(t,e,n),t=t.sibling;t!==null;)gh(t,e,n),t=t.sibling}var at=null,fn=!1;function fr(t,e,n){for(n=n.child;n!==null;)xv(t,e,n),n=n.sibling}function xv(t,e,n){if(jn&&typeof jn.onCommitFiberUnmount=="function")try{jn.onCommitFiberUnmount(Rc,n)}catch{}switch(n.tag){case 5:wt||Js(n,e);case 6:var r=at,s=fn;at=null,fr(t,e,n),at=r,fn=s,at!==null&&(fn?(t=at,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):at.removeChild(n.stateNode));break;case 18:at!==null&&(fn?(t=at,n=n.stateNode,t.nodeType===8?sd(t.parentNode,n):t.nodeType===1&&sd(t,n),Va(t)):sd(at,n.stateNode));break;case 4:r=at,s=fn,at=n.stateNode.containerInfo,fn=!0,fr(t,e,n),at=r,fn=s;break;case 0:case 11:case 14:case 15:if(!wt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var a=s,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&mh(n,e,o),s=s.next}while(s!==r)}fr(t,e,n);break;case 1:if(!wt&&(Js(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){ze(n,e,c)}fr(t,e,n);break;case 21:fr(t,e,n);break;case 22:n.mode&1?(wt=(r=wt)||n.memoizedState!==null,fr(t,e,n),wt=r):fr(t,e,n);break;default:fr(t,e,n)}}function $g(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new sT),e.forEach(function(r){var s=fT.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function hn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var a=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:at=c.stateNode,fn=!1;break e;case 3:at=c.stateNode.containerInfo,fn=!0;break e;case 4:at=c.stateNode.containerInfo,fn=!0;break e}c=c.return}if(at===null)throw Error(J(160));xv(a,o,s),at=null,fn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){ze(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)vv(e,t),e=e.sibling}function vv(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(hn(e,t),wn(t),r&4){try{Ea(3,t,t.return),Bc(3,t)}catch(E){ze(t,t.return,E)}try{Ea(5,t,t.return)}catch(E){ze(t,t.return,E)}}break;case 1:hn(e,t),wn(t),r&512&&n!==null&&Js(n,n.return);break;case 5:if(hn(e,t),wn(t),r&512&&n!==null&&Js(n,n.return),t.flags&32){var s=t.stateNode;try{Da(s,"")}catch(E){ze(t,t.return,E)}}if(r&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,o=n!==null?n.memoizedProps:a,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&a.type==="radio"&&a.name!=null&&B0(s,a),Fd(c,o);var d=Fd(c,a);for(o=0;o<u.length;o+=2){var m=u[o],g=u[o+1];m==="style"?G0(s,g):m==="dangerouslySetInnerHTML"?q0(s,g):m==="children"?Da(s,g):Zh(s,m,g,d)}switch(c){case"input":Md(s,a);break;case"textarea":$0(s,a);break;case"select":var y=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var x=a.value;x!=null?ti(s,!!a.multiple,x,!1):y!==!!a.multiple&&(a.defaultValue!=null?ti(s,!!a.multiple,a.defaultValue,!0):ti(s,!!a.multiple,a.multiple?[]:"",!1))}s[za]=a}catch(E){ze(t,t.return,E)}}break;case 6:if(hn(e,t),wn(t),r&4){if(t.stateNode===null)throw Error(J(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(E){ze(t,t.return,E)}}break;case 3:if(hn(e,t),wn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Va(e.containerInfo)}catch(E){ze(t,t.return,E)}break;case 4:hn(e,t),wn(t);break;case 13:hn(e,t),wn(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Pm=We())),r&4&&$g(t);break;case 22:if(m=n!==null&&n.memoizedState!==null,t.mode&1?(wt=(d=wt)||m,hn(e,t),wt=d):hn(e,t),wn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!m&&t.mode&1)for(se=t,m=t.child;m!==null;){for(g=se=m;se!==null;){switch(y=se,x=y.child,y.tag){case 0:case 11:case 14:case 15:Ea(4,y,y.return);break;case 1:Js(y,y.return);var S=y.stateNode;if(typeof S.componentWillUnmount=="function"){r=y,n=y.return;try{e=r,S.props=e.memoizedProps,S.state=e.memoizedState,S.componentWillUnmount()}catch(E){ze(r,n,E)}}break;case 5:Js(y,y.return);break;case 22:if(y.memoizedState!==null){qg(g);continue}}x!==null?(x.return=y,se=x):qg(g)}m=m.sibling}e:for(m=null,g=t;;){if(g.tag===5){if(m===null){m=g;try{s=g.stateNode,d?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(c=g.stateNode,u=g.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=H0("display",o))}catch(E){ze(t,t.return,E)}}}else if(g.tag===6){if(m===null)try{g.stateNode.nodeValue=d?"":g.memoizedProps}catch(E){ze(t,t.return,E)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;m===g&&(m=null),g=g.return}m===g&&(m=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:hn(e,t),wn(t),r&4&&$g(t);break;case 21:break;default:hn(e,t),wn(t)}}function wn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(yv(n)){var r=n;break e}n=n.return}throw Error(J(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Da(s,""),r.flags&=-33);var a=Bg(t);gh(t,a,s);break;case 3:case 4:var o=r.stateNode.containerInfo,c=Bg(t);ph(t,c,o);break;default:throw Error(J(161))}}catch(u){ze(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function aT(t,e,n){se=t,bv(t)}function bv(t,e,n){for(var r=(t.mode&1)!==0;se!==null;){var s=se,a=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||ll;if(!o){var c=s.alternate,u=c!==null&&c.memoizedState!==null||wt;c=ll;var d=wt;if(ll=o,(wt=u)&&!d)for(se=s;se!==null;)o=se,u=o.child,o.tag===22&&o.memoizedState!==null?Hg(s):u!==null?(u.return=o,se=u):Hg(s);for(;a!==null;)se=a,bv(a),a=a.sibling;se=s,ll=c,wt=d}zg(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,se=a):zg(t)}}function zg(t){for(;se!==null;){var e=se;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:wt||Bc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!wt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:mn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&Sg(e,a,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Sg(e,o,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var m=d.memoizedState;if(m!==null){var g=m.dehydrated;g!==null&&Va(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}wt||e.flags&512&&fh(e)}catch(y){ze(e,e.return,y)}}if(e===t){se=null;break}if(n=e.sibling,n!==null){n.return=e.return,se=n;break}se=e.return}}function qg(t){for(;se!==null;){var e=se;if(e===t){se=null;break}var n=e.sibling;if(n!==null){n.return=e.return,se=n;break}se=e.return}}function Hg(t){for(;se!==null;){var e=se;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Bc(4,e)}catch(u){ze(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){ze(e,s,u)}}var a=e.return;try{fh(e)}catch(u){ze(e,a,u)}break;case 5:var o=e.return;try{fh(e)}catch(u){ze(e,o,u)}}}catch(u){ze(e,e.return,u)}if(e===t){se=null;break}var c=e.sibling;if(c!==null){c.return=e.return,se=c;break}se=e.return}}var oT=Math.ceil,ic=lr.ReactCurrentDispatcher,Am=lr.ReactCurrentOwner,nn=lr.ReactCurrentBatchConfig,ve=0,st=null,Qe=null,ct=0,qt=0,Zs=Kr(0),et=0,Qa=null,xs=0,$c=0,km=0,Ta=null,Mt=null,Pm=0,xi=1/0,Fn=null,ac=!1,yh=null,Rr=null,cl=!1,jr=null,oc=0,ja=0,xh=null,Sl=-1,Cl=0;function At(){return ve&6?We():Sl!==-1?Sl:Sl=We()}function Dr(t){return t.mode&1?ve&2&&ct!==0?ct&-ct:qE.transition!==null?(Cl===0&&(Cl=sx()),Cl):(t=Ee,t!==0||(t=window.event,t=t===void 0?16:dx(t.type)),t):1}function yn(t,e,n,r){if(50<ja)throw ja=0,xh=null,Error(J(185));oo(t,n,r),(!(ve&2)||t!==st)&&(t===st&&(!(ve&2)&&($c|=n),et===4&&vr(t,ct)),Ft(t,r),n===1&&ve===0&&!(e.mode&1)&&(xi=We()+500,Vc&&Qr()))}function Ft(t,e){var n=t.callbackNode;qN(t,e);var r=ql(t,t===st?ct:0);if(r===0)n!==null&&eg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&eg(n),e===1)t.tag===0?zE(Gg.bind(null,t)):Ax(Gg.bind(null,t)),UE(function(){!(ve&6)&&Qr()}),n=null;else{switch(ix(r)){case 1:n=sm;break;case 4:n=nx;break;case 16:n=zl;break;case 536870912:n=rx;break;default:n=zl}n=Cv(n,wv.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function wv(t,e){if(Sl=-1,Cl=0,ve&6)throw Error(J(327));var n=t.callbackNode;if(ai()&&t.callbackNode!==n)return null;var r=ql(t,t===st?ct:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=lc(t,r);else{e=r;var s=ve;ve|=2;var a=Nv();(st!==t||ct!==e)&&(Fn=null,xi=We()+500,us(t,e));do try{uT();break}catch(c){_v(t,c)}while(!0);ym(),ic.current=a,ve=s,Qe!==null?e=0:(st=null,ct=0,e=et)}if(e!==0){if(e===2&&(s=Hd(t),s!==0&&(r=s,e=vh(t,s))),e===1)throw n=Qa,us(t,0),vr(t,r),Ft(t,We()),n;if(e===6)vr(t,r);else{if(s=t.current.alternate,!(r&30)&&!lT(s)&&(e=lc(t,r),e===2&&(a=Hd(t),a!==0&&(r=a,e=vh(t,a))),e===1))throw n=Qa,us(t,0),vr(t,r),Ft(t,We()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(J(345));case 2:rs(t,Mt,Fn);break;case 3:if(vr(t,r),(r&130023424)===r&&(e=Pm+500-We(),10<e)){if(ql(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){At(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Zd(rs.bind(null,t,Mt,Fn),e);break}rs(t,Mt,Fn);break;case 4:if(vr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-gn(r);a=1<<o,o=e[o],o>s&&(s=o),r&=~a}if(r=s,r=We()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*oT(r/1960))-r,10<r){t.timeoutHandle=Zd(rs.bind(null,t,Mt,Fn),r);break}rs(t,Mt,Fn);break;case 5:rs(t,Mt,Fn);break;default:throw Error(J(329))}}}return Ft(t,We()),t.callbackNode===n?wv.bind(null,t):null}function vh(t,e){var n=Ta;return t.current.memoizedState.isDehydrated&&(us(t,e).flags|=256),t=lc(t,e),t!==2&&(e=Mt,Mt=n,e!==null&&bh(e)),t}function bh(t){Mt===null?Mt=t:Mt.push.apply(Mt,t)}function lT(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],a=s.getSnapshot;s=s.value;try{if(!xn(a(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function vr(t,e){for(e&=~km,e&=~$c,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-gn(e),r=1<<n;t[n]=-1,e&=~r}}function Gg(t){if(ve&6)throw Error(J(327));ai();var e=ql(t,0);if(!(e&1))return Ft(t,We()),null;var n=lc(t,e);if(t.tag!==0&&n===2){var r=Hd(t);r!==0&&(e=r,n=vh(t,r))}if(n===1)throw n=Qa,us(t,0),vr(t,e),Ft(t,We()),n;if(n===6)throw Error(J(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,rs(t,Mt,Fn),Ft(t,We()),null}function Rm(t,e){var n=ve;ve|=1;try{return t(e)}finally{ve=n,ve===0&&(xi=We()+500,Vc&&Qr())}}function vs(t){jr!==null&&jr.tag===0&&!(ve&6)&&ai();var e=ve;ve|=1;var n=nn.transition,r=Ee;try{if(nn.transition=null,Ee=1,t)return t()}finally{Ee=r,nn.transition=n,ve=e,!(ve&6)&&Qr()}}function Dm(){qt=Zs.current,De(Zs)}function us(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,VE(n)),Qe!==null)for(n=Qe.return;n!==null;){var r=n;switch(fm(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ql();break;case 3:gi(),De(Vt),De(Et),Nm();break;case 5:_m(r);break;case 4:gi();break;case 13:De(Le);break;case 19:De(Le);break;case 10:xm(r.type._context);break;case 22:case 23:Dm()}n=n.return}if(st=t,Qe=t=Mr(t.current,null),ct=qt=e,et=0,Qa=null,km=$c=xs=0,Mt=Ta=null,as!==null){for(e=0;e<as.length;e++)if(n=as[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,a=n.pending;if(a!==null){var o=a.next;a.next=s,r.next=o}n.pending=r}as=null}return t}function _v(t,e){do{var n=Qe;try{if(ym(),El.current=sc,rc){for(var r=Ve.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}rc=!1}if(ys=0,nt=Je=Ve=null,Na=!1,Ga=0,Am.current=null,n===null||n.return===null){et=1,Qa=e,Qe=null;break}e:{var a=t,o=n.return,c=n,u=e;if(e=ct,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,m=c,g=m.tag;if(!(m.mode&1)&&(g===0||g===11||g===15)){var y=m.alternate;y?(m.updateQueue=y.updateQueue,m.memoizedState=y.memoizedState,m.lanes=y.lanes):(m.updateQueue=null,m.memoizedState=null)}var x=Rg(o);if(x!==null){x.flags&=-257,Dg(x,o,c,a,e),x.mode&1&&Pg(a,d,e),e=x,u=d;var S=e.updateQueue;if(S===null){var E=new Set;E.add(u),e.updateQueue=E}else S.add(u);break e}else{if(!(e&1)){Pg(a,d,e),Mm();break e}u=Error(J(426))}}else if(Oe&&c.mode&1){var P=Rg(o);if(P!==null){!(P.flags&65536)&&(P.flags|=256),Dg(P,o,c,a,e),pm(yi(u,c));break e}}a=u=yi(u,c),et!==4&&(et=2),Ta===null?Ta=[a]:Ta.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var T=iv(a,u,e);jg(a,T);break e;case 1:c=u;var j=a.type,R=a.stateNode;if(!(a.flags&128)&&(typeof j.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(Rr===null||!Rr.has(R)))){a.flags|=65536,e&=-e,a.lanes|=e;var M=av(a,c,e);jg(a,M);break e}}a=a.return}while(a!==null)}Tv(n)}catch(q){e=q,Qe===n&&n!==null&&(Qe=n=n.return);continue}break}while(!0)}function Nv(){var t=ic.current;return ic.current=sc,t===null?sc:t}function Mm(){(et===0||et===3||et===2)&&(et=4),st===null||!(xs&268435455)&&!($c&268435455)||vr(st,ct)}function lc(t,e){var n=ve;ve|=2;var r=Nv();(st!==t||ct!==e)&&(Fn=null,us(t,e));do try{cT();break}catch(s){_v(t,s)}while(!0);if(ym(),ve=n,ic.current=r,Qe!==null)throw Error(J(261));return st=null,ct=0,et}function cT(){for(;Qe!==null;)Ev(Qe)}function uT(){for(;Qe!==null&&!MN();)Ev(Qe)}function Ev(t){var e=Sv(t.alternate,t,qt);t.memoizedProps=t.pendingProps,e===null?Tv(t):Qe=e,Am.current=null}function Tv(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=rT(n,e),n!==null){n.flags&=32767,Qe=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{et=6,Qe=null;return}}else if(n=nT(n,e,qt),n!==null){Qe=n;return}if(e=e.sibling,e!==null){Qe=e;return}Qe=e=t}while(e!==null);et===0&&(et=5)}function rs(t,e,n){var r=Ee,s=nn.transition;try{nn.transition=null,Ee=1,dT(t,e,n,r)}finally{nn.transition=s,Ee=r}return null}function dT(t,e,n,r){do ai();while(jr!==null);if(ve&6)throw Error(J(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(J(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(HN(t,a),t===st&&(Qe=st=null,ct=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||cl||(cl=!0,Cv(zl,function(){return ai(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=nn.transition,nn.transition=null;var o=Ee;Ee=1;var c=ve;ve|=4,Am.current=null,iT(t,n),vv(n,t),kE(Xd),Hl=!!Yd,Xd=Yd=null,t.current=n,aT(n),ON(),ve=c,Ee=o,nn.transition=a}else t.current=n;if(cl&&(cl=!1,jr=t,oc=s),a=t.pendingLanes,a===0&&(Rr=null),UN(n.stateNode),Ft(t,We()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(ac)throw ac=!1,t=yh,yh=null,t;return oc&1&&t.tag!==0&&ai(),a=t.pendingLanes,a&1?t===xh?ja++:(ja=0,xh=t):ja=0,Qr(),null}function ai(){if(jr!==null){var t=ix(oc),e=nn.transition,n=Ee;try{if(nn.transition=null,Ee=16>t?16:t,jr===null)var r=!1;else{if(t=jr,jr=null,oc=0,ve&6)throw Error(J(331));var s=ve;for(ve|=4,se=t.current;se!==null;){var a=se,o=a.child;if(se.flags&16){var c=a.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(se=d;se!==null;){var m=se;switch(m.tag){case 0:case 11:case 15:Ea(8,m,a)}var g=m.child;if(g!==null)g.return=m,se=g;else for(;se!==null;){m=se;var y=m.sibling,x=m.return;if(gv(m),m===d){se=null;break}if(y!==null){y.return=x,se=y;break}se=x}}}var S=a.alternate;if(S!==null){var E=S.child;if(E!==null){S.child=null;do{var P=E.sibling;E.sibling=null,E=P}while(E!==null)}}se=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,se=o;else e:for(;se!==null;){if(a=se,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Ea(9,a,a.return)}var T=a.sibling;if(T!==null){T.return=a.return,se=T;break e}se=a.return}}var j=t.current;for(se=j;se!==null;){o=se;var R=o.child;if(o.subtreeFlags&2064&&R!==null)R.return=o,se=R;else e:for(o=j;se!==null;){if(c=se,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Bc(9,c)}}catch(q){ze(c,c.return,q)}if(c===o){se=null;break e}var M=c.sibling;if(M!==null){M.return=c.return,se=M;break e}se=c.return}}if(ve=s,Qr(),jn&&typeof jn.onPostCommitFiberRoot=="function")try{jn.onPostCommitFiberRoot(Rc,t)}catch{}r=!0}return r}finally{Ee=n,nn.transition=e}}return!1}function Wg(t,e,n){e=yi(n,e),e=iv(t,e,1),t=Pr(t,e,1),e=At(),t!==null&&(oo(t,1,e),Ft(t,e))}function ze(t,e,n){if(t.tag===3)Wg(t,t,n);else for(;e!==null;){if(e.tag===3){Wg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Rr===null||!Rr.has(r))){t=yi(n,t),t=av(e,t,1),e=Pr(e,t,1),t=At(),e!==null&&(oo(e,1,t),Ft(e,t));break}}e=e.return}}function hT(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=At(),t.pingedLanes|=t.suspendedLanes&n,st===t&&(ct&n)===n&&(et===4||et===3&&(ct&130023424)===ct&&500>We()-Pm?us(t,0):km|=n),Ft(t,e)}function jv(t,e){e===0&&(t.mode&1?(e=Zo,Zo<<=1,!(Zo&130023424)&&(Zo=4194304)):e=1);var n=At();t=Zn(t,e),t!==null&&(oo(t,e,n),Ft(t,n))}function mT(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),jv(t,n)}function fT(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(J(314))}r!==null&&r.delete(e),jv(t,n)}var Sv;Sv=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Vt.current)Lt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Lt=!1,tT(t,e,n);Lt=!!(t.flags&131072)}else Lt=!1,Oe&&e.flags&1048576&&kx(e,Jl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;jl(t,e),t=e.pendingProps;var s=mi(e,Et.current);ii(e,n),s=Tm(null,e,r,t,s,n);var a=jm();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ut(r)?(a=!0,Yl(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,bm(e),s.updater=Fc,e.stateNode=s,s._reactInternals=e,ah(e,r,t,n),e=ch(null,e,r,!0,a,n)):(e.tag=0,Oe&&a&&mm(e),It(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(jl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=gT(r),t=mn(r,t),s){case 0:e=lh(null,e,r,t,n);break e;case 1:e=Lg(null,e,r,t,n);break e;case 11:e=Mg(null,e,r,t,n);break e;case 14:e=Og(null,e,r,mn(r.type,t),n);break e}throw Error(J(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mn(r,s),lh(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mn(r,s),Lg(t,e,r,s,n);case 3:e:{if(uv(e),t===null)throw Error(J(387));r=e.pendingProps,a=e.memoizedState,s=a.element,Lx(t,e),tc(e,r,null,n);var o=e.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=yi(Error(J(423)),e),e=Vg(t,e,r,n,s);break e}else if(r!==s){s=yi(Error(J(424)),e),e=Vg(t,e,r,n,s);break e}else for(Ht=kr(e.stateNode.containerInfo.firstChild),Kt=e,Oe=!0,pn=null,n=Mx(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(fi(),r===s){e=er(t,e,n);break e}It(t,e,r,n)}e=e.child}return e;case 5:return Vx(e),t===null&&rh(e),r=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,o=s.children,Jd(r,s)?o=null:a!==null&&Jd(r,a)&&(e.flags|=32),cv(t,e),It(t,e,o,n),e.child;case 6:return t===null&&rh(e),null;case 13:return dv(t,e,n);case 4:return wm(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=pi(e,null,r,n):It(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mn(r,s),Mg(t,e,r,s,n);case 7:return It(t,e,e.pendingProps,n),e.child;case 8:return It(t,e,e.pendingProps.children,n),e.child;case 12:return It(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,a=e.memoizedProps,o=s.value,Ie(Zl,r._currentValue),r._currentValue=o,a!==null)if(xn(a.value,o)){if(a.children===s.children&&!Vt.current){e=er(t,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var c=a.dependencies;if(c!==null){o=a.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(a.tag===1){u=Wn(-1,n&-n),u.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var m=d.pending;m===null?u.next=u:(u.next=m.next,m.next=u),d.pending=u}}a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),sh(a.return,n,e),c.lanes|=n;break}u=u.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(J(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),sh(o,n,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}It(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ii(e,n),s=an(s),r=r(s),e.flags|=1,It(t,e,r,n),e.child;case 14:return r=e.type,s=mn(r,e.pendingProps),s=mn(r.type,s),Og(t,e,r,s,n);case 15:return ov(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mn(r,s),jl(t,e),e.tag=1,Ut(r)?(t=!0,Yl(e)):t=!1,ii(e,n),sv(e,r,s),ah(e,r,s,n),ch(null,e,r,!0,t,n);case 19:return hv(t,e,n);case 22:return lv(t,e,n)}throw Error(J(156,e.tag))};function Cv(t,e){return tx(t,e)}function pT(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tn(t,e,n,r){return new pT(t,e,n,r)}function Om(t){return t=t.prototype,!(!t||!t.isReactComponent)}function gT(t){if(typeof t=="function")return Om(t)?1:0;if(t!=null){if(t=t.$$typeof,t===tm)return 11;if(t===nm)return 14}return 2}function Mr(t,e){var n=t.alternate;return n===null?(n=tn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Il(t,e,n,r,s,a){var o=2;if(r=t,typeof t=="function")Om(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case zs:return ds(n.children,s,a,e);case em:o=8,s|=8;break;case Ad:return t=tn(12,n,e,s|2),t.elementType=Ad,t.lanes=a,t;case kd:return t=tn(13,n,e,s),t.elementType=kd,t.lanes=a,t;case Pd:return t=tn(19,n,e,s),t.elementType=Pd,t.lanes=a,t;case V0:return zc(n,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case O0:o=10;break e;case L0:o=9;break e;case tm:o=11;break e;case nm:o=14;break e;case gr:o=16,r=null;break e}throw Error(J(130,t==null?t:typeof t,""))}return e=tn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=a,e}function ds(t,e,n,r){return t=tn(7,t,r,e),t.lanes=n,t}function zc(t,e,n,r){return t=tn(22,t,r,e),t.elementType=V0,t.lanes=n,t.stateNode={isHidden:!1},t}function hd(t,e,n){return t=tn(6,t,null,e),t.lanes=n,t}function md(t,e,n){return e=tn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function yT(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wu(0),this.expirationTimes=Wu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Lm(t,e,n,r,s,a,o,c,u){return t=new yT(t,e,n,c,u),e===1?(e=1,a===!0&&(e|=8)):e=0,a=tn(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},bm(a),t}function xT(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$s,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Iv(t){if(!t)return Br;t=t._reactInternals;e:{if(Ss(t)!==t||t.tag!==1)throw Error(J(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ut(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(J(171))}if(t.tag===1){var n=t.type;if(Ut(n))return Ix(t,n,e)}return e}function Av(t,e,n,r,s,a,o,c,u){return t=Lm(n,r,!0,t,s,a,o,c,u),t.context=Iv(null),n=t.current,r=At(),s=Dr(n),a=Wn(r,s),a.callback=e??null,Pr(n,a,s),t.current.lanes=s,oo(t,s,r),Ft(t,r),t}function qc(t,e,n,r){var s=e.current,a=At(),o=Dr(s);return n=Iv(n),e.context===null?e.context=n:e.pendingContext=n,e=Wn(a,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Pr(s,e,o),t!==null&&(yn(t,s,o,a),Nl(t,s,o)),o}function cc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Kg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Vm(t,e){Kg(t,e),(t=t.alternate)&&Kg(t,e)}function vT(){return null}var kv=typeof reportError=="function"?reportError:function(t){console.error(t)};function Um(t){this._internalRoot=t}Hc.prototype.render=Um.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(J(409));qc(t,e,null,null)};Hc.prototype.unmount=Um.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;vs(function(){qc(null,t,null,null)}),e[Jn]=null}};function Hc(t){this._internalRoot=t}Hc.prototype.unstable_scheduleHydration=function(t){if(t){var e=lx();t={blockedOn:null,target:t,priority:e};for(var n=0;n<xr.length&&e!==0&&e<xr[n].priority;n++);xr.splice(n,0,t),n===0&&ux(t)}};function Fm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Gc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Qg(){}function bT(t,e,n,r,s){if(s){if(typeof r=="function"){var a=r;r=function(){var d=cc(o);a.call(d)}}var o=Av(e,r,t,0,null,!1,!1,"",Qg);return t._reactRootContainer=o,t[Jn]=o.current,Ba(t.nodeType===8?t.parentNode:t),vs(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var d=cc(u);c.call(d)}}var u=Lm(t,0,!1,null,null,!1,!1,"",Qg);return t._reactRootContainer=u,t[Jn]=u.current,Ba(t.nodeType===8?t.parentNode:t),vs(function(){qc(e,u,n,r)}),u}function Wc(t,e,n,r,s){var a=n._reactRootContainer;if(a){var o=a;if(typeof s=="function"){var c=s;s=function(){var u=cc(o);c.call(u)}}qc(e,o,t,s)}else o=bT(n,e,t,s,r);return cc(o)}ax=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ua(e.pendingLanes);n!==0&&(im(e,n|1),Ft(e,We()),!(ve&6)&&(xi=We()+500,Qr()))}break;case 13:vs(function(){var r=Zn(t,1);if(r!==null){var s=At();yn(r,t,1,s)}}),Vm(t,1)}};am=function(t){if(t.tag===13){var e=Zn(t,134217728);if(e!==null){var n=At();yn(e,t,134217728,n)}Vm(t,134217728)}};ox=function(t){if(t.tag===13){var e=Dr(t),n=Zn(t,e);if(n!==null){var r=At();yn(n,t,e,r)}Vm(t,e)}};lx=function(){return Ee};cx=function(t,e){var n=Ee;try{return Ee=t,e()}finally{Ee=n}};$d=function(t,e,n){switch(e){case"input":if(Md(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Lc(r);if(!s)throw Error(J(90));F0(r),Md(r,s)}}}break;case"textarea":$0(t,n);break;case"select":e=n.value,e!=null&&ti(t,!!n.multiple,e,!1)}};Q0=Rm;Y0=vs;var wT={usingClientEntryPoint:!1,Events:[co,Ws,Lc,W0,K0,Rm]},ia={findFiberByHostInstance:is,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_T={bundleType:ia.bundleType,version:ia.version,rendererPackageName:ia.rendererPackageName,rendererConfig:ia.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:lr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Z0(t),t===null?null:t.stateNode},findFiberByHostInstance:ia.findFiberByHostInstance||vT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ul=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ul.isDisabled&&ul.supportsFiber)try{Rc=ul.inject(_T),jn=ul}catch{}}Yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wT;Yt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fm(e))throw Error(J(200));return xT(t,e,null,n)};Yt.createRoot=function(t,e){if(!Fm(t))throw Error(J(299));var n=!1,r="",s=kv;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Lm(t,1,!1,null,null,n,!1,r,s),t[Jn]=e.current,Ba(t.nodeType===8?t.parentNode:t),new Um(e)};Yt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(J(188)):(t=Object.keys(t).join(","),Error(J(268,t)));return t=Z0(e),t=t===null?null:t.stateNode,t};Yt.flushSync=function(t){return vs(t)};Yt.hydrate=function(t,e,n){if(!Gc(e))throw Error(J(200));return Wc(null,t,e,!0,n)};Yt.hydrateRoot=function(t,e,n){if(!Fm(t))throw Error(J(405));var r=n!=null&&n.hydratedSources||null,s=!1,a="",o=kv;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Av(e,null,t,1,n??null,s,!1,a,o),t[Jn]=e.current,Ba(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Hc(e)};Yt.render=function(t,e,n){if(!Gc(e))throw Error(J(200));return Wc(null,t,e,!1,n)};Yt.unmountComponentAtNode=function(t){if(!Gc(t))throw Error(J(40));return t._reactRootContainer?(vs(function(){Wc(null,null,t,!1,function(){t._reactRootContainer=null,t[Jn]=null})}),!0):!1};Yt.unstable_batchedUpdates=Rm;Yt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Gc(n))throw Error(J(200));if(t==null||t._reactInternals===void 0)throw Error(J(38));return Wc(t,e,n,!1,r)};Yt.version="18.3.1-next-f1338f8080-20240426";function Pv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Pv)}catch(t){console.error(t)}}Pv(),P0.exports=Yt;var NT=P0.exports,Yg=NT;Cd.createRoot=Yg.createRoot,Cd.hydrateRoot=Yg.hydrateRoot;var Xg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rv=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},ET=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const a=t[n++];e[r++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=t[n++],o=t[n++],c=t[n++],u=((s&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const a=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(a&63)<<6|o&63)}}return e.join("")},Dv={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const a=t[s],o=s+1<t.length,c=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,m=a>>2,g=(a&3)<<4|c>>4;let y=(c&15)<<2|d>>6,x=d&63;u||(x=64,o||(y=64)),r.push(n[m],n[g],n[y],n[x])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Rv(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ET(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const a=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,a==null||c==null||d==null||g==null)throw new TT;const y=a<<2|c>>4;if(r.push(y),d!==64){const x=c<<4&240|d>>2;if(r.push(x),g!==64){const S=d<<6&192|g;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class TT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const jT=function(t){const e=Rv(t);return Dv.encodeByteArray(e,!0)},uc=function(t){return jT(t).replace(/\./g,"")},Mv=function(t){try{return Dv.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ST(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CT=()=>ST().__FIREBASE_DEFAULTS__,IT=()=>{if(typeof process>"u"||typeof Xg>"u")return;const t=Xg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},AT=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Mv(t[1]);return e&&JSON.parse(e)},Kc=()=>{try{return CT()||IT()||AT()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Ov=t=>{var e,n;return(n=(e=Kc())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Bm=t=>{const e=Ov(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Lv=()=>{var t;return(t=Kc())===null||t===void 0?void 0:t.config},Vv=t=>{var e;return(e=Kc())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uv(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t);return[uc(JSON.stringify(n)),uc(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function PT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Tt())}function RT(){var t;const e=(t=Kc())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function DT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function MT(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function OT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function LT(){const t=Tt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function VT(){return!RT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function UT(){try{return typeof indexedDB=="object"}catch{return!1}}function FT(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var a;e(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BT="FirebaseError";class Mn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=BT,Object.setPrototypeOf(this,Mn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ho.prototype.create)}}class ho{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,a=this.errors[e],o=a?$T(a,r):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new Mn(s,c,r)}}function $T(t,e){return t.replace(zT,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const zT=/\{\$([^}]+)}/g;function qT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function dc(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const a=t[s],o=e[s];if(Jg(a)&&Jg(o)){if(!dc(a,o))return!1}else if(a!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Jg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mo(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ha(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,a]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function ma(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function HT(t,e){const n=new GT(t,e);return n.subscribe.bind(n)}class GT{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");WT(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=fd),s.error===void 0&&(s.error=fd),s.complete===void 0&&(s.complete=fd);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function WT(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function fd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ce(t){return t&&t._delegate?t._delegate:t}class tr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new kT;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(YT(e))try{this.getOrInitializeService({instanceIdentifier:ss})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const a=this.getOrInitializeService({instanceIdentifier:s});r.resolve(a)}catch{}}}}clearInstance(e=ss){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ss){return this.instances.has(e)}getOptions(e=ss){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);r===c&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),a=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;a.add(e),this.onInitCallbacks.set(s,a);const o=this.instances.get(s);return o&&e(o,s),()=>{a.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:QT(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ss){return this.component?this.component.multipleInstances?e:ss:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function QT(t){return t===ss?void 0:t}function YT(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new KT(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ye||(ye={}));const JT={debug:ye.DEBUG,verbose:ye.VERBOSE,info:ye.INFO,warn:ye.WARN,error:ye.ERROR,silent:ye.SILENT},ZT=ye.INFO,ej={[ye.DEBUG]:"log",[ye.VERBOSE]:"log",[ye.INFO]:"info",[ye.WARN]:"warn",[ye.ERROR]:"error"},tj=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=ej[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $m{constructor(e){this.name=e,this._logLevel=ZT,this._logHandler=tj,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?JT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ye.DEBUG,...e),this._logHandler(this,ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ye.VERBOSE,...e),this._logHandler(this,ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ye.INFO,...e),this._logHandler(this,ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ye.WARN,...e),this._logHandler(this,ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ye.ERROR,...e),this._logHandler(this,ye.ERROR,...e)}}const nj=(t,e)=>e.some(n=>t instanceof n);let Zg,ey;function rj(){return Zg||(Zg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sj(){return ey||(ey=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Fv=new WeakMap,wh=new WeakMap,Bv=new WeakMap,pd=new WeakMap,zm=new WeakMap;function ij(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{n(Or(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Fv.set(n,t)}).catch(()=>{}),zm.set(e,t),e}function aj(t){if(wh.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});wh.set(t,e)}let _h={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return wh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Bv.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Or(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function oj(t){_h=t(_h)}function lj(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(gd(this),e,...n);return Bv.set(r,e.sort?e.sort():[e]),Or(r)}:sj().includes(t)?function(...e){return t.apply(gd(this),e),Or(Fv.get(this))}:function(...e){return Or(t.apply(gd(this),e))}}function cj(t){return typeof t=="function"?lj(t):(t instanceof IDBTransaction&&aj(t),nj(t,rj())?new Proxy(t,_h):t)}function Or(t){if(t instanceof IDBRequest)return ij(t);if(pd.has(t))return pd.get(t);const e=cj(t);return e!==t&&(pd.set(t,e),zm.set(e,t)),e}const gd=t=>zm.get(t);function uj(t,e,{blocked:n,upgrade:r,blocking:s,terminated:a}={}){const o=indexedDB.open(t,e),c=Or(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Or(o.result),u.oldVersion,u.newVersion,Or(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const dj=["get","getKey","getAll","getAllKeys","count"],hj=["put","add","delete","clear"],yd=new Map;function ty(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(yd.get(e))return yd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=hj.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||dj.includes(n)))return;const a=async function(o,...c){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[n](...c),s&&u.done]))[0]};return yd.set(e,a),a}oj(t=>({...t,get:(e,n,r)=>ty(e,n)||t.get(e,n,r),has:(e,n)=>!!ty(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mj{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(fj(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function fj(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Nh="@firebase/app",ny="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nr=new $m("@firebase/app"),pj="@firebase/app-compat",gj="@firebase/analytics-compat",yj="@firebase/analytics",xj="@firebase/app-check-compat",vj="@firebase/app-check",bj="@firebase/auth",wj="@firebase/auth-compat",_j="@firebase/database",Nj="@firebase/data-connect",Ej="@firebase/database-compat",Tj="@firebase/functions",jj="@firebase/functions-compat",Sj="@firebase/installations",Cj="@firebase/installations-compat",Ij="@firebase/messaging",Aj="@firebase/messaging-compat",kj="@firebase/performance",Pj="@firebase/performance-compat",Rj="@firebase/remote-config",Dj="@firebase/remote-config-compat",Mj="@firebase/storage",Oj="@firebase/storage-compat",Lj="@firebase/firestore",Vj="@firebase/vertexai-preview",Uj="@firebase/firestore-compat",Fj="firebase",Bj="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eh="[DEFAULT]",$j={[Nh]:"fire-core",[pj]:"fire-core-compat",[yj]:"fire-analytics",[gj]:"fire-analytics-compat",[vj]:"fire-app-check",[xj]:"fire-app-check-compat",[bj]:"fire-auth",[wj]:"fire-auth-compat",[_j]:"fire-rtdb",[Nj]:"fire-data-connect",[Ej]:"fire-rtdb-compat",[Tj]:"fire-fn",[jj]:"fire-fn-compat",[Sj]:"fire-iid",[Cj]:"fire-iid-compat",[Ij]:"fire-fcm",[Aj]:"fire-fcm-compat",[kj]:"fire-perf",[Pj]:"fire-perf-compat",[Rj]:"fire-rc",[Dj]:"fire-rc-compat",[Mj]:"fire-gcs",[Oj]:"fire-gcs-compat",[Lj]:"fire-fst",[Uj]:"fire-fst-compat",[Vj]:"fire-vertex","fire-js":"fire-js",[Fj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hc=new Map,zj=new Map,Th=new Map;function ry(t,e){try{t.container.addComponent(e)}catch(n){nr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function $r(t){const e=t.name;if(Th.has(e))return nr.debug(`There were multiple attempts to register component ${e}.`),!1;Th.set(e,t);for(const n of hc.values())ry(n,t);for(const n of zj.values())ry(n,t);return!0}function fo(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function En(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Lr=new ho("app","Firebase",qj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hj{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new tr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Lr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs=Bj;function $v(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Eh,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Lr.create("bad-app-name",{appName:String(s)});if(n||(n=Lv()),!n)throw Lr.create("no-options");const a=hc.get(s);if(a){if(dc(n,a.options)&&dc(r,a.config))return a;throw Lr.create("duplicate-app",{appName:s})}const o=new XT(s);for(const u of Th.values())o.addComponent(u);const c=new Hj(n,r,o);return hc.set(s,c),c}function Qc(t=Eh){const e=hc.get(t);if(!e&&t===Eh&&Lv())return $v();if(!e)throw Lr.create("no-app",{appName:t});return e}function rn(t,e,n){var r;let s=(r=$j[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const a=s.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const c=[`Unable to register library "${s}" with version "${e}":`];a&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),nr.warn(c.join(" "));return}$r(new tr(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gj="firebase-heartbeat-database",Wj=1,Ya="firebase-heartbeat-store";let xd=null;function zv(){return xd||(xd=uj(Gj,Wj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ya)}catch(n){console.warn(n)}}}}).catch(t=>{throw Lr.create("idb-open",{originalErrorMessage:t.message})})),xd}async function Kj(t){try{const n=(await zv()).transaction(Ya),r=await n.objectStore(Ya).get(qv(t));return await n.done,r}catch(e){if(e instanceof Mn)nr.warn(e.message);else{const n=Lr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});nr.warn(n.message)}}}async function sy(t,e){try{const r=(await zv()).transaction(Ya,"readwrite");await r.objectStore(Ya).put(e,qv(t)),await r.done}catch(n){if(n instanceof Mn)nr.warn(n.message);else{const r=Lr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});nr.warn(r.message)}}}function qv(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qj=1024,Yj=30*24*60*60*1e3;class Xj{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Zj(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=iy();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(o=>o.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const c=new Date(o.date).valueOf();return Date.now()-c<=Yj}),this._storage.overwrite(this._heartbeatsCache))}catch(r){nr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=iy(),{heartbeatsToSend:r,unsentEntries:s}=Jj(this._heartbeatsCache.heartbeats),a=uc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(n){return nr.warn(n),""}}}function iy(){return new Date().toISOString().substring(0,10)}function Jj(t,e=Qj){const n=[];let r=t.slice();for(const s of t){const a=n.find(o=>o.agent===s.agent);if(a){if(a.dates.push(s.date),ay(n)>e){a.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),ay(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Zj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return UT()?FT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Kj(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return sy(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return sy(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function ay(t){return uc(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eS(t){$r(new tr("platform-logger",e=>new mj(e),"PRIVATE")),$r(new tr("heartbeat",e=>new Xj(e),"PRIVATE")),rn(Nh,ny,t),rn(Nh,ny,"esm2017"),rn("fire-js","")}eS("");function qm(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Hv(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const tS=Hv,Gv=new ho("auth","Firebase",Hv());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mc=new $m("@firebase/auth");function nS(t,...e){mc.logLevel<=ye.WARN&&mc.warn(`Auth (${Cs}): ${t}`,...e)}function Al(t,...e){mc.logLevel<=ye.ERROR&&mc.error(`Auth (${Cs}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(t,...e){throw Hm(t,...e)}function Cn(t,...e){return Hm(t,...e)}function Wv(t,e,n){const r=Object.assign(Object.assign({},tS()),{[e]:n});return new ho("auth","Firebase",r).create(e,{appName:t.name})}function Kn(t){return Wv(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Hm(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Gv.create(t,...e)}function ue(t,e,...n){if(!t)throw Hm(e,...n)}function qn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Al(e),new Error(e)}function rr(t,e){t||qn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function rS(){return oy()==="http:"||oy()==="https:"}function oy(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(rS()||MT()||"connection"in navigator)?navigator.onLine:!0}function iS(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e,n){this.shortDelay=e,this.longDelay=n,rr(n>e,"Short delay should be less than long delay!"),this.isMobile=PT()||OT()}get(){return sS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gm(t,e){rr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;qn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;qn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;qn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oS=new po(3e4,6e4);function cr(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function On(t,e,n,r,s={}){return Qv(t,s,async()=>{let a={},o={};r&&(e==="GET"?o=r:a={body:JSON.stringify(r)});const c=mo(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:u},a);return DT()||(d.referrerPolicy="no-referrer"),Kv.fetch()(Yv(t,t.config.apiHost,n,c),d)})}async function Qv(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},aS),e);try{const s=new cS(t),a=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw dl(t,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const c=a.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw dl(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw dl(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw dl(t,"user-disabled",o);const m=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Wv(t,m,d);vn(t,m)}}catch(s){if(s instanceof Mn)throw s;vn(t,"network-request-failed",{message:String(s)})}}async function go(t,e,n,r,s={}){const a=await On(t,e,n,r,s);return"mfaPendingCredential"in a&&vn(t,"multi-factor-auth-required",{_serverResponse:a}),a}function Yv(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Gm(t.config,s):`${t.config.apiScheme}://${s}`}function lS(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class cS{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Cn(this.auth,"network-request-failed")),oS.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function dl(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Cn(t,e,r);return s.customData._tokenResponse=n,s}function ly(t){return t!==void 0&&t.enterprise!==void 0}class uS{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return lS(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function dS(t,e){return On(t,"GET","/v2/recaptchaConfig",cr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hS(t,e){return On(t,"POST","/v1/accounts:delete",e)}async function Xv(t,e){return On(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sa(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function mS(t,e=!1){const n=Ce(t),r=await n.getIdToken(e),s=Wm(r);ue(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,o=a==null?void 0:a.sign_in_provider;return{claims:s,token:r,authTime:Sa(vd(s.auth_time)),issuedAtTime:Sa(vd(s.iat)),expirationTime:Sa(vd(s.exp)),signInProvider:o||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function vd(t){return Number(t)*1e3}function Wm(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Al("JWT malformed, contained fewer than 3 sections"),null;try{const s=Mv(n);return s?JSON.parse(s):(Al("Failed to decode base64 JWT payload"),null)}catch(s){return Al("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function cy(t){const e=Wm(t);return ue(e,"internal-error"),ue(typeof e.exp<"u","internal-error"),ue(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vi(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Mn&&fS(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function fS({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Sa(this.lastLoginAt),this.creationTime=Sa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fc(t){var e;const n=t.auth,r=await t.getIdToken(),s=await vi(t,Xv(n,{idToken:r}));ue(s==null?void 0:s.users.length,n,"internal-error");const a=s.users[0];t._notifyReloadListener(a);const o=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?Jv(a.providerUserInfo):[],c=yS(t.providerData,o),u=t.isAnonymous,d=!(t.email&&a.passwordHash)&&!(c!=null&&c.length),m=u?d:!1,g={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new Sh(a.createdAt,a.lastLoginAt),isAnonymous:m};Object.assign(t,g)}async function gS(t){const e=Ce(t);await fc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function yS(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Jv(t){return t.map(e=>{var{providerId:n}=e,r=qm(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xS(t,e){const n=await Qv(t,{},async()=>{const r=mo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=t.config,o=Yv(t,s,"/v1/token",`key=${a}`),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",Kv.fetch()(o,{method:"POST",headers:c,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function vS(t,e){return On(t,"POST","/v2/accounts:revokeToken",cr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ue(e.idToken,"internal-error"),ue(typeof e.idToken<"u","internal-error"),ue(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):cy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ue(e.length!==0,"internal-error");const n=cy(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ue(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:a}=await xS(e,n);this.updateTokensAndExpiration(r,s,Number(a))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:a}=n,o=new oi;return r&&(ue(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ue(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),a&&(ue(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new oi,this.toJSON())}_performRefresh(){return qn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pr(t,e){ue(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Hn{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,a=qm(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new pS(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Sh(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const n=await vi(this,this.stsTokenManager.getToken(this.auth,e));return ue(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return mS(this,e)}reload(){return gS(this)}_assign(e){this!==e&&(ue(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Hn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ue(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await fc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(En(this.auth.app))return Promise.reject(Kn(this.auth));const e=await this.getIdToken();return await vi(this,hS(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,a,o,c,u,d,m;const g=(r=n.displayName)!==null&&r!==void 0?r:void 0,y=(s=n.email)!==null&&s!==void 0?s:void 0,x=(a=n.phoneNumber)!==null&&a!==void 0?a:void 0,S=(o=n.photoURL)!==null&&o!==void 0?o:void 0,E=(c=n.tenantId)!==null&&c!==void 0?c:void 0,P=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,T=(d=n.createdAt)!==null&&d!==void 0?d:void 0,j=(m=n.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:R,emailVerified:M,isAnonymous:q,providerData:z,stsTokenManager:I}=n;ue(R&&I,e,"internal-error");const b=oi.fromJSON(this.name,I);ue(typeof R=="string",e,"internal-error"),pr(g,e.name),pr(y,e.name),ue(typeof M=="boolean",e,"internal-error"),ue(typeof q=="boolean",e,"internal-error"),pr(x,e.name),pr(S,e.name),pr(E,e.name),pr(P,e.name),pr(T,e.name),pr(j,e.name);const C=new Hn({uid:R,auth:e,email:y,emailVerified:M,displayName:g,isAnonymous:q,photoURL:S,phoneNumber:x,tenantId:E,stsTokenManager:b,createdAt:T,lastLoginAt:j});return z&&Array.isArray(z)&&(C.providerData=z.map(p=>Object.assign({},p))),P&&(C._redirectEventId=P),C}static async _fromIdTokenResponse(e,n,r=!1){const s=new oi;s.updateFromServerResponse(n);const a=new Hn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await fc(a),a}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ue(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?Jv(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),c=new oi;c.updateFromIdToken(r);const u=new Hn({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Sh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy=new Map;function Gn(t){rr(t instanceof Function,"Expected a class definition");let e=uy.get(t);return e?(rr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,uy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Zv.type="NONE";const dy=Zv;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kl(t,e,n){return`firebase:${t}:${e}:${n}`}class li{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:a}=this.auth;this.fullUserKey=kl(this.userKey,s.apiKey,a),this.fullPersistenceKey=kl("persistence",s.apiKey,a),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Hn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new li(Gn(dy),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=s[0]||Gn(dy);const o=kl(r,e.config.apiKey,e.name);let c=null;for(const d of n)try{const m=await d._get(o);if(m){const g=Hn._fromJSON(e,m);d!==a&&(c=g),a=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new li(a,e,r):(a=u[0],c&&await a._set(o,c.toJSON()),await Promise.all(n.map(async d=>{if(d!==a)try{await d._remove(o)}catch{}})),new li(a,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hy(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(rb(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(eb(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ib(e))return"Blackberry";if(ab(e))return"Webos";if(tb(e))return"Safari";if((e.includes("chrome/")||nb(e))&&!e.includes("edge/"))return"Chrome";if(sb(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function eb(t=Tt()){return/firefox\//i.test(t)}function tb(t=Tt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function nb(t=Tt()){return/crios\//i.test(t)}function rb(t=Tt()){return/iemobile/i.test(t)}function sb(t=Tt()){return/android/i.test(t)}function ib(t=Tt()){return/blackberry/i.test(t)}function ab(t=Tt()){return/webos/i.test(t)}function Km(t=Tt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function bS(t=Tt()){var e;return Km(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function wS(){return LT()&&document.documentMode===10}function ob(t=Tt()){return Km(t)||sb(t)||ab(t)||ib(t)||/windows phone/i.test(t)||rb(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lb(t,e=[]){let n;switch(t){case"Browser":n=hy(Tt());break;case"Worker":n=`${hy(Tt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Cs}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=a=>new Promise((o,c)=>{try{const u=e(a);o(u)}catch(u){c(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NS(t,e={}){return On(t,"GET","/v2/passwordPolicy",cr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ES=6;class TS{constructor(e){var n,r,s,a;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:ES,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,a,o,c;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(a=u.containsUppercaseLetter)!==null&&a!==void 0?a:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new my(this),this.idTokenSubscription=new my(this),this.beforeStateQueue=new _S(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Gv,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Gn(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await li.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Xv(this,{idToken:e}),r=await Hn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(En(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,c=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&(u!=null&&u.user)&&(s=u.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ue(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await fc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=iS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(En(this.app))return Promise.reject(Kn(this));const n=e?Ce(e):null;return n&&ue(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ue(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return En(this.app)?Promise.reject(Kn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return En(this.app)?Promise.reject(Kn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Gn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await NS(this),n=new TS(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ho("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await vS(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Gn(e)||this._popupRedirectResolver;ue(n,this,"argument-error"),this.redirectPersistenceManager=await li.create(this,[Gn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const a=typeof n=="function"?n:n.next.bind(n);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(ue(c,this,"internal-error"),c.then(()=>{o||a(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ue(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=lb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&nS(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Is(t){return Ce(t)}class my{constructor(e){this.auth=e,this.observer=null,this.addObserver=HT(n=>this.observer=n)}get next(){return ue(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function SS(t){Yc=t}function cb(t){return Yc.loadJS(t)}function CS(){return Yc.recaptchaEnterpriseScript}function IS(){return Yc.gapiScript}function AS(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const kS="recaptcha-enterprise",PS="NO_RECAPTCHA";class RS{constructor(e){this.type=kS,this.auth=Is(e)}async verify(e="verify",n=!1){async function r(a){if(!n){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,c)=>{dS(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new uS(u);return a.tenantId==null?a._agentRecaptchaConfig=d:a._tenantRecaptchaConfigs[a.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function s(a,o,c){const u=window.grecaptcha;ly(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(d=>{o(d)}).catch(()=>{o(PS)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((a,o)=>{r(this.auth).then(c=>{if(!n&&ly(window.grecaptcha))s(c,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=CS();u.length!==0&&(u+=c),cb(u).then(()=>{s(c,a,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function fy(t,e,n,r=!1){const s=new RS(t);let a;try{a=await s.verify(n)}catch{a=await s.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Ch(t,e,n,r){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await fy(t,e,n,n==="getOobCode");return r(t,a)}else return r(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await fy(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DS(t,e){const n=fo(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),a=n.getOptions();if(dc(a,e??{}))return s;vn(s,"already-initialized")}return n.initialize({options:e})}function MS(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Gn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function OS(t,e,n){const r=Is(t);ue(r._canInitEmulator,r,"emulator-config-failed"),ue(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,a=ub(e),{host:o,port:c}=LS(e),u=c===null?"":`:${c}`;r.config.emulator={url:`${a}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})}),VS()}function ub(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function LS(t){const e=ub(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const a=s[1];return{host:a,port:py(r.substr(a.length+1))}}else{const[a,o]=r.split(":");return{host:a,port:py(o)}}}function py(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function VS(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return qn("not implemented")}_getIdTokenResponse(e){return qn("not implemented")}_linkToIdToken(e,n){return qn("not implemented")}_getReauthenticationResolver(e){return qn("not implemented")}}async function US(t,e){return On(t,"POST","/v1/accounts:update",e)}async function FS(t,e){return On(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BS(t,e){return go(t,"POST","/v1/accounts:signInWithPassword",cr(t,e))}async function $S(t,e){return On(t,"POST","/v1/accounts:sendOobCode",cr(t,e))}async function zS(t,e){return $S(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qS(t,e){return go(t,"POST","/v1/accounts:signInWithEmailLink",cr(t,e))}async function HS(t,e){return go(t,"POST","/v1/accounts:signInWithEmailLink",cr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa extends Qm{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Xa(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Xa(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ch(e,n,"signInWithPassword",BS);case"emailLink":return qS(e,{email:this._email,oobCode:this._password});default:vn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ch(e,r,"signUpPassword",FS);case"emailLink":return HS(e,{idToken:n,email:this._email,oobCode:this._password});default:vn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ci(t,e){return go(t,"POST","/v1/accounts:signInWithIdp",cr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS="http://localhost";class bs extends Qm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new bs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):vn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,a=qm(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new bs(r,s);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ci(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ci(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ci(e,n)}buildRequest(){const e={requestUri:GS,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=mo(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WS(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function KS(t){const e=ha(ma(t)).link,n=e?ha(ma(e)).deep_link_id:null,r=ha(ma(t)).deep_link_id;return(r?ha(ma(r)).link:null)||r||n||e||t}class Ym{constructor(e){var n,r,s,a,o,c;const u=ha(ma(e)),d=(n=u.apiKey)!==null&&n!==void 0?n:null,m=(r=u.oobCode)!==null&&r!==void 0?r:null,g=WS((s=u.mode)!==null&&s!==void 0?s:null);ue(d&&m&&g,"argument-error"),this.apiKey=d,this.operation=g,this.code=m,this.continueUrl=(a=u.continueUrl)!==null&&a!==void 0?a:null,this.languageCode=(o=u.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(c=u.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){const n=KS(e);try{return new Ym(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(){this.providerId=Pi.PROVIDER_ID}static credential(e,n){return Xa._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Ym.parseLink(n);return ue(r,"argument-error"),Xa._fromEmailAndCode(e,r.code,r.tenantId)}}Pi.PROVIDER_ID="password";Pi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Pi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo extends db{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br extends yo{constructor(){super("facebook.com")}static credential(e){return bs._fromParams({providerId:br.PROVIDER_ID,signInMethod:br.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return br.credentialFromTaggedObject(e)}static credentialFromError(e){return br.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return br.credential(e.oauthAccessToken)}catch{return null}}}br.FACEBOOK_SIGN_IN_METHOD="facebook.com";br.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr extends yo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return bs._fromParams({providerId:wr.PROVIDER_ID,signInMethod:wr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return wr.credentialFromTaggedObject(e)}static credentialFromError(e){return wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return wr.credential(n,r)}catch{return null}}}wr.GOOGLE_SIGN_IN_METHOD="google.com";wr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r extends yo{constructor(){super("github.com")}static credential(e){return bs._fromParams({providerId:_r.PROVIDER_ID,signInMethod:_r.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _r.credentialFromTaggedObject(e)}static credentialFromError(e){return _r.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _r.credential(e.oauthAccessToken)}catch{return null}}}_r.GITHUB_SIGN_IN_METHOD="github.com";_r.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr extends yo{constructor(){super("twitter.com")}static credential(e,n){return bs._fromParams({providerId:Nr.PROVIDER_ID,signInMethod:Nr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Nr.credentialFromTaggedObject(e)}static credentialFromError(e){return Nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Nr.credential(n,r)}catch{return null}}}Nr.TWITTER_SIGN_IN_METHOD="twitter.com";Nr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QS(t,e){return go(t,"POST","/v1/accounts:signUp",cr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const a=await Hn._fromIdTokenResponse(e,r,s),o=gy(r);return new ws({user:a,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=gy(r);return new ws({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function gy(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc extends Mn{constructor(e,n,r,s){var a;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,pc.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new pc(e,n,r,s)}}function hb(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?pc._fromErrorAndOperation(t,a,e,r):a})}async function YS(t,e,n=!1){const r=await vi(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ws._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XS(t,e,n=!1){const{auth:r}=t;if(En(r.app))return Promise.reject(Kn(r));const s="reauthenticate";try{const a=await vi(t,hb(r,s,e,t),n);ue(a.idToken,r,"internal-error");const o=Wm(a.idToken);ue(o,r,"internal-error");const{sub:c}=o;return ue(t.uid===c,r,"user-mismatch"),ws._forOperation(t,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&vn(r,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mb(t,e,n=!1){if(En(t.app))return Promise.reject(Kn(t));const r="signIn",s=await hb(t,r,e),a=await ws._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(a.user),a}async function JS(t,e){return mb(Is(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fb(t){const e=Is(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Xc(t,e,n){if(En(t.app))return Promise.reject(Kn(t));const r=Is(t),o=await Ch(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",QS).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&fb(t),u}),c=await ws._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function gc(t,e,n){return En(t.app)?Promise.reject(Kn(t)):JS(Ce(t),Pi.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&fb(t),r})}async function pb(t,e){const n=Ce(t),s={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:a}=await zS(n.auth,s);a!==t.email&&await t.reload()}function ZS(t,e){return e1(Ce(t),null,e)}async function e1(t,e,n){const{auth:r}=t,a={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(a.password=n);const o=await vi(t,US(r,a));await t._updateTokensIfNecessary(o,!0)}function t1(t,e,n,r){return Ce(t).onIdTokenChanged(e,n,r)}function n1(t,e,n){return Ce(t).beforeAuthStateChanged(e,n)}function r1(t,e,n,r){return Ce(t).onAuthStateChanged(e,n,r)}function ls(t){return Ce(t).signOut()}const yc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gb{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(yc,"1"),this.storage.removeItem(yc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s1=1e3,i1=10;class yb extends gb{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ob(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},a=this.storage.getItem(r);wS()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,i1):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},s1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}yb.type="LOCAL";const a1=yb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb extends gb{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}xb.type="SESSION";const vb=xb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o1(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Jc(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:a}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(o).map(async d=>d(n.origin,a)),u=await o1(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Jc.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xm(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,o;return new Promise((c,u)=>{const d=Xm("",20);s.port1.start();const m=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(g){const y=g;if(y.data.eventId===d)switch(y.data.status){case"ack":clearTimeout(m),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(y.data.response);break;default:clearTimeout(m),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function In(){return window}function c1(t){In().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bb(){return typeof In().WorkerGlobalScope<"u"&&typeof In().importScripts=="function"}async function u1(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function d1(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function h1(){return bb()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wb="firebaseLocalStorageDb",m1=1,xc="firebaseLocalStorage",_b="fbase_key";class xo{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Zc(t,e){return t.transaction([xc],e?"readwrite":"readonly").objectStore(xc)}function f1(){const t=indexedDB.deleteDatabase(wb);return new xo(t).toPromise()}function Ih(){const t=indexedDB.open(wb,m1);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(xc,{keyPath:_b})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(xc)?e(r):(r.close(),await f1(),e(await Ih()))})})}async function yy(t,e,n){const r=Zc(t,!0).put({[_b]:e,value:n});return new xo(r).toPromise()}async function p1(t,e){const n=Zc(t,!1).get(e),r=await new xo(n).toPromise();return r===void 0?null:r.value}function xy(t,e){const n=Zc(t,!0).delete(e);return new xo(n).toPromise()}const g1=800,y1=3;class Nb{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ih(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>y1)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return bb()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Jc._getInstance(h1()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await u1(),!this.activeServiceWorker)return;this.sender=new l1(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||d1()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ih();return await yy(e,yc,"1"),await xy(e,yc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>yy(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>p1(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>xy(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=Zc(s,!1).getAll();return new xo(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),g1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Nb.type="LOCAL";const x1=Nb;new po(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v1(t,e){return e?Gn(e):(ue(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm extends Qm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ci(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ci(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ci(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function b1(t){return mb(t.auth,new Jm(t),t.bypassAuthState)}function w1(t){const{auth:e,user:n}=t;return ue(n,e,"internal-error"),XS(n,new Jm(t),t.bypassAuthState)}async function _1(t){const{auth:e,user:n}=t;return ue(n,e,"internal-error"),YS(n,new Jm(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eb{constructor(e,n,r,s,a=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:a,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return b1;case"linkViaPopup":case"linkViaRedirect":return _1;case"reauthViaPopup":case"reauthViaRedirect":return w1;default:vn(this.auth,"internal-error")}}resolve(e){rr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){rr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N1=new po(2e3,1e4);class ei extends Eb{constructor(e,n,r,s,a){super(e,n,s,a),this.provider=r,this.authWindow=null,this.pollId=null,ei.currentPopupAction&&ei.currentPopupAction.cancel(),ei.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ue(e,this.auth,"internal-error"),e}async onExecution(){rr(this.filter.length===1,"Popup operations only handle one event");const e=Xm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Cn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Cn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ei.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Cn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,N1.get())};e()}}ei.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1="pendingRedirect",Pl=new Map;class T1 extends Eb{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Pl.get(this.auth._key());if(!e){try{const r=await j1(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Pl.set(this.auth._key(),e)}return this.bypassAuthState||Pl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function j1(t,e){const n=I1(e),r=C1(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function S1(t,e){Pl.set(t._key(),e)}function C1(t){return Gn(t._redirectPersistence)}function I1(t){return kl(E1,t.config.apiKey,t.name)}async function A1(t,e,n=!1){if(En(t.app))return Promise.reject(Kn(t));const r=Is(t),s=v1(r,e),o=await new T1(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1=10*60*1e3;class P1{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!R1(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Tb(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Cn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=k1&&this.cachedEventUids.clear(),this.cachedEventUids.has(vy(e))}saveEventToCache(e){this.cachedEventUids.add(vy(e)),this.lastProcessedEventTime=Date.now()}}function vy(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Tb({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function R1(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Tb(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D1(t,e={}){return On(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,O1=/^https?/;async function L1(t){if(t.config.emulator)return;const{authorizedDomains:e}=await D1(t);for(const n of e)try{if(V1(n))return}catch{}vn(t,"unauthorized-domain")}function V1(t){const e=jh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!O1.test(n))return!1;if(M1.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U1=new po(3e4,6e4);function by(){const t=In().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function F1(t){return new Promise((e,n)=>{var r,s,a;function o(){by(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{by(),n(Cn(t,"network-request-failed"))},timeout:U1.get()})}if(!((s=(r=In().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((a=In().gapi)===null||a===void 0)&&a.load)o();else{const c=AS("iframefcb");return In()[c]=()=>{gapi.load?o():n(Cn(t,"network-request-failed"))},cb(`${IS()}?onload=${c}`).catch(u=>n(u))}}).catch(e=>{throw Rl=null,e})}let Rl=null;function B1(t){return Rl=Rl||F1(t),Rl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $1=new po(5e3,15e3),z1="__/auth/iframe",q1="emulator/auth/iframe",H1={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},G1=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function W1(t){const e=t.config;ue(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Gm(e,q1):`https://${t.config.authDomain}/${z1}`,r={apiKey:e.apiKey,appName:t.name,v:Cs},s=G1.get(t.config.apiHost);s&&(r.eid=s);const a=t._getFrameworks();return a.length&&(r.fw=a.join(",")),`${n}?${mo(r).slice(1)}`}async function K1(t){const e=await B1(t),n=In().gapi;return ue(n,t,"internal-error"),e.open({where:document.body,url:W1(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:H1,dontclear:!0},r=>new Promise(async(s,a)=>{await r.restyle({setHideOnLeave:!1});const o=Cn(t,"network-request-failed"),c=In().setTimeout(()=>{a(o)},$1.get());function u(){In().clearTimeout(c),s(r)}r.ping(u).then(u,()=>{a(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q1={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Y1=500,X1=600,J1="_blank",Z1="http://localhost";class wy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function eC(t,e,n,r=Y1,s=X1){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},Q1),{width:r.toString(),height:s.toString(),top:a,left:o}),d=Tt().toLowerCase();n&&(c=nb(d)?J1:n),eb(d)&&(e=e||Z1,u.scrollbars="yes");const m=Object.entries(u).reduce((y,[x,S])=>`${y}${x}=${S},`,"");if(bS(d)&&c!=="_self")return tC(e||"",c),new wy(null);const g=window.open(e||"",c,m);ue(g,t,"popup-blocked");try{g.focus()}catch{}return new wy(g)}function tC(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nC="__/auth/handler",rC="emulator/auth/handler",sC=encodeURIComponent("fac");async function _y(t,e,n,r,s,a){ue(t.config.authDomain,t,"auth-domain-config-required"),ue(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Cs,eventId:s};if(e instanceof db){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",qT(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,g]of Object.entries({}))o[m]=g}if(e instanceof yo){const m=e.getScopes().filter(g=>g!=="");m.length>0&&(o.scopes=m.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const m of Object.keys(c))c[m]===void 0&&delete c[m];const u=await t._getAppCheckToken(),d=u?`#${sC}=${encodeURIComponent(u)}`:"";return`${iC(t)}?${mo(c).slice(1)}${d}`}function iC({config:t}){return t.emulator?Gm(t,rC):`https://${t.authDomain}/${nC}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bd="webStorageSupport";class aC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vb,this._completeRedirectFn=A1,this._overrideRedirectResult=S1}async _openPopup(e,n,r,s){var a;rr((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const o=await _y(e,n,r,jh(),s);return eC(e,o,Xm())}async _openRedirect(e,n,r,s){await this._originValidation(e);const a=await _y(e,n,r,jh(),s);return c1(a),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:a}=this.eventManagers[n];return s?Promise.resolve(s):(rr(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await K1(e),r=new P1(e);return n.register("authEvent",s=>(ue(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(bd,{type:bd},s=>{var a;const o=(a=s==null?void 0:s[0])===null||a===void 0?void 0:a[bd];o!==void 0&&n(!!o),vn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=L1(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return ob()||tb()||Km()}}const oC=aC;var Ny="@firebase/auth",Ey="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ue(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cC(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function uC(t){$r(new tr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;ue(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:lb(t)},d=new jS(r,s,a,u);return MS(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),$r(new tr("auth-internal",e=>{const n=Is(e.getProvider("auth").getImmediate());return(r=>new lC(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),rn(Ny,Ey,cC(t)),rn(Ny,Ey,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC=5*60,hC=Vv("authIdTokenMaxAge")||dC;let Ty=null;const mC=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>hC)return;const s=n==null?void 0:n.token;Ty!==s&&(Ty=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function fC(t=Qc()){const e=fo(t,"auth");if(e.isInitialized())return e.getImmediate();const n=DS(t,{popupRedirectResolver:oC,persistence:[x1,a1,vb]}),r=Vv("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const o=mC(a.toString());n1(n,o,()=>o(n.currentUser)),t1(n,c=>o(c))}}const s=Ov("auth");return s&&OS(n,`http://${s}`),n}function pC(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}SS({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const a=Cn("internal-error");a.customData=s,n(a)},r.type="text/javascript",r.charset="UTF-8",pC().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});uC("Browser");var jy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var hs,jb;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,b){function C(){}C.prototype=b.prototype,I.D=b.prototype,I.prototype=new C,I.prototype.constructor=I,I.C=function(p,k,w){for(var N=Array(arguments.length-2),$=2;$<arguments.length;$++)N[$-2]=arguments[$];return b.prototype[k].apply(p,N)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,b,C){C||(C=0);var p=Array(16);if(typeof b=="string")for(var k=0;16>k;++k)p[k]=b.charCodeAt(C++)|b.charCodeAt(C++)<<8|b.charCodeAt(C++)<<16|b.charCodeAt(C++)<<24;else for(k=0;16>k;++k)p[k]=b[C++]|b[C++]<<8|b[C++]<<16|b[C++]<<24;b=I.g[0],C=I.g[1],k=I.g[2];var w=I.g[3],N=b+(w^C&(k^w))+p[0]+3614090360&4294967295;b=C+(N<<7&4294967295|N>>>25),N=w+(k^b&(C^k))+p[1]+3905402710&4294967295,w=b+(N<<12&4294967295|N>>>20),N=k+(C^w&(b^C))+p[2]+606105819&4294967295,k=w+(N<<17&4294967295|N>>>15),N=C+(b^k&(w^b))+p[3]+3250441966&4294967295,C=k+(N<<22&4294967295|N>>>10),N=b+(w^C&(k^w))+p[4]+4118548399&4294967295,b=C+(N<<7&4294967295|N>>>25),N=w+(k^b&(C^k))+p[5]+1200080426&4294967295,w=b+(N<<12&4294967295|N>>>20),N=k+(C^w&(b^C))+p[6]+2821735955&4294967295,k=w+(N<<17&4294967295|N>>>15),N=C+(b^k&(w^b))+p[7]+4249261313&4294967295,C=k+(N<<22&4294967295|N>>>10),N=b+(w^C&(k^w))+p[8]+1770035416&4294967295,b=C+(N<<7&4294967295|N>>>25),N=w+(k^b&(C^k))+p[9]+2336552879&4294967295,w=b+(N<<12&4294967295|N>>>20),N=k+(C^w&(b^C))+p[10]+4294925233&4294967295,k=w+(N<<17&4294967295|N>>>15),N=C+(b^k&(w^b))+p[11]+2304563134&4294967295,C=k+(N<<22&4294967295|N>>>10),N=b+(w^C&(k^w))+p[12]+1804603682&4294967295,b=C+(N<<7&4294967295|N>>>25),N=w+(k^b&(C^k))+p[13]+4254626195&4294967295,w=b+(N<<12&4294967295|N>>>20),N=k+(C^w&(b^C))+p[14]+2792965006&4294967295,k=w+(N<<17&4294967295|N>>>15),N=C+(b^k&(w^b))+p[15]+1236535329&4294967295,C=k+(N<<22&4294967295|N>>>10),N=b+(k^w&(C^k))+p[1]+4129170786&4294967295,b=C+(N<<5&4294967295|N>>>27),N=w+(C^k&(b^C))+p[6]+3225465664&4294967295,w=b+(N<<9&4294967295|N>>>23),N=k+(b^C&(w^b))+p[11]+643717713&4294967295,k=w+(N<<14&4294967295|N>>>18),N=C+(w^b&(k^w))+p[0]+3921069994&4294967295,C=k+(N<<20&4294967295|N>>>12),N=b+(k^w&(C^k))+p[5]+3593408605&4294967295,b=C+(N<<5&4294967295|N>>>27),N=w+(C^k&(b^C))+p[10]+38016083&4294967295,w=b+(N<<9&4294967295|N>>>23),N=k+(b^C&(w^b))+p[15]+3634488961&4294967295,k=w+(N<<14&4294967295|N>>>18),N=C+(w^b&(k^w))+p[4]+3889429448&4294967295,C=k+(N<<20&4294967295|N>>>12),N=b+(k^w&(C^k))+p[9]+568446438&4294967295,b=C+(N<<5&4294967295|N>>>27),N=w+(C^k&(b^C))+p[14]+3275163606&4294967295,w=b+(N<<9&4294967295|N>>>23),N=k+(b^C&(w^b))+p[3]+4107603335&4294967295,k=w+(N<<14&4294967295|N>>>18),N=C+(w^b&(k^w))+p[8]+1163531501&4294967295,C=k+(N<<20&4294967295|N>>>12),N=b+(k^w&(C^k))+p[13]+2850285829&4294967295,b=C+(N<<5&4294967295|N>>>27),N=w+(C^k&(b^C))+p[2]+4243563512&4294967295,w=b+(N<<9&4294967295|N>>>23),N=k+(b^C&(w^b))+p[7]+1735328473&4294967295,k=w+(N<<14&4294967295|N>>>18),N=C+(w^b&(k^w))+p[12]+2368359562&4294967295,C=k+(N<<20&4294967295|N>>>12),N=b+(C^k^w)+p[5]+4294588738&4294967295,b=C+(N<<4&4294967295|N>>>28),N=w+(b^C^k)+p[8]+2272392833&4294967295,w=b+(N<<11&4294967295|N>>>21),N=k+(w^b^C)+p[11]+1839030562&4294967295,k=w+(N<<16&4294967295|N>>>16),N=C+(k^w^b)+p[14]+4259657740&4294967295,C=k+(N<<23&4294967295|N>>>9),N=b+(C^k^w)+p[1]+2763975236&4294967295,b=C+(N<<4&4294967295|N>>>28),N=w+(b^C^k)+p[4]+1272893353&4294967295,w=b+(N<<11&4294967295|N>>>21),N=k+(w^b^C)+p[7]+4139469664&4294967295,k=w+(N<<16&4294967295|N>>>16),N=C+(k^w^b)+p[10]+3200236656&4294967295,C=k+(N<<23&4294967295|N>>>9),N=b+(C^k^w)+p[13]+681279174&4294967295,b=C+(N<<4&4294967295|N>>>28),N=w+(b^C^k)+p[0]+3936430074&4294967295,w=b+(N<<11&4294967295|N>>>21),N=k+(w^b^C)+p[3]+3572445317&4294967295,k=w+(N<<16&4294967295|N>>>16),N=C+(k^w^b)+p[6]+76029189&4294967295,C=k+(N<<23&4294967295|N>>>9),N=b+(C^k^w)+p[9]+3654602809&4294967295,b=C+(N<<4&4294967295|N>>>28),N=w+(b^C^k)+p[12]+3873151461&4294967295,w=b+(N<<11&4294967295|N>>>21),N=k+(w^b^C)+p[15]+530742520&4294967295,k=w+(N<<16&4294967295|N>>>16),N=C+(k^w^b)+p[2]+3299628645&4294967295,C=k+(N<<23&4294967295|N>>>9),N=b+(k^(C|~w))+p[0]+4096336452&4294967295,b=C+(N<<6&4294967295|N>>>26),N=w+(C^(b|~k))+p[7]+1126891415&4294967295,w=b+(N<<10&4294967295|N>>>22),N=k+(b^(w|~C))+p[14]+2878612391&4294967295,k=w+(N<<15&4294967295|N>>>17),N=C+(w^(k|~b))+p[5]+4237533241&4294967295,C=k+(N<<21&4294967295|N>>>11),N=b+(k^(C|~w))+p[12]+1700485571&4294967295,b=C+(N<<6&4294967295|N>>>26),N=w+(C^(b|~k))+p[3]+2399980690&4294967295,w=b+(N<<10&4294967295|N>>>22),N=k+(b^(w|~C))+p[10]+4293915773&4294967295,k=w+(N<<15&4294967295|N>>>17),N=C+(w^(k|~b))+p[1]+2240044497&4294967295,C=k+(N<<21&4294967295|N>>>11),N=b+(k^(C|~w))+p[8]+1873313359&4294967295,b=C+(N<<6&4294967295|N>>>26),N=w+(C^(b|~k))+p[15]+4264355552&4294967295,w=b+(N<<10&4294967295|N>>>22),N=k+(b^(w|~C))+p[6]+2734768916&4294967295,k=w+(N<<15&4294967295|N>>>17),N=C+(w^(k|~b))+p[13]+1309151649&4294967295,C=k+(N<<21&4294967295|N>>>11),N=b+(k^(C|~w))+p[4]+4149444226&4294967295,b=C+(N<<6&4294967295|N>>>26),N=w+(C^(b|~k))+p[11]+3174756917&4294967295,w=b+(N<<10&4294967295|N>>>22),N=k+(b^(w|~C))+p[2]+718787259&4294967295,k=w+(N<<15&4294967295|N>>>17),N=C+(w^(k|~b))+p[9]+3951481745&4294967295,I.g[0]=I.g[0]+b&4294967295,I.g[1]=I.g[1]+(k+(N<<21&4294967295|N>>>11))&4294967295,I.g[2]=I.g[2]+k&4294967295,I.g[3]=I.g[3]+w&4294967295}r.prototype.u=function(I,b){b===void 0&&(b=I.length);for(var C=b-this.blockSize,p=this.B,k=this.h,w=0;w<b;){if(k==0)for(;w<=C;)s(this,I,w),w+=this.blockSize;if(typeof I=="string"){for(;w<b;)if(p[k++]=I.charCodeAt(w++),k==this.blockSize){s(this,p),k=0;break}}else for(;w<b;)if(p[k++]=I[w++],k==this.blockSize){s(this,p),k=0;break}}this.h=k,this.o+=b},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var b=1;b<I.length-8;++b)I[b]=0;var C=8*this.o;for(b=I.length-8;b<I.length;++b)I[b]=C&255,C/=256;for(this.u(I),I=Array(16),b=C=0;4>b;++b)for(var p=0;32>p;p+=8)I[C++]=this.g[b]>>>p&255;return I};function a(I,b){var C=c;return Object.prototype.hasOwnProperty.call(C,I)?C[I]:C[I]=b(I)}function o(I,b){this.h=b;for(var C=[],p=!0,k=I.length-1;0<=k;k--){var w=I[k]|0;p&&w==b||(C[k]=w,p=!1)}this.g=C}var c={};function u(I){return-128<=I&&128>I?a(I,function(b){return new o([b|0],0>b?-1:0)}):new o([I|0],0>I?-1:0)}function d(I){if(isNaN(I)||!isFinite(I))return g;if(0>I)return P(d(-I));for(var b=[],C=1,p=0;I>=C;p++)b[p]=I/C|0,C*=4294967296;return new o(b,0)}function m(I,b){if(I.length==0)throw Error("number format error: empty string");if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(I.charAt(0)=="-")return P(m(I.substring(1),b));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=d(Math.pow(b,8)),p=g,k=0;k<I.length;k+=8){var w=Math.min(8,I.length-k),N=parseInt(I.substring(k,k+w),b);8>w?(w=d(Math.pow(b,w)),p=p.j(w).add(d(N))):(p=p.j(C),p=p.add(d(N)))}return p}var g=u(0),y=u(1),x=u(16777216);t=o.prototype,t.m=function(){if(E(this))return-P(this).m();for(var I=0,b=1,C=0;C<this.g.length;C++){var p=this.i(C);I+=(0<=p?p:4294967296+p)*b,b*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(S(this))return"0";if(E(this))return"-"+P(this).toString(I);for(var b=d(Math.pow(I,6)),C=this,p="";;){var k=M(C,b).g;C=T(C,k.j(b));var w=((0<C.g.length?C.g[0]:C.h)>>>0).toString(I);if(C=k,S(C))return w+p;for(;6>w.length;)w="0"+w;p=w+p}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function S(I){if(I.h!=0)return!1;for(var b=0;b<I.g.length;b++)if(I.g[b]!=0)return!1;return!0}function E(I){return I.h==-1}t.l=function(I){return I=T(this,I),E(I)?-1:S(I)?0:1};function P(I){for(var b=I.g.length,C=[],p=0;p<b;p++)C[p]=~I.g[p];return new o(C,~I.h).add(y)}t.abs=function(){return E(this)?P(this):this},t.add=function(I){for(var b=Math.max(this.g.length,I.g.length),C=[],p=0,k=0;k<=b;k++){var w=p+(this.i(k)&65535)+(I.i(k)&65535),N=(w>>>16)+(this.i(k)>>>16)+(I.i(k)>>>16);p=N>>>16,w&=65535,N&=65535,C[k]=N<<16|w}return new o(C,C[C.length-1]&-2147483648?-1:0)};function T(I,b){return I.add(P(b))}t.j=function(I){if(S(this)||S(I))return g;if(E(this))return E(I)?P(this).j(P(I)):P(P(this).j(I));if(E(I))return P(this.j(P(I)));if(0>this.l(x)&&0>I.l(x))return d(this.m()*I.m());for(var b=this.g.length+I.g.length,C=[],p=0;p<2*b;p++)C[p]=0;for(p=0;p<this.g.length;p++)for(var k=0;k<I.g.length;k++){var w=this.i(p)>>>16,N=this.i(p)&65535,$=I.i(k)>>>16,D=I.i(k)&65535;C[2*p+2*k]+=N*D,j(C,2*p+2*k),C[2*p+2*k+1]+=w*D,j(C,2*p+2*k+1),C[2*p+2*k+1]+=N*$,j(C,2*p+2*k+1),C[2*p+2*k+2]+=w*$,j(C,2*p+2*k+2)}for(p=0;p<b;p++)C[p]=C[2*p+1]<<16|C[2*p];for(p=b;p<2*b;p++)C[p]=0;return new o(C,0)};function j(I,b){for(;(I[b]&65535)!=I[b];)I[b+1]+=I[b]>>>16,I[b]&=65535,b++}function R(I,b){this.g=I,this.h=b}function M(I,b){if(S(b))throw Error("division by zero");if(S(I))return new R(g,g);if(E(I))return b=M(P(I),b),new R(P(b.g),P(b.h));if(E(b))return b=M(I,P(b)),new R(P(b.g),b.h);if(30<I.g.length){if(E(I)||E(b))throw Error("slowDivide_ only works with positive integers.");for(var C=y,p=b;0>=p.l(I);)C=q(C),p=q(p);var k=z(C,1),w=z(p,1);for(p=z(p,2),C=z(C,2);!S(p);){var N=w.add(p);0>=N.l(I)&&(k=k.add(C),w=N),p=z(p,1),C=z(C,1)}return b=T(I,k.j(b)),new R(k,b)}for(k=g;0<=I.l(b);){for(C=Math.max(1,Math.floor(I.m()/b.m())),p=Math.ceil(Math.log(C)/Math.LN2),p=48>=p?1:Math.pow(2,p-48),w=d(C),N=w.j(b);E(N)||0<N.l(I);)C-=p,w=d(C),N=w.j(b);S(w)&&(w=y),k=k.add(w),I=T(I,N)}return new R(k,I)}t.A=function(I){return M(this,I).h},t.and=function(I){for(var b=Math.max(this.g.length,I.g.length),C=[],p=0;p<b;p++)C[p]=this.i(p)&I.i(p);return new o(C,this.h&I.h)},t.or=function(I){for(var b=Math.max(this.g.length,I.g.length),C=[],p=0;p<b;p++)C[p]=this.i(p)|I.i(p);return new o(C,this.h|I.h)},t.xor=function(I){for(var b=Math.max(this.g.length,I.g.length),C=[],p=0;p<b;p++)C[p]=this.i(p)^I.i(p);return new o(C,this.h^I.h)};function q(I){for(var b=I.g.length+1,C=[],p=0;p<b;p++)C[p]=I.i(p)<<1|I.i(p-1)>>>31;return new o(C,I.h)}function z(I,b){var C=b>>5;b%=32;for(var p=I.g.length-C,k=[],w=0;w<p;w++)k[w]=0<b?I.i(w+C)>>>b|I.i(w+C+1)<<32-b:I.i(w+C);return new o(k,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,jb=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=m,hs=o}).apply(typeof jy<"u"?jy:typeof self<"u"?self:typeof window<"u"?window:{});var hl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Sb,fa,Cb,Dl,Ah,Ib,Ab,kb;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,f){return l==Array.prototype||l==Object.prototype||(l[h]=f.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof hl=="object"&&hl];for(var h=0;h<l.length;++h){var f=l[h];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(l,h){if(h)e:{var f=r;l=l.split(".");for(var _=0;_<l.length-1;_++){var B=l[_];if(!(B in f))break e;f=f[B]}l=l[l.length-1],_=f[l],h=h(_),h!=_&&h!=null&&e(f,l,{configurable:!0,writable:!0,value:h})}}function a(l,h){l instanceof String&&(l+="");var f=0,_=!1,B={next:function(){if(!_&&f<l.length){var H=f++;return{value:h(H,l[H]),done:!1}}return _=!0,{done:!0,value:void 0}}};return B[Symbol.iterator]=function(){return B},B}s("Array.prototype.values",function(l){return l||function(){return a(this,function(h,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function u(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function d(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function m(l,h,f){return l.call.apply(l.bind,arguments)}function g(l,h,f){if(!l)throw Error();if(2<arguments.length){var _=Array.prototype.slice.call(arguments,2);return function(){var B=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(B,_),l.apply(h,B)}}return function(){return l.apply(h,arguments)}}function y(l,h,f){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:g,y.apply(null,arguments)}function x(l,h){var f=Array.prototype.slice.call(arguments,1);return function(){var _=f.slice();return _.push.apply(_,arguments),l.apply(this,_)}}function S(l,h){function f(){}f.prototype=h.prototype,l.aa=h.prototype,l.prototype=new f,l.prototype.constructor=l,l.Qb=function(_,B,H){for(var ne=Array(arguments.length-2),Se=2;Se<arguments.length;Se++)ne[Se-2]=arguments[Se];return h.prototype[B].apply(_,ne)}}function E(l){const h=l.length;if(0<h){const f=Array(h);for(let _=0;_<h;_++)f[_]=l[_];return f}return[]}function P(l,h){for(let f=1;f<arguments.length;f++){const _=arguments[f];if(u(_)){const B=l.length||0,H=_.length||0;l.length=B+H;for(let ne=0;ne<H;ne++)l[B+ne]=_[ne]}else l.push(_)}}class T{constructor(h,f){this.i=h,this.j=f,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function j(l){return/^[\s\xa0]*$/.test(l)}function R(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function M(l){return M[" "](l),l}M[" "]=function(){};var q=R().indexOf("Gecko")!=-1&&!(R().toLowerCase().indexOf("webkit")!=-1&&R().indexOf("Edge")==-1)&&!(R().indexOf("Trident")!=-1||R().indexOf("MSIE")!=-1)&&R().indexOf("Edge")==-1;function z(l,h,f){for(const _ in l)h.call(f,l[_],_,l)}function I(l,h){for(const f in l)h.call(void 0,l[f],f,l)}function b(l){const h={};for(const f in l)h[f]=l[f];return h}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function p(l,h){let f,_;for(let B=1;B<arguments.length;B++){_=arguments[B];for(f in _)l[f]=_[f];for(let H=0;H<C.length;H++)f=C[H],Object.prototype.hasOwnProperty.call(_,f)&&(l[f]=_[f])}}function k(l){var h=1;l=l.split(":");const f=[];for(;0<h&&l.length;)f.push(l.shift()),h--;return l.length&&f.push(l.join(":")),f}function w(l){c.setTimeout(()=>{throw l},0)}function N(){var l=A;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class ${constructor(){this.h=this.g=null}add(h,f){const _=D.get();_.set(h,f),this.h?this.h.next=_:this.g=_,this.h=_}}var D=new T(()=>new V,l=>l.reset());class V{constructor(){this.next=this.g=this.h=null}set(h,f){this.h=h,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let O,v=!1,A=new $,F=()=>{const l=c.Promise.resolve(void 0);O=()=>{l.then(K)}};var K=()=>{for(var l;l=N();){try{l.h.call(l.g)}catch(f){w(f)}var h=D;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}v=!1};function G(){this.s=this.s,this.C=this.C}G.prototype.s=!1,G.prototype.ma=function(){this.s||(this.s=!0,this.N())},G.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Z(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}Z.prototype.h=function(){this.defaultPrevented=!0};var U=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const f=()=>{};c.addEventListener("test",f,h),c.removeEventListener("test",f,h)}catch{}return l}();function Q(l,h){if(Z.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var f=this.type=l.type,_=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(q){e:{try{M(h.nodeName);var B=!0;break e}catch{}B=!1}B||(h=null)}}else f=="mouseover"?h=l.fromElement:f=="mouseout"&&(h=l.toElement);this.relatedTarget=h,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:X[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&Q.aa.h.call(this)}}S(Q,Z);var X={2:"touch",3:"pen",4:"mouse"};Q.prototype.h=function(){Q.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var ae="closure_listenable_"+(1e6*Math.random()|0),Ne=0;function He(l,h,f,_,B){this.listener=l,this.proxy=null,this.src=h,this.type=f,this.capture=!!_,this.ha=B,this.key=++Ne,this.da=this.fa=!1}function je(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Rt(l){this.src=l,this.g={},this.h=0}Rt.prototype.add=function(l,h,f,_,B){var H=l.toString();l=this.g[H],l||(l=this.g[H]=[],this.h++);var ne=Ln(l,h,_,B);return-1<ne?(h=l[ne],f||(h.fa=!1)):(h=new He(h,this.src,H,!!_,B),h.fa=f,l.push(h)),h};function ln(l,h){var f=h.type;if(f in l.g){var _=l.g[f],B=Array.prototype.indexOf.call(_,h,void 0),H;(H=0<=B)&&Array.prototype.splice.call(_,B,1),H&&(je(h),l.g[f].length==0&&(delete l.g[f],l.h--))}}function Ln(l,h,f,_){for(var B=0;B<l.length;++B){var H=l[B];if(!H.da&&H.listener==h&&H.capture==!!f&&H.ha==_)return B}return-1}var cn="closure_lm_"+(1e6*Math.random()|0),un={};function Xr(l,h,f,_,B){if(Array.isArray(h)){for(var H=0;H<h.length;H++)Xr(l,h[H],f,_,B);return null}return f=Gf(f),l&&l[ae]?l.K(h,f,d(_)?!!_.capture:!1,B):mt(l,h,f,!1,_,B)}function mt(l,h,f,_,B,H){if(!h)throw Error("Invalid event type");var ne=d(B)?!!B.capture:!!B,Se=Eu(l);if(Se||(l[cn]=Se=new Rt(l)),f=Se.add(h,f,_,ne,H),f.proxy)return f;if(_=__(),f.proxy=_,_.src=l,_.listener=f,l.addEventListener)U||(B=ne),B===void 0&&(B=!1),l.addEventListener(h.toString(),_,B);else if(l.attachEvent)l.attachEvent(Hf(h.toString()),_);else if(l.addListener&&l.removeListener)l.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return f}function __(){function l(f){return h.call(l.src,l.listener,f)}const h=N_;return l}function qf(l,h,f,_,B){if(Array.isArray(h))for(var H=0;H<h.length;H++)qf(l,h[H],f,_,B);else _=d(_)?!!_.capture:!!_,f=Gf(f),l&&l[ae]?(l=l.i,h=String(h).toString(),h in l.g&&(H=l.g[h],f=Ln(H,f,_,B),-1<f&&(je(H[f]),Array.prototype.splice.call(H,f,1),H.length==0&&(delete l.g[h],l.h--)))):l&&(l=Eu(l))&&(h=l.g[h.toString()],l=-1,h&&(l=Ln(h,f,_,B)),(f=-1<l?h[l]:null)&&Nu(f))}function Nu(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[ae])ln(h.i,l);else{var f=l.type,_=l.proxy;h.removeEventListener?h.removeEventListener(f,_,l.capture):h.detachEvent?h.detachEvent(Hf(f),_):h.addListener&&h.removeListener&&h.removeListener(_),(f=Eu(h))?(ln(f,l),f.h==0&&(f.src=null,h[cn]=null)):je(l)}}}function Hf(l){return l in un?un[l]:un[l]="on"+l}function N_(l,h){if(l.da)l=!0;else{h=new Q(h,this);var f=l.listener,_=l.ha||l.src;l.fa&&Nu(l),l=f.call(_,h)}return l}function Eu(l){return l=l[cn],l instanceof Rt?l:null}var Tu="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gf(l){return typeof l=="function"?l:(l[Tu]||(l[Tu]=function(h){return l.handleEvent(h)}),l[Tu])}function ft(){G.call(this),this.i=new Rt(this),this.M=this,this.F=null}S(ft,G),ft.prototype[ae]=!0,ft.prototype.removeEventListener=function(l,h,f,_){qf(this,l,h,f,_)};function jt(l,h){var f,_=l.F;if(_)for(f=[];_;_=_.F)f.push(_);if(l=l.M,_=h.type||h,typeof h=="string")h=new Z(h,l);else if(h instanceof Z)h.target=h.target||l;else{var B=h;h=new Z(_,l),p(h,B)}if(B=!0,f)for(var H=f.length-1;0<=H;H--){var ne=h.g=f[H];B=Po(ne,_,!0,h)&&B}if(ne=h.g=l,B=Po(ne,_,!0,h)&&B,B=Po(ne,_,!1,h)&&B,f)for(H=0;H<f.length;H++)ne=h.g=f[H],B=Po(ne,_,!1,h)&&B}ft.prototype.N=function(){if(ft.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var f=l.g[h],_=0;_<f.length;_++)je(f[_]);delete l.g[h],l.h--}}this.F=null},ft.prototype.K=function(l,h,f,_){return this.i.add(String(l),h,!1,f,_)},ft.prototype.L=function(l,h,f,_){return this.i.add(String(l),h,!0,f,_)};function Po(l,h,f,_){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var B=!0,H=0;H<h.length;++H){var ne=h[H];if(ne&&!ne.da&&ne.capture==f){var Se=ne.listener,it=ne.ha||ne.src;ne.fa&&ln(l.i,ne),B=Se.call(it,_)!==!1&&B}}return B&&!_.defaultPrevented}function Wf(l,h,f){if(typeof l=="function")f&&(l=y(l,f));else if(l&&typeof l.handleEvent=="function")l=y(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:c.setTimeout(l,h||0)}function Kf(l){l.g=Wf(()=>{l.g=null,l.i&&(l.i=!1,Kf(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class E_ extends G{constructor(h,f){super(),this.m=h,this.l=f,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Kf(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ui(l){G.call(this),this.h=l,this.g={}}S(Ui,G);var Qf=[];function Yf(l){z(l.g,function(h,f){this.g.hasOwnProperty(f)&&Nu(h)},l),l.g={}}Ui.prototype.N=function(){Ui.aa.N.call(this),Yf(this)},Ui.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ju=c.JSON.stringify,T_=c.JSON.parse,j_=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function Su(){}Su.prototype.h=null;function Xf(l){return l.h||(l.h=l.i())}function Jf(){}var Fi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Cu(){Z.call(this,"d")}S(Cu,Z);function Iu(){Z.call(this,"c")}S(Iu,Z);var Jr={},Zf=null;function Ro(){return Zf=Zf||new ft}Jr.La="serverreachability";function ep(l){Z.call(this,Jr.La,l)}S(ep,Z);function Bi(l){const h=Ro();jt(h,new ep(h))}Jr.STAT_EVENT="statevent";function tp(l,h){Z.call(this,Jr.STAT_EVENT,l),this.stat=h}S(tp,Z);function St(l){const h=Ro();jt(h,new tp(h,l))}Jr.Ma="timingevent";function np(l,h){Z.call(this,Jr.Ma,l),this.size=h}S(np,Z);function $i(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},h)}function zi(){this.g=!0}zi.prototype.xa=function(){this.g=!1};function S_(l,h,f,_,B,H){l.info(function(){if(l.g)if(H)for(var ne="",Se=H.split("&"),it=0;it<Se.length;it++){var be=Se[it].split("=");if(1<be.length){var pt=be[0];be=be[1];var gt=pt.split("_");ne=2<=gt.length&&gt[1]=="type"?ne+(pt+"="+be+"&"):ne+(pt+"=redacted&")}}else ne=null;else ne=H;return"XMLHTTP REQ ("+_+") [attempt "+B+"]: "+h+`
`+f+`
`+ne})}function C_(l,h,f,_,B,H,ne){l.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+B+"]: "+h+`
`+f+`
`+H+" "+ne})}function Ps(l,h,f,_){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+A_(l,f)+(_?" "+_:"")})}function I_(l,h){l.info(function(){return"TIMEOUT: "+h})}zi.prototype.info=function(){};function A_(l,h){if(!l.g)return h;if(!h)return null;try{var f=JSON.parse(h);if(f){for(l=0;l<f.length;l++)if(Array.isArray(f[l])){var _=f[l];if(!(2>_.length)){var B=_[1];if(Array.isArray(B)&&!(1>B.length)){var H=B[0];if(H!="noop"&&H!="stop"&&H!="close")for(var ne=1;ne<B.length;ne++)B[ne]=""}}}}return ju(f)}catch{return h}}var Do={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},rp={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Au;function Mo(){}S(Mo,Su),Mo.prototype.g=function(){return new XMLHttpRequest},Mo.prototype.i=function(){return{}},Au=new Mo;function dr(l,h,f,_){this.j=l,this.i=h,this.l=f,this.R=_||1,this.U=new Ui(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new sp}function sp(){this.i=null,this.g="",this.h=!1}var ip={},ku={};function Pu(l,h,f){l.L=1,l.v=Uo(Vn(h)),l.m=f,l.P=!0,ap(l,null)}function ap(l,h){l.F=Date.now(),Oo(l),l.A=Vn(l.v);var f=l.A,_=l.R;Array.isArray(_)||(_=[String(_)]),bp(f.i,"t",_),l.C=0,f=l.j.J,l.h=new sp,l.g=Vp(l.j,f?h:null,!l.m),0<l.O&&(l.M=new E_(y(l.Y,l,l.g),l.O)),h=l.U,f=l.g,_=l.ca;var B="readystatechange";Array.isArray(B)||(B&&(Qf[0]=B.toString()),B=Qf);for(var H=0;H<B.length;H++){var ne=Xr(f,B[H],_||h.handleEvent,!1,h.h||h);if(!ne)break;h.g[ne.key]=ne}h=l.H?b(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),Bi(),S_(l.i,l.u,l.A,l.l,l.R,l.m)}dr.prototype.ca=function(l){l=l.target;const h=this.M;h&&Un(l)==3?h.j():this.Y(l)},dr.prototype.Y=function(l){try{if(l==this.g)e:{const gt=Un(this.g);var h=this.g.Ba();const Ms=this.g.Z();if(!(3>gt)&&(gt!=3||this.g&&(this.h.h||this.g.oa()||Sp(this.g)))){this.J||gt!=4||h==7||(h==8||0>=Ms?Bi(3):Bi(2)),Ru(this);var f=this.g.Z();this.X=f;t:if(op(this)){var _=Sp(this.g);l="";var B=_.length,H=Un(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Zr(this),qi(this);var ne="";break t}this.h.i=new c.TextDecoder}for(h=0;h<B;h++)this.h.h=!0,l+=this.h.i.decode(_[h],{stream:!(H&&h==B-1)});_.length=0,this.h.g+=l,this.C=0,ne=this.h.g}else ne=this.g.oa();if(this.o=f==200,C_(this.i,this.u,this.A,this.l,this.R,gt,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Se,it=this.g;if((Se=it.g?it.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(Se)){var be=Se;break t}}be=null}if(f=be)Ps(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Du(this,f);else{this.o=!1,this.s=3,St(12),Zr(this),qi(this);break e}}if(this.P){f=!0;let dn;for(;!this.J&&this.C<ne.length;)if(dn=k_(this,ne),dn==ku){gt==4&&(this.s=4,St(14),f=!1),Ps(this.i,this.l,null,"[Incomplete Response]");break}else if(dn==ip){this.s=4,St(15),Ps(this.i,this.l,ne,"[Invalid Chunk]"),f=!1;break}else Ps(this.i,this.l,dn,null),Du(this,dn);if(op(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),gt!=4||ne.length!=0||this.h.h||(this.s=1,St(16),f=!1),this.o=this.o&&f,!f)Ps(this.i,this.l,ne,"[Invalid Chunked Response]"),Zr(this),qi(this);else if(0<ne.length&&!this.W){this.W=!0;var pt=this.j;pt.g==this&&pt.ba&&!pt.M&&(pt.j.info("Great, no buffering proxy detected. Bytes received: "+ne.length),Fu(pt),pt.M=!0,St(11))}}else Ps(this.i,this.l,ne,null),Du(this,ne);gt==4&&Zr(this),this.o&&!this.J&&(gt==4?Dp(this.j,this):(this.o=!1,Oo(this)))}else K_(this.g),f==400&&0<ne.indexOf("Unknown SID")?(this.s=3,St(12)):(this.s=0,St(13)),Zr(this),qi(this)}}}catch{}finally{}};function op(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function k_(l,h){var f=l.C,_=h.indexOf(`
`,f);return _==-1?ku:(f=Number(h.substring(f,_)),isNaN(f)?ip:(_+=1,_+f>h.length?ku:(h=h.slice(_,_+f),l.C=_+f,h)))}dr.prototype.cancel=function(){this.J=!0,Zr(this)};function Oo(l){l.S=Date.now()+l.I,lp(l,l.I)}function lp(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=$i(y(l.ba,l),h)}function Ru(l){l.B&&(c.clearTimeout(l.B),l.B=null)}dr.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(I_(this.i,this.A),this.L!=2&&(Bi(),St(17)),Zr(this),this.s=2,qi(this)):lp(this,this.S-l)};function qi(l){l.j.G==0||l.J||Dp(l.j,l)}function Zr(l){Ru(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,Yf(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function Du(l,h){try{var f=l.j;if(f.G!=0&&(f.g==l||Mu(f.h,l))){if(!l.K&&Mu(f.h,l)&&f.G==3){try{var _=f.Da.g.parse(h)}catch{_=null}if(Array.isArray(_)&&_.length==3){var B=_;if(B[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<l.F)Ho(f),zo(f);else break e;Uu(f),St(18)}}else f.za=B[1],0<f.za-f.T&&37500>B[2]&&f.F&&f.v==0&&!f.C&&(f.C=$i(y(f.Za,f),6e3));if(1>=dp(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else ts(f,11)}else if((l.K||f.g==l)&&Ho(f),!j(h))for(B=f.Da.g.parse(h),h=0;h<B.length;h++){let be=B[h];if(f.T=be[0],be=be[1],f.G==2)if(be[0]=="c"){f.K=be[1],f.ia=be[2];const pt=be[3];pt!=null&&(f.la=pt,f.j.info("VER="+f.la));const gt=be[4];gt!=null&&(f.Aa=gt,f.j.info("SVER="+f.Aa));const Ms=be[5];Ms!=null&&typeof Ms=="number"&&0<Ms&&(_=1.5*Ms,f.L=_,f.j.info("backChannelRequestTimeoutMs_="+_)),_=f;const dn=l.g;if(dn){const Wo=dn.g?dn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Wo){var H=_.h;H.g||Wo.indexOf("spdy")==-1&&Wo.indexOf("quic")==-1&&Wo.indexOf("h2")==-1||(H.j=H.l,H.g=new Set,H.h&&(Ou(H,H.h),H.h=null))}if(_.D){const Bu=dn.g?dn.g.getResponseHeader("X-HTTP-Session-Id"):null;Bu&&(_.ya=Bu,ke(_.I,_.D,Bu))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-l.F,f.j.info("Handshake RTT: "+f.R+"ms")),_=f;var ne=l;if(_.qa=Lp(_,_.J?_.ia:null,_.W),ne.K){hp(_.h,ne);var Se=ne,it=_.L;it&&(Se.I=it),Se.B&&(Ru(Se),Oo(Se)),_.g=ne}else Pp(_);0<f.i.length&&qo(f)}else be[0]!="stop"&&be[0]!="close"||ts(f,7);else f.G==3&&(be[0]=="stop"||be[0]=="close"?be[0]=="stop"?ts(f,7):Vu(f):be[0]!="noop"&&f.l&&f.l.ta(be),f.v=0)}}Bi(4)}catch{}}var P_=class{constructor(l,h){this.g=l,this.map=h}};function cp(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function up(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function dp(l){return l.h?1:l.g?l.g.size:0}function Mu(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function Ou(l,h){l.g?l.g.add(h):l.h=h}function hp(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}cp.prototype.cancel=function(){if(this.i=mp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function mp(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const f of l.g.values())h=h.concat(f.D);return h}return E(l.i)}function R_(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var h=[],f=l.length,_=0;_<f;_++)h.push(l[_]);return h}h=[],f=0;for(_ in l)h[f++]=l[_];return h}function D_(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var h=[];l=l.length;for(var f=0;f<l;f++)h.push(f);return h}h=[],f=0;for(const _ in l)h[f++]=_;return h}}}function fp(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var f=D_(l),_=R_(l),B=_.length,H=0;H<B;H++)h.call(void 0,_[H],f&&f[H],l)}var pp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function M_(l,h){if(l){l=l.split("&");for(var f=0;f<l.length;f++){var _=l[f].indexOf("="),B=null;if(0<=_){var H=l[f].substring(0,_);B=l[f].substring(_+1)}else H=l[f];h(H,B?decodeURIComponent(B.replace(/\+/g," ")):"")}}}function es(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof es){this.h=l.h,Lo(this,l.j),this.o=l.o,this.g=l.g,Vo(this,l.s),this.l=l.l;var h=l.i,f=new Wi;f.i=h.i,h.g&&(f.g=new Map(h.g),f.h=h.h),gp(this,f),this.m=l.m}else l&&(h=String(l).match(pp))?(this.h=!1,Lo(this,h[1]||"",!0),this.o=Hi(h[2]||""),this.g=Hi(h[3]||"",!0),Vo(this,h[4]),this.l=Hi(h[5]||"",!0),gp(this,h[6]||"",!0),this.m=Hi(h[7]||"")):(this.h=!1,this.i=new Wi(null,this.h))}es.prototype.toString=function(){var l=[],h=this.j;h&&l.push(Gi(h,yp,!0),":");var f=this.g;return(f||h=="file")&&(l.push("//"),(h=this.o)&&l.push(Gi(h,yp,!0),"@"),l.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&l.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&l.push("/"),l.push(Gi(f,f.charAt(0)=="/"?V_:L_,!0))),(f=this.i.toString())&&l.push("?",f),(f=this.m)&&l.push("#",Gi(f,F_)),l.join("")};function Vn(l){return new es(l)}function Lo(l,h,f){l.j=f?Hi(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function Vo(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function gp(l,h,f){h instanceof Wi?(l.i=h,B_(l.i,l.h)):(f||(h=Gi(h,U_)),l.i=new Wi(h,l.h))}function ke(l,h,f){l.i.set(h,f)}function Uo(l){return ke(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Hi(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Gi(l,h,f){return typeof l=="string"?(l=encodeURI(l).replace(h,O_),f&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function O_(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var yp=/[#\/\?@]/g,L_=/[#\?:]/g,V_=/[#\?]/g,U_=/[#\?@]/g,F_=/#/g;function Wi(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function hr(l){l.g||(l.g=new Map,l.h=0,l.i&&M_(l.i,function(h,f){l.add(decodeURIComponent(h.replace(/\+/g," ")),f)}))}t=Wi.prototype,t.add=function(l,h){hr(this),this.i=null,l=Rs(this,l);var f=this.g.get(l);return f||this.g.set(l,f=[]),f.push(h),this.h+=1,this};function xp(l,h){hr(l),h=Rs(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function vp(l,h){return hr(l),h=Rs(l,h),l.g.has(h)}t.forEach=function(l,h){hr(this),this.g.forEach(function(f,_){f.forEach(function(B){l.call(h,B,_,this)},this)},this)},t.na=function(){hr(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),f=[];for(let _=0;_<h.length;_++){const B=l[_];for(let H=0;H<B.length;H++)f.push(h[_])}return f},t.V=function(l){hr(this);let h=[];if(typeof l=="string")vp(this,l)&&(h=h.concat(this.g.get(Rs(this,l))));else{l=Array.from(this.g.values());for(let f=0;f<l.length;f++)h=h.concat(l[f])}return h},t.set=function(l,h){return hr(this),this.i=null,l=Rs(this,l),vp(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function bp(l,h,f){xp(l,h),0<f.length&&(l.i=null,l.g.set(Rs(l,h),E(f)),l.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var f=0;f<h.length;f++){var _=h[f];const H=encodeURIComponent(String(_)),ne=this.V(_);for(_=0;_<ne.length;_++){var B=H;ne[_]!==""&&(B+="="+encodeURIComponent(String(ne[_]))),l.push(B)}}return this.i=l.join("&")};function Rs(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function B_(l,h){h&&!l.j&&(hr(l),l.i=null,l.g.forEach(function(f,_){var B=_.toLowerCase();_!=B&&(xp(this,_),bp(this,B,f))},l)),l.j=h}function $_(l,h){const f=new zi;if(c.Image){const _=new Image;_.onload=x(mr,f,"TestLoadImage: loaded",!0,h,_),_.onerror=x(mr,f,"TestLoadImage: error",!1,h,_),_.onabort=x(mr,f,"TestLoadImage: abort",!1,h,_),_.ontimeout=x(mr,f,"TestLoadImage: timeout",!1,h,_),c.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=l}else h(!1)}function z_(l,h){const f=new zi,_=new AbortController,B=setTimeout(()=>{_.abort(),mr(f,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:_.signal}).then(H=>{clearTimeout(B),H.ok?mr(f,"TestPingServer: ok",!0,h):mr(f,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(B),mr(f,"TestPingServer: error",!1,h)})}function mr(l,h,f,_,B){try{B&&(B.onload=null,B.onerror=null,B.onabort=null,B.ontimeout=null),_(f)}catch{}}function q_(){this.g=new j_}function H_(l,h,f){const _=f||"";try{fp(l,function(B,H){let ne=B;d(B)&&(ne=ju(B)),h.push(_+H+"="+encodeURIComponent(ne))})}catch(B){throw h.push(_+"type="+encodeURIComponent("_badmap")),B}}function Fo(l){this.l=l.Ub||null,this.j=l.eb||!1}S(Fo,Su),Fo.prototype.g=function(){return new Bo(this.l,this.j)},Fo.prototype.i=function(l){return function(){return l}}({});function Bo(l,h){ft.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(Bo,ft),t=Bo.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,Qi(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||c).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ki(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Qi(this)),this.g&&(this.readyState=3,Qi(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;wp(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function wp(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?Ki(this):Qi(this),this.readyState==3&&wp(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,Ki(this))},t.Qa=function(l){this.g&&(this.response=l,Ki(this))},t.ga=function(){this.g&&Ki(this)};function Ki(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Qi(l)}t.setRequestHeader=function(l,h){this.u.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var f=h.next();!f.done;)f=f.value,l.push(f[0]+": "+f[1]),f=h.next();return l.join(`\r
`)};function Qi(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Bo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function _p(l){let h="";return z(l,function(f,_){h+=_,h+=":",h+=f,h+=`\r
`}),h}function Lu(l,h,f){e:{for(_ in f){var _=!1;break e}_=!0}_||(f=_p(f),typeof l=="string"?f!=null&&encodeURIComponent(String(f)):ke(l,h,f))}function $e(l){ft.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S($e,ft);var G_=/^https?$/i,W_=["POST","PUT"];t=$e.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,h,f,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Au.g(),this.v=this.o?Xf(this.o):Xf(Au),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(H){Np(this,H);return}if(l=f||"",f=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var B in _)f.set(B,_[B]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const H of _.keys())f.set(H,_.get(H));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(f.keys()).find(H=>H.toLowerCase()=="content-type"),B=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(W_,h,void 0))||_||B||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[H,ne]of f)this.g.setRequestHeader(H,ne);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{jp(this),this.u=!0,this.g.send(l),this.u=!1}catch(H){Np(this,H)}};function Np(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,Ep(l),$o(l)}function Ep(l){l.A||(l.A=!0,jt(l,"complete"),jt(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,jt(this,"complete"),jt(this,"abort"),$o(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$o(this,!0)),$e.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Tp(this):this.bb())},t.bb=function(){Tp(this)};function Tp(l){if(l.h&&typeof o<"u"&&(!l.v[1]||Un(l)!=4||l.Z()!=2)){if(l.u&&Un(l)==4)Wf(l.Ea,0,l);else if(jt(l,"readystatechange"),Un(l)==4){l.h=!1;try{const ne=l.Z();e:switch(ne){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var f;if(!(f=h)){var _;if(_=ne===0){var B=String(l.D).match(pp)[1]||null;!B&&c.self&&c.self.location&&(B=c.self.location.protocol.slice(0,-1)),_=!G_.test(B?B.toLowerCase():"")}f=_}if(f)jt(l,"complete"),jt(l,"success");else{l.m=6;try{var H=2<Un(l)?l.g.statusText:""}catch{H=""}l.l=H+" ["+l.Z()+"]",Ep(l)}}finally{$o(l)}}}}function $o(l,h){if(l.g){jp(l);const f=l.g,_=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||jt(l,"ready");try{f.onreadystatechange=_}catch{}}}function jp(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function Un(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<Un(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),T_(h)}};function Sp(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function K_(l){const h={};l=(l.g&&2<=Un(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<l.length;_++){if(j(l[_]))continue;var f=k(l[_]);const B=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const H=h[B]||[];h[B]=H,H.push(f)}I(h,function(_){return _.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Yi(l,h,f){return f&&f.internalChannelParams&&f.internalChannelParams[l]||h}function Cp(l){this.Aa=0,this.i=[],this.j=new zi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Yi("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Yi("baseRetryDelayMs",5e3,l),this.cb=Yi("retryDelaySeedMs",1e4,l),this.Wa=Yi("forwardChannelMaxRetries",2,l),this.wa=Yi("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new cp(l&&l.concurrentRequestLimit),this.Da=new q_,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Cp.prototype,t.la=8,t.G=1,t.connect=function(l,h,f,_){St(0),this.W=l,this.H=h||{},f&&_!==void 0&&(this.H.OSID=f,this.H.OAID=_),this.F=this.X,this.I=Lp(this,null,this.W),qo(this)};function Vu(l){if(Ip(l),l.G==3){var h=l.U++,f=Vn(l.I);if(ke(f,"SID",l.K),ke(f,"RID",h),ke(f,"TYPE","terminate"),Xi(l,f),h=new dr(l,l.j,h),h.L=2,h.v=Uo(Vn(f)),f=!1,c.navigator&&c.navigator.sendBeacon)try{f=c.navigator.sendBeacon(h.v.toString(),"")}catch{}!f&&c.Image&&(new Image().src=h.v,f=!0),f||(h.g=Vp(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Oo(h)}Op(l)}function zo(l){l.g&&(Fu(l),l.g.cancel(),l.g=null)}function Ip(l){zo(l),l.u&&(c.clearTimeout(l.u),l.u=null),Ho(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function qo(l){if(!up(l.h)&&!l.s){l.s=!0;var h=l.Ga;O||F(),v||(O(),v=!0),A.add(h,l),l.B=0}}function Q_(l,h){return dp(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=$i(y(l.Ga,l,h),Mp(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const B=new dr(this,this.j,l);let H=this.o;if(this.S&&(H?(H=b(H),p(H,this.S)):H=this.S),this.m!==null||this.O||(B.H=H,H=null),this.P)e:{for(var h=0,f=0;f<this.i.length;f++){t:{var _=this.i[f];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(h+=_,4096<h){h=f;break e}if(h===4096||f===this.i.length-1){h=f+1;break e}}h=1e3}else h=1e3;h=kp(this,B,h),f=Vn(this.I),ke(f,"RID",l),ke(f,"CVER",22),this.D&&ke(f,"X-HTTP-Session-Id",this.D),Xi(this,f),H&&(this.O?h="headers="+encodeURIComponent(String(_p(H)))+"&"+h:this.m&&Lu(f,this.m,H)),Ou(this.h,B),this.Ua&&ke(f,"TYPE","init"),this.P?(ke(f,"$req",h),ke(f,"SID","null"),B.T=!0,Pu(B,f,null)):Pu(B,f,h),this.G=2}}else this.G==3&&(l?Ap(this,l):this.i.length==0||up(this.h)||Ap(this))};function Ap(l,h){var f;h?f=h.l:f=l.U++;const _=Vn(l.I);ke(_,"SID",l.K),ke(_,"RID",f),ke(_,"AID",l.T),Xi(l,_),l.m&&l.o&&Lu(_,l.m,l.o),f=new dr(l,l.j,f,l.B+1),l.m===null&&(f.H=l.o),h&&(l.i=h.D.concat(l.i)),h=kp(l,f,1e3),f.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Ou(l.h,f),Pu(f,_,h)}function Xi(l,h){l.H&&z(l.H,function(f,_){ke(h,_,f)}),l.l&&fp({},function(f,_){ke(h,_,f)})}function kp(l,h,f){f=Math.min(l.i.length,f);var _=l.l?y(l.l.Na,l.l,l):null;e:{var B=l.i;let H=-1;for(;;){const ne=["count="+f];H==-1?0<f?(H=B[0].g,ne.push("ofs="+H)):H=0:ne.push("ofs="+H);let Se=!0;for(let it=0;it<f;it++){let be=B[it].g;const pt=B[it].map;if(be-=H,0>be)H=Math.max(0,B[it].g-100),Se=!1;else try{H_(pt,ne,"req"+be+"_")}catch{_&&_(pt)}}if(Se){_=ne.join("&");break e}}}return l=l.i.splice(0,f),h.D=l,_}function Pp(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;O||F(),v||(O(),v=!0),A.add(h,l),l.v=0}}function Uu(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=$i(y(l.Fa,l),Mp(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Rp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=$i(y(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,St(10),zo(this),Rp(this))};function Fu(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Rp(l){l.g=new dr(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=Vn(l.qa);ke(h,"RID","rpc"),ke(h,"SID",l.K),ke(h,"AID",l.T),ke(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&ke(h,"TO",l.ja),ke(h,"TYPE","xmlhttp"),Xi(l,h),l.m&&l.o&&Lu(h,l.m,l.o),l.L&&(l.g.I=l.L);var f=l.g;l=l.ia,f.L=1,f.v=Uo(Vn(h)),f.m=null,f.P=!0,ap(f,l)}t.Za=function(){this.C!=null&&(this.C=null,zo(this),Uu(this),St(19))};function Ho(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function Dp(l,h){var f=null;if(l.g==h){Ho(l),Fu(l),l.g=null;var _=2}else if(Mu(l.h,h))f=h.D,hp(l.h,h),_=1;else return;if(l.G!=0){if(h.o)if(_==1){f=h.m?h.m.length:0,h=Date.now()-h.F;var B=l.B;_=Ro(),jt(_,new np(_,f)),qo(l)}else Pp(l);else if(B=h.s,B==3||B==0&&0<h.X||!(_==1&&Q_(l,h)||_==2&&Uu(l)))switch(f&&0<f.length&&(h=l.h,h.i=h.i.concat(f)),B){case 1:ts(l,5);break;case 4:ts(l,10);break;case 3:ts(l,6);break;default:ts(l,2)}}}function Mp(l,h){let f=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(f*=2),f*h}function ts(l,h){if(l.j.info("Error code "+h),h==2){var f=y(l.fb,l),_=l.Xa;const B=!_;_=new es(_||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Lo(_,"https"),Uo(_),B?$_(_.toString(),f):z_(_.toString(),f)}else St(2);l.G=0,l.l&&l.l.sa(h),Op(l),Ip(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),St(2)):(this.j.info("Failed to ping google.com"),St(1))};function Op(l){if(l.G=0,l.ka=[],l.l){const h=mp(l.h);(h.length!=0||l.i.length!=0)&&(P(l.ka,h),P(l.ka,l.i),l.h.i.length=0,E(l.i),l.i.length=0),l.l.ra()}}function Lp(l,h,f){var _=f instanceof es?Vn(f):new es(f);if(_.g!="")h&&(_.g=h+"."+_.g),Vo(_,_.s);else{var B=c.location;_=B.protocol,h=h?h+"."+B.hostname:B.hostname,B=+B.port;var H=new es(null);_&&Lo(H,_),h&&(H.g=h),B&&Vo(H,B),f&&(H.l=f),_=H}return f=l.D,h=l.ya,f&&h&&ke(_,f,h),ke(_,"VER",l.la),Xi(l,_),_}function Vp(l,h,f){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new $e(new Fo({eb:f})):new $e(l.pa),h.Ha(l.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Up(){}t=Up.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Go(){}Go.prototype.g=function(l,h){return new zt(l,h)};function zt(l,h){ft.call(this),this.g=new Cp(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!j(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!j(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new Ds(this)}S(zt,ft),zt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},zt.prototype.close=function(){Vu(this.g)},zt.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var f={};f.__data__=l,l=f}else this.u&&(f={},f.__data__=ju(l),l=f);h.i.push(new P_(h.Ya++,l)),h.G==3&&qo(h)},zt.prototype.N=function(){this.g.l=null,delete this.j,Vu(this.g),delete this.g,zt.aa.N.call(this)};function Fp(l){Cu.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const f in h){l=f;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}S(Fp,Cu);function Bp(){Iu.call(this),this.status=1}S(Bp,Iu);function Ds(l){this.g=l}S(Ds,Up),Ds.prototype.ua=function(){jt(this.g,"a")},Ds.prototype.ta=function(l){jt(this.g,new Fp(l))},Ds.prototype.sa=function(l){jt(this.g,new Bp)},Ds.prototype.ra=function(){jt(this.g,"b")},Go.prototype.createWebChannel=Go.prototype.g,zt.prototype.send=zt.prototype.o,zt.prototype.open=zt.prototype.m,zt.prototype.close=zt.prototype.close,kb=function(){return new Go},Ab=function(){return Ro()},Ib=Jr,Ah={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Do.NO_ERROR=0,Do.TIMEOUT=8,Do.HTTP_ERROR=6,Dl=Do,rp.COMPLETE="complete",Cb=rp,Jf.EventType=Fi,Fi.OPEN="a",Fi.CLOSE="b",Fi.ERROR="c",Fi.MESSAGE="d",ft.prototype.listen=ft.prototype.K,fa=Jf,$e.prototype.listenOnce=$e.prototype.L,$e.prototype.getLastError=$e.prototype.Ka,$e.prototype.getLastErrorCode=$e.prototype.Ba,$e.prototype.getStatus=$e.prototype.Z,$e.prototype.getResponseJson=$e.prototype.Oa,$e.prototype.getResponseText=$e.prototype.oa,$e.prototype.send=$e.prototype.ea,$e.prototype.setWithCredentials=$e.prototype.Ha,Sb=$e}).apply(typeof hl<"u"?hl:typeof self<"u"?self:typeof window<"u"?window:{});const Sy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}bt.UNAUTHENTICATED=new bt(null),bt.GOOGLE_CREDENTIALS=new bt("google-credentials-uid"),bt.FIRST_PARTY=new bt("first-party-uid"),bt.MOCK_USER=new bt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ri="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _s=new $m("@firebase/firestore");function aa(){return _s.logLevel}function ie(t,...e){if(_s.logLevel<=ye.DEBUG){const n=e.map(Zm);_s.debug(`Firestore (${Ri}): ${t}`,...n)}}function sr(t,...e){if(_s.logLevel<=ye.ERROR){const n=e.map(Zm);_s.error(`Firestore (${Ri}): ${t}`,...n)}}function bi(t,...e){if(_s.logLevel<=ye.WARN){const n=e.map(Zm);_s.warn(`Firestore (${Ri}): ${t}`,...n)}}function Zm(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function de(t="Unexpected state"){const e=`FIRESTORE (${Ri}) INTERNAL ASSERTION FAILED: `+t;throw sr(e),new Error(e)}function Te(t,e){t||de()}function me(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends Mn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(bt.UNAUTHENTICATED))}shutdown(){}}class yC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class xC{constructor(e){this.t=e,this.currentUser=bt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Te(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let a=new Qn;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Qn,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=a;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Qn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Te(typeof r.accessToken=="string"),new Pb(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Te(e===null||typeof e=="string"),new bt(e)}}class vC{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=bt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class bC{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new vC(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(bt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class wC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class _C{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Te(this.o===void 0);const r=a=>{a.error!=null&&ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.R;return this.R=a.token,ie("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const s=a=>{ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?s(a):ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Te(typeof n.token=="string"),this.R=n.token,new wC(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NC(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=NC(40);for(let a=0;a<s.length;++a)r.length<20&&s[a]<n&&(r+=e.charAt(s[a]%e.length))}return r}}function we(t,e){return t<e?-1:t>e?1:0}function wi(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new re(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new re(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new re(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return le.fromMillis(Date.now())}static fromDate(e){return le.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new le(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?we(this.nanoseconds,e.nanoseconds):we(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e){this.timestamp=e}static fromTimestamp(e){return new he(e)}static min(){return new he(new le(0,0))}static max(){return new he(new le(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(e,n,r){n===void 0?n=0:n>e.length&&de(),r===void 0?r=e.length-n:r>e.length-n&&de(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ja.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ja?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const a=e.get(s),o=n.get(s);if(a<o)return-1;if(a>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Re extends Ja{construct(e,n,r){return new Re(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new re(W.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Re(n)}static emptyPath(){return new Re([])}}const EC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class lt extends Ja{construct(e,n,r){return new lt(e,n,r)}static isValidIdentifier(e){return EC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),lt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new lt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const a=()=>{if(r.length===0)throw new re(W.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new re(W.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new re(W.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(r+=c,s++):(a(),s++)}if(a(),o)throw new re(W.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new lt(n)}static emptyPath(){return new lt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.path=e}static fromPath(e){return new oe(Re.fromString(e))}static fromName(e){return new oe(Re.fromString(e).popFirst(5))}static empty(){return new oe(Re.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Re.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Re.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new oe(new Re(e.slice()))}}function TC(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=he.fromTimestamp(r===1e9?new le(n+1,0):new le(n,r));return new zr(s,oe.empty(),e)}function jC(t){return new zr(t.readTime,t.key,-1)}class zr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new zr(he.min(),oe.empty(),-1)}static max(){return new zr(he.max(),oe.empty(),-1)}}function SC(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=oe.comparator(t.documentKey,e.documentKey),n!==0?n:we(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class IC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vo(t){if(t.code!==W.FAILED_PRECONDITION||t.message!==CC)throw t;ie("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&de(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Y((r,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,s)},this.catchCallback=a=>{this.wrapFailure(n,a).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Y?n:Y.resolve(n)}catch(n){return Y.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Y.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Y.reject(n)}static resolve(e){return new Y((n,r)=>{n(e)})}static reject(e){return new Y((n,r)=>{r(e)})}static waitFor(e){return new Y((n,r)=>{let s=0,a=0,o=!1;e.forEach(c=>{++s,c.next(()=>{++a,o&&a===s&&n()},u=>r(u))}),o=!0,a===s&&n()})}static or(e){let n=Y.resolve(!1);for(const r of e)n=n.next(s=>s?Y.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,a)=>{r.push(n.call(this,s,a))}),this.waitFor(r)}static mapArray(e,n){return new Y((r,s)=>{const a=e.length,o=new Array(a);let c=0;for(let u=0;u<a;u++){const d=u;n(e[d]).next(m=>{o[d]=m,++c,c===a&&r(o)},m=>s(m))}})}static doWhile(e,n){return new Y((r,s)=>{const a=()=>{e()===!0?n().next(()=>{a()},s):r()};a()})}}function AC(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function bo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}ef.oe=-1;function eu(t){return t==null}function vc(t){return t===0&&1/t==-1/0}function kC(t){return typeof t=="number"&&Number.isInteger(t)&&!vc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cy(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function As(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Db(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e,n){this.comparator=e,this.root=n||ot.EMPTY}insert(e,n){return new Fe(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ot.BLACK,null,null))}remove(e){return new Fe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ot.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ml(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ml(this.root,e,this.comparator,!1)}getReverseIterator(){return new ml(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ml(this.root,e,this.comparator,!0)}}class ml{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=n?r(e.key,n):1,n&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ot{constructor(e,n,r,s,a){this.key=e,this.value=n,this.color=r??ot.RED,this.left=s??ot.EMPTY,this.right=a??ot.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,a){return new ot(e??this.key,n??this.value,r??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const a=r(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,n,r),null):a===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ot.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return ot.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ot.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ot.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw de();const e=this.left.check();if(e!==this.right.check())throw de();return e+(this.isRed()?0:1)}}ot.EMPTY=null,ot.RED=!0,ot.BLACK=!1;ot.EMPTY=new class{constructor(){this.size=0}get key(){throw de()}get value(){throw de()}get color(){throw de()}get left(){throw de()}get right(){throw de()}copy(e,n,r,s,a){return this}insert(e,n,r){return new ot(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e){this.comparator=e,this.data=new Fe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Iy(this.data.getIterator())}getIteratorFrom(e){return new Iy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof ut)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,a=r.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ut(this.comparator);return n.data=e,n}}class Iy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.fields=e,e.sort(lt.comparator)}static empty(){return new Gt([])}unionWith(e){let n=new ut(lt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Gt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return wi(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new Mb("Invalid base64 string: "+a):a}}(e);return new ht(n)}static fromUint8Array(e){const n=function(s){let a="";for(let o=0;o<s.length;++o)a+=String.fromCharCode(s[o]);return a}(e);return new ht(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return we(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ht.EMPTY_BYTE_STRING=new ht("");const PC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qr(t){if(Te(!!t),typeof t=="string"){let e=0;const n=PC.exec(t);if(Te(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ge(t.seconds),nanos:Ge(t.nanos)}}function Ge(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ns(t){return typeof t=="string"?ht.fromBase64String(t):ht.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tf(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function nf(t){const e=t.mapValue.fields.__previous_value__;return tf(e)?nf(e):e}function Za(t){const e=qr(t.mapValue.fields.__local_write_time__.timestampValue);return new le(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e,n,r,s,a,o,c,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d}}class eo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new eo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof eo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fl={mapValue:{}};function Es(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?tf(t)?4:MC(t)?9007199254740991:DC(t)?10:11:de()}function Pn(t,e){if(t===e)return!0;const n=Es(t);if(n!==Es(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Za(t).isEqual(Za(e));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const o=qr(s.timestampValue),c=qr(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,a){return Ns(s.bytesValue).isEqual(Ns(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,a){return Ge(s.geoPointValue.latitude)===Ge(a.geoPointValue.latitude)&&Ge(s.geoPointValue.longitude)===Ge(a.geoPointValue.longitude)}(t,e);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return Ge(s.integerValue)===Ge(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const o=Ge(s.doubleValue),c=Ge(a.doubleValue);return o===c?vc(o)===vc(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return wi(t.arrayValue.values||[],e.arrayValue.values||[],Pn);case 10:case 11:return function(s,a){const o=s.mapValue.fields||{},c=a.mapValue.fields||{};if(Cy(o)!==Cy(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!Pn(o[u],c[u])))return!1;return!0}(t,e);default:return de()}}function to(t,e){return(t.values||[]).find(n=>Pn(n,e))!==void 0}function _i(t,e){if(t===e)return 0;const n=Es(t),r=Es(e);if(n!==r)return we(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return we(t.booleanValue,e.booleanValue);case 2:return function(a,o){const c=Ge(a.integerValue||a.doubleValue),u=Ge(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return Ay(t.timestampValue,e.timestampValue);case 4:return Ay(Za(t),Za(e));case 5:return we(t.stringValue,e.stringValue);case 6:return function(a,o){const c=Ns(a),u=Ns(o);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(a,o){const c=a.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const m=we(c[d],u[d]);if(m!==0)return m}return we(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,o){const c=we(Ge(a.latitude),Ge(o.latitude));return c!==0?c:we(Ge(a.longitude),Ge(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return ky(t.arrayValue,e.arrayValue);case 10:return function(a,o){var c,u,d,m;const g=a.fields||{},y=o.fields||{},x=(c=g.value)===null||c===void 0?void 0:c.arrayValue,S=(u=y.value)===null||u===void 0?void 0:u.arrayValue,E=we(((d=x==null?void 0:x.values)===null||d===void 0?void 0:d.length)||0,((m=S==null?void 0:S.values)===null||m===void 0?void 0:m.length)||0);return E!==0?E:ky(x,S)}(t.mapValue,e.mapValue);case 11:return function(a,o){if(a===fl.mapValue&&o===fl.mapValue)return 0;if(a===fl.mapValue)return 1;if(o===fl.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),d=o.fields||{},m=Object.keys(d);u.sort(),m.sort();for(let g=0;g<u.length&&g<m.length;++g){const y=we(u[g],m[g]);if(y!==0)return y;const x=_i(c[u[g]],d[m[g]]);if(x!==0)return x}return we(u.length,m.length)}(t.mapValue,e.mapValue);default:throw de()}}function Ay(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return we(t,e);const n=qr(t),r=qr(e),s=we(n.seconds,r.seconds);return s!==0?s:we(n.nanos,r.nanos)}function ky(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const a=_i(n[s],r[s]);if(a)return a}return we(n.length,r.length)}function Ni(t){return kh(t)}function kh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=qr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ns(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return oe.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const a of n.values||[])s?s=!1:r+=",",r+=kh(a);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",a=!0;for(const o of r)a?a=!1:s+=",",s+=`${o}:${kh(n.fields[o])}`;return s+"}"}(t.mapValue):de()}function Py(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Ph(t){return!!t&&"integerValue"in t}function rf(t){return!!t&&"arrayValue"in t}function Ry(t){return!!t&&"nullValue"in t}function Dy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ml(t){return!!t&&"mapValue"in t}function DC(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Ca(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return As(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ca(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ca(t.arrayValue.values[n]);return e}return Object.assign({},t)}function MC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e){this.value=e}static empty(){return new Ot({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Ml(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ca(n)}setAll(e){let n=lt.emptyPath(),r={},s=[];e.forEach((o,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=c.popLast()}o?r[c.lastSegment()]=Ca(o):s.push(c.lastSegment())});const a=this.getFieldsMap(n);this.applyChanges(a,r,s)}delete(e){const n=this.field(e.popLast());Ml(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Pn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Ml(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){As(n,(s,a)=>e[s]=a);for(const s of r)delete e[s]}clone(){return new Ot(Ca(this.value))}}function Ob(t){const e=[];return As(t.fields,(n,r)=>{const s=new lt([n]);if(Ml(r)){const a=Ob(r.mapValue).fields;if(a.length===0)e.push(s);else for(const o of a)e.push(s.child(o))}else e.push(s)}),new Gt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e,n,r,s,a,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new _t(e,0,he.min(),he.min(),he.min(),Ot.empty(),0)}static newFoundDocument(e,n,r,s){return new _t(e,1,n,he.min(),r,s,0)}static newNoDocument(e,n){return new _t(e,2,n,he.min(),he.min(),Ot.empty(),0)}static newUnknownDocument(e,n){return new _t(e,3,n,he.min(),he.min(),Ot.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(he.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ot.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ot.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=he.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof _t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new _t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{constructor(e,n){this.position=e,this.inclusive=n}}function My(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const a=e[s],o=t.position[s];if(a.field.isKeyField()?r=oe.comparator(oe.fromName(o.referenceValue),n.key):r=_i(o,n.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function Oy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Pn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,n="asc"){this.field=e,this.dir=n}}function OC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{}class Ye extends Lb{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new VC(e,n,r):n==="array-contains"?new BC(e,r):n==="in"?new $C(e,r):n==="not-in"?new zC(e,r):n==="array-contains-any"?new qC(e,r):new Ye(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new UC(e,r):new FC(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(_i(n,this.value)):n!==null&&Es(this.value)===Es(n)&&this.matchesComparison(_i(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return de()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class bn extends Lb{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new bn(e,n)}matches(e){return Vb(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Vb(t){return t.op==="and"}function Ub(t){return LC(t)&&Vb(t)}function LC(t){for(const e of t.filters)if(e instanceof bn)return!1;return!0}function Rh(t){if(t instanceof Ye)return t.field.canonicalString()+t.op.toString()+Ni(t.value);if(Ub(t))return t.filters.map(e=>Rh(e)).join(",");{const e=t.filters.map(n=>Rh(n)).join(",");return`${t.op}(${e})`}}function Fb(t,e){return t instanceof Ye?function(r,s){return s instanceof Ye&&r.op===s.op&&r.field.isEqual(s.field)&&Pn(r.value,s.value)}(t,e):t instanceof bn?function(r,s){return s instanceof bn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((a,o,c)=>a&&Fb(o,s.filters[c]),!0):!1}(t,e):void de()}function Bb(t){return t instanceof Ye?function(n){return`${n.field.canonicalString()} ${n.op} ${Ni(n.value)}`}(t):t instanceof bn?function(n){return n.op.toString()+" {"+n.getFilters().map(Bb).join(" ,")+"}"}(t):"Filter"}class VC extends Ye{constructor(e,n,r){super(e,n,r),this.key=oe.fromName(r.referenceValue)}matches(e){const n=oe.comparator(e.key,this.key);return this.matchesComparison(n)}}class UC extends Ye{constructor(e,n){super(e,"in",n),this.keys=$b("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class FC extends Ye{constructor(e,n){super(e,"not-in",n),this.keys=$b("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function $b(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>oe.fromName(r.referenceValue))}class BC extends Ye{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return rf(n)&&to(n.arrayValue,this.value)}}class $C extends Ye{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&to(this.value.arrayValue,n)}}class zC extends Ye{constructor(e,n){super(e,"not-in",n)}matches(e){if(to(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!to(this.value.arrayValue,n)}}class qC extends Ye{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!rf(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>to(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e,n=null,r=[],s=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=a,this.startAt=o,this.endAt=c,this.ue=null}}function Ly(t,e=null,n=[],r=[],s=null,a=null,o=null){return new HC(t,e,n,r,s,a,o)}function sf(t){const e=me(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Rh(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(a){return a.field.canonicalString()+a.dir}(r)).join(","),eu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ni(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ni(r)).join(",")),e.ue=n}return e.ue}function af(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!OC(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Fb(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Oy(t.startAt,e.startAt)&&Oy(t.endAt,e.endAt)}function Dh(t){return oe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(e,n=null,r=[],s=[],a=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function GC(t,e,n,r,s,a,o,c){return new Di(t,e,n,r,s,a,o,c)}function tu(t){return new Di(t)}function Vy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function zb(t){return t.collectionGroup!==null}function Ia(t){const e=me(t);if(e.ce===null){e.ce=[];const n=new Set;for(const a of e.explicitOrderBy)e.ce.push(a),n.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new ut(lt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(a=>{n.has(a.canonicalString())||a.isKeyField()||e.ce.push(new no(a,r))}),n.has(lt.keyField().canonicalString())||e.ce.push(new no(lt.keyField(),r))}return e.ce}function An(t){const e=me(t);return e.le||(e.le=WC(e,Ia(t))),e.le}function WC(t,e){if(t.limitType==="F")return Ly(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new no(s.field,a)});const n=t.endAt?new bc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new bc(t.startAt.position,t.startAt.inclusive):null;return Ly(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Mh(t,e){const n=t.filters.concat([e]);return new Di(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function wc(t,e,n){return new Di(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function nu(t,e){return af(An(t),An(e))&&t.limitType===e.limitType}function qb(t){return`${sf(An(t))}|lt:${t.limitType}`}function Vs(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Bb(s)).join(", ")}]`),eu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Ni(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Ni(s)).join(",")),`Target(${r})`}(An(t))}; limitType=${t.limitType})`}function ru(t,e){return e.isFoundDocument()&&function(r,s){const a=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):oe.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)}(t,e)&&function(r,s){for(const a of Ia(r))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const a of r.filters)if(!a.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,c,u){const d=My(o,c,u);return o.inclusive?d<=0:d<0}(r.startAt,Ia(r),s)||r.endAt&&!function(o,c,u){const d=My(o,c,u);return o.inclusive?d>=0:d>0}(r.endAt,Ia(r),s))}(t,e)}function KC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Hb(t){return(e,n)=>{let r=!1;for(const s of Ia(t)){const a=QC(s,e,n);if(a!==0)return a;r=r||s.field.isKeyField()}return 0}}function QC(t,e,n){const r=t.field.isKeyField()?oe.comparator(e.key,n.key):function(a,o,c){const u=o.data.field(a),d=c.data.field(a);return u!==null&&d!==null?_i(u,d):de()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return de()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,a]of r)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){As(this.inner,(n,r)=>{for(const[s,a]of r)e(s,a)})}isEmpty(){return Db(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YC=new Fe(oe.comparator);function ir(){return YC}const Gb=new Fe(oe.comparator);function pa(...t){let e=Gb;for(const n of t)e=e.insert(n.key,n);return e}function Wb(t){let e=Gb;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function cs(){return Aa()}function Kb(){return Aa()}function Aa(){return new Mi(t=>t.toString(),(t,e)=>t.isEqual(e))}const XC=new Fe(oe.comparator),JC=new ut(oe.comparator);function pe(...t){let e=JC;for(const n of t)e=e.add(n);return e}const ZC=new ut(we);function eI(){return ZC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function of(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vc(e)?"-0":e}}function Qb(t){return{integerValue:""+t}}function tI(t,e){return kC(e)?Qb(e):of(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(){this._=void 0}}function nI(t,e,n){return t instanceof _c?function(s,a){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&tf(a)&&(a=nf(a)),a&&(o.fields.__previous_value__=a),{mapValue:o}}(n,e):t instanceof ro?Xb(t,e):t instanceof so?Jb(t,e):function(s,a){const o=Yb(s,a),c=Uy(o)+Uy(s.Pe);return Ph(o)&&Ph(s.Pe)?Qb(c):of(s.serializer,c)}(t,e)}function rI(t,e,n){return t instanceof ro?Xb(t,e):t instanceof so?Jb(t,e):n}function Yb(t,e){return t instanceof Nc?function(r){return Ph(r)||function(a){return!!a&&"doubleValue"in a}(r)}(e)?e:{integerValue:0}:null}class _c extends su{}class ro extends su{constructor(e){super(),this.elements=e}}function Xb(t,e){const n=Zb(e);for(const r of t.elements)n.some(s=>Pn(s,r))||n.push(r);return{arrayValue:{values:n}}}class so extends su{constructor(e){super(),this.elements=e}}function Jb(t,e){let n=Zb(e);for(const r of t.elements)n=n.filter(s=>!Pn(s,r));return{arrayValue:{values:n}}}class Nc extends su{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Uy(t){return Ge(t.integerValue||t.doubleValue)}function Zb(t){return rf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function sI(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof ro&&s instanceof ro||r instanceof so&&s instanceof so?wi(r.elements,s.elements,Pn):r instanceof Nc&&s instanceof Nc?Pn(r.Pe,s.Pe):r instanceof _c&&s instanceof _c}(t.transform,e.transform)}class iI{constructor(e,n){this.version=e,this.transformResults=n}}class sn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new sn}static exists(e){return new sn(void 0,e)}static updateTime(e){return new sn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ol(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class iu{}function ew(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new lf(t.key,sn.none()):new wo(t.key,t.data,sn.none());{const n=t.data,r=Ot.empty();let s=new ut(lt.comparator);for(let a of e.fields)if(!s.has(a)){let o=n.field(a);o===null&&a.length>1&&(a=a.popLast(),o=n.field(a)),o===null?r.delete(a):r.set(a,o),s=s.add(a)}return new Yr(t.key,r,new Gt(s.toArray()),sn.none())}}function aI(t,e,n){t instanceof wo?function(s,a,o){const c=s.value.clone(),u=By(s.fieldTransforms,a,o.transformResults);c.setAll(u),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):t instanceof Yr?function(s,a,o){if(!Ol(s.precondition,a))return void a.convertToUnknownDocument(o.version);const c=By(s.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(tw(s)),u.setAll(c),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function ka(t,e,n,r){return t instanceof wo?function(a,o,c,u){if(!Ol(a.precondition,o))return c;const d=a.value.clone(),m=$y(a.fieldTransforms,u,o);return d.setAll(m),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Yr?function(a,o,c,u){if(!Ol(a.precondition,o))return c;const d=$y(a.fieldTransforms,u,o),m=o.data;return m.setAll(tw(a)),m.setAll(d),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(a,o,c){return Ol(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,n)}function oI(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),a=Yb(r.transform,s||null);a!=null&&(n===null&&(n=Ot.empty()),n.set(r.field,a))}return n||null}function Fy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&wi(r,s,(a,o)=>sI(a,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class wo extends iu{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Yr extends iu{constructor(e,n,r,s,a=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function tw(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function By(t,e,n){const r=new Map;Te(t.length===n.length);for(let s=0;s<n.length;s++){const a=t[s],o=a.transform,c=e.data.field(a.field);r.set(a.field,rI(o,c,n[s]))}return r}function $y(t,e,n){const r=new Map;for(const s of t){const a=s.transform,o=n.data.field(s.field);r.set(s.field,nI(a,o,e))}return r}class lf extends iu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class lI extends iu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&aI(a,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ka(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ka(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Kb();return this.mutations.forEach(s=>{const a=e.get(s.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=n.has(s.key)?null:c;const u=ew(o,c);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(he.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),pe())}isEqual(e){return this.batchId===e.batchId&&wi(this.mutations,e.mutations,(n,r)=>Fy(n,r))&&wi(this.baseMutations,e.baseMutations,(n,r)=>Fy(n,r))}}class cf{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Te(e.mutations.length===r.length);let s=function(){return XC}();const a=e.mutations;for(let o=0;o<a.length;o++)s=s.insert(a[o].key,r[o].version);return new cf(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ke,xe;function hI(t){switch(t){default:return de();case W.CANCELLED:case W.UNKNOWN:case W.DEADLINE_EXCEEDED:case W.RESOURCE_EXHAUSTED:case W.INTERNAL:case W.UNAVAILABLE:case W.UNAUTHENTICATED:return!1;case W.INVALID_ARGUMENT:case W.NOT_FOUND:case W.ALREADY_EXISTS:case W.PERMISSION_DENIED:case W.FAILED_PRECONDITION:case W.ABORTED:case W.OUT_OF_RANGE:case W.UNIMPLEMENTED:case W.DATA_LOSS:return!0}}function nw(t){if(t===void 0)return sr("GRPC error has no .code"),W.UNKNOWN;switch(t){case Ke.OK:return W.OK;case Ke.CANCELLED:return W.CANCELLED;case Ke.UNKNOWN:return W.UNKNOWN;case Ke.DEADLINE_EXCEEDED:return W.DEADLINE_EXCEEDED;case Ke.RESOURCE_EXHAUSTED:return W.RESOURCE_EXHAUSTED;case Ke.INTERNAL:return W.INTERNAL;case Ke.UNAVAILABLE:return W.UNAVAILABLE;case Ke.UNAUTHENTICATED:return W.UNAUTHENTICATED;case Ke.INVALID_ARGUMENT:return W.INVALID_ARGUMENT;case Ke.NOT_FOUND:return W.NOT_FOUND;case Ke.ALREADY_EXISTS:return W.ALREADY_EXISTS;case Ke.PERMISSION_DENIED:return W.PERMISSION_DENIED;case Ke.FAILED_PRECONDITION:return W.FAILED_PRECONDITION;case Ke.ABORTED:return W.ABORTED;case Ke.OUT_OF_RANGE:return W.OUT_OF_RANGE;case Ke.UNIMPLEMENTED:return W.UNIMPLEMENTED;case Ke.DATA_LOSS:return W.DATA_LOSS;default:return de()}}(xe=Ke||(Ke={}))[xe.OK=0]="OK",xe[xe.CANCELLED=1]="CANCELLED",xe[xe.UNKNOWN=2]="UNKNOWN",xe[xe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xe[xe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xe[xe.NOT_FOUND=5]="NOT_FOUND",xe[xe.ALREADY_EXISTS=6]="ALREADY_EXISTS",xe[xe.PERMISSION_DENIED=7]="PERMISSION_DENIED",xe[xe.UNAUTHENTICATED=16]="UNAUTHENTICATED",xe[xe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xe[xe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xe[xe.ABORTED=10]="ABORTED",xe[xe.OUT_OF_RANGE=11]="OUT_OF_RANGE",xe[xe.UNIMPLEMENTED=12]="UNIMPLEMENTED",xe[xe.INTERNAL=13]="INTERNAL",xe[xe.UNAVAILABLE=14]="UNAVAILABLE",xe[xe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mI(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI=new hs([4294967295,4294967295],0);function zy(t){const e=mI().encode(t),n=new jb;return n.update(e),new Uint8Array(n.digest())}function qy(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new hs([n,r],0),new hs([s,a],0)]}class uf{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ga(`Invalid padding: ${n}`);if(r<0)throw new ga(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ga(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ga(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=hs.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(hs.fromNumber(r)));return s.compare(fI)===1&&(s=new hs([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=zy(e),[r,s]=qy(n);for(let a=0;a<this.hashCount;a++){const o=this.Ee(r,s,a);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new uf(a,s,n);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.Ie===0)return;const n=zy(e),[r,s]=qy(n);for(let a=0;a<this.hashCount;a++){const o=this.Ee(r,s,a);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ga extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(e,n,r,s,a){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,_o.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new au(he.min(),s,new Fe(we),ir(),pe())}}class _o{constructor(e,n,r,s,a){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new _o(r,n,pe(),pe(),pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class rw{constructor(e,n){this.targetId=e,this.me=n}}class sw{constructor(e,n,r=ht.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Hy{constructor(){this.fe=0,this.ge=Wy(),this.pe=ht.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=pe(),n=pe(),r=pe();return this.ge.forEach((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:de()}}),new _o(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Wy()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Te(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class pI{constructor(e){this.Le=e,this.Be=new Map,this.ke=ir(),this.qe=Gy(),this.Qe=new Fe(we)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:de()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const a=s.target;if(Dh(a))if(r===0){const o=new oe(a.path);this.Ue(n,o,_t.newNoDocument(o,he.min()))}else Te(r===1);else{const o=this.Ye(n);if(o!==r){const c=this.Ze(e),u=c?this.Xe(c,e,o):1;if(u!==0){this.je(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:a=0}=n;let o,c;try{o=Ns(r).toUint8Array()}catch(u){if(u instanceof Mb)return bi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new uf(o,s,a)}catch(u){return bi(u instanceof ga?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.Ie===0?null:c}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(a=>{const o=this.Le.tt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.Ue(n,a,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((a,o)=>{const c=this.Je(o);if(c){if(a.current&&Dh(c.target)){const u=new oe(c.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,_t.newNoDocument(u,e))}a.be&&(n.set(o,a.ve()),a.Ce())}});let r=pe();this.qe.forEach((a,o)=>{let c=!0;o.forEachWhile(u=>{const d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(a))}),this.ke.forEach((a,o)=>o.setReadTime(e));const s=new au(e,n,this.Qe,this.ke,r);return this.ke=ir(),this.qe=Gy(),this.Qe=new Fe(we),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Hy,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new ut(we),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||ie("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Hy),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Gy(){return new Fe(oe.comparator)}function Wy(){return new Fe(oe.comparator)}const gI={asc:"ASCENDING",desc:"DESCENDING"},yI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},xI={and:"AND",or:"OR"};class vI{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Oh(t,e){return t.useProto3Json||eu(e)?e:{value:e}}function Ec(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function iw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function bI(t,e){return Ec(t,e.toTimestamp())}function kn(t){return Te(!!t),he.fromTimestamp(function(n){const r=qr(n);return new le(r.seconds,r.nanos)}(t))}function df(t,e){return Lh(t,e).canonicalString()}function Lh(t,e){const n=function(s){return new Re(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function aw(t){const e=Re.fromString(t);return Te(dw(e)),e}function Vh(t,e){return df(t.databaseId,e.path)}function wd(t,e){const n=aw(e);if(n.get(1)!==t.databaseId.projectId)throw new re(W.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new re(W.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new oe(lw(n))}function ow(t,e){return df(t.databaseId,e)}function wI(t){const e=aw(t);return e.length===4?Re.emptyPath():lw(e)}function Uh(t){return new Re(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function lw(t){return Te(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Ky(t,e,n){return{name:Vh(t,e),fields:n.value.mapValue.fields}}function _I(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:de()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=function(d,m){return d.useProto3Json?(Te(m===void 0||typeof m=="string"),ht.fromBase64String(m||"")):(Te(m===void 0||m instanceof Buffer||m instanceof Uint8Array),ht.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(d){const m=d.code===void 0?W.UNKNOWN:nw(d.code);return new re(m,d.message||"")}(o);n=new sw(r,s,a,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=wd(t,r.document.name),a=kn(r.document.updateTime),o=r.document.createTime?kn(r.document.createTime):he.min(),c=new Ot({mapValue:{fields:r.document.fields}}),u=_t.newFoundDocument(s,a,o,c),d=r.targetIds||[],m=r.removedTargetIds||[];n=new Ll(d,m,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=wd(t,r.document),a=r.readTime?kn(r.readTime):he.min(),o=_t.newNoDocument(s,a),c=r.removedTargetIds||[];n=new Ll([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=wd(t,r.document),a=r.removedTargetIds||[];n=new Ll([],a,s,null)}else{if(!("filter"in e))return de();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:a}=r,o=new dI(s,a),c=r.targetId;n=new rw(c,o)}}return n}function NI(t,e){let n;if(e instanceof wo)n={update:Ky(t,e.key,e.value)};else if(e instanceof lf)n={delete:Vh(t,e.key)};else if(e instanceof Yr)n={update:Ky(t,e.key,e.data),updateMask:PI(e.fieldMask)};else{if(!(e instanceof lI))return de();n={verify:Vh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(a,o){const c=o.transform;if(c instanceof _c)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof ro)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof so)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Nc)return{fieldPath:o.field.canonicalString(),increment:c.Pe};throw de()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:bI(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:de()}(t,e.precondition)),n}function EI(t,e){return t&&t.length>0?(Te(e!==void 0),t.map(n=>function(s,a){let o=s.updateTime?kn(s.updateTime):kn(a);return o.isEqual(he.min())&&(o=kn(a)),new iI(o,s.transformResults||[])}(n,e))):[]}function TI(t,e){return{documents:[ow(t,e.path)]}}function jI(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=ow(t,s);const a=function(d){if(d.length!==0)return uw(bn.create(d,"and"))}(e.filters);a&&(n.structuredQuery.where=a);const o=function(d){if(d.length!==0)return d.map(m=>function(y){return{field:Us(y.field),direction:II(y.dir)}}(m))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=Oh(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:s}}function SI(t){let e=wI(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Te(r===1);const m=n.from[0];m.allDescendants?s=m.collectionId:e=e.child(m.collectionId)}let a=[];n.where&&(a=function(g){const y=cw(g);return y instanceof bn&&Ub(y)?y.getFilters():[y]}(n.where));let o=[];n.orderBy&&(o=function(g){return g.map(y=>function(S){return new no(Fs(S.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(y))}(n.orderBy));let c=null;n.limit&&(c=function(g){let y;return y=typeof g=="object"?g.value:g,eu(y)?null:y}(n.limit));let u=null;n.startAt&&(u=function(g){const y=!!g.before,x=g.values||[];return new bc(x,y)}(n.startAt));let d=null;return n.endAt&&(d=function(g){const y=!g.before,x=g.values||[];return new bc(x,y)}(n.endAt)),GC(e,s,o,a,c,"F",u,d)}function CI(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return de()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function cw(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Fs(n.unaryFilter.field);return Ye.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Fs(n.unaryFilter.field);return Ye.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Fs(n.unaryFilter.field);return Ye.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Fs(n.unaryFilter.field);return Ye.create(o,"!=",{nullValue:"NULL_VALUE"});default:return de()}}(t):t.fieldFilter!==void 0?function(n){return Ye.create(Fs(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return de()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return bn.create(n.compositeFilter.filters.map(r=>cw(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return de()}}(n.compositeFilter.op))}(t):de()}function II(t){return gI[t]}function AI(t){return yI[t]}function kI(t){return xI[t]}function Us(t){return{fieldPath:t.canonicalString()}}function Fs(t){return lt.fromServerFormat(t.fieldPath)}function uw(t){return t instanceof Ye?function(n){if(n.op==="=="){if(Dy(n.value))return{unaryFilter:{field:Us(n.field),op:"IS_NAN"}};if(Ry(n.value))return{unaryFilter:{field:Us(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Dy(n.value))return{unaryFilter:{field:Us(n.field),op:"IS_NOT_NAN"}};if(Ry(n.value))return{unaryFilter:{field:Us(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Us(n.field),op:AI(n.op),value:n.value}}}(t):t instanceof bn?function(n){const r=n.getFilters().map(s=>uw(s));return r.length===1?r[0]:{compositeFilter:{op:kI(n.op),filters:r}}}(t):de()}function PI(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function dw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e,n,r,s,a=he.min(),o=he.min(),c=ht.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Sr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Sr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(e){this.ct=e}}function DI(t){const e=SI({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?wc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(){this.un=new OI}addToCollectionParentIndex(e,n){return this.un.add(n),Y.resolve()}getCollectionParents(e,n){return Y.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return Y.resolve()}deleteFieldIndex(e,n){return Y.resolve()}deleteAllFieldIndexes(e){return Y.resolve()}createTargetIndexes(e,n){return Y.resolve()}getDocumentsMatchingTarget(e,n){return Y.resolve(null)}getIndexType(e,n){return Y.resolve(0)}getFieldIndexes(e,n){return Y.resolve([])}getNextCollectionGroupToUpdate(e){return Y.resolve(null)}getMinOffset(e,n){return Y.resolve(zr.min())}getMinOffsetFromCollectionGroup(e,n){return Y.resolve(zr.min())}updateCollectionGroup(e,n,r){return Y.resolve()}updateIndexEntries(e,n){return Y.resolve()}}class OI{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new ut(Re.comparator),a=!s.has(r);return this.index[n]=s.add(r),a}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ut(Re.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Ei(0)}static kn(){return new Ei(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LI{constructor(){this.changes=new Mi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,_t.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?Y.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UI{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&ka(r.mutation,s,Gt.empty(),le.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,pe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=pe()){const s=cs();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(a=>{let o=pa();return a.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=cs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,pe()))}populateOverlays(e,n,r){const s=[];return r.forEach(a=>{n.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(e,s).next(a=>{a.forEach((o,c)=>{n.set(o,c)})})}computeViews(e,n,r,s){let a=ir();const o=Aa(),c=function(){return Aa()}();return n.forEach((u,d)=>{const m=r.get(d.key);s.has(d.key)&&(m===void 0||m.mutation instanceof Yr)?a=a.insert(d.key,d):m!==void 0?(o.set(d.key,m.mutation.getFieldMask()),ka(m.mutation,d,m.mutation.getFieldMask(),le.now())):o.set(d.key,Gt.empty())}),this.recalculateAndSaveOverlays(e,a).next(u=>(u.forEach((d,m)=>o.set(d,m)),n.forEach((d,m)=>{var g;return c.set(d,new VI(m,(g=o.get(d))!==null&&g!==void 0?g:null))}),c))}recalculateAndSaveOverlays(e,n){const r=Aa();let s=new Fe((o,c)=>o-c),a=pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const c of o)c.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let m=r.get(u)||Gt.empty();m=c.applyToLocalView(d,m),r.set(u,m);const g=(s.get(c.batchId)||pe()).add(u);s=s.insert(c.batchId,g)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,m=u.value,g=Kb();m.forEach(y=>{if(!a.has(y)){const x=ew(n.get(y),r.get(y));x!==null&&g.set(y,x),a=a.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,g))}return Y.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return oe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):zb(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(a=>{const o=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-a.size):Y.resolve(cs());let c=-1,u=a;return o.next(d=>Y.forEach(d,(m,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),a.get(m)?Y.resolve():this.remoteDocumentCache.getEntry(e,m).next(y=>{u=u.insert(m,y)}))).next(()=>this.populateOverlays(e,d,a)).next(()=>this.computeViews(e,u,d,pe())).next(m=>({batchId:c,changes:Wb(m)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new oe(n)).next(r=>{let s=pa();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const a=n.collectionGroup;let o=pa();return this.indexManager.getCollectionParents(e,a).next(c=>Y.forEach(c,u=>{const d=function(g,y){return new Di(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(m=>{m.forEach((g,y)=>{o=o.insert(g,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,a,s))).next(o=>{a.forEach((u,d)=>{const m=d.getKey();o.get(m)===null&&(o=o.insert(m,_t.newInvalidDocument(m)))});let c=pa();return o.forEach((u,d)=>{const m=a.get(u);m!==void 0&&ka(m.mutation,d,Gt.empty(),le.now()),ru(n,d)&&(c=c.insert(u,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return Y.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:kn(s.createTime)}}(n)),Y.resolve()}getNamedQuery(e,n){return Y.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:DI(s.bundledQuery),readTime:kn(s.readTime)}}(n)),Y.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BI{constructor(){this.overlays=new Fe(oe.comparator),this.Ir=new Map}getOverlay(e,n){return Y.resolve(this.overlays.get(n))}getOverlays(e,n){const r=cs();return Y.forEach(n,s=>this.getOverlay(e,s).next(a=>{a!==null&&r.set(s,a)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,a)=>{this.ht(e,n,a)}),Y.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.Ir.delete(r)),Y.resolve()}getOverlaysForCollection(e,n,r){const s=cs(),a=n.length+1,o=new oe(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===a&&u.largestBatchId>r&&s.set(u.getKey(),u)}return Y.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let a=new Fe((d,m)=>d-m);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let m=a.get(d.largestBatchId);m===null&&(m=cs(),a=a.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const c=cs(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,m)=>c.set(d,m)),!(c.size()>=s)););return Y.resolve(c)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new uI(n,r));let a=this.Ir.get(n);a===void 0&&(a=pe(),this.Ir.set(n,a)),this.Ir.set(n,a.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $I{constructor(){this.sessionToken=ht.EMPTY_BYTE_STRING}getSessionToken(e){return Y.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Y.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(){this.Tr=new ut(tt.Er),this.dr=new ut(tt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new tt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new tt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new oe(new Re([])),r=new tt(n,e),s=new tt(n,e+1),a=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),a.push(o.key)}),a}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new oe(new Re([])),r=new tt(n,e),s=new tt(n,e+1);let a=pe();return this.dr.forEachInRange([r,s],o=>{a=a.add(o.key)}),a}containsKey(e){const n=new tt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class tt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return oe.comparator(e.key,n.key)||we(e.wr,n.wr)}static Ar(e,n){return we(e.wr,n.wr)||oe.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zI{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new ut(tt.Er)}checkEmpty(e){return Y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new cI(a,n,r,s);this.mutationQueue.push(o);for(const c of s)this.br=this.br.add(new tt(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return Y.resolve(o)}lookupMutationBatch(e,n){return Y.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),a=s<0?0:s;return Y.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return Y.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new tt(n,0),s=new tt(n,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([r,s],o=>{const c=this.Dr(o.wr);a.push(c)}),Y.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ut(we);return n.forEach(s=>{const a=new tt(s,0),o=new tt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([a,o],c=>{r=r.add(c.wr)})}),Y.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let a=r;oe.isDocumentKey(a)||(a=a.child(""));const o=new tt(new oe(a),0);let c=new ut(we);return this.br.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(c=c.add(u.wr)),!0)},o),Y.resolve(this.Cr(c))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Te(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return Y.forEach(n.mutations,s=>{const a=new tt(s.key,n.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new tt(n,0),s=this.br.firstAfterOrEqual(r);return Y.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Y.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI{constructor(e){this.Mr=e,this.docs=function(){return new Fe(oe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),a=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return Y.resolve(r?r.document.mutableCopy():_t.newInvalidDocument(n))}getEntries(e,n){let r=ir();return n.forEach(s=>{const a=this.docs.get(s);r=r.insert(s,a?a.document.mutableCopy():_t.newInvalidDocument(s))}),Y.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let a=ir();const o=n.path,c=new oe(o.child("")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:m}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||SC(jC(m),r)<=0||(s.has(m.key)||ru(n,m))&&(a=a.insert(m.key,m.mutableCopy()))}return Y.resolve(a)}getAllFromCollectionGroup(e,n,r,s){de()}Or(e,n){return Y.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new HI(this)}getSize(e){return Y.resolve(this.size)}}class HI extends LI{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),Y.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GI{constructor(e){this.persistence=e,this.Nr=new Mi(n=>sf(n),af),this.lastRemoteSnapshotVersion=he.min(),this.highestTargetId=0,this.Lr=0,this.Br=new hf,this.targetCount=0,this.kr=Ei.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),Y.resolve()}getLastRemoteSnapshotVersion(e){return Y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Y.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Y.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),Y.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Ei(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,Y.resolve()}updateTargetData(e,n){return this.Kn(n),Y.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,Y.resolve()}removeTargets(e,n,r){let s=0;const a=[];return this.Nr.forEach((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.Nr.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),Y.waitFor(a).next(()=>s)}getTargetCount(e){return Y.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return Y.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),Y.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,a=[];return s&&n.forEach(o=>{a.push(s.markPotentiallyOrphaned(e,o))}),Y.waitFor(a)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),Y.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return Y.resolve(r)}containsKey(e,n){return Y.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WI{constructor(e,n){this.qr={},this.overlays={},this.Qr=new ef(0),this.Kr=!1,this.Kr=!0,this.$r=new $I,this.referenceDelegate=e(this),this.Ur=new GI(this),this.indexManager=new MI,this.remoteDocumentCache=function(s){return new qI(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new RI(n),this.Gr=new FI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new BI,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new zI(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){ie("MemoryPersistence","Starting transaction:",e);const s=new KI(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(a=>this.referenceDelegate.jr(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Hr(e,n){return Y.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class KI extends IC{constructor(e){super(),this.currentSequenceNumber=e}}class mf{constructor(e){this.persistence=e,this.Jr=new hf,this.Yr=null}static Zr(e){return new mf(e)}get Xr(){if(this.Yr)return this.Yr;throw de()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),Y.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),Y.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),Y.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(a=>this.Xr.add(a.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Y.forEach(this.Xr,r=>{const s=oe.fromPath(r);return this.ei(e,s).next(a=>{a||n.removeEntry(s,he.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return Y.or([()=>Y.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=pe(),s=pe();for(const a of n.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new ff(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return VT()?8:AC(Tt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const a={result:null};return this.Yi(e,n).next(o=>{a.result=o}).next(()=>{if(!a.result)return this.Zi(e,n,s,r).next(o=>{a.result=o})}).next(()=>{if(a.result)return;const o=new QI;return this.Xi(e,n,o).next(c=>{if(a.result=c,this.zi)return this.es(e,n,o,c.size)})}).next(()=>a.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(aa()<=ye.DEBUG&&ie("QueryEngine","SDK will not create cache indexes for query:",Vs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Y.resolve()):(aa()<=ye.DEBUG&&ie("QueryEngine","Query:",Vs(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(aa()<=ye.DEBUG&&ie("QueryEngine","The SDK decides to create cache indexes for query:",Vs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,An(n))):Y.resolve())}Yi(e,n){if(Vy(n))return Y.resolve(null);let r=An(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=wc(n,null,"F"),r=An(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const o=pe(...a);return this.Ji.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.ts(n,c);return this.ns(n,d,o,u.readTime)?this.Yi(e,wc(n,null,"F")):this.rs(e,d,n,u)}))})))}Zi(e,n,r,s){return Vy(n)||s.isEqual(he.min())?Y.resolve(null):this.Ji.getDocuments(e,r).next(a=>{const o=this.ts(n,a);return this.ns(n,o,r,s)?Y.resolve(null):(aa()<=ye.DEBUG&&ie("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Vs(n)),this.rs(e,o,n,TC(s,-1)).next(c=>c))})}ts(e,n){let r=new ut(Hb(e));return n.forEach((s,a)=>{ru(e,a)&&(r=r.add(a))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const a=e.limitType==="F"?n.last():n.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Xi(e,n,r){return aa()<=ye.DEBUG&&ie("QueryEngine","Using full collection scan to execute query:",Vs(n)),this.Ji.getDocumentsMatchingQuery(e,n,zr.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(a=>(n.forEach(o=>{a=a.insert(o.key,o)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new Fe(we),this._s=new Mi(a=>sf(a),af),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new UI(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function JI(t,e,n,r){return new XI(t,e,n,r)}async function hw(t,e){const n=me(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(a=>(s=a,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(a=>{const o=[],c=[];let u=pe();for(const d of s){o.push(d.batchId);for(const m of d.mutations)u=u.add(m.key)}for(const d of a){c.push(d.batchId);for(const m of d.mutations)u=u.add(m.key)}return n.localDocuments.getDocuments(r,u).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:c}))})})}function ZI(t,e){const n=me(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),a=n.cs.newChangeBuffer({trackRemovals:!0});return function(c,u,d,m){const g=d.batch,y=g.keys();let x=Y.resolve();return y.forEach(S=>{x=x.next(()=>m.getEntry(u,S)).next(E=>{const P=d.docVersions.get(S);Te(P!==null),E.version.compareTo(P)<0&&(g.applyToRemoteDocument(E,d),E.isValidDocument()&&(E.setReadTime(d.commitVersion),m.addEntry(E)))})}),x.next(()=>c.mutationQueue.removeMutationBatch(u,g))}(n,r,e,a).next(()=>a.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=pe();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function mw(t){const e=me(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function eA(t,e){const n=me(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const c=[];e.targetChanges.forEach((m,g)=>{const y=s.get(g);if(!y)return;c.push(n.Ur.removeMatchingKeys(a,m.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(a,m.addedDocuments,g)));let x=y.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(g)!==null?x=x.withResumeToken(ht.EMPTY_BYTE_STRING,he.min()).withLastLimboFreeSnapshotVersion(he.min()):m.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(m.resumeToken,r)),s=s.insert(g,x),function(E,P,T){return E.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(y,x,m)&&c.push(n.Ur.updateTargetData(a,x))});let u=ir(),d=pe();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(a,m))}),c.push(tA(a,o,e.documentUpdates).next(m=>{u=m.Ps,d=m.Is})),!r.isEqual(he.min())){const m=n.Ur.getLastRemoteSnapshotVersion(a).next(g=>n.Ur.setTargetsMetadata(a,a.currentSequenceNumber,r));c.push(m)}return Y.waitFor(c).next(()=>o.apply(a)).next(()=>n.localDocuments.getLocalViewOfDocuments(a,u,d)).next(()=>u)}).then(a=>(n.os=s,a))}function tA(t,e,n){let r=pe(),s=pe();return n.forEach(a=>r=r.add(a)),e.getEntries(t,r).next(a=>{let o=ir();return n.forEach((c,u)=>{const d=a.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(he.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):ie("LocalStore","Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function nA(t,e){const n=me(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function rA(t,e){const n=me(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(a=>a?(s=a,Y.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new Sr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Fh(t,e,n){const r=me(t),s=r.os.get(e),a=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",a,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!bo(o))throw o;ie("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Qy(t,e,n){const r=me(t);let s=he.min(),a=pe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,m){const g=me(u),y=g._s.get(m);return y!==void 0?Y.resolve(g.os.get(y)):g.Ur.getTargetData(d,m)}(r,o,An(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,c.targetId).next(u=>{a=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:he.min(),n?a:pe())).next(c=>(sA(r,KC(e),c),{documents:c,Ts:a})))}function sA(t,e,n){let r=t.us.get(e)||he.min();n.forEach((s,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),t.us.set(e,r)}class Yy{constructor(){this.activeTargetIds=eI()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class iA{constructor(){this.so=new Yy,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Yy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aA{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ie("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ie("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pl=null;function _d(){return pl===null?pl=function(){return 268435456+Math.round(2147483648*Math.random())}():pl++,"0x"+pl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vt="WebChannelConnection";class cA extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${a}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${a}`}get Fo(){return!1}Mo(n,r,s,a,o){const c=_d(),u=this.xo(n,r.toUriEncodedString());ie("RestConnection",`Sending RPC '${n}' ${c}:`,u,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,a,o),this.No(n,u,d,s).then(m=>(ie("RestConnection",`Received RPC '${n}' ${c}: `,m),m),m=>{throw bi("RestConnection",`RPC '${n}' ${c} failed with error: `,m,"url: ",u,"request:",s),m})}Lo(n,r,s,a,o,c){return this.Mo(n,r,s,a,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ri}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((a,o)=>n[o]=a),s&&s.headers.forEach((a,o)=>n[o]=a)}xo(n,r){const s=oA[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const a=_d();return new Promise((o,c)=>{const u=new Sb;u.setWithCredentials(!0),u.listenOnce(Cb.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Dl.NO_ERROR:const m=u.getResponseJson();ie(vt,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(m)),o(m);break;case Dl.TIMEOUT:ie(vt,`RPC '${e}' ${a} timed out`),c(new re(W.DEADLINE_EXCEEDED,"Request time out"));break;case Dl.HTTP_ERROR:const g=u.getStatus();if(ie(vt,`RPC '${e}' ${a} failed with status:`,g,"response text:",u.getResponseText()),g>0){let y=u.getResponseJson();Array.isArray(y)&&(y=y[0]);const x=y==null?void 0:y.error;if(x&&x.status&&x.message){const S=function(P){const T=P.toLowerCase().replace(/_/g,"-");return Object.values(W).indexOf(T)>=0?T:W.UNKNOWN}(x.status);c(new re(S,x.message))}else c(new re(W.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new re(W.UNAVAILABLE,"Connection failed."));break;default:de()}}finally{ie(vt,`RPC '${e}' ${a} completed.`)}});const d=JSON.stringify(s);ie(vt,`RPC '${e}' ${a} sending request:`,s),u.send(n,"POST",d,r,15)})}Bo(e,n,r){const s=_d(),a=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=kb(),c=Ab(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const m=a.join("");ie(vt,`Creating RPC '${e}' stream ${s}: ${m}`,u);const g=o.createWebChannel(m,u);let y=!1,x=!1;const S=new lA({Io:P=>{x?ie(vt,`Not sending because RPC '${e}' stream ${s} is closed:`,P):(y||(ie(vt,`Opening RPC '${e}' stream ${s} transport.`),g.open(),y=!0),ie(vt,`RPC '${e}' stream ${s} sending:`,P),g.send(P))},To:()=>g.close()}),E=(P,T,j)=>{P.listen(T,R=>{try{j(R)}catch(M){setTimeout(()=>{throw M},0)}})};return E(g,fa.EventType.OPEN,()=>{x||(ie(vt,`RPC '${e}' stream ${s} transport opened.`),S.yo())}),E(g,fa.EventType.CLOSE,()=>{x||(x=!0,ie(vt,`RPC '${e}' stream ${s} transport closed`),S.So())}),E(g,fa.EventType.ERROR,P=>{x||(x=!0,bi(vt,`RPC '${e}' stream ${s} transport errored:`,P),S.So(new re(W.UNAVAILABLE,"The operation could not be completed")))}),E(g,fa.EventType.MESSAGE,P=>{var T;if(!x){const j=P.data[0];Te(!!j);const R=j,M=R.error||((T=R[0])===null||T===void 0?void 0:T.error);if(M){ie(vt,`RPC '${e}' stream ${s} received error:`,M);const q=M.status;let z=function(C){const p=Ke[C];if(p!==void 0)return nw(p)}(q),I=M.message;z===void 0&&(z=W.INTERNAL,I="Unknown error status: "+q+" with message "+M.message),x=!0,S.So(new re(z,I)),g.close()}else ie(vt,`RPC '${e}' stream ${s} received:`,j),S.bo(j)}}),E(c,Ib.STAT_EVENT,P=>{P.stat===Ah.PROXY?ie(vt,`RPC '${e}' stream ${s} detected buffering proxy`):P.stat===Ah.NOPROXY&&ie(vt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{S.wo()},0),S}}function Nd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(t){return new vI(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e,n,r=1e3,s=1.5,a=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&ie("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(e,n,r,s,a,o,c,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new fw(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===W.RESOURCE_EXHAUSTED?(sr(n.toString()),sr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===W.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new re(W.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ie("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(ie("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class uA extends pw{constructor(e,n,r,s,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=a}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=_I(this.serializer,e),r=function(a){if(!("targetChange"in a))return he.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?he.min():o.readTime?kn(o.readTime):he.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Uh(this.serializer),n.addTarget=function(a,o){let c;const u=o.target;if(c=Dh(u)?{documents:TI(a,u)}:{query:jI(a,u)._t},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=iw(a,o.resumeToken);const d=Oh(a,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(he.min())>0){c.readTime=Ec(a,o.snapshotVersion.toTimestamp());const d=Oh(a,o.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const r=CI(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Uh(this.serializer),n.removeTarget=e,this.a_(n)}}class dA extends pw{constructor(e,n,r,s,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Te(!!e.streamToken),this.lastStreamToken=e.streamToken,Te(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Te(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=EI(e.writeResults,e.commitTime),r=kn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Uh(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>NI(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hA extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new re(W.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Mo(e,Lh(n,r),s,a,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new re(W.UNKNOWN,a.toString())})}Lo(e,n,r,s,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Lo(e,Lh(n,r),s,o,c,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new re(W.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class mA{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(sr(n),this.D_=!1):ie("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e,n,r,s,a){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o(o=>{r.enqueueAndForget(async()=>{ks(this)&&(ie("RemoteStore","Restarting streams for network reachability change."),await async function(u){const d=me(u);d.L_.add(4),await No(d),d.q_.set("Unknown"),d.L_.delete(4),await lu(d)}(this))})}),this.q_=new mA(r,s)}}async function lu(t){if(ks(t))for(const e of t.B_)await e(!0)}async function No(t){for(const e of t.B_)await e(!1)}function gw(t,e){const n=me(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),xf(n)?yf(n):Oi(n).r_()&&gf(n,e))}function pf(t,e){const n=me(t),r=Oi(n);n.N_.delete(e),r.r_()&&yw(n,e),n.N_.size===0&&(r.r_()?r.o_():ks(n)&&n.q_.set("Unknown"))}function gf(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(he.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Oi(t).A_(e)}function yw(t,e){t.Q_.xe(e),Oi(t).R_(e)}function yf(t){t.Q_=new pI({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Oi(t).start(),t.q_.v_()}function xf(t){return ks(t)&&!Oi(t).n_()&&t.N_.size>0}function ks(t){return me(t).L_.size===0}function xw(t){t.Q_=void 0}async function pA(t){t.q_.set("Online")}async function gA(t){t.N_.forEach((e,n)=>{gf(t,e)})}async function yA(t,e){xw(t),xf(t)?(t.q_.M_(e),yf(t)):t.q_.set("Unknown")}async function xA(t,e,n){if(t.q_.set("Online"),e instanceof sw&&e.state===2&&e.cause)try{await async function(s,a){const o=a.cause;for(const c of a.targetIds)s.N_.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.N_.delete(c),s.Q_.removeTarget(c))}(t,e)}catch(r){ie("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Tc(t,r)}else if(e instanceof Ll?t.Q_.Ke(e):e instanceof rw?t.Q_.He(e):t.Q_.We(e),!n.isEqual(he.min()))try{const r=await mw(t.localStore);n.compareTo(r)>=0&&await function(a,o){const c=a.Q_.rt(o);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const m=a.N_.get(d);m&&a.N_.set(d,m.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,d)=>{const m=a.N_.get(u);if(!m)return;a.N_.set(u,m.withResumeToken(ht.EMPTY_BYTE_STRING,m.snapshotVersion)),yw(a,u);const g=new Sr(m.target,u,d,m.sequenceNumber);gf(a,g)}),a.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){ie("RemoteStore","Failed to raise snapshot:",r),await Tc(t,r)}}async function Tc(t,e,n){if(!bo(e))throw e;t.L_.add(1),await No(t),t.q_.set("Offline"),n||(n=()=>mw(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ie("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await lu(t)})}function vw(t,e){return e().catch(n=>Tc(t,n,e))}async function cu(t){const e=me(t),n=Hr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;vA(e);)try{const s=await nA(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,bA(e,s)}catch(s){await Tc(e,s)}bw(e)&&ww(e)}function vA(t){return ks(t)&&t.O_.length<10}function bA(t,e){t.O_.push(e);const n=Hr(t);n.r_()&&n.V_&&n.m_(e.mutations)}function bw(t){return ks(t)&&!Hr(t).n_()&&t.O_.length>0}function ww(t){Hr(t).start()}async function wA(t){Hr(t).p_()}async function _A(t){const e=Hr(t);for(const n of t.O_)e.m_(n.mutations)}async function NA(t,e,n){const r=t.O_.shift(),s=cf.from(r,e,n);await vw(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await cu(t)}async function EA(t,e){e&&Hr(t).V_&&await async function(r,s){if(function(o){return hI(o)&&o!==W.ABORTED}(s.code)){const a=r.O_.shift();Hr(r).s_(),await vw(r,()=>r.remoteSyncer.rejectFailedWrite(a.batchId,s)),await cu(r)}}(t,e),bw(t)&&ww(t)}async function Jy(t,e){const n=me(t);n.asyncQueue.verifyOperationInProgress(),ie("RemoteStore","RemoteStore received new credentials");const r=ks(n);n.L_.add(3),await No(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await lu(n)}async function TA(t,e){const n=me(t);e?(n.L_.delete(2),await lu(n)):e||(n.L_.add(2),await No(n),n.q_.set("Unknown"))}function Oi(t){return t.K_||(t.K_=function(n,r,s){const a=me(n);return a.w_(),new uA(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Eo:pA.bind(null,t),Ro:gA.bind(null,t),mo:yA.bind(null,t),d_:xA.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),xf(t)?yf(t):t.q_.set("Unknown")):(await t.K_.stop(),xw(t))})),t.K_}function Hr(t){return t.U_||(t.U_=function(n,r,s){const a=me(n);return a.w_(),new dA(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:wA.bind(null,t),mo:EA.bind(null,t),f_:_A.bind(null,t),g_:NA.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await cu(t)):(await t.U_.stop(),t.O_.length>0&&(ie("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(e,n,r,s,a){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=a,this.deferred=new Qn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,a){const o=Date.now()+r,c=new vf(e,n,o,s,a);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(W.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function bf(t,e){if(sr("AsyncQueue",`${e}: ${t}`),bo(t))return new re(W.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e){this.comparator=e?(n,r)=>e(n,r)||oe.comparator(n.key,r.key):(n,r)=>oe.comparator(n.key,r.key),this.keyedMap=pa(),this.sortedSet=new Fe(this.comparator)}static emptySet(e){return new ui(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ui)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,a=r.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ui;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(){this.W_=new Fe(oe.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):de():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ti{constructor(e,n,r,s,a,o,c,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,a){const o=[];return n.forEach(c=>{o.push({type:0,doc:c})}),new Ti(e,n,ui.emptySet(n),o,r,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&nu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class SA{constructor(){this.queries=e0(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=me(n),a=s.queries;s.queries=e0(),a.forEach((o,c)=>{for(const u of c.j_)u.onError(r)})})(this,new re(W.ABORTED,"Firestore shutting down"))}}function e0(){return new Mi(t=>qb(t),nu)}async function wf(t,e){const n=me(t);let r=3;const s=e.query;let a=n.queries.get(s);a?!a.H_()&&e.J_()&&(r=2):(a=new jA,r=e.J_()?0:1);try{switch(r){case 0:a.z_=await n.onListen(s,!0);break;case 1:a.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const c=bf(o,`Initialization of query '${Vs(e.query)}' failed`);return void e.onError(c)}n.queries.set(s,a),a.j_.push(e),e.Z_(n.onlineState),a.z_&&e.X_(a.z_)&&Nf(n)}async function _f(t,e){const n=me(t),r=e.query;let s=3;const a=n.queries.get(r);if(a){const o=a.j_.indexOf(e);o>=0&&(a.j_.splice(o,1),a.j_.length===0?s=e.J_()?0:1:!a.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function CA(t,e){const n=me(t);let r=!1;for(const s of e){const a=s.query,o=n.queries.get(a);if(o){for(const c of o.j_)c.X_(s)&&(r=!0);o.z_=s}}r&&Nf(n)}function IA(t,e,n){const r=me(t),s=r.queries.get(e);if(s)for(const a of s.j_)a.onError(n);r.queries.delete(e)}function Nf(t){t.Y_.forEach(e=>{e.next()})}var Bh,t0;(t0=Bh||(Bh={})).ea="default",t0.Cache="cache";class Ef{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ti(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Ti.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Bh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w{constructor(e){this.key=e}}class Nw{constructor(e){this.key=e}}class AA{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=pe(),this.mutatedKeys=pe(),this.Aa=Hb(e),this.Ra=new ui(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Zy,s=n?n.Ra:this.Ra;let a=n?n.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((m,g)=>{const y=s.get(m),x=ru(this.query,g)?g:null,S=!!y&&this.mutatedKeys.has(y.key),E=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let P=!1;y&&x?y.data.isEqual(x.data)?S!==E&&(r.track({type:3,doc:x}),P=!0):this.ga(y,x)||(r.track({type:2,doc:x}),P=!0,(u&&this.Aa(x,u)>0||d&&this.Aa(x,d)<0)&&(c=!0)):!y&&x?(r.track({type:0,doc:x}),P=!0):y&&!x&&(r.track({type:1,doc:y}),P=!0,(u||d)&&(c=!0)),P&&(x?(o=o.add(x),a=E?a.add(m):a.delete(m)):(o=o.delete(m),a=a.delete(m)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),a=a.delete(m.key),r.track({type:1,doc:m})}return{Ra:o,fa:r,ns:c,mutatedKeys:a}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const a=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((m,g)=>function(x,S){const E=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return de()}};return E(x)-E(S)}(m.type,g.type)||this.Aa(m.doc,g.doc)),this.pa(r),s=s!=null&&s;const c=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,d=u!==this.Ea;return this.Ea=u,o.length!==0||d?{snapshot:new Ti(this.query,e.Ra,a,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Zy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=pe(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new Nw(r))}),this.da.forEach(r=>{e.has(r)||n.push(new _w(r))}),n}ba(e){this.Ta=e.Ts,this.da=pe();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Ti.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class kA{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class PA{constructor(e){this.key=e,this.va=!1}}class RA{constructor(e,n,r,s,a,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Mi(c=>qb(c),nu),this.Ma=new Map,this.xa=new Set,this.Oa=new Fe(oe.comparator),this.Na=new Map,this.La=new hf,this.Ba={},this.ka=new Map,this.qa=Ei.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function DA(t,e,n=!0){const r=Iw(t);let s;const a=r.Fa.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.Da()):s=await Ew(r,e,n,!0),s}async function MA(t,e){const n=Iw(t);await Ew(n,e,!0,!1)}async function Ew(t,e,n,r){const s=await rA(t.localStore,An(e)),a=s.targetId,o=t.sharedClientState.addLocalQueryTarget(a,n);let c;return r&&(c=await OA(t,e,a,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&gw(t.remoteStore,s),c}async function OA(t,e,n,r,s){t.Ka=(g,y,x)=>async function(E,P,T,j){let R=P.view.ma(T);R.ns&&(R=await Qy(E.localStore,P.query,!1).then(({documents:I})=>P.view.ma(I,R)));const M=j&&j.targetChanges.get(P.targetId),q=j&&j.targetMismatches.get(P.targetId)!=null,z=P.view.applyChanges(R,E.isPrimaryClient,M,q);return r0(E,P.targetId,z.wa),z.snapshot}(t,g,y,x);const a=await Qy(t.localStore,e,!0),o=new AA(e,a.Ts),c=o.ma(a.documents),u=_o.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(c,t.isPrimaryClient,u);r0(t,n,d.wa);const m=new kA(e,n,o);return t.Fa.set(e,m),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function LA(t,e,n){const r=me(t),s=r.Fa.get(e),a=r.Ma.get(s.targetId);if(a.length>1)return r.Ma.set(s.targetId,a.filter(o=>!nu(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Fh(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&pf(r.remoteStore,s.targetId),$h(r,s.targetId)}).catch(vo)):($h(r,s.targetId),await Fh(r.localStore,s.targetId,!0))}async function VA(t,e){const n=me(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),pf(n.remoteStore,r.targetId))}async function UA(t,e,n){const r=GA(t);try{const s=await function(o,c){const u=me(o),d=le.now(),m=c.reduce((x,S)=>x.add(S.key),pe());let g,y;return u.persistence.runTransaction("Locally write mutations","readwrite",x=>{let S=ir(),E=pe();return u.cs.getEntries(x,m).next(P=>{S=P,S.forEach((T,j)=>{j.isValidDocument()||(E=E.add(T))})}).next(()=>u.localDocuments.getOverlayedDocuments(x,S)).next(P=>{g=P;const T=[];for(const j of c){const R=oI(j,g.get(j.key).overlayedDocument);R!=null&&T.push(new Yr(j.key,R,Ob(R.value.mapValue),sn.exists(!0)))}return u.mutationQueue.addMutationBatch(x,d,T,c)}).next(P=>{y=P;const T=P.applyToLocalDocumentSet(g,E);return u.documentOverlayCache.saveOverlays(x,P.batchId,T)})}).then(()=>({batchId:y.batchId,changes:Wb(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,c,u){let d=o.Ba[o.currentUser.toKey()];d||(d=new Fe(we)),d=d.insert(c,u),o.Ba[o.currentUser.toKey()]=d}(r,s.batchId,n),await Eo(r,s.changes),await cu(r.remoteStore)}catch(s){const a=bf(s,"Failed to persist write");n.reject(a)}}async function Tw(t,e){const n=me(t);try{const r=await eA(n.localStore,e);e.targetChanges.forEach((s,a)=>{const o=n.Na.get(a);o&&(Te(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Te(o.va):s.removedDocuments.size>0&&(Te(o.va),o.va=!1))}),await Eo(n,r,e)}catch(r){await vo(r)}}function n0(t,e,n){const r=me(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((a,o)=>{const c=o.view.Z_(e);c.snapshot&&s.push(c.snapshot)}),function(o,c){const u=me(o);u.onlineState=c;let d=!1;u.queries.forEach((m,g)=>{for(const y of g.j_)y.Z_(c)&&(d=!0)}),d&&Nf(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function FA(t,e,n){const r=me(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),a=s&&s.key;if(a){let o=new Fe(oe.comparator);o=o.insert(a,_t.newNoDocument(a,he.min()));const c=pe().add(a),u=new au(he.min(),new Map,new Fe(we),o,c);await Tw(r,u),r.Oa=r.Oa.remove(a),r.Na.delete(e),Tf(r)}else await Fh(r.localStore,e,!1).then(()=>$h(r,e,n)).catch(vo)}async function BA(t,e){const n=me(t),r=e.batch.batchId;try{const s=await ZI(n.localStore,e);Sw(n,r,null),jw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Eo(n,s)}catch(s){await vo(s)}}async function $A(t,e,n){const r=me(t);try{const s=await function(o,c){const u=me(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let m;return u.mutationQueue.lookupMutationBatch(d,c).next(g=>(Te(g!==null),m=g.keys(),u.mutationQueue.removeMutationBatch(d,g))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,m,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m)).next(()=>u.localDocuments.getDocuments(d,m))})}(r.localStore,e);Sw(r,e,n),jw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Eo(r,s)}catch(s){await vo(s)}}function jw(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Sw(t,e,n){const r=me(t);let s=r.Ba[r.currentUser.toKey()];if(s){const a=s.get(e);a&&(n?a.reject(n):a.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function $h(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||Cw(t,r)})}function Cw(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(pf(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Tf(t))}function r0(t,e,n){for(const r of n)r instanceof _w?(t.La.addReference(r.key,e),zA(t,r)):r instanceof Nw?(ie("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||Cw(t,r.key)):de()}function zA(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(ie("SyncEngine","New document in limbo: "+n),t.xa.add(r),Tf(t))}function Tf(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new oe(Re.fromString(e)),r=t.qa.next();t.Na.set(r,new PA(n)),t.Oa=t.Oa.insert(n,r),gw(t.remoteStore,new Sr(An(tu(n.path)),r,"TargetPurposeLimboResolution",ef.oe))}}async function Eo(t,e,n){const r=me(t),s=[],a=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((c,u)=>{o.push(r.Ka(u,e,n).then(d=>{var m;if((d||n)&&r.isPrimaryClient){const g=d?!d.fromCache:(m=n==null?void 0:n.targetChanges.get(u.targetId))===null||m===void 0?void 0:m.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(d){s.push(d);const g=ff.Wi(u.targetId,d);a.push(g)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(u,d){const m=me(u);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>Y.forEach(d,y=>Y.forEach(y.$i,x=>m.persistence.referenceDelegate.addReference(g,y.targetId,x)).next(()=>Y.forEach(y.Ui,x=>m.persistence.referenceDelegate.removeReference(g,y.targetId,x)))))}catch(g){if(!bo(g))throw g;ie("LocalStore","Failed to update sequence numbers: "+g)}for(const g of d){const y=g.targetId;if(!g.fromCache){const x=m.os.get(y),S=x.snapshotVersion,E=x.withLastLimboFreeSnapshotVersion(S);m.os=m.os.insert(y,E)}}}(r.localStore,a))}async function qA(t,e){const n=me(t);if(!n.currentUser.isEqual(e)){ie("SyncEngine","User change. New user:",e.toKey());const r=await hw(n.localStore,e);n.currentUser=e,function(a,o){a.ka.forEach(c=>{c.forEach(u=>{u.reject(new re(W.CANCELLED,o))})}),a.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Eo(n,r.hs)}}function HA(t,e){const n=me(t),r=n.Na.get(e);if(r&&r.va)return pe().add(r.key);{let s=pe();const a=n.Ma.get(e);if(!a)return s;for(const o of a){const c=n.Fa.get(o);s=s.unionWith(c.view.Va)}return s}}function Iw(t){const e=me(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Tw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=HA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=FA.bind(null,e),e.Ca.d_=CA.bind(null,e.eventManager),e.Ca.$a=IA.bind(null,e.eventManager),e}function GA(t){const e=me(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=BA.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$A.bind(null,e),e}class jc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ou(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return JI(this.persistence,new YI,e.initialUser,this.serializer)}Ga(e){return new WI(mf.Zr,this.serializer)}Wa(e){return new iA}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jc.provider={build:()=>new jc};class zh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>n0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=qA.bind(null,this.syncEngine),await TA(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new SA}()}createDatastore(e){const n=ou(e.databaseInfo.databaseId),r=function(a){return new cA(a)}(e.databaseInfo);return function(a,o,c,u){return new hA(a,o,c,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,a,o,c){return new fA(r,s,a,o,c)}(this.localStore,this.datastore,e.asyncQueue,n=>n0(this.syncEngine,n,0),function(){return Xy.D()?new Xy:new aA}())}createSyncEngine(e,n){return function(s,a,o,c,u,d,m){const g=new RA(s,a,o,c,u,d);return m&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const a=me(s);ie("RemoteStore","RemoteStore shutting down."),a.L_.add(5),await No(a),a.k_.shutdown(),a.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}zh.provider={build:()=>new zh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):sr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(e,n,r,s,a){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=bt.UNAUTHENTICATED,this.clientId=Rb.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,async o=>{ie("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ie("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Qn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=bf(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ed(t,e){t.asyncQueue.verifyOperationInProgress(),ie("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await hw(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function s0(t,e){t.asyncQueue.verifyOperationInProgress();const n=await KA(t);ie("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Jy(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Jy(e.remoteStore,s)),t._onlineComponents=e}async function KA(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ie("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ed(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===W.FAILED_PRECONDITION||s.code===W.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;bi("Error using user provided cache. Falling back to memory cache: "+n),await Ed(t,new jc)}}else ie("FirestoreClient","Using default OfflineComponentProvider"),await Ed(t,new jc);return t._offlineComponents}async function Aw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ie("FirestoreClient","Using user provided OnlineComponentProvider"),await s0(t,t._uninitializedComponentsProvider._online)):(ie("FirestoreClient","Using default OnlineComponentProvider"),await s0(t,new zh))),t._onlineComponents}function QA(t){return Aw(t).then(e=>e.syncEngine)}async function Sc(t){const e=await Aw(t),n=e.eventManager;return n.onListen=DA.bind(null,e.syncEngine),n.onUnlisten=LA.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=MA.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=VA.bind(null,e.syncEngine),n}function YA(t,e,n={}){const r=new Qn;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,c,u,d){const m=new jf({next:y=>{m.Za(),o.enqueueAndForget(()=>_f(a,g));const x=y.docs.has(c);!x&&y.fromCache?d.reject(new re(W.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&y.fromCache&&u&&u.source==="server"?d.reject(new re(W.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(y)},error:y=>d.reject(y)}),g=new Ef(tu(c.path),m,{includeMetadataChanges:!0,_a:!0});return wf(a,g)}(await Sc(t),t.asyncQueue,e,n,r)),r.promise}function XA(t,e,n={}){const r=new Qn;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,c,u,d){const m=new jf({next:y=>{m.Za(),o.enqueueAndForget(()=>_f(a,g)),y.fromCache&&u.source==="server"?d.reject(new re(W.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(y)},error:y=>d.reject(y)}),g=new Ef(c,m,{includeMetadataChanges:!0,_a:!0});return wf(a,g)}(await Sc(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i0=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pw(t,e,n){if(!n)throw new re(W.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function JA(t,e,n,r){if(e===!0&&r===!0)throw new re(W.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function a0(t){if(!oe.isDocumentKey(t))throw new re(W.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function o0(t){if(oe.isDocumentKey(t))throw new re(W.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function uu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":de()}function Bt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re(W.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=uu(t);throw new re(W.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new re(W.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new re(W.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}JA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new re(W.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new re(W.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new re(W.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class du{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new l0({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(W.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(W.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new l0(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new gC;switch(r.type){case"firstParty":return new bC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new re(W.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=i0.get(n);r&&(ie("ComponentProvider","Removing Datastore"),i0.delete(n),r.terminate())}(this),Promise.resolve()}}function ZA(t,e,n,r={}){var s;const a=(t=Bt(t,du))._getSettings(),o=`${e}:${n}`;if(a.host!=="firestore.googleapis.com"&&a.host!==o&&bi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},a),{host:o,ssl:!1})),r.mockUserToken){let c,u;if(typeof r.mockUserToken=="string")c=r.mockUserToken,u=bt.MOCK_USER;else{c=Uv(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new re(W.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new bt(d)}t._authCredentials=new yC(new Pb(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ur(this.firestore,e,this._query)}}class Nt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Nt(this.firestore,e,this._key)}}class Vr extends ur{constructor(e,n,r){super(e,n,tu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Nt(this.firestore,null,new oe(e))}withConverter(e){return new Vr(this.firestore,e,this._path)}}function ge(t,e,...n){if(t=Ce(t),Pw("collection","path",e),t instanceof du){const r=Re.fromString(e,...n);return o0(r),new Vr(t,null,r)}{if(!(t instanceof Nt||t instanceof Vr))throw new re(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Re.fromString(e,...n));return o0(r),new Vr(t.firestore,null,r)}}function ce(t,e,...n){if(t=Ce(t),arguments.length===1&&(e=Rb.newId()),Pw("doc","path",e),t instanceof du){const r=Re.fromString(e,...n);return a0(r),new Nt(t,null,new oe(r))}{if(!(t instanceof Nt||t instanceof Vr))throw new re(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Re.fromString(e,...n));return a0(r),new Nt(t.firestore,t instanceof Vr?t.converter:null,new oe(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c0{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new fw(this,"async_queue_retry"),this.Vu=()=>{const r=Nd();r&&ie("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Nd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Nd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Qn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!bo(e))throw e;ie("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let c=o.message||"";return o.stack&&(c=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),c}(r);throw sr("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=vf.createAndSchedule(this,e,n,r,a=>this.yu(a));return this.Tu.push(s),s}fu(){this.Eu&&de()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function u0(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const a of r)if(a in s&&typeof s[a]=="function")return!0;return!1}(t,["next","error","complete"])}class ar extends du{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new c0,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new c0(e),this._firestoreClient=void 0,await e}}}function e2(t,e){const n=typeof t=="object"?t:Qc(),r=typeof t=="string"?t:"(default)",s=fo(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const a=Bm("firestore");a&&ZA(s,...a)}return s}function hu(t){if(t._terminated)throw new re(W.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||t2(t),t._firestoreClient}function t2(t){var e,n,r;const s=t._freezeSettings(),a=function(c,u,d,m){return new RC(c,u,d,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,kw(m.experimentalLongPollingOptions),m.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new WA(t._authCredentials,t._appCheckCredentials,t._queue,a,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ji(ht.fromBase64String(e))}catch(n){throw new re(W.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ji(ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new re(W.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new re(W.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new re(W.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return we(this._lat,e._lat)||we(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==s[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n2=/^__.*__$/;class r2{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Yr(e,this.data,this.fieldMask,n,this.fieldTransforms):new wo(e,this.data,n,this.fieldTransforms)}}class Rw{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Yr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Dw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw de()}}class Af{constructor(e,n,r,s,a,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,a===void 0&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Af(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Cc(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Dw(this.Cu)&&n2.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class s2{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ou(e)}Qu(e,n,r,s=!1){return new Af({Cu:e,methodName:n,qu:r,path:lt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function fu(t){const e=t._freezeSettings(),n=ou(t._databaseId);return new s2(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Mw(t,e,n,r,s,a={}){const o=t.Qu(a.merge||a.mergeFields?2:0,e,n,s);kf("Data must be an object, but it was:",o,r);const c=Ow(r,o);let u,d;if(a.merge)u=new Gt(o.fieldMask),d=o.fieldTransforms;else if(a.mergeFields){const m=[];for(const g of a.mergeFields){const y=qh(e,g,n);if(!o.contains(y))throw new re(W.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);Vw(m,y)||m.push(y)}u=new Gt(m),d=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,d=o.fieldTransforms;return new r2(new Ot(c),u,d)}class pu extends Sf{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof pu}}function i2(t,e,n,r){const s=t.Qu(1,e,n);kf("Data must be an object, but it was:",s,r);const a=[],o=Ot.empty();As(r,(u,d)=>{const m=Pf(e,u,n);d=Ce(d);const g=s.Nu(m);if(d instanceof pu)a.push(m);else{const y=To(d,g);y!=null&&(a.push(m),o.set(m,y))}});const c=new Gt(a);return new Rw(o,c,s.fieldTransforms)}function a2(t,e,n,r,s,a){const o=t.Qu(1,e,n),c=[qh(e,r,n)],u=[s];if(a.length%2!=0)throw new re(W.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<a.length;y+=2)c.push(qh(e,a[y])),u.push(a[y+1]);const d=[],m=Ot.empty();for(let y=c.length-1;y>=0;--y)if(!Vw(d,c[y])){const x=c[y];let S=u[y];S=Ce(S);const E=o.Nu(x);if(S instanceof pu)d.push(x);else{const P=To(S,E);P!=null&&(d.push(x),m.set(x,P))}}const g=new Gt(d);return new Rw(m,g,o.fieldTransforms)}function o2(t,e,n,r=!1){return To(n,t.Qu(r?4:3,e))}function To(t,e){if(Lw(t=Ce(t)))return kf("Unsupported field value:",e,t),Ow(t,e);if(t instanceof Sf)return function(r,s){if(!Dw(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const a=[];let o=0;for(const c of r){let u=To(c,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}}(t,e)}return function(r,s){if((r=Ce(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return tI(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=le.fromDate(r);return{timestampValue:Ec(s.serializer,a)}}if(r instanceof le){const a=new le(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ec(s.serializer,a)}}if(r instanceof Cf)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ji)return{bytesValue:iw(s.serializer,r._byteString)};if(r instanceof Nt){const a=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(a))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:df(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof If)return function(o,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw c.Bu("VectorValues must only contain numeric values.");return of(c.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${uu(r)}`)}(t,e)}function Ow(t,e){const n={};return Db(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):As(t,(r,s)=>{const a=To(s,e.Mu(r));a!=null&&(n[r]=a)}),{mapValue:{fields:n}}}function Lw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof le||t instanceof Cf||t instanceof ji||t instanceof Nt||t instanceof Sf||t instanceof If)}function kf(t,e,n){if(!Lw(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=uu(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function qh(t,e,n){if((e=Ce(e))instanceof mu)return e._internalPath;if(typeof e=="string")return Pf(t,e);throw Cc("Field path arguments must be of type string or ",t,!1,void 0,n)}const l2=new RegExp("[~\\*/\\[\\]]");function Pf(t,e,n){if(e.search(l2)>=0)throw Cc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new mu(...e.split("."))._internalPath}catch{throw Cc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Cc(t,e,n,r,s){const a=r&&!r.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new re(W.INVALID_ARGUMENT,c+t+u)}function Vw(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uw{constructor(e,n,r,s,a){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Nt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new c2(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(gu("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class c2 extends Uw{data(){return super.data()}}function gu(t,e){return typeof e=="string"?Pf(t,e):e instanceof mu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fw(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new re(W.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Rf{}class Df extends Rf{}function qe(t,e,...n){let r=[];e instanceof Rf&&r.push(e),r=r.concat(n),function(a){const o=a.filter(u=>u instanceof Mf).length,c=a.filter(u=>u instanceof yu).length;if(o>1||o>0&&c>0)throw new re(W.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class yu extends Df{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new yu(e,n,r)}_apply(e){const n=this._parse(e);return $w(e._query,n),new ur(e.firestore,e.converter,Mh(e._query,n))}_parse(e){const n=fu(e.firestore);return function(a,o,c,u,d,m,g){let y;if(d.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new re(W.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){h0(g,m);const x=[];for(const S of g)x.push(d0(u,a,S));y={arrayValue:{values:x}}}else y=d0(u,a,g)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||h0(g,m),y=o2(c,o,g,m==="in"||m==="not-in");return Ye.create(d,m,y)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function rt(t,e,n){const r=e,s=gu("where",t);return yu._create(s,r,n)}class Mf extends Rf{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Mf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:bn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,a){let o=s;const c=a.getFlattenedFilters();for(const u of c)$w(o,u),o=Mh(o,u)}(e._query,n),new ur(e.firestore,e.converter,Mh(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Of extends Df{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Of(e,n)}_apply(e){const n=function(s,a,o){if(s.startAt!==null)throw new re(W.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new re(W.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new no(a,o)}(e._query,this._field,this._direction);return new ur(e.firestore,e.converter,function(s,a){const o=s.explicitOrderBy.concat([a]);return new Di(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function jo(t,e="asc"){const n=e,r=gu("orderBy",t);return Of._create(r,n)}class Lf extends Df{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Lf(e,n,r)}_apply(e){return new ur(e.firestore,e.converter,wc(e._query,this._limit,this._limitType))}}function Bw(t){return Lf._create("limit",t,"F")}function d0(t,e,n){if(typeof(n=Ce(n))=="string"){if(n==="")throw new re(W.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!zb(e)&&n.indexOf("/")!==-1)throw new re(W.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Re.fromString(n));if(!oe.isDocumentKey(r))throw new re(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Py(t,new oe(r))}if(n instanceof Nt)return Py(t,n._key);throw new re(W.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${uu(n)}.`)}function h0(t,e){if(!Array.isArray(t)||t.length===0)throw new re(W.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function $w(t,e){const n=function(s,a){for(const o of s)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new re(W.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new re(W.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class u2{convertValue(e,n="none"){switch(Es(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ge(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ns(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw de()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return As(e,(s,a)=>{r[s]=this.convertValue(a,n)}),r}convertVectorValue(e){var n,r,s;const a=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Ge(o.doubleValue));return new If(a)}convertGeoPoint(e){return new Cf(Ge(e.latitude),Ge(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=nf(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Za(e));default:return null}}convertTimestamp(e){const n=qr(e);return new le(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Re.fromString(e);Te(dw(r));const s=new eo(r.get(1),r.get(3)),a=new oe(r.popFirst(5));return s.isEqual(n)||sr(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zw(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class qw extends Uw{constructor(e,n,r,s,a,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Vl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(gu("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Vl extends qw{data(e={}){return super.data(e)}}class Hw{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new ya(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Vl(this._firestore,this._userDataWriter,r.key,r,new ya(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new re(W.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(c=>{const u=new Vl(s._firestore,s._userDataWriter,c.doc.key,c.doc,new ya(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>a||c.type!==3).map(c=>{const u=new Vl(s._firestore,s._userDataWriter,c.doc.key,c.doc,new ya(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,m=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),m=o.indexOf(c.doc.key)),{type:d2(c.type),doc:u,oldIndex:d,newIndex:m}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function d2(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return de()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function So(t){t=Bt(t,Nt);const e=Bt(t.firestore,ar);return YA(hu(e),t._key).then(n=>Gw(e,t,n))}class Vf extends u2{constructor(e){super(),this.firestore=e}convertBytes(e){return new ji(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Nt(this.firestore,null,n)}}function Rn(t){t=Bt(t,ur);const e=Bt(t.firestore,ar),n=hu(e),r=new Vf(e);return Fw(t._query),XA(n,t._query).then(s=>new Hw(e,r,t,s))}function Dn(t,e,n){t=Bt(t,Nt);const r=Bt(t.firestore,ar),s=zw(t.converter,e,n);return xu(r,[Mw(fu(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,sn.none())])}function Xe(t,e,n,...r){t=Bt(t,Nt);const s=Bt(t.firestore,ar),a=fu(s);let o;return o=typeof(e=Ce(e))=="string"||e instanceof mu?a2(a,"updateDoc",t._key,e,n,r):i2(a,"updateDoc",t._key,e),xu(s,[o.toMutation(t._key,sn.exists(!0))])}function Si(t){return xu(Bt(t.firestore,ar),[new lf(t._key,sn.none())])}function or(t,e){const n=Bt(t.firestore,ar),r=ce(t),s=zw(t.converter,e);return xu(n,[Mw(fu(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,sn.exists(!1))]).then(()=>r)}function _e(t,...e){var n,r,s;t=Ce(t);let a={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||u0(e[o])||(a=e[o],o++);const c={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(u0(e[o])){const g=e[o];e[o]=(n=g.next)===null||n===void 0?void 0:n.bind(g),e[o+1]=(r=g.error)===null||r===void 0?void 0:r.bind(g),e[o+2]=(s=g.complete)===null||s===void 0?void 0:s.bind(g)}let u,d,m;if(t instanceof Nt)d=Bt(t.firestore,ar),m=tu(t._key.path),u={next:g=>{e[o]&&e[o](Gw(d,t,g))},error:e[o+1],complete:e[o+2]};else{const g=Bt(t,ur);d=Bt(g.firestore,ar),m=g._query;const y=new Vf(d);u={next:x=>{e[o]&&e[o](new Hw(d,y,g,x))},error:e[o+1],complete:e[o+2]},Fw(t._query)}return function(y,x,S,E){const P=new jf(E),T=new Ef(x,P,S);return y.asyncQueue.enqueueAndForget(async()=>wf(await Sc(y),T)),()=>{P.Za(),y.asyncQueue.enqueueAndForget(async()=>_f(await Sc(y),T))}}(hu(d),m,c,u)}function xu(t,e){return function(r,s){const a=new Qn;return r.asyncQueue.enqueueAndForget(async()=>UA(await QA(r),s,a)),a.promise}(hu(t),e)}function Gw(t,e,n){const r=n.docs.get(e._key),s=new Vf(t);return new qw(t,s,e._key,r,new ya(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){Ri=s})(Cs),$r(new tr("firestore",(r,{instanceIdentifier:s,options:a})=>{const o=r.getProvider("app").getImmediate(),c=new ar(new xC(r.getProvider("auth-internal")),new _C(r.getProvider("app-check-internal")),function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new re(W.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new eo(d.options.projectId,m)}(o,s),o);return a=Object.assign({useFetchStreams:n},a),c._setSettings(a),c},"PUBLIC").setMultipleInstances(!0)),rn(Sy,"4.7.3",e),rn(Sy,"4.7.3","esm2017")})();var h2="firebase",m2="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rn(h2,m2,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ww="firebasestorage.googleapis.com",Kw="storageBucket",f2=2*60*1e3,p2=10*60*1e3,g2=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be extends Mn{constructor(e,n,r=0){super(Td(e),`Firebase Storage: ${n} (${Td(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Be.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Td(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Me;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Me||(Me={}));function Td(t){return"storage/"+t}function Uf(){const t="An unknown error occurred, please check the error payload for server response.";return new Be(Me.UNKNOWN,t)}function y2(t){return new Be(Me.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function x2(t){return new Be(Me.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function v2(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Be(Me.UNAUTHENTICATED,t)}function b2(){return new Be(Me.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function w2(t){return new Be(Me.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function Qw(){return new Be(Me.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Yw(){return new Be(Me.CANCELED,"User canceled the upload/download.")}function _2(t){return new Be(Me.INVALID_URL,"Invalid URL '"+t+"'.")}function N2(t){return new Be(Me.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function E2(){return new Be(Me.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Kw+"' property when initializing the app?")}function Xw(){return new Be(Me.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function T2(){return new Be(Me.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function j2(){return new Be(Me.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function S2(t){return new Be(Me.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Hh(t){return new Be(Me.INVALID_ARGUMENT,t)}function Jw(){return new Be(Me.APP_DELETED,"The Firebase app was deleted.")}function C2(t){return new Be(Me.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Pa(t,e){return new Be(Me.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function oa(t){throw new Be(Me.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Wt.makeFromUrl(e,n)}catch{return new Wt(e,"")}if(r.path==="")return r;throw N2(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function a(M){M.path.charAt(M.path.length-1)==="/"&&(M.path_=M.path_.slice(0,-1))}const o="(/(.*))?$",c=new RegExp("^gs://"+s+o,"i"),u={bucket:1,path:3};function d(M){M.path_=decodeURIComponent(M.path)}const m="v[A-Za-z0-9_]+",g=n.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",x=new RegExp(`^https?://${g}/${m}/b/${s}/o${y}`,"i"),S={bucket:1,path:3},E=n===Ww?"(?:storage.googleapis.com|storage.cloud.google.com)":n,P="([^?#]*)",T=new RegExp(`^https?://${E}/${s}/${P}`,"i"),R=[{regex:c,indices:u,postModify:a},{regex:x,indices:S,postModify:d},{regex:T,indices:{bucket:1,path:2},postModify:d}];for(let M=0;M<R.length;M++){const q=R[M],z=q.regex.exec(e);if(z){const I=z[q.indices.bucket];let b=z[q.indices.path];b||(b=""),r=new Wt(I,b),q.postModify(r);break}}if(r==null)throw _2(e);return r}}class I2{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A2(t,e,n){let r=1,s=null,a=null,o=!1,c=0;function u(){return c===2}let d=!1;function m(...P){d||(d=!0,e.apply(null,P))}function g(P){s=setTimeout(()=>{s=null,t(x,u())},P)}function y(){a&&clearTimeout(a)}function x(P,...T){if(d){y();return}if(P){y(),m.call(null,P,...T);return}if(u()||o){y(),m.call(null,P,...T);return}r<64&&(r*=2);let R;c===1?(c=2,R=0):R=(r+Math.random())*1e3,g(R)}let S=!1;function E(P){S||(S=!0,y(),!d&&(s!==null?(P||(c=2),clearTimeout(s),g(0)):P||(c=1)))}return g(0),a=setTimeout(()=>{o=!0,E(!0)},n),E}function k2(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P2(t){return t!==void 0}function R2(t){return typeof t=="function"}function D2(t){return typeof t=="object"&&!Array.isArray(t)}function vu(t){return typeof t=="string"||t instanceof String}function m0(t){return Ff()&&t instanceof Blob}function Ff(){return typeof Blob<"u"}function f0(t,e,n,r){if(r<e)throw Hh(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Hh(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Co(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function Zw(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var ms;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ms||(ms={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e_(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,a=e.indexOf(t)!==-1;return n||s||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M2{constructor(e,n,r,s,a,o,c,u,d,m,g,y=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=a,this.additionalRetryCodes_=o,this.callback_=c,this.errorCallback_=u,this.timeout_=d,this.progressCallback_=m,this.connectionFactory_=g,this.retry=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,S)=>{this.resolve_=x,this.reject_=S,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new gl(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const o=c=>{const u=c.loaded,d=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,d)};this.progressCallback_!==null&&a.addUploadProgressListener(o),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(o),this.pendingConnection_=null;const c=a.getErrorCode()===ms.NO_ERROR,u=a.getStatus();if(!c||e_(u,this.additionalRetryCodes_)&&this.retry){const m=a.getErrorCode()===ms.ABORT;r(!1,new gl(!1,null,m));return}const d=this.successCodes_.indexOf(u)!==-1;r(!0,new gl(d,a))})},n=(r,s)=>{const a=this.resolve_,o=this.reject_,c=s.connection;if(s.wasSuccessCode)try{const u=this.callback_(c,c.getResponse());P2(u)?a(u):a()}catch(u){o(u)}else if(c!==null){const u=Uf();u.serverResponse=c.getErrorText(),this.errorCallback_?o(this.errorCallback_(c,u)):o(u)}else if(s.canceled){const u=this.appDelete_?Jw():Yw();o(u)}else{const u=Qw();o(u)}};this.canceled_?n(!1,new gl(!1,null,!0)):this.backoffId_=A2(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&k2(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class gl{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function O2(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function L2(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function V2(t,e){e&&(t["X-Firebase-GMPID"]=e)}function U2(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function F2(t,e,n,r,s,a,o=!0){const c=Zw(t.urlParams),u=t.url+c,d=Object.assign({},t.headers);return V2(d,e),O2(d,n),L2(d,a),U2(d,r),new M2(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B2(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function $2(...t){const e=B2();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(Ff())return new Blob(t);throw new Be(Me.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function z2(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q2(t){if(typeof atob>"u")throw S2("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class jd{constructor(e,n){this.data=e,this.contentType=n||null}}function H2(t,e){switch(t){case Tn.RAW:return new jd(t_(e));case Tn.BASE64:case Tn.BASE64URL:return new jd(n_(t,e));case Tn.DATA_URL:return new jd(W2(e),K2(e))}throw Uf()}function t_(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const a=r,o=t.charCodeAt(++n);r=65536|(a&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function G2(t){let e;try{e=decodeURIComponent(t)}catch{throw Pa(Tn.DATA_URL,"Malformed data URL.")}return t_(e)}function n_(t,e){switch(t){case Tn.BASE64:{const s=e.indexOf("-")!==-1,a=e.indexOf("_")!==-1;if(s||a)throw Pa(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Tn.BASE64URL:{const s=e.indexOf("+")!==-1,a=e.indexOf("/")!==-1;if(s||a)throw Pa(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=q2(e)}catch(s){throw s.message.includes("polyfill")?s:Pa(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class r_{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Pa(Tn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=Q2(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function W2(t){const e=new r_(t);return e.base64?n_(Tn.BASE64,e.rest):G2(e.rest)}function K2(t){return new r_(t).contentType}function Q2(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e,n){let r=0,s="";m0(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(m0(this.data_)){const r=this.data_,s=z2(r,e,n);return s===null?null:new Er(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Er(r,!0)}}static getBlob(...e){if(Ff()){const n=e.map(r=>r instanceof Er?r.data_:r);return new Er($2.apply(null,n))}else{const n=e.map(o=>vu(o)?H2(Tn.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let a=0;return n.forEach(o=>{for(let c=0;c<o.length;c++)s[a++]=o[c]}),new Er(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s_(t){let e;try{e=JSON.parse(t)}catch{return null}return D2(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y2(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function X2(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function i_(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J2(t,e){return e}class Ct{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||J2}}let yl=null;function Z2(t){return!vu(t)||t.length<2?t:i_(t)}function a_(){if(yl)return yl;const t=[];t.push(new Ct("bucket")),t.push(new Ct("generation")),t.push(new Ct("metageneration")),t.push(new Ct("name","fullPath",!0));function e(a,o){return Z2(o)}const n=new Ct("name");n.xform=e,t.push(n);function r(a,o){return o!==void 0?Number(o):o}const s=new Ct("size");return s.xform=r,t.push(s),t.push(new Ct("timeCreated")),t.push(new Ct("updated")),t.push(new Ct("md5Hash",null,!0)),t.push(new Ct("cacheControl",null,!0)),t.push(new Ct("contentDisposition",null,!0)),t.push(new Ct("contentEncoding",null,!0)),t.push(new Ct("contentLanguage",null,!0)),t.push(new Ct("contentType",null,!0)),t.push(new Ct("metadata","customMetadata",!0)),yl=t,yl}function ek(t,e){function n(){const r=t.bucket,s=t.fullPath,a=new Wt(r,s);return e._makeStorageReference(a)}Object.defineProperty(t,"ref",{get:n})}function tk(t,e,n){const r={};r.type="file";const s=n.length;for(let a=0;a<s;a++){const o=n[a];r[o.local]=o.xform(r,e[o.server])}return ek(r,t),r}function o_(t,e,n){const r=s_(e);return r===null?null:tk(t,r,n)}function nk(t,e,n,r){const s=s_(e);if(s===null||!vu(s.downloadTokens))return null;const a=s.downloadTokens;if(a.length===0)return null;const o=encodeURIComponent;return a.split(",").map(d=>{const m=t.bucket,g=t.fullPath,y="/b/"+o(m)+"/o/"+o(g),x=Co(y,n,r),S=Zw({alt:"media",token:d});return x+S})[0]}function l_(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const a=e[s];a.writable&&(n[a.server]=t[a.local])}return JSON.stringify(n)}class Li{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yn(t){if(!t)throw Uf()}function Bf(t,e){function n(r,s){const a=o_(t,s,e);return Yn(a!==null),a}return n}function rk(t,e){function n(r,s){const a=o_(t,s,e);return Yn(a!==null),nk(a,s,t.host,t._protocol)}return n}function Io(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=b2():s=v2():n.getStatus()===402?s=x2(t.bucket):n.getStatus()===403?s=w2(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function c_(t){const e=Io(t);function n(r,s){let a=e(r,s);return r.getStatus()===404&&(a=y2(t.path)),a.serverResponse=s.serverResponse,a}return n}function sk(t,e,n){const r=e.fullServerUrl(),s=Co(r,t.host,t._protocol),a="GET",o=t.maxOperationRetryTime,c=new Li(s,a,Bf(t,n),o);return c.errorHandler=c_(e),c}function ik(t,e,n){const r=e.fullServerUrl(),s=Co(r,t.host,t._protocol),a="GET",o=t.maxOperationRetryTime,c=new Li(s,a,rk(t,n),o);return c.errorHandler=c_(e),c}function ak(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function u_(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=ak(null,e)),r}function ok(t,e,n,r,s){const a=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function c(){let R="";for(let M=0;M<2;M++)R=R+Math.random().toString().slice(2);return R}const u=c();o["Content-Type"]="multipart/related; boundary="+u;const d=u_(e,r,s),m=l_(d,n),g="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+m+`\r
--`+u+`\r
Content-Type: `+d.contentType+`\r
\r
`,y=`\r
--`+u+"--",x=Er.getBlob(g,r,y);if(x===null)throw Xw();const S={name:d.fullPath},E=Co(a,t.host,t._protocol),P="POST",T=t.maxUploadRetryTime,j=new Li(E,P,Bf(t,n),T);return j.urlParams=S,j.headers=o,j.body=x.uploadData(),j.errorHandler=Io(e),j}class Ic{constructor(e,n,r,s){this.current=e,this.total=n,this.finalized=!!r,this.metadata=s||null}}function $f(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Yn(!1)}return Yn(!!n&&(e||["active"]).indexOf(n)!==-1),n}function lk(t,e,n,r,s){const a=e.bucketOnlyServerUrl(),o=u_(e,r,s),c={name:o.fullPath},u=Co(a,t.host,t._protocol),d="POST",m={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},g=l_(o,n),y=t.maxUploadRetryTime;function x(E){$f(E);let P;try{P=E.getResponseHeader("X-Goog-Upload-URL")}catch{Yn(!1)}return Yn(vu(P)),P}const S=new Li(u,d,x,y);return S.urlParams=c,S.headers=m,S.body=g,S.errorHandler=Io(e),S}function ck(t,e,n,r){const s={"X-Goog-Upload-Command":"query"};function a(d){const m=$f(d,["active","final"]);let g=null;try{g=d.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Yn(!1)}g||Yn(!1);const y=Number(g);return Yn(!isNaN(y)),new Ic(y,r.size(),m==="final")}const o="POST",c=t.maxUploadRetryTime,u=new Li(n,o,a,c);return u.headers=s,u.errorHandler=Io(e),u}const p0=256*1024;function uk(t,e,n,r,s,a,o,c){const u=new Ic(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw T2();const d=u.total-u.current;let m=d;s>0&&(m=Math.min(m,s));const g=u.current,y=g+m;let x="";m===0?x="finalize":d===m?x="upload, finalize":x="upload";const S={"X-Goog-Upload-Command":x,"X-Goog-Upload-Offset":`${u.current}`},E=r.slice(g,y);if(E===null)throw Xw();function P(M,q){const z=$f(M,["active","final"]),I=u.current+m,b=r.size();let C;return z==="final"?C=Bf(e,a)(M,q):C=null,new Ic(I,b,z==="final",C)}const T="POST",j=e.maxUploadRetryTime,R=new Li(n,T,P,j);return R.headers=S,R.body=E.uploadData(),R.progressCallback=c||null,R.errorHandler=Io(t),R}const Dt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Sd(t){switch(t){case"running":case"pausing":case"canceling":return Dt.RUNNING;case"paused":return Dt.PAUSED;case"success":return Dt.SUCCESS;case"canceled":return Dt.CANCELED;case"error":return Dt.ERROR;default:return Dt.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(e,n,r){if(R2(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{const a=e;this.next=a.next,this.error=a.error,this.complete=a.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ls(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class hk{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ms.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ms.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ms.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw oa("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const a in s)s.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,s[a].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw oa("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw oa("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw oa("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw oa("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class mk extends hk{initXhr(){this.xhr_.responseType="text"}}function Bs(){return new mk}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=a_(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{if(this._request=void 0,this._chunkMultiplier=1,s._codeEquals(Me.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const a=this.isExponentialBackoffExpired();if(e_(s.status,[]))if(a)s=Qw();else{this.sleepTime=Math.max(this.sleepTime*2,g2),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=s,this._transition("error")}},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals(Me.CANCELED)?this.completeTransitions_():(this._error=s,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((s,a)=>{this._resolve=s,this._reject=a,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const r=lk(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Bs,e,n);this._request=s,s.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const s=ck(this._ref.storage,this._ref._location,e,this._blob),a=this._ref.storage._makeRequest(s,Bs,n,r);this._request=a,a.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=p0*this._chunkMultiplier,n=new Ic(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((s,a)=>{let o;try{o=uk(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(u){this._error=u,this._transition("error");return}const c=this._ref.storage._makeRequest(o,Bs,s,a,!1);this._request=c,c.getPromise().then(u=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(u.current),u.finalized?(this._metadata=u.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){p0*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=sk(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(r,Bs,e,n);this._request=s,s.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=ok(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Bs,e,n);this._request=s,s.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=Yw(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=Sd(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,s){const a=new dk(n||void 0,r||void 0,s||void 0);return this._addObserver(a),()=>{this._removeObserver(a)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Sd(this._state)){case Dt.SUCCESS:Ls(this._resolve.bind(null,this.snapshot))();break;case Dt.CANCELED:case Dt.ERROR:const n=this._reject;Ls(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Sd(this._state)){case Dt.RUNNING:case Dt.PAUSED:e.next&&Ls(e.next.bind(e,this.snapshot))();break;case Dt.SUCCESS:e.complete&&Ls(e.complete.bind(e))();break;case Dt.CANCELED:case Dt.ERROR:e.error&&Ls(e.error.bind(e,this._error))();break;default:e.error&&Ls(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e,n){this._service=e,n instanceof Wt?this._location=n:this._location=Wt.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ts(e,n)}get root(){const e=new Wt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return i_(this._location.path)}get storage(){return this._service}get parent(){const e=Y2(this._location.path);if(e===null)return null;const n=new Wt(this._location.bucket,e);return new Ts(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw C2(e)}}function pk(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new fk(t,new Er(e),n)}function gk(t){t._throwIfRoot("getDownloadURL");const e=ik(t.storage,t._location,a_());return t.storage.makeRequestWithTokens(e,Bs).then(n=>{if(n===null)throw j2();return n})}function yk(t,e){const n=X2(t._location.path,e),r=new Wt(t._location.bucket,n);return new Ts(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xk(t){return/^[A-Za-z]+:\/\//.test(t)}function vk(t,e){return new Ts(t,e)}function d_(t,e){if(t instanceof zf){const n=t;if(n._bucket==null)throw E2();const r=new Ts(n,n._bucket);return e!=null?d_(r,e):r}else return e!==void 0?yk(t,e):t}function bk(t,e){if(e&&xk(e)){if(t instanceof zf)return vk(t,e);throw Hh("To use ref(service, url), the first argument must be a Storage instance.")}else return d_(t,e)}function g0(t,e){const n=e==null?void 0:e[Kw];return n==null?null:Wt.makeFromBucketSpec(n,t)}function wk(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:Uv(s,t.app.options.projectId))}class zf{constructor(e,n,r,s,a){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=a,this._bucket=null,this._host=Ww,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=f2,this._maxUploadRetryTime=p2,this._requests=new Set,s!=null?this._bucket=Wt.makeFromBucketSpec(s,this._host):this._bucket=g0(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Wt.makeFromBucketSpec(this._url,e):this._bucket=g0(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){f0("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){f0("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ts(this,e)}_makeRequest(e,n,r,s,a=!0){if(this._deleted)return new I2(Jw());{const o=F2(e,this._appId,r,s,n,this._firebaseVersion,a);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const y0="@firebase/storage",x0="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h_="storage";function _k(t,e,n){return t=Ce(t),pk(t,e,n)}function Nk(t){return t=Ce(t),gk(t)}function Ek(t,e){return t=Ce(t),bk(t,e)}function Tk(t=Qc(),e){t=Ce(t);const r=fo(t,h_).getImmediate({identifier:e}),s=Bm("storage");return s&&jk(r,...s),r}function jk(t,e,n,r={}){wk(t,e,n,r)}function Sk(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new zf(n,r,s,e,Cs)}function Ck(){$r(new tr(h_,Sk,"PUBLIC").setMultipleInstances(!0)),rn(y0,x0,""),rn(y0,x0,"esm2017")}Ck();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m_="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gh="us-central1";class Ak{constructor(e,n,r,s,a=Gh,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new Ik(n,r,s),this.cancelAllRequests=new Promise(c=>{this.deleteService=()=>Promise.resolve(c())});try{const c=new URL(a);this.customDomain=c.origin+(c.pathname==="/"?"":c.pathname),this.region=Gh}catch{this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function kk(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const v0="@firebase/functions",b0="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pk="auth-internal",Rk="app-check-internal",Dk="messaging-internal";function Mk(t,e){const n=(r,{instanceIdentifier:s})=>{const a=r.getProvider("app").getImmediate(),o=r.getProvider(Pk),c=r.getProvider(Dk),u=r.getProvider(Rk);return new Ak(a,o,c,u,s,t)};$r(new tr(m_,n,"PUBLIC").setMultipleInstances(!0)),rn(v0,b0,e),rn(v0,b0,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ok(t=Qc(),e=Gh){const r=fo(Ce(t),m_).getImmediate({identifier:e}),s=Bm("functions");return s&&Lk(r,...s),r}function Lk(t,e,n){kk(Ce(t),e,n)}Mk(fetch.bind(self));const Vk={apiKey:"AIzaSyB1ddVOczgt5n2NkoIq3H_5x_eB0Aqw2HI",authDomain:"alojamientos-3c46b.firebaseapp.com",projectId:"alojamientos-3c46b",storageBucket:"alojamientos-3c46b.appspot.com",messagingSenderId:"858434059981",appId:"1:858434059981:web:f235cea133b874f985b384"},ee="alojamientos-3c46b",bu=$v(Vk),Ze=fC(bu),te=e2(bu),Uk=Tk(bu);Ok(bu);const f_=async()=>{console.log("🔍 DIAGNÓSTICO COMPLETO DE FIREBASE"),console.log("=====================================");try{console.log("📱 App ID:",ee),console.log(`
📁 Verificando estructura de base de datos...`);const t=ge(te,"artifacts",ee,"public","data","users");console.log("👥 Ruta de usuarios:",`artifacts/${ee}/public/data/users`);try{const e=await Rn(t);if(console.log("👥 Total de usuarios encontrados:",e.size),e.empty)return console.log("❌ No hay usuarios en la colección"),{hasUsers:!1,users:[]};const n=[];e.docs.forEach((a,o)=>{const c=a.data(),u={id:a.id,email:c.email||"Sin email",role:c.role||"Sin rol",status:c.status||"Sin estado",createdAt:c.createdAt||"Sin fecha",fullName:c.fullName||"Sin nombre"};n.push(u),console.log(`👤 Usuario ${o+1}:`,u)}),console.log(`
🏢 Verificando configuración de empresa...`);const r=ce(te,"artifacts",ee,"public","data","settings","company_info"),s=await So(r);s.exists()?(console.log("✅ Configuración de empresa encontrada"),console.log("📋 Configuración:",s.data())):console.log("❌ No hay configuración de empresa"),console.log(`
🔐 Verificando permisos...`);try{const a=qe(t,Bw(1));await Rn(a),console.log("✅ Permisos de lectura OK")}catch(a){console.error("❌ Error de permisos:",a)}return{hasUsers:!0,users:n,hasSettings:s.exists(),settings:s.exists()?s.data():null}}catch(e){return console.error("❌ Error accediendo a usuarios:",e),{hasUsers:!1,error:e.message}}}catch(t){return console.error("❌ Error en diagnóstico:",t),{hasUsers:!1,error:t.message}}},Fk=async()=>{try{console.log("🔍 Buscando usuario más antiguo...");const t=ge(te,"artifacts",ee,"public","data","users");try{const s=qe(t,jo("createdAt","asc"),Bw(1)),a=await Rn(s);if(!a.empty){const o=a.docs[0],c=o.data();return console.log("👑 Usuario más antiguo (con ordenamiento):",{id:o.id,email:c.email,role:c.role,createdAt:c.createdAt}),{user:o,data:c}}}catch(s){console.warn("⚠️ Error con ordenamiento, usando método alternativo:",s)}const e=await Rn(t);if(e.empty)return console.log("❌ No hay usuarios"),null;let n=null,r=null;return e.docs.forEach(s=>{const a=s.data(),o=a.createdAt;o&&(!r||o<r)&&(r=o,n={user:s,data:a})}),n?console.log("👑 Usuario más antiguo (método alternativo):",{id:n.user.id,email:n.data.email,role:n.data.role,createdAt:n.data.createdAt}):console.log("❌ No se pudo determinar el usuario más antiguo"),n}catch(t){return console.error("❌ Error buscando usuario más antiguo:",t),null}},Bk=async()=>{try{console.log("🔐 Verificando usuarios en Authentication...");const t=Ze.currentUser;return t?(console.log("✅ Usuario autenticado encontrado:",t.email),!0):(console.log("⚠️ No hay usuario autenticado, pero asumiendo que hay usuarios en el sistema"),!0)}catch(t){return console.error("❌ Error verificando Authentication:",t),!1}},p_=L.createContext();function $k({message:t,type:e,onClose:n}){const r=e==="success"?"bg-green-500":"bg-red-500";return L.useEffect(()=>{const s=setTimeout(n,4e3);return()=>clearTimeout(s)},[n]),i.jsx("div",{className:`fixed top-5 right-5 ${r} text-white py-2 px-4 rounded-lg shadow-lg animate-fade-in-down`,children:t})}function zk({children:t}){const[e,n]=L.useState([]),r=(a,o="success")=>{const c=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;n(u=>[...u,{id:c,message:a,type:o}])},s=a=>{n(o=>o.filter(c=>c.id!==a))};return i.jsxs(p_.Provider,{value:{addNotification:r},children:[t,i.jsx("div",{className:"fixed top-5 right-5 z-50 space-y-2",children:e.map(a=>i.jsx($k,{message:a.message,type:a.type,onClose:()=>s(a.id)},a.id))})]})}const Ae=()=>L.useContext(p_),Ao=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),g_=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),qk=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),Hk=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M15 21a6 6 0 00-9-5.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-3-5.197m0 0A4 4 0 0112 4.354a4 4 0 013 3.249m-3 7.586a4 4 0 01-3-3.25"})}),Ac=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),Ul=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),y_=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h7"})}),wu=()=>i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),fs=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),Gk=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),Wk=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})}),Vi=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})}),Kk=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),Qk=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-5 5v-5zM4.828 7l2.586 2.586a2 2 0 002.828 0L12 7H4.828zM4.828 17h5l-5-5v5zM12 7l2.586 2.586a2 2 0 002.828 0L20 7h-8z"})}),$t=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),di=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"})}),_u=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),Ci=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),Ur=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),x_=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),en=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),Gr=()=>i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),io=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),kc=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),Yk=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),Xk=()=>i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})});function ko({children:t}){const[e,n]=L.useState(!1),[r,s]=L.useState({top:0,left:0,position:"bottom-right"}),a=L.useRef(null),o=L.useRef(null);L.useEffect(()=>{const u=d=>{a.current&&!a.current.contains(d.target)&&n(!1)};return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[a]),L.useEffect(()=>{if(e&&o.current){const u=o.current.getBoundingClientRect(),d=window.innerHeight,m=window.innerWidth,g=d-u.bottom,y=u.top,x=m-u.right,S=u.left;let E=u.bottom+8,P=u.right-224,T="bottom-right";g<200&&y>g&&(E=u.top-8,T=x>224?"top-right":"top-left"),x<224&&S>224&&(P=u.left-224,T=g>200?"bottom-left":"top-left"),P<8&&(P=8),P+224>m-8&&(P=m-232),E<8&&(E=8),E+200>d-8&&(E=d-208),s({top:E,left:P,position:T})}},[e]);const c=()=>"fixed w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50";return i.jsxs("div",{className:"relative inline-block text-left",ref:a,children:[i.jsxs("button",{ref:o,onClick:()=>n(!e),className:"inline-flex justify-center w-full rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:["Acciones ",i.jsx(Wk,{className:"-mr-1 ml-2 h-5 w-5"})]}),e&&i.jsx("div",{className:c(),style:{top:`${r.top}px`,left:`${r.left}px`},children:i.jsx("div",{className:"py-1",role:"menu","aria-orientation":"vertical",onClick:()=>n(!1),children:t})})]})}function Jk({isOpen:t,onClose:e,onSave:n,service:r,clients:s,isDemo:a}){var $;const{addNotification:o}=Ae(),[c,u]=L.useState({}),[d,m]=L.useState(""),[g,y]=L.useState(""),[x,S]=L.useState(""),[E,P]=L.useState(!1),[T,j]=L.useState(""),[R,M]=L.useState(!1),q=["Activo","Periodo de Gracia Vencido","Pendiente Pago","Pago","Cancelado"],z=()=>{const D=new Date,V=D.getFullYear().toString().slice(-2),O=(D.getMonth()+1).toString().padStart(2,"0"),v=D.getDate().toString().padStart(2,"0"),A=D.getTime().toString().slice(-6);return`SRV-${V}${O}${v}-${A}`},I=(D,V)=>{if(!D||D==="One-Time"||!V)return{startDate:"",endDate:""};const O=new Date(V);let v=new Date(O);switch(D){case"Monthly":v.setMonth(v.getMonth()+1);break;case"Semiannually":v.setMonth(v.getMonth()+6);break;case"Annually":v.setFullYear(v.getFullYear()+1);break;case"Biennially":v.setFullYear(v.getFullYear()+2);break;case"Triennially":v.setFullYear(v.getFullYear()+3);break;case"Custom":return{startDate:O.toISOString().split("T")[0],endDate:""};default:if(D&&D!=="Custom"&&D!=="One-Time"){const A=D.match(/(\d+)\s*mes/i),F=D.match(/(\d+)\s*año/i);if(A){const K=parseInt(A[1]);v.setMonth(v.getMonth()+K)}else if(F){const K=parseInt(F[1]);v.setFullYear(v.getFullYear()+K)}else return{startDate:O.toISOString().split("T")[0],endDate:""}}else return{startDate:"",endDate:""};break}return{startDate:O.toISOString().split("T")[0],endDate:v.toISOString().split("T")[0]}},b=()=>[{value:"One-Time",label:"Pago único"},{value:"Monthly",label:"Mensual"},{value:"Semiannually",label:"Semestral"},{value:"Annually",label:"Anual"},{value:"Biennially",label:"Bianual (2 años)"},{value:"Triennially",label:"Trienal (3 años)"},{value:"Custom",label:"Otros"}];L.useEffect(()=>{const D={clientName:"",clientEmail:"",serviceType:"Hosting",description:"",amount:"",currency:"USD",dueDate:"",billingCycle:"One-Time",status:"Activo",clientNotes:"",adminNotes:"",assignedUserId:""};if(r){u({...r,dueDate:r.dueDate?new Date(r.dueDate.seconds*1e3).toISOString().split("T")[0]:"",assignedUserId:r.assignedUserId||""}),y(r.serviceNumber||"");const V=["Hosting","Dominio","Dominio + Hosting"];r.serviceType&&!V.includes(r.serviceType)?(j(r.serviceType),M(!0)):(j(""),M(!1));const O=["One-Time","Monthly","Semiannually","Annually","Biennially","Triennially"];if(r.billingCycle&&!O.includes(r.billingCycle)?(S(r.billingCycle),P(!0)):(S(""),P(!1)),r.assignedUserId){const v=s.find(A=>A.id===r.assignedUserId);v&&m(v.email)}}else{const V=z();u(D),m(""),y(V),j(""),M(!1),S(""),P(!1)}},[r,s]);const C=D=>{const{name:V,value:O}=D.target;u(v=>({...v,[V]:O})),V==="billingCycle"&&(O==="Custom"?P(!0):(P(!1),S(""))),V==="serviceType"&&(O==="Otro"?M(!0):(M(!1),j("")))},p=D=>{const V=D.target.value;S(V),u(O=>({...O,billingCycle:V||"Custom"}))},k=D=>{const V=D.target.value;j(V),u(O=>({...O,serviceType:V||"Otro"}))},w=D=>{m(D);const V=s.find(O=>O.email===D);u(V?O=>({...O,clientEmail:V.email,clientName:V.fullName||V.email.split("@")[0],assignedUserId:V.id}):O=>({...O,assignedUserId:""}))},N=async D=>{if(D.preventDefault(),a){o("Función no disponible en modo demo.","error");return}try{const V={...c,amount:parseFloat(c.amount),dueDate:le.fromDate(new Date(c.dueDate)),serviceNumber:g};await n(V),o(`Servicio ${r?"actualizado":"creado"} exitosamente.`,"success"),e()}catch(V){o("Error al guardar el servicio.","error"),console.error(V)}};return t?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:r?"Editar Servicio":"Añadir Nuevo Servicio"}),i.jsxs("form",{onSubmit:N,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Número de Servicio"}),i.jsx("input",{type:"text",value:g,onChange:D=>y(D.target.value),className:"w-full p-2 border rounded-md bg-gray-50 font-mono",placeholder:"SRV-YYMMDD-XXXXXX",required:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Identificador único del servicio"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asignar a Cliente Existente"}),i.jsxs("select",{value:d,onChange:D=>w(D.target.value),className:"w-full p-2 border rounded-md bg-gray-50",children:[i.jsx("option",{value:"",children:"-- Opcional --"}),s.map(D=>i.jsx("option",{value:D.email,children:D.fullName||D.email},D.id))]}),d&&i.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["✓ Servicio asignado a: ",(($=s.find(D=>D.email===d))==null?void 0:$.fullName)||d]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx("input",{name:"clientName",value:c.clientName||"",onChange:C,placeholder:"Nombre del Cliente",className:"w-full p-2 border rounded-md",required:!0}),i.jsx("input",{name:"clientEmail",type:"email",value:c.clientEmail||"",onChange:C,placeholder:"Email del Cliente",className:"w-full p-2 border rounded-md",required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Servicio"}),i.jsxs("select",{name:"serviceType",value:c.serviceType||"Hosting",onChange:C,className:"w-full p-2 border rounded-md",children:[i.jsx("option",{children:"Hosting"}),i.jsx("option",{children:"Dominio"}),i.jsx("option",{children:"Dominio + Hosting"}),i.jsx("option",{children:"Otro"})]}),R&&i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Especificar tipo de servicio personalizado"}),i.jsx("input",{type:"text",value:T,onChange:k,placeholder:"Ej: VPS, Cloud Storage, SSL, etc.",className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Escribe el tipo de servicio específico que ofreces"})]})]}),i.jsx("input",{name:"description",value:c.description||"",onChange:C,placeholder:"Descripción (ej: plan, dominio.com)",className:"w-full p-2 border rounded-md"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx("input",{name:"amount",type:"number",step:"0.01",value:c.amount||"",onChange:C,placeholder:"Monto",className:"w-full p-2 border rounded-md",required:!0}),i.jsxs("select",{name:"currency",value:c.currency||"USD",onChange:C,className:"w-full p-2 border rounded-md",children:[i.jsx("option",{children:"USD"}),i.jsx("option",{children:"COP"})]}),i.jsx("input",{name:"dueDate",type:"date",value:c.dueDate||"",onChange:C,className:"w-full p-2 border rounded-md",required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ciclo de Facturación"}),i.jsx("select",{name:"billingCycle",value:c.billingCycle||"One-Time",onChange:C,className:"w-full p-2 border rounded-md",children:b().map(D=>i.jsx("option",{value:D.value,children:D.label},D.value))}),E&&i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Especificar ciclo personalizado"}),i.jsx("input",{type:"text",value:x,onChange:p,placeholder:"Ej: 6 meses, 18 meses, 2 años, etc.",className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Puedes escribir el período en meses o años (ej: "6 meses", "2 años")'})]})]}),i.jsx("select",{name:"status",value:c.status||"Activo",onChange:C,className:"w-full p-2 border rounded-md",children:q.map(D=>i.jsx("option",{value:D,children:D},D))})]}),c.billingCycle&&c.billingCycle!=="One-Time"&&c.dueDate&&i.jsxs("div",{className:"bg-blue-50 p-4 rounded-md",children:[i.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Período del Servicio"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-blue-700 mb-1",children:"Fecha de Inicio"}),i.jsx("input",{type:"date",value:I(c.billingCycle,c.dueDate).startDate,readOnly:!0,className:"w-full p-2 border border-blue-200 rounded-md bg-blue-50 text-blue-800"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-blue-700 mb-1",children:"Fecha de Vencimiento"}),i.jsx("input",{type:"date",value:I(c.billingCycle,c.dueDate).endDate,readOnly:!0,className:"w-full p-2 border border-blue-200 rounded-md bg-blue-50 text-blue-800"})]})]})]}),c.billingCycle==="One-Time"&&i.jsxs("div",{className:"bg-yellow-50 p-4 rounded-md",children:[i.jsx("h4",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Pago Único"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"radio",id:"activation-only",name:"oneTimeType",value:"activation-only",className:"text-yellow-600"}),i.jsx("label",{htmlFor:"activation-only",className:"text-sm text-yellow-700",children:"Solo fecha de activación (sin expiración)"})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"radio",id:"with-expiration",name:"oneTimeType",value:"with-expiration",className:"text-yellow-600"}),i.jsx("label",{htmlFor:"with-expiration",className:"text-sm text-yellow-700",children:"Con fecha de expiración"})]}),i.jsxs("div",{className:"ml-6",children:[i.jsx("label",{className:"block text-xs font-medium text-yellow-700 mb-1",children:"Hasta qué fecha expira"}),i.jsx("input",{type:"date",name:"expirationDate",value:c.expirationDate||"",onChange:C,className:"w-full p-2 border border-yellow-200 rounded-md"})]})]})]}),i.jsx("textarea",{name:"clientNotes",value:c.clientNotes||"",onChange:C,placeholder:"Notas para el cliente (visible en su portal)",rows:"3",className:"w-full p-2 border rounded-md"}),i.jsx("textarea",{name:"adminNotes",value:c.adminNotes||"",onChange:C,placeholder:"Notas internas (solo para administrador)",rows:"3",className:"w-full p-2 border rounded-md"}),i.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[i.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Guardar Servicio"})]})]})]})}):null}function Zk({isOpen:t,onClose:e,onSend:n,service:r,templates:s,companySettings:a,isDemo:o}){const{addNotification:c}=Ae(),[u,d]=L.useState(""),[m,g]=L.useState(""),[y,x]=L.useState("");if(L.useEffect(()=>{var E;s.length>0&&t&&d(((E=s[0])==null?void 0:E.id)||"")},[s,t]),L.useEffect(()=>{var E;if(u&&r){const P=s.find(T=>T.id===u);if(P){const T=r.dueDate?new Date(r.dueDate.seconds*1e3).toLocaleDateString():"N/A",j={"{clientName}":r.clientName||"","{serviceType}":r.serviceType||"","{description}":r.description||"","{amount}":`$${(E=r.amount)==null?void 0:E.toFixed(2)} ${r.currency}`||"","{dueDate}":T,"{companyName}":a.companyName||"Tu Empresa"};let R=P.subject,M=P.body;for(const q in j){const z=new RegExp(q.replace(/[-\\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g");R=R.replace(z,j[q]),M=M.replace(z,j[q])}g(R),x(M)}}},[u,r,s,a]),!t)return null;const S=()=>{var E;n({to:r.clientEmail,subject:m,body:y,reason:`Notificación Manual: ${((E=s.find(P=>P.id===u))==null?void 0:E.name)||"Mensaje Personalizado"}`}),e()};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full",children:[i.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Enviar Notificación a ",r.clientName]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Seleccionar Plantilla"}),i.jsx("select",{value:u,onChange:E=>d(E.target.value),className:"mt-1 w-full p-2 border rounded-md",children:s.map(E=>i.jsx("option",{value:E.id,children:E.name},E.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Asunto"}),i.jsx("input",{type:"text",value:m,onChange:E=>g(E.target.value),className:"mt-1 w-full p-2 border rounded-md"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cuerpo del Mensaje (Editable)"}),i.jsx("textarea",{value:y,onChange:E=>x(E.target.value),rows:"10",className:"mt-1 w-full p-2 border rounded-md font-mono text-sm"})]})]}),i.jsxs("div",{className:"flex justify-end gap-4 mt-8",children:[i.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),i.jsx("button",{onClick:S,className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Enviar"})]})]})})}function eP({isDemo:t,userRole:e}){const{addNotification:n}=Ae(),[r,s]=L.useState([]),[a,o]=L.useState([]),[c,u]=L.useState(!1),[d,m]=L.useState(null),[g,y]=L.useState("Todos"),[x,S]=L.useState(""),[E,P]=L.useState(!1),[T,j]=L.useState([]),[R,M]=L.useState({}),q=["Activo","Periodo de Gracia Vencido","Pendiente Pago","Pago","Cancelado"];L.useEffect(()=>{if(t){const X=le.fromDate(new Date);s([{id:"s1",clientName:"Juan Perez (Demo)",clientEmail:"juan@demo.com",serviceType:"Hosting",description:"Plan Pro",amount:25,currency:"USD",dueDate:X,billingCycle:"Monthly",status:"Pendiente Pago",clientNotes:"A la espera del pago.",adminNotes:"Contactado por teléfono."},{id:"s2",clientName:"Maria Garcia (Demo)",clientEmail:"maria@demo.com",serviceType:"Dominio",description:"nuevositio.co",amount:5e4,currency:"COP",dueDate:X,billingCycle:"Annually",status:"Pago",clientNotes:"",adminNotes:""},{id:"s3",clientName:"Carlos Lopez (Demo)",clientEmail:"carlos@demo.com",serviceType:"Mantenimiento",description:"Sitio Web",amount:150,currency:"USD",dueDate:X,billingCycle:"Monthly",status:"Activo",clientNotes:"Servicio funcionando correctamente.",adminNotes:"Cliente satisfecho."},{id:"s4",clientName:"Ana Rodriguez (Demo)",clientEmail:"ana@demo.com",serviceType:"Hosting",description:"Plan Básico",amount:15,currency:"USD",dueDate:X,billingCycle:"Monthly",status:"Periodo de Gracia Vencido",clientNotes:"Necesita renovar pronto.",adminNotes:"Enviar recordatorio urgente."},{id:"s5",clientName:"Pedro Martinez (Demo)",clientEmail:"pedro@demo.com",serviceType:"Dominio",description:"tiendaonline.com",amount:12e4,currency:"COP",dueDate:X,billingCycle:"Annually",status:"Cancelado",clientNotes:"Cliente canceló el servicio.",adminNotes:"Cancelación por solicitud del cliente."}]),o([{id:"c1",email:"juan@demo.com",fullName:"Juan Perez (Demo)"},{id:"c2",email:"maria@demo.com",fullName:"Maria Garcia (Demo)"}]),j([{id:"t1",name:"Recordatorio General (Demo)",subject:"Recordatorio de pago",body:"Hola {clientName}, recuerda pagar..."}]),M({companyName:"Tu Empresa (Demo)"});return}const V=ge(te,"artifacts",ee,"public","data","services"),O=qe(V,jo("dueDate","desc")),v=_e(O,X=>{s(X.docs.map(ae=>({id:ae.id,...ae.data()})))}),A=ge(te,"artifacts",ee,"public","data","users"),F=qe(A,rt("role","==","client")),K=_e(F,X=>{o(X.docs.map(ae=>({id:ae.id,...ae.data()})))}),G=ge(te,"artifacts",ee,"public","data","messageTemplates"),Z=_e(G,X=>{j(X.docs.map(ae=>({id:ae.id,...ae.data()})))}),U=ce(te,"artifacts",ee,"public","data","settings","company"),Q=_e(U,X=>{X.exists()&&M(X.data())});return()=>{v(),K(),Z(),Q()}},[t]);const z=async V=>{if(t){n("Función no disponible en modo demo.","error");return}const O=ge(te,"artifacts",ee,"public","data","services");try{if(V.id){const{id:v,...A}=V;await Xe(ce(O,v),A)}else await or(O,{...V,createdAt:le.now()})}catch(v){throw v}},I=async V=>{if(t){n("Función no disponible en modo demo.","error");return}if(window.confirm("¿Seguro que quieres eliminar este servicio?"))try{await Si(ce(te,"artifacts",ee,"public","data","services",V)),n("Servicio eliminado.","success")}catch{n("Error al eliminar el servicio.","error")}},b=async V=>{if(t){n(`Simulación: Enviando correo a ${V.to}.`,"success");return}try{await or(ge(te,"artifacts",ee,"public","data","messageHistory"),{...V,sentAt:le.now()}),n("Notificación registrada en el historial.","success")}catch{n("Error al registrar la notificación.","error")}},C=async(V,O)=>{if(t){n("Función no disponible en modo demo.","error");return}try{await Xe(ce(te,"artifacts",ee,"public","data","services",V),{status:O}),n("Estado actualizado.","success")}catch{n("Error al actualizar estado.","error")}},p=V=>V.status==="Pendiente Pago"&&V.dueDate&&V.dueDate.toDate()<new Date?"Periodo de Gracia Vencido":V.status,k=(V,O)=>{if(!O)return"text-gray-500";const v=new Date,F=(O.toDate()-v)/(1e3*60*60*24);return V==="Pago"?"text-green-600":V==="Cancelado"?"text-gray-500":V==="Periodo de Gracia Vencido"||F<0?"text-red-600 font-bold":V==="Pendiente Pago"&&F<7?"text-yellow-600 font-semibold":V==="Activo"?"text-blue-600":"text-gray-700"},w=V=>{if(!V.dueDate||!V.billingCycle||V.billingCycle==="One-Time")return V.expirationDate?V.expirationDate.toDate().toLocaleDateString():"N/A";const O=V.dueDate.toDate();let v=new Date(O);switch(V.billingCycle){case"Monthly":v.setMonth(v.getMonth()+1);break;case"Semiannually":v.setMonth(v.getMonth()+6);break;case"Annually":v.setFullYear(v.getFullYear()+1);break;case"Biennially":v.setFullYear(v.getFullYear()+2);break;case"Triennially":v.setFullYear(v.getFullYear()+3);break;default:return"N/A"}return v.toLocaleDateString()},N=V=>({"One-Time":"Pago único",Monthly:"Mensual",Semiannually:"Semestral",Annually:"Anual",Biennially:"Bianual",Triennially:"Trienal",Custom:"Personalizado"})[V]||V,$=V=>{m(V),P(!0)},D=r.filter(V=>g==="Todos"||p(V)===g).filter(V=>{var A,F,K,G,Z,U,Q,X,ae,Ne;if(!x)return!0;const O=x.toLowerCase(),v=p(V);return((A=V.clientName)==null?void 0:A.toLowerCase().includes(O))||((F=V.clientEmail)==null?void 0:F.toLowerCase().includes(O))||((K=V.serviceType)==null?void 0:K.toLowerCase().includes(O))||((G=V.description)==null?void 0:G.toLowerCase().includes(O))||((Z=V.amount)==null?void 0:Z.toString().includes(O))||((U=V.currency)==null?void 0:U.toLowerCase().includes(O))||((Q=V.billingCycle)==null?void 0:Q.toLowerCase().includes(O))||(v==null?void 0:v.toLowerCase().includes(O))||((X=V.clientNotes)==null?void 0:X.toLowerCase().includes(O))||((ae=V.adminNotes)==null?void 0:ae.toLowerCase().includes(O))||V.dueDate&&new Date(V.dueDate.seconds*1e3).toLocaleDateString().includes(O)||V.dueDate&&((Ne=V.dueDate.seconds)==null?void 0:Ne.toString().includes(O))});return i.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[i.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[i.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[["Todos",...q].map(V=>i.jsx("button",{onClick:()=>y(V),className:`px-4 py-2 rounded-full text-sm font-semibold transition-colors ${g===V?"bg-blue-600 text-white shadow-lg":"bg-white hover:bg-gray-100"}`,children:V},V)),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",placeholder:"Buscar en toda la tabla...",value:x,onChange:V=>S(V.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full sm:w-64"}),i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Vi,{})})]})]}),i.jsxs("button",{onClick:()=>{m(null),u(!0)},className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700",children:[i.jsx(Ao,{})," ",i.jsx("span",{className:"hidden sm:inline",children:"Nuevo Servicio"})]})]}),i.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:i.jsxs("table",{className:"w-full text-left",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsx("tr",{children:["Número","Cliente","Servicio","Monto","Ciclo","Fecha de Inicio","Fecha de Vencimiento","Notas","Estado","Acciones"].map(V=>i.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:V},V))})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:D.map(V=>{var v;const O=p(V);return i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:V.serviceNumber||"N/A"})}),i.jsxs("td",{className:"px-6 py-4",children:[i.jsx("div",{className:"font-medium",children:V.clientName}),i.jsx("div",{className:"text-sm text-gray-500",children:V.clientEmail})]}),i.jsxs("td",{className:"px-6 py-4",children:[i.jsx("div",{className:"font-semibold",children:V.serviceType}),i.jsx("div",{className:"text-sm text-gray-600",children:V.description})]}),i.jsxs("td",{className:"px-6 py-4 font-semibold",children:[(v=V.amount)==null?void 0:v.toFixed(2)," ",V.currency]}),i.jsxs("td",{className:"px-6 py-4",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:N(V.billingCycle)}),V.billingCycle==="Custom"&&V.customBillingCycle&&i.jsxs("div",{className:"text-xs text-gray-500",children:["(",V.customBillingCycle,")"]})]}),i.jsxs("td",{className:`px-6 py-4 ${k(O,V.dueDate)}`,children:[i.jsx("div",{className:"text-sm",children:V.dueDate?V.dueDate.toDate().toLocaleDateString():"N/A"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Inicio"})]}),i.jsxs("td",{className:"px-6 py-4",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:w(V)}),i.jsx("div",{className:"text-xs text-gray-500",children:"Vencimiento"})]}),i.jsxs("td",{className:"px-6 py-4 text-xs max-w-xs",children:[V.clientNotes&&i.jsxs("div",{className:"truncate",title:V.clientNotes,children:[i.jsx("strong",{children:"Cliente:"})," ",V.clientNotes]}),V.adminNotes&&i.jsxs("div",{className:"truncate text-purple-600 mt-1",title:V.adminNotes,children:[i.jsx("strong",{children:"Admin:"})," ",V.adminNotes]})]}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("select",{value:V.status,onChange:A=>C(V.id,A.target.value),className:"p-1 text-xs rounded-md border-gray-300 bg-white shadow-sm w-full",children:q.map(A=>i.jsx("option",{value:A,children:A},A))})}),i.jsx("td",{className:"px-6 py-4 text-center",children:i.jsxs(ko,{children:[i.jsx("button",{onClick:()=>{m(V),u(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Editar"}),i.jsx("button",{onClick:()=>$(V),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Enviar Notificación"}),i.jsx("button",{onClick:()=>I(V.id),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"Eliminar"})]})})]},V.id)})})]})}),i.jsx(Jk,{isOpen:c,onClose:()=>u(!1),onSave:z,service:d,clients:a,isDemo:t}),i.jsx(Zk,{isOpen:E,onClose:()=>P(!1),onSend:b,service:d,templates:T,companySettings:R,isDemo:t})]})}function tP({isOpen:t,onClose:e,onSave:n,user:r,isDemo:s}){const{addNotification:a}=Ae(),[o,c]=L.useState({});L.useEffect(()=>{r&&c(r)},[r]);const u=m=>{const{name:g,value:y}=m.target;c(x=>({...x,[g]:y}))},d=async m=>{m.preventDefault();try{await n(o),a("Usuario actualizado.","success"),e()}catch{a("Error al actualizar usuario.","error")}};return t?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-lg w-full",children:[i.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Editar Usuario"}),i.jsxs("form",{onSubmit:d,className:"space-y-4",children:[i.jsx("input",{name:"fullName",value:o.fullName||"",onChange:u,placeholder:"Nombre Completo",className:"w-full p-2 border rounded-md"}),i.jsx("input",{name:"identification",value:o.identification||"",onChange:u,placeholder:"Identificación",className:"w-full p-2 border rounded-md"}),i.jsx("input",{type:"email",value:o.email||"",readOnly:!0,disabled:!0,className:"w-full p-2 border rounded-md bg-gray-100"}),i.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[i.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Guardar Cambios"})]})]})]})}):null}function nP({isOpen:t,onClose:e,onSave:n,isDemo:r}){const{addNotification:s}=Ae(),[a,o]=L.useState(""),[c,u]=L.useState(""),[d,m]=L.useState(""),[g,y]=L.useState(""),[x,S]=L.useState("client"),[E,P]=L.useState("active"),[T,j]=L.useState(!1),[R,M]=L.useState(""),q=[{value:"client",label:"Cliente"},{value:"admin",label:"Administrador"},{value:"superadmin",label:"Super Administrador"}],z=[{value:"active",label:"Activo"},{value:"inactive",label:"Inactivo"},{value:"pending",label:"Pendiente"}],I=()=>{o(""),u(""),m(""),y(""),S("client"),P("active"),j(!1),M("")},b=()=>{I(),e()},C=async p=>{if(p.preventDefault(),c.length<6){M("La contraseña debe tener al menos 6 caracteres.");return}M("");try{await n({email:a,password:c,notify:T,fullName:d,identification:g,role:x,status:E}),e()}catch{s("Error al crear usuario.","error")}};return t?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-md w-full",children:[i.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Crear Nuevo Usuario"}),i.jsxs("form",{onSubmit:C,className:"space-y-4",children:[i.jsx("input",{type:"email",value:a,onChange:p=>o(p.target.value),placeholder:"Email del nuevo usuario",className:"w-full p-2 border rounded-md",required:!0}),i.jsx("input",{type:"password",value:c,onChange:p=>u(p.target.value),placeholder:"Contraseña temporal",className:"w-full p-2 border rounded-md",required:!0}),i.jsx("input",{value:d,onChange:p=>m(p.target.value),placeholder:"Nombre Completo",className:"w-full p-2 border rounded-md"}),i.jsx("input",{value:g,onChange:p=>y(p.target.value),placeholder:"Identificación",className:"w-full p-2 border rounded-md"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),i.jsx("select",{value:x,onChange:p=>S(p.target.value),className:"w-full p-2 border rounded-md",required:!0,children:q.map(p=>i.jsx("option",{value:p.value,children:p.label},p.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),i.jsx("select",{value:E,onChange:p=>P(p.target.value),className:"w-full p-2 border rounded-md",required:!0,children:z.map(p=>i.jsx("option",{value:p.value,children:p.label},p.value))})]})]}),R&&i.jsx("p",{className:"text-red-500 text-sm",children:R}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{id:"notify",type:"checkbox",checked:T,onChange:p=>j(p.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"notify",className:"ml-2 block text-sm text-gray-900",children:"Notificar al usuario por correo"})]}),i.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[i.jsx("button",{type:"button",onClick:b,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Crear Usuario"})]})]})]})}):null}function rP({isOpen:t,onClose:e,user:n,onActivate:r}){const{addNotification:s}=Ae(),[a,o]=L.useState(""),[c,u]=L.useState(!1),d=`Hola ${(n==null?void 0:n.fullName)||(n==null?void 0:n.email)},

Tu cuenta ha sido activada exitosamente en nuestro sistema de gestión de cobros.

Ahora puedes:
• Ver tus servicios contratados
• Crear tickets de soporte
• Gestionar tu perfil

Para acceder, simplemente inicia sesión con tu email y contraseña.

¡Bienvenido!

Equipo de Soporte`,m=async()=>{u(!0);try{await r(),await or(ge(te,"artifacts",ee,"public","data","messageHistory"),{to:n.email,subject:"Cuenta Activada - Sistema de Gestión de Cobros",body:a||d,reason:"Activación de Usuario",sentAt:le.now(),type:"activation"}),s(`Usuario ${n.email} activado y notificado exitosamente`,"success"),e()}catch(g){s("Error al activar usuario","error"),console.error("Error activating user:",g)}finally{u(!1)}};return t?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Activar Usuario"}),i.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"Usuario a Activar:"}),i.jsxs("p",{className:"text-blue-700",children:[i.jsx("strong",{children:"Email:"})," ",n==null?void 0:n.email,i.jsx("br",{}),i.jsx("strong",{children:"Nombre:"})," ",(n==null?void 0:n.fullName)||"Sin especificar",i.jsx("br",{}),i.jsx("strong",{children:"Rol:"})," ",(n==null?void 0:n.role)||"Cliente"]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje de Notificación (Opcional)"}),i.jsx("textarea",{value:a,onChange:g=>o(g.target.value),rows:"8",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",placeholder:d}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Si no escribes un mensaje personalizado, se enviará el mensaje por defecto."})]}),i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:[i.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"¿Qué sucederá?"}),i.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[i.jsx("li",{children:"• El usuario será activado inmediatamente"}),i.jsx("li",{children:"• Se enviará una notificación por email"}),i.jsx("li",{children:"• El usuario podrá iniciar sesión"}),i.jsx("li",{children:"• Si es cliente, deberá completar su perfil"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-4",children:[i.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{onClick:m,disabled:c,className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 flex items-center gap-2",children:c?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Activando..."]}):"Activar y Notificar"})]})]})}):null}function sP({isDemo:t,userRole:e}){const{addNotification:n}=Ae(),[r,s]=L.useState([]),[a,o]=L.useState(""),[c,u]=L.useState(!1),[d,m]=L.useState(!1),[g,y]=L.useState(!1),[x,S]=L.useState(null),[E,P]=L.useState(null);L.useEffect(()=>{if(t){s([{id:"u1",email:"superadmin@demo.com",role:"superadmin",status:"active",fullName:"Super Admin",identification:"123"},{id:"u2",email:"admin@demo.com",role:"admin",status:"active",fullName:"Admin User",identification:"456"},{id:"u3",email:"cliente1@demo.com",role:"client",status:"pending",fullName:"Cliente Pendiente",identification:"789"},{id:"u4",email:"cliente2@demo.com",role:"client",status:"disabled",fullName:"Cliente Deshabilitado",identification:"101"}]);return}const p=ge(te,"artifacts",ee,"public","data","users");return _e(qe(p,jo("email")),w=>{s(w.docs.map(N=>({id:N.id,...N.data()})))})},[t]);const T=async p=>{if(t){n("Función no disponible en modo demo.","error");return}const{id:k,...w}=p,N=ce(te,"artifacts",ee,"public","data","users",k);await Xe(N,w)},j=async p=>{if(t){n(`Simulación: Creando usuario ${p.email} con rol ${p.role}.`,"success");return}try{const k=qe(ge(te,"artifacts",ee,"public","data","users"),rt("email","==",p.email));if(!(await Rn(k)).empty){n("El email ya está registrado en el sistema","error");return}const $=(await Xc(Ze,p.email,p.password)).user,D={email:p.email,fullName:p.fullName||"",identification:p.identification||"",role:p.role||"client",status:p.status||"active",isProfileComplete:!0,createdAt:le.now(),requiresPasswordChange:!0},V=ce(te,"artifacts",ee,"public","data","users",$.uid);if(await Dn(V,D),p.notify)try{await pb($),n(`Usuario ${p.email} creado exitosamente. Email de verificación enviado.`,"success")}catch{n(`Usuario ${p.email} creado exitosamente, pero no se pudo enviar el email de verificación.`,"warning")}else n(`Usuario ${p.email} creado exitosamente.`,"success")}catch(k){console.error("Error creating user:",k);let w="Error al crear usuario";throw k.code==="auth/email-already-in-use"?w="El email ya está registrado en el sistema":k.code==="auth/invalid-email"?w="El email no es válido":k.code==="auth/weak-password"?w="La contraseña es muy débil":w=`Error al crear usuario: ${k.message}`,n(w,"error"),k}},R=async()=>{if(E)try{const p=ce(te,"artifacts",ee,"public","data","users",E.id);await Xe(p,{status:"active"}),n(`Usuario ${E.email} activado exitosamente.`,"success")}catch(p){n("Error al activar usuario","error"),console.error("Error activating user:",p)}},M=async(p,k)=>{if(t||e!=="superadmin"){n("Acción no permitida.","error");return}const w=ce(te,"artifacts",ee,"public","data","users",p.id);try{switch(k){case"activate":P(p),y(!0);break;case"notify":const N=`${window.location.origin}?uid=${p.id}&email=${encodeURIComponent(p.email)}&name=${encodeURIComponent(p.fullName||"")}&id=${encodeURIComponent(p.identification||"")}`;console.log("Link de activación:",N),n(`Link de activación generado para ${p.email}. Copia el link desde la consola.`,"success"),navigator.clipboard.writeText(N),n("Link copiado al portapapeles","info");break;case"disable":window.confirm(`¿Deshabilitar a ${p.email}?`)&&(await Xe(w,{status:"disabled"}),n(`Usuario ${p.email} deshabilitado.`,"success"));break;case"makeAdmin":window.confirm(`¿Convertir a ${p.email} en administrador?`)&&(await Xe(w,{role:"admin"}),n(`${p.email} ahora es administrador.`,"success"));break;case"makeClient":window.confirm(`¿Convertir a ${p.email} en cliente?`)&&(await Xe(w,{role:"client"}),n(`${p.email} ahora es cliente.`,"success"));break;case"delete":if(window.confirm(`¿Eliminar permanentemente a ${p.email}? Esta acción no se puede deshacer.`))try{await Si(w),n(`Usuario ${p.email} eliminado de la base de datos.`,"success"),n("Nota: El usuario permanece en Authentication. Contacta al administrador para eliminación completa.","info")}catch($){console.error("Error deleting user:",$),n("Error al eliminar el usuario: "+$.message,"error")}break;default:n("Acción no reconocida.","error")}}catch(N){n("Ocurrió un error al realizar la acción.","error"),console.error("Error in user action:",N)}},q=r.filter(p=>{const k=a.toLowerCase();return!k||p.email.toLowerCase().includes(k)||p.fullName&&p.fullName.toLowerCase().includes(k)||p.identification&&p.identification.includes(k)}),z=p=>({active:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",disabled:"bg-red-100 text-red-800"})[p]||"bg-gray-100 text-gray-800",I=p=>({superadmin:"bg-red-100 text-red-800 font-bold",admin:"bg-blue-100 text-blue-800 font-semibold",client:"bg-gray-100 text-gray-800"})[p]||"bg-gray-100 text-gray-800",b=p=>({active:"Activo",pending:"Pendiente",disabled:"Deshabilitado"})[p]||p,C=p=>({superadmin:"Super Admin",admin:"Administrador",client:"Cliente"})[p]||p;return i.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[i.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",placeholder:"Buscar por email, nombre, ID...",value:a,onChange:p=>o(p.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full sm:w-64"}),i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Vi,{})})]}),e==="superadmin"&&i.jsxs("button",{onClick:()=>u(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700",children:[i.jsx(Ao,{})," ",i.jsx("span",{className:"hidden sm:inline",children:"Crear Usuario"})]})]}),i.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:i.jsxs("table",{className:"w-full text-left",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsx("tr",{children:["Nombre","Email","Identificación","Rol","Estado","Fecha Creación","Acciones"].map(p=>i.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:p},p))})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:q.map(p=>i.jsxs("tr",{children:[i.jsxs("td",{className:"px-6 py-4",children:[i.jsx("div",{className:"font-medium text-gray-900",children:p.fullName||"Sin nombre"}),p.fullName&&i.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",p.id.slice(0,8),"..."]})]}),i.jsxs("td",{className:"px-6 py-4",children:[i.jsx("div",{className:"text-sm text-gray-900",children:p.email}),p.requiresPasswordChange&&i.jsx("div",{className:"text-xs text-orange-600",children:"Requiere cambio de contraseña"})]}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:p.identification||"--"}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${I(p.role)}`,children:C(p.role)})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${z(p.status)}`,children:b(p.status)})}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:p.createdAt?new Date(p.createdAt.seconds*1e3).toLocaleDateString():"--"}),i.jsx("td",{className:"px-6 py-4",children:e==="superadmin"&&p.role!=="superadmin"&&i.jsxs(ko,{children:[i.jsx("button",{onClick:()=>{S(p),m(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"✏️ Editar Datos"}),i.jsx("button",{onClick:()=>M(p,"notify"),className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:"📧 Notificar Activación"}),p.status==="pending"&&i.jsx("button",{onClick:()=>M(p,"activate"),className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:"✅ Activar Usuario"}),p.status==="active"&&i.jsx("button",{onClick:()=>M(p,"disable"),className:"block w-full text-left px-4 py-2 text-sm text-yellow-700 hover:bg-yellow-50",children:"⏸️ Deshabilitar"}),p.status==="disabled"&&i.jsx("button",{onClick:()=>M(p,"activate"),className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:"🔄 Re-Activar"}),p.role==="client"?i.jsx("button",{onClick:()=>M(p,"makeAdmin"),className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:"👨‍💼 Hacer Administrador"}):i.jsx("button",{onClick:()=>M(p,"makeClient"),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:"👤 Hacer Cliente"}),i.jsx("button",{onClick:()=>M(p,"delete"),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"🗑️ Eliminar Permanentemente"})]})})]},p.id))})]})}),i.jsx(nP,{isOpen:c,onClose:()=>u(!1),onSave:j,isDemo:t}),i.jsx(tP,{isOpen:d,onClose:()=>m(!1),onSave:T,user:x,isDemo:t}),i.jsx(rP,{isOpen:g,onClose:()=>{y(!1),P(null)},onActivate:R,user:E})]})}function iP({isDemo:t}){const{addNotification:e}=Ae(),[n,r]=L.useState([]),[s,a]=L.useState(null),[o,c]=L.useState(""),[u,d]=L.useState(""),[m,g]=L.useState(""),[y,x]=L.useState(!1),[S,E]=L.useState([]),[P,T]=L.useState({preVencimiento:{enabled:!1,days:7,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]},periodoGracia:{enabled:!1,days:3,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]},vencido:{enabled:!1,days:0,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]},suspendido:{enabled:!1,days:0,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]}}),[j,R]=L.useState("templates"),M={preVencimiento:{name:"Aviso de Próximo Vencimiento",subject:"Recordatorio de Renovación de Servicio: {description}",body:`Estimado/a {clientName},

Le escribimos para recordarle que su servicio '{description}' está programado para vencer el próximo {dueDate}.

El monto correspondiente a la renovación es de {amount} {currency}.

Para garantizar la continuidad de su servicio, le recomendamos realizar el pago antes de la fecha de vencimiento. Puede gestionarlo a través de nuestro portal de clientes.

Si tiene alguna consulta, no dude en contactarnos.

Atentamente,
{companyName}`},vencido:{name:"Notificación de Servicio Vencido",subject:"Importante: Su servicio {description} ha vencido",body:`Estimado/a {clientName},

Le informamos que la factura correspondiente a su servicio '{description}', con fecha de vencimiento {dueDate}, se encuentra pendiente de pago.

Su servicio ha entrado en un período de gracia. Para evitar la suspensión del mismo, le solicitamos regularizar su situación a la brevedad posible. El monto pendiente es de {amount} {currency}.

Si usted ya ha realizado el pago, por favor, omita esta notificación.

Cordialmente,
{companyName}`},suspendido:{name:"Aviso de Suspensión de Servicio",subject:"Acción Requerida: Suspensión del servicio {description}",body:`Estimado/a {clientName},

Lamentamos informarle que, debido a la falta de pago, su servicio '{description}' ha sido suspendido.

Para proceder con la reactivación y recuperar el acceso, es necesario saldar el monto pendiente de {amount} {currency}. Por favor, contáctenos para coordinar el pago y la restauración del servicio.

Quedamos a su disposición.

Atentamente,
{companyName}`},pagoRecibido:{name:"Confirmación de Pago Recibido",subject:"Confirmación: Pago recibido para {description}",body:`Estimado/a {clientName},

Hemos recibido y procesado exitosamente su pago por {amount} {currency} correspondiente al servicio '{description}'.

Su servicio está activo y funcionando correctamente. La próxima fecha de vencimiento será {dueDate}.

Gracias por su confianza y por mantener sus pagos al día.

Atentamente,
{companyName}`},bienvenida:{name:"Bienvenida a Nuevo Cliente",subject:"Bienvenido a {companyName} - Servicio {description}",body:`Estimado/a {clientName},

¡Bienvenido a {companyName}!

Nos complace confirmar que su servicio '{description}' ha sido activado exitosamente.

Detalles del servicio:
- Descripción: {description}
- Monto: {amount} {currency}
- Próximo vencimiento: {dueDate}

Puede acceder a su portal de cliente en cualquier momento para gestionar su cuenta y realizar pagos.

Si tiene alguna pregunta, no dude en contactarnos.

¡Gracias por elegirnos!

Atentamente,
{companyName}`},adminPreVencimiento:{name:"Alerta Admin: Próximo Vencimiento",subject:"ALERTA: Servicio próximo a vencer - {clientName}",body:`Estimado/a Administrador,

Se ha generado una alerta automática para el siguiente servicio:

📋 INFORMACIÓN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto: {amount} {currency}
- Fecha de vencimiento: {dueDate}
- Ciclo de facturación: {billingCycle}
- Días restantes: {daysRemaining}

📊 ESTADO ACTUAL:
- Estado: Próximo a vencer
- Notificación enviada al cliente: ✅
- Plantilla utilizada: Aviso de Próximo Vencimiento

🔔 ACCIONES RECOMENDADAS:
1. Verificar que el cliente haya recibido la notificación
2. Contactar al cliente si es necesario
3. Preparar seguimiento post-vencimiento

📈 ESTADÍSTICAS:
- Total de servicios próximos a vencer: {totalPending}
- Ingresos potenciales: {potentialRevenue}

Este es un mensaje automático del sistema de gestión de cobros.

Sistema de Gestión - {companyName}`},adminPeriodoGracia:{name:"Alerta Admin: Período de Gracia",subject:"URGENTE: Servicio en período de gracia - {clientName}",body:`Estimado/a Administrador,

⚠️ ALERTA URGENTE - Servicio en período de gracia:

📋 INFORMACIÓN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto pendiente: {amount} {currency}
- Fecha de vencimiento original: {dueDate}
- Días en período de gracia: {graceDays}
- Días restantes de gracia: {remainingGraceDays}

📊 ESTADO ACTUAL:
- Estado: Período de Gracia Vencido
- Notificación enviada al cliente: ✅
- Plantilla utilizada: Notificación de Servicio Vencido
- Riesgo de suspensión: ALTO

🚨 ACCIONES INMEDIATAS:
1. Contactar al cliente por teléfono
2. Enviar recordatorio personalizado
3. Evaluar opciones de pago flexibles
4. Preparar suspensión si no hay respuesta

📈 IMPACTO:
- Ingresos en riesgo: {amount} {currency}
- Tiempo de mora: {daysOverdue} días
- Historial de pagos: {paymentHistory}

⏰ PRÓXIMOS PASOS:
- Si no se paga en {remainingGraceDays} días: Suspender servicio
- Seguimiento diario hasta resolución
- Documentar todas las comunicaciones

Este es un mensaje automático del sistema de gestión de cobros.

Sistema de Gestión - {companyName}`},adminVencido:{name:"Alerta Admin: Servicio Vencido",subject:"INMEDIATO: Servicio vencido - {clientName}",body:`Estimado/a Administrador,

🔴 ALERTA INMEDIATA - Servicio vencido:

📋 INFORMACIÓN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto vencido: {amount} {currency}
- Fecha de vencimiento: {dueDate}
- Días de atraso: {daysOverdue}
- Ciclo de facturación: {billingCycle}

📊 ESTADO ACTUAL:
- Estado: Vencido
- Notificación enviada al cliente: ✅
- Plantilla utilizada: Notificación de Servicio Vencido
- Próximo paso: Período de gracia

🎯 ACCIONES REQUERIDAS:
1. Verificar recepción de notificación por cliente
2. Iniciar período de gracia ({gracePeriod} días)
3. Contacto directo con el cliente
4. Evaluar historial de pagos del cliente
5. Preparar estrategia de cobro

📈 ANÁLISIS:
- Cliente desde: {clientSince}
- Pagos anteriores: {previousPayments}
- Patrón de pago: {paymentPattern}
- Riesgo de pérdida: {riskLevel}

📞 CONTACTOS:
- Teléfono: {clientPhone}
- Email: {clientEmail}
- Última comunicación: {lastContact}

Este es un mensaje automático del sistema de gestión de cobros.

Sistema de Gestión - {companyName}`},adminSuspendido:{name:"Alerta Admin: Servicio Suspendido",subject:"SUSPENDIDO: Servicio cancelado por falta de pago - {clientName}",body:`Estimado/a Administrador,

❌ SERVICIO SUSPENDIDO - Acción requerida:

📋 INFORMACIÓN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto pendiente: {amount} {currency}
- Fecha de vencimiento: {dueDate}
- Días de atraso: {daysOverdue}
- Período de gracia agotado: {gracePeriod} días

📊 ESTADO ACTUAL:
- Estado: Cancelado
- Motivo: Falta de pago
- Notificación enviada al cliente: ✅
- Plantilla utilizada: Aviso de Suspensión de Servicio
- Fecha de suspensión: {suspensionDate}

🔧 ACCIONES INMEDIATAS:
1. Suspender acceso del cliente al servicio
2. Documentar suspensión en el sistema
3. Enviar notificación de suspensión
4. Iniciar proceso de recuperación de cobros
5. Evaluar reactivación futura

📈 ANÁLISIS FINANCIERO:
- Pérdida de ingresos: {amount} {currency}
- Costo de reactivación: {reactivationCost}
- Valor del cliente: {clientValue}
- Probabilidad de recuperación: {recoveryProbability}%

📞 SEGUIMIENTO:
- Contactar para negociación de pago
- Ofrecer planes de pago flexibles
- Documentar todas las comunicaciones
- Evaluar cancelación definitiva

📋 DOCUMENTACIÓN:
- Historial de pagos: {paymentHistory}
- Comunicaciones previas: {communicationHistory}
- Términos del servicio: {serviceTerms}
- Política de suspensión: {suspensionPolicy}

Este es un mensaje automático del sistema de gestión de cobros.

Sistema de Gestión - {companyName}`},adminPagoRecibido:{name:"Notificación Admin: Pago Recibido",subject:"CONFIRMADO: Pago recibido - {clientName}",body:`Estimado/a Administrador,

✅ PAGO CONFIRMADO - Servicio reactivado:

📋 INFORMACIÓN DEL PAGO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Monto recibido: {amount} {currency}
- Fecha de pago: {paymentDate}
- Método de pago: {paymentMethod}
- Referencia: {paymentReference}

📊 ESTADO ACTUAL:
- Estado: Activo
- Servicio reactivado: ✅
- Notificación enviada al cliente: ✅
- Plantilla utilizada: Confirmación de Pago Recibido
- Próximo vencimiento: {nextDueDate}

🎯 ACCIONES COMPLETADAS:
1. Pago procesado y verificado
2. Servicio reactivado automáticamente
3. Cliente notificado del pago
4. Próxima fecha de vencimiento actualizada
5. Historial de pagos actualizado

📈 IMPACTO POSITIVO:
- Ingresos recuperados: {amount} {currency}
- Cliente retenido: ✅
- Servicio activo: ✅
- Próximo ciclo iniciado

📊 ESTADÍSTICAS:
- Tiempo de pago: {paymentTime} días
- Eficiencia de cobro: {collectionEfficiency}%
- Satisfacción del cliente: {clientSatisfaction}
- Ingresos mensuales: {monthlyRevenue}

📋 SEGUIMIENTO:
- Monitorear estabilidad del servicio
- Preparar próximo recordatorio
- Actualizar perfil del cliente
- Documentar éxito de cobro

Este es un mensaje automático del sistema de gestión de cobros.

Sistema de Gestión - {companyName}`},adminNuevoCliente:{name:"Notificación Admin: Nuevo Cliente",subject:"NUEVO CLIENTE: {clientName} - Servicio {description}",body:`Estimado/a Administrador,

🎉 NUEVO CLIENTE REGISTRADO:

📋 INFORMACIÓN DEL CLIENTE:
- Nombre: {clientName}
- Email: {clientEmail}
- Identificación: {clientId}
- Teléfono: {clientPhone}
- Fecha de registro: {registrationDate}

📋 INFORMACIÓN DEL SERVICIO:
- Descripción: {description}
- Tipo: {serviceType}
- Monto: {amount} {currency}
- Ciclo de facturación: {billingCycle}
- Fecha de vencimiento: {dueDate}
- Estado: Activo

📊 CONFIGURACIÓN:
- Servicio activado: ✅
- Notificación de bienvenida enviada: ✅
- Plantilla utilizada: Bienvenida a Nuevo Cliente
- Portal de cliente habilitado: ✅
- Método de pago configurado: {paymentMethod}

🎯 ACCIONES INICIALES:
1. Verificar activación del servicio
2. Confirmar recepción de bienvenida
3. Programar seguimiento inicial
4. Configurar recordatorios automáticos
5. Documentar preferencias del cliente

📈 ANÁLISIS:
- Valor del cliente: {clientValue}
- Potencial de crecimiento: {growthPotential}
- Segmento: {clientSegment}
- Fuente de adquisición: {acquisitionSource}

📋 PRÓXIMOS PASOS:
- Seguimiento en 7 días
- Verificar satisfacción inicial
- Preparar próximo recordatorio
- Monitorear uso del servicio

Este es un mensaje automático del sistema de gestión de cobros.

Sistema de Gestión - {companyName}`}},q=D=>{a(null),x(!1),c(D.name),d(D.subject),g(D.body),e("Sugerencia cargada en el editor.","success")};L.useEffect(()=>{if(t){E([{id:"admin1",email:"admin@demo.com",fullName:"Admin Demo",role:"admin"},{id:"super1",email:"super@demo.com",fullName:"Super Admin Demo",role:"superadmin"}]);return}const D=ge(te,"artifacts",ee,"public","data","users");return _e(qe(D,rt("role","in",["admin","superadmin"])),O=>{E(O.docs.map(v=>({id:v.id,...v.data()})))})},[t]),L.useEffect(()=>{if(t){T({preVencimiento:{enabled:!0,days:7,clientTemplate:"t1",adminTemplate:"t1",notifyAdmins:!0,selectedAdmins:["admin1"]},periodoGracia:{enabled:!0,days:3,clientTemplate:"t2",adminTemplate:"t2",notifyAdmins:!0,selectedAdmins:["admin1"]},vencido:{enabled:!0,days:0,clientTemplate:"t2",adminTemplate:"t2",notifyAdmins:!0,selectedAdmins:["admin1"]},suspendido:{enabled:!1,days:0,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]}});return}const D=ce(te,"artifacts",ee,"public","data","settings","alertSettings");return _e(D,O=>{O.exists()&&T(O.data())})},[t]),L.useEffect(()=>{if(t){r([{id:"t1",name:"Recordatorio General (Demo)",subject:"Recordatorio de pago",body:"Hola {clientName}, recuerda pagar tu servicio {description} por {amount} {currency} antes del {dueDate}. Gracias, {companyName}",createdAt:new Date},{id:"t2",name:"Servicio Vencido (Demo)",subject:"Servicio vencido: {description}",body:"Estimado {clientName}, su servicio {description} ha vencido. Por favor regularice su pago de {amount} {currency}. Atentamente, {companyName}",createdAt:new Date}]);return}const D=ge(te,"artifacts",ee,"public","data","messageTemplates");return _e(qe(D,jo("name")),O=>{r(O.docs.map(v=>({id:v.id,...v.data()})))})},[t]),L.useEffect(()=>{s?(c(s.name),d(s.subject),g(s.body),x(!0)):(c(""),d(""),g(""),x(!1))},[s]);const z=async()=>{if(t){e("Función no disponible en modo demo.","error");return}if(!o.trim()||!u.trim()||!m.trim()){e("Por favor, complete todos los campos de la plantilla.","error");return}const D={name:o.trim(),subject:u.trim(),body:m.trim(),updatedAt:new Date},V=ge(te,"artifacts",ee,"public","data","messageTemplates");try{s?(await Xe(ce(V,s.id),D),e("Plantilla actualizada exitosamente.","success")):(await or(V,{...D,createdAt:new Date}),e("Plantilla creada exitosamente.","success")),a(null)}catch(O){console.error("Error saving template:",O),e("Error al guardar la plantilla.","error")}},I=async D=>{if(t){e("Función no disponible en modo demo.","error");return}if(window.confirm("¿Seguro que quieres eliminar esta plantilla?"))try{await Si(ce(te,"artifacts",ee,"public","data","messageTemplates",D)),e("Plantilla eliminada.","success"),a(null)}catch(V){console.error("Error deleting template:",V),e("Error al eliminar la plantilla.","error")}},b=()=>{a(null),x(!1),c(""),d(""),g("")},C=D=>{a(D),x(!0)},p=(D,V,O)=>{T(v=>({...v,[D]:{...v[D],[V]:O}}))},k=(D,V,O)=>{T(v=>({...v,[D]:{...v[D],selectedAdmins:O?[...v[D].selectedAdmins,V]:v[D].selectedAdmins.filter(A=>A!==V)}}))},w=async()=>{if(t){e("Configuración de alertas guardada (modo demo).","success");return}try{const D=ce(te,"artifacts",ee,"public","data","settings","alertSettings");await Dn(D,P,{merge:!0}),e("Configuración de alertas guardada exitosamente.","success")}catch(D){console.error("Error saving alert settings:",D),e("Error al guardar la configuración de alertas.","error")}},N=["{clientName}","{serviceType}","{description}","{amount}","{currency}","{dueDate}","{companyName}","{billingCycle}","{clientEmail}"],$=["{clientName}","{clientEmail}","{clientPhone}","{clientId}","{serviceType}","{description}","{amount}","{currency}","{dueDate}","{billingCycle}","{companyName}","{daysRemaining}","{daysOverdue}","{graceDays}","{remainingGraceDays}","{totalPending}","{potentialRevenue}","{paymentHistory}","{clientSince}","{previousPayments}","{paymentPattern}","{riskLevel}","{lastContact}","{suspensionDate}","{reactivationCost}","{clientValue}","{recoveryProbability}","{paymentDate}","{paymentMethod}","{paymentReference}","{nextDueDate}","{paymentTime}","{collectionEfficiency}","{clientSatisfaction}","{monthlyRevenue}","{registrationDate}","{growthPotential}","{clientSegment}","{acquisitionSource}","{gracePeriod}","{communicationHistory}","{serviceTerms}","{suspensionPolicy}"];return i.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Plantillas y Alertas"}),i.jsx("p",{className:"text-gray-600 mt-2",children:"Gestiona las plantillas de correo y configura alertas automáticas"})]}),i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"border-b border-gray-200",children:i.jsxs("nav",{className:"-mb-px flex space-x-8",children:[i.jsxs("button",{onClick:()=>R("templates"),className:`py-2 px-1 border-b-2 font-medium text-sm ${j==="templates"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[i.jsx(y_,{}),i.jsx("span",{className:"ml-2",children:"Plantillas"})]}),i.jsxs("button",{onClick:()=>R("alerts"),className:`py-2 px-1 border-b-2 font-medium text-sm ${j==="alerts"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[i.jsx(Qk,{}),i.jsx("span",{className:"ml-2",children:"Alertas Automáticas"})]})]})})}),j==="templates"&&i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[i.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[i.jsxs("div",{className:"p-4 border-b",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Plantillas Guardadas"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Haz clic para editar una plantilla"})]}),i.jsx("div",{className:"max-h-80 overflow-y-auto",children:n.length===0?i.jsxs("div",{className:"p-4 text-center text-gray-500",children:[i.jsx("p",{children:"No hay plantillas guardadas"}),i.jsx("p",{className:"text-sm",children:"Crea tu primera plantilla"})]}):n.map(D=>i.jsx("div",{className:"p-4 border-b hover:bg-gray-50 transition-colors",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h4",{className:"font-medium text-gray-900 truncate",children:D.name}),i.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:D.subject}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:D.createdAt?new Date(D.createdAt.seconds*1e3).toLocaleDateString():"Sin fecha"})]}),i.jsxs("div",{className:"flex space-x-2 ml-2",children:[i.jsx("button",{onClick:()=>C(D),className:"text-blue-600 hover:text-blue-800 p-1",title:"Editar plantilla",children:i.jsx(Kk,{})}),i.jsx("button",{onClick:()=>I(D.id),className:"text-red-600 hover:text-red-800 p-1",title:"Eliminar plantilla",children:i.jsx(g_,{})})]})]})},D.id))}),i.jsx("div",{className:"p-4",children:i.jsxs("button",{onClick:b,className:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[i.jsx(Ao,{}),i.jsx("span",{className:"ml-2",children:"Nueva Plantilla"})]})})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[i.jsxs("div",{className:"p-4 border-b",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Plantillas para Clientes"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Mensajes dirigidos a los clientes"})]}),i.jsxs("div",{className:"p-4 space-y-2",children:[i.jsxs("button",{onClick:()=>q(M.preVencimiento),className:"w-full text-left p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[i.jsx("div",{className:"font-medium text-blue-900",children:"Aviso de Próximo Vencimiento"}),i.jsx("div",{className:"text-sm text-blue-700",children:"Recordatorio antes del vencimiento"})]}),i.jsxs("button",{onClick:()=>q(M.vencido),className:"w-full text-left p-3 bg-yellow-50 hover:bg-yellow-100 rounded-lg transition-colors",children:[i.jsx("div",{className:"font-medium text-yellow-900",children:"Servicio Vencido"}),i.jsx("div",{className:"text-sm text-yellow-700",children:"Notificación de período de gracia"})]}),i.jsxs("button",{onClick:()=>q(M.suspendido),className:"w-full text-left p-3 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",children:[i.jsx("div",{className:"font-medium text-red-900",children:"Aviso de Suspensión"}),i.jsx("div",{className:"text-sm text-red-700",children:"Servicio suspendido por falta de pago"})]}),i.jsxs("button",{onClick:()=>q(M.pagoRecibido),className:"w-full text-left p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[i.jsx("div",{className:"font-medium text-green-900",children:"Confirmación de Pago"}),i.jsx("div",{className:"text-sm text-green-700",children:"Confirmación de pago recibido"})]}),i.jsxs("button",{onClick:()=>q(M.bienvenida),className:"w-full text-left p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[i.jsx("div",{className:"font-medium text-purple-900",children:"Bienvenida"}),i.jsx("div",{className:"text-sm text-purple-700",children:"Mensaje de bienvenida a nuevos clientes"})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[i.jsxs("div",{className:"p-4 border-b",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Plantillas para Administradores"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Alertas y notificaciones internas"})]}),i.jsxs("div",{className:"p-4 space-y-2",children:[i.jsxs("button",{onClick:()=>q(M.adminPreVencimiento),className:"w-full text-left p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[i.jsx("div",{className:"font-medium text-blue-900",children:"🔔 Alerta: Próximo Vencimiento"}),i.jsx("div",{className:"text-sm text-blue-700",children:"Notificación interna de servicios próximos a vencer"})]}),i.jsxs("button",{onClick:()=>q(M.adminPeriodoGracia),className:"w-full text-left p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition-colors",children:[i.jsx("div",{className:"font-medium text-orange-900",children:"⚠️ Alerta: Período de Gracia"}),i.jsx("div",{className:"text-sm text-orange-700",children:"Alerta urgente de servicios en período de gracia"})]}),i.jsxs("button",{onClick:()=>q(M.adminVencido),className:"w-full text-left p-3 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",children:[i.jsx("div",{className:"font-medium text-red-900",children:"🔴 Alerta: Servicio Vencido"}),i.jsx("div",{className:"text-sm text-red-700",children:"Notificación inmediata de servicios vencidos"})]}),i.jsxs("button",{onClick:()=>q(M.adminSuspendido),className:"w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:[i.jsx("div",{className:"font-medium text-gray-900",children:"❌ Alerta: Servicio Suspendido"}),i.jsx("div",{className:"text-sm text-gray-700",children:"Notificación de servicios cancelados por falta de pago"})]}),i.jsxs("button",{onClick:()=>q(M.adminPagoRecibido),className:"w-full text-left p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[i.jsx("div",{className:"font-medium text-green-900",children:"✅ Notificación: Pago Recibido"}),i.jsx("div",{className:"text-sm text-green-700",children:"Confirmación interna de pagos procesados"})]}),i.jsxs("button",{onClick:()=>q(M.adminNuevoCliente),className:"w-full text-left p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[i.jsx("div",{className:"font-medium text-purple-900",children:"🎉 Notificación: Nuevo Cliente"}),i.jsx("div",{className:"text-sm text-purple-700",children:"Alerta de nuevos clientes registrados"})]})]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Variables para Clientes"}),i.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[i.jsx("p",{className:"font-medium",children:"Información básica:"}),i.jsx("p",{children:N.slice(0,3).join(", ")}),i.jsx("p",{className:"font-medium mt-2",children:"Información del servicio:"}),i.jsx("p",{children:N.slice(3,6).join(", ")}),i.jsx("p",{className:"font-medium mt-2",children:"Información adicional:"}),i.jsx("p",{children:N.slice(6).join(", ")})]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Variables para Administradores"}),i.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[i.jsx("p",{className:"font-medium",children:"Información del cliente:"}),i.jsx("p",{children:$.slice(0,4).join(", ")}),i.jsx("p",{className:"font-medium mt-2",children:"Información del servicio:"}),i.jsx("p",{children:$.slice(4,11).join(", ")}),i.jsx("p",{className:"font-medium mt-2",children:"Fechas y tiempos:"}),i.jsx("p",{children:$.slice(11,15).join(", ")}),i.jsx("p",{className:"font-medium mt-2",children:"Estadísticas:"}),i.jsx("p",{children:$.slice(15,19).join(", ")}),i.jsx("p",{className:"font-medium mt-2",children:"Análisis de riesgo:"}),i.jsx("p",{children:$.slice(19,23).join(", ")}),i.jsx("p",{className:"font-medium mt-2",children:"Información de pago:"}),i.jsx("p",{children:$.slice(23,27).join(", ")}),i.jsx("p",{className:"font-medium mt-2",children:"Métricas de rendimiento:"}),i.jsx("p",{children:$.slice(27,31).join(", ")}),i.jsx("p",{className:"font-medium mt-2",children:"Información de registro:"}),i.jsx("p",{children:$.slice(31,35).join(", ")}),i.jsx("p",{className:"font-medium mt-2",children:"Configuración:"}),i.jsx("p",{children:$.slice(35).join(", ")})]})]})]}),i.jsx("div",{className:"lg:col-span-2",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[i.jsxs("div",{className:"p-6 border-b",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:y?"Editando Plantilla":"Nueva Plantilla"}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:y?"Modifica los campos de la plantilla":"Completa los campos para crear una nueva plantilla"})]}),i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de la Plantilla"}),i.jsx("input",{type:"text",value:o,onChange:D=>c(D.target.value),placeholder:"Ej: Primer Recordatorio de Pago",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Asunto del Correo"}),i.jsx("input",{type:"text",value:u,onChange:D=>d(D.target.value),placeholder:"Ej: Recordatorio de Renovación: {description}",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cuerpo del Mensaje"}),i.jsx("textarea",{value:m,onChange:D=>g(D.target.value),placeholder:"Escribe el contenido del mensaje aquí...",rows:"12",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm"})]}),i.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[i.jsx("button",{onClick:b,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Limpiar"}),i.jsx("button",{onClick:z,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:y?"Guardar Cambios":"Crear Plantilla"})]})]})]})})]}),j==="alerts"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[i.jsxs("div",{className:"p-6 border-b",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-3"}),"Alerta de Próximo Vencimiento"]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Notificaciones antes del vencimiento del servicio"})]}),i.jsxs("div",{className:"p-6 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Activar alerta"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Enviar notificaciones antes del vencimiento"})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:P.preVencimiento.enabled,onChange:D=>p("preVencimiento","enabled",D.target.checked),className:"sr-only peer"}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),P.preVencimiento.enabled&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Días antes del vencimiento"}),i.jsx("input",{type:"number",min:"1",max:"30",value:P.preVencimiento.days,onChange:D=>p("preVencimiento","days",parseInt(D.target.value)),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para cliente"}),i.jsxs("select",{value:P.preVencimiento.clientTemplate,onChange:D=>p("preVencimiento","clientTemplate",D.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(D=>i.jsx("option",{value:D.id,children:D.name},D.id))]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notificar administradores"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Enviar copia a administradores seleccionados"})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:P.preVencimiento.notifyAdmins,onChange:D=>p("preVencimiento","notifyAdmins",D.target.checked),className:"sr-only peer"}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),P.preVencimiento.notifyAdmins&&i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para administradores"}),i.jsxs("select",{value:P.preVencimiento.adminTemplate,onChange:D=>p("preVencimiento","adminTemplate",D.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(D=>i.jsx("option",{value:D.id,children:D.name},D.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Administradores a notificar"}),i.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-3",children:S.map(D=>i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",checked:P.preVencimiento.selectedAdmins.includes(D.id),onChange:V=>k("preVencimiento",D.id,V.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsxs("span",{className:"text-sm text-gray-700",children:[D.fullName," (",D.email,")"]})]},D.id))})]})]})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[i.jsxs("div",{className:"p-6 border-b",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full mr-3"}),"Período de Gracia"]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Notificaciones durante el período de gracia después del vencimiento"})]}),i.jsxs("div",{className:"p-6 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Activar período de gracia"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Tiempo adicional para pagar antes de suspender"})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:P.periodoGracia.enabled,onChange:D=>p("periodoGracia","enabled",D.target.checked),className:"sr-only peer"}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),P.periodoGracia.enabled&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Días de gracia"}),i.jsx("input",{type:"number",min:"1",max:"30",value:P.periodoGracia.days,onChange:D=>p("periodoGracia","days",parseInt(D.target.value)),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para cliente"}),i.jsxs("select",{value:P.periodoGracia.clientTemplate,onChange:D=>p("periodoGracia","clientTemplate",D.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(D=>i.jsx("option",{value:D.id,children:D.name},D.id))]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notificar administradores"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Enviar copia a administradores seleccionados"})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:P.periodoGracia.notifyAdmins,onChange:D=>p("periodoGracia","notifyAdmins",D.target.checked),className:"sr-only peer"}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),P.periodoGracia.notifyAdmins&&i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para administradores"}),i.jsxs("select",{value:P.periodoGracia.adminTemplate,onChange:D=>p("periodoGracia","adminTemplate",D.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(D=>i.jsx("option",{value:D.id,children:D.name},D.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Administradores a notificar"}),i.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-3",children:S.map(D=>i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",checked:P.periodoGracia.selectedAdmins.includes(D.id),onChange:V=>k("periodoGracia",D.id,V.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsxs("span",{className:"text-sm text-gray-700",children:[D.fullName," (",D.email,")"]})]},D.id))})]})]})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[i.jsxs("div",{className:"p-6 border-b",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-3"}),"Servicio Vencido"]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Notificaciones cuando el servicio ha vencido"})]}),i.jsxs("div",{className:"p-6 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Activar alerta"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Enviar notificaciones cuando el servicio vence"})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:P.vencido.enabled,onChange:D=>p("vencido","enabled",D.target.checked),className:"sr-only peer"}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),P.vencido.enabled&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para cliente"}),i.jsxs("select",{value:P.vencido.clientTemplate,onChange:D=>p("vencido","clientTemplate",D.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(D=>i.jsx("option",{value:D.id,children:D.name},D.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para administradores"}),i.jsxs("select",{value:P.vencido.adminTemplate,onChange:D=>p("vencido","adminTemplate",D.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(D=>i.jsx("option",{value:D.id,children:D.name},D.id))]})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notificar administradores"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Enviar copia a administradores seleccionados"})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:P.vencido.notifyAdmins,onChange:D=>p("vencido","notifyAdmins",D.target.checked),className:"sr-only peer"}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),P.vencido.notifyAdmins&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Administradores a notificar"}),i.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-3",children:S.map(D=>i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",checked:P.vencido.selectedAdmins.includes(D.id),onChange:V=>k("vencido",D.id,V.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsxs("span",{className:"text-sm text-gray-700",children:[D.fullName," (",D.email,")"]})]},D.id))})]})]})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:w,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center",children:[i.jsx(wu,{}),i.jsx("span",{className:"ml-2",children:"Guardar Configuración de Alertas"})]})})]})]})}function v_({isDemo:t}){const{addNotification:e}=Ae(),[n,r]=L.useState({bold:{enabled:!1,apiKey:"",environment:"sandbox",webhookSecret:"",autoApprove:!1},paypal:{enabled:!1,clientId:"",clientSecret:"",environment:"sandbox",autoApprove:!1},payu:{enabled:!1,merchantId:"",apiKey:"",apiLogin:"",environment:"sandbox",autoApprove:!1},bankTransfer:{enabled:!1,accounts:[],autoApprove:!1,requireConfirmation:!0},general:{currency:"USD",defaultGateway:"bold"}}),[s,a]=L.useState(!1);L.useEffect(()=>{if(t){r({bold:{enabled:!0,apiKey:"demo_key",environment:"sandbox",webhookSecret:"demo_secret",autoApprove:!1},paypal:{enabled:!1,clientId:"",clientSecret:"",environment:"sandbox",autoApprove:!1},payu:{enabled:!1,merchantId:"",apiKey:"",apiLogin:"",environment:"sandbox",autoApprove:!1},bankTransfer:{enabled:!0,accounts:[{id:"1",bankName:"Banco Nacional",accountNumber:"1234567890",accountHolder:"Empresa Demo",accountType:"Ahorros"},{id:"2",bankName:"Banco Popular",accountNumber:"0987654321",accountHolder:"Empresa Demo",accountType:"Corriente"}],autoApprove:!1,requireConfirmation:!0},general:{currency:"USD",defaultGateway:"bold"}});return}const x=ce(te,"artifacts",ee,"public","data","settings","paymentConfig"),S=_e(x,E=>{E.exists()&&r(E.data())});return()=>S()},[t]);const o=(x,S,E)=>{r(P=>({...P,[x]:{...P[x],[S]:E}}))},c=(x,S)=>{r(E=>({...E,general:{...E.general,[x]:S}}))},u=()=>{const x={id:Date.now().toString(),bankName:"",accountNumber:"",accountHolder:"",accountType:"Ahorros"};r(S=>({...S,bankTransfer:{...S.bankTransfer,accounts:[...S.bankTransfer.accounts,x]}}))},d=(x,S,E)=>{r(P=>({...P,bankTransfer:{...P.bankTransfer,accounts:P.bankTransfer.accounts.map(T=>T.id===x?{...T,[S]:E}:T)}}))},m=x=>{r(S=>({...S,bankTransfer:{...S.bankTransfer,accounts:S.bankTransfer.accounts.filter(E=>E.id!==x)}}))},g=async()=>{if(t){e("Configuración guardada (modo demo)","success");return}a(!0);try{const x=ce(te,"artifacts",ee,"public","data","settings","paymentConfig");await Dn(x,n),e("Configuración de pagos guardada exitosamente","success")}catch(x){console.error("Error saving payment config:",x),e("Error al guardar la configuración","error")}a(!1)},y=(x,S,E)=>i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[i.jsx($t,{}),S]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:n[x].enabled,onChange:P=>o(x,"enabled",P.target.checked),className:"mr-2"}),i.jsx("span",{className:"text-sm text-gray-600",children:"Habilitado"})]})]}),n[x].enabled&&i.jsxs("div",{className:"space-y-4",children:[E.map(P=>i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:P.label}),P.type==="select"?i.jsx("select",{value:n[x][P.name],onChange:T=>o(x,P.name,T.target.value),className:"w-full p-2 border rounded-md",children:P.options.map(T=>i.jsx("option",{value:T.value,children:T.label},T.value))}):i.jsx("input",{type:P.type,value:n[x][P.name],onChange:T=>o(x,P.name,T.target.value),placeholder:P.placeholder,className:"w-full p-2 border rounded-md"}),P.help&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:P.help})]},P.name)),i.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-md",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:n[x].autoApprove,onChange:P=>o(x,"autoApprove",P.target.checked),className:"mr-2"}),i.jsx("span",{className:"text-sm text-gray-700",children:"Aprobar pagos automáticamente"})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Los pagos de esta pasarela se marcarán como "Completado" automáticamente'})]})]})]});return i.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(wu,{}),"Configuración de Pagos"]}),i.jsx("button",{onClick:g,disabled:s,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:s?"Guardando...":"Guardar Configuración"})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuración General"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Moneda por Defecto"}),i.jsxs("select",{value:n.general.currency,onChange:x=>c("currency",x.target.value),className:"w-full p-2 border rounded-md",children:[i.jsx("option",{value:"USD",children:"USD - Dólar Americano"}),i.jsx("option",{value:"COP",children:"COP - Peso Colombiano"}),i.jsx("option",{value:"EUR",children:"EUR - Euro"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pasarela por Defecto"}),i.jsxs("select",{value:n.general.defaultGateway,onChange:x=>c("defaultGateway",x.target.value),className:"w-full p-2 border rounded-md",children:[i.jsx("option",{value:"bold",children:"Bold"}),i.jsx("option",{value:"paypal",children:"PayPal"}),i.jsx("option",{value:"payu",children:"PayU"}),i.jsx("option",{value:"bankTransfer",children:"Transferencia Bancaria"})]})]})]}),i.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Cada pasarela tiene su propia configuración de auto-aprobación independiente."})]}),y("bold","Bold",[{name:"apiKey",label:"API Key",type:"password",placeholder:"Ingresa tu API Key de Bold"},{name:"environment",label:"Ambiente",type:"select",options:[{value:"sandbox",label:"Sandbox (Pruebas)"},{value:"production",label:"Producción"}]},{name:"webhookSecret",label:"Webhook Secret",type:"password",placeholder:"Secreto para webhooks"}]),y("paypal","PayPal",[{name:"clientId",label:"Client ID",type:"text",placeholder:"Ingresa tu Client ID de PayPal"},{name:"clientSecret",label:"Client Secret",type:"password",placeholder:"Ingresa tu Client Secret"},{name:"environment",label:"Ambiente",type:"select",options:[{value:"sandbox",label:"Sandbox (Pruebas)"},{value:"live",label:"Live (Producción)"}]}]),y("payu","PayU",[{name:"merchantId",label:"Merchant ID",type:"text",placeholder:"ID del comerciante"},{name:"apiKey",label:"API Key",type:"password",placeholder:"API Key de PayU"},{name:"apiLogin",label:"API Login",type:"text",placeholder:"API Login de PayU"},{name:"environment",label:"Ambiente",type:"select",options:[{value:"sandbox",label:"Sandbox (Pruebas)"},{value:"production",label:"Producción"}]}]),i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[i.jsx($t,{}),"Transferencias Bancarias"]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:n.bankTransfer.enabled,onChange:x=>o("bankTransfer","enabled",x.target.checked),className:"mr-2"}),i.jsx("span",{className:"text-sm text-gray-600",children:"Habilitado"})]})]}),n.bankTransfer.enabled&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"p-3 bg-gray-50 rounded-md",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:n.bankTransfer.autoApprove,onChange:x=>o("bankTransfer","autoApprove",x.target.checked),className:"mr-2"}),i.jsx("span",{className:"text-sm text-gray-700",children:"Aprobar transferencias automáticamente"})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Las transferencias se marcarán como "Completado" automáticamente'})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h4",{className:"text-md font-medium text-gray-800",children:"Cuentas Bancarias"}),i.jsx("button",{onClick:u,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700",children:"+ Agregar Cuenta"})]}),i.jsx("div",{className:"space-y-4",children:n.bankTransfer.accounts.map((x,S)=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h5",{className:"font-medium text-gray-700",children:["Cuenta ",S+1]}),i.jsx("button",{onClick:()=>m(x.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Eliminar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Banco"}),i.jsx("input",{type:"text",value:x.bankName,onChange:E=>d(x.id,"bankName",E.target.value),placeholder:"Ej: Banco Nacional",className:"w-full p-2 border rounded-md"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Número de Cuenta"}),i.jsx("input",{type:"text",value:x.accountNumber,onChange:E=>d(x.id,"accountNumber",E.target.value),placeholder:"1234567890",className:"w-full p-2 border rounded-md"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titular de la Cuenta"}),i.jsx("input",{type:"text",value:x.accountHolder,onChange:E=>d(x.id,"accountHolder",E.target.value),placeholder:"Nombre del titular",className:"w-full p-2 border rounded-md"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Cuenta"}),i.jsxs("select",{value:x.accountType,onChange:E=>d(x.id,"accountType",E.target.value),className:"w-full p-2 border rounded-md",children:[i.jsx("option",{value:"Ahorros",children:"Ahorros"}),i.jsx("option",{value:"Corriente",children:"Corriente"})]})]})]})]},x.id))}),n.bankTransfer.accounts.length===0&&i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx("p",{children:"No hay cuentas bancarias configuradas"}),i.jsx("p",{className:"text-sm",children:'Haz clic en "Agregar Cuenta" para comenzar'})]})]})]})]}),i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"⚠️ Información Importante"}),i.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[i.jsx("li",{children:"• Las credenciales se almacenan de forma segura en Firestore"}),i.jsx("li",{children:"• Siempre prueba en modo sandbox antes de usar en producción"}),i.jsx("li",{children:"• Mantén tus claves API seguras y no las compartas"}),i.jsx("li",{children:"• Los webhooks deben configurarse en cada pasarela de pago"})]})]})]})}function aP({isOpen:t,onClose:e,payment:n,onSend:r,isDemo:s}){const{addNotification:a}=Ae(),[o,c]=L.useState([]),[u,d]=L.useState(""),[m,g]=L.useState("approval"),[y,x]=L.useState(""),[S,E]=L.useState(!1),P={approval:[{id:"approval_1",name:"Pago Aprobado - Estándar",subject:"Pago Aprobado - {serviceNumber}",body:`Estimado/a {clientName},

Su pago por el servicio {serviceNumber} ha sido aprobado exitosamente.

Detalles del pago:
- Servicio: {serviceType}
- Monto: {amount} {currency}
- Fecha: {paymentDate}
- Método: {gateway}

Su servicio está ahora activo. Gracias por su pago.

Saludos cordiales,
Equipo de Soporte`},{id:"approval_2",name:"Pago Aprobado - Con Acceso",subject:"Pago Confirmado - Acceso Activado",body:`Hola {clientName},

¡Excelente noticia! Su pago de {amount} {currency} ha sido procesado correctamente.

Su servicio {serviceType} (Ref: {serviceNumber}) está ahora activo y disponible.

Puede acceder a su panel de cliente en: {clientPortalUrl}

Si tiene alguna pregunta, no dude en contactarnos.

¡Gracias por confiar en nosotros!`}],rejection:[{id:"rejection_1",name:"Pago Rechazado - Estándar",subject:"Pago Rechazado - {serviceNumber}",body:`Estimado/a {clientName},

Lamentamos informarle que su pago por el servicio {serviceNumber} no pudo ser procesado.

Detalles del pago:
- Servicio: {serviceType}
- Monto: {amount} {currency}
- Fecha: {paymentDate}
- Método: {gateway}

Por favor, verifique los datos de su método de pago e intente nuevamente.

Si necesita ayuda, contacte a nuestro equipo de soporte.

Saludos cordiales,
Equipo de Soporte`},{id:"rejection_2",name:"Pago Rechazado - Con Alternativas",subject:"Problema con el Pago - Alternativas Disponibles",body:`Hola {clientName},

Hemos detectado un problema con su pago de {amount} {currency} para el servicio {serviceNumber}.

Métodos de pago alternativos disponibles:
- Transferencia bancaria
- PayPal
- Pago en efectivo (oficina)

Para más información, visite: {paymentMethodsUrl}

¿Necesita ayuda? Contáctenos: {supportEmail}

¡Estamos aquí para ayudarle!`}]};L.useEffect(()=>{if(s){c([]);return}const z=qe(ge(te,"artifacts",ee,"public","data","templates"),rt("type","==","payment_message")),I=_e(z,b=>{const C=b.docs.map(p=>({id:p.id,...p.data()}));c(C)});return()=>I()},[s]);const T=z=>{d(z);const I=o.find(p=>p.id===z);if(I){x(I.body);return}const C=P[m].find(p=>p.id===z);C&&x(C.body)},j=z=>n?z.replace(/{clientName}/g,n.clientName||"Cliente").replace(/{serviceNumber}/g,n.serviceNumber||"N/A").replace(/{serviceType}/g,n.serviceType||"Servicio").replace(/{amount}/g,n.amount||"0").replace(/{currency}/g,n.currency||"USD").replace(/{gateway}/g,n.gateway||"N/A").replace(/{paymentDate}/g,new Date().toLocaleDateString("es-ES")).replace(/{clientPortalUrl}/g,window.location.origin).replace(/{paymentMethodsUrl}/g,`${window.location.origin}/payment-methods`).replace(/{supportEmail}/g,"soporte@empresa.com"):z,R=async()=>{if(!y.trim()){a("Por favor, ingrese un mensaje","error");return}E(!0);try{const z={paymentId:n.id,type:m,templateId:u,message:j(y),sentAt:new Date,status:"sent"};await r(z),a(`Mensaje de ${m==="approval"?"aprobación":"rechazo"} enviado`,"success"),e()}catch(z){console.error("Error sending message:",z),a("Error al enviar el mensaje","error")}E(!1)};if(!t||!n)return null;const M=P[m],q=[...o,...M];return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[i.jsx($t,{}),"Enviar Mensaje de ",m==="approval"?"Aprobación":"Rechazo"]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[i.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Información del Pago"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-600",children:"Cliente:"}),i.jsx("span",{className:"ml-2",children:n.clientName})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-600",children:"Servicio:"}),i.jsx("span",{className:"ml-2 font-mono",children:n.serviceNumber})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-600",children:"Monto:"}),i.jsxs("span",{className:"ml-2",children:[n.amount," ",n.currency]})]})]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Tipo de Mensaje"}),i.jsxs("div",{className:"flex space-x-4",children:[i.jsxs("button",{onClick:()=>g("approval"),className:`flex items-center gap-2 px-4 py-2 rounded-lg border ${m==="approval"?"bg-green-50 border-green-200 text-green-800":"bg-gray-50 border-gray-200 text-gray-600"}`,children:[i.jsx(_u,{}),"Aprobación"]}),i.jsxs("button",{onClick:()=>g("rejection"),className:`flex items-center gap-2 px-4 py-2 rounded-lg border ${m==="rejection"?"bg-red-50 border-red-200 text-red-800":"bg-gray-50 border-gray-200 text-gray-600"}`,children:[i.jsx(Ci,{}),"Rechazo"]})]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Seleccionar Plantilla"}),i.jsxs("select",{value:u,onChange:z=>T(z.target.value),className:"w-full p-2 border rounded-md",children:[i.jsx("option",{value:"",children:"-- Seleccionar plantilla --"}),q.map(z=>i.jsx("option",{value:z.id,children:z.name},z.id))]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje Personalizado"}),i.jsx("textarea",{value:y,onChange:z=>x(z.target.value),placeholder:"Escriba su mensaje personalizado aquí...",rows:12,className:"w-full p-3 border rounded-md font-mono text-sm"}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables disponibles: ",clientName,", ",serviceNumber,", ",serviceType,", ",amount,", ",currency,", ",gateway,", ",paymentDate]})]}),y&&i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vista Previa"}),i.jsxs("div",{className:"bg-gray-50 border rounded-lg p-4",children:[i.jsx("div",{className:"font-semibold text-gray-800 mb-2",children:m==="approval"?"✅ Pago Aprobado":"❌ Pago Rechazado"}),i.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:j(y)})]})]}),i.jsxs("div",{className:"flex justify-end space-x-4",children:[i.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{onClick:R,disabled:S||!y.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:S?"Enviando...":`Enviar ${m==="approval"?"Aprobación":"Rechazo"}`})]})]})})}function oP({isDemo:t}){const{addNotification:e}=Ae(),[n,r]=L.useState({renewalSettings:{enabled:!0,maxRenewalYears:3,autoRenewal:!0,gracePeriodDays:7,reminderDays:3},discounts:{monthly:{enabled:!1,discount:0,description:"Descuento por pago mensual"},quarterly:{enabled:!1,discount:5,description:"Descuento por pago trimestral"},semiAnnual:{enabled:!1,discount:10,description:"Descuento por pago semestral"},annual:{enabled:!1,discount:15,description:"Descuento por pago anual"},biennial:{enabled:!1,discount:25,description:"Descuento por pago bienal (2 años)"},triennial:{enabled:!1,discount:35,description:"Descuento por pago trienal (3 años)"}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"},documentSettings:{invoiceName:"Factura",receiptName:"Remisión",invoicePrefix:"FAC",receiptPrefix:"REM",invoiceNumberFormat:"FAC-{year}-{month}-{number}",receiptNumberFormat:"REM-{year}-{month}-{number}"},pricingSettings:{roundToNearest:100,minimumAmount:1e3,maximumAmount:1e7}}),[s,a]=L.useState(!1);L.useEffect(()=>{if(t){r({renewalSettings:{enabled:!0,maxRenewalYears:3,autoRenewal:!0,gracePeriodDays:7,reminderDays:3},discounts:{monthly:{enabled:!1,discount:0,description:"Descuento por pago mensual"},quarterly:{enabled:!0,discount:5,description:"Descuento por pago trimestral"},semiAnnual:{enabled:!0,discount:10,description:"Descuento por pago semestral"},annual:{enabled:!0,discount:15,description:"Descuento por pago anual"},biennial:{enabled:!0,discount:25,description:"Descuento por pago bienal (2 años)"},triennial:{enabled:!0,discount:35,description:"Descuento por pago trienal (3 años)"}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"},documentSettings:{invoiceName:"Factura",receiptName:"Remisión",invoicePrefix:"FAC",receiptPrefix:"REM",invoiceNumberFormat:"FAC-{year}-{month}-{number}",receiptNumberFormat:"REM-{year}-{month}-{number}"},pricingSettings:{roundToNearest:100,minimumAmount:1e3,maximumAmount:1e7}});return}const x=ce(te,"artifacts",ee,"public","data","settings","renewalConfig"),S=_e(x,E=>{E.exists()&&r(E.data())});return()=>S()},[t]);const o=(x,S,E)=>{r(P=>({...P,[x]:{...P[x],[S]:E}}))},c=(x,S,E)=>{r(P=>({...P,discounts:{...P.discounts,[x]:{...P.discounts[x],[S]:E}}}))},u=async()=>{if(t){e("Configuración guardada (modo demo)","success");return}a(!0);try{const x=ce(te,"artifacts",ee,"public","data","settings","renewalConfig");await Dn(x,n),e("Configuración de renovaciones guardada exitosamente","success")}catch(x){console.error("Error saving renewal config:",x),e("Error al guardar la configuración","error")}a(!1)},d=(x,S)=>{const E=n.discounts[S];if(!E.enabled)return x;const P=x*E.discount/100,T=x-P,j=Math.round(T/n.pricingSettings.roundToNearest)*n.pricingSettings.roundToNearest;return Math.max(j,n.pricingSettings.minimumAmount)},m=x=>{if(!n.taxSettings.ivaEnabled||n.taxSettings.ivaIncluded)return x;{const S=x*n.taxSettings.ivaPercentage/100;return x+S}},g=x=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(x),y=[{key:"monthly",label:"Mensual",months:1},{key:"quarterly",label:"Trimestral",months:3},{key:"semiAnnual",label:"Semestral",months:6},{key:"annual",label:"Anual",months:12},{key:"biennial",label:"Bienal (2 años)",months:24},{key:"triennial",label:"Trienal (3 años)",months:36}];return i.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(Ur,{}),"Configuración de Renovaciones"]}),i.jsx("button",{onClick:u,disabled:s,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:s?"Guardando...":"Guardar Configuración"})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[i.jsx(wu,{}),"Configuración General"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsx("div",{children:i.jsxs("label",{className:"flex items-center mb-2",children:[i.jsx("input",{type:"checkbox",checked:n.renewalSettings.enabled,onChange:x=>o("renewalSettings","enabled",x.target.checked),className:"mr-2"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Habilitar renovaciones automáticas"})]})}),i.jsx("div",{children:i.jsxs("label",{className:"flex items-center mb-2",children:[i.jsx("input",{type:"checkbox",checked:n.renewalSettings.autoRenewal,onChange:x=>o("renewalSettings","autoRenewal",x.target.checked),className:"mr-2"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Renovación automática"})]})}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Máximo de años para renovación"}),i.jsxs("select",{value:n.renewalSettings.maxRenewalYears,onChange:x=>o("renewalSettings","maxRenewalYears",parseInt(x.target.value)),className:"w-full p-2 border rounded-md",children:[i.jsx("option",{value:1,children:"1 año"}),i.jsx("option",{value:2,children:"2 años"}),i.jsx("option",{value:3,children:"3 años"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Días de gracia"}),i.jsx("input",{type:"number",value:n.renewalSettings.gracePeriodDays,onChange:x=>o("renewalSettings","gracePeriodDays",parseInt(x.target.value)),className:"w-full p-2 border rounded-md",min:"0",max:"30"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Días de recordatorio"}),i.jsx("input",{type:"number",value:n.renewalSettings.reminderDays,onChange:x=>o("renewalSettings","reminderDays",parseInt(x.target.value)),className:"w-full p-2 border rounded-md",min:"1",max:"30"})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[i.jsx(x_,{}),"Descuentos por Período de Renovación"]}),i.jsx("div",{className:"space-y-4",children:y.map(x=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h4",{className:"font-medium text-gray-800",children:x.label}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:n.discounts[x.key].enabled,onChange:S=>c(x.key,"enabled",S.target.checked),className:"mr-2"}),i.jsx("span",{className:"text-sm text-gray-600",children:"Habilitado"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descuento (%)"}),i.jsx("input",{type:"number",value:n.discounts[x.key].discount,onChange:S=>c(x.key,"discount",parseFloat(S.target.value)),className:"w-full p-2 border rounded-md",min:"0",max:"100",step:"0.1",disabled:!n.discounts[x.key].enabled})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción"}),i.jsx("input",{type:"text",value:n.discounts[x.key].description,onChange:S=>c(x.key,"description",S.target.value),className:"w-full p-2 border rounded-md",disabled:!n.discounts[x.key].enabled})]})]}),n.discounts[x.key].enabled&&i.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-md",children:[i.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Simulación de Precio"}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsxs("div",{children:["Precio original: ",g(1e5)]}),i.jsxs("div",{children:["Descuento (",n.discounts[x.key].discount,"%): ",g(1e5-d(1e5,x.key))]}),i.jsxs("div",{className:"font-semibold text-green-600",children:["Precio final: ",g(d(1e5,x.key))]})]})]})]},x.key))})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[i.jsx($t,{}),"Configuración de Impuestos"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsx("div",{children:i.jsxs("label",{className:"flex items-center mb-2",children:[i.jsx("input",{type:"checkbox",checked:n.taxSettings.ivaEnabled,onChange:x=>o("taxSettings","ivaEnabled",x.target.checked),className:"mr-2"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Habilitar IVA"})]})}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Porcentaje de IVA (%)"}),i.jsx("input",{type:"number",value:n.taxSettings.ivaPercentage,onChange:x=>o("taxSettings","ivaPercentage",parseFloat(x.target.value)),className:"w-full p-2 border rounded-md",min:"0",max:"100",step:"0.1",disabled:!n.taxSettings.ivaEnabled})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de IVA"}),i.jsxs("select",{value:n.taxSettings.ivaIncluded?"included":"excluded",onChange:x=>o("taxSettings","ivaIncluded",x.target.value==="included"),className:"w-full p-2 border rounded-md",disabled:!n.taxSettings.ivaEnabled,children:[i.jsx("option",{value:"excluded",children:"IVA se suma al precio"}),i.jsx("option",{value:"included",children:"IVA incluido en el precio"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del impuesto"}),i.jsx("input",{type:"text",value:n.taxSettings.taxName,onChange:x=>o("taxSettings","taxName",x.target.value),className:"w-full p-2 border rounded-md",disabled:!n.taxSettings.ivaEnabled})]})]}),n.taxSettings.ivaEnabled&&i.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[i.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Simulación de Impuestos"}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsxs("div",{children:["Precio base: ",g(1e5)]}),!n.taxSettings.ivaIncluded&&i.jsxs("div",{children:["IVA (",n.taxSettings.ivaPercentage,"%): ",g(1e5*n.taxSettings.ivaPercentage/100)]}),i.jsxs("div",{className:"font-semibold text-blue-600",children:["Precio final: ",g(m(1e5))]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuración de Documentos"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de Factura"}),i.jsx("input",{type:"text",value:n.documentSettings.invoiceName,onChange:x=>o("documentSettings","invoiceName",x.target.value),className:"w-full p-2 border rounded-md"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de Remisión"}),i.jsx("input",{type:"text",value:n.documentSettings.receiptName,onChange:x=>o("documentSettings","receiptName",x.target.value),className:"w-full p-2 border rounded-md"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prefijo de Factura"}),i.jsx("input",{type:"text",value:n.documentSettings.invoicePrefix,onChange:x=>o("documentSettings","invoicePrefix",x.target.value),className:"w-full p-2 border rounded-md"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prefijo de Remisión"}),i.jsx("input",{type:"text",value:n.documentSettings.receiptPrefix,onChange:x=>o("documentSettings","receiptPrefix",x.target.value),className:"w-full p-2 border rounded-md"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Formato de Número de Factura"}),i.jsx("input",{type:"text",value:n.documentSettings.invoiceNumberFormat,onChange:x=>o("documentSettings","invoiceNumberFormat",x.target.value),className:"w-full p-2 border rounded-md",placeholder:"FAC-{year}-{month}-{number}"}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables disponibles: ","{year}",", ","{month}",", ","{number}"]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Formato de Número de Remisión"}),i.jsx("input",{type:"text",value:n.documentSettings.receiptNumberFormat,onChange:x=>o("documentSettings","receiptNumberFormat",x.target.value),className:"w-full p-2 border rounded-md",placeholder:"REM-{year}-{month}-{number}"}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables disponibles: ","{year}",", ","{month}",", ","{number}"]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuración de Precios"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Redondear al múltiplo más cercano"}),i.jsx("input",{type:"number",value:n.pricingSettings.roundToNearest,onChange:x=>o("pricingSettings","roundToNearest",parseInt(x.target.value)),className:"w-full p-2 border rounded-md",min:"1"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ej: 100 para redondear a centenas"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto mínimo"}),i.jsx("input",{type:"number",value:n.pricingSettings.minimumAmount,onChange:x=>o("pricingSettings","minimumAmount",parseInt(x.target.value)),className:"w-full p-2 border rounded-md",min:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto máximo"}),i.jsx("input",{type:"number",value:n.pricingSettings.maximumAmount,onChange:x=>o("pricingSettings","maximumAmount",parseInt(x.target.value)),className:"w-full p-2 border rounded-md",min:"0"})]})]})]}),i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"⚠️ Información Importante"}),i.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[i.jsx("li",{children:"• Los descuentos se aplican automáticamente según el período de renovación seleccionado"}),i.jsx("li",{children:"• Los precios se redondean automáticamente para evitar decimales"}),i.jsx("li",{children:"• El IVA se calcula según la configuración establecida"}),i.jsx("li",{children:"• Los nombres de documentos se pueden personalizar según las necesidades"})]})]})]})}function lP({isDemo:t,userRole:e}){const{addNotification:n}=Ae(),[r,s]=L.useState([]),[a,o]=L.useState([]),[c,u]=L.useState(""),[d,m]=L.useState("Todos"),[g,y]=L.useState("Todos"),[x,S]=L.useState(!0),[E,P]=L.useState("history"),[T,j]=L.useState(!1),[R,M]=L.useState(null),[q,z]=L.useState(!1),I=["Todos","Pendiente","Procesando","Completado","Fallido","Cancelado","Reembolsado"],b=["Todos","Bold","PayPal","PayU","Transferencia Bancaria","Manual"];L.useEffect(()=>{if(t){s([{id:"demo1",serviceNumber:"SRV-241017-123456",clientName:"Juan Pérez",clientEmail:"juan@ejemplo.com",amount:10.99,currency:"USD",status:"Completado",gateway:"Bold",transactionId:"bold_txn_123456",createdAt:{seconds:Date.now()/1e3-86400},completedAt:{seconds:Date.now()/1e3-3600}},{id:"demo2",serviceNumber:"SRV-241017-789012",clientName:"María García",clientEmail:"maria@ejemplo.com",amount:25,currency:"USD",status:"Pendiente",gateway:"PayPal",transactionId:"paypal_txn_789012",createdAt:{seconds:Date.now()/1e3-7200}},{id:"demo3",serviceNumber:"SRV-241017-345678",clientName:"Carlos López",clientEmail:"carlos@ejemplo.com",amount:50,currency:"USD",status:"Completado",gateway:"Transferencia Bancaria",transactionId:"TRF-123456789",createdAt:{seconds:Date.now()/1e3-10800},completedAt:{seconds:Date.now()/1e3-9e3}}]),o([{id:"client1",fullName:"Juan Pérez",email:"juan@ejemplo.com"},{id:"client2",fullName:"María García",email:"maria@ejemplo.com"}]),S(!1);return}const A=ge(te,"artifacts",ee,"public","data","payments"),F=_e(A,Z=>{console.log("Admin payments snapshot:",Z.size,"documents");const U=Z.docs.map(Q=>{const X=Q.data();return console.log("Payment doc:",Q.id,X),{id:Q.id,...X}});U.sort((Q,X)=>{var He,je;const ae=((He=Q.createdAt)==null?void 0:He.seconds)||0;return(((je=X.createdAt)==null?void 0:je.seconds)||0)-ae}),console.log("Admin payments loaded:",U.length,U),s(U),S(!1)},Z=>{console.error("Error loading payments:",Z),n("Error al cargar los pagos","error"),S(!1)}),K=qe(ge(te,"artifacts",ee,"public","data","users"),rt("role","==","client")),G=_e(K,Z=>{const U=Z.docs.map(Q=>({id:Q.id,...Q.data()}));o(U)});return()=>{F(),G()}},[t,n]);const C=r.filter(A=>{var Z,U,Q,X;const F=((Z=A.serviceNumber)==null?void 0:Z.toLowerCase().includes(c.toLowerCase()))||((U=A.clientName)==null?void 0:U.toLowerCase().includes(c.toLowerCase()))||((Q=A.clientEmail)==null?void 0:Q.toLowerCase().includes(c.toLowerCase()))||((X=A.transactionId)==null?void 0:X.toLowerCase().includes(c.toLowerCase())),K=d==="Todos"||A.status===d,G=g==="Todos"||A.gateway===g;return F&&K&&G}),p=async(A,F)=>{if(t){n("Función no disponible en modo demo","error");return}try{const K=ce(te,"artifacts",ee,"public","data","payments",A);if(await Xe(K,{status:F,updatedAt:new Date,...F==="Completado"?{completedAt:le.now()}:{}}),F==="Completado"){const G=await So(K);if(G.exists()){const Z=G.data(),U=Z.serviceId;if(U&&(Z.isRenewal||Z.paymentType==="Renovación"))try{const Q=ce(te,"artifacts",ee,"public","data","services",U),X={};Z.startDate&&(X.dueDate=Z.startDate),Z.endDate&&(X.expirationDate=Z.endDate),X.status="Pago",X.updatedAt=le.now(),await Xe(Q,X)}catch(Q){console.error("Error updating service after completed payment:",Q)}}}n(`Estado del pago actualizado a ${F}`,"success")}catch(K){console.error("Error updating payment status:",K),n("Error al actualizar el estado del pago","error")}},k=(A,F)=>{M(A),j(!0)},w=A=>{const F={invoiceNumber:`INV-${A.id.slice(-8).toUpperCase()}`,date:new Date(A.createdAt.seconds*1e3).toLocaleDateString(),dueDate:A.dueDate?new Date(A.dueDate.seconds*1e3).toLocaleDateString():"N/A",clientName:A.clientName||"Cliente",clientEmail:A.clientEmail||"N/A",serviceNumber:A.serviceNumber||"N/A",serviceType:A.serviceType||"Servicio",description:A.description||"Descripción del servicio",amount:A.amount||0,currency:A.currency||"USD",status:A.status||"Pendiente",gateway:A.gateway||"N/A",transactionId:A.transactionId||"N/A",paymentMethod:A.paymentMethod||"N/A"},K=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>Invoice ${F.invoiceNumber}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
          .invoice { background: white; max-width: 800px; margin: 0 auto; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
          .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #e5e5e5; padding-bottom: 20px; }
          .company-name { font-size: 24px; font-weight: bold; color: #2563eb; margin-bottom: 5px; }
          .invoice-title { font-size: 18px; color: #666; }
          .invoice-details { display: flex; justify-content: space-between; margin-bottom: 30px; }
          .client-info, .invoice-info { flex: 1; }
          .client-info h3, .invoice-info h3 { margin: 0 0 10px 0; color: #333; font-size: 16px; }
          .client-info p, .invoice-info p { margin: 5px 0; color: #666; font-size: 14px; }
          .service-details { margin-bottom: 30px; }
          .service-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
          .service-table th, .service-table td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e5e5; }
          .service-table th { background: #f8f9fa; font-weight: bold; color: #333; }
          .service-table .amount { text-align: right; font-weight: bold; }
          .total { text-align: right; margin-top: 20px; }
          .total-amount { font-size: 20px; font-weight: bold; color: #2563eb; }
          .status { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; }
          .status.completado { background: #d1fae5; color: #065f46; }
          .status.pendiente { background: #fef3c7; color: #92400e; }
          .status.fallido { background: #fee2e2; color: #991b1b; }
          .status.cancelado { background: #f3f4f6; color: #374151; }
          .footer { margin-top: 40px; text-align: center; color: #666; font-size: 12px; border-top: 1px solid #e5e5e5; padding-top: 20px; }
        </style>
      </head>
      <body>
        <div class="invoice">
          <div class="header">
            <div class="company-name">Gestor de Cobros</div>
            <div class="invoice-title">FACTURA</div>
          </div>
          
          <div class="invoice-details">
            <div class="client-info">
              <h3>Cliente</h3>
              <p><strong>${F.clientName}</strong></p>
              <p>${F.clientEmail}</p>
            </div>
            <div class="invoice-info">
              <h3>Detalles de la Factura</h3>
              <p><strong>Número:</strong> ${F.invoiceNumber}</p>
              <p><strong>Fecha:</strong> ${F.date}</p>
              <p><strong>Vencimiento:</strong> ${F.dueDate}</p>
              <p><strong>Estado:</strong> <span class="status ${F.status.toLowerCase()}">${F.status}</span></p>
            </div>
          </div>
          
          <div class="service-details">
            <h3>Detalles del Servicio</h3>
            <table class="service-table">
              <thead>
                <tr>
                  <th>Servicio</th>
                  <th>Descripción</th>
                  <th>Monto</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>${F.serviceType}</td>
                  <td>${F.description}</td>
                  <td class="amount">${F.currency} ${F.amount.toFixed(2)}</td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <div class="total">
            <div class="total-amount">Total: ${F.currency} ${F.amount.toFixed(2)}</div>
          </div>
          
          <div class="footer">
            <p>Método de Pago: ${F.paymentMethod}</p>
            <p>Gateway: ${F.gateway}</p>
            ${F.transactionId!=="N/A"?`<p>ID de Transacción: ${F.transactionId}</p>`:""}
            <p>Gracias por su negocio</p>
          </div>
        </div>
      </body>
      </html>
    `,G=new Blob([K],{type:"text/html"}),Z=URL.createObjectURL(G),U=document.createElement("a");U.href=Z,U.download=`invoice-${F.invoiceNumber}.html`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(Z),n("Invoice descargado exitosamente","success")},N=async A=>{if(t){n("Función no disponible en modo demo","error");return}if(window.confirm("¿Estás seguro de que quieres eliminar este pago? Esta acción no se puede deshacer."))try{await Si(ce(te,"artifacts",ee,"public","data","payments",A)),n("Pago eliminado exitosamente","success")}catch(F){console.error("Error deleting payment:",F),n("Error al eliminar el pago","error")}},$=async A=>{if(t){n("Mensaje enviado (modo demo)","success");return}try{console.log("Mensaje enviado:",A),n("Mensaje enviado exitosamente","success")}catch(F){console.error("Error sending message:",F),n("Error al enviar el mensaje","error")}},D=A=>({Pendiente:"bg-yellow-100 text-yellow-800",Procesando:"bg-blue-100 text-blue-800",Completado:"bg-green-100 text-green-800",Fallido:"bg-red-100 text-red-800",Cancelado:"bg-gray-100 text-gray-800",Reembolsado:"bg-purple-100 text-purple-800"})[A]||"bg-gray-100 text-gray-800",V=A=>({Bold:"bg-blue-100 text-blue-800",PayPal:"bg-yellow-100 text-yellow-800",PayU:"bg-green-100 text-green-800","Transferencia Bancaria":"bg-purple-100 text-purple-800",Manual:"bg-gray-100 text-gray-800"})[A]||"bg-gray-100 text-gray-800",O=A=>A?new Date(A.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",v=(A,F)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:F||"USD"}).format(A);return x?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):i.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[i.jsx("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:i.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[i.jsx($t,{}),"Gestión de Pagos"]})}),i.jsx("div",{className:"border-b border-gray-200 mb-6",children:i.jsxs("nav",{className:"-mb-px flex space-x-8",children:[i.jsxs("button",{onClick:()=>P("history"),className:`${E==="history"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[i.jsx($t,{}),"Historial de Pagos"]}),i.jsxs("button",{onClick:()=>P("renewal"),className:`${E==="renewal"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[i.jsx(Ur,{}),"Renovaciones"]}),e==="superadmin"&&i.jsxs("button",{onClick:()=>P("config"),className:`${E==="config"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[i.jsx(wu,{}),"Configuración"]})]})}),E==="renewal"?i.jsxs("div",{className:"p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Configuración de Renovaciones"}),i.jsx(oP,{isDemo:t})]}):E==="config"?i.jsx(v_,{isDemo:t}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:i.jsxs("div",{className:"text-sm text-gray-500",children:[C.length," pago",C.length!==1?"s":""," encontrado",C.length!==1?"s":""]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",placeholder:"Buscar por servicio, cliente, email o transacción...",value:c,onChange:A=>u(A.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md"}),i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Vi,{})})]}),i.jsx("select",{value:d,onChange:A=>m(A.target.value),className:"w-full p-2 border rounded-md",children:I.map(A=>i.jsx("option",{value:A,children:A},A))}),i.jsx("select",{value:g,onChange:A=>y(A.target.value),className:"w-full p-2 border rounded-md",children:b.map(A=>i.jsx("option",{value:A,children:A},A))}),i.jsxs("button",{className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:[i.jsx(di,{}),"Filtros"]})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:i.jsxs("table",{className:"w-full text-left",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsx("tr",{children:["Servicio","Cliente","Monto","Estado","Pasarela","Transacción","Fecha","Acciones"].map(A=>i.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:A},A))})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:C.map(A=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsxs("td",{className:"px-6 py-4",children:[i.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:A.serviceNumber||A.id}),i.jsx("div",{className:"text-sm text-gray-600",children:A.serviceName||A.serviceType||"N/A"}),A.serviceDescription&&i.jsx("div",{className:"text-xs text-gray-500 truncate max-w-xs",children:A.serviceDescription}),A.isRenewal&&i.jsxs("div",{className:"text-xs text-green-600 font-medium",children:["Renovación: ",A.renewalPeriod||"N/A"]})]}),i.jsxs("td",{className:"px-6 py-4",children:[i.jsx("div",{className:"font-medium text-gray-900",children:A.clientName}),i.jsx("div",{className:"text-sm text-gray-500",children:A.clientEmail})]}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"font-semibold text-gray-900",children:v(A.amount,A.currency)})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${D(A.status)}`,children:A.status})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${V(A.gateway)}`,children:A.gateway})}),i.jsxs("td",{className:"px-6 py-4",children:[i.jsx("div",{className:"font-mono text-sm text-gray-600",children:A.transactionId||"N/A"}),A.proofUrl&&i.jsx("div",{className:"mt-2",children:i.jsx("button",{onClick:()=>{M(A),z(!0)},className:"px-2 py-1 text-xs bg-purple-100 text-purple-700 rounded hover:bg-purple-200",children:"Ver Comprobante"})})]}),i.jsxs("td",{className:"px-6 py-4",children:[i.jsxs("div",{className:"text-sm text-gray-900 flex items-center gap-2",children:[O(A.createdAt),A.proofUrl&&i.jsx("span",{className:"ml-2 inline-flex px-2 py-0.5 text-xs rounded-full bg-purple-100 text-purple-700",title:"Comprobante adjunto",children:"Comprobante"})]}),A.completedAt&&i.jsxs("div",{className:"text-xs text-gray-500",children:["Completado: ",O(A.completedAt)]}),A.startDate&&A.endDate&&i.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[i.jsxs("div",{children:["Inicio: ",O(A.startDate)]}),i.jsxs("div",{children:["Fin: ",O(A.endDate)]})]})]}),i.jsx("td",{className:"px-6 py-4",children:i.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[A.proofUrl&&i.jsx("button",{onClick:()=>{M(A),z(!0)},className:"p-2 text-purple-600 hover:bg-purple-50 rounded-md",title:"Ver comprobante de pago",children:i.jsx(Gr,{})}),e==="superadmin"&&i.jsxs(i.Fragment,{children:[i.jsxs(ko,{children:[i.jsx("select",{value:A.status,onChange:F=>p(A.id,F.target.value),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 border-none bg-transparent",children:I.filter(F=>F!=="Todos").map(F=>i.jsx("option",{value:F,children:F},F))}),i.jsxs("button",{onClick:()=>w(A),className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50 flex items-center",children:[i.jsx(Gr,{className:"h-4 w-4 mr-2"}),"Descargar Invoice"]}),i.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:"Ver Detalles"}),i.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-yellow-700 hover:bg-yellow-50",children:"Reembolsar"}),i.jsxs("button",{onClick:()=>N(A.id),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50 flex items-center",children:[i.jsx(g_,{className:"h-4 w-4 mr-2"}),"Eliminar Pago"]})]}),i.jsx("button",{onClick:()=>k(A),className:"p-2 text-green-600 hover:bg-green-50 rounded-md",title:"Enviar mensaje de aprobación",children:i.jsx(_u,{})}),i.jsx("button",{onClick:()=>k(A),className:"p-2 text-red-600 hover:bg-red-50 rounded-md",title:"Enviar mensaje de rechazo",children:i.jsx(Ci,{})})]})]})})]},A.id))})]})}),C.length===0&&i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[i.jsx($t,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron pagos"}),i.jsx("p",{className:"text-gray-500",children:"No hay pagos que coincidan con los filtros seleccionados."})]})]}),i.jsx(aP,{isOpen:T,onClose:()=>j(!1),payment:R,onSend:$,isDemo:t}),q&&(R==null?void 0:R.proofUrl)&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"p-4 flex justify-between items-center border-b",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Comprobante de Pago"}),i.jsx("button",{onClick:()=>z(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),i.jsx("div",{className:"p-4",children:i.jsx("img",{src:R.proofUrl,alt:"Comprobante",className:"max-w-full h-auto rounded"})})]})})]})}function cP({isDemo:t,userRole:e}){const{addNotification:n}=Ae(),[r,s]=L.useState([]),[a,o]=L.useState(""),[c,u]=L.useState("Todos"),[d,m]=L.useState("Todos"),[g,y]=L.useState("Todos"),[x,S]=L.useState(!0),[E,P]=L.useState(null),[T,j]=L.useState(!1),R=["Todos","Enviado","Entregado","Leído","Fallido","Pendiente"],M=["Todos","Aprobación","Rechazo","Recordatorio","Notificación","Activación","Sistema"],q=["Todos","Cliente","Administrador","Sistema"];L.useEffect(()=>{if(t){s([{id:"msg1",type:"Aprobación",recipientType:"Cliente",recipientName:"Juan Pérez",recipientEmail:"juan@ejemplo.com",subject:"Pago Aprobado - SRV-241017-123456",message:`Estimado/a Juan Pérez,

Su pago por el servicio SRV-241017-123456 ha sido aprobado exitosamente.

Detalles del pago:
- Servicio: Hosting Básico
- Monto: $50,000 COP
- Fecha: 17/10/2024
- Método: Bold

Su servicio está ahora activo. Gracias por su pago.

Saludos cordiales,
Equipo de Soporte`,status:"Entregado",sentAt:{seconds:Date.now()/1e3-3600},deliveredAt:{seconds:Date.now()/1e3-3e3},readAt:{seconds:Date.now()/1e3-1800},templateId:"approval_1",paymentId:"pay1",serviceId:"srv1",sentBy:"admin@empresa.com",channel:"email"},{id:"msg2",type:"Recordatorio",recipientType:"Cliente",recipientName:"María García",recipientEmail:"maria@ejemplo.com",subject:"Recordatorio de Vencimiento - SRV-241017-789012",message:`Hola María García,

Te recordamos que tu servicio SRV-241017-789012 vence en 3 días.

Para evitar interrupciones, por favor realiza el pago correspondiente.

Gracias por tu atención.

Equipo de Soporte`,status:"Enviado",sentAt:{seconds:Date.now()/1e3-7200},deliveredAt:null,readAt:null,templateId:"reminder_1",serviceId:"srv2",sentBy:"sistema@empresa.com",channel:"email"},{id:"msg3",type:"Rechazo",recipientType:"Cliente",recipientName:"Carlos López",recipientEmail:"carlos@ejemplo.com",subject:"Pago Rechazado - SRV-241017-345678",message:`Estimado/a Carlos López,

Lamentamos informarle que su pago por el servicio SRV-241017-345678 no pudo ser procesado.

Por favor, verifique los datos de su método de pago e intente nuevamente.

Si necesita ayuda, contacte a nuestro equipo de soporte.

Saludos cordiales,
Equipo de Soporte`,status:"Fallido",sentAt:{seconds:Date.now()/1e3-10800},deliveredAt:null,readAt:null,templateId:"rejection_1",paymentId:"pay3",serviceId:"srv3",sentBy:"admin@empresa.com",channel:"email",errorMessage:"Error de conexión con el servidor de email"},{id:"msg4",type:"Notificación",recipientType:"Administrador",recipientName:"Admin Principal",recipientEmail:"admin@empresa.com",subject:"Nuevo Pago Recibido",message:`Se ha recibido un nuevo pago:

- Cliente: Ana Martínez
- Servicio: SRV-241017-456789
- Monto: $75,000 COP
- Método: Transferencia Bancaria

Por favor, verifica y aprueba el pago si es necesario.`,status:"Leído",sentAt:{seconds:Date.now()/1e3-14400},deliveredAt:{seconds:Date.now()/1e3-14300},readAt:{seconds:Date.now()/1e3-14200},templateId:"admin_payment_notification",paymentId:"pay4",serviceId:"srv4",sentBy:"sistema@empresa.com",channel:"email"}]),S(!1);return}const $=qe(ge(te,"artifacts",ee,"public","data","messages"),jo("sentAt","desc")),D=_e($,V=>{const O=V.docs.map(v=>({id:v.id,...v.data()}));s(O),S(!1)},V=>{console.error("Error loading messages:",V),n("Error al cargar los mensajes.","error"),S(!1)});return()=>D()},[t,n]);const z=async($,D)=>{if(t){n("Función no disponible en modo demo","error");return}try{const V=ce(te,"artifacts",ee,"public","data","messages",$);await Xe(V,{status:D,updatedAt:new Date}),n(`Estado del mensaje actualizado a ${D}`,"success")}catch(V){console.error("Error updating message status:",V),n("Error al actualizar el estado del mensaje","error")}},I=$=>{P($),j(!0)},b=$=>({Enviado:"bg-blue-100 text-blue-800",Entregado:"bg-green-100 text-green-800",Leído:"bg-purple-100 text-purple-800",Fallido:"bg-red-100 text-red-800",Pendiente:"bg-yellow-100 text-yellow-800"})[$]||"bg-gray-100 text-gray-800",C=$=>({Aprobación:"bg-green-100 text-green-800",Rechazo:"bg-red-100 text-red-800",Recordatorio:"bg-yellow-100 text-yellow-800",Notificación:"bg-blue-100 text-blue-800",Activación:"bg-purple-100 text-purple-800",Sistema:"bg-gray-100 text-gray-800"})[$]||"bg-gray-100 text-gray-800",p=$=>({Cliente:"bg-blue-100 text-blue-800",Administrador:"bg-purple-100 text-purple-800",Sistema:"bg-gray-100 text-gray-800"})[$]||"bg-gray-100 text-gray-800",k=$=>$?new Date($.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",w=$=>{switch($){case"Enviado":return i.jsx(en,{});case"Entregado":return i.jsx(_u,{});case"Leído":return i.jsx(Gr,{});case"Fallido":return i.jsx(Ci,{});case"Pendiente":return i.jsx(en,{});default:return i.jsx(en,{})}},N=r.filter($=>{const D=a===""||$.recipientName.toLowerCase().includes(a.toLowerCase())||$.recipientEmail.toLowerCase().includes(a.toLowerCase())||$.subject.toLowerCase().includes(a.toLowerCase())||$.message.toLowerCase().includes(a.toLowerCase()),V=c==="Todos"||$.status===c,O=d==="Todos"||$.type===d,v=g==="Todos"||$.recipientType===g;return D&&V&&O&&v});return x?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):i.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[i.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[i.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(Ul,{}),"Historial de Mensajes"]}),i.jsxs("div",{className:"text-sm text-gray-500",children:[N.length," mensaje",N.length!==1?"s":""," encontrado",N.length!==1?"s":""]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",placeholder:"Buscar por destinatario, asunto o contenido...",value:a,onChange:$=>o($.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full"}),i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Vi,{})})]}),i.jsxs("div",{className:"relative",children:[i.jsx("select",{value:c,onChange:$=>u($.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:R.map($=>i.jsx("option",{value:$,children:$},$))}),i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(di,{})})]}),i.jsxs("div",{className:"relative",children:[i.jsx("select",{value:d,onChange:$=>m($.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:M.map($=>i.jsx("option",{value:$,children:$},$))}),i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Ul,{})})]}),i.jsxs("div",{className:"relative",children:[i.jsx("select",{value:g,onChange:$=>y($.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:q.map($=>i.jsx("option",{value:$,children:$},$))}),i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(di,{})})]})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsx("tr",{children:["Tipo","Destinatario","Asunto","Estado","Canal","Enviado","Entregado","Leído","Acciones"].map($=>i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:$},$))})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map($=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${C($.type)}`,children:$.type}),i.jsx("span",{className:`ml-2 px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${p($.recipientType)}`,children:$.recipientType})]})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:$.recipientName}),i.jsx("div",{className:"text-sm text-gray-500",children:$.recipientEmail})]}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",title:$.subject,children:$.subject})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${b($.status)}`,children:$.status}),i.jsx("div",{className:"ml-2 text-gray-400",children:w($.status)})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:$.channel||"Email"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:k($.sentAt)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:$.deliveredAt?k($.deliveredAt):"--"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:$.readAt?k($.readAt):"--"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:i.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[i.jsx("button",{onClick:()=>I($),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md",title:"Ver mensaje completo",children:i.jsx(Gr,{})}),e==="superadmin"&&i.jsxs(ko,{children:[i.jsx("select",{value:$.status,onChange:D=>z($.id,D.target.value),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 border-none bg-transparent",children:R.filter(D=>D!=="Todos").map(D=>i.jsx("option",{value:D,children:D},D))}),i.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:"Reenviar"}),i.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"Eliminar"})]})]})})]},$.id))})]})}),N.length===0&&i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[i.jsx(Ul,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron mensajes"}),i.jsx("p",{className:"text-gray-500",children:"No hay mensajes que coincidan con los filtros seleccionados."})]}),T&&E&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Detalles del Mensaje"}),i.jsx("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tipo"}),i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${C(E.type)}`,children:E.type})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${b(E.status)}`,children:E.status})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Destinatario"}),i.jsx("div",{className:"text-sm text-gray-900",children:E.recipientName}),i.jsx("div",{className:"text-sm text-gray-500",children:E.recipientEmail})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Canal"}),i.jsx("div",{className:"text-sm text-gray-900",children:E.channel||"Email"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto"}),i.jsx("div",{className:"text-sm text-gray-900 p-3 bg-gray-50 rounded-md",children:E.subject})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contenido del Mensaje"}),i.jsx("div",{className:"text-sm text-gray-900 p-4 bg-gray-50 rounded-md whitespace-pre-wrap max-h-64 overflow-y-auto",children:E.message})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Enviado"}),i.jsx("div",{className:"text-gray-900",children:k(E.sentAt)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Entregado"}),i.jsx("div",{className:"text-gray-900",children:E.deliveredAt?k(E.deliveredAt):"No entregado"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Leído"}),i.jsx("div",{className:"text-gray-900",children:E.readAt?k(E.readAt):"No leído"})]})]}),E.errorMessage&&i.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:[i.jsx("label",{className:"block text-sm font-medium text-red-700 mb-1",children:"Error"}),i.jsx("div",{className:"text-sm text-red-600",children:E.errorMessage})]}),i.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[i.jsx("button",{onClick:()=>j(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cerrar"}),e==="superadmin"&&i.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Reenviar Mensaje"})]})]})]})})]})}function b_({ticketId:t,isDemo:e,userRole:n,currentUser:r}){const{addNotification:s}=Ae(),[a,o]=L.useState([]),[c,u]=L.useState(""),[d,m]=L.useState(!0),[g,y]=L.useState(!1);L.useEffect(()=>{if(e){o([{id:"msg1",ticketId:t,content:"Hola, tengo un problema con el acceso a mi panel de cliente. No puedo iniciar sesión desde ayer.",senderId:"client1",senderName:"Juan Pérez",senderRole:"client",senderEmail:"juan@ejemplo.com",isInternal:!1,createdAt:{seconds:Date.now()/1e3-3600},attachments:[]},{id:"msg2",ticketId:t,content:"Hola Juan, gracias por contactarnos. He revisado tu cuenta y veo que hay un problema con la configuración de tu perfil. Voy a solucionarlo ahora mismo.",senderId:"admin1",senderName:"Admin Principal",senderRole:"admin",senderEmail:"admin@empresa.com",isInternal:!1,createdAt:{seconds:Date.now()/1e3-1800},attachments:[]},{id:"msg3",ticketId:t,content:"Nota interna: El cliente tiene un problema de configuración en su perfil. Necesito revisar la base de datos.",senderId:"admin1",senderName:"Admin Principal",senderRole:"admin",senderEmail:"admin@empresa.com",isInternal:!0,createdAt:{seconds:Date.now()/1e3-900},attachments:[]}]),m(!1);return}if(!t){m(!1);return}const E=qe(ge(te,"artifacts",ee,"public","data","ticketMessages"),rt("ticketId","==",t)),P=_e(E,T=>{const j=T.docs.map(R=>({id:R.id,...R.data()}));j.sort((R,M)=>{var I,b;const q=((I=R.createdAt)==null?void 0:I.seconds)||0,z=((b=M.createdAt)==null?void 0:b.seconds)||0;return q-z}),o(j),m(!1)},T=>{console.error("Error loading messages:",T),s("Error al cargar los mensajes","error"),m(!1)});return()=>P()},[t,e,s]);const x=async E=>{if(E.preventDefault(),!!c.trim()){if(y(!0),e){const P={id:`msg_${Date.now()}`,ticketId:t,content:c,senderId:(r==null?void 0:r.uid)||"demo",senderName:(r==null?void 0:r.displayName)||"Usuario Demo",senderRole:n||"client",senderEmail:(r==null?void 0:r.email)||"demo@ejemplo.com",isInternal:!1,createdAt:{seconds:Date.now()/1e3},attachments:[]};o(T=>[...T,P]),u(""),y(!1),s("Mensaje enviado (modo demo)","success"),window.updateTicketReplyCount&&window.updateTicketReplyCount(t,a.length+1);return}try{const P={ticketId:t,content:c.trim(),senderId:r.uid,senderName:r.displayName||r.email,senderRole:n,senderEmail:r.email,isInternal:!1,createdAt:le.now(),attachments:[]};await or(ge(te,"artifacts",ee,"public","data","ticketMessages"),P);const T=ce(te,"artifacts",ee,"public","data","tickets",t);await Xe(T,{replyCount:a.length+1,lastReplyAt:le.now(),lastReplyBy:r.displayName||r.email,updatedAt:le.now()}),u(""),s("Mensaje enviado","success")}catch(P){console.error("Error sending message:",P),s("Error al enviar el mensaje","error")}finally{y(!1)}}},S=E=>{if(!E)return"--";const P=new Date,T=new Date(E.seconds*1e3),j=P.getTime()-T.getTime(),R=Math.floor(j/(1e3*60*60*24)),M=Math.floor(j/(1e3*60*60)),q=Math.floor(j/(1e3*60));return R>0?`hace ${R} día${R>1?"s":""}`:M>0?`hace ${M} hora${M>1?"s":""}`:q>0?`hace ${q} minuto${q>1?"s":""}`:"hace unos segundos"};return d?i.jsx("div",{className:"flex justify-center items-center h-32",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:a.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(kc,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),i.jsx("p",{children:"No hay mensajes en este ticket"})]}):a.map(E=>i.jsx("div",{className:`flex ${E.senderRole==="client"?"justify-start":"justify-end"}`,children:i.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${E.senderRole==="client"?"bg-gray-100 text-gray-900":E.isInternal?"bg-yellow-100 text-yellow-900 border border-yellow-300":"bg-blue-100 text-blue-900"}`,children:[E.isInternal&&i.jsx("div",{className:"text-xs font-semibold text-yellow-700 mb-1",children:"NOTA INTERNA"}),i.jsx("div",{className:"text-sm whitespace-pre-wrap",children:E.content}),i.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-gray-500",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(io,{}),i.jsx("span",{children:E.senderName})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(en,{}),i.jsx("span",{children:S(E.createdAt)})]})]}),E.attachments&&E.attachments.length>0&&i.jsx("div",{className:"mt-2 pt-2 border-t border-gray-300",children:i.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[i.jsx(Yk,{}),i.jsxs("span",{children:[E.attachments.length," archivo",E.attachments.length!==1?"s":""]})]})})]})},E.id))}),i.jsx("div",{className:"border-t pt-4",children:i.jsxs("form",{onSubmit:x,className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n==="client"?"Responder al ticket":"Responder al cliente"}),i.jsx("textarea",{value:c,onChange:E=>u(E.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:n==="client"?"Escribe tu respuesta aquí...":"Escribe tu respuesta al cliente aquí...",required:!0})]}),n==="admin"||n==="superadmin"?i.jsx("div",{className:"flex items-center gap-4",children:i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Nota interna (solo visible para administradores)"})]})}):null,i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"submit",disabled:g||!c.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:g?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Enviando..."]}):i.jsxs(i.Fragment,{children:[i.jsx(kc,{}),"Enviar Mensaje"]})})})]})})]})}function uP({isDemo:t,userRole:e}){const{addNotification:n}=Ae(),[r,s]=L.useState([]),[a,o]=L.useState([]),[c,u]=L.useState(""),[d,m]=L.useState("Todos"),[g,y]=L.useState("Todos"),[x,S]=L.useState("Todos"),[E,P]=L.useState(!0),[T,j]=L.useState(null),[R,M]=L.useState(!1),[q,z]=L.useState(!1),[I,b]=L.useState({subject:"",department:"Soporte Técnico",priority:"Media",description:"",clientId:"",clientName:"",clientEmail:""}),C=["Todos","Abierto","En Progreso","Respondido","Cerrado","Esperando Cliente"],p=["Todos","Baja","Media","Alta","Crítica"],k=["Todos","Soporte Técnico","Facturación","Ventas","General"];L.useEffect(()=>{if(t){s([{id:"ticket1",ticketNumber:"TKT-2024-001",subject:"Problema con el acceso al panel de cliente",description:"No puedo acceder a mi panel de cliente desde ayer. Me aparece un error 500.",status:"Abierto",priority:"Alta",department:"Soporte Técnico",clientId:"client1",clientName:"Juan Pérez",clientEmail:"juan@ejemplo.com",assignedTo:null,assignedToName:null,createdAt:{seconds:Date.now()/1e3-3600},updatedAt:{seconds:Date.now()/1e3-3600},lastReplyAt:{seconds:Date.now()/1e3-3600},lastReplyBy:"Cliente",replyCount:0,attachments:[]},{id:"ticket2",ticketNumber:"TKT-2024-002",subject:"Consulta sobre facturación",description:"Necesito una copia de mi factura del mes pasado para contabilidad.",status:"Respondido",priority:"Media",department:"Facturación",clientId:"client2",clientName:"María García",clientEmail:"maria@ejemplo.com",assignedTo:"admin1",assignedToName:"Admin Principal",createdAt:{seconds:Date.now()/1e3-7200},updatedAt:{seconds:Date.now()/1e3-1800},lastReplyAt:{seconds:Date.now()/1e3-1800},lastReplyBy:"Admin Principal",replyCount:2,attachments:["factura_enero.pdf"]},{id:"ticket3",ticketNumber:"TKT-2024-003",subject:"Solicitud de nuevo servicio",description:"Me gustaría contratar un plan de hosting más grande para mi sitio web.",status:"En Progreso",priority:"Baja",department:"Ventas",clientId:"client3",clientName:"Carlos López",clientEmail:"carlos@ejemplo.com",assignedTo:"admin2",assignedToName:"Admin Ventas",createdAt:{seconds:Date.now()/1e3-10800},updatedAt:{seconds:Date.now()/1e3-900},lastReplyAt:{seconds:Date.now()/1e3-900},lastReplyBy:"Admin Ventas",replyCount:1,attachments:[]},{id:"ticket4",ticketNumber:"TKT-2024-004",subject:"Error crítico en el servidor",description:"Mi sitio web está caído y no responde. Es urgente.",status:"Abierto",priority:"Crítica",department:"Soporte Técnico",clientId:"client4",clientName:"Ana Martínez",clientEmail:"ana@ejemplo.com",assignedTo:null,assignedToName:null,createdAt:{seconds:Date.now()/1e3-300},updatedAt:{seconds:Date.now()/1e3-300},lastReplyAt:{seconds:Date.now()/1e3-300},lastReplyBy:"Cliente",replyCount:0,attachments:["error_screenshot.png"]}]),o([{id:"client1",fullName:"Juan Pérez",email:"juan@ejemplo.com"},{id:"client2",fullName:"María García",email:"maria@ejemplo.com"},{id:"client3",fullName:"Carlos López",email:"carlos@ejemplo.com"},{id:"client4",fullName:"Ana Martínez",email:"ana@ejemplo.com"}]),P(!1);return}const U=qe(ge(te,"artifacts",ee,"public","data","tickets")),Q=_e(U,Ne=>{const He=Ne.docs.map(je=>({id:je.id,...je.data()}));He.sort((je,Rt)=>{var cn,un;const ln=((cn=je.createdAt)==null?void 0:cn.seconds)||0;return(((un=Rt.createdAt)==null?void 0:un.seconds)||0)-ln}),s(He),P(!1)},Ne=>{console.error("Error loading tickets:",Ne),n("Error al cargar los tickets.","error"),P(!1)}),X=qe(ge(te,"artifacts",ee,"public","data","users"),rt("role","==","client")),ae=_e(X,Ne=>{const He=Ne.docs.map(je=>({id:je.id,...je.data()}));o(He)},Ne=>{console.error("Error loading clients:",Ne)});return()=>{Q(),ae()}},[t,n]);const w=async(U,Q)=>{if(t){n("Función no disponible en modo demo","error");return}try{const X=ce(te,"artifacts",ee,"public","data","tickets",U);await Xe(X,{status:Q,updatedAt:le.now()}),n(`Estado del ticket actualizado a ${Q}`,"success")}catch(X){console.error("Error updating ticket status:",X),n("Error al actualizar el estado del ticket","error")}},N=async(U,Q)=>{if(t){n("Función no disponible en modo demo","error");return}try{const X=ce(te,"artifacts",ee,"public","data","tickets",U);await Xe(X,{assignedTo:Q,assignedToName:Q?"Admin Actual":null,updatedAt:le.now()}),n("Ticket asignado correctamente","success")}catch(X){console.error("Error assigning ticket:",X),n("Error al asignar el ticket","error")}},$=U=>{j(U),M(!0)},D=async U=>{if(t){s(Q=>Q.filter(X=>X.id!==U)),n("Ticket eliminado (modo demo)","success");return}try{await Si(ce(te,"artifacts",ee,"public","data","tickets",U));const Q=qe(ge(te,"artifacts",ee,"public","data","ticketMessages"),rt("ticketId","==",U)),ae=(await Rn(Q)).docs.map(Ne=>Si(Ne.ref));await Promise.all(ae),n("Ticket eliminado exitosamente","success")}catch(Q){console.error("Error deleting ticket:",Q),n("Error al eliminar el ticket","error")}},V=async U=>{if(U.preventDefault(),t){const Q={id:`ticket_${Date.now()}`,ticketNumber:`TKT-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,subject:I.subject,description:I.description,status:"Abierto",priority:I.priority,department:I.department,clientId:I.clientId||"demo",clientName:I.clientName||"Cliente Demo",clientEmail:I.clientEmail||"demo@ejemplo.com",assignedTo:null,assignedToName:null,createdAt:{seconds:Date.now()/1e3},updatedAt:{seconds:Date.now()/1e3},lastReplyAt:{seconds:Date.now()/1e3},lastReplyBy:"Cliente",replyCount:0,attachments:[]};s(X=>[Q,...X]),n("Ticket creado (modo demo)","success"),z(!1),b({subject:"",department:"Soporte Técnico",priority:"Media",description:"",clientId:"",clientName:"",clientEmail:""});return}try{const Q={...I,ticketNumber:`TKT-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,status:"Abierto",assignedTo:null,assignedToName:null,createdAt:le.now(),updatedAt:le.now(),lastReplyAt:le.now(),lastReplyBy:"Cliente",replyCount:0,attachments:[]};await or(ge(te,"artifacts",ee,"public","data","tickets"),Q),n("Ticket creado exitosamente","success"),z(!1),b({subject:"",department:"Soporte Técnico",priority:"Media",description:"",clientId:"",clientName:"",clientEmail:""})}catch(Q){console.error("Error creating ticket:",Q),n("Error al crear el ticket","error")}},O=U=>({Abierto:"bg-red-100 text-red-800","En Progreso":"bg-yellow-100 text-yellow-800",Respondido:"bg-blue-100 text-blue-800",Cerrado:"bg-gray-100 text-gray-800","Esperando Cliente":"bg-orange-100 text-orange-800"})[U]||"bg-gray-100 text-gray-800",v=U=>({Baja:"bg-green-100 text-green-800",Media:"bg-yellow-100 text-yellow-800",Alta:"bg-orange-100 text-orange-800",Crítica:"bg-red-100 text-red-800"})[U]||"bg-gray-100 text-gray-800",A=U=>({"Soporte Técnico":"bg-blue-100 text-blue-800",Facturación:"bg-green-100 text-green-800",Ventas:"bg-purple-100 text-purple-800",General:"bg-gray-100 text-gray-800"})[U]||"bg-gray-100 text-gray-800",F=U=>U?new Date(U.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",K=U=>{switch(U){case"Abierto":return i.jsx(en,{});case"En Progreso":return i.jsx(en,{});case"Respondido":return i.jsx(_u,{});case"Cerrado":return i.jsx(Ci,{});case"Esperando Cliente":return i.jsx(io,{});default:return i.jsx(en,{})}},G=U=>{if(!U)return"--";const Q=new Date,X=new Date(U.seconds*1e3),ae=Q.getTime()-X.getTime(),Ne=Math.floor(ae/(1e3*60*60*24)),He=Math.floor(ae/(1e3*60*60)),je=Math.floor(ae/(1e3*60));return Ne>0?`hace ${Ne} día${Ne>1?"s":""}`:He>0?`hace ${He} hora${He>1?"s":""}`:je>0?`hace ${je} minuto${je>1?"s":""}`:"hace unos segundos"},Z=r.filter(U=>{const Q=c===""||U.ticketNumber.toLowerCase().includes(c.toLowerCase())||U.subject.toLowerCase().includes(c.toLowerCase())||U.clientName.toLowerCase().includes(c.toLowerCase())||U.clientEmail.toLowerCase().includes(c.toLowerCase())||U.description.toLowerCase().includes(c.toLowerCase()),X=d==="Todos"||U.status===d,ae=g==="Todos"||U.priority===g,Ne=x==="Todos"||U.department===x;return Q&&X&&ae&&Ne});return E?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):i.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[i.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[i.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(fs,{}),"Sistema de Tickets"]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"text-sm text-gray-500",children:[Z.length," ticket",Z.length!==1?"s":""," encontrado",Z.length!==1?"s":""]}),i.jsxs("button",{onClick:()=>z(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[i.jsx(Ao,{}),"Nuevo Ticket"]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:i.jsx(en,{})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Abiertos"}),i.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(U=>U.status==="Abierto").length})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:i.jsx(en,{})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-gray-500",children:"En Progreso"}),i.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(U=>U.status==="En Progreso").length})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:i.jsx(io,{})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Esperando Cliente"}),i.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(U=>U.status==="Esperando Cliente").length})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:i.jsx(Ci,{})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Críticos"}),i.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(U=>U.priority==="Crítica").length})]})]})})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",placeholder:"Buscar por número, asunto, cliente...",value:c,onChange:U=>u(U.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full"}),i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Vi,{})})]}),i.jsxs("div",{className:"relative",children:[i.jsx("select",{value:d,onChange:U=>m(U.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:C.map(U=>i.jsx("option",{value:U,children:U},U))}),i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(di,{})})]}),i.jsxs("div",{className:"relative",children:[i.jsx("select",{value:g,onChange:U=>y(U.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:p.map(U=>i.jsx("option",{value:U,children:U},U))}),i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(di,{})})]}),i.jsxs("div",{className:"relative",children:[i.jsx("select",{value:x,onChange:U=>S(U.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:k.map(U=>i.jsx("option",{value:U,children:U},U))}),i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(di,{})})]})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsx("tr",{children:["Ticket","Cliente","Asunto","Estado","Prioridad","Departamento","Asignado","Última Actividad","Respuestas","Acciones"].map(U=>i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:U},U))})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Z.map(U=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:U.ticketNumber}),i.jsx("div",{className:"text-xs text-gray-500",children:F(U.createdAt)})]}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:U.clientName}),i.jsx("div",{className:"text-sm text-gray-500",children:U.clientEmail})]}),i.jsxs("td",{className:"px-6 py-4",children:[i.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",title:U.subject,children:U.subject}),i.jsx("div",{className:"text-xs text-gray-500 max-w-xs truncate",title:U.description,children:U.description})]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${O(U.status)}`,children:U.status}),i.jsx("div",{className:"ml-2 text-gray-400",children:K(U.status)})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${v(U.priority)}`,children:U.priority})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${A(U.department)}`,children:U.department})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:U.assignedToName||"Sin asignar"}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[i.jsx("div",{children:G(U.lastReplyAt)}),i.jsxs("div",{className:"text-xs text-gray-400",children:["por ",U.lastReplyBy]})]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(kc,{}),i.jsx("span",{className:"ml-1",children:U.replyCount})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:i.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[i.jsx("button",{onClick:()=>$(U),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md",title:"Ver ticket completo",children:i.jsx(Gr,{})}),e==="superadmin"&&i.jsxs(ko,{children:[i.jsx("select",{value:U.status,onChange:Q=>w(U.id,Q.target.value),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 border-none bg-transparent",children:C.filter(Q=>Q!=="Todos").map(Q=>i.jsx("option",{value:Q,children:Q},Q))}),i.jsx("button",{onClick:()=>N(U.id,U.assignedTo?null:"admin"),className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:U.assignedTo?"Desasignar":"Asignar"}),i.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:"Responder"}),i.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-orange-700 hover:bg-orange-50",children:"Cerrar Ticket"}),i.jsx("button",{onClick:()=>{window.confirm("¿Estás seguro de que quieres eliminar este ticket? Esta acción no se puede deshacer.")&&D(U.id)},className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"Eliminar Ticket"})]})]})})]},U.id))})]})}),Z.length===0&&i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[i.jsx(fs,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron tickets"}),i.jsx("p",{className:"text-gray-500",children:"No hay tickets que coincidan con los filtros seleccionados."})]}),R&&T&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:["Ticket ",T.ticketNumber]}),i.jsx("button",{onClick:()=>M(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cliente"}),i.jsx("div",{className:"text-sm text-gray-900",children:T.clientName}),i.jsx("div",{className:"text-sm text-gray-500",children:T.clientEmail})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Asignado a"}),i.jsx("div",{className:"text-sm text-gray-900",children:T.assignedToName||"Sin asignar"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${O(T.status)}`,children:T.status})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prioridad"}),i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${v(T.priority)}`,children:T.priority})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Departamento"}),i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${A(T.department)}`,children:T.department})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Creado"}),i.jsx("div",{className:"text-sm text-gray-900",children:F(T.createdAt)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto"}),i.jsx("div",{className:"text-sm text-gray-900 p-3 bg-gray-50 rounded-md",children:T.subject})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción"}),i.jsx("div",{className:"text-sm text-gray-900 p-4 bg-gray-50 rounded-md whitespace-pre-wrap",children:T.description})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Historial de Mensajes"}),i.jsx("div",{className:"border border-gray-200 rounded-md p-4",children:i.jsx(b_,{ticketId:T.id,isDemo:t,userRole:e,currentUser:{uid:"admin",displayName:"Admin",email:"admin@empresa.com"}})})]}),i.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[i.jsx("button",{onClick:()=>M(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cerrar"}),e==="superadmin"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Responder"}),i.jsx("button",{onClick:()=>{window.confirm("¿Estás seguro de que quieres eliminar este ticket? Esta acción no se puede deshacer.")&&(D(T.id),M(!1))},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Eliminar Ticket"})]})]})]})]})}),q&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Crear Nuevo Ticket"}),i.jsx("button",{onClick:()=>z(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),i.jsxs("form",{onSubmit:V,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cliente"}),i.jsxs("select",{value:I.clientId,onChange:U=>{const Q=a.find(X=>X.id===U.target.value);b(X=>({...X,clientId:U.target.value,clientName:(Q==null?void 0:Q.fullName)||"",clientEmail:(Q==null?void 0:Q.email)||""}))},className:"w-full p-2 border rounded-md",required:!0,children:[i.jsx("option",{value:"",children:"Seleccionar cliente"}),a.map(U=>i.jsxs("option",{value:U.id,children:[U.fullName," (",U.email,")"]},U.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento"}),i.jsx("select",{value:I.department,onChange:U=>b(Q=>({...Q,department:U.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:k.filter(U=>U!=="Todos").map(U=>i.jsx("option",{value:U,children:U},U))})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridad"}),i.jsx("select",{value:I.priority,onChange:U=>b(Q=>({...Q,priority:U.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:p.filter(U=>U!=="Todos").map(U=>i.jsx("option",{value:U,children:U},U))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email del Cliente"}),i.jsx("input",{type:"email",value:I.clientEmail,onChange:U=>b(Q=>({...Q,clientEmail:U.target.value})),className:"w-full p-2 border rounded-md",placeholder:"email@ejemplo.com",required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto *"}),i.jsx("input",{type:"text",value:I.subject,onChange:U=>b(Q=>({...Q,subject:U.target.value})),className:"w-full p-2 border rounded-md",placeholder:"Describe brevemente el problema o consulta",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción *"}),i.jsx("textarea",{value:I.description,onChange:U=>b(Q=>({...Q,description:U.target.value})),className:"w-full p-2 border rounded-md",rows:6,placeholder:"Describe el problema o consulta en detalle...",required:!0})]}),i.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:()=>z(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Crear Ticket"})]})]})]})})]})}function dP({isDemo:t,setIsDemoMode:e,onLogout:n}){const{addNotification:r}=Ae(),[s,a]=L.useState({}),o="company_info";L.useEffect(()=>{if(t){a({companyName:"Mi Empresa (Demo)",identification:"123.456.789-0",address:"Calle Falsa 123, Ciudad Demo",phone:"+57 300 123 4567",email:"contacto@empresa-demo.com",website:"www.empresa-demo.com",logoUrl:"https://placehold.co/200x80/1d4ed8/ffffff?text=Mi+Logo"});return}const m=ce(te,"artifacts",ee,"public","data","settings",o);return _e(m,y=>{y.exists()&&a(y.data())})},[t]);const c=m=>{const{name:g,value:y}=m.target;a(x=>({...x,[g]:y}))},u=()=>{const m=!t;e(m),m&&r("Modo demo activado. Recuerda guardar la configuración para aplicar los cambios.","info")},d=async()=>{if(t){r("Función no disponible en modo demo.","error");return}try{const m=ce(te,"artifacts",ee,"public","data","settings",o),g={...s,isDemoMode:t,allowDemoMode:!0};await Dn(m,g,{merge:!0}),r("Configuración de la empresa guardada.","success"),t&&n&&(r("Modo demo activado. Cerrando sesión para probar los botones de demo...","info"),setTimeout(()=>{n()},2e3))}catch{r("Error al guardar la configuración.","error")}};return i.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[i.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Configuración"}),i.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md max-w-4xl mx-auto space-y-8",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Información de Facturación y Contacto"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsx("input",{name:"companyName",value:s.companyName||"",onChange:c,placeholder:"Nombre de la Empresa",className:"w-full p-2 border rounded-md"}),i.jsx("input",{name:"identification",value:s.identification||"",onChange:c,placeholder:"NIT / Identificación Fiscal",className:"w-full p-2 border rounded-md"}),i.jsx("input",{name:"address",value:s.address||"",onChange:c,placeholder:"Dirección",className:"w-full p-2 border rounded-md"}),i.jsx("input",{name:"phone",value:s.phone||"",onChange:c,placeholder:"Teléfono",className:"w-full p-2 border rounded-md"}),i.jsx("input",{name:"email",type:"email",value:s.email||"",onChange:c,placeholder:"Email de Contacto",className:"w-full p-2 border rounded-md"}),i.jsx("input",{name:"website",value:s.website||"",onChange:c,placeholder:"Sitio Web",className:"w-full p-2 border rounded-md"})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold mt-8 mb-4",children:"Branding"}),i.jsx("input",{name:"logoUrl",value:s.logoUrl||"",onChange:c,placeholder:"URL del Logo (enlace a la imagen)",className:"w-full p-2 border rounded-md"}),s.logoUrl&&i.jsx("img",{src:s.logoUrl,alt:"Vista previa del logo",className:"mt-4 max-h-20 bg-gray-100 p-2 rounded"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Modo de Operación"}),i.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-800",children:"Activar Modo de Prueba"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Usa datos de ejemplo sin afectar la información real. En modo prueba aparecerán botones separados para admin y cliente."})]}),i.jsx("label",{htmlFor:"demoToggle",className:"flex items-center cursor-pointer",children:i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"checkbox",id:"demoToggle",className:"sr-only",checked:t,onChange:u}),i.jsx("div",{className:"block bg-gray-600 w-14 h-8 rounded-full"}),i.jsx("div",{className:"dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition"})]})})]}),t&&i.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Modo de Prueba Activado"}),i.jsxs("p",{className:"text-sm text-blue-700 mb-2",children:["En el login aparecerán dos botones:",i.jsx("br",{}),"• ",i.jsx("strong",{children:"Administrador:"})," Acceso completo al sistema",i.jsx("br",{}),"• ",i.jsx("strong",{children:"Cliente:"})," Vista limitada de servicios y tickets"]}),i.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded",children:i.jsx("p",{className:"text-sm text-yellow-800 font-medium",children:"⚠️ Recuerda guardar la configuración para aplicar los cambios. Se cerrará la sesión automáticamente para probar los botones de demo."})})]}),i.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[i.jsx("h4",{className:"font-semibold text-green-800 mb-2",children:"🔧 Herramientas de Desarrollo"}),i.jsx("p",{className:"text-sm text-green-700 mb-2",children:"Al activar el modo de prueba, también se habilitarán:"}),i.jsxs("ul",{className:"text-sm text-green-700 list-disc list-inside space-y-1",children:[i.jsx("li",{children:"Botón de cambio entre modo Demo/Live en el login"}),i.jsx("li",{children:"Botón de diagnóstico de Firebase para debugging"}),i.jsx("li",{children:"Acceso a herramientas de desarrollo"})]})]})]}),i.jsx("button",{onClick:d,className:"mt-4 px-5 py-2 bg-blue-600 text-white font-semibold rounded-md shadow-sm hover:bg-blue-700",children:"Guardar Configuración"})]})]})}function hP({user:t,isDemo:e,setIsDemoMode:n,userRole:r,companySettings:s,onLogout:a}){const[o,c]=L.useState("services"),u=()=>{switch(o){case"users":return i.jsx(sP,{isDemo:e,userRole:r});case"templates":return i.jsx(iP,{isDemo:e});case"messages":return i.jsx(cP,{isDemo:e,userRole:r});case"tickets":return i.jsx(uP,{isDemo:e,userRole:r});case"payments":return i.jsx(lP,{isDemo:e,userRole:r});case"payment-config":return i.jsx(v_,{isDemo:e});case"settings":return i.jsx(dP,{isDemo:e,setIsDemoMode:n,onLogout:a});case"services":default:return i.jsx(eP,{isDemo:e,userRole:r})}};return i.jsxs("main",{className:"container mx-auto",children:[i.jsx("div",{className:"border-b border-gray-200",children:i.jsxs("nav",{className:"-mb-px flex space-x-8 px-4 sm:px-6 lg:px-8","aria-label":"Tabs",children:[i.jsxs("button",{onClick:()=>c("services"),className:`${o==="services"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[i.jsx(Ac,{})," Servicios"]}),r==="superadmin"&&i.jsxs("button",{onClick:()=>c("users"),className:`${o==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[i.jsx(Hk,{})," Usuarios"]}),i.jsxs("button",{onClick:()=>c("templates"),className:`${o==="templates"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[i.jsx(y_,{})," Plantillas"]}),i.jsxs("button",{onClick:()=>c("messages"),className:`${o==="messages"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[i.jsx(Ul,{})," Mensajes"]}),i.jsxs("button",{onClick:()=>c("payments"),className:`${o==="payments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[i.jsx($t,{})," Pagos"]}),i.jsxs("button",{onClick:()=>c("tickets"),className:`${o==="tickets"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[i.jsx(fs,{})," Tickets"]}),r==="superadmin"&&i.jsxs("button",{onClick:()=>c("settings"),className:`${o==="settings"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[i.jsx(Gk,{})," Empresa"]})]})}),u()]})}function mP({isOpen:t,onClose:e,onConfirm:n,service:r,paymentType:s,warningMessage:a}){if(!t)return null;const o=()=>s==="One-Time"?i.jsx($t,{className:"h-8 w-8 text-blue-600"}):i.jsx(Ur,{className:"h-8 w-8 text-green-600"}),c=()=>s==="One-Time"?"Solicitar Pago Único":"Solicitar Pago de Renovación",u=()=>s==="One-Time"?"Esta es una solicitud de pago único que no se renovará automáticamente":"Esta solicitud renovará tu servicio por el período seleccionado",d=()=>s==="One-Time"?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"bg-green-600 hover:bg-green-700 focus:ring-green-500";return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 transform transition-all",children:[i.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"flex-shrink-0",children:o()}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:c()}),i.jsx("p",{className:"text-sm text-gray-500",children:u()})]})]})}),i.jsxs("div",{className:"px-6 py-4",children:[i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:r.serviceType}),i.jsxs("span",{className:"text-sm font-semibold text-gray-600",children:[r.currency," ",r.amount.toFixed(2)]})]}),i.jsx("p",{className:"text-sm text-gray-600 mb-2",children:r.description}),i.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[i.jsxs("span",{children:["Número: ",r.serviceNumber]}),s!=="One-Time"&&i.jsxs("span",{children:["Ciclo: ",r.billingCycle]})]})]}),i.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4",children:i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx(Xk,{className:"h-5 w-5 text-amber-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{children:[i.jsx("h5",{className:"text-sm font-medium text-amber-800 mb-1",children:"Información Importante"}),i.jsx("p",{className:"text-sm text-amber-700",children:a})]})]})}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo de Pago:"}),i.jsx("span",{className:"font-medium text-gray-900",children:s==="One-Time"?"Pago Único":"Renovación"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto:"}),i.jsxs("span",{className:"font-medium text-gray-900",children:[r.currency," ",r.amount.toFixed(2)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Método de Pago:"}),i.jsx("span",{className:"font-medium text-gray-900",children:"Transferencia Bancaria"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Estado Inicial:"}),i.jsx("span",{className:"font-medium text-amber-600",children:"Pendiente"})]})]})]}),i.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-2xl flex justify-end space-x-3",children:[i.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors",children:"Cancelar"}),i.jsx("button",{onClick:n,className:`px-6 py-2 text-sm font-medium text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors ${d()}`,children:s==="One-Time"?"Solicitar Pago Único":"Solicitar Renovación"})]})]})})}function fP({user:t,isDemo:e,userProfile:n}){const{addNotification:r}=Ae(),[s,a]=L.useState([]),[o,c]=L.useState(!0),[u,d]=L.useState(new Set),[m,g]=L.useState(new Set),[y,x]=L.useState({}),[S,E]=L.useState(null),[P,T]=L.useState({isOpen:!1,service:null}),j=w=>{if(!w.dueDate||!w.billingCycle||w.billingCycle==="One-Time")return w.expirationDate?new Date(w.expirationDate.seconds*1e3):null;const N=new Date(w.dueDate.seconds*1e3);let $=new Date(N);switch(w.billingCycle){case"Monthly":$.setMonth($.getMonth()+1);break;case"Semiannually":$.setMonth($.getMonth()+6);break;case"Annually":$.setFullYear($.getFullYear()+1);break;case"Biennially":$.setFullYear($.getFullYear()+2);break;case"Triennially":$.setFullYear($.getFullYear()+3);break;default:return null}return $},R=w=>{const N=j(w);return N?N.toLocaleDateString():"N/A"},M=w=>({"One-Time":"Pago único",Monthly:"Mensual",Semiannually:"Semestral",Annually:"Anual",Biennially:"Bianual",Triennially:"Trienal",Custom:"Personalizado"})[w]||w,q=w=>{if(u.has(w.id)){r("Ya se está solicitando un pago para este servicio","warning");return}if(m.has(w.id)){r("Ya existe una solicitud de pago pendiente para este servicio","warning");return}T({isOpen:!0,service:w})},z=async w=>{if(e){r("Solicitud de pago creada exitosamente (modo demo)","success"),T({isOpen:!1,service:null});return}d(N=>new Set(N).add(w.id));try{let N;if(w.billingCycle==="One-Time")N=w.dueDate?new Date(w.dueDate.seconds*1e3):new Date,N.setDate(N.getDate()+30);else{const G=j(w);G?N=G:N=new Date(Date.now()+30*24*60*60*1e3)}const $=G=>{if(!G)return null;if(G.gateways)return G.gateways;const{bold:Z,paypal:U,payu:Q,bankTransfer:X}=G,ae={};return Z&&(ae.bold={name:"Bold",...Z}),U&&(ae.paypal={name:"PayPal",...U}),Q&&(ae.payu={name:"PayU",...Q}),X&&(ae.bankTransfer={name:"Transferencia Bancaria",...X}),ae},[D,V]=L.useState(null);L.useEffect(()=>{if(e){V({gateways:{bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}}});return}const G=ce(te,"artifacts",ee,"public","data","settings","paymentConfig"),Z=_e(G,U=>{U.exists()&&V(U.data())});return()=>Z()},[e]);let O=D&&$(D);const v=O?Object.values(O).filter(G=>G.enabled):[];let A="Transferencia Bancaria",F="Transferencia Bancaria";v.length===1?(A=v[0].name,F=v[0].name):v.length>1&&(A="Pendiente de Selección",F=w.billingCycle==="One-Time"?"Pago Único":"Renovación");const K={serviceId:w.id,serviceNumber:w.serviceNumber,serviceType:w.serviceType,description:w.description,amount:w.amount,currency:w.currency,status:"Pendiente",gateway:A,userId:t.uid,clientName:(n==null?void 0:n.fullName)||"Cliente",clientEmail:t.email,dueDate:le.fromDate(N),createdAt:le.now(),paymentMethod:F,notes:`Solicitud de pago automática para servicio ${w.serviceNumber} - Ciclo: ${M(w.billingCycle)}`,billingCycle:w.billingCycle,isAutoGenerated:!0,originalServiceDueDate:w.dueDate?w.dueDate.toDate?w.dueDate:le.fromDate(new Date(w.dueDate)):null,paymentType:w.billingCycle==="One-Time"?"Pago Único":"Renovación"};await or(ge(te,"artifacts",ee,"public","data","payments"),K),r("Solicitud de pago creada exitosamente. Revisa la sección de pagos.","success"),T({isOpen:!1,service:null})}catch(N){console.error("Error generating payment:",N),r("Error al crear la solicitud de pago. Intenta nuevamente.","error")}finally{d(N=>{const $=new Set(N);return $.delete(w.id),$})}},I=w=>{localStorage.setItem("selectedServiceForRenewal",JSON.stringify({id:w.id,serviceNumber:w.serviceNumber,serviceType:w.serviceType,description:w.description,amount:w.amount,currency:w.currency,billingCycle:w.billingCycle,dueDate:w.dueDate})),window.location.hash==="#renewals"?(window.location.hash="",setTimeout(()=>{window.location.hash="renewals"},50)):window.location.hash="renewals",r("Redirigiendo a renovaciones para este servicio","success")};L.useEffect(()=>{if(e){g(new Set(["demo1","demo2"]));return}if(!(t!=null&&t.uid))return;const w=qe(ge(te,"artifacts",ee,"public","data","payments"),rt("userId","==",t.uid),rt("status","==","Pendiente")),N=_e(w,$=>{const D=new Set,V={};$.docs.forEach(O=>{const v=O.data();v.serviceId&&(D.add(v.serviceId),V[v.serviceId]={id:O.id,...v})}),g(D),x(V)});return()=>N()},[t==null?void 0:t.uid,e]),L.useEffect(()=>{if(e){E({renewalSettings:{reminderDays:10,gracePeriodDays:7}});return}const w=ce(te,"artifacts",ee,"public","data","settings","renewalConfig"),N=_e(w,$=>{$.exists()&&E($.data())});return()=>N()},[e]);const b=w=>{if(!w||w.billingCycle==="One-Time")return null;const N=j(w);if(!N)return null;const $=new Date;return Math.ceil((N.getTime()-$.getTime())/(1e3*60*60*24))};L.useEffect(()=>{if(e||!(S!=null&&S.renewalSettings)||!(t!=null&&t.uid))return;const w=Number(S.renewalSettings.reminderDays??0),N=Number(S.renewalSettings.gracePeriodDays??0);(async()=>{for(const D of s){if(!D||D.billingCycle==="One-Time")continue;const V=b(D);if(V!=null){if(V<=w&&V>=-N&&!m.has(D.id))try{await z(D)}catch(O){console.error("Auto-generate payment failed:",O)}if(V<-N){const O=y[D.id];if(O!=null&&O.id)try{await Xe(ce(te,"artifacts",ee,"public","data","payments",O.id),{status:"Cancelado",updatedAt:new Date,cancelReason:"Periodo de gracia agotado"}),r(`Solicitud de pago cancelada por período de gracia (${D.serviceNumber})`,"warning")}catch(v){console.error("Auto-cancel payment failed:",v)}}}}})()},[s,S,m,y,t==null?void 0:t.uid,e]),L.useEffect(()=>{if(e){a([{id:"demo1",serviceNumber:"SRV-241017-123456",serviceType:"Hosting",description:"Plan Básico - 1GB",amount:10.99,currency:"USD",status:"Activo",dueDate:{seconds:Date.now()/1e3+30*24*60*60},billingCycle:"Monthly",clientNotes:"Servicio de hosting básico"},{id:"demo2",serviceNumber:"SRV-241017-789012",serviceType:"Dominio",description:"midominio.com",amount:15,currency:"USD",status:"Pendiente Pago",dueDate:{seconds:Date.now()/1e3+10*24*60*60},billingCycle:"Annually",clientNotes:"Renovación de dominio"}]),c(!1);return}if(!(t!=null&&t.uid)){c(!1);return}const w=qe(ge(te,"artifacts",ee,"public","data","services"),rt("assignedUserId","==",t.uid)),N=_e(w,$=>{const D=$.docs.map(V=>({id:V.id,...V.data()}));D.sort((V,O)=>{var F,K;const v=((F=V.createdAt)==null?void 0:F.seconds)||0;return(((K=O.createdAt)==null?void 0:K.seconds)||0)-v}),a(D),c(!1)},$=>{console.error("Error loading services:",$),r("Error al cargar los servicios","error"),c(!1)});return()=>N()},[t==null?void 0:t.uid,e,r]);const C=w=>({Activo:"bg-green-100 text-green-800","Periodo de Gracia Vencido":"bg-yellow-100 text-yellow-800","Pendiente Pago":"bg-red-100 text-red-800",Pago:"bg-blue-100 text-blue-800",Cancelado:"bg-gray-100 text-gray-800"})[w]||"bg-gray-100 text-gray-800",p=w=>w?new Date(w.seconds*1e3).toLocaleDateString("es-ES"):"--",k=(w,N)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:N||"USD"}).format(w);return o?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):i.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(Ac,{}),"Mis Servicios Contratados"]}),i.jsxs("div",{className:"text-sm text-gray-500",children:[s.length," servicio",s.length!==1?"s":""," encontrado",s.length!==1?"s":""]})]}),s.length===0?i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[i.jsx(Ac,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes servicios asignados"}),i.jsx("p",{className:"text-gray-500",children:"Contacta al administrador para que te asigne servicios."})]}):i.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:i.jsxs("table",{className:"w-full text-left",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsx("tr",{children:["Número","Servicio","Descripción","Monto","Estado","Ciclo","Fecha de Inicio","Fecha de Vencimiento","Notas","Acciones"].map(w=>i.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:w},w))})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:s.map(w=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:w.serviceNumber||"N/A"})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"font-medium text-gray-900",children:w.serviceType})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"text-gray-900",children:w.description})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"font-medium text-gray-900",children:k(w.amount,w.currency)})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${C(w.status)}`,children:w.status})}),i.jsxs("td",{className:"px-6 py-4",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:M(w.billingCycle)}),w.billingCycle==="Custom"&&w.customBillingCycle&&i.jsxs("div",{className:"text-xs text-gray-500",children:["(",w.customBillingCycle,")"]})]}),i.jsxs("td",{className:"px-6 py-4",children:[i.jsx("div",{className:"text-sm text-gray-900",children:p(w.dueDate)}),i.jsx("div",{className:"text-xs text-gray-500",children:"Inicio"})]}),i.jsxs("td",{className:"px-6 py-4",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:R(w)}),i.jsx("div",{className:"text-xs text-gray-500",children:"Vencimiento"})]}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"text-gray-600 text-sm max-w-xs truncate",children:w.clientNotes||"--"})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center space-x-2",children:m.has(w.id)?i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-xs text-orange-600 font-medium mb-1",children:"Por pagar"}),i.jsxs("button",{onClick:()=>window.location.href="#payments",className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700",title:"Ir a Pago",children:[i.jsx(Gr,{className:"h-4 w-4 mr-1"}),"Ir a Pago"]})]}):i.jsxs("div",{className:"flex flex-col space-y-2",children:[i.jsxs("button",{onClick:()=>{const N=b(w);if(w.billingCycle!=="One-Time"&&(N==null||S!=null&&S.renewalSettings&&N>(S.renewalSettings.reminderDays??0))){I(w);return}q(w)},disabled:u.has(w.id),className:`inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${u.has(w.id)?"text-gray-400 bg-gray-200 cursor-not-allowed":"text-white bg-blue-600 hover:bg-blue-700"}`,title:u.has(w.id)?"Creando solicitud...":w.billingCycle==="One-Time"?"Solicitar de Nuevo":"Solicitar de Nuevo (irá a Renovaciones fuera de ventana)",children:[i.jsx($t,{className:"h-4 w-4 mr-1"}),u.has(w.id)?"Creando...":m.has(w.id)?"Ir a Pago":"Solicitar de Nuevo"]}),w.billingCycle!=="One-Time"&&i.jsxs("button",{onClick:()=>I(w),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",title:"Aumentar ciclo de este servicio",children:[i.jsx(Ur,{className:"h-4 w-4 mr-1"}),"Aumentar Ciclo"]})]})})})]},w.id))})]})}),P.isOpen&&P.service&&i.jsx(mP,{isOpen:P.isOpen,onClose:()=>T({isOpen:!1,service:null}),onConfirm:()=>z(P.service),service:P.service,paymentType:P.service.billingCycle,warningMessage:P.service.billingCycle==="One-Time"?`Se creará una solicitud de pago único para el servicio "${P.service.serviceType}". La solicitud vencerá en 30 días desde la fecha actual.`:`Se creará una solicitud de pago de renovación para el servicio "${P.service.serviceType}" con ciclo ${M(P.service.billingCycle)}. La solicitud vencerá en la fecha de vencimiento del servicio.`})]})}function pP({bankAccounts:t,serviceNumber:e,amount:n,currency:r,onUpload:s}){const a=(o,c)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:c||"USD"}).format(o);return!t||t.length===0?i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsx("p",{className:"text-yellow-800",children:"No hay cuentas bancarias configuradas. Contacta al administrador."})}):i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx($t,{}),i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Instrucciones para Transferencia Bancaria"})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Información del Pago"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Número de Servicio:"}),i.jsx("span",{className:"ml-2 font-mono text-blue-600",children:e})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Monto a Pagar:"}),i.jsx("span",{className:"ml-2 font-semibold text-green-600",children:a(n,r)})]})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Cuentas Disponibles para Transferencia"}),i.jsx("div",{className:"space-y-4",children:t.map((o,c)=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h5",{className:"font-medium text-gray-700",children:["Opción ",c+1]}),i.jsx("span",{className:"text-sm text-gray-500",children:o.accountType})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-600",children:"Banco:"}),i.jsx("span",{className:"ml-2 text-gray-800",children:o.bankName})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-600",children:"Número de Cuenta:"}),i.jsx("span",{className:"ml-2 font-mono text-blue-600",children:o.accountNumber})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("span",{className:"font-medium text-gray-600",children:"Titular:"}),i.jsx("span",{className:"ml-2 text-gray-800",children:o.accountHolder})]})]})]},o.id))})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Instrucciones Paso a Paso"}),i.jsxs("ol",{className:"space-y-2 text-sm text-gray-700",children:[i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"1"}),i.jsx("span",{children:"Realiza una transferencia bancaria a cualquiera de las cuentas mostradas arriba"})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"2"}),i.jsxs("span",{children:["Usa el ",i.jsx("strong",{children:"Número de Servicio"})," como referencia en la transferencia"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"3"}),i.jsxs("span",{children:["Transfiere el monto exacto: ",i.jsx("strong",{children:a(n,r)})]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"4"}),i.jsx("span",{children:"Guarda el comprobante de transferencia"})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"5"}),i.jsx("span",{children:"Envía el comprobante por email o sube una foto en el sistema"})]})]})]}),i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"⚠️ Información Importante"}),i.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[i.jsx("li",{children:"• El pago puede tardar hasta 24 horas en ser procesado"}),i.jsx("li",{children:"• Asegúrate de incluir el número de servicio como referencia"}),i.jsx("li",{children:"• El monto debe ser exacto para evitar retrasos"}),i.jsx("li",{children:"• Contacta al administrador si tienes alguna duda"})]})]}),i.jsx("div",{className:"text-center",children:i.jsxs("label",{className:"inline-block px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium cursor-pointer",children:["Subir Comprobante de Transferencia",i.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:o=>{var c;return s&&((c=o.target.files)==null?void 0:c[0])&&s(o.target.files[0])}})]})})]})]})}function gP({user:t,isDemo:e,userProfile:n}){const{addNotification:r}=Ae(),[s,a]=L.useState([]),[o,c]=L.useState(""),[u,d]=L.useState("Todos"),[m,g]=L.useState(!0),[y,x]=L.useState([]),[S,E]=L.useState(!1),[P,T]=L.useState(null),[j,R]=L.useState(null),[M,q]=L.useState({}),z=()=>{if(!j)return null;if(j.gateways)return j.gateways;const{bold:v,paypal:A,payu:F,bankTransfer:K}=j,G={};return v&&(G.bold={name:"Bold",...v}),A&&(G.paypal={name:"PayPal",...A}),F&&(G.payu={name:"PayU",...F}),K&&(G.bankTransfer={name:"Transferencia Bancaria",...K}),G},I=["Todos","Pendiente","Procesando","Completado","Fallido","Cancelado","Reembolsado"];L.useEffect(()=>{if(e){R({gateways:{bold:{enabled:!0,name:"Bold",autoApprove:!1},paypal:{enabled:!0,name:"PayPal",autoApprove:!1},payu:{enabled:!0,name:"PayU",autoApprove:!1},bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}},bankAccounts:[{id:"1",bank:"Banco Nacional",accountNumber:"1234567890",accountHolder:"Mi Empresa"},{id:"2",bank:"Banco Popular",accountNumber:"0987654321",accountHolder:"Mi Empresa"}]});return}const v=ce(te,"artifacts",ee,"public","data","settings","paymentConfig"),A=_e(v,F=>{F.exists()?(R(F.data()),console.log("Payment config loaded:",F.data())):(console.log("No payment config found, using defaults"),R({gateways:{bold:{enabled:!0,name:"Bold",autoApprove:!1},paypal:{enabled:!0,name:"PayPal",autoApprove:!1},payu:{enabled:!0,name:"PayU",autoApprove:!1},bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}},bankAccounts:[]}))},F=>{console.error("Error loading payment config:",F)});return()=>A()},[e]),L.useEffect(()=>{if(e){a([{id:"demo1",serviceNumber:"SRV-241017-123456",serviceType:"Hosting",amount:10.99,currency:"USD",status:"Completado",gateway:"Bold",transactionId:"bold_txn_123456",createdAt:{seconds:Date.now()/1e3-86400},completedAt:{seconds:Date.now()/1e3-3600}},{id:"demo2",serviceNumber:"SRV-241017-789012",serviceType:"Dominio",amount:25,currency:"USD",status:"Pendiente",gateway:"PayPal",transactionId:"paypal_txn_789012",createdAt:{seconds:Date.now()/1e3-7200}},{id:"demo3",serviceNumber:"SRV-241017-345678",serviceType:"Hosting Premium",amount:50,currency:"USD",status:"Completado",gateway:"Transferencia Bancaria",transactionId:"TRF-123456789",createdAt:{seconds:Date.now()/1e3-10800},completedAt:{seconds:Date.now()/1e3-9e3}}]),x([{id:"1",bankName:"Banco Nacional",accountNumber:"1234567890",accountHolder:"Empresa Demo",accountType:"Ahorros"},{id:"2",bankName:"Banco Popular",accountNumber:"0987654321",accountHolder:"Empresa Demo",accountType:"Corriente"}]),g(!1);return}if(!(t!=null&&t.uid)){g(!1);return}const v=qe(ge(te,"artifacts",ee,"public","data","payments"),rt("userId","==",t.uid)),A=_e(v,F=>{const K=F.docs.map(G=>({id:G.id,...G.data()}));console.log("Payments loaded:",K.length,K),K.sort((G,Z)=>{var X,ae;const U=((X=G.createdAt)==null?void 0:X.seconds)||0;return(((ae=Z.createdAt)==null?void 0:ae.seconds)||0)-U}),a(K),g(!1)},F=>{console.error("Error loading payments:",F),r("Error al cargar los pagos","error"),g(!1)});return()=>A()},[t==null?void 0:t.uid,e,r]),L.useEffect(()=>{if(e)return;const v=ce(te,"artifacts",ee,"public","data","settings","paymentConfig"),A=_e(v,F=>{var K;if(F.exists()){const G=F.data();(K=G.bankTransfer)!=null&&K.accounts&&x(G.bankTransfer.accounts)}});return()=>A()},[e]);const b=s.filter(v=>{const A=o===""||v.serviceNumber&&v.serviceNumber.toLowerCase().includes(o.toLowerCase())||v.serviceType&&v.serviceType.toLowerCase().includes(o.toLowerCase())||v.serviceName&&v.serviceName.toLowerCase().includes(o.toLowerCase())||v.transactionId&&v.transactionId.toLowerCase().includes(o.toLowerCase()),F=u==="Todos"||v.status===u,K=A&&F;return console.log("Payment filter:",{payment:v.id,serviceType:v.serviceType,serviceName:v.serviceName,status:v.status,searchTerm:o,statusFilter:u,matchesSearch:A,matchesStatus:F,result:K}),K}),C=v=>({Pendiente:"bg-yellow-100 text-yellow-800",Procesando:"bg-blue-100 text-blue-800",Completado:"bg-green-100 text-green-800",Fallido:"bg-red-100 text-red-800",Cancelado:"bg-gray-100 text-gray-800",Reembolsado:"bg-purple-100 text-purple-800"})[v]||"bg-gray-100 text-gray-800",p=v=>({Bold:"bg-blue-100 text-blue-800",PayPal:"bg-yellow-100 text-yellow-800",PayU:"bg-green-100 text-green-800","Transferencia Bancaria":"bg-purple-100 text-purple-800",Manual:"bg-gray-100 text-gray-800"})[v]||"bg-gray-100 text-gray-800",k=v=>{const A={invoiceNumber:`INV-${v.id.slice(-8).toUpperCase()}`,date:new Date(v.createdAt.seconds*1e3).toLocaleDateString(),dueDate:v.dueDate?new Date(v.dueDate.seconds*1e3).toLocaleDateString():"N/A",clientName:v.clientName||(n==null?void 0:n.fullName)||"Cliente",clientEmail:v.clientEmail||(t==null?void 0:t.email)||"N/A",serviceNumber:v.serviceNumber||"N/A",serviceType:v.serviceType||"Servicio",description:v.description||"Descripción del servicio",amount:v.amount||0,currency:v.currency||"USD",status:v.status||"Pendiente",gateway:v.gateway||"N/A",transactionId:v.transactionId||"N/A",paymentMethod:v.paymentMethod||"N/A"},F=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>Invoice ${A.invoiceNumber}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
          .invoice { background: white; max-width: 800px; margin: 0 auto; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
          .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #e5e5e5; padding-bottom: 20px; }
          .company-name { font-size: 24px; font-weight: bold; color: #2563eb; margin-bottom: 5px; }
          .invoice-title { font-size: 18px; color: #666; }
          .invoice-details { display: flex; justify-content: space-between; margin-bottom: 30px; }
          .client-info, .invoice-info { flex: 1; }
          .client-info h3, .invoice-info h3 { margin: 0 0 10px 0; color: #333; font-size: 16px; }
          .client-info p, .invoice-info p { margin: 5px 0; color: #666; font-size: 14px; }
          .service-details { margin-bottom: 30px; }
          .service-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
          .service-table th, .service-table td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e5e5; }
          .service-table th { background: #f8f9fa; font-weight: bold; color: #333; }
          .service-table .amount { text-align: right; font-weight: bold; }
          .total { text-align: right; margin-top: 20px; }
          .total-amount { font-size: 20px; font-weight: bold; color: #2563eb; }
          .status { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; }
          .status.completado { background: #d1fae5; color: #065f46; }
          .status.pendiente { background: #fef3c7; color: #92400e; }
          .status.fallido { background: #fee2e2; color: #991b1b; }
          .status.cancelado { background: #f3f4f6; color: #374151; }
          .footer { margin-top: 40px; text-align: center; color: #666; font-size: 12px; border-top: 1px solid #e5e5e5; padding-top: 20px; }
        </style>
      </head>
      <body>
        <div class="invoice">
          <div class="header">
            <div class="company-name">Gestor de Cobros</div>
            <div class="invoice-title">FACTURA</div>
          </div>
          
          <div class="invoice-details">
            <div class="client-info">
              <h3>Cliente</h3>
              <p><strong>${A.clientName}</strong></p>
              <p>${A.clientEmail}</p>
            </div>
            <div class="invoice-info">
              <h3>Detalles de la Factura</h3>
              <p><strong>Número:</strong> ${A.invoiceNumber}</p>
              <p><strong>Fecha:</strong> ${A.date}</p>
              <p><strong>Vencimiento:</strong> ${A.dueDate}</p>
              <p><strong>Estado:</strong> <span class="status ${A.status.toLowerCase()}">${A.status}</span></p>
            </div>
          </div>
          
          <div class="service-details">
            <h3>Detalles del Servicio</h3>
            <table class="service-table">
              <thead>
                <tr>
                  <th>Servicio</th>
                  <th>Descripción</th>
                  <th>Monto</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>${A.serviceType}</td>
                  <td>${A.description}</td>
                  <td class="amount">${A.currency} ${A.amount.toFixed(2)}</td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <div class="total">
            <div class="total-amount">Total: ${A.currency} ${A.amount.toFixed(2)}</div>
          </div>
          
          <div class="footer">
            <p>Método de Pago: ${A.paymentMethod}</p>
            <p>Gateway: ${A.gateway}</p>
            ${A.transactionId!=="N/A"?`<p>ID de Transacción: ${A.transactionId}</p>`:""}
            <p>Gracias por su negocio</p>
          </div>
        </div>
      </body>
      </html>
    `,K=new Blob([F],{type:"text/html"}),G=URL.createObjectURL(K),Z=document.createElement("a");Z.href=G,Z.download=`invoice-${A.invoiceNumber}.html`,document.body.appendChild(Z),Z.click(),document.body.removeChild(Z),URL.revokeObjectURL(G),r("Invoice descargado exitosamente","success")},w=v=>v?new Date(v.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",N=(v,A)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:A||"USD"}).format(v),$=v=>{switch(v){case"Completado":return"✅";case"Pendiente":return"⏳";case"Procesando":return"🔄";case"Fallido":return"❌";case"Cancelado":return"🚫";case"Reembolsado":return"↩️";default:return"❓"}},D=v=>{T(v),E(!0)},V=async(v,A)=>{const F=z(),K=F==null?void 0:F[A];if(K)if(A==="bankTransfer"){if(v.gateway!=="Transferencia Bancaria")try{const G=ce(te,"artifacts",ee,"public","data","payments",v.id);await Xe(G,{gateway:"Transferencia Bancaria",updatedAt:new Date}),r("Pasarela cambiada a Transferencia Bancaria","success")}catch{r("No se pudo actualizar la pasarela del pago","error")}D({...v,gateway:"Transferencia Bancaria"})}else r(`Redirigiendo a ${K.name} para procesar el pago`,"info")},O=async(v,A)=>{if(!A||!(v!=null&&v.id)){r("Selecciona una imagen válida","warning");return}try{q(X=>({...X,[v.id]:!0}));const F=(A.name||"comprobante").replace(/[^a-zA-Z0-9._-]/g,"_"),K=`artifacts/${ee}/public/data/payments/${v.id}/proof-${Date.now()}-${F}`,G=Ek(Uk,K),Z=_k(G,A);await new Promise((X,ae)=>{Z.on("state_changed",()=>{},ae,X)});const U=await Nk(Z.snapshot.ref),Q=ce(te,"artifacts",ee,"public","data","payments",v.id);await Xe(Q,{proofUrl:U,proofUploadedAt:new Date}),T(X=>X&&X.id===v.id?{...X,proofUrl:U}:X),a(X=>X.map(ae=>ae.id===v.id?{...ae,proofUrl:U}:ae)),E(!1),r("Comprobante subido correctamente","success")}catch(F){console.error("Upload proof failed",F),r("No se pudo subir el comprobante","error")}finally{q(F=>({...F,[v.id]:!1}))}};return m?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):i.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[i.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[i.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[i.jsx($t,{}),"Mis Pagos"]}),i.jsxs("div",{className:"text-sm text-gray-500",children:[b.length," pago",b.length!==1?"s":""," encontrado",b.length!==1?"s":""]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",placeholder:"Buscar por servicio o transacción...",value:o,onChange:v=>c(v.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md"}),i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Vi,{})})]}),i.jsx("select",{value:u,onChange:v=>d(v.target.value),className:"w-full p-2 border rounded-md",children:I.map(v=>i.jsx("option",{value:v,children:v},v))})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[i.jsx("div",{className:"text-sm text-gray-500",children:"Total Pagado"}),i.jsx("div",{className:"text-2xl font-bold text-green-600",children:N(s.filter(v=>v.status==="Completado").reduce((v,A)=>v+(A.amount||0),0),"USD")})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[i.jsx("div",{className:"text-sm text-gray-500",children:"Pendientes"}),i.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:s.filter(v=>v.status==="Pendiente").length})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[i.jsx("div",{className:"text-sm text-gray-500",children:"Completados"}),i.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.filter(v=>v.status==="Completado").length})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[i.jsx("div",{className:"text-sm text-gray-500",children:"Fallidos"}),i.jsx("div",{className:"text-2xl font-bold text-red-600",children:s.filter(v=>v.status==="Fallido").length})]})]}),b.length===0?i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[i.jsx($t,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes pagos registrados"}),i.jsx("p",{className:"text-gray-500",children:"Los pagos aparecerán aquí una vez que realices una transacción."})]}):i.jsx("div",{className:"space-y-4",children:b.map(v=>i.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("span",{className:"text-2xl",children:$(v.status)}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:v.serviceName||v.serviceType||"Servicio"}),i.jsx("p",{className:"text-sm text-gray-500 font-mono",children:v.serviceNumber||v.id}),v.serviceDescription&&i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:v.serviceDescription}),v.isRenewal&&i.jsxs("div",{className:"text-xs text-green-600 font-medium mt-1",children:["Renovación: ",v.renewalPeriod||"N/A"]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-gray-500",children:"Monto:"}),i.jsx("div",{className:"font-semibold text-lg text-gray-900",children:N(v.amount,v.currency)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-gray-500",children:"Estado:"}),i.jsx("div",{className:"mt-1",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${C(v.status)}`,children:v.status})})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-gray-500",children:"Pasarela:"}),i.jsx("div",{className:"mt-1",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${p(v.gateway)}`,children:v.gateway})})]})]}),i.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:[i.jsxs("div",{children:["Fecha: ",w(v.createdAt)]}),v.completedAt&&i.jsxs("div",{children:["Completado: ",w(v.completedAt)]}),v.startDate&&v.endDate&&i.jsx("div",{className:"text-blue-600 mt-2",children:i.jsxs("div",{children:["Período: ",w(v.startDate)," - ",w(v.endDate)]})}),v.transactionId&&i.jsxs("div",{className:"font-mono",children:["ID: ",v.transactionId]}),v.isRenewal&&v.renewalMonths&&i.jsxs("div",{className:"text-green-600",children:["Duración: ",v.renewalMonths," meses"]})]})]}),i.jsxs("div",{className:"mt-4 md:mt-0 md:ml-4 flex flex-wrap gap-2",children:[(v.status==="Completado"||v.status==="Fallido"||v.status==="Cancelado")&&i.jsxs("button",{onClick:()=>k(v),className:"inline-flex items-center px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm",children:[i.jsx(Gr,{className:"h-4 w-4 mr-1"}),"Descargar Invoice"]}),v.status==="Pendiente"&&i.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{const A=z();return A?Object.entries(A).map(([F,K])=>K.enabled?i.jsxs("button",{onClick:()=>V(v,F),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:["Pagar con ",K.name]},F):null):null})()}),v.status==="Pendiente"&&v.gateway==="Transferencia Bancaria"&&i.jsxs(i.Fragment,{children:[i.jsxs("label",{className:`px-4 py-2 ${M[v.id]?"bg-gray-200 text-gray-400 cursor-wait":"bg-gray-100 text-gray-800 hover:bg-gray-200 cursor-pointer"} rounded-lg text-sm`,children:[M[v.id]?"Subiendo...":"Subir Comprobante",i.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:A=>{var F;return((F=A.target.files)==null?void 0:F[0])&&O(v,A.target.files[0])}})]}),v.proofUrl&&i.jsx("a",{href:v.proofUrl,target:"_blank",rel:"noreferrer",className:"px-4 py-2 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 text-sm",children:"Ver Comprobante"})]})]})]})},v.id))}),S&&P&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:i.jsx("div",{className:"bg-white rounded-lg shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Instrucciones de Transferencia"}),i.jsx("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),i.jsx(pP,{bankAccounts:y,serviceNumber:P.serviceNumber,amount:P.amount,currency:P.currency,onUpload:v=>O(P,v)})]})})})]})}function yP({user:t,isDemo:e,userProfile:n}){const{addNotification:r}=Ae(),[s,a]=L.useState([]),[o,c]=L.useState(null),[u,d]=L.useState(!0),[m,g]=L.useState(null),[y,x]=L.useState(new Set),[S,E]=L.useState(!1),P=[{key:"monthly",label:"Mensual",months:1},{key:"quarterly",label:"Trimestral",months:3},{key:"semiAnnual",label:"Semestral",months:6},{key:"annual",label:"Anual",months:12},{key:"biennial",label:"Bienal (2 años)",months:24},{key:"triennial",label:"Trienal (3 años)",months:36}];L.useEffect(()=>{if(e){c({discounts:{monthly:{enabled:!1,percentage:0},quarterly:{enabled:!0,percentage:5},semiAnnual:{enabled:!0,percentage:10},annual:{enabled:!0,percentage:15},biennial:{enabled:!0,percentage:25},triennial:{enabled:!0,percentage:35}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"}});return}const O=ce(te,"artifacts",ee,"public","data","settings","renewalConfig"),v=_e(O,A=>{A.exists()?(c(A.data()),console.log("Renewal config loaded:",A.data())):(console.log("No renewal config found, using defaults"),c({discounts:{monthly:{enabled:!1,percentage:0},quarterly:{enabled:!0,percentage:5},semiAnnual:{enabled:!0,percentage:10},annual:{enabled:!0,percentage:15},biennial:{enabled:!0,percentage:25},triennial:{enabled:!0,percentage:35}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"}}))},A=>{console.error("Error loading renewal config:",A)});return()=>v()},[e]),L.useEffect(()=>{const O=localStorage.getItem("selectedServiceForRenewal");if(O)try{const v=JSON.parse(O);g(v),r(`Servicio "${v.serviceType}" seleccionado para renovación`,"success"),localStorage.removeItem("selectedServiceForRenewal")}catch(v){console.error("Error parsing selected service:",v)}},[]),L.useEffect(()=>{if(!m||s.length===0)return;const O=document.getElementById(`service-${m.id}`);O&&O.scrollIntoView({behavior:"smooth",block:"start"})},[m,s]),L.useEffect(()=>{if(e||!(t!=null&&t.uid))return;const O=qe(ge(te,"artifacts",ee,"public","data","payments"),rt("userId","==",t.uid),rt("status","==","Pendiente"),rt("isRenewal","==",!0)),v=_e(O,A=>{const F=new Set;A.docs.forEach(K=>{const G=K.data();G.serviceId&&F.add(G.serviceId)}),x(F)},A=>{console.error("Error loading pending renewals:",A)});return()=>v()},[t==null?void 0:t.uid,e]);const T=O=>{if(!O.dueDate||!O.billingCycle||O.billingCycle==="One-Time")return O.expirationDate?new Date(O.expirationDate.seconds*1e3):null;const v=new Date(O.dueDate.seconds*1e3);let A=new Date(v);switch(O.billingCycle){case"Monthly":A.setMonth(A.getMonth()+1);break;case"Semiannually":A.setMonth(A.getMonth()+6);break;case"Annually":A.setFullYear(A.getFullYear()+1);break;case"Biennially":A.setFullYear(A.getFullYear()+2);break;case"Triennially":A.setFullYear(A.getFullYear()+3);break;default:return null}return A},j=O=>O.billingCycle==="One-Time"?O.dueDate?new Date(O.dueDate.seconds*1e3):null:T(O);L.useEffect(()=>{if(e){a([{id:"demo1",serviceNumber:"SRV-241017-123456",serviceType:"Hosting Básico",description:"Plan Básico - 1GB",amount:5e4,currency:"COP",status:"Activo",dueDate:{seconds:Date.now()/1e3+30*24*60*60},billingCycle:"Monthly",clientNotes:"Servicio de hosting básico"},{id:"demo2",serviceNumber:"SRV-241017-789012",serviceType:"Dominio",description:"midominio.com",amount:15e4,currency:"COP",status:"Activo",dueDate:{seconds:Date.now()/1e3+10*24*60*60},billingCycle:"Annually",clientNotes:"Renovación de dominio"}]),c({renewalSettings:{enabled:!0,maxRenewalYears:3,autoRenewal:!0,gracePeriodDays:7,reminderDays:3},discounts:{monthly:{enabled:!1,discount:0,description:"Descuento por pago mensual"},quarterly:{enabled:!0,discount:5,description:"Descuento por pago trimestral"},semiAnnual:{enabled:!0,discount:10,description:"Descuento por pago semestral"},annual:{enabled:!0,discount:15,description:"Descuento por pago anual"},biennial:{enabled:!0,discount:25,description:"Descuento por pago bienal (2 años)"},triennial:{enabled:!0,discount:35,description:"Descuento por pago trienal (3 años)"}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"},pricingSettings:{roundToNearest:100,minimumAmount:1e3,maximumAmount:1e7}}),d(!1);return}if(!(t!=null&&t.uid)){d(!1);return}const O=qe(ge(te,"artifacts",ee,"public","data","services"),rt("assignedUserId","==",t.uid)),v=_e(O,K=>{const G=K.docs.map(Z=>({id:Z.id,...Z.data()}));a(G)},K=>{console.error("Error loading services:",K),r("Error al cargar los servicios","error")}),A=ce(te,"artifacts",ee,"public","data","settings","renewalConfig"),F=_e(A,K=>{K.exists()&&c(K.data()),d(!1)});return()=>{v(),F()}},[t==null?void 0:t.uid,e,r]);const R=(O,v)=>{var Z,U;if(!((U=(Z=o==null?void 0:o.discounts)==null?void 0:Z[v])!=null&&U.enabled))return O;const A=o.discounts[v],F=O*A.discount/100,K=O-F,G=Math.round(K/o.pricingSettings.roundToNearest)*o.pricingSettings.roundToNearest;return Math.max(G,o.pricingSettings.minimumAmount)},M=O=>{var v;if(!((v=o==null?void 0:o.taxSettings)!=null&&v.ivaEnabled)||o.taxSettings.ivaIncluded)return O;{const A=O*o.taxSettings.ivaPercentage/100;return O+A}},q=O=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(O),z=O=>{const v=j(O);if(!v)return 0;const A=new Date,F=v.getTime()-A.getTime();return Math.ceil(F/(1e3*60*60*24))},I=O=>{switch(O){case"Activo":return"bg-green-100 text-green-800";case"Periodo de Gracia Vencido":return"bg-yellow-100 text-yellow-800";case"Pendiente Pago":return"bg-orange-100 text-orange-800";case"Pago":return"bg-blue-100 text-blue-800";case"Cancelado":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},b=O=>{switch(O){case"Monthly":return 1;case"Quarterly":return 3;case"Semi-Annual":return 6;case"Annually":return 12;case"Biennial":return 24;case"Triennial":return 36;case"One-Time":return 0;default:return 1}},C=(O,v)=>{var K;const A=b(O.billingCycle),F=((K=P.find(G=>G.key===v))==null?void 0:K.months)||0;return A===0?!1:F>=A},p=(O,v)=>{var Z;const A=j(O);if(!A)return{startDate:null,endDate:null};const F=((Z=P.find(U=>U.key===v))==null?void 0:Z.months)||0,K=new Date(A),G=new Date(K);return G.setMonth(G.getMonth()+F),{startDate:K,endDate:G}},k=(O,v)=>{var K;const A=b(O.billingCycle);return A===0?"Volver a Comprar":(((K=P.find(G=>G.key===v))==null?void 0:K.months)||0)<A?"Período Insuficiente":"Renovar"},w=()=>{window.location.href="#payments"},N=O=>{if(!O)return null;if(O.gateways)return O.gateways;const{bold:v,paypal:A,payu:F,bankTransfer:K}=O,G={};return v&&(G.bold={name:"Bold",...v}),A&&(G.paypal={name:"PayPal",...A}),F&&(G.payu={name:"PayU",...F}),K&&(G.bankTransfer={name:"Transferencia Bancaria",...K}),G},[$,D]=L.useState(null);L.useEffect(()=>{if(e){D({gateways:{bankTransfer:{enabled:!0,name:"Transferencia Bancaria"}}});return}const O=ce(te,"artifacts",ee,"public","data","settings","paymentConfig"),v=_e(O,A=>{A.exists()&&D(A.data())});return()=>v()},[e]);const V=async(O,v)=>{var A,F,K,G,Z;if(e){const U=k(O,v);r(`${U} ${(A=P.find(Q=>Q.key===v))==null?void 0:A.label} iniciada (modo demo)`,"success");return}if(y.has(O.id)){r("Ya tienes una solicitud de renovación pendiente para este servicio","warning");return}if(S){r("Ya se está procesando una solicitud de renovación","warning");return}E(!0);try{const{startDate:U,endDate:Q}=p(O,v),X=O.amount,ae=R(X,v),Ne=M(ae);let He=$&&N($);const je=He?Object.values(He).filter(mt=>mt.enabled):[];let Rt="Pendiente de Selección",ln="Renovación";je.length===1&&(Rt=je[0].name,ln=je[0].name);const Ln={userId:t.uid,serviceId:O.id,serviceName:O.serviceType,serviceType:O.serviceType,serviceDescription:O.description,serviceNumber:O.serviceNumber,amount:Ne,originalAmount:X,discount:X-ae,currency:"USD",status:"Pendiente",paymentMethod:ln,paymentType:"Renovación",gateway:Rt,transactionId:null,dueDate:le.fromDate(new Date(U)),renewalPeriod:((F=P.find(mt=>mt.key===v))==null?void 0:F.label)||v,renewalMonths:((K=P.find(mt=>mt.key===v))==null?void 0:K.months)||0,startDate:le.fromDate(new Date(U)),endDate:le.fromDate(new Date(Q)),createdAt:le.now(),updatedAt:le.now(),notes:`Renovación de ${(G=P.find(mt=>mt.key===v))==null?void 0:G.label} para el servicio ${O.serviceType}`,isRenewal:!0},cn=ge(te,`artifacts/${ee}/public/data/payments`);await or(cn,Ln);const un={service:O,period:v,startDate:U,endDate:Q,originalPrice:X,discountedPrice:ae,finalPrice:Ne};localStorage.setItem("renewalData",JSON.stringify(un));const Xr=k(O,v);r(`${Xr} ${(Z=P.find(mt=>mt.key===v))==null?void 0:Z.label} - Redirigiendo a pagos`,"success"),x(mt=>new Set([...mt,O.id])),setTimeout(()=>{window.location.href="#payments"},1500)}catch(U){console.error("Error creating renewal payment:",U),r("Error al crear la solicitud de renovación. Intenta nuevamente.","error")}finally{E(!1)}};return u?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):i.jsxs("main",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[i.jsx("div",{className:"flex justify-between items-center mb-6",children:i.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(Ur,{}),"Renovaciones de Servicios"]})}),s.length===0?i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[i.jsx(Ur,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes servicios para renovar"}),i.jsx("p",{className:"text-gray-500",children:"Contacta al administrador para que te asigne servicios."})]}):i.jsx("div",{className:"space-y-6",children:s.map(O=>{const v=z(O),A=v<=30&&v>0,F=v<=0,K=m&&m.id===O.id;return i.jsxs("div",{id:`service-${O.id}`,className:`bg-white rounded-xl shadow-lg p-6 ${K?"ring-2 ring-blue-500 border-blue-200":""}`,children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-4",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:O.serviceType}),K&&i.jsx("span",{className:"px-2 py-1 text-xs font-semibold text-blue-700 bg-blue-100 rounded-full",children:"Seleccionado"})]}),i.jsx("p",{className:"text-sm text-gray-500 font-mono",children:O.serviceNumber}),i.jsx("p",{className:"text-sm text-gray-600",children:O.description})]}),i.jsx("div",{className:"mt-2 md:mt-0",children:i.jsx("span",{className:`px-3 py-1 text-sm font-semibold rounded-full ${I(O.status)}`,children:O.status})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-gray-500",children:"Precio Actual:"}),i.jsx("div",{className:"font-semibold text-lg text-gray-900",children:q(O.amount)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-gray-500",children:O.billingCycle==="One-Time"?"Fecha de Inicio:":"Fecha de Vencimiento:"}),i.jsx("div",{className:`font-semibold ${F?"text-red-600":A?"text-orange-600":"text-gray-900"}`,children:(()=>{const G=j(O);return G?G.toLocaleDateString():"N/A"})()}),i.jsx("div",{className:"text-xs text-gray-500",children:F?"Vencido":A?`${v} días restantes`:`${v} días restantes`})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-gray-500",children:"Ciclo Actual:"}),i.jsx("div",{className:"font-semibold text-gray-900",children:O.billingCycle})]})]}),i.jsxs("div",{className:"border-t pt-6",children:[i.jsxs("h4",{className:"text-md font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[i.jsx(x_,{}),b(O.billingCycle)===0?"Opciones de Compra":"Opciones de Renovación"]}),b(O.billingCycle)===0?i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.725-1.36 3.49 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Servicio de Pago Único"}),i.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:i.jsx("p",{children:'Este servicio es de pago único. Para volver a adquirirlo, contacta al administrador o selecciona "Volver a Comprar" si está disponible.'})})]})]})}):i.jsxs("div",{className:"space-y-4",children:[(()=>{var Z,U;const G=P.find(Q=>b(O.billingCycle)===Q.months);if(G){const Q=O.amount,X=R(Q,G.key),ae=M(X),Ne=(Z=o==null?void 0:o.discounts)==null?void 0:Z[G.key],He=Q-X,{startDate:je,endDate:Rt}=p(O,G.key);return i.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h5",{className:"font-semibold text-blue-900 flex items-center gap-2",children:[i.jsx(Ur,{className:"h-4 w-4"}),"Renovación de Período Actual"]}),i.jsx("span",{className:"px-3 py-1 bg-blue-200 text-blue-800 text-sm font-semibold rounded-full",children:G.label})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[i.jsxs("div",{children:["Precio base: ",q(Q)]}),(Ne==null?void 0:Ne.enabled)&&He>0&&i.jsxs("div",{className:"text-green-600",children:["Ahorras: ",q(He)]})]}),i.jsx("div",{className:"font-bold text-xl text-blue-600",children:q(ae)}),((U=o==null?void 0:o.taxSettings)==null?void 0:U.ivaEnabled)&&i.jsx("div",{className:"text-xs text-gray-500",children:o.taxSettings.ivaIncluded?"IVA incluido":`+ ${o.taxSettings.taxName} ${o.taxSettings.ivaPercentage}%`})]}),i.jsx("div",{children:je&&Rt&&i.jsxs("div",{className:"p-3 bg-white border border-blue-200 rounded-lg",children:[i.jsx("div",{className:"text-xs font-medium text-blue-800 mb-2",children:"Fechas de Renovación:"}),i.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[i.jsxs("div",{children:["Fecha de Vencimiento: ",je.toLocaleDateString()]}),i.jsxs("div",{children:["Fecha Nueva Renovación: ",Rt.toLocaleDateString()]})]})]})})]}),y.has(O.id)?i.jsx("button",{onClick:w,className:"w-full mt-4 px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-colors",children:"Ver Solicitud Pendiente"}):i.jsx("button",{onClick:()=>V(O,G.key),disabled:S,className:`w-full mt-4 px-6 py-3 font-semibold rounded-lg transition-colors ${S?"bg-gray-400 text-white cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:S?"Creando...":`Renovar ${G.label}`})]})}return null})(),i.jsxs("div",{children:[i.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-3",children:"Otras Opciones de Renovación:"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.map(G=>{var Ln,cn,un;const Z=O.amount,U=R(Z,G.key),Q=M(U),X=(Ln=o==null?void 0:o.discounts)==null?void 0:Ln[G.key],ae=Z-U,Ne=C(O,G),He=k(O,G),je=b(O.billingCycle)===G.months,Rt=!((cn=o==null?void 0:o.discounts)!=null&&cn[G.key])||o.discounts[G.key].enabled,ln=Ne&&!je&&Rt;return ln?i.jsxs("div",{className:"border rounded-lg p-4 transition-shadow border-gray-200 hover:shadow-md",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h5",{className:"font-medium text-gray-800",children:G.label}),(X==null?void 0:X.enabled)&&ln&&i.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-semibold rounded-full",children:["-",X.discount,"%"]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsxs("div",{children:["Precio base: ",q(Z)]}),(X==null?void 0:X.enabled)&&ae>0&&i.jsxs("div",{className:"text-green-600",children:["Ahorras: ",q(ae)]})]}),i.jsx("div",{className:"font-semibold text-lg text-blue-600",children:q(Q)}),((un=o==null?void 0:o.taxSettings)==null?void 0:un.ivaEnabled)&&i.jsx("div",{className:"text-xs text-gray-500",children:o.taxSettings.ivaIncluded?"IVA incluido":`+ ${o.taxSettings.taxName} ${o.taxSettings.ivaPercentage}%`}),(()=>{const{startDate:Xr,endDate:mt}=p(O,G);return Xr&&mt?i.jsxs("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsx("div",{className:"text-xs font-medium text-blue-800 mb-2",children:"Fechas de Renovación:"}),i.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[i.jsxs("div",{children:["Fecha de Vencimiento: ",Xr.toLocaleDateString()]}),i.jsxs("div",{children:["Fecha Nueva Renovación: ",mt.toLocaleDateString()]})]})]}):null})(),y.has(O.id)?i.jsx("button",{onClick:w,className:"w-full px-4 py-2 rounded-md text-sm font-medium bg-green-600 text-white hover:bg-green-700",children:"Ver Solicitud"}):i.jsx("button",{onClick:()=>V(O,G.key),disabled:S,className:`w-full px-4 py-2 rounded-md text-sm font-medium ${S?"bg-gray-400 text-white cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:S?"Creando...":`${He} ${G.label}`})]})]},G.key):null})})]})]})]}),i.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[i.jsx("h5",{className:"font-medium text-gray-800 mb-2",children:"Información Importante"}),i.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[i.jsxs("li",{children:["• ",i.jsx("strong",{children:'La "Renovación de Período Actual" siempre está disponible y destacada'})]}),i.jsxs("li",{children:["• ",i.jsx("strong",{children:"Fecha de Vencimiento"}),": Fecha actual de vencimiento del servicio"]}),i.jsxs("li",{children:["• ",i.jsx("strong",{children:"Fecha Nueva Renovación"}),": Fecha calculada después de sumar el período"]}),i.jsx("li",{children:"• Los descuentos se aplican automáticamente según el período seleccionado (si están configurados)"}),i.jsx("li",{children:"• Los precios se redondean para evitar decimales"}),i.jsx("li",{children:"• El IVA se calcula según la configuración actual"}),i.jsxs("li",{children:["• ",i.jsx("strong",{children:"La renovación extiende el servicio desde la fecha de vencimiento actual"})]}),i.jsx("li",{children:"• El período de renovación no puede ser inferior al ciclo actual del servicio"}),i.jsx("li",{children:'• Los servicios de pago único requieren "Volver a Comprar" en lugar de renovar'}),i.jsx("li",{children:"• Al seleccionar una renovación, serás redirigido a la sección de pagos para proceder"})]})]})]},O.id)})})]})}function xP({user:t,isDemo:e,userProfile:n}){const{addNotification:r}=Ae(),[s,a]=L.useState([]),[o,c]=L.useState(!0),[u,d]=L.useState(!1),[m,g]=L.useState(null),[y,x]=L.useState(!1),[S,E]=L.useState({subject:"",department:"Soporte Técnico",priority:"Media",description:""}),P=["Soporte Técnico","Facturación","Ventas","General"],T=["Baja","Media","Alta","Crítica"];L.useEffect(()=>{if(e){a([{id:"ticket1",ticketNumber:"TKT-2024-001",subject:"Problema con el acceso al panel de cliente",description:"No puedo acceder a mi panel de cliente desde ayer. Me aparece un error 500.",status:"Abierto",priority:"Alta",department:"Soporte Técnico",clientId:(t==null?void 0:t.uid)||"demo",clientName:(n==null?void 0:n.fullName)||"Usuario Demo",clientEmail:(t==null?void 0:t.email)||"demo@ejemplo.com",assignedTo:null,assignedToName:null,createdAt:{seconds:Date.now()/1e3-3600},updatedAt:{seconds:Date.now()/1e3-3600},lastReplyAt:{seconds:Date.now()/1e3-3600},lastReplyBy:"Cliente",replyCount:0,attachments:[]},{id:"ticket2",ticketNumber:"TKT-2024-002",subject:"Consulta sobre facturación",description:"Necesito una copia de mi factura del mes pasado para contabilidad.",status:"Respondido",priority:"Media",department:"Facturación",clientId:(t==null?void 0:t.uid)||"demo",clientName:(n==null?void 0:n.fullName)||"Usuario Demo",clientEmail:(t==null?void 0:t.email)||"demo@ejemplo.com",assignedTo:"admin1",assignedToName:"Admin Principal",createdAt:{seconds:Date.now()/1e3-7200},updatedAt:{seconds:Date.now()/1e3-1800},lastReplyAt:{seconds:Date.now()/1e3-1800},lastReplyBy:"Admin Principal",replyCount:2,attachments:["factura_enero.pdf"]}]),c(!1);return}if(!(t!=null&&t.uid)){c(!1);return}const p=qe(ge(te,"artifacts",ee,"public","data","tickets"),rt("clientId","==",t.uid)),k=_e(p,w=>{const N=w.docs.map($=>({id:$.id,...$.data()}));N.sort(($,D)=>{var v,A;const V=((v=$.createdAt)==null?void 0:v.seconds)||0;return(((A=D.createdAt)==null?void 0:A.seconds)||0)-V}),a(N),c(!1)},w=>{console.error("Error loading tickets:",w),r("Error al cargar los tickets","error"),c(!1)});return()=>k()},[t==null?void 0:t.uid,e,r,n]);const j=async p=>{if(p.preventDefault(),e){r("Ticket creado (modo demo)","success"),d(!1),E({subject:"",department:"Soporte Técnico",priority:"Media",description:""});return}try{const k={...S,ticketNumber:`TKT-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,status:"Abierto",clientId:t.uid,clientName:(n==null?void 0:n.fullName)||t.email,clientEmail:t.email,assignedTo:null,assignedToName:null,createdAt:le.now(),updatedAt:le.now(),lastReplyAt:le.now(),lastReplyBy:"Cliente",replyCount:0,attachments:[]};await or(ge(te,"artifacts",ee,"public","data","tickets"),k),r("Ticket creado exitosamente","success"),d(!1),E({subject:"",department:"Soporte Técnico",priority:"Media",description:""})}catch(k){console.error("Error creating ticket:",k),r("Error al crear el ticket","error")}},R=p=>{g(p),x(!0)},M=async p=>{if(e){a(k=>k.map(w=>w.id===p?{...w,status:"Cerrado",updatedAt:{seconds:Date.now()/1e3}}:w)),r("Ticket cerrado (modo demo)","success");return}try{const k=ce(te,"artifacts",ee,"public","data","tickets",p);await Xe(k,{status:"Cerrado",updatedAt:le.now()}),r("Ticket cerrado exitosamente","success")}catch(k){console.error("Error closing ticket:",k),r("Error al cerrar el ticket","error")}},q=p=>({Abierto:"bg-red-100 text-red-800","En Progreso":"bg-yellow-100 text-yellow-800",Respondido:"bg-blue-100 text-blue-800",Cerrado:"bg-gray-100 text-gray-800","Esperando Cliente":"bg-orange-100 text-orange-800"})[p]||"bg-gray-100 text-gray-800",z=p=>({Baja:"bg-green-100 text-green-800",Media:"bg-yellow-100 text-yellow-800",Alta:"bg-orange-100 text-orange-800",Crítica:"bg-red-100 text-red-800"})[p]||"bg-gray-100 text-gray-800",I=p=>({"Soporte Técnico":"bg-blue-100 text-blue-800",Facturación:"bg-green-100 text-green-800",Ventas:"bg-purple-100 text-purple-800",General:"bg-gray-100 text-gray-800"})[p]||"bg-gray-100 text-gray-800",b=p=>p?new Date(p.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",C=p=>{if(!p)return"--";const k=new Date,w=new Date(p.seconds*1e3),N=k.getTime()-w.getTime(),$=Math.floor(N/(1e3*60*60*24)),D=Math.floor(N/(1e3*60*60)),V=Math.floor(N/(1e3*60));return $>0?`hace ${$} día${$>1?"s":""}`:D>0?`hace ${D} hora${D>1?"s":""}`:V>0?`hace ${V} minuto${V>1?"s":""}`:"hace unos segundos"};return o?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):i.jsxs("main",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(fs,{}),"Mis Tickets de Soporte"]}),i.jsxs("button",{onClick:()=>d(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[i.jsx(Ao,{}),"Nuevo Ticket"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:i.jsx(en,{})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Abiertos"}),i.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s.filter(p=>p.status==="Abierto").length})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:i.jsx(io,{})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Respondidos"}),i.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s.filter(p=>p.status==="Respondido").length})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:i.jsx(en,{})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-gray-500",children:"En Progreso"}),i.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s.filter(p=>p.status==="En Progreso").length})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:i.jsx(fs,{})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Cerrados"}),i.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s.filter(p=>p.status==="Cerrado").length})]})]})})]}),s.length===0?i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[i.jsx(fs,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes tickets"}),i.jsx("p",{className:"text-gray-500 mb-4",children:"Crea tu primer ticket para obtener soporte."}),i.jsx("button",{onClick:()=>d(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Crear Primer Ticket"})]}):i.jsx("div",{className:"space-y-4",children:s.map(p=>i.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("span",{className:"font-mono text-sm font-medium text-blue-600",children:p.ticketNumber}),i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${q(p.status)}`,children:p.status}),i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${z(p.priority)}`,children:p.priority}),i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${I(p.department)}`,children:p.department})]}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:p.subject}),i.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:p.description}),i.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(en,{}),i.jsxs("span",{children:["Creado ",C(p.createdAt)]})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(kc,{}),i.jsxs("span",{children:[p.replyCount," respuesta",p.replyCount!==1?"s":""]})]}),p.assignedToName&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(io,{}),i.jsxs("span",{children:["Asignado a ",p.assignedToName]})]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>R(p),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md",title:"Ver ticket completo",children:i.jsx(Gr,{})}),p.status!=="Cerrado"&&i.jsx("button",{onClick:()=>M(p.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-md",title:"Cerrar ticket",children:i.jsx(Ci,{})})]})]})},p.id))}),u&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Crear Nuevo Ticket"}),i.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),i.jsxs("form",{onSubmit:j,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto *"}),i.jsx("input",{type:"text",value:S.subject,onChange:p=>E(k=>({...k,subject:p.target.value})),className:"w-full p-2 border rounded-md",placeholder:"Describe brevemente tu problema o consulta",required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento *"}),i.jsx("select",{value:S.department,onChange:p=>E(k=>({...k,department:p.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:P.map(p=>i.jsx("option",{value:p,children:p},p))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridad *"}),i.jsx("select",{value:S.priority,onChange:p=>E(k=>({...k,priority:p.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:T.map(p=>i.jsx("option",{value:p,children:p},p))})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción *"}),i.jsx("textarea",{value:S.description,onChange:p=>E(k=>({...k,description:p.target.value})),className:"w-full p-2 border rounded-md",rows:6,placeholder:"Describe tu problema o consulta en detalle. Incluye cualquier información relevante que pueda ayudar a resolver tu ticket más rápidamente.",required:!0})]}),i.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Crear Ticket"})]})]})]})}),y&&m&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:["Ticket ",m.ticketNumber]}),i.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${q(m.status)}`,children:m.status})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prioridad"}),i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${z(m.priority)}`,children:m.priority})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Departamento"}),i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${I(m.department)}`,children:m.department})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Asignado a"}),i.jsx("div",{className:"text-sm text-gray-900",children:m.assignedToName||"Sin asignar"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Creado"}),i.jsx("div",{className:"text-sm text-gray-900",children:b(m.createdAt)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Última actividad"}),i.jsx("div",{className:"text-sm text-gray-900",children:C(m.lastReplyAt)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto"}),i.jsx("div",{className:"text-sm text-gray-900 p-3 bg-gray-50 rounded-md",children:m.subject})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción"}),i.jsx("div",{className:"text-sm text-gray-900 p-4 bg-gray-50 rounded-md whitespace-pre-wrap",children:m.description})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Historial de Mensajes"}),i.jsx("div",{className:"border border-gray-200 rounded-md p-4",children:i.jsx(b_,{ticketId:m.id,isDemo:e,userRole:"client",currentUser:t})})]}),i.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[i.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cerrar"}),m.status!=="Cerrado"&&i.jsx("button",{onClick:()=>{M(m.id),x(!1)},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Cerrar Ticket"}),i.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Responder"})]})]})]})})]})}function vP({user:t,isDemo:e,userProfile:n}){const[r,s]=L.useState("services");L.useEffect(()=>{const o=()=>{const c=(window.location.hash||"").replace("#","");(c==="services"||c==="payments"||c==="renewals"||c==="tickets")&&s(c)};return o(),window.addEventListener("hashchange",o),()=>window.removeEventListener("hashchange",o)},[]);const a=()=>{switch(r){case"tickets":return i.jsx(xP,{user:t,isDemo:e,userProfile:n});case"payments":return i.jsx(gP,{user:t,isDemo:e,userProfile:n});case"renewals":return i.jsx(yP,{user:t,isDemo:e,userProfile:n});case"services":default:return i.jsx(fP,{user:t,isDemo:e,userProfile:n})}};return i.jsxs("main",{className:"container mx-auto",children:[i.jsx("div",{className:"border-b border-gray-200",children:i.jsxs("nav",{className:"-mb-px flex space-x-8 px-4 sm:px-6 lg:px-8","aria-label":"Tabs",children:[i.jsxs("button",{onClick:()=>s("services"),className:`${r==="services"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[i.jsx(Ac,{})," Mis Servicios"]}),i.jsxs("button",{onClick:()=>s("payments"),className:`${r==="payments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[i.jsx($t,{})," Mis Pagos"]}),i.jsxs("button",{onClick:()=>s("renewals"),className:`${r==="renewals"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[i.jsx(Ur,{})," Renovaciones"]}),i.jsxs("button",{onClick:()=>s("tickets"),className:`${r==="tickets"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[i.jsx(fs,{})," Tickets de Soporte"]})]})}),a()]})}function bP({companySettings:t}){const{addNotification:e}=Ae(),[n,r]=L.useState(!0),[s,a]=L.useState(""),[o,c]=L.useState(""),u=async d=>{d.preventDefault();try{if(n){const m=await gc(Ze,s,o),g=await Rn(qe(ge(te,"artifacts",ee,"public","data","users"),rt("__name__","==",m.user.uid)));if(g.docs.length===0)throw new Error("No se encontró el perfil de usuario.");const y=g.docs[0].data();if(y.status==="pending"||y.status==="disabled")throw await ls(Ze),new Error("Tu cuenta está pendiente de activación o ha sido deshabilitada.")}else{const m=await Xc(Ze,s,o);await pb(m.user);const g=ge(te,"artifacts",ee,"public","data","users");let x=(await Rn(g)).empty?"superadmin":"client";const S=x==="superadmin"?"active":"pending",E=x!=="superadmin";await Dn(ce(te,"artifacts",ee,"public","data","users",m.user.uid),{email:s,role:x,status:S,isProfileComplete:!1,createdAt:le.now(),fullName:"",identification:"",requiresPasswordChange:E}),x==="superadmin"?e("¡Registro exitoso! Eres el primer usuario y tienes permisos de superadministrador.","success"):(e("¡Registro exitoso! Revisa tu correo para verificar la cuenta. Un administrador debe activar tu usuario.","success"),await ls(Ze))}}catch(m){e(m.message,"error")}};return i.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:i.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-sm w-full",children:[i.jsx("div",{className:"flex justify-center mb-6",children:t.logoUrl?i.jsx("img",{src:t.logoUrl,alt:"Logo de la Empresa",className:"max-h-16"}):i.jsx("h1",{className:"text-3xl font-bold",children:t.companyName||"Gestor de Pagos"})}),i.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:n?"Iniciar Sesión":"Crear Cuenta"}),i.jsxs("form",{onSubmit:u,children:[i.jsx("input",{type:"email",value:s,onChange:d=>a(d.target.value),placeholder:"Email",className:"w-full p-2 mb-4 border rounded",required:!0}),i.jsx("input",{type:"password",value:o,onChange:d=>c(d.target.value),placeholder:"Contraseña",className:"w-full p-2 mb-4 border rounded",required:!0}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700",children:n?"Entrar":"Registrarse"})]}),i.jsx("button",{onClick:()=>r(!n),className:"w-full mt-4 text-sm text-blue-600 hover:underline",children:n?"¿No tienes cuenta? Regístrate":"¿Ya tienes cuenta? Inicia sesión"})]})})}function wP({companySettings:t,onLogin:e}){const{addNotification:n}=Ae(),[r,s]=L.useState(!1),a=async()=>{s(!0);try{const d=await gc(Ze,"admin@test.com","admin123");e(d.user,"superadmin")}catch{n("Error al iniciar sesión como administrador. Verifica las credenciales.","error")}finally{s(!1)}},o=async()=>{s(!0);try{const d=await gc(Ze,"cliente@test.com","cliente123");e(d.user,"client")}catch{n("Error al iniciar sesión como cliente. Verifica las credenciales.","error")}finally{s(!1)}};return i.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:i.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-md w-full",children:[i.jsx("div",{className:"flex justify-center mb-6",children:t.logoUrl?i.jsx("img",{src:t.logoUrl,alt:"Logo de la Empresa",className:"max-h-16"}):i.jsx("h1",{className:"text-3xl font-bold",children:t.companyName||"Gestor de Cobros"})}),i.jsxs("div",{className:"text-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Modo de Prueba"}),i.jsx("p",{className:"text-gray-600",children:"Selecciona el tipo de usuario para probar el sistema"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("button",{onClick:a,disabled:r,className:"w-full bg-blue-600 text-white p-4 rounded-lg hover:bg-blue-700 font-semibold text-lg disabled:opacity-50 flex items-center justify-center gap-2",children:r?i.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):i.jsxs(i.Fragment,{children:[i.jsx("span",{children:"👨‍💼"}),i.jsx("span",{children:"Entrar como Administrador"})]})}),i.jsx("button",{onClick:o,disabled:r,className:"w-full bg-green-600 text-white p-4 rounded-lg hover:bg-green-700 font-semibold text-lg disabled:opacity-50 flex items-center justify-center gap-2",children:r?i.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):i.jsxs(i.Fragment,{children:[i.jsx("span",{children:"👤"}),i.jsx("span",{children:"Entrar como Cliente"})]})})]}),i.jsx("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:i.jsxs("p",{className:"text-sm text-yellow-800 text-center",children:[i.jsx("strong",{children:"Credenciales de Prueba:"}),i.jsx("br",{}),"Admin: admin@test.com / admin123",i.jsx("br",{}),"Cliente: cliente@test.com / cliente123"]})})]})})}function _P({isOpen:t,onSave:e}){const{addNotification:n}=Ae(),[r,s]=L.useState(""),[a,o]=L.useState(""),[c,u]=L.useState(""),d=async m=>{if(m.preventDefault(),r.length<6){u("La contraseña debe tener al menos 6 caracteres.");return}if(r!==a){u("Las contraseñas no coinciden.");return}u("");try{await e(r),n("Contraseña cambiada exitosamente.","success")}catch{n("Error al cambiar la contraseña.","error")}};return t?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-md w-full",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Cambio de Contraseña Requerido"}),i.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Por seguridad, debes establecer una nueva contraseña para continuar."}),i.jsxs("form",{onSubmit:d,className:"space-y-4",children:[i.jsx("input",{type:"password",value:r,onChange:m=>s(m.target.value),placeholder:"Nueva Contraseña",className:"w-full p-2 border rounded-md",required:!0}),i.jsx("input",{type:"password",value:a,onChange:m=>o(m.target.value),placeholder:"Confirmar Nueva Contraseña",className:"w-full p-2 border rounded-md",required:!0}),c&&i.jsx("p",{className:"text-red-500 text-sm",children:c}),i.jsx("button",{type:"submit",className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md",children:"Guardar Contraseña"})]})]})}):null}function NP({isOpen:t,onComplete:e,user:n,userProfile:r}){const{addNotification:s}=Ae(),[a,o]=L.useState({fullName:(r==null?void 0:r.fullName)||"",identification:(r==null?void 0:r.identification)||"",phone:(r==null?void 0:r.phone)||"",address:(r==null?void 0:r.address)||""}),[c,u]=L.useState(!1);L.useEffect(()=>{const g=new URLSearchParams(window.location.search),y=g.get("uid");g.get("email");const x=g.get("name"),S=g.get("id");y&&y===(n==null?void 0:n.uid)&&(x||S)&&o(E=>({...E,fullName:x?decodeURIComponent(x):E.fullName,identification:S?decodeURIComponent(S):E.identification}))},[n==null?void 0:n.uid]);const d=g=>{const{name:y,value:x}=g.target;o(S=>({...S,[y]:x}))},m=async g=>{if(g.preventDefault(),!a.fullName.trim()){s("El nombre completo es obligatorio","error");return}u(!0);try{const y=ce(te,"artifacts",ee,"public","data","users",n.uid);await Xe(y,{fullName:a.fullName.trim(),identification:a.identification.trim(),phone:a.phone.trim(),address:a.address.trim(),isProfileComplete:!0,profileCompletedAt:new Date}),s("Perfil completado exitosamente","success"),e()}catch(y){console.error("Error completing profile:",y),s("Error al completar el perfil","error")}finally{u(!1)}};return t?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"text-center mb-6",children:[i.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Completar Perfil"}),i.jsxs("p",{className:"text-gray-600 mt-2",children:["Bienvenido ",n.email,"! Confirma o actualiza tu información para continuar."]})]}),i.jsxs("form",{onSubmit:m,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Completo *"}),i.jsx("input",{name:"fullName",value:a.fullName,onChange:d,placeholder:"Tu nombre completo",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Identificación"}),i.jsx("input",{name:"identification",value:a.identification,onChange:d,placeholder:"Cédula, DNI, etc.",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teléfono"}),i.jsx("input",{name:"phone",value:a.phone,onChange:d,placeholder:"+57 300 123 4567",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dirección"}),i.jsx("input",{name:"address",value:a.address,onChange:d,placeholder:"Tu dirección",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Información Importante"}),i.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[i.jsx("li",{children:"• Los datos mostrados fueron configurados por el administrador"}),i.jsx("li",{children:"• Puedes confirmar o modificar la información"}),i.jsx("li",{children:"• Esta información se usará para la facturación"}),i.jsx("li",{children:"• Puedes actualizar estos datos más tarde"})]})]}),i.jsx("div",{className:"flex justify-end pt-4",children:i.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold disabled:opacity-50 flex items-center gap-2",children:c?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Completando..."]}):"Completar Perfil"})})]})]})}):null}function EP({onComplete:t}){const{addNotification:e}=Ae(),[n,r]=L.useState(1),[s,a]=L.useState({companyName:"",identification:"",address:"",phone:"",email:"",website:""}),[o,c]=L.useState({email:"",password:"",confirmPassword:"",fullName:"",identification:""}),[u,d]=L.useState(!1),m=S=>{const{name:E,value:P}=S.target;a(T=>({...T,[E]:P}))},g=S=>{const{name:E,value:P}=S.target;c(T=>({...T,[E]:P}))},y=S=>{if(S.preventDefault(),!s.companyName){e("El nombre de la empresa es obligatorio","error");return}r(2)},x=async S=>{if(S.preventDefault(),o.password!==o.confirmPassword){e("Las contraseñas no coinciden","error");return}if(o.password.length<6){e("La contraseña debe tener al menos 6 caracteres","error");return}d(!0);try{const E=await Xc(Ze,o.email,o.password);await Dn(ce(te,"artifacts",ee,"public","data","users",E.user.uid),{email:o.email,fullName:o.fullName,identification:o.identification,role:"superadmin",status:"active",isProfileComplete:!0,createdAt:le.now(),requiresPasswordChange:!1}),await Dn(ce(te,"artifacts",ee,"public","data","settings","company_info"),{...s,isDemoMode:!1,createdAt:le.now()}),e("¡Configuración inicial completada exitosamente!","success"),r(3),setTimeout(()=>{t()},2e3)}catch(E){console.error("Error en configuración inicial:",E),e(`Error: ${E.message}`,"error")}finally{d(!1)}};return n===1?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"text-center mb-6",children:[i.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Configuración Inicial"}),i.jsx("p",{className:"text-gray-600 mt-2",children:"Paso 1 de 2: Información de la Empresa"})]}),i.jsxs("form",{onSubmit:y,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx("input",{name:"companyName",value:s.companyName,onChange:m,placeholder:"Nombre de la Empresa *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),i.jsx("input",{name:"identification",value:s.identification,onChange:m,placeholder:"NIT / Identificación Fiscal",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx("input",{name:"address",value:s.address,onChange:m,placeholder:"Dirección",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"}),i.jsx("input",{name:"phone",value:s.phone,onChange:m,placeholder:"Teléfono",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx("input",{name:"email",type:"email",value:s.email,onChange:m,placeholder:"Email de Contacto",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"}),i.jsx("input",{name:"website",value:s.website,onChange:m,placeholder:"Sitio Web",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),i.jsx("div",{className:"flex justify-end pt-4",children:i.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold",children:"Continuar"})})]})]})}):n===2?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"text-center mb-6",children:[i.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Crear Superadministrador"}),i.jsx("p",{className:"text-gray-600 mt-2",children:"Paso 2 de 2: Cuenta de Administrador Principal"})]}),i.jsxs("form",{onSubmit:x,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx("input",{name:"fullName",value:o.fullName,onChange:g,placeholder:"Nombre Completo *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),i.jsx("input",{name:"identification",value:o.identification,onChange:g,placeholder:"Identificación",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),i.jsx("input",{name:"email",type:"email",value:o.email,onChange:g,placeholder:"Email del Administrador *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx("input",{name:"password",type:"password",value:o.password,onChange:g,placeholder:"Contraseña *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),i.jsx("input",{name:"confirmPassword",type:"password",value:o.confirmPassword,onChange:g,placeholder:"Confirmar Contraseña *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{className:"flex justify-between pt-4",children:[i.jsx("button",{type:"button",onClick:()=>r(1),className:"px-6 py-3 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 font-semibold",children:"Atrás"}),i.jsx("button",{type:"submit",disabled:u,className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold disabled:opacity-50",children:u?"Creando...":"Completar Configuración"})]})]})]})}):n===3?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-md w-full text-center",children:[i.jsx("div",{className:"text-green-500 text-6xl mb-4",children:"✅"}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"¡Configuración Completada!"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"El sistema está listo para usar. Serás redirigido al dashboard en unos segundos..."}),i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"})]})}):null}const TP=async()=>{console.log("🔍 Iniciando diagnóstico de Firebase...");try{console.log("📋 Configuración de Firebase:"),console.log("- App ID:",ee),console.log("- Auth:",Ze?"✅ Configurado":"❌ No configurado"),console.log("- Firestore:",te?"✅ Configurado":"❌ No configurado"),console.log(`
👥 Verificando usuarios existentes...`);const t=ge(te,"artifacts",ee,"public","data","users"),e=await Rn(t);if(e.empty)return console.log("⚠️ No hay usuarios en la base de datos"),{success:!1,message:"No hay usuarios registrados"};const n=e.docs.map(a=>({id:a.id,...a.data()}));console.log("📊 Usuarios encontrados:",n.length),n.forEach(a=>{console.log(`- ${a.email} (${a.role}) - Estado: ${a.status}`)}),console.log(`
🏢 Verificando configuración de empresa...`);const r=ce(te,"artifacts",ee,"public","data","settings","company_info"),s=await So(r);return s.exists()?(console.log("✅ Configuración de empresa encontrada"),console.log("- Nombre:",s.data().companyName)):console.log("⚠️ No hay configuración de empresa"),{success:!0,users:n,settings:s.exists()?s.data():null}}catch(t){return console.error("❌ Error en diagnóstico:",t),{success:!1,error:t.message}}},w_=async(t,e,n="client")=>{try{console.log(`🔧 Creando usuario de prueba: ${t}`);const r=await Xc(Ze,t,e);return await Dn(ce(te,"artifacts",ee,"public","data","users",r.user.uid),{email:t,fullName:`Usuario ${n}`,identification:"12345678",role:n,status:"active",isProfileComplete:!0,createdAt:le.now(),requiresPasswordChange:!1}),console.log("✅ Usuario creado exitosamente"),{success:!0,user:r.user}}catch(r){return console.error("❌ Error creando usuario:",r),{success:!1,error:r.message}}},jP=async(t,e)=>{try{console.log(`🔐 Probando login: ${t}`);const n=await gc(Ze,t,e);return console.log("✅ Login exitoso"),await ls(Ze),console.log("🚪 Sesión cerrada"),{success:!0,user:n.user}}catch(n){return console.error("❌ Error en login:",n),{success:!1,error:n.message}}},SP=async()=>{const t=[{email:"admin@test.com",password:"admin123",role:"superadmin"},{email:"cliente@test.com",password:"cliente123",role:"client"}];console.log("🚀 Creando usuarios de prueba por defecto...");for(const e of t){const n=await w_(e.email,e.password,e.role);n.success?console.log(`✅ ${e.email} creado`):console.log(`❌ Error creando ${e.email}:`,n.error)}},CP=async()=>{try{console.log("🔧 Verificando configuración básica...");const t=ce(te,"artifacts",ee,"public","data","settings","company_info");(await So(t)).exists()||(console.log("📝 Creando configuración básica de empresa..."),await Dn(t,{companyName:"Gestor de Cobros",identification:"123.456.789-0",address:"Dirección de Prueba",phone:"+57 300 123 4567",email:"contacto@gestor-cobros.com",website:"www.gestor-cobros.com",isDemoMode:!1,createdAt:le.now()}),console.log("✅ Configuración de empresa creada"));const n=ge(te,"artifacts",ee,"public","data","users");return(await Rn(n)).empty&&(console.log("👥 Creando superadmin inicial..."),await w_("admin@gestor-cobros.com","admin123","superadmin")),console.log("✅ Configuración básica completada"),{success:!0}}catch(t){return console.error("❌ Error en configuración básica:",t),{success:!1,error:t.message}}};function IP(){const[t,e]=L.useState([]),[n,r]=L.useState(!1),s=(y,x="info")=>{e(S=>[...S,{message:y,type:x,timestamp:new Date().toLocaleTimeString()}])},a=()=>e([]),o=async()=>{r(!0),a(),s("🔍 Iniciando diagnóstico de Firebase...","info");try{const y=await TP();y.success?(s("✅ Diagnóstico completado exitosamente","success"),s(`📊 Usuarios encontrados: ${y.users.length}`,"info"),y.users.forEach(x=>{s(`- ${x.email} (${x.role}) - Estado: ${x.status}`,"info")})):s(`❌ Error en diagnóstico: ${y.message}`,"error")}catch(y){s(`❌ Error: ${y.message}`,"error")}finally{r(!1)}},c=async()=>{r(!0),a(),s("🚀 Creando usuarios de prueba...","info");try{await SP(),s("✅ Usuarios de prueba creados","success")}catch(y){s(`❌ Error: ${y.message}`,"error")}finally{r(!1)}},u=async()=>{r(!0),a(),s("🔧 Configurando sistema básico...","info");try{const y=await CP();y.success?s("✅ Configuración básica completada","success"):s(`❌ Error: ${y.error}`,"error")}catch(y){s(`❌ Error: ${y.message}`,"error")}finally{r(!1)}},d=async()=>{r(!0),a(),s("🔐 Probando login con usuario de prueba...","info");try{const y=await jP("admin@test.com","admin123");y.success?s("✅ Login de prueba exitoso","success"):s(`❌ Error en login: ${y.error}`,"error")}catch(y){s(`❌ Error: ${y.message}`,"error")}finally{r(!1)}},m=async()=>{r(!0),a(),s("🔍 Ejecutando diagnóstico avanzado...","info");try{const y=await f_();if(y.hasUsers){s(`✅ Usuarios encontrados: ${y.users.length}`,"success"),y.users.forEach((S,E)=>{s(`👤 ${E+1}. ${S.email} (${S.role}) - ${S.status}`,"info")}),y.hasSettings?s("✅ Configuración de empresa encontrada","success"):s("⚠️ No hay configuración de empresa","warning");const x=await Fk();x&&s(`👑 Usuario más antiguo: ${x.data.email} (${x.data.role})`,"info")}else s("❌ No hay usuarios en la base de datos","error"),y.error&&s(`Error: ${y.error}`,"error")}catch(y){s(`❌ Error en diagnóstico: ${y.message}`,"error")}finally{r(!1)}},g=y=>{switch(y){case"success":return"text-green-600";case"error":return"text-red-600";case"warning":return"text-yellow-600";default:return"text-blue-600"}};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-6",children:"🔧 Diagnóstico de Firebase"}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[i.jsx("button",{onClick:o,disabled:n,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:"🔍 Diagnóstico"}),i.jsx("button",{onClick:m,disabled:n,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50",children:"🔬 Avanzado"}),i.jsx("button",{onClick:c,disabled:n,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50",children:"👥 Crear Usuarios"}),i.jsx("button",{onClick:u,disabled:n,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50",children:"⚙️ Configurar"}),i.jsx("button",{onClick:d,disabled:n,className:"px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 disabled:opacity-50",children:"🔐 Probar Login"})]}),i.jsx("div",{className:"mb-4",children:i.jsx("button",{onClick:a,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"🗑️ Limpiar"})}),i.jsxs("div",{className:"bg-gray-100 rounded-lg p-4 max-h-96 overflow-y-auto",children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Resultados:"}),t.length===0?i.jsx("p",{className:"text-gray-500",children:"No hay resultados aún. Ejecuta un diagnóstico."}):i.jsx("div",{className:"space-y-1",children:t.map((y,x)=>i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx("span",{className:"text-xs text-gray-400",children:y.timestamp}),i.jsx("span",{className:`text-sm ${g(y.type)}`,children:y.message})]},x))})]}),i.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Credenciales de Prueba:"}),i.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Admin:"})," admin@test.com / admin123"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Cliente:"})," cliente@test.com / cliente123"]})]})]}),i.jsx("div",{className:"mt-4 flex justify-end",children:i.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"🔄 Recargar Página"})})]})})}function AP(){const{addNotification:t}=Ae(),[e,n]=L.useState(null),[r,s]=L.useState(null),[a,o]=L.useState(!0),[c,u]=L.useState(()=>localStorage.getItem("isDemoMode")==="true"),[d,m]=L.useState({companyName:"Gestor de Cobros"}),[g,y]=L.useState(!1),[x,S]=L.useState(!1),[E,P]=L.useState(!1);L.useEffect(()=>{localStorage.setItem("isDemoMode",c.toString())},[c]);const T=async()=>{try{console.log("🔍 Verificando si el sistema está configurado...");try{if((await f_()).hasUsers)return console.log("✅ Usuarios encontrados en Firestore"),!0}catch(w){console.warn("⚠️ Error accediendo a Firestore:",w.message)}return await Bk()?(console.log("✅ Usuarios encontrados en Authentication"),!0):(console.log("⚠️ Asumiendo que el sistema está configurado (hay errores de permisos)"),!0)}catch(k){return console.error("❌ Error verificando configuración:",k),!0}};L.useEffect(()=>{(async()=>{try{console.log("🔧 Iniciando verificación de configuración..."),console.log("🏢 Verificando configuración de empresa...");const w=ce(te,"artifacts",ee,"public","data","settings","company_info"),N=await So(w);if(N.exists()){console.log("✅ Configuración de empresa encontrada");const D=N.data();console.log("📋 Configuración:",D),m(D),u(D.isDemoMode||!1),S(!0),y(!1),console.log("✅ Sistema configurado con configuración existente");return}console.log("👥 No hay configuración, verificando si hay usuarios..."),await T()?(console.log("✅ Sistema ya configurado, saltando setup inicial"),m({companyName:"Gestor de Cobros",isDemoMode:!1}),S(!0),y(!1)):(console.log("❌ Sistema no configurado, mostrando setup inicial"),y(!0))}catch(w){console.error("❌ Error checking configuration:",w),console.log("⚠️ Error en verificación, asumiendo que el sistema está configurado"),m({companyName:"Gestor de Cobros",isDemoMode:!1}),S(!0),y(!1)}})()},[]),L.useEffect(()=>{if(!x)return;if(c){n({email:"superadmin@demo.com",uid:"demouser"}),s({role:"superadmin"}),o(!1);return}const k=r1(Ze,w=>{if(w){const N=ce(te,"artifacts",ee,"public","data","users",w.uid),$=_e(N,async D=>{if(D.exists()){const V=D.data();V.status==="active"||V.role==="superadmin"?(s(V),n(w)):(console.warn("Usuario inactivo o sin permisos:",V),t("Tu cuenta no está activa. Contacta al administrador.","error"),ls(Ze))}else console.warn("No se encontró el perfil de usuario en la base de datos"),console.log("Usuario no tiene perfil en Firestore, cerrando sesión..."),t("Usuario no encontrado en el sistema. Contacta al administrador.","error"),ls(Ze);o(!1)},D=>{console.error("Error fetching user data:",D),w&&t("Error al cargar el perfil de usuario. Intenta nuevamente.","error"),o(!1)});return()=>$()}else n(null),s(null),o(!1)});return()=>{k()}},[x,c]);const j=async k=>{const w=Ze.currentUser;if(w)try{await ZS(w,k);const N=ce(te,"artifacts",ee,"public","data","users",w.uid);await Xe(N,{requiresPasswordChange:!1})}catch(N){console.error("Error updating password:",N),t("Hubo un error al cambiar la contraseña.","error"),ls(Ze)}},R=()=>{c?(n(null),s(null)):ls(Ze)},M=(k,w)=>{n(k),s({role:w,status:"active"})},q=()=>{y(!1),S(!0),window.location.reload()};if(g)return i.jsx(EP,{onComplete:q});if(E)return i.jsx(IP,{onClose:()=>P(!1)});if(a)return i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"Cargando..."});const z=c?{email:"superadmin@demo.com",uid:"demouser"}:e,I=c?"superadmin":r==null?void 0:r.role;if(r!=null&&r.requiresPasswordChange&&!c)return i.jsx(_P,{isOpen:!0,onSave:j});const C=new URLSearchParams(window.location.search).get("uid"),p=C&&C===(e==null?void 0:e.uid);return(r==null?void 0:r.role)==="client"&&!c&&(!(r!=null&&r.isProfileComplete)&&(r==null?void 0:r.requiresPasswordChange)===!1||p)?i.jsx(NP,{isOpen:!0,onComplete:()=>{s(k=>({...k,isProfileComplete:!0})),p&&window.history.replaceState({},document.title,window.location.pathname)},user:e,userProfile:r}):i.jsx("div",{className:"bg-gray-50 min-h-screen font-sans text-gray-800",children:z?i.jsxs(i.Fragment,{children:[i.jsx("header",{className:"bg-white shadow-md",children:i.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center",children:[d.logoUrl?i.jsx("img",{src:d.logoUrl,alt:d.companyName,className:"max-h-10"}):i.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:d.companyName}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("span",{className:"text-sm text-gray-600 hidden sm:block",children:z.email}),i.jsx("button",{onClick:R,className:"text-gray-500 hover:text-red-600",children:i.jsx(qk,{})})]})]})}),c&&i.jsx("div",{className:"bg-yellow-400 text-center p-2 text-sm font-semibold",children:"MODO DE PRUEBA ACTIVO"}),I==="superadmin"||I==="admin"?i.jsx(hP,{user:z,isDemo:c,setIsDemoMode:u,userRole:I,companySettings:d,onLogout:R}):i.jsx(vP,{user:z,isDemo:c,userProfile:r})]}):i.jsxs("div",{className:"flex flex-col min-h-screen",children:[c&&i.jsx("div",{className:"bg-yellow-400 text-center p-3 text-sm font-semibold",children:"🟡 MODO DEMO ACTIVO - Usa los botones de prueba para acceder"}),i.jsx("div",{className:"flex-grow",children:c?i.jsx(wP,{companySettings:d,onLogin:M}):i.jsx(bP,{companySettings:d})}),(d.isDemoMode||d.allowDemoMode)&&i.jsxs("div",{className:"fixed bottom-4 right-4 flex flex-col gap-2",children:[i.jsx("button",{onClick:()=>u(!c),className:`px-4 py-2 rounded-lg shadow-lg text-sm font-medium transition-colors ${c?"bg-green-600 text-white hover:bg-green-700":"bg-yellow-600 text-white hover:bg-yellow-700"}`,title:c?"Cambiar a modo Live":"Cambiar a modo Demo",children:c?"🟢 Live":"🟡 Demo"}),i.jsx("button",{onClick:()=>P(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg shadow-lg hover:bg-red-700 text-sm",title:"Diagnóstico de Firebase",children:"🔧 Debug"})]})]})})}function kP(){return i.jsx(zk,{children:i.jsx(AP,{})})}Cd.createRoot(document.getElementById("root")).render(i.jsx(hN.StrictMode,{children:i.jsx(kP,{})}));
