var FE=Object.defineProperty;var VE=(t,e,n)=>e in t?FE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var dn=(t,e,n)=>VE(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var IM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function UE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ew={exports:{}},dp={},Aw={exports:{}},Vt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xh=Symbol.for("react.element"),BE=Symbol.for("react.portal"),zE=Symbol.for("react.fragment"),qE=Symbol.for("react.strict_mode"),$E=Symbol.for("react.profiler"),HE=Symbol.for("react.provider"),WE=Symbol.for("react.context"),GE=Symbol.for("react.forward_ref"),KE=Symbol.for("react.suspense"),YE=Symbol.for("react.memo"),QE=Symbol.for("react.lazy"),P2=Symbol.iterator;function XE(t){return t===null||typeof t!="object"?null:(t=P2&&t[P2]||t["@@iterator"],typeof t=="function"?t:null)}var jw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Tw=Object.assign,kw={};function Cu(t,e,n){this.props=t,this.context=e,this.refs=kw,this.updater=n||jw}Cu.prototype.isReactComponent={};Cu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Cu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Cw(){}Cw.prototype=Cu.prototype;function Z1(t,e,n){this.props=t,this.context=e,this.refs=kw,this.updater=n||jw}var ev=Z1.prototype=new Cw;ev.constructor=Z1;Tw(ev,Cu.prototype);ev.isPureReactComponent=!0;var R2=Array.isArray,Iw=Object.prototype.hasOwnProperty,tv={current:null},Pw={key:!0,ref:!0,__self:!0,__source:!0};function Rw(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Iw.call(e,r)&&!Pw.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:xh,type:t,key:s,ref:o,props:i,_owner:tv.current}}function JE(t,e){return{$$typeof:xh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function nv(t){return typeof t=="object"&&t!==null&&t.$$typeof===xh}function ZE(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var L2=/\/+/g;function yg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?ZE(""+t.key):e.toString(36)}function Vf(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case xh:case BE:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+yg(o,0):r,R2(i)?(n="",t!=null&&(n=t.replace(L2,"$&/")+"/"),Vf(i,e,n,"",function(u){return u})):i!=null&&(nv(i)&&(i=JE(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(L2,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",R2(t))for(var l=0;l<t.length;l++){s=t[l];var c=r+yg(s,l);o+=Vf(s,e,n,c,i)}else if(c=XE(t),typeof c=="function")for(t=c.call(t),l=0;!(s=t.next()).done;)s=s.value,c=r+yg(s,l++),o+=Vf(s,e,n,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function of(t,e,n){if(t==null)return t;var r=[],i=0;return Vf(t,r,"","",function(s){return e.call(n,s,i++)}),r}function eA(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var mi={current:null},Uf={transition:null},tA={ReactCurrentDispatcher:mi,ReactCurrentBatchConfig:Uf,ReactCurrentOwner:tv};function Lw(){throw Error("act(...) is not supported in production builds of React.")}Vt.Children={map:of,forEach:function(t,e,n){of(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return of(t,function(){e++}),e},toArray:function(t){return of(t,function(e){return e})||[]},only:function(t){if(!nv(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Vt.Component=Cu;Vt.Fragment=zE;Vt.Profiler=$E;Vt.PureComponent=Z1;Vt.StrictMode=qE;Vt.Suspense=KE;Vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tA;Vt.act=Lw;Vt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Tw({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=tv.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)Iw.call(e,c)&&!Pw.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:xh,type:t.type,key:i,ref:s,props:r,_owner:o}};Vt.createContext=function(t){return t={$$typeof:WE,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:HE,_context:t},t.Consumer=t};Vt.createElement=Rw;Vt.createFactory=function(t){var e=Rw.bind(null,t);return e.type=t,e};Vt.createRef=function(){return{current:null}};Vt.forwardRef=function(t){return{$$typeof:GE,render:t}};Vt.isValidElement=nv;Vt.lazy=function(t){return{$$typeof:QE,_payload:{_status:-1,_result:t},_init:eA}};Vt.memo=function(t,e){return{$$typeof:YE,type:t,compare:e===void 0?null:e}};Vt.startTransition=function(t){var e=Uf.transition;Uf.transition={};try{t()}finally{Uf.transition=e}};Vt.unstable_act=Lw;Vt.useCallback=function(t,e){return mi.current.useCallback(t,e)};Vt.useContext=function(t){return mi.current.useContext(t)};Vt.useDebugValue=function(){};Vt.useDeferredValue=function(t){return mi.current.useDeferredValue(t)};Vt.useEffect=function(t,e){return mi.current.useEffect(t,e)};Vt.useId=function(){return mi.current.useId()};Vt.useImperativeHandle=function(t,e,n){return mi.current.useImperativeHandle(t,e,n)};Vt.useInsertionEffect=function(t,e){return mi.current.useInsertionEffect(t,e)};Vt.useLayoutEffect=function(t,e){return mi.current.useLayoutEffect(t,e)};Vt.useMemo=function(t,e){return mi.current.useMemo(t,e)};Vt.useReducer=function(t,e,n){return mi.current.useReducer(t,e,n)};Vt.useRef=function(t){return mi.current.useRef(t)};Vt.useState=function(t){return mi.current.useState(t)};Vt.useSyncExternalStore=function(t,e,n){return mi.current.useSyncExternalStore(t,e,n)};Vt.useTransition=function(){return mi.current.useTransition()};Vt.version="18.3.1";Aw.exports=Vt;var ue=Aw.exports;const nA=UE(ue);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rA=ue,iA=Symbol.for("react.element"),sA=Symbol.for("react.fragment"),aA=Object.prototype.hasOwnProperty,oA=rA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,lA={key:!0,ref:!0,__self:!0,__source:!0};function Dw(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)aA.call(e,r)&&!lA.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:iA,type:t,key:s,ref:o,props:i,_owner:oA.current}}dp.Fragment=sA;dp.jsx=Dw;dp.jsxs=Dw;Ew.exports=dp;var a=Ew.exports,S0={},Mw={exports:{}},Zi={},Ow={exports:{}},Fw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(U,ee){var fe=U.length;U.push(ee);e:for(;0<fe;){var Q=fe-1>>>1,w=U[Q];if(0<i(w,ee))U[Q]=ee,U[fe]=w,fe=Q;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var ee=U[0],fe=U.pop();if(fe!==ee){U[0]=fe;e:for(var Q=0,w=U.length,F=w>>>1;Q<F;){var D=2*(Q+1)-1,K=U[D],te=D+1,oe=U[te];if(0>i(K,fe))te<w&&0>i(oe,K)?(U[Q]=oe,U[te]=fe,Q=te):(U[Q]=K,U[D]=fe,Q=D);else if(te<w&&0>i(oe,fe))U[Q]=oe,U[te]=fe,Q=te;else break e}}return ee}function i(U,ee){var fe=U.sortIndex-ee.sortIndex;return fe!==0?fe:U.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],f=1,g=null,v=3,m=!1,E=!1,A=!1,C=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O(U){for(var ee=n(u);ee!==null;){if(ee.callback===null)r(u);else if(ee.startTime<=U)r(u),ee.sortIndex=ee.expirationTime,e(c,ee);else break;ee=n(u)}}function V(U){if(A=!1,O(U),!E)if(n(c)!==null)E=!0,Y(ne);else{var ee=n(u);ee!==null&&M(V,ee.startTime-U)}}function ne(U,ee){E=!1,A&&(A=!1,b(T),T=-1),m=!0;var fe=v;try{for(O(ee),g=n(c);g!==null&&(!(g.expirationTime>ee)||U&&!S());){var Q=g.callback;if(typeof Q=="function"){g.callback=null,v=g.priorityLevel;var w=Q(g.expirationTime<=ee);ee=t.unstable_now(),typeof w=="function"?g.callback=w:g===n(c)&&r(c),O(ee)}else r(c);g=n(c)}if(g!==null)var F=!0;else{var D=n(u);D!==null&&M(V,D.startTime-ee),F=!1}return F}finally{g=null,v=fe,m=!1}}var le=!1,z=null,T=-1,k=5,N=-1;function S(){return!(t.unstable_now()-N<k)}function P(){if(z!==null){var U=t.unstable_now();N=U;var ee=!0;try{ee=z(!0,U)}finally{ee?R():(le=!1,z=null)}}else le=!1}var R;if(typeof I=="function")R=function(){I(P)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,H=$.port2;$.port1.onmessage=P,R=function(){H.postMessage(null)}}else R=function(){C(P,0)};function Y(U){z=U,le||(le=!0,R())}function M(U,ee){T=C(function(){U(t.unstable_now())},ee)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(U){U.callback=null},t.unstable_continueExecution=function(){E||m||(E=!0,Y(ne))},t.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<U?Math.floor(1e3/U):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(U){switch(v){case 1:case 2:case 3:var ee=3;break;default:ee=v}var fe=v;v=ee;try{return U()}finally{v=fe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(U,ee){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var fe=v;v=U;try{return ee()}finally{v=fe}},t.unstable_scheduleCallback=function(U,ee,fe){var Q=t.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?Q+fe:Q):fe=Q,U){case 1:var w=-1;break;case 2:w=250;break;case 5:w=1073741823;break;case 4:w=1e4;break;default:w=5e3}return w=fe+w,U={id:f++,callback:ee,priorityLevel:U,startTime:fe,expirationTime:w,sortIndex:-1},fe>Q?(U.sortIndex=fe,e(u,U),n(c)===null&&U===n(u)&&(A?(b(T),T=-1):A=!0,M(V,fe-Q))):(U.sortIndex=w,e(c,U),E||m||(E=!0,Y(ne))),U},t.unstable_shouldYield=S,t.unstable_wrapCallback=function(U){var ee=v;return function(){var fe=v;v=ee;try{return U.apply(this,arguments)}finally{v=fe}}}})(Fw);Ow.exports=Fw;var cA=Ow.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uA=ue,Ji=cA;function Fe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Vw=new Set,$d={};function vc(t,e){pu(t,e),pu(t+"Capture",e)}function pu(t,e){for($d[t]=e,t=0;t<e.length;t++)Vw.add(e[t])}var Za=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),E0=Object.prototype.hasOwnProperty,dA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,D2={},M2={};function hA(t){return E0.call(M2,t)?!0:E0.call(D2,t)?!1:dA.test(t)?M2[t]=!0:(D2[t]=!0,!1)}function fA(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function mA(t,e,n,r){if(e===null||typeof e>"u"||fA(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function pi(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Vr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vr[t]=new pi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vr[e]=new pi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vr[t]=new pi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vr[t]=new pi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vr[t]=new pi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vr[t]=new pi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vr[t]=new pi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vr[t]=new pi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vr[t]=new pi(t,5,!1,t.toLowerCase(),null,!1,!1)});var rv=/[\-:]([a-z])/g;function iv(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(rv,iv);Vr[e]=new pi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(rv,iv);Vr[e]=new pi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(rv,iv);Vr[e]=new pi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vr[t]=new pi(t,1,!1,t.toLowerCase(),null,!1,!1)});Vr.xlinkHref=new pi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vr[t]=new pi(t,1,!1,t.toLowerCase(),null,!0,!0)});function sv(t,e,n,r){var i=Vr.hasOwnProperty(e)?Vr[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(mA(e,n,i,r)&&(n=null),r||i===null?hA(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var co=uA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,lf=Symbol.for("react.element"),Uc=Symbol.for("react.portal"),Bc=Symbol.for("react.fragment"),av=Symbol.for("react.strict_mode"),A0=Symbol.for("react.profiler"),Uw=Symbol.for("react.provider"),Bw=Symbol.for("react.context"),ov=Symbol.for("react.forward_ref"),j0=Symbol.for("react.suspense"),T0=Symbol.for("react.suspense_list"),lv=Symbol.for("react.memo"),Vo=Symbol.for("react.lazy"),zw=Symbol.for("react.offscreen"),O2=Symbol.iterator;function od(t){return t===null||typeof t!="object"?null:(t=O2&&t[O2]||t["@@iterator"],typeof t=="function"?t:null)}var qn=Object.assign,xg;function yd(t){if(xg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);xg=e&&e[1]||""}return`
`+xg+t}var bg=!1;function wg(t,e){if(!t||bg)return"";bg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{bg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?yd(t):""}function pA(t){switch(t.tag){case 5:return yd(t.type);case 16:return yd("Lazy");case 13:return yd("Suspense");case 19:return yd("SuspenseList");case 0:case 2:case 15:return t=wg(t.type,!1),t;case 11:return t=wg(t.type.render,!1),t;case 1:return t=wg(t.type,!0),t;default:return""}}function k0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Bc:return"Fragment";case Uc:return"Portal";case A0:return"Profiler";case av:return"StrictMode";case j0:return"Suspense";case T0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Bw:return(t.displayName||"Context")+".Consumer";case Uw:return(t._context.displayName||"Context")+".Provider";case ov:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case lv:return e=t.displayName||null,e!==null?e:k0(t.type)||"Memo";case Vo:e=t._payload,t=t._init;try{return k0(t(e))}catch{}}return null}function gA(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return k0(e);case 8:return e===av?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function cl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function qw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function vA(t){var e=qw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function cf(t){t._valueTracker||(t._valueTracker=vA(t))}function $w(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=qw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function fm(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function C0(t,e){var n=e.checked;return qn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function F2(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=cl(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Hw(t,e){e=e.checked,e!=null&&sv(t,"checked",e,!1)}function I0(t,e){Hw(t,e);var n=cl(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?P0(t,e.type,n):e.hasOwnProperty("defaultValue")&&P0(t,e.type,cl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function V2(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function P0(t,e,n){(e!=="number"||fm(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var xd=Array.isArray;function eu(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+cl(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function R0(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Fe(91));return qn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function U2(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Fe(92));if(xd(n)){if(1<n.length)throw Error(Fe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:cl(n)}}function Ww(t,e){var n=cl(e.value),r=cl(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function B2(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Gw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function L0(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Gw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var uf,Kw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(uf=uf||document.createElement("div"),uf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=uf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Hd(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Td={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},yA=["Webkit","ms","Moz","O"];Object.keys(Td).forEach(function(t){yA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Td[e]=Td[t]})});function Yw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Td.hasOwnProperty(t)&&Td[t]?(""+e).trim():e+"px"}function Qw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Yw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var xA=qn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function D0(t,e){if(e){if(xA[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Fe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Fe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Fe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Fe(62))}}function M0(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var O0=null;function cv(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var F0=null,tu=null,nu=null;function z2(t){if(t=_h(t)){if(typeof F0!="function")throw Error(Fe(280));var e=t.stateNode;e&&(e=gp(e),F0(t.stateNode,t.type,e))}}function Xw(t){tu?nu?nu.push(t):nu=[t]:tu=t}function Jw(){if(tu){var t=tu,e=nu;if(nu=tu=null,z2(t),e)for(t=0;t<e.length;t++)z2(e[t])}}function Zw(t,e){return t(e)}function e_(){}var _g=!1;function t_(t,e,n){if(_g)return t(e,n);_g=!0;try{return Zw(t,e,n)}finally{_g=!1,(tu!==null||nu!==null)&&(e_(),Jw())}}function Wd(t,e){var n=t.stateNode;if(n===null)return null;var r=gp(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Fe(231,e,typeof n));return n}var V0=!1;if(Za)try{var ld={};Object.defineProperty(ld,"passive",{get:function(){V0=!0}}),window.addEventListener("test",ld,ld),window.removeEventListener("test",ld,ld)}catch{V0=!1}function bA(t,e,n,r,i,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var kd=!1,mm=null,pm=!1,U0=null,wA={onError:function(t){kd=!0,mm=t}};function _A(t,e,n,r,i,s,o,l,c){kd=!1,mm=null,bA.apply(wA,arguments)}function NA(t,e,n,r,i,s,o,l,c){if(_A.apply(this,arguments),kd){if(kd){var u=mm;kd=!1,mm=null}else throw Error(Fe(198));pm||(pm=!0,U0=u)}}function yc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function n_(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function q2(t){if(yc(t)!==t)throw Error(Fe(188))}function SA(t){var e=t.alternate;if(!e){if(e=yc(t),e===null)throw Error(Fe(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return q2(i),t;if(s===r)return q2(i),e;s=s.sibling}throw Error(Fe(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(Fe(189))}}if(n.alternate!==r)throw Error(Fe(190))}if(n.tag!==3)throw Error(Fe(188));return n.stateNode.current===n?t:e}function r_(t){return t=SA(t),t!==null?i_(t):null}function i_(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=i_(t);if(e!==null)return e;t=t.sibling}return null}var s_=Ji.unstable_scheduleCallback,$2=Ji.unstable_cancelCallback,EA=Ji.unstable_shouldYield,AA=Ji.unstable_requestPaint,ir=Ji.unstable_now,jA=Ji.unstable_getCurrentPriorityLevel,uv=Ji.unstable_ImmediatePriority,a_=Ji.unstable_UserBlockingPriority,gm=Ji.unstable_NormalPriority,TA=Ji.unstable_LowPriority,o_=Ji.unstable_IdlePriority,hp=null,da=null;function kA(t){if(da&&typeof da.onCommitFiberRoot=="function")try{da.onCommitFiberRoot(hp,t,void 0,(t.current.flags&128)===128)}catch{}}var Ls=Math.clz32?Math.clz32:PA,CA=Math.log,IA=Math.LN2;function PA(t){return t>>>=0,t===0?32:31-(CA(t)/IA|0)|0}var df=64,hf=4194304;function bd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function vm(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=bd(l):(s&=o,s!==0&&(r=bd(s)))}else o=n&~i,o!==0?r=bd(o):s!==0&&(r=bd(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ls(e),i=1<<n,r|=t[n],e&=~i;return r}function RA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function LA(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Ls(s),l=1<<o,c=i[o];c===-1?(!(l&n)||l&r)&&(i[o]=RA(l,e)):c<=e&&(t.expiredLanes|=l),s&=~l}}function B0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function l_(){var t=df;return df<<=1,!(df&4194240)&&(df=64),t}function Ng(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function bh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ls(e),t[e]=n}function DA(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ls(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function dv(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ls(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var fn=0;function c_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var u_,hv,d_,h_,f_,z0=!1,ff=[],Xo=null,Jo=null,Zo=null,Gd=new Map,Kd=new Map,Bo=[],MA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function H2(t,e){switch(t){case"focusin":case"focusout":Xo=null;break;case"dragenter":case"dragleave":Jo=null;break;case"mouseover":case"mouseout":Zo=null;break;case"pointerover":case"pointerout":Gd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kd.delete(e.pointerId)}}function cd(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=_h(e),e!==null&&hv(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function OA(t,e,n,r,i){switch(e){case"focusin":return Xo=cd(Xo,t,e,n,r,i),!0;case"dragenter":return Jo=cd(Jo,t,e,n,r,i),!0;case"mouseover":return Zo=cd(Zo,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Gd.set(s,cd(Gd.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Kd.set(s,cd(Kd.get(s)||null,t,e,n,r,i)),!0}return!1}function m_(t){var e=Gl(t.target);if(e!==null){var n=yc(e);if(n!==null){if(e=n.tag,e===13){if(e=n_(n),e!==null){t.blockedOn=e,f_(t.priority,function(){d_(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Bf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=q0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);O0=r,n.target.dispatchEvent(r),O0=null}else return e=_h(n),e!==null&&hv(e),t.blockedOn=n,!1;e.shift()}return!0}function W2(t,e,n){Bf(t)&&n.delete(e)}function FA(){z0=!1,Xo!==null&&Bf(Xo)&&(Xo=null),Jo!==null&&Bf(Jo)&&(Jo=null),Zo!==null&&Bf(Zo)&&(Zo=null),Gd.forEach(W2),Kd.forEach(W2)}function ud(t,e){t.blockedOn===e&&(t.blockedOn=null,z0||(z0=!0,Ji.unstable_scheduleCallback(Ji.unstable_NormalPriority,FA)))}function Yd(t){function e(i){return ud(i,t)}if(0<ff.length){ud(ff[0],t);for(var n=1;n<ff.length;n++){var r=ff[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Xo!==null&&ud(Xo,t),Jo!==null&&ud(Jo,t),Zo!==null&&ud(Zo,t),Gd.forEach(e),Kd.forEach(e),n=0;n<Bo.length;n++)r=Bo[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Bo.length&&(n=Bo[0],n.blockedOn===null);)m_(n),n.blockedOn===null&&Bo.shift()}var ru=co.ReactCurrentBatchConfig,ym=!0;function VA(t,e,n,r){var i=fn,s=ru.transition;ru.transition=null;try{fn=1,fv(t,e,n,r)}finally{fn=i,ru.transition=s}}function UA(t,e,n,r){var i=fn,s=ru.transition;ru.transition=null;try{fn=4,fv(t,e,n,r)}finally{fn=i,ru.transition=s}}function fv(t,e,n,r){if(ym){var i=q0(t,e,n,r);if(i===null)Rg(t,e,r,xm,n),H2(t,r);else if(OA(i,t,e,n,r))r.stopPropagation();else if(H2(t,r),e&4&&-1<MA.indexOf(t)){for(;i!==null;){var s=_h(i);if(s!==null&&u_(s),s=q0(t,e,n,r),s===null&&Rg(t,e,r,xm,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Rg(t,e,r,null,n)}}var xm=null;function q0(t,e,n,r){if(xm=null,t=cv(r),t=Gl(t),t!==null)if(e=yc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=n_(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return xm=t,null}function p_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jA()){case uv:return 1;case a_:return 4;case gm:case TA:return 16;case o_:return 536870912;default:return 16}default:return 16}}var Go=null,mv=null,zf=null;function g_(){if(zf)return zf;var t,e=mv,n=e.length,r,i="value"in Go?Go.value:Go.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return zf=i.slice(t,1<r?1-r:void 0)}function qf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function mf(){return!0}function G2(){return!1}function es(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?mf:G2,this.isPropagationStopped=G2,this}return qn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=mf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=mf)},persist:function(){},isPersistent:mf}),e}var Iu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pv=es(Iu),wh=qn({},Iu,{view:0,detail:0}),BA=es(wh),Sg,Eg,dd,fp=qn({},wh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gv,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==dd&&(dd&&t.type==="mousemove"?(Sg=t.screenX-dd.screenX,Eg=t.screenY-dd.screenY):Eg=Sg=0,dd=t),Sg)},movementY:function(t){return"movementY"in t?t.movementY:Eg}}),K2=es(fp),zA=qn({},fp,{dataTransfer:0}),qA=es(zA),$A=qn({},wh,{relatedTarget:0}),Ag=es($A),HA=qn({},Iu,{animationName:0,elapsedTime:0,pseudoElement:0}),WA=es(HA),GA=qn({},Iu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),KA=es(GA),YA=qn({},Iu,{data:0}),Y2=es(YA),QA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},XA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},JA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ZA(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=JA[t])?!!e[t]:!1}function gv(){return ZA}var ej=qn({},wh,{key:function(t){if(t.key){var e=QA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=qf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?XA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gv,charCode:function(t){return t.type==="keypress"?qf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?qf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),tj=es(ej),nj=qn({},fp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Q2=es(nj),rj=qn({},wh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gv}),ij=es(rj),sj=qn({},Iu,{propertyName:0,elapsedTime:0,pseudoElement:0}),aj=es(sj),oj=qn({},fp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),lj=es(oj),cj=[9,13,27,32],vv=Za&&"CompositionEvent"in window,Cd=null;Za&&"documentMode"in document&&(Cd=document.documentMode);var uj=Za&&"TextEvent"in window&&!Cd,v_=Za&&(!vv||Cd&&8<Cd&&11>=Cd),X2=" ",J2=!1;function y_(t,e){switch(t){case"keyup":return cj.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function x_(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var zc=!1;function dj(t,e){switch(t){case"compositionend":return x_(e);case"keypress":return e.which!==32?null:(J2=!0,X2);case"textInput":return t=e.data,t===X2&&J2?null:t;default:return null}}function hj(t,e){if(zc)return t==="compositionend"||!vv&&y_(t,e)?(t=g_(),zf=mv=Go=null,zc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return v_&&e.locale!=="ko"?null:e.data;default:return null}}var fj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Z2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!fj[t.type]:e==="textarea"}function b_(t,e,n,r){Xw(r),e=bm(e,"onChange"),0<e.length&&(n=new pv("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Id=null,Qd=null;function mj(t){I_(t,0)}function mp(t){var e=Hc(t);if($w(e))return t}function pj(t,e){if(t==="change")return e}var w_=!1;if(Za){var jg;if(Za){var Tg="oninput"in document;if(!Tg){var ex=document.createElement("div");ex.setAttribute("oninput","return;"),Tg=typeof ex.oninput=="function"}jg=Tg}else jg=!1;w_=jg&&(!document.documentMode||9<document.documentMode)}function tx(){Id&&(Id.detachEvent("onpropertychange",__),Qd=Id=null)}function __(t){if(t.propertyName==="value"&&mp(Qd)){var e=[];b_(e,Qd,t,cv(t)),t_(mj,e)}}function gj(t,e,n){t==="focusin"?(tx(),Id=e,Qd=n,Id.attachEvent("onpropertychange",__)):t==="focusout"&&tx()}function vj(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return mp(Qd)}function yj(t,e){if(t==="click")return mp(e)}function xj(t,e){if(t==="input"||t==="change")return mp(e)}function bj(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ms=typeof Object.is=="function"?Object.is:bj;function Xd(t,e){if(Ms(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!E0.call(e,i)||!Ms(t[i],e[i]))return!1}return!0}function nx(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function rx(t,e){var n=nx(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=nx(n)}}function N_(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?N_(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function S_(){for(var t=window,e=fm();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=fm(t.document)}return e}function yv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function wj(t){var e=S_(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&N_(n.ownerDocument.documentElement,n)){if(r!==null&&yv(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=rx(n,s);var o=rx(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var _j=Za&&"documentMode"in document&&11>=document.documentMode,qc=null,$0=null,Pd=null,H0=!1;function ix(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;H0||qc==null||qc!==fm(r)||(r=qc,"selectionStart"in r&&yv(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Pd&&Xd(Pd,r)||(Pd=r,r=bm($0,"onSelect"),0<r.length&&(e=new pv("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=qc)))}function pf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var $c={animationend:pf("Animation","AnimationEnd"),animationiteration:pf("Animation","AnimationIteration"),animationstart:pf("Animation","AnimationStart"),transitionend:pf("Transition","TransitionEnd")},kg={},E_={};Za&&(E_=document.createElement("div").style,"AnimationEvent"in window||(delete $c.animationend.animation,delete $c.animationiteration.animation,delete $c.animationstart.animation),"TransitionEvent"in window||delete $c.transitionend.transition);function pp(t){if(kg[t])return kg[t];if(!$c[t])return t;var e=$c[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in E_)return kg[t]=e[n];return t}var A_=pp("animationend"),j_=pp("animationiteration"),T_=pp("animationstart"),k_=pp("transitionend"),C_=new Map,sx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yl(t,e){C_.set(t,e),vc(e,[t])}for(var Cg=0;Cg<sx.length;Cg++){var Ig=sx[Cg],Nj=Ig.toLowerCase(),Sj=Ig[0].toUpperCase()+Ig.slice(1);yl(Nj,"on"+Sj)}yl(A_,"onAnimationEnd");yl(j_,"onAnimationIteration");yl(T_,"onAnimationStart");yl("dblclick","onDoubleClick");yl("focusin","onFocus");yl("focusout","onBlur");yl(k_,"onTransitionEnd");pu("onMouseEnter",["mouseout","mouseover"]);pu("onMouseLeave",["mouseout","mouseover"]);pu("onPointerEnter",["pointerout","pointerover"]);pu("onPointerLeave",["pointerout","pointerover"]);vc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vc("onBeforeInput",["compositionend","keypress","textInput","paste"]);vc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ej=new Set("cancel close invalid load scroll toggle".split(" ").concat(wd));function ax(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,NA(r,e,void 0,t),t.currentTarget=null}function I_(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;ax(i,l,u),s=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;ax(i,l,u),s=c}}}if(pm)throw t=U0,pm=!1,U0=null,t}function jn(t,e){var n=e[Q0];n===void 0&&(n=e[Q0]=new Set);var r=t+"__bubble";n.has(r)||(P_(e,t,2,!1),n.add(r))}function Pg(t,e,n){var r=0;e&&(r|=4),P_(n,t,r,e)}var gf="_reactListening"+Math.random().toString(36).slice(2);function Jd(t){if(!t[gf]){t[gf]=!0,Vw.forEach(function(n){n!=="selectionchange"&&(Ej.has(n)||Pg(n,!1,t),Pg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[gf]||(e[gf]=!0,Pg("selectionchange",!1,e))}}function P_(t,e,n,r){switch(p_(e)){case 1:var i=VA;break;case 4:i=UA;break;default:i=fv}n=i.bind(null,e,n,t),i=void 0,!V0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Rg(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Gl(l),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}l=l.parentNode}}r=r.return}t_(function(){var u=s,f=cv(n),g=[];e:{var v=C_.get(t);if(v!==void 0){var m=pv,E=t;switch(t){case"keypress":if(qf(n)===0)break e;case"keydown":case"keyup":m=tj;break;case"focusin":E="focus",m=Ag;break;case"focusout":E="blur",m=Ag;break;case"beforeblur":case"afterblur":m=Ag;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=K2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=qA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=ij;break;case A_:case j_:case T_:m=WA;break;case k_:m=aj;break;case"scroll":m=BA;break;case"wheel":m=lj;break;case"copy":case"cut":case"paste":m=KA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Q2}var A=(e&4)!==0,C=!A&&t==="scroll",b=A?v!==null?v+"Capture":null:v;A=[];for(var I=u,O;I!==null;){O=I;var V=O.stateNode;if(O.tag===5&&V!==null&&(O=V,b!==null&&(V=Wd(I,b),V!=null&&A.push(Zd(I,V,O)))),C)break;I=I.return}0<A.length&&(v=new m(v,E,null,n,f),g.push({event:v,listeners:A}))}}if(!(e&7)){e:{if(v=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",v&&n!==O0&&(E=n.relatedTarget||n.fromElement)&&(Gl(E)||E[eo]))break e;if((m||v)&&(v=f.window===f?f:(v=f.ownerDocument)?v.defaultView||v.parentWindow:window,m?(E=n.relatedTarget||n.toElement,m=u,E=E?Gl(E):null,E!==null&&(C=yc(E),E!==C||E.tag!==5&&E.tag!==6)&&(E=null)):(m=null,E=u),m!==E)){if(A=K2,V="onMouseLeave",b="onMouseEnter",I="mouse",(t==="pointerout"||t==="pointerover")&&(A=Q2,V="onPointerLeave",b="onPointerEnter",I="pointer"),C=m==null?v:Hc(m),O=E==null?v:Hc(E),v=new A(V,I+"leave",m,n,f),v.target=C,v.relatedTarget=O,V=null,Gl(f)===u&&(A=new A(b,I+"enter",E,n,f),A.target=O,A.relatedTarget=C,V=A),C=V,m&&E)t:{for(A=m,b=E,I=0,O=A;O;O=Ic(O))I++;for(O=0,V=b;V;V=Ic(V))O++;for(;0<I-O;)A=Ic(A),I--;for(;0<O-I;)b=Ic(b),O--;for(;I--;){if(A===b||b!==null&&A===b.alternate)break t;A=Ic(A),b=Ic(b)}A=null}else A=null;m!==null&&ox(g,v,m,A,!1),E!==null&&C!==null&&ox(g,C,E,A,!0)}}e:{if(v=u?Hc(u):window,m=v.nodeName&&v.nodeName.toLowerCase(),m==="select"||m==="input"&&v.type==="file")var ne=pj;else if(Z2(v))if(w_)ne=xj;else{ne=vj;var le=gj}else(m=v.nodeName)&&m.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(ne=yj);if(ne&&(ne=ne(t,u))){b_(g,ne,n,f);break e}le&&le(t,v,u),t==="focusout"&&(le=v._wrapperState)&&le.controlled&&v.type==="number"&&P0(v,"number",v.value)}switch(le=u?Hc(u):window,t){case"focusin":(Z2(le)||le.contentEditable==="true")&&(qc=le,$0=u,Pd=null);break;case"focusout":Pd=$0=qc=null;break;case"mousedown":H0=!0;break;case"contextmenu":case"mouseup":case"dragend":H0=!1,ix(g,n,f);break;case"selectionchange":if(_j)break;case"keydown":case"keyup":ix(g,n,f)}var z;if(vv)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else zc?y_(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(v_&&n.locale!=="ko"&&(zc||T!=="onCompositionStart"?T==="onCompositionEnd"&&zc&&(z=g_()):(Go=f,mv="value"in Go?Go.value:Go.textContent,zc=!0)),le=bm(u,T),0<le.length&&(T=new Y2(T,t,null,n,f),g.push({event:T,listeners:le}),z?T.data=z:(z=x_(n),z!==null&&(T.data=z)))),(z=uj?dj(t,n):hj(t,n))&&(u=bm(u,"onBeforeInput"),0<u.length&&(f=new Y2("onBeforeInput","beforeinput",null,n,f),g.push({event:f,listeners:u}),f.data=z))}I_(g,e)})}function Zd(t,e,n){return{instance:t,listener:e,currentTarget:n}}function bm(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Wd(t,n),s!=null&&r.unshift(Zd(t,s,i)),s=Wd(t,e),s!=null&&r.push(Zd(t,s,i))),t=t.return}return r}function Ic(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ox(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,i?(c=Wd(n,s),c!=null&&o.unshift(Zd(n,c,l))):i||(c=Wd(n,s),c!=null&&o.push(Zd(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Aj=/\r\n?/g,jj=/\u0000|\uFFFD/g;function lx(t){return(typeof t=="string"?t:""+t).replace(Aj,`
`).replace(jj,"")}function vf(t,e,n){if(e=lx(e),lx(t)!==e&&n)throw Error(Fe(425))}function wm(){}var W0=null,G0=null;function K0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Y0=typeof setTimeout=="function"?setTimeout:void 0,Tj=typeof clearTimeout=="function"?clearTimeout:void 0,cx=typeof Promise=="function"?Promise:void 0,kj=typeof queueMicrotask=="function"?queueMicrotask:typeof cx<"u"?function(t){return cx.resolve(null).then(t).catch(Cj)}:Y0;function Cj(t){setTimeout(function(){throw t})}function Lg(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Yd(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Yd(e)}function el(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ux(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Pu=Math.random().toString(36).slice(2),la="__reactFiber$"+Pu,eh="__reactProps$"+Pu,eo="__reactContainer$"+Pu,Q0="__reactEvents$"+Pu,Ij="__reactListeners$"+Pu,Pj="__reactHandles$"+Pu;function Gl(t){var e=t[la];if(e)return e;for(var n=t.parentNode;n;){if(e=n[eo]||n[la]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=ux(t);t!==null;){if(n=t[la])return n;t=ux(t)}return e}t=n,n=t.parentNode}return null}function _h(t){return t=t[la]||t[eo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Hc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Fe(33))}function gp(t){return t[eh]||null}var X0=[],Wc=-1;function xl(t){return{current:t}}function Cn(t){0>Wc||(t.current=X0[Wc],X0[Wc]=null,Wc--)}function Nn(t,e){Wc++,X0[Wc]=t.current,t.current=e}var ul={},ii=xl(ul),Ei=xl(!1),rc=ul;function gu(t,e){var n=t.type.contextTypes;if(!n)return ul;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Ai(t){return t=t.childContextTypes,t!=null}function _m(){Cn(Ei),Cn(ii)}function dx(t,e,n){if(ii.current!==ul)throw Error(Fe(168));Nn(ii,e),Nn(Ei,n)}function R_(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Fe(108,gA(t)||"Unknown",i));return qn({},n,r)}function Nm(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ul,rc=ii.current,Nn(ii,t),Nn(Ei,Ei.current),!0}function hx(t,e,n){var r=t.stateNode;if(!r)throw Error(Fe(169));n?(t=R_(t,e,rc),r.__reactInternalMemoizedMergedChildContext=t,Cn(Ei),Cn(ii),Nn(ii,t)):Cn(Ei),Nn(Ei,n)}var za=null,vp=!1,Dg=!1;function L_(t){za===null?za=[t]:za.push(t)}function Rj(t){vp=!0,L_(t)}function bl(){if(!Dg&&za!==null){Dg=!0;var t=0,e=fn;try{var n=za;for(fn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}za=null,vp=!1}catch(i){throw za!==null&&(za=za.slice(t+1)),s_(uv,bl),i}finally{fn=e,Dg=!1}}return null}var Gc=[],Kc=0,Sm=null,Em=0,cs=[],us=0,ic=null,$a=1,Ha="";function zl(t,e){Gc[Kc++]=Em,Gc[Kc++]=Sm,Sm=t,Em=e}function D_(t,e,n){cs[us++]=$a,cs[us++]=Ha,cs[us++]=ic,ic=t;var r=$a;t=Ha;var i=32-Ls(r)-1;r&=~(1<<i),n+=1;var s=32-Ls(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,$a=1<<32-Ls(e)+i|n<<i|r,Ha=s+t}else $a=1<<s|n<<i|r,Ha=t}function xv(t){t.return!==null&&(zl(t,1),D_(t,1,0))}function bv(t){for(;t===Sm;)Sm=Gc[--Kc],Gc[Kc]=null,Em=Gc[--Kc],Gc[Kc]=null;for(;t===ic;)ic=cs[--us],cs[us]=null,Ha=cs[--us],cs[us]=null,$a=cs[--us],cs[us]=null}var Qi=null,Gi=null,Dn=!1,Ps=null;function M_(t,e){var n=hs(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function fx(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Qi=t,Gi=el(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Qi=t,Gi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ic!==null?{id:$a,overflow:Ha}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=hs(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Qi=t,Gi=null,!0):!1;default:return!1}}function J0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Z0(t){if(Dn){var e=Gi;if(e){var n=e;if(!fx(t,e)){if(J0(t))throw Error(Fe(418));e=el(n.nextSibling);var r=Qi;e&&fx(t,e)?M_(r,n):(t.flags=t.flags&-4097|2,Dn=!1,Qi=t)}}else{if(J0(t))throw Error(Fe(418));t.flags=t.flags&-4097|2,Dn=!1,Qi=t}}}function mx(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Qi=t}function yf(t){if(t!==Qi)return!1;if(!Dn)return mx(t),Dn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!K0(t.type,t.memoizedProps)),e&&(e=Gi)){if(J0(t))throw O_(),Error(Fe(418));for(;e;)M_(t,e),e=el(e.nextSibling)}if(mx(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Fe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Gi=el(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Gi=null}}else Gi=Qi?el(t.stateNode.nextSibling):null;return!0}function O_(){for(var t=Gi;t;)t=el(t.nextSibling)}function vu(){Gi=Qi=null,Dn=!1}function wv(t){Ps===null?Ps=[t]:Ps.push(t)}var Lj=co.ReactCurrentBatchConfig;function hd(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Fe(309));var r=n.stateNode}if(!r)throw Error(Fe(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Fe(284));if(!n._owner)throw Error(Fe(290,t))}return t}function xf(t,e){throw t=Object.prototype.toString.call(e),Error(Fe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function px(t){var e=t._init;return e(t._payload)}function F_(t){function e(b,I){if(t){var O=b.deletions;O===null?(b.deletions=[I],b.flags|=16):O.push(I)}}function n(b,I){if(!t)return null;for(;I!==null;)e(b,I),I=I.sibling;return null}function r(b,I){for(b=new Map;I!==null;)I.key!==null?b.set(I.key,I):b.set(I.index,I),I=I.sibling;return b}function i(b,I){return b=il(b,I),b.index=0,b.sibling=null,b}function s(b,I,O){return b.index=O,t?(O=b.alternate,O!==null?(O=O.index,O<I?(b.flags|=2,I):O):(b.flags|=2,I)):(b.flags|=1048576,I)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function l(b,I,O,V){return I===null||I.tag!==6?(I=zg(O,b.mode,V),I.return=b,I):(I=i(I,O),I.return=b,I)}function c(b,I,O,V){var ne=O.type;return ne===Bc?f(b,I,O.props.children,V,O.key):I!==null&&(I.elementType===ne||typeof ne=="object"&&ne!==null&&ne.$$typeof===Vo&&px(ne)===I.type)?(V=i(I,O.props),V.ref=hd(b,I,O),V.return=b,V):(V=Qf(O.type,O.key,O.props,null,b.mode,V),V.ref=hd(b,I,O),V.return=b,V)}function u(b,I,O,V){return I===null||I.tag!==4||I.stateNode.containerInfo!==O.containerInfo||I.stateNode.implementation!==O.implementation?(I=qg(O,b.mode,V),I.return=b,I):(I=i(I,O.children||[]),I.return=b,I)}function f(b,I,O,V,ne){return I===null||I.tag!==7?(I=Zl(O,b.mode,V,ne),I.return=b,I):(I=i(I,O),I.return=b,I)}function g(b,I,O){if(typeof I=="string"&&I!==""||typeof I=="number")return I=zg(""+I,b.mode,O),I.return=b,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case lf:return O=Qf(I.type,I.key,I.props,null,b.mode,O),O.ref=hd(b,null,I),O.return=b,O;case Uc:return I=qg(I,b.mode,O),I.return=b,I;case Vo:var V=I._init;return g(b,V(I._payload),O)}if(xd(I)||od(I))return I=Zl(I,b.mode,O,null),I.return=b,I;xf(b,I)}return null}function v(b,I,O,V){var ne=I!==null?I.key:null;if(typeof O=="string"&&O!==""||typeof O=="number")return ne!==null?null:l(b,I,""+O,V);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case lf:return O.key===ne?c(b,I,O,V):null;case Uc:return O.key===ne?u(b,I,O,V):null;case Vo:return ne=O._init,v(b,I,ne(O._payload),V)}if(xd(O)||od(O))return ne!==null?null:f(b,I,O,V,null);xf(b,O)}return null}function m(b,I,O,V,ne){if(typeof V=="string"&&V!==""||typeof V=="number")return b=b.get(O)||null,l(I,b,""+V,ne);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case lf:return b=b.get(V.key===null?O:V.key)||null,c(I,b,V,ne);case Uc:return b=b.get(V.key===null?O:V.key)||null,u(I,b,V,ne);case Vo:var le=V._init;return m(b,I,O,le(V._payload),ne)}if(xd(V)||od(V))return b=b.get(O)||null,f(I,b,V,ne,null);xf(I,V)}return null}function E(b,I,O,V){for(var ne=null,le=null,z=I,T=I=0,k=null;z!==null&&T<O.length;T++){z.index>T?(k=z,z=null):k=z.sibling;var N=v(b,z,O[T],V);if(N===null){z===null&&(z=k);break}t&&z&&N.alternate===null&&e(b,z),I=s(N,I,T),le===null?ne=N:le.sibling=N,le=N,z=k}if(T===O.length)return n(b,z),Dn&&zl(b,T),ne;if(z===null){for(;T<O.length;T++)z=g(b,O[T],V),z!==null&&(I=s(z,I,T),le===null?ne=z:le.sibling=z,le=z);return Dn&&zl(b,T),ne}for(z=r(b,z);T<O.length;T++)k=m(z,b,T,O[T],V),k!==null&&(t&&k.alternate!==null&&z.delete(k.key===null?T:k.key),I=s(k,I,T),le===null?ne=k:le.sibling=k,le=k);return t&&z.forEach(function(S){return e(b,S)}),Dn&&zl(b,T),ne}function A(b,I,O,V){var ne=od(O);if(typeof ne!="function")throw Error(Fe(150));if(O=ne.call(O),O==null)throw Error(Fe(151));for(var le=ne=null,z=I,T=I=0,k=null,N=O.next();z!==null&&!N.done;T++,N=O.next()){z.index>T?(k=z,z=null):k=z.sibling;var S=v(b,z,N.value,V);if(S===null){z===null&&(z=k);break}t&&z&&S.alternate===null&&e(b,z),I=s(S,I,T),le===null?ne=S:le.sibling=S,le=S,z=k}if(N.done)return n(b,z),Dn&&zl(b,T),ne;if(z===null){for(;!N.done;T++,N=O.next())N=g(b,N.value,V),N!==null&&(I=s(N,I,T),le===null?ne=N:le.sibling=N,le=N);return Dn&&zl(b,T),ne}for(z=r(b,z);!N.done;T++,N=O.next())N=m(z,b,T,N.value,V),N!==null&&(t&&N.alternate!==null&&z.delete(N.key===null?T:N.key),I=s(N,I,T),le===null?ne=N:le.sibling=N,le=N);return t&&z.forEach(function(P){return e(b,P)}),Dn&&zl(b,T),ne}function C(b,I,O,V){if(typeof O=="object"&&O!==null&&O.type===Bc&&O.key===null&&(O=O.props.children),typeof O=="object"&&O!==null){switch(O.$$typeof){case lf:e:{for(var ne=O.key,le=I;le!==null;){if(le.key===ne){if(ne=O.type,ne===Bc){if(le.tag===7){n(b,le.sibling),I=i(le,O.props.children),I.return=b,b=I;break e}}else if(le.elementType===ne||typeof ne=="object"&&ne!==null&&ne.$$typeof===Vo&&px(ne)===le.type){n(b,le.sibling),I=i(le,O.props),I.ref=hd(b,le,O),I.return=b,b=I;break e}n(b,le);break}else e(b,le);le=le.sibling}O.type===Bc?(I=Zl(O.props.children,b.mode,V,O.key),I.return=b,b=I):(V=Qf(O.type,O.key,O.props,null,b.mode,V),V.ref=hd(b,I,O),V.return=b,b=V)}return o(b);case Uc:e:{for(le=O.key;I!==null;){if(I.key===le)if(I.tag===4&&I.stateNode.containerInfo===O.containerInfo&&I.stateNode.implementation===O.implementation){n(b,I.sibling),I=i(I,O.children||[]),I.return=b,b=I;break e}else{n(b,I);break}else e(b,I);I=I.sibling}I=qg(O,b.mode,V),I.return=b,b=I}return o(b);case Vo:return le=O._init,C(b,I,le(O._payload),V)}if(xd(O))return E(b,I,O,V);if(od(O))return A(b,I,O,V);xf(b,O)}return typeof O=="string"&&O!==""||typeof O=="number"?(O=""+O,I!==null&&I.tag===6?(n(b,I.sibling),I=i(I,O),I.return=b,b=I):(n(b,I),I=zg(O,b.mode,V),I.return=b,b=I),o(b)):n(b,I)}return C}var yu=F_(!0),V_=F_(!1),Am=xl(null),jm=null,Yc=null,_v=null;function Nv(){_v=Yc=jm=null}function Sv(t){var e=Am.current;Cn(Am),t._currentValue=e}function e1(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function iu(t,e){jm=t,_v=Yc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Si=!0),t.firstContext=null)}function gs(t){var e=t._currentValue;if(_v!==t)if(t={context:t,memoizedValue:e,next:null},Yc===null){if(jm===null)throw Error(Fe(308));Yc=t,jm.dependencies={lanes:0,firstContext:t}}else Yc=Yc.next=t;return e}var Kl=null;function Ev(t){Kl===null?Kl=[t]:Kl.push(t)}function U_(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Ev(e)):(n.next=i.next,i.next=n),e.interleaved=n,to(t,r)}function to(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Uo=!1;function Av(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function B_(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ya(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function tl(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Jt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,to(t,n)}return i=r.interleaved,i===null?(e.next=e,Ev(r)):(e.next=i.next,i.next=e),r.interleaved=e,to(t,n)}function $f(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,dv(t,n)}}function gx(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Tm(t,e,n,r){var i=t.updateQueue;Uo=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=c))}if(s!==null){var g=i.baseState;o=0,f=u=c=null,l=s;do{var v=l.lane,m=l.eventTime;if((r&v)===v){f!==null&&(f=f.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var E=t,A=l;switch(v=e,m=n,A.tag){case 1:if(E=A.payload,typeof E=="function"){g=E.call(m,g,v);break e}g=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=A.payload,v=typeof E=="function"?E.call(m,g,v):E,v==null)break e;g=qn({},g,v);break e;case 2:Uo=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,v=i.effects,v===null?i.effects=[l]:v.push(l))}else m={eventTime:m,lane:v,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(u=f=m,c=g):f=f.next=m,o|=v;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;v=l,l=v.next,v.next=null,i.lastBaseUpdate=v,i.shared.pending=null}}while(!0);if(f===null&&(c=g),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ac|=o,t.lanes=o,t.memoizedState=g}}function vx(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Fe(191,i));i.call(r)}}}var Nh={},ha=xl(Nh),th=xl(Nh),nh=xl(Nh);function Yl(t){if(t===Nh)throw Error(Fe(174));return t}function jv(t,e){switch(Nn(nh,e),Nn(th,t),Nn(ha,Nh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:L0(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=L0(e,t)}Cn(ha),Nn(ha,e)}function xu(){Cn(ha),Cn(th),Cn(nh)}function z_(t){Yl(nh.current);var e=Yl(ha.current),n=L0(e,t.type);e!==n&&(Nn(th,t),Nn(ha,n))}function Tv(t){th.current===t&&(Cn(ha),Cn(th))}var Bn=xl(0);function km(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Mg=[];function kv(){for(var t=0;t<Mg.length;t++)Mg[t]._workInProgressVersionPrimary=null;Mg.length=0}var Hf=co.ReactCurrentDispatcher,Og=co.ReactCurrentBatchConfig,sc=0,zn=null,yr=null,Ar=null,Cm=!1,Rd=!1,rh=0,Dj=0;function Wr(){throw Error(Fe(321))}function Cv(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ms(t[n],e[n]))return!1;return!0}function Iv(t,e,n,r,i,s){if(sc=s,zn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Hf.current=t===null||t.memoizedState===null?Vj:Uj,t=n(r,i),Rd){s=0;do{if(Rd=!1,rh=0,25<=s)throw Error(Fe(301));s+=1,Ar=yr=null,e.updateQueue=null,Hf.current=Bj,t=n(r,i)}while(Rd)}if(Hf.current=Im,e=yr!==null&&yr.next!==null,sc=0,Ar=yr=zn=null,Cm=!1,e)throw Error(Fe(300));return t}function Pv(){var t=rh!==0;return rh=0,t}function oa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ar===null?zn.memoizedState=Ar=t:Ar=Ar.next=t,Ar}function vs(){if(yr===null){var t=zn.alternate;t=t!==null?t.memoizedState:null}else t=yr.next;var e=Ar===null?zn.memoizedState:Ar.next;if(e!==null)Ar=e,yr=t;else{if(t===null)throw Error(Fe(310));yr=t,t={memoizedState:yr.memoizedState,baseState:yr.baseState,baseQueue:yr.baseQueue,queue:yr.queue,next:null},Ar===null?zn.memoizedState=Ar=t:Ar=Ar.next=t}return Ar}function ih(t,e){return typeof e=="function"?e(t):e}function Fg(t){var e=vs(),n=e.queue;if(n===null)throw Error(Fe(311));n.lastRenderedReducer=t;var r=yr,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,c=null,u=s;do{var f=u.lane;if((sc&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var g={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=g,o=r):c=c.next=g,zn.lanes|=f,ac|=f}u=u.next}while(u!==null&&u!==s);c===null?o=r:c.next=l,Ms(r,e.memoizedState)||(Si=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,zn.lanes|=s,ac|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Vg(t){var e=vs(),n=e.queue;if(n===null)throw Error(Fe(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Ms(s,e.memoizedState)||(Si=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function q_(){}function $_(t,e){var n=zn,r=vs(),i=e(),s=!Ms(r.memoizedState,i);if(s&&(r.memoizedState=i,Si=!0),r=r.queue,Rv(G_.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Ar!==null&&Ar.memoizedState.tag&1){if(n.flags|=2048,sh(9,W_.bind(null,n,r,i,e),void 0,null),Tr===null)throw Error(Fe(349));sc&30||H_(n,e,i)}return i}function H_(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=zn.updateQueue,e===null?(e={lastEffect:null,stores:null},zn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function W_(t,e,n,r){e.value=n,e.getSnapshot=r,K_(e)&&Y_(t)}function G_(t,e,n){return n(function(){K_(e)&&Y_(t)})}function K_(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ms(t,n)}catch{return!0}}function Y_(t){var e=to(t,1);e!==null&&Ds(e,t,1,-1)}function yx(t){var e=oa();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ih,lastRenderedState:t},e.queue=t,t=t.dispatch=Fj.bind(null,zn,t),[e.memoizedState,t]}function sh(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=zn.updateQueue,e===null?(e={lastEffect:null,stores:null},zn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Q_(){return vs().memoizedState}function Wf(t,e,n,r){var i=oa();zn.flags|=t,i.memoizedState=sh(1|e,n,void 0,r===void 0?null:r)}function yp(t,e,n,r){var i=vs();r=r===void 0?null:r;var s=void 0;if(yr!==null){var o=yr.memoizedState;if(s=o.destroy,r!==null&&Cv(r,o.deps)){i.memoizedState=sh(e,n,s,r);return}}zn.flags|=t,i.memoizedState=sh(1|e,n,s,r)}function xx(t,e){return Wf(8390656,8,t,e)}function Rv(t,e){return yp(2048,8,t,e)}function X_(t,e){return yp(4,2,t,e)}function J_(t,e){return yp(4,4,t,e)}function Z_(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function eN(t,e,n){return n=n!=null?n.concat([t]):null,yp(4,4,Z_.bind(null,e,t),n)}function Lv(){}function tN(t,e){var n=vs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Cv(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function nN(t,e){var n=vs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Cv(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function rN(t,e,n){return sc&21?(Ms(n,e)||(n=l_(),zn.lanes|=n,ac|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Si=!0),t.memoizedState=n)}function Mj(t,e){var n=fn;fn=n!==0&&4>n?n:4,t(!0);var r=Og.transition;Og.transition={};try{t(!1),e()}finally{fn=n,Og.transition=r}}function iN(){return vs().memoizedState}function Oj(t,e,n){var r=rl(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},sN(t))aN(e,n);else if(n=U_(t,e,n,r),n!==null){var i=fi();Ds(n,t,r,i),oN(n,e,r)}}function Fj(t,e,n){var r=rl(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(sN(t))aN(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,n);if(i.hasEagerState=!0,i.eagerState=l,Ms(l,o)){var c=e.interleaved;c===null?(i.next=i,Ev(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=U_(t,e,i,r),n!==null&&(i=fi(),Ds(n,t,r,i),oN(n,e,r))}}function sN(t){var e=t.alternate;return t===zn||e!==null&&e===zn}function aN(t,e){Rd=Cm=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function oN(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,dv(t,n)}}var Im={readContext:gs,useCallback:Wr,useContext:Wr,useEffect:Wr,useImperativeHandle:Wr,useInsertionEffect:Wr,useLayoutEffect:Wr,useMemo:Wr,useReducer:Wr,useRef:Wr,useState:Wr,useDebugValue:Wr,useDeferredValue:Wr,useTransition:Wr,useMutableSource:Wr,useSyncExternalStore:Wr,useId:Wr,unstable_isNewReconciler:!1},Vj={readContext:gs,useCallback:function(t,e){return oa().memoizedState=[t,e===void 0?null:e],t},useContext:gs,useEffect:xx,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Wf(4194308,4,Z_.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Wf(4194308,4,t,e)},useInsertionEffect:function(t,e){return Wf(4,2,t,e)},useMemo:function(t,e){var n=oa();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=oa();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Oj.bind(null,zn,t),[r.memoizedState,t]},useRef:function(t){var e=oa();return t={current:t},e.memoizedState=t},useState:yx,useDebugValue:Lv,useDeferredValue:function(t){return oa().memoizedState=t},useTransition:function(){var t=yx(!1),e=t[0];return t=Mj.bind(null,t[1]),oa().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=zn,i=oa();if(Dn){if(n===void 0)throw Error(Fe(407));n=n()}else{if(n=e(),Tr===null)throw Error(Fe(349));sc&30||H_(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,xx(G_.bind(null,r,s,t),[t]),r.flags|=2048,sh(9,W_.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=oa(),e=Tr.identifierPrefix;if(Dn){var n=Ha,r=$a;n=(r&~(1<<32-Ls(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=rh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Dj++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Uj={readContext:gs,useCallback:tN,useContext:gs,useEffect:Rv,useImperativeHandle:eN,useInsertionEffect:X_,useLayoutEffect:J_,useMemo:nN,useReducer:Fg,useRef:Q_,useState:function(){return Fg(ih)},useDebugValue:Lv,useDeferredValue:function(t){var e=vs();return rN(e,yr.memoizedState,t)},useTransition:function(){var t=Fg(ih)[0],e=vs().memoizedState;return[t,e]},useMutableSource:q_,useSyncExternalStore:$_,useId:iN,unstable_isNewReconciler:!1},Bj={readContext:gs,useCallback:tN,useContext:gs,useEffect:Rv,useImperativeHandle:eN,useInsertionEffect:X_,useLayoutEffect:J_,useMemo:nN,useReducer:Vg,useRef:Q_,useState:function(){return Vg(ih)},useDebugValue:Lv,useDeferredValue:function(t){var e=vs();return yr===null?e.memoizedState=t:rN(e,yr.memoizedState,t)},useTransition:function(){var t=Vg(ih)[0],e=vs().memoizedState;return[t,e]},useMutableSource:q_,useSyncExternalStore:$_,useId:iN,unstable_isNewReconciler:!1};function Cs(t,e){if(t&&t.defaultProps){e=qn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function t1(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:qn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var xp={isMounted:function(t){return(t=t._reactInternals)?yc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=fi(),i=rl(t),s=Ya(r,i);s.payload=e,n!=null&&(s.callback=n),e=tl(t,s,i),e!==null&&(Ds(e,t,i,r),$f(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=fi(),i=rl(t),s=Ya(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=tl(t,s,i),e!==null&&(Ds(e,t,i,r),$f(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=fi(),r=rl(t),i=Ya(n,r);i.tag=2,e!=null&&(i.callback=e),e=tl(t,i,r),e!==null&&(Ds(e,t,r,n),$f(e,t,r))}};function bx(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Xd(n,r)||!Xd(i,s):!0}function lN(t,e,n){var r=!1,i=ul,s=e.contextType;return typeof s=="object"&&s!==null?s=gs(s):(i=Ai(e)?rc:ii.current,r=e.contextTypes,s=(r=r!=null)?gu(t,i):ul),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=xp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function wx(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&xp.enqueueReplaceState(e,e.state,null)}function n1(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Av(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=gs(s):(s=Ai(e)?rc:ii.current,i.context=gu(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(t1(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&xp.enqueueReplaceState(i,i.state,null),Tm(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function bu(t,e){try{var n="",r=e;do n+=pA(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Ug(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function r1(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var zj=typeof WeakMap=="function"?WeakMap:Map;function cN(t,e,n){n=Ya(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Rm||(Rm=!0,f1=r),r1(t,e)},n}function uN(t,e,n){n=Ya(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){r1(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){r1(t,e),typeof r!="function"&&(nl===null?nl=new Set([this]):nl.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function _x(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new zj;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=nT.bind(null,t,e,n),e.then(t,t))}function Nx(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Sx(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ya(-1,1),e.tag=2,tl(n,e,1))),n.lanes|=1),t)}var qj=co.ReactCurrentOwner,Si=!1;function hi(t,e,n,r){e.child=t===null?V_(e,null,n,r):yu(e,t.child,n,r)}function Ex(t,e,n,r,i){n=n.render;var s=e.ref;return iu(e,i),r=Iv(t,e,n,r,s,i),n=Pv(),t!==null&&!Si?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,no(t,e,i)):(Dn&&n&&xv(e),e.flags|=1,hi(t,e,r,i),e.child)}function Ax(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!zv(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,dN(t,e,s,r,i)):(t=Qf(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Xd,n(o,r)&&t.ref===e.ref)return no(t,e,i)}return e.flags|=1,t=il(s,r),t.ref=e.ref,t.return=e,e.child=t}function dN(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Xd(s,r)&&t.ref===e.ref)if(Si=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Si=!0);else return e.lanes=t.lanes,no(t,e,i)}return i1(t,e,n,r,i)}function hN(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Nn(Xc,Wi),Wi|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Nn(Xc,Wi),Wi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Nn(Xc,Wi),Wi|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Nn(Xc,Wi),Wi|=r;return hi(t,e,i,n),e.child}function fN(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function i1(t,e,n,r,i){var s=Ai(n)?rc:ii.current;return s=gu(e,s),iu(e,i),n=Iv(t,e,n,r,s,i),r=Pv(),t!==null&&!Si?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,no(t,e,i)):(Dn&&r&&xv(e),e.flags|=1,hi(t,e,n,i),e.child)}function jx(t,e,n,r,i){if(Ai(n)){var s=!0;Nm(e)}else s=!1;if(iu(e,i),e.stateNode===null)Gf(t,e),lN(e,n,r),n1(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=gs(u):(u=Ai(n)?rc:ii.current,u=gu(e,u));var f=n.getDerivedStateFromProps,g=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";g||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&wx(e,o,r,u),Uo=!1;var v=e.memoizedState;o.state=v,Tm(e,r,o,i),c=e.memoizedState,l!==r||v!==c||Ei.current||Uo?(typeof f=="function"&&(t1(e,n,f,r),c=e.memoizedState),(l=Uo||bx(e,n,l,r,v,c,u))?(g||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,B_(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Cs(e.type,l),o.props=u,g=e.pendingProps,v=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=gs(c):(c=Ai(n)?rc:ii.current,c=gu(e,c));var m=n.getDerivedStateFromProps;(f=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==g||v!==c)&&wx(e,o,r,c),Uo=!1,v=e.memoizedState,o.state=v,Tm(e,r,o,i);var E=e.memoizedState;l!==g||v!==E||Ei.current||Uo?(typeof m=="function"&&(t1(e,n,m,r),E=e.memoizedState),(u=Uo||bx(e,n,u,r,v,E,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),r=!1)}return s1(t,e,n,r,s,i)}function s1(t,e,n,r,i,s){fN(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&hx(e,n,!1),no(t,e,s);r=e.stateNode,qj.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=yu(e,t.child,null,s),e.child=yu(e,null,l,s)):hi(t,e,l,s),e.memoizedState=r.state,i&&hx(e,n,!0),e.child}function mN(t){var e=t.stateNode;e.pendingContext?dx(t,e.pendingContext,e.pendingContext!==e.context):e.context&&dx(t,e.context,!1),jv(t,e.containerInfo)}function Tx(t,e,n,r,i){return vu(),wv(i),e.flags|=256,hi(t,e,n,r),e.child}var a1={dehydrated:null,treeContext:null,retryLane:0};function o1(t){return{baseLanes:t,cachePool:null,transitions:null}}function pN(t,e,n){var r=e.pendingProps,i=Bn.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Nn(Bn,i&1),t===null)return Z0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=_p(o,r,0,null),t=Zl(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=o1(n),e.memoizedState=a1,t):Dv(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return $j(t,e,o,r,l,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=il(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=il(l,s):(s=Zl(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?o1(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=a1,r}return s=t.child,t=s.sibling,r=il(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Dv(t,e){return e=_p({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function bf(t,e,n,r){return r!==null&&wv(r),yu(e,t.child,null,n),t=Dv(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function $j(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Ug(Error(Fe(422))),bf(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=_p({mode:"visible",children:r.children},i,0,null),s=Zl(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&yu(e,t.child,null,o),e.child.memoizedState=o1(o),e.memoizedState=a1,s);if(!(e.mode&1))return bf(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(Fe(419)),r=Ug(s,r,void 0),bf(t,e,o,r)}if(l=(o&t.childLanes)!==0,Si||l){if(r=Tr,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,to(t,i),Ds(r,t,i,-1))}return Bv(),r=Ug(Error(Fe(421))),bf(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=rT.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Gi=el(i.nextSibling),Qi=e,Dn=!0,Ps=null,t!==null&&(cs[us++]=$a,cs[us++]=Ha,cs[us++]=ic,$a=t.id,Ha=t.overflow,ic=e),e=Dv(e,r.children),e.flags|=4096,e)}function kx(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),e1(t.return,e,n)}function Bg(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function gN(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(hi(t,e,r.children,n),r=Bn.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&kx(t,n,e);else if(t.tag===19)kx(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Nn(Bn,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&km(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Bg(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&km(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Bg(e,!0,n,null,s);break;case"together":Bg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Gf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function no(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ac|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Fe(153));if(e.child!==null){for(t=e.child,n=il(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=il(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Hj(t,e,n){switch(e.tag){case 3:mN(e),vu();break;case 5:z_(e);break;case 1:Ai(e.type)&&Nm(e);break;case 4:jv(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Nn(Am,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Nn(Bn,Bn.current&1),e.flags|=128,null):n&e.child.childLanes?pN(t,e,n):(Nn(Bn,Bn.current&1),t=no(t,e,n),t!==null?t.sibling:null);Nn(Bn,Bn.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return gN(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Nn(Bn,Bn.current),r)break;return null;case 22:case 23:return e.lanes=0,hN(t,e,n)}return no(t,e,n)}var vN,l1,yN,xN;vN=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};l1=function(){};yN=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Yl(ha.current);var s=null;switch(n){case"input":i=C0(t,i),r=C0(t,r),s=[];break;case"select":i=qn({},i,{value:void 0}),r=qn({},r,{value:void 0}),s=[];break;case"textarea":i=R0(t,i),r=R0(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=wm)}D0(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&($d.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&($d.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&jn("scroll",t),s||l===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};xN=function(t,e,n,r){n!==r&&(e.flags|=4)};function fd(t,e){if(!Dn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Gr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Wj(t,e,n){var r=e.pendingProps;switch(bv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gr(e),null;case 1:return Ai(e.type)&&_m(),Gr(e),null;case 3:return r=e.stateNode,xu(),Cn(Ei),Cn(ii),kv(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(yf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ps!==null&&(g1(Ps),Ps=null))),l1(t,e),Gr(e),null;case 5:Tv(e);var i=Yl(nh.current);if(n=e.type,t!==null&&e.stateNode!=null)yN(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Fe(166));return Gr(e),null}if(t=Yl(ha.current),yf(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[la]=e,r[eh]=s,t=(e.mode&1)!==0,n){case"dialog":jn("cancel",r),jn("close",r);break;case"iframe":case"object":case"embed":jn("load",r);break;case"video":case"audio":for(i=0;i<wd.length;i++)jn(wd[i],r);break;case"source":jn("error",r);break;case"img":case"image":case"link":jn("error",r),jn("load",r);break;case"details":jn("toggle",r);break;case"input":F2(r,s),jn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},jn("invalid",r);break;case"textarea":U2(r,s),jn("invalid",r)}D0(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&vf(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&vf(r.textContent,l,t),i=["children",""+l]):$d.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&jn("scroll",r)}switch(n){case"input":cf(r),V2(r,s,!0);break;case"textarea":cf(r),B2(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=wm)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Gw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[la]=e,t[eh]=r,vN(t,e,!1,!1),e.stateNode=t;e:{switch(o=M0(n,r),n){case"dialog":jn("cancel",t),jn("close",t),i=r;break;case"iframe":case"object":case"embed":jn("load",t),i=r;break;case"video":case"audio":for(i=0;i<wd.length;i++)jn(wd[i],t);i=r;break;case"source":jn("error",t),i=r;break;case"img":case"image":case"link":jn("error",t),jn("load",t),i=r;break;case"details":jn("toggle",t),i=r;break;case"input":F2(t,r),i=C0(t,r),jn("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=qn({},r,{value:void 0}),jn("invalid",t);break;case"textarea":U2(t,r),i=R0(t,r),jn("invalid",t);break;default:i=r}D0(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?Qw(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Kw(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Hd(t,c):typeof c=="number"&&Hd(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&($d.hasOwnProperty(s)?c!=null&&s==="onScroll"&&jn("scroll",t):c!=null&&sv(t,s,c,o))}switch(n){case"input":cf(t),V2(t,r,!1);break;case"textarea":cf(t),B2(t);break;case"option":r.value!=null&&t.setAttribute("value",""+cl(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?eu(t,!!r.multiple,s,!1):r.defaultValue!=null&&eu(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=wm)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Gr(e),null;case 6:if(t&&e.stateNode!=null)xN(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Fe(166));if(n=Yl(nh.current),Yl(ha.current),yf(e)){if(r=e.stateNode,n=e.memoizedProps,r[la]=e,(s=r.nodeValue!==n)&&(t=Qi,t!==null))switch(t.tag){case 3:vf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&vf(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[la]=e,e.stateNode=r}return Gr(e),null;case 13:if(Cn(Bn),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Dn&&Gi!==null&&e.mode&1&&!(e.flags&128))O_(),vu(),e.flags|=98560,s=!1;else if(s=yf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Fe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Fe(317));s[la]=e}else vu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Gr(e),s=!1}else Ps!==null&&(g1(Ps),Ps=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Bn.current&1?br===0&&(br=3):Bv())),e.updateQueue!==null&&(e.flags|=4),Gr(e),null);case 4:return xu(),l1(t,e),t===null&&Jd(e.stateNode.containerInfo),Gr(e),null;case 10:return Sv(e.type._context),Gr(e),null;case 17:return Ai(e.type)&&_m(),Gr(e),null;case 19:if(Cn(Bn),s=e.memoizedState,s===null)return Gr(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)fd(s,!1);else{if(br!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=km(t),o!==null){for(e.flags|=128,fd(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Nn(Bn,Bn.current&1|2),e.child}t=t.sibling}s.tail!==null&&ir()>wu&&(e.flags|=128,r=!0,fd(s,!1),e.lanes=4194304)}else{if(!r)if(t=km(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),fd(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Dn)return Gr(e),null}else 2*ir()-s.renderingStartTime>wu&&n!==1073741824&&(e.flags|=128,r=!0,fd(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ir(),e.sibling=null,n=Bn.current,Nn(Bn,r?n&1|2:n&1),e):(Gr(e),null);case 22:case 23:return Uv(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Wi&1073741824&&(Gr(e),e.subtreeFlags&6&&(e.flags|=8192)):Gr(e),null;case 24:return null;case 25:return null}throw Error(Fe(156,e.tag))}function Gj(t,e){switch(bv(e),e.tag){case 1:return Ai(e.type)&&_m(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return xu(),Cn(Ei),Cn(ii),kv(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Tv(e),null;case 13:if(Cn(Bn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Fe(340));vu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Cn(Bn),null;case 4:return xu(),null;case 10:return Sv(e.type._context),null;case 22:case 23:return Uv(),null;case 24:return null;default:return null}}var wf=!1,ei=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,Ke=null;function Qc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Qn(t,e,r)}else n.current=null}function c1(t,e,n){try{n()}catch(r){Qn(t,e,r)}}var Cx=!1;function Yj(t,e){if(W0=ym,t=S_(),yv(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,f=0,g=t,v=null;t:for(;;){for(var m;g!==n||i!==0&&g.nodeType!==3||(l=o+i),g!==s||r!==0&&g.nodeType!==3||(c=o+r),g.nodeType===3&&(o+=g.nodeValue.length),(m=g.firstChild)!==null;)v=g,g=m;for(;;){if(g===t)break t;if(v===n&&++u===i&&(l=o),v===s&&++f===r&&(c=o),(m=g.nextSibling)!==null)break;g=v,v=g.parentNode}g=m}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(G0={focusedElem:t,selectionRange:n},ym=!1,Ke=e;Ke!==null;)if(e=Ke,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ke=t;else for(;Ke!==null;){e=Ke;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var A=E.memoizedProps,C=E.memoizedState,b=e.stateNode,I=b.getSnapshotBeforeUpdate(e.elementType===e.type?A:Cs(e.type,A),C);b.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var O=e.stateNode.containerInfo;O.nodeType===1?O.textContent="":O.nodeType===9&&O.documentElement&&O.removeChild(O.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Fe(163))}}catch(V){Qn(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,Ke=t;break}Ke=e.return}return E=Cx,Cx=!1,E}function Ld(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&c1(e,n,s)}i=i.next}while(i!==r)}}function bp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function u1(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function bN(t){var e=t.alternate;e!==null&&(t.alternate=null,bN(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[la],delete e[eh],delete e[Q0],delete e[Ij],delete e[Pj])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function wN(t){return t.tag===5||t.tag===3||t.tag===4}function Ix(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||wN(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function d1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=wm));else if(r!==4&&(t=t.child,t!==null))for(d1(t,e,n),t=t.sibling;t!==null;)d1(t,e,n),t=t.sibling}function h1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(h1(t,e,n),t=t.sibling;t!==null;)h1(t,e,n),t=t.sibling}var Lr=null,Is=!1;function Do(t,e,n){for(n=n.child;n!==null;)_N(t,e,n),n=n.sibling}function _N(t,e,n){if(da&&typeof da.onCommitFiberUnmount=="function")try{da.onCommitFiberUnmount(hp,n)}catch{}switch(n.tag){case 5:ei||Qc(n,e);case 6:var r=Lr,i=Is;Lr=null,Do(t,e,n),Lr=r,Is=i,Lr!==null&&(Is?(t=Lr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Lr.removeChild(n.stateNode));break;case 18:Lr!==null&&(Is?(t=Lr,n=n.stateNode,t.nodeType===8?Lg(t.parentNode,n):t.nodeType===1&&Lg(t,n),Yd(t)):Lg(Lr,n.stateNode));break;case 4:r=Lr,i=Is,Lr=n.stateNode.containerInfo,Is=!0,Do(t,e,n),Lr=r,Is=i;break;case 0:case 11:case 14:case 15:if(!ei&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&c1(n,e,o),i=i.next}while(i!==r)}Do(t,e,n);break;case 1:if(!ei&&(Qc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Qn(n,e,l)}Do(t,e,n);break;case 21:Do(t,e,n);break;case 22:n.mode&1?(ei=(r=ei)||n.memoizedState!==null,Do(t,e,n),ei=r):Do(t,e,n);break;default:Do(t,e,n)}}function Px(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Kj),e.forEach(function(r){var i=iT.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Ts(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Lr=l.stateNode,Is=!1;break e;case 3:Lr=l.stateNode.containerInfo,Is=!0;break e;case 4:Lr=l.stateNode.containerInfo,Is=!0;break e}l=l.return}if(Lr===null)throw Error(Fe(160));_N(s,o,i),Lr=null,Is=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){Qn(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)NN(e,t),e=e.sibling}function NN(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ts(e,t),ia(t),r&4){try{Ld(3,t,t.return),bp(3,t)}catch(A){Qn(t,t.return,A)}try{Ld(5,t,t.return)}catch(A){Qn(t,t.return,A)}}break;case 1:Ts(e,t),ia(t),r&512&&n!==null&&Qc(n,n.return);break;case 5:if(Ts(e,t),ia(t),r&512&&n!==null&&Qc(n,n.return),t.flags&32){var i=t.stateNode;try{Hd(i,"")}catch(A){Qn(t,t.return,A)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&Hw(i,s),M0(l,o);var u=M0(l,s);for(o=0;o<c.length;o+=2){var f=c[o],g=c[o+1];f==="style"?Qw(i,g):f==="dangerouslySetInnerHTML"?Kw(i,g):f==="children"?Hd(i,g):sv(i,f,g,u)}switch(l){case"input":I0(i,s);break;case"textarea":Ww(i,s);break;case"select":var v=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?eu(i,!!s.multiple,m,!1):v!==!!s.multiple&&(s.defaultValue!=null?eu(i,!!s.multiple,s.defaultValue,!0):eu(i,!!s.multiple,s.multiple?[]:"",!1))}i[eh]=s}catch(A){Qn(t,t.return,A)}}break;case 6:if(Ts(e,t),ia(t),r&4){if(t.stateNode===null)throw Error(Fe(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(A){Qn(t,t.return,A)}}break;case 3:if(Ts(e,t),ia(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Yd(e.containerInfo)}catch(A){Qn(t,t.return,A)}break;case 4:Ts(e,t),ia(t);break;case 13:Ts(e,t),ia(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Fv=ir())),r&4&&Px(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(ei=(u=ei)||f,Ts(e,t),ei=u):Ts(e,t),ia(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(Ke=t,f=t.child;f!==null;){for(g=Ke=f;Ke!==null;){switch(v=Ke,m=v.child,v.tag){case 0:case 11:case 14:case 15:Ld(4,v,v.return);break;case 1:Qc(v,v.return);var E=v.stateNode;if(typeof E.componentWillUnmount=="function"){r=v,n=v.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(A){Qn(r,n,A)}}break;case 5:Qc(v,v.return);break;case 22:if(v.memoizedState!==null){Lx(g);continue}}m!==null?(m.return=v,Ke=m):Lx(g)}f=f.sibling}e:for(f=null,g=t;;){if(g.tag===5){if(f===null){f=g;try{i=g.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=g.stateNode,c=g.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Yw("display",o))}catch(A){Qn(t,t.return,A)}}}else if(g.tag===6){if(f===null)try{g.stateNode.nodeValue=u?"":g.memoizedProps}catch(A){Qn(t,t.return,A)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;f===g&&(f=null),g=g.return}f===g&&(f=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:Ts(e,t),ia(t),r&4&&Px(t);break;case 21:break;default:Ts(e,t),ia(t)}}function ia(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(wN(n)){var r=n;break e}n=n.return}throw Error(Fe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Hd(i,""),r.flags&=-33);var s=Ix(t);h1(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Ix(t);d1(t,l,o);break;default:throw Error(Fe(161))}}catch(c){Qn(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Qj(t,e,n){Ke=t,SN(t)}function SN(t,e,n){for(var r=(t.mode&1)!==0;Ke!==null;){var i=Ke,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||wf;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||ei;l=wf;var u=ei;if(wf=o,(ei=c)&&!u)for(Ke=i;Ke!==null;)o=Ke,c=o.child,o.tag===22&&o.memoizedState!==null?Dx(i):c!==null?(c.return=o,Ke=c):Dx(i);for(;s!==null;)Ke=s,SN(s),s=s.sibling;Ke=i,wf=l,ei=u}Rx(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Ke=s):Rx(t)}}function Rx(t){for(;Ke!==null;){var e=Ke;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ei||bp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ei)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Cs(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&vx(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}vx(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var g=f.dehydrated;g!==null&&Yd(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Fe(163))}ei||e.flags&512&&u1(e)}catch(v){Qn(e,e.return,v)}}if(e===t){Ke=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ke=n;break}Ke=e.return}}function Lx(t){for(;Ke!==null;){var e=Ke;if(e===t){Ke=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ke=n;break}Ke=e.return}}function Dx(t){for(;Ke!==null;){var e=Ke;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{bp(4,e)}catch(c){Qn(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Qn(e,i,c)}}var s=e.return;try{u1(e)}catch(c){Qn(e,s,c)}break;case 5:var o=e.return;try{u1(e)}catch(c){Qn(e,o,c)}}}catch(c){Qn(e,e.return,c)}if(e===t){Ke=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Ke=l;break}Ke=e.return}}var Xj=Math.ceil,Pm=co.ReactCurrentDispatcher,Mv=co.ReactCurrentOwner,fs=co.ReactCurrentBatchConfig,Jt=0,Tr=null,dr=null,Or=0,Wi=0,Xc=xl(0),br=0,ah=null,ac=0,wp=0,Ov=0,Dd=null,_i=null,Fv=0,wu=1/0,Ba=null,Rm=!1,f1=null,nl=null,_f=!1,Ko=null,Lm=0,Md=0,m1=null,Kf=-1,Yf=0;function fi(){return Jt&6?ir():Kf!==-1?Kf:Kf=ir()}function rl(t){return t.mode&1?Jt&2&&Or!==0?Or&-Or:Lj.transition!==null?(Yf===0&&(Yf=l_()),Yf):(t=fn,t!==0||(t=window.event,t=t===void 0?16:p_(t.type)),t):1}function Ds(t,e,n,r){if(50<Md)throw Md=0,m1=null,Error(Fe(185));bh(t,n,r),(!(Jt&2)||t!==Tr)&&(t===Tr&&(!(Jt&2)&&(wp|=n),br===4&&zo(t,Or)),ji(t,r),n===1&&Jt===0&&!(e.mode&1)&&(wu=ir()+500,vp&&bl()))}function ji(t,e){var n=t.callbackNode;LA(t,e);var r=vm(t,t===Tr?Or:0);if(r===0)n!==null&&$2(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&$2(n),e===1)t.tag===0?Rj(Mx.bind(null,t)):L_(Mx.bind(null,t)),kj(function(){!(Jt&6)&&bl()}),n=null;else{switch(c_(r)){case 1:n=uv;break;case 4:n=a_;break;case 16:n=gm;break;case 536870912:n=o_;break;default:n=gm}n=PN(n,EN.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function EN(t,e){if(Kf=-1,Yf=0,Jt&6)throw Error(Fe(327));var n=t.callbackNode;if(su()&&t.callbackNode!==n)return null;var r=vm(t,t===Tr?Or:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Dm(t,r);else{e=r;var i=Jt;Jt|=2;var s=jN();(Tr!==t||Or!==e)&&(Ba=null,wu=ir()+500,Jl(t,e));do try{eT();break}catch(l){AN(t,l)}while(!0);Nv(),Pm.current=s,Jt=i,dr!==null?e=0:(Tr=null,Or=0,e=br)}if(e!==0){if(e===2&&(i=B0(t),i!==0&&(r=i,e=p1(t,i))),e===1)throw n=ah,Jl(t,0),zo(t,r),ji(t,ir()),n;if(e===6)zo(t,r);else{if(i=t.current.alternate,!(r&30)&&!Jj(i)&&(e=Dm(t,r),e===2&&(s=B0(t),s!==0&&(r=s,e=p1(t,s))),e===1))throw n=ah,Jl(t,0),zo(t,r),ji(t,ir()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Fe(345));case 2:ql(t,_i,Ba);break;case 3:if(zo(t,r),(r&130023424)===r&&(e=Fv+500-ir(),10<e)){if(vm(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){fi(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Y0(ql.bind(null,t,_i,Ba),e);break}ql(t,_i,Ba);break;case 4:if(zo(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Ls(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=ir()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Xj(r/1960))-r,10<r){t.timeoutHandle=Y0(ql.bind(null,t,_i,Ba),r);break}ql(t,_i,Ba);break;case 5:ql(t,_i,Ba);break;default:throw Error(Fe(329))}}}return ji(t,ir()),t.callbackNode===n?EN.bind(null,t):null}function p1(t,e){var n=Dd;return t.current.memoizedState.isDehydrated&&(Jl(t,e).flags|=256),t=Dm(t,e),t!==2&&(e=_i,_i=n,e!==null&&g1(e)),t}function g1(t){_i===null?_i=t:_i.push.apply(_i,t)}function Jj(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Ms(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function zo(t,e){for(e&=~Ov,e&=~wp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ls(e),r=1<<n;t[n]=-1,e&=~r}}function Mx(t){if(Jt&6)throw Error(Fe(327));su();var e=vm(t,0);if(!(e&1))return ji(t,ir()),null;var n=Dm(t,e);if(t.tag!==0&&n===2){var r=B0(t);r!==0&&(e=r,n=p1(t,r))}if(n===1)throw n=ah,Jl(t,0),zo(t,e),ji(t,ir()),n;if(n===6)throw Error(Fe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ql(t,_i,Ba),ji(t,ir()),null}function Vv(t,e){var n=Jt;Jt|=1;try{return t(e)}finally{Jt=n,Jt===0&&(wu=ir()+500,vp&&bl())}}function oc(t){Ko!==null&&Ko.tag===0&&!(Jt&6)&&su();var e=Jt;Jt|=1;var n=fs.transition,r=fn;try{if(fs.transition=null,fn=1,t)return t()}finally{fn=r,fs.transition=n,Jt=e,!(Jt&6)&&bl()}}function Uv(){Wi=Xc.current,Cn(Xc)}function Jl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Tj(n)),dr!==null)for(n=dr.return;n!==null;){var r=n;switch(bv(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&_m();break;case 3:xu(),Cn(Ei),Cn(ii),kv();break;case 5:Tv(r);break;case 4:xu();break;case 13:Cn(Bn);break;case 19:Cn(Bn);break;case 10:Sv(r.type._context);break;case 22:case 23:Uv()}n=n.return}if(Tr=t,dr=t=il(t.current,null),Or=Wi=e,br=0,ah=null,Ov=wp=ac=0,_i=Dd=null,Kl!==null){for(e=0;e<Kl.length;e++)if(n=Kl[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Kl=null}return t}function AN(t,e){do{var n=dr;try{if(Nv(),Hf.current=Im,Cm){for(var r=zn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Cm=!1}if(sc=0,Ar=yr=zn=null,Rd=!1,rh=0,Mv.current=null,n===null||n.return===null){br=1,ah=e,dr=null;break}e:{var s=t,o=n.return,l=n,c=e;if(e=Or,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=l,g=f.tag;if(!(f.mode&1)&&(g===0||g===11||g===15)){var v=f.alternate;v?(f.updateQueue=v.updateQueue,f.memoizedState=v.memoizedState,f.lanes=v.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=Nx(o);if(m!==null){m.flags&=-257,Sx(m,o,l,s,e),m.mode&1&&_x(s,u,e),e=m,c=u;var E=e.updateQueue;if(E===null){var A=new Set;A.add(c),e.updateQueue=A}else E.add(c);break e}else{if(!(e&1)){_x(s,u,e),Bv();break e}c=Error(Fe(426))}}else if(Dn&&l.mode&1){var C=Nx(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),Sx(C,o,l,s,e),wv(bu(c,l));break e}}s=c=bu(c,l),br!==4&&(br=2),Dd===null?Dd=[s]:Dd.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var b=cN(s,c,e);gx(s,b);break e;case 1:l=c;var I=s.type,O=s.stateNode;if(!(s.flags&128)&&(typeof I.getDerivedStateFromError=="function"||O!==null&&typeof O.componentDidCatch=="function"&&(nl===null||!nl.has(O)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=uN(s,l,e);gx(s,V);break e}}s=s.return}while(s!==null)}kN(n)}catch(ne){e=ne,dr===n&&n!==null&&(dr=n=n.return);continue}break}while(!0)}function jN(){var t=Pm.current;return Pm.current=Im,t===null?Im:t}function Bv(){(br===0||br===3||br===2)&&(br=4),Tr===null||!(ac&268435455)&&!(wp&268435455)||zo(Tr,Or)}function Dm(t,e){var n=Jt;Jt|=2;var r=jN();(Tr!==t||Or!==e)&&(Ba=null,Jl(t,e));do try{Zj();break}catch(i){AN(t,i)}while(!0);if(Nv(),Jt=n,Pm.current=r,dr!==null)throw Error(Fe(261));return Tr=null,Or=0,br}function Zj(){for(;dr!==null;)TN(dr)}function eT(){for(;dr!==null&&!EA();)TN(dr)}function TN(t){var e=IN(t.alternate,t,Wi);t.memoizedProps=t.pendingProps,e===null?kN(t):dr=e,Mv.current=null}function kN(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Gj(n,e),n!==null){n.flags&=32767,dr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{br=6,dr=null;return}}else if(n=Wj(n,e,Wi),n!==null){dr=n;return}if(e=e.sibling,e!==null){dr=e;return}dr=e=t}while(e!==null);br===0&&(br=5)}function ql(t,e,n){var r=fn,i=fs.transition;try{fs.transition=null,fn=1,tT(t,e,n,r)}finally{fs.transition=i,fn=r}return null}function tT(t,e,n,r){do su();while(Ko!==null);if(Jt&6)throw Error(Fe(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Fe(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(DA(t,s),t===Tr&&(dr=Tr=null,Or=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||_f||(_f=!0,PN(gm,function(){return su(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=fs.transition,fs.transition=null;var o=fn;fn=1;var l=Jt;Jt|=4,Mv.current=null,Yj(t,n),NN(n,t),wj(G0),ym=!!W0,G0=W0=null,t.current=n,Qj(n),AA(),Jt=l,fn=o,fs.transition=s}else t.current=n;if(_f&&(_f=!1,Ko=t,Lm=i),s=t.pendingLanes,s===0&&(nl=null),kA(n.stateNode),ji(t,ir()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Rm)throw Rm=!1,t=f1,f1=null,t;return Lm&1&&t.tag!==0&&su(),s=t.pendingLanes,s&1?t===m1?Md++:(Md=0,m1=t):Md=0,bl(),null}function su(){if(Ko!==null){var t=c_(Lm),e=fs.transition,n=fn;try{if(fs.transition=null,fn=16>t?16:t,Ko===null)var r=!1;else{if(t=Ko,Ko=null,Lm=0,Jt&6)throw Error(Fe(331));var i=Jt;for(Jt|=4,Ke=t.current;Ke!==null;){var s=Ke,o=s.child;if(Ke.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Ke=u;Ke!==null;){var f=Ke;switch(f.tag){case 0:case 11:case 15:Ld(8,f,s)}var g=f.child;if(g!==null)g.return=f,Ke=g;else for(;Ke!==null;){f=Ke;var v=f.sibling,m=f.return;if(bN(f),f===u){Ke=null;break}if(v!==null){v.return=m,Ke=v;break}Ke=m}}}var E=s.alternate;if(E!==null){var A=E.child;if(A!==null){E.child=null;do{var C=A.sibling;A.sibling=null,A=C}while(A!==null)}}Ke=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Ke=o;else e:for(;Ke!==null;){if(s=Ke,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ld(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,Ke=b;break e}Ke=s.return}}var I=t.current;for(Ke=I;Ke!==null;){o=Ke;var O=o.child;if(o.subtreeFlags&2064&&O!==null)O.return=o,Ke=O;else e:for(o=I;Ke!==null;){if(l=Ke,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:bp(9,l)}}catch(ne){Qn(l,l.return,ne)}if(l===o){Ke=null;break e}var V=l.sibling;if(V!==null){V.return=l.return,Ke=V;break e}Ke=l.return}}if(Jt=i,bl(),da&&typeof da.onPostCommitFiberRoot=="function")try{da.onPostCommitFiberRoot(hp,t)}catch{}r=!0}return r}finally{fn=n,fs.transition=e}}return!1}function Ox(t,e,n){e=bu(n,e),e=cN(t,e,1),t=tl(t,e,1),e=fi(),t!==null&&(bh(t,1,e),ji(t,e))}function Qn(t,e,n){if(t.tag===3)Ox(t,t,n);else for(;e!==null;){if(e.tag===3){Ox(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(nl===null||!nl.has(r))){t=bu(n,t),t=uN(e,t,1),e=tl(e,t,1),t=fi(),e!==null&&(bh(e,1,t),ji(e,t));break}}e=e.return}}function nT(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=fi(),t.pingedLanes|=t.suspendedLanes&n,Tr===t&&(Or&n)===n&&(br===4||br===3&&(Or&130023424)===Or&&500>ir()-Fv?Jl(t,0):Ov|=n),ji(t,e)}function CN(t,e){e===0&&(t.mode&1?(e=hf,hf<<=1,!(hf&130023424)&&(hf=4194304)):e=1);var n=fi();t=to(t,e),t!==null&&(bh(t,e,n),ji(t,n))}function rT(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),CN(t,n)}function iT(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Fe(314))}r!==null&&r.delete(e),CN(t,n)}var IN;IN=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ei.current)Si=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Si=!1,Hj(t,e,n);Si=!!(t.flags&131072)}else Si=!1,Dn&&e.flags&1048576&&D_(e,Em,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Gf(t,e),t=e.pendingProps;var i=gu(e,ii.current);iu(e,n),i=Iv(null,e,r,t,i,n);var s=Pv();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ai(r)?(s=!0,Nm(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Av(e),i.updater=xp,e.stateNode=i,i._reactInternals=e,n1(e,r,t,n),e=s1(null,e,r,!0,s,n)):(e.tag=0,Dn&&s&&xv(e),hi(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Gf(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=aT(r),t=Cs(r,t),i){case 0:e=i1(null,e,r,t,n);break e;case 1:e=jx(null,e,r,t,n);break e;case 11:e=Ex(null,e,r,t,n);break e;case 14:e=Ax(null,e,r,Cs(r.type,t),n);break e}throw Error(Fe(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Cs(r,i),i1(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Cs(r,i),jx(t,e,r,i,n);case 3:e:{if(mN(e),t===null)throw Error(Fe(387));r=e.pendingProps,s=e.memoizedState,i=s.element,B_(t,e),Tm(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=bu(Error(Fe(423)),e),e=Tx(t,e,r,n,i);break e}else if(r!==i){i=bu(Error(Fe(424)),e),e=Tx(t,e,r,n,i);break e}else for(Gi=el(e.stateNode.containerInfo.firstChild),Qi=e,Dn=!0,Ps=null,n=V_(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(vu(),r===i){e=no(t,e,n);break e}hi(t,e,r,n)}e=e.child}return e;case 5:return z_(e),t===null&&Z0(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,K0(r,i)?o=null:s!==null&&K0(r,s)&&(e.flags|=32),fN(t,e),hi(t,e,o,n),e.child;case 6:return t===null&&Z0(e),null;case 13:return pN(t,e,n);case 4:return jv(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=yu(e,null,r,n):hi(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Cs(r,i),Ex(t,e,r,i,n);case 7:return hi(t,e,e.pendingProps,n),e.child;case 8:return hi(t,e,e.pendingProps.children,n),e.child;case 12:return hi(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Nn(Am,r._currentValue),r._currentValue=o,s!==null)if(Ms(s.value,o)){if(s.children===i.children&&!Ei.current){e=no(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Ya(-1,n&-n),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),e1(s.return,n,e),l.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Fe(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),e1(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}hi(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,iu(e,n),i=gs(i),r=r(i),e.flags|=1,hi(t,e,r,n),e.child;case 14:return r=e.type,i=Cs(r,e.pendingProps),i=Cs(r.type,i),Ax(t,e,r,i,n);case 15:return dN(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Cs(r,i),Gf(t,e),e.tag=1,Ai(r)?(t=!0,Nm(e)):t=!1,iu(e,n),lN(e,r,i),n1(e,r,i,n),s1(null,e,r,!0,t,n);case 19:return gN(t,e,n);case 22:return hN(t,e,n)}throw Error(Fe(156,e.tag))};function PN(t,e){return s_(t,e)}function sT(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hs(t,e,n,r){return new sT(t,e,n,r)}function zv(t){return t=t.prototype,!(!t||!t.isReactComponent)}function aT(t){if(typeof t=="function")return zv(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ov)return 11;if(t===lv)return 14}return 2}function il(t,e){var n=t.alternate;return n===null?(n=hs(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Qf(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")zv(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Bc:return Zl(n.children,i,s,e);case av:o=8,i|=8;break;case A0:return t=hs(12,n,e,i|2),t.elementType=A0,t.lanes=s,t;case j0:return t=hs(13,n,e,i),t.elementType=j0,t.lanes=s,t;case T0:return t=hs(19,n,e,i),t.elementType=T0,t.lanes=s,t;case zw:return _p(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Uw:o=10;break e;case Bw:o=9;break e;case ov:o=11;break e;case lv:o=14;break e;case Vo:o=16,r=null;break e}throw Error(Fe(130,t==null?t:typeof t,""))}return e=hs(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Zl(t,e,n,r){return t=hs(7,t,r,e),t.lanes=n,t}function _p(t,e,n,r){return t=hs(22,t,r,e),t.elementType=zw,t.lanes=n,t.stateNode={isHidden:!1},t}function zg(t,e,n){return t=hs(6,t,null,e),t.lanes=n,t}function qg(t,e,n){return e=hs(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function oT(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ng(0),this.expirationTimes=Ng(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ng(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function qv(t,e,n,r,i,s,o,l,c){return t=new oT(t,e,n,l,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=hs(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Av(s),t}function lT(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Uc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function RN(t){if(!t)return ul;t=t._reactInternals;e:{if(yc(t)!==t||t.tag!==1)throw Error(Fe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ai(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Fe(171))}if(t.tag===1){var n=t.type;if(Ai(n))return R_(t,n,e)}return e}function LN(t,e,n,r,i,s,o,l,c){return t=qv(n,r,!0,t,i,s,o,l,c),t.context=RN(null),n=t.current,r=fi(),i=rl(n),s=Ya(r,i),s.callback=e??null,tl(n,s,i),t.current.lanes=i,bh(t,i,r),ji(t,r),t}function Np(t,e,n,r){var i=e.current,s=fi(),o=rl(i);return n=RN(n),e.context===null?e.context=n:e.pendingContext=n,e=Ya(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=tl(i,e,o),t!==null&&(Ds(t,i,o,s),$f(t,i,o)),o}function Mm(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Fx(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function $v(t,e){Fx(t,e),(t=t.alternate)&&Fx(t,e)}function cT(){return null}var DN=typeof reportError=="function"?reportError:function(t){console.error(t)};function Hv(t){this._internalRoot=t}Sp.prototype.render=Hv.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Fe(409));Np(t,e,null,null)};Sp.prototype.unmount=Hv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;oc(function(){Np(null,t,null,null)}),e[eo]=null}};function Sp(t){this._internalRoot=t}Sp.prototype.unstable_scheduleHydration=function(t){if(t){var e=h_();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Bo.length&&e!==0&&e<Bo[n].priority;n++);Bo.splice(n,0,t),n===0&&m_(t)}};function Wv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ep(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Vx(){}function uT(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Mm(o);s.call(u)}}var o=LN(e,r,t,0,null,!1,!1,"",Vx);return t._reactRootContainer=o,t[eo]=o.current,Jd(t.nodeType===8?t.parentNode:t),oc(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=Mm(c);l.call(u)}}var c=qv(t,0,!1,null,null,!1,!1,"",Vx);return t._reactRootContainer=c,t[eo]=c.current,Jd(t.nodeType===8?t.parentNode:t),oc(function(){Np(e,c,n,r)}),c}function Ap(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=Mm(o);l.call(c)}}Np(e,o,t,i)}else o=uT(n,e,t,i,r);return Mm(o)}u_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=bd(e.pendingLanes);n!==0&&(dv(e,n|1),ji(e,ir()),!(Jt&6)&&(wu=ir()+500,bl()))}break;case 13:oc(function(){var r=to(t,1);if(r!==null){var i=fi();Ds(r,t,1,i)}}),$v(t,1)}};hv=function(t){if(t.tag===13){var e=to(t,134217728);if(e!==null){var n=fi();Ds(e,t,134217728,n)}$v(t,134217728)}};d_=function(t){if(t.tag===13){var e=rl(t),n=to(t,e);if(n!==null){var r=fi();Ds(n,t,e,r)}$v(t,e)}};h_=function(){return fn};f_=function(t,e){var n=fn;try{return fn=t,e()}finally{fn=n}};F0=function(t,e,n){switch(e){case"input":if(I0(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=gp(r);if(!i)throw Error(Fe(90));$w(r),I0(r,i)}}}break;case"textarea":Ww(t,n);break;case"select":e=n.value,e!=null&&eu(t,!!n.multiple,e,!1)}};Zw=Vv;e_=oc;var dT={usingClientEntryPoint:!1,Events:[_h,Hc,gp,Xw,Jw,Vv]},md={findFiberByHostInstance:Gl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},hT={bundleType:md.bundleType,version:md.version,rendererPackageName:md.rendererPackageName,rendererConfig:md.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:co.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=r_(t),t===null?null:t.stateNode},findFiberByHostInstance:md.findFiberByHostInstance||cT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nf.isDisabled&&Nf.supportsFiber)try{hp=Nf.inject(hT),da=Nf}catch{}}Zi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dT;Zi.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wv(e))throw Error(Fe(200));return lT(t,e,null,n)};Zi.createRoot=function(t,e){if(!Wv(t))throw Error(Fe(299));var n=!1,r="",i=DN;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=qv(t,1,!1,null,null,n,!1,r,i),t[eo]=e.current,Jd(t.nodeType===8?t.parentNode:t),new Hv(e)};Zi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Fe(188)):(t=Object.keys(t).join(","),Error(Fe(268,t)));return t=r_(e),t=t===null?null:t.stateNode,t};Zi.flushSync=function(t){return oc(t)};Zi.hydrate=function(t,e,n){if(!Ep(e))throw Error(Fe(200));return Ap(null,t,e,!0,n)};Zi.hydrateRoot=function(t,e,n){if(!Wv(t))throw Error(Fe(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=DN;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=LN(e,null,t,1,n??null,i,!1,s,o),t[eo]=e.current,Jd(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Sp(e)};Zi.render=function(t,e,n){if(!Ep(e))throw Error(Fe(200));return Ap(null,t,e,!1,n)};Zi.unmountComponentAtNode=function(t){if(!Ep(t))throw Error(Fe(40));return t._reactRootContainer?(oc(function(){Ap(null,null,t,!1,function(){t._reactRootContainer=null,t[eo]=null})}),!0):!1};Zi.unstable_batchedUpdates=Vv;Zi.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Ep(n))throw Error(Fe(200));if(t==null||t._reactInternals===void 0)throw Error(Fe(38));return Ap(t,e,n,!1,r)};Zi.version="18.3.1-next-f1338f8080-20240426";function MN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(MN)}catch(t){console.error(t)}}MN(),Mw.exports=Zi;var fT=Mw.exports,Ux=fT;S0.createRoot=Ux.createRoot,S0.hydrateRoot=Ux.hydrateRoot;var Bx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ON=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},mT=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],l=t[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},FN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,l=o?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,f=s>>2,g=(s&3)<<4|l>>4;let v=(l&15)<<2|u>>6,m=u&63;c||(m=64,o||(v=64)),r.push(n[f],n[g],n[v],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ON(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):mT(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const g=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||l==null||u==null||g==null)throw new pT;const v=s<<2|l>>4;if(r.push(v),u!==64){const m=l<<4&240|u>>2;if(r.push(m),g!==64){const E=u<<6&192|g;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class pT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const gT=function(t){const e=ON(t);return FN.encodeByteArray(e,!0)},Om=function(t){return gT(t).replace(/\./g,"")},VN=function(t){try{return FN.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yT=()=>vT().__FIREBASE_DEFAULTS__,xT=()=>{if(typeof process>"u"||typeof Bx>"u")return;const t=Bx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},bT=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&VN(t[1]);return e&&JSON.parse(e)},jp=()=>{try{return yT()||xT()||bT()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},UN=t=>{var e,n;return(n=(e=jp())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Gv=t=>{const e=UN(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},BN=()=>{var t;return(t=jp())===null||t===void 0?void 0:t.config},zN=t=>{var e;return(e=jp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qN(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Om(JSON.stringify(n)),Om(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function si(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function _T(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(si())}function NT(){var t;const e=(t=jp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ST(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function ET(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function AT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function jT(){const t=si();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function TT(){return!NT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function kT(){try{return typeof indexedDB=="object"}catch{return!1}}function CT(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IT="FirebaseError";class wa extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=IT,Object.setPrototypeOf(this,wa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Sh.prototype.create)}}class Sh{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?PT(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new wa(i,l,r)}}function PT(t,e){return t.replace(RT,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const RT=/\{\$([^}]+)}/g;function LT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Fm(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(zx(s)&&zx(o)){if(!Fm(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function zx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eh(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function _d(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Nd(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function DT(t,e){const n=new MT(t,e);return n.subscribe.bind(n)}class MT{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");OT(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=$g),i.error===void 0&&(i.error=$g),i.complete===void 0&&(i.complete=$g);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function OT(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function $g(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mn(t){return t&&t._delegate?t._delegate:t}class ro{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $l="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FT{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new wT;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(UT(e))try{this.getOrInitializeService({instanceIdentifier:$l})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=$l){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=$l){return this.instances.has(e)}getOptions(e=$l){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:VT(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=$l){return this.component?this.component.multipleInstances?e:$l:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function VT(t){return t===$l?void 0:t}function UT(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new FT(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Wt||(Wt={}));const zT={debug:Wt.DEBUG,verbose:Wt.VERBOSE,info:Wt.INFO,warn:Wt.WARN,error:Wt.ERROR,silent:Wt.SILENT},qT=Wt.INFO,$T={[Wt.DEBUG]:"log",[Wt.VERBOSE]:"log",[Wt.INFO]:"info",[Wt.WARN]:"warn",[Wt.ERROR]:"error"},HT=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=$T[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Kv{constructor(e){this.name=e,this._logLevel=qT,this._logHandler=HT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Wt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?zT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Wt.DEBUG,...e),this._logHandler(this,Wt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Wt.VERBOSE,...e),this._logHandler(this,Wt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Wt.INFO,...e),this._logHandler(this,Wt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Wt.WARN,...e),this._logHandler(this,Wt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Wt.ERROR,...e),this._logHandler(this,Wt.ERROR,...e)}}const WT=(t,e)=>e.some(n=>t instanceof n);let qx,$x;function GT(){return qx||(qx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function KT(){return $x||($x=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const $N=new WeakMap,v1=new WeakMap,HN=new WeakMap,Hg=new WeakMap,Yv=new WeakMap;function YT(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(sl(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&$N.set(n,t)}).catch(()=>{}),Yv.set(e,t),e}function QT(t){if(v1.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});v1.set(t,e)}let y1={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return v1.get(t);if(e==="objectStoreNames")return t.objectStoreNames||HN.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return sl(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function XT(t){y1=t(y1)}function JT(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Wg(this),e,...n);return HN.set(r,e.sort?e.sort():[e]),sl(r)}:KT().includes(t)?function(...e){return t.apply(Wg(this),e),sl($N.get(this))}:function(...e){return sl(t.apply(Wg(this),e))}}function ZT(t){return typeof t=="function"?JT(t):(t instanceof IDBTransaction&&QT(t),WT(t,GT())?new Proxy(t,y1):t)}function sl(t){if(t instanceof IDBRequest)return YT(t);if(Hg.has(t))return Hg.get(t);const e=ZT(t);return e!==t&&(Hg.set(t,e),Yv.set(e,t)),e}const Wg=t=>Yv.get(t);function ek(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),l=sl(o);return r&&o.addEventListener("upgradeneeded",c=>{r(sl(o.result),c.oldVersion,c.newVersion,sl(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const tk=["get","getKey","getAll","getAllKeys","count"],nk=["put","add","delete","clear"],Gg=new Map;function Hx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Gg.get(e))return Gg.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=nk.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||tk.includes(n)))return;const s=async function(o,...l){const c=this.transaction(o,i?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),i&&c.done]))[0]};return Gg.set(e,s),s}XT(t=>({...t,get:(e,n,r)=>Hx(e,n)||t.get(e,n,r),has:(e,n)=>!!Hx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(ik(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function ik(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const x1="@firebase/app",Wx="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const io=new Kv("@firebase/app"),sk="@firebase/app-compat",ak="@firebase/analytics-compat",ok="@firebase/analytics",lk="@firebase/app-check-compat",ck="@firebase/app-check",uk="@firebase/auth",dk="@firebase/auth-compat",hk="@firebase/database",fk="@firebase/data-connect",mk="@firebase/database-compat",pk="@firebase/functions",gk="@firebase/functions-compat",vk="@firebase/installations",yk="@firebase/installations-compat",xk="@firebase/messaging",bk="@firebase/messaging-compat",wk="@firebase/performance",_k="@firebase/performance-compat",Nk="@firebase/remote-config",Sk="@firebase/remote-config-compat",Ek="@firebase/storage",Ak="@firebase/storage-compat",jk="@firebase/firestore",Tk="@firebase/vertexai-preview",kk="@firebase/firestore-compat",Ck="firebase",Ik="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b1="[DEFAULT]",Pk={[x1]:"fire-core",[sk]:"fire-core-compat",[ok]:"fire-analytics",[ak]:"fire-analytics-compat",[ck]:"fire-app-check",[lk]:"fire-app-check-compat",[uk]:"fire-auth",[dk]:"fire-auth-compat",[hk]:"fire-rtdb",[fk]:"fire-data-connect",[mk]:"fire-rtdb-compat",[pk]:"fire-fn",[gk]:"fire-fn-compat",[vk]:"fire-iid",[yk]:"fire-iid-compat",[xk]:"fire-fcm",[bk]:"fire-fcm-compat",[wk]:"fire-perf",[_k]:"fire-perf-compat",[Nk]:"fire-rc",[Sk]:"fire-rc-compat",[Ek]:"fire-gcs",[Ak]:"fire-gcs-compat",[jk]:"fire-fst",[kk]:"fire-fst-compat",[Tk]:"fire-vertex","fire-js":"fire-js",[Ck]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm=new Map,Rk=new Map,w1=new Map;function Gx(t,e){try{t.container.addComponent(e)}catch(n){io.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function dl(t){const e=t.name;if(w1.has(e))return io.debug(`There were multiple attempts to register component ${e}.`),!1;w1.set(e,t);for(const n of Vm.values())Gx(n,t);for(const n of Rk.values())Gx(n,t);return!0}function Ah(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ca(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},al=new Sh("app","Firebase",Lk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ro("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw al.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xc=Ik;function WN(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:b1,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw al.create("bad-app-name",{appName:String(i)});if(n||(n=BN()),!n)throw al.create("no-options");const s=Vm.get(i);if(s){if(Fm(n,s.options)&&Fm(r,s.config))return s;throw al.create("duplicate-app",{appName:i})}const o=new BT(i);for(const c of w1.values())o.addComponent(c);const l=new Dk(n,r,o);return Vm.set(i,l),l}function Tp(t=b1){const e=Vm.get(t);if(!e&&t===b1&&BN())return WN();if(!e)throw al.create("no-app",{appName:t});return e}function ms(t,e,n){var r;let i=(r=Pk[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),io.warn(l.join(" "));return}dl(new ro(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mk="firebase-heartbeat-database",Ok=1,oh="firebase-heartbeat-store";let Kg=null;function GN(){return Kg||(Kg=ek(Mk,Ok,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(oh)}catch(n){console.warn(n)}}}}).catch(t=>{throw al.create("idb-open",{originalErrorMessage:t.message})})),Kg}async function Fk(t){try{const n=(await GN()).transaction(oh),r=await n.objectStore(oh).get(KN(t));return await n.done,r}catch(e){if(e instanceof wa)io.warn(e.message);else{const n=al.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});io.warn(n.message)}}}async function Kx(t,e){try{const r=(await GN()).transaction(oh,"readwrite");await r.objectStore(oh).put(e,KN(t)),await r.done}catch(n){if(n instanceof wa)io.warn(n.message);else{const r=al.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});io.warn(r.message)}}}function KN(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vk=1024,Uk=30*24*60*60*1e3;class Bk{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new qk(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Yx();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=Uk}),this._storage.overwrite(this._heartbeatsCache))}catch(r){io.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Yx(),{heartbeatsToSend:r,unsentEntries:i}=zk(this._heartbeatsCache.heartbeats),s=Om(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return io.warn(n),""}}}function Yx(){return new Date().toISOString().substring(0,10)}function zk(t,e=Vk){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Qx(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Qx(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class qk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return kT()?CT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Fk(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Kx(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Kx(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Qx(t){return Om(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $k(t){dl(new ro("platform-logger",e=>new rk(e),"PRIVATE")),dl(new ro("heartbeat",e=>new Bk(e),"PRIVATE")),ms(x1,Wx,t),ms(x1,Wx,"esm2017"),ms("fire-js","")}$k("");function Qv(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function YN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Hk=YN,QN=new Sh("auth","Firebase",YN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Um=new Kv("@firebase/auth");function Wk(t,...e){Um.logLevel<=Wt.WARN&&Um.warn(`Auth (${xc}): ${t}`,...e)}function Xf(t,...e){Um.logLevel<=Wt.ERROR&&Um.error(`Auth (${xc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Os(t,...e){throw Xv(t,...e)}function fa(t,...e){return Xv(t,...e)}function XN(t,e,n){const r=Object.assign(Object.assign({},Hk()),{[e]:n});return new Sh("auth","Firebase",r).create(e,{appName:t.name})}function Qa(t){return XN(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Xv(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return QN.create(t,...e)}function bt(t,e,...n){if(!t)throw Xv(e,...n)}function Wa(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Xf(e),new Error(e)}function so(t,e){t||Wa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _1(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Gk(){return Xx()==="http:"||Xx()==="https:"}function Xx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Gk()||ET()||"connection"in navigator)?navigator.onLine:!0}function Yk(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{constructor(e,n){this.shortDelay=e,this.longDelay=n,so(n>e,"Short delay should be less than long delay!"),this.isMobile=_T()||AT()}get(){return Kk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jv(t,e){so(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xk=new jh(3e4,6e4);function uo(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function _a(t,e,n,r,i={}){return ZN(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const l=Eh(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},s);return ST()||(u.referrerPolicy="no-referrer"),JN.fetch()(e4(t,t.config.apiHost,n,l),u)})}async function ZN(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Qk),e);try{const i=new Zk(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Sf(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Sf(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Sf(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Sf(t,"user-disabled",o);const f=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw XN(t,f,u);Os(t,f)}}catch(i){if(i instanceof wa)throw i;Os(t,"network-request-failed",{message:String(i)})}}async function Th(t,e,n,r,i={}){const s=await _a(t,e,n,r,i);return"mfaPendingCredential"in s&&Os(t,"multi-factor-auth-required",{_serverResponse:s}),s}function e4(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?Jv(t.config,i):`${t.config.apiScheme}://${i}`}function Jk(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Zk{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(fa(this.auth,"network-request-failed")),Xk.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Sf(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=fa(t,e,r);return i.customData._tokenResponse=n,i}function Jx(t){return t!==void 0&&t.enterprise!==void 0}class eC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Jk(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function tC(t,e){return _a(t,"GET","/v2/recaptchaConfig",uo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nC(t,e){return _a(t,"POST","/v1/accounts:delete",e)}async function t4(t,e){return _a(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Od(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function rC(t,e=!1){const n=Mn(t),r=await n.getIdToken(e),i=Zv(r);bt(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Od(Yg(i.auth_time)),issuedAtTime:Od(Yg(i.iat)),expirationTime:Od(Yg(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Yg(t){return Number(t)*1e3}function Zv(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Xf("JWT malformed, contained fewer than 3 sections"),null;try{const i=VN(n);return i?JSON.parse(i):(Xf("Failed to decode base64 JWT payload"),null)}catch(i){return Xf("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Zx(t){const e=Zv(t);return bt(e,"internal-error"),bt(typeof e.exp<"u","internal-error"),bt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _u(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof wa&&iC(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function iC({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Od(this.lastLoginAt),this.creationTime=Od(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bm(t){var e;const n=t.auth,r=await t.getIdToken(),i=await _u(t,t4(n,{idToken:r}));bt(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?n4(s.providerUserInfo):[],l=oC(t.providerData,o),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),f=c?u:!1,g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new N1(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,g)}async function aC(t){const e=Mn(t);await Bm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function oC(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function n4(t){return t.map(e=>{var{providerId:n}=e,r=Qv(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lC(t,e){const n=await ZN(t,{},async()=>{const r=Eh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=e4(t,i,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",JN.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function cC(t,e){return _a(t,"POST","/v2/accounts:revokeToken",uo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){bt(e.idToken,"internal-error"),bt(typeof e.idToken<"u","internal-error"),bt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Zx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){bt(e.length!==0,"internal-error");const n=Zx(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(bt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await lC(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new au;return r&&(bt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(bt(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(bt(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new au,this.toJSON())}_performRefresh(){return Wa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mo(t,e){bt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ga{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=Qv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new sC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new N1(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await _u(this,this.stsTokenManager.getToken(this.auth,e));return bt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return rC(this,e)}reload(){return aC(this)}_assign(e){this!==e&&(bt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ga(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){bt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Bm(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ca(this.auth.app))return Promise.reject(Qa(this.auth));const e=await this.getIdToken();return await _u(this,nC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,l,c,u,f;const g=(r=n.displayName)!==null&&r!==void 0?r:void 0,v=(i=n.email)!==null&&i!==void 0?i:void 0,m=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=n.photoURL)!==null&&o!==void 0?o:void 0,A=(l=n.tenantId)!==null&&l!==void 0?l:void 0,C=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,b=(u=n.createdAt)!==null&&u!==void 0?u:void 0,I=(f=n.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:O,emailVerified:V,isAnonymous:ne,providerData:le,stsTokenManager:z}=n;bt(O&&z,e,"internal-error");const T=au.fromJSON(this.name,z);bt(typeof O=="string",e,"internal-error"),Mo(g,e.name),Mo(v,e.name),bt(typeof V=="boolean",e,"internal-error"),bt(typeof ne=="boolean",e,"internal-error"),Mo(m,e.name),Mo(E,e.name),Mo(A,e.name),Mo(C,e.name),Mo(b,e.name),Mo(I,e.name);const k=new Ga({uid:O,auth:e,email:v,emailVerified:V,displayName:g,isAnonymous:ne,photoURL:E,phoneNumber:m,tenantId:A,stsTokenManager:T,createdAt:b,lastLoginAt:I});return le&&Array.isArray(le)&&(k.providerData=le.map(N=>Object.assign({},N))),C&&(k._redirectEventId=C),k}static async _fromIdTokenResponse(e,n,r=!1){const i=new au;i.updateFromServerResponse(n);const s=new Ga({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Bm(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];bt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?n4(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new au;l.updateFromIdToken(r);const c=new Ga({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new N1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eb=new Map;function Ka(t){so(t instanceof Function,"Expected a class definition");let e=eb.get(t);return e?(so(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,eb.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}r4.type="NONE";const tb=r4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jf(t,e,n){return`firebase:${t}:${e}:${n}`}class ou{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Jf(this.userKey,i.apiKey,s),this.fullPersistenceKey=Jf("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ga._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ou(Ka(tb),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Ka(tb);const o=Jf(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const f=await u._get(o);if(f){const g=Ga._fromJSON(e,f);u!==s&&(l=g),s=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new ou(s,e,r):(s=c[0],l&&await s._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new ou(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nb(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(o4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(i4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(c4(e))return"Blackberry";if(u4(e))return"Webos";if(s4(e))return"Safari";if((e.includes("chrome/")||a4(e))&&!e.includes("edge/"))return"Chrome";if(l4(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function i4(t=si()){return/firefox\//i.test(t)}function s4(t=si()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function a4(t=si()){return/crios\//i.test(t)}function o4(t=si()){return/iemobile/i.test(t)}function l4(t=si()){return/android/i.test(t)}function c4(t=si()){return/blackberry/i.test(t)}function u4(t=si()){return/webos/i.test(t)}function ey(t=si()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function uC(t=si()){var e;return ey(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function dC(){return jT()&&document.documentMode===10}function d4(t=si()){return ey(t)||l4(t)||u4(t)||c4(t)||/windows phone/i.test(t)||o4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h4(t,e=[]){let n;switch(t){case"Browser":n=nb(si());break;case"Worker":n=`${nb(si())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${xc}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,l)=>{try{const c=e(s);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fC(t,e={}){return _a(t,"GET","/v2/passwordPolicy",uo(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mC=6;class pC{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:mC,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rb(this),this.idTokenSubscription=new rb(this),this.beforeStateQueue=new hC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=QN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ka(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await ou.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await t4(this,{idToken:e}),r=await Ga._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(ca(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return bt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Bm(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Yk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ca(this.app))return Promise.reject(Qa(this));const n=e?Mn(e):null;return n&&bt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&bt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ca(this.app)?Promise.reject(Qa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ca(this.app)?Promise.reject(Qa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ka(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await fC(this),n=new pC(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Sh("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await cC(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ka(e)||this._popupRedirectResolver;bt(n,this,"argument-error"),this.redirectPersistenceManager=await ou.create(this,[Ka(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(bt(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,i);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return bt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=h4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&Wk(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function bc(t){return Mn(t)}class rb{constructor(e){this.auth=e,this.observer=null,this.addObserver=DT(n=>this.observer=n)}get next(){return bt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function vC(t){kp=t}function f4(t){return kp.loadJS(t)}function yC(){return kp.recaptchaEnterpriseScript}function xC(){return kp.gapiScript}function bC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const wC="recaptcha-enterprise",_C="NO_RECAPTCHA";class NC{constructor(e){this.type=wC,this.auth=bc(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{tC(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new eC(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function i(s,o,l){const c=window.grecaptcha;Jx(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(_C)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(l=>{if(!n&&Jx(window.grecaptcha))i(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=yC();c.length!==0&&(c+=l),f4(c).then(()=>{i(l,s,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function ib(t,e,n,r=!1){const i=new NC(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function S1(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await ib(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await ib(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SC(t,e){const n=Ah(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Fm(s,e??{}))return i;Os(i,"already-initialized")}return n.initialize({options:e})}function EC(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ka);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function AC(t,e,n){const r=bc(t);bt(r._canInitEmulator,r,"emulator-config-failed"),bt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=m4(e),{host:o,port:l}=jC(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),TC()}function m4(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function jC(t){const e=m4(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:sb(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:sb(o)}}}function sb(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function TC(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Wa("not implemented")}_getIdTokenResponse(e){return Wa("not implemented")}_linkToIdToken(e,n){return Wa("not implemented")}_getReauthenticationResolver(e){return Wa("not implemented")}}async function kC(t,e){return _a(t,"POST","/v1/accounts:update",e)}async function CC(t,e){return _a(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IC(t,e){return Th(t,"POST","/v1/accounts:signInWithPassword",uo(t,e))}async function PC(t,e){return _a(t,"POST","/v1/accounts:sendOobCode",uo(t,e))}async function RC(t,e){return PC(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LC(t,e){return Th(t,"POST","/v1/accounts:signInWithEmailLink",uo(t,e))}async function DC(t,e){return Th(t,"POST","/v1/accounts:signInWithEmailLink",uo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh extends ty{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new lh(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new lh(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return S1(e,n,"signInWithPassword",IC);case"emailLink":return LC(e,{email:this._email,oobCode:this._password});default:Os(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return S1(e,r,"signUpPassword",CC);case"emailLink":return DC(e,{idToken:n,email:this._email,oobCode:this._password});default:Os(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lu(t,e){return Th(t,"POST","/v1/accounts:signInWithIdp",uo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC="http://localhost";class lc extends ty{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new lc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Os("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=Qv(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new lc(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return lu(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,lu(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,lu(e,n)}buildRequest(){const e={requestUri:MC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Eh(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OC(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function FC(t){const e=_d(Nd(t)).link,n=e?_d(Nd(e)).deep_link_id:null,r=_d(Nd(t)).deep_link_id;return(r?_d(Nd(r)).link:null)||r||n||e||t}class ny{constructor(e){var n,r,i,s,o,l;const c=_d(Nd(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,f=(r=c.oobCode)!==null&&r!==void 0?r:null,g=OC((i=c.mode)!==null&&i!==void 0?i:null);bt(u&&f&&g,"argument-error"),this.apiKey=u,this.operation=g,this.code=f,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=FC(e);try{return new ny(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(){this.providerId=Ru.PROVIDER_ID}static credential(e,n){return lh._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=ny.parseLink(n);return bt(r,"argument-error"),lh._fromEmailAndCode(e,r.code,r.tenantId)}}Ru.PROVIDER_ID="password";Ru.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ru.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh extends p4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo extends kh{constructor(){super("facebook.com")}static credential(e){return lc._fromParams({providerId:qo.PROVIDER_ID,signInMethod:qo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qo.credentialFromTaggedObject(e)}static credentialFromError(e){return qo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qo.credential(e.oauthAccessToken)}catch{return null}}}qo.FACEBOOK_SIGN_IN_METHOD="facebook.com";qo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o extends kh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return lc._fromParams({providerId:$o.PROVIDER_ID,signInMethod:$o.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return $o.credentialFromTaggedObject(e)}static credentialFromError(e){return $o.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return $o.credential(n,r)}catch{return null}}}$o.GOOGLE_SIGN_IN_METHOD="google.com";$o.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho extends kh{constructor(){super("github.com")}static credential(e){return lc._fromParams({providerId:Ho.PROVIDER_ID,signInMethod:Ho.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ho.credentialFromTaggedObject(e)}static credentialFromError(e){return Ho.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ho.credential(e.oauthAccessToken)}catch{return null}}}Ho.GITHUB_SIGN_IN_METHOD="github.com";Ho.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo extends kh{constructor(){super("twitter.com")}static credential(e,n){return lc._fromParams({providerId:Wo.PROVIDER_ID,signInMethod:Wo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Wo.credentialFromTaggedObject(e)}static credentialFromError(e){return Wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Wo.credential(n,r)}catch{return null}}}Wo.TWITTER_SIGN_IN_METHOD="twitter.com";Wo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VC(t,e){return Th(t,"POST","/v1/accounts:signUp",uo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Ga._fromIdTokenResponse(e,r,i),o=ab(r);return new cc({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=ab(r);return new cc({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function ab(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm extends wa{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,zm.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new zm(e,n,r,i)}}function g4(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?zm._fromErrorAndOperation(t,s,e,r):s})}async function UC(t,e,n=!1){const r=await _u(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return cc._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BC(t,e,n=!1){const{auth:r}=t;if(ca(r.app))return Promise.reject(Qa(r));const i="reauthenticate";try{const s=await _u(t,g4(r,i,e,t),n);bt(s.idToken,r,"internal-error");const o=Zv(s.idToken);bt(o,r,"internal-error");const{sub:l}=o;return bt(t.uid===l,r,"user-mismatch"),cc._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Os(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v4(t,e,n=!1){if(ca(t.app))return Promise.reject(Qa(t));const r="signIn",i=await g4(t,r,e),s=await cc._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function zC(t,e){return v4(bc(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y4(t){const e=bc(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Cp(t,e,n){if(ca(t.app))return Promise.reject(Qa(t));const r=bc(t),o=await S1(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",VC).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&y4(t),c}),l=await cc._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function qm(t,e,n){return ca(t.app)?Promise.reject(Qa(t)):zC(Mn(t),Ru.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&y4(t),r})}async function x4(t,e){const n=Mn(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:s}=await RC(n.auth,i);s!==t.email&&await t.reload()}function qC(t,e){return $C(Mn(t),null,e)}async function $C(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(s.password=n);const o=await _u(t,kC(r,s));await t._updateTokensIfNecessary(o,!0)}function HC(t,e,n,r){return Mn(t).onIdTokenChanged(e,n,r)}function WC(t,e,n){return Mn(t).beforeAuthStateChanged(e,n)}function GC(t,e,n,r){return Mn(t).onAuthStateChanged(e,n,r)}function Ql(t){return Mn(t).signOut()}const $m="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem($m,"1"),this.storage.removeItem($m),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KC=1e3,YC=10;class w4 extends b4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=d4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);dC()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,YC):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},KC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}w4.type="LOCAL";const QC=w4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4 extends b4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}_4.type="SESSION";const N4=_4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Ip(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(o).map(async u=>u(n.origin,s)),c=await XC(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ip.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ry(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((l,c)=>{const u=ry("",20);i.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(g){const v=g;if(v.data.eventId===u)switch(v.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(v.data.response);break;default:clearTimeout(f),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ma(){return window}function ZC(t){ma().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S4(){return typeof ma().WorkerGlobalScope<"u"&&typeof ma().importScripts=="function"}async function e6(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function t6(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function n6(){return S4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E4="firebaseLocalStorageDb",r6=1,Hm="firebaseLocalStorage",A4="fbase_key";class Ch{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Pp(t,e){return t.transaction([Hm],e?"readwrite":"readonly").objectStore(Hm)}function i6(){const t=indexedDB.deleteDatabase(E4);return new Ch(t).toPromise()}function E1(){const t=indexedDB.open(E4,r6);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Hm,{keyPath:A4})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Hm)?e(r):(r.close(),await i6(),e(await E1()))})})}async function ob(t,e,n){const r=Pp(t,!0).put({[A4]:e,value:n});return new Ch(r).toPromise()}async function s6(t,e){const n=Pp(t,!1).get(e),r=await new Ch(n).toPromise();return r===void 0?null:r.value}function lb(t,e){const n=Pp(t,!0).delete(e);return new Ch(n).toPromise()}const a6=800,o6=3;class j4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await E1(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>o6)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return S4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ip._getInstance(n6()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await e6(),!this.activeServiceWorker)return;this.sender=new JC(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||t6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await E1();return await ob(e,$m,"1"),await lb(e,$m),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>ob(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>s6(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>lb(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Pp(i,!1).getAll();return new Ch(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),a6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}j4.type="LOCAL";const l6=j4;new jh(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c6(t,e){return e?Ka(e):(bt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy extends ty{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return lu(e,this._buildIdpRequest())}_linkToIdToken(e,n){return lu(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return lu(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function u6(t){return v4(t.auth,new iy(t),t.bypassAuthState)}function d6(t){const{auth:e,user:n}=t;return bt(n,e,"internal-error"),BC(n,new iy(t),t.bypassAuthState)}async function h6(t){const{auth:e,user:n}=t;return bt(n,e,"internal-error"),UC(n,new iy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return u6;case"linkViaPopup":case"linkViaRedirect":return h6;case"reauthViaPopup":case"reauthViaRedirect":return d6;default:Os(this.auth,"internal-error")}}resolve(e){so(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){so(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f6=new jh(2e3,1e4);class Jc extends T4{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Jc.currentPopupAction&&Jc.currentPopupAction.cancel(),Jc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return bt(e,this.auth,"internal-error"),e}async onExecution(){so(this.filter.length===1,"Popup operations only handle one event");const e=ry();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(fa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(fa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Jc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(fa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,f6.get())};e()}}Jc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m6="pendingRedirect",Zf=new Map;class p6 extends T4{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Zf.get(this.auth._key());if(!e){try{const r=await g6(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Zf.set(this.auth._key(),e)}return this.bypassAuthState||Zf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function g6(t,e){const n=x6(e),r=y6(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function v6(t,e){Zf.set(t._key(),e)}function y6(t){return Ka(t._redirectPersistence)}function x6(t){return Jf(m6,t.config.apiKey,t.name)}async function b6(t,e,n=!1){if(ca(t.app))return Promise.reject(Qa(t));const r=bc(t),i=c6(r,e),o=await new p6(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w6=10*60*1e3;class _6{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!N6(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!k4(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(fa(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=w6&&this.cachedEventUids.clear(),this.cachedEventUids.has(cb(e))}saveEventToCache(e){this.cachedEventUids.add(cb(e)),this.lastProcessedEventTime=Date.now()}}function cb(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function k4({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function N6(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return k4(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S6(t,e={}){return _a(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E6=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,A6=/^https?/;async function j6(t){if(t.config.emulator)return;const{authorizedDomains:e}=await S6(t);for(const n of e)try{if(T6(n))return}catch{}Os(t,"unauthorized-domain")}function T6(t){const e=_1(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!A6.test(n))return!1;if(E6.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k6=new jh(3e4,6e4);function ub(){const t=ma().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function C6(t){return new Promise((e,n)=>{var r,i,s;function o(){ub(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ub(),n(fa(t,"network-request-failed"))},timeout:k6.get()})}if(!((i=(r=ma().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ma().gapi)===null||s===void 0)&&s.load)o();else{const l=bC("iframefcb");return ma()[l]=()=>{gapi.load?o():n(fa(t,"network-request-failed"))},f4(`${xC()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw em=null,e})}let em=null;function I6(t){return em=em||C6(t),em}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P6=new jh(5e3,15e3),R6="__/auth/iframe",L6="emulator/auth/iframe",D6={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},M6=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function O6(t){const e=t.config;bt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Jv(e,L6):`https://${t.config.authDomain}/${R6}`,r={apiKey:e.apiKey,appName:t.name,v:xc},i=M6.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Eh(r).slice(1)}`}async function F6(t){const e=await I6(t),n=ma().gapi;return bt(n,t,"internal-error"),e.open({where:document.body,url:O6(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:D6,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=fa(t,"network-request-failed"),l=ma().setTimeout(()=>{s(o)},P6.get());function c(){ma().clearTimeout(l),i(r)}r.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V6={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},U6=500,B6=600,z6="_blank",q6="http://localhost";class db{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function $6(t,e,n,r=U6,i=B6){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},V6),{width:r.toString(),height:i.toString(),top:s,left:o}),u=si().toLowerCase();n&&(l=a4(u)?z6:n),i4(u)&&(e=e||q6,c.scrollbars="yes");const f=Object.entries(c).reduce((v,[m,E])=>`${v}${m}=${E},`,"");if(uC(u)&&l!=="_self")return H6(e||"",l),new db(null);const g=window.open(e||"",l,f);bt(g,t,"popup-blocked");try{g.focus()}catch{}return new db(g)}function H6(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W6="__/auth/handler",G6="emulator/auth/handler",K6=encodeURIComponent("fac");async function hb(t,e,n,r,i,s){bt(t.config.authDomain,t,"auth-domain-config-required"),bt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:xc,eventId:i};if(e instanceof p4){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",LT(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,g]of Object.entries({}))o[f]=g}if(e instanceof kh){const f=e.getScopes().filter(g=>g!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const c=await t._getAppCheckToken(),u=c?`#${K6}=${encodeURIComponent(c)}`:"";return`${Y6(t)}?${Eh(l).slice(1)}${u}`}function Y6({config:t}){return t.emulator?Jv(t,G6):`https://${t.authDomain}/${W6}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qg="webStorageSupport";class Q6{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=N4,this._completeRedirectFn=b6,this._overrideRedirectResult=v6}async _openPopup(e,n,r,i){var s;so((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await hb(e,n,r,_1(),i);return $6(e,o,ry())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await hb(e,n,r,_1(),i);return ZC(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(so(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await F6(e),r=new _6(e);return n.register("authEvent",i=>(bt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Qg,{type:Qg},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Qg];o!==void 0&&n(!!o),Os(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=j6(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return d4()||s4()||ey()}}const X6=Q6;var fb="@firebase/auth",mb="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J6{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){bt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z6(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function eI(t){dl(new ro("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;bt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:h4(t)},u=new gC(r,i,s,c);return EC(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),dl(new ro("auth-internal",e=>{const n=bc(e.getProvider("auth").getImmediate());return(r=>new J6(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ms(fb,mb,Z6(t)),ms(fb,mb,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI=5*60,nI=zN("authIdTokenMaxAge")||tI;let pb=null;const rI=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>nI)return;const i=n==null?void 0:n.token;pb!==i&&(pb=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function iI(t=Tp()){const e=Ah(t,"auth");if(e.isInitialized())return e.getImmediate();const n=SC(t,{popupRedirectResolver:X6,persistence:[l6,QC,N4]}),r=zN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=rI(s.toString());WC(n,o,()=>o(n.currentUser)),HC(n,l=>o(l))}}const i=UN("auth");return i&&AC(n,`http://${i}`),n}function sI(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}vC({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=fa("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",sI().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});eI("Browser");var gb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ec,C4;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(z,T){function k(){}k.prototype=T.prototype,z.D=T.prototype,z.prototype=new k,z.prototype.constructor=z,z.C=function(N,S,P){for(var R=Array(arguments.length-2),$=2;$<arguments.length;$++)R[$-2]=arguments[$];return T.prototype[S].apply(N,R)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(z,T,k){k||(k=0);var N=Array(16);if(typeof T=="string")for(var S=0;16>S;++S)N[S]=T.charCodeAt(k++)|T.charCodeAt(k++)<<8|T.charCodeAt(k++)<<16|T.charCodeAt(k++)<<24;else for(S=0;16>S;++S)N[S]=T[k++]|T[k++]<<8|T[k++]<<16|T[k++]<<24;T=z.g[0],k=z.g[1],S=z.g[2];var P=z.g[3],R=T+(P^k&(S^P))+N[0]+3614090360&4294967295;T=k+(R<<7&4294967295|R>>>25),R=P+(S^T&(k^S))+N[1]+3905402710&4294967295,P=T+(R<<12&4294967295|R>>>20),R=S+(k^P&(T^k))+N[2]+606105819&4294967295,S=P+(R<<17&4294967295|R>>>15),R=k+(T^S&(P^T))+N[3]+3250441966&4294967295,k=S+(R<<22&4294967295|R>>>10),R=T+(P^k&(S^P))+N[4]+4118548399&4294967295,T=k+(R<<7&4294967295|R>>>25),R=P+(S^T&(k^S))+N[5]+1200080426&4294967295,P=T+(R<<12&4294967295|R>>>20),R=S+(k^P&(T^k))+N[6]+2821735955&4294967295,S=P+(R<<17&4294967295|R>>>15),R=k+(T^S&(P^T))+N[7]+4249261313&4294967295,k=S+(R<<22&4294967295|R>>>10),R=T+(P^k&(S^P))+N[8]+1770035416&4294967295,T=k+(R<<7&4294967295|R>>>25),R=P+(S^T&(k^S))+N[9]+2336552879&4294967295,P=T+(R<<12&4294967295|R>>>20),R=S+(k^P&(T^k))+N[10]+4294925233&4294967295,S=P+(R<<17&4294967295|R>>>15),R=k+(T^S&(P^T))+N[11]+2304563134&4294967295,k=S+(R<<22&4294967295|R>>>10),R=T+(P^k&(S^P))+N[12]+1804603682&4294967295,T=k+(R<<7&4294967295|R>>>25),R=P+(S^T&(k^S))+N[13]+4254626195&4294967295,P=T+(R<<12&4294967295|R>>>20),R=S+(k^P&(T^k))+N[14]+2792965006&4294967295,S=P+(R<<17&4294967295|R>>>15),R=k+(T^S&(P^T))+N[15]+1236535329&4294967295,k=S+(R<<22&4294967295|R>>>10),R=T+(S^P&(k^S))+N[1]+4129170786&4294967295,T=k+(R<<5&4294967295|R>>>27),R=P+(k^S&(T^k))+N[6]+3225465664&4294967295,P=T+(R<<9&4294967295|R>>>23),R=S+(T^k&(P^T))+N[11]+643717713&4294967295,S=P+(R<<14&4294967295|R>>>18),R=k+(P^T&(S^P))+N[0]+3921069994&4294967295,k=S+(R<<20&4294967295|R>>>12),R=T+(S^P&(k^S))+N[5]+3593408605&4294967295,T=k+(R<<5&4294967295|R>>>27),R=P+(k^S&(T^k))+N[10]+38016083&4294967295,P=T+(R<<9&4294967295|R>>>23),R=S+(T^k&(P^T))+N[15]+3634488961&4294967295,S=P+(R<<14&4294967295|R>>>18),R=k+(P^T&(S^P))+N[4]+3889429448&4294967295,k=S+(R<<20&4294967295|R>>>12),R=T+(S^P&(k^S))+N[9]+568446438&4294967295,T=k+(R<<5&4294967295|R>>>27),R=P+(k^S&(T^k))+N[14]+3275163606&4294967295,P=T+(R<<9&4294967295|R>>>23),R=S+(T^k&(P^T))+N[3]+4107603335&4294967295,S=P+(R<<14&4294967295|R>>>18),R=k+(P^T&(S^P))+N[8]+1163531501&4294967295,k=S+(R<<20&4294967295|R>>>12),R=T+(S^P&(k^S))+N[13]+2850285829&4294967295,T=k+(R<<5&4294967295|R>>>27),R=P+(k^S&(T^k))+N[2]+4243563512&4294967295,P=T+(R<<9&4294967295|R>>>23),R=S+(T^k&(P^T))+N[7]+1735328473&4294967295,S=P+(R<<14&4294967295|R>>>18),R=k+(P^T&(S^P))+N[12]+2368359562&4294967295,k=S+(R<<20&4294967295|R>>>12),R=T+(k^S^P)+N[5]+4294588738&4294967295,T=k+(R<<4&4294967295|R>>>28),R=P+(T^k^S)+N[8]+2272392833&4294967295,P=T+(R<<11&4294967295|R>>>21),R=S+(P^T^k)+N[11]+1839030562&4294967295,S=P+(R<<16&4294967295|R>>>16),R=k+(S^P^T)+N[14]+4259657740&4294967295,k=S+(R<<23&4294967295|R>>>9),R=T+(k^S^P)+N[1]+2763975236&4294967295,T=k+(R<<4&4294967295|R>>>28),R=P+(T^k^S)+N[4]+1272893353&4294967295,P=T+(R<<11&4294967295|R>>>21),R=S+(P^T^k)+N[7]+4139469664&4294967295,S=P+(R<<16&4294967295|R>>>16),R=k+(S^P^T)+N[10]+3200236656&4294967295,k=S+(R<<23&4294967295|R>>>9),R=T+(k^S^P)+N[13]+681279174&4294967295,T=k+(R<<4&4294967295|R>>>28),R=P+(T^k^S)+N[0]+3936430074&4294967295,P=T+(R<<11&4294967295|R>>>21),R=S+(P^T^k)+N[3]+3572445317&4294967295,S=P+(R<<16&4294967295|R>>>16),R=k+(S^P^T)+N[6]+76029189&4294967295,k=S+(R<<23&4294967295|R>>>9),R=T+(k^S^P)+N[9]+3654602809&4294967295,T=k+(R<<4&4294967295|R>>>28),R=P+(T^k^S)+N[12]+3873151461&4294967295,P=T+(R<<11&4294967295|R>>>21),R=S+(P^T^k)+N[15]+530742520&4294967295,S=P+(R<<16&4294967295|R>>>16),R=k+(S^P^T)+N[2]+3299628645&4294967295,k=S+(R<<23&4294967295|R>>>9),R=T+(S^(k|~P))+N[0]+4096336452&4294967295,T=k+(R<<6&4294967295|R>>>26),R=P+(k^(T|~S))+N[7]+1126891415&4294967295,P=T+(R<<10&4294967295|R>>>22),R=S+(T^(P|~k))+N[14]+2878612391&4294967295,S=P+(R<<15&4294967295|R>>>17),R=k+(P^(S|~T))+N[5]+4237533241&4294967295,k=S+(R<<21&4294967295|R>>>11),R=T+(S^(k|~P))+N[12]+1700485571&4294967295,T=k+(R<<6&4294967295|R>>>26),R=P+(k^(T|~S))+N[3]+2399980690&4294967295,P=T+(R<<10&4294967295|R>>>22),R=S+(T^(P|~k))+N[10]+4293915773&4294967295,S=P+(R<<15&4294967295|R>>>17),R=k+(P^(S|~T))+N[1]+2240044497&4294967295,k=S+(R<<21&4294967295|R>>>11),R=T+(S^(k|~P))+N[8]+1873313359&4294967295,T=k+(R<<6&4294967295|R>>>26),R=P+(k^(T|~S))+N[15]+4264355552&4294967295,P=T+(R<<10&4294967295|R>>>22),R=S+(T^(P|~k))+N[6]+2734768916&4294967295,S=P+(R<<15&4294967295|R>>>17),R=k+(P^(S|~T))+N[13]+1309151649&4294967295,k=S+(R<<21&4294967295|R>>>11),R=T+(S^(k|~P))+N[4]+4149444226&4294967295,T=k+(R<<6&4294967295|R>>>26),R=P+(k^(T|~S))+N[11]+3174756917&4294967295,P=T+(R<<10&4294967295|R>>>22),R=S+(T^(P|~k))+N[2]+718787259&4294967295,S=P+(R<<15&4294967295|R>>>17),R=k+(P^(S|~T))+N[9]+3951481745&4294967295,z.g[0]=z.g[0]+T&4294967295,z.g[1]=z.g[1]+(S+(R<<21&4294967295|R>>>11))&4294967295,z.g[2]=z.g[2]+S&4294967295,z.g[3]=z.g[3]+P&4294967295}r.prototype.u=function(z,T){T===void 0&&(T=z.length);for(var k=T-this.blockSize,N=this.B,S=this.h,P=0;P<T;){if(S==0)for(;P<=k;)i(this,z,P),P+=this.blockSize;if(typeof z=="string"){for(;P<T;)if(N[S++]=z.charCodeAt(P++),S==this.blockSize){i(this,N),S=0;break}}else for(;P<T;)if(N[S++]=z[P++],S==this.blockSize){i(this,N),S=0;break}}this.h=S,this.o+=T},r.prototype.v=function(){var z=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);z[0]=128;for(var T=1;T<z.length-8;++T)z[T]=0;var k=8*this.o;for(T=z.length-8;T<z.length;++T)z[T]=k&255,k/=256;for(this.u(z),z=Array(16),T=k=0;4>T;++T)for(var N=0;32>N;N+=8)z[k++]=this.g[T]>>>N&255;return z};function s(z,T){var k=l;return Object.prototype.hasOwnProperty.call(k,z)?k[z]:k[z]=T(z)}function o(z,T){this.h=T;for(var k=[],N=!0,S=z.length-1;0<=S;S--){var P=z[S]|0;N&&P==T||(k[S]=P,N=!1)}this.g=k}var l={};function c(z){return-128<=z&&128>z?s(z,function(T){return new o([T|0],0>T?-1:0)}):new o([z|0],0>z?-1:0)}function u(z){if(isNaN(z)||!isFinite(z))return g;if(0>z)return C(u(-z));for(var T=[],k=1,N=0;z>=k;N++)T[N]=z/k|0,k*=4294967296;return new o(T,0)}function f(z,T){if(z.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(z.charAt(0)=="-")return C(f(z.substring(1),T));if(0<=z.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=u(Math.pow(T,8)),N=g,S=0;S<z.length;S+=8){var P=Math.min(8,z.length-S),R=parseInt(z.substring(S,S+P),T);8>P?(P=u(Math.pow(T,P)),N=N.j(P).add(u(R))):(N=N.j(k),N=N.add(u(R)))}return N}var g=c(0),v=c(1),m=c(16777216);t=o.prototype,t.m=function(){if(A(this))return-C(this).m();for(var z=0,T=1,k=0;k<this.g.length;k++){var N=this.i(k);z+=(0<=N?N:4294967296+N)*T,T*=4294967296}return z},t.toString=function(z){if(z=z||10,2>z||36<z)throw Error("radix out of range: "+z);if(E(this))return"0";if(A(this))return"-"+C(this).toString(z);for(var T=u(Math.pow(z,6)),k=this,N="";;){var S=V(k,T).g;k=b(k,S.j(T));var P=((0<k.g.length?k.g[0]:k.h)>>>0).toString(z);if(k=S,E(k))return P+N;for(;6>P.length;)P="0"+P;N=P+N}},t.i=function(z){return 0>z?0:z<this.g.length?this.g[z]:this.h};function E(z){if(z.h!=0)return!1;for(var T=0;T<z.g.length;T++)if(z.g[T]!=0)return!1;return!0}function A(z){return z.h==-1}t.l=function(z){return z=b(this,z),A(z)?-1:E(z)?0:1};function C(z){for(var T=z.g.length,k=[],N=0;N<T;N++)k[N]=~z.g[N];return new o(k,~z.h).add(v)}t.abs=function(){return A(this)?C(this):this},t.add=function(z){for(var T=Math.max(this.g.length,z.g.length),k=[],N=0,S=0;S<=T;S++){var P=N+(this.i(S)&65535)+(z.i(S)&65535),R=(P>>>16)+(this.i(S)>>>16)+(z.i(S)>>>16);N=R>>>16,P&=65535,R&=65535,k[S]=R<<16|P}return new o(k,k[k.length-1]&-2147483648?-1:0)};function b(z,T){return z.add(C(T))}t.j=function(z){if(E(this)||E(z))return g;if(A(this))return A(z)?C(this).j(C(z)):C(C(this).j(z));if(A(z))return C(this.j(C(z)));if(0>this.l(m)&&0>z.l(m))return u(this.m()*z.m());for(var T=this.g.length+z.g.length,k=[],N=0;N<2*T;N++)k[N]=0;for(N=0;N<this.g.length;N++)for(var S=0;S<z.g.length;S++){var P=this.i(N)>>>16,R=this.i(N)&65535,$=z.i(S)>>>16,H=z.i(S)&65535;k[2*N+2*S]+=R*H,I(k,2*N+2*S),k[2*N+2*S+1]+=P*H,I(k,2*N+2*S+1),k[2*N+2*S+1]+=R*$,I(k,2*N+2*S+1),k[2*N+2*S+2]+=P*$,I(k,2*N+2*S+2)}for(N=0;N<T;N++)k[N]=k[2*N+1]<<16|k[2*N];for(N=T;N<2*T;N++)k[N]=0;return new o(k,0)};function I(z,T){for(;(z[T]&65535)!=z[T];)z[T+1]+=z[T]>>>16,z[T]&=65535,T++}function O(z,T){this.g=z,this.h=T}function V(z,T){if(E(T))throw Error("division by zero");if(E(z))return new O(g,g);if(A(z))return T=V(C(z),T),new O(C(T.g),C(T.h));if(A(T))return T=V(z,C(T)),new O(C(T.g),T.h);if(30<z.g.length){if(A(z)||A(T))throw Error("slowDivide_ only works with positive integers.");for(var k=v,N=T;0>=N.l(z);)k=ne(k),N=ne(N);var S=le(k,1),P=le(N,1);for(N=le(N,2),k=le(k,2);!E(N);){var R=P.add(N);0>=R.l(z)&&(S=S.add(k),P=R),N=le(N,1),k=le(k,1)}return T=b(z,S.j(T)),new O(S,T)}for(S=g;0<=z.l(T);){for(k=Math.max(1,Math.floor(z.m()/T.m())),N=Math.ceil(Math.log(k)/Math.LN2),N=48>=N?1:Math.pow(2,N-48),P=u(k),R=P.j(T);A(R)||0<R.l(z);)k-=N,P=u(k),R=P.j(T);E(P)&&(P=v),S=S.add(P),z=b(z,R)}return new O(S,z)}t.A=function(z){return V(this,z).h},t.and=function(z){for(var T=Math.max(this.g.length,z.g.length),k=[],N=0;N<T;N++)k[N]=this.i(N)&z.i(N);return new o(k,this.h&z.h)},t.or=function(z){for(var T=Math.max(this.g.length,z.g.length),k=[],N=0;N<T;N++)k[N]=this.i(N)|z.i(N);return new o(k,this.h|z.h)},t.xor=function(z){for(var T=Math.max(this.g.length,z.g.length),k=[],N=0;N<T;N++)k[N]=this.i(N)^z.i(N);return new o(k,this.h^z.h)};function ne(z){for(var T=z.g.length+1,k=[],N=0;N<T;N++)k[N]=z.i(N)<<1|z.i(N-1)>>>31;return new o(k,z.h)}function le(z,T){var k=T>>5;T%=32;for(var N=z.g.length-k,S=[],P=0;P<N;P++)S[P]=0<T?z.i(P+k)>>>T|z.i(P+k+1)<<32-T:z.i(P+k);return new o(S,z.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,C4=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,ec=o}).apply(typeof gb<"u"?gb:typeof self<"u"?self:typeof window<"u"?window:{});var Ef=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var I4,Sd,P4,tm,A1,R4,L4,D4;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,_,L){return h==Array.prototype||h==Object.prototype||(h[_]=L.value),h};function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ef=="object"&&Ef];for(var _=0;_<h.length;++_){var L=h[_];if(L&&L.Math==Math)return L}throw Error("Cannot find global object")}var r=n(this);function i(h,_){if(_)e:{var L=r;h=h.split(".");for(var J=0;J<h.length-1;J++){var ye=h[J];if(!(ye in L))break e;L=L[ye]}h=h[h.length-1],J=L[h],_=_(J),_!=J&&_!=null&&e(L,h,{configurable:!0,writable:!0,value:_})}}function s(h,_){h instanceof String&&(h+="");var L=0,J=!1,ye={next:function(){if(!J&&L<h.length){var _e=L++;return{value:_(_e,h[_e]),done:!1}}return J=!0,{done:!0,value:void 0}}};return ye[Symbol.iterator]=function(){return ye},ye}i("Array.prototype.values",function(h){return h||function(){return s(this,function(_,L){return L})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(h){var _=typeof h;return _=_!="object"?_:h?Array.isArray(h)?"array":_:"null",_=="array"||_=="object"&&typeof h.length=="number"}function u(h){var _=typeof h;return _=="object"&&h!=null||_=="function"}function f(h,_,L){return h.call.apply(h.bind,arguments)}function g(h,_,L){if(!h)throw Error();if(2<arguments.length){var J=Array.prototype.slice.call(arguments,2);return function(){var ye=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ye,J),h.apply(_,ye)}}return function(){return h.apply(_,arguments)}}function v(h,_,L){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:g,v.apply(null,arguments)}function m(h,_){var L=Array.prototype.slice.call(arguments,1);return function(){var J=L.slice();return J.push.apply(J,arguments),h.apply(this,J)}}function E(h,_){function L(){}L.prototype=_.prototype,h.aa=_.prototype,h.prototype=new L,h.prototype.constructor=h,h.Qb=function(J,ye,_e){for(var Be=Array(arguments.length-2),$t=2;$t<arguments.length;$t++)Be[$t-2]=arguments[$t];return _.prototype[ye].apply(J,Be)}}function A(h){const _=h.length;if(0<_){const L=Array(_);for(let J=0;J<_;J++)L[J]=h[J];return L}return[]}function C(h,_){for(let L=1;L<arguments.length;L++){const J=arguments[L];if(c(J)){const ye=h.length||0,_e=J.length||0;h.length=ye+_e;for(let Be=0;Be<_e;Be++)h[ye+Be]=J[Be]}else h.push(J)}}class b{constructor(_,L){this.i=_,this.j=L,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function I(h){return/^[\s\xa0]*$/.test(h)}function O(){var h=l.navigator;return h&&(h=h.userAgent)?h:""}function V(h){return V[" "](h),h}V[" "]=function(){};var ne=O().indexOf("Gecko")!=-1&&!(O().toLowerCase().indexOf("webkit")!=-1&&O().indexOf("Edge")==-1)&&!(O().indexOf("Trident")!=-1||O().indexOf("MSIE")!=-1)&&O().indexOf("Edge")==-1;function le(h,_,L){for(const J in h)_.call(L,h[J],J,h)}function z(h,_){for(const L in h)_.call(void 0,h[L],L,h)}function T(h){const _={};for(const L in h)_[L]=h[L];return _}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(h,_){let L,J;for(let ye=1;ye<arguments.length;ye++){J=arguments[ye];for(L in J)h[L]=J[L];for(let _e=0;_e<k.length;_e++)L=k[_e],Object.prototype.hasOwnProperty.call(J,L)&&(h[L]=J[L])}}function S(h){var _=1;h=h.split(":");const L=[];for(;0<_&&h.length;)L.push(h.shift()),_--;return h.length&&L.push(h.join(":")),L}function P(h){l.setTimeout(()=>{throw h},0)}function R(){var h=ee;let _=null;return h.g&&(_=h.g,h.g=h.g.next,h.g||(h.h=null),_.next=null),_}class ${constructor(){this.h=this.g=null}add(_,L){const J=H.get();J.set(_,L),this.h?this.h.next=J:this.g=J,this.h=J}}var H=new b(()=>new Y,h=>h.reset());class Y{constructor(){this.next=this.g=this.h=null}set(_,L){this.h=_,this.g=L,this.next=null}reset(){this.next=this.g=this.h=null}}let M,U=!1,ee=new $,fe=()=>{const h=l.Promise.resolve(void 0);M=()=>{h.then(Q)}};var Q=()=>{for(var h;h=R();){try{h.h.call(h.g)}catch(L){P(L)}var _=H;_.j(h),100>_.h&&(_.h++,h.next=_.g,_.g=h)}U=!1};function w(){this.s=this.s,this.C=this.C}w.prototype.s=!1,w.prototype.ma=function(){this.s||(this.s=!0,this.N())},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(h,_){this.type=h,this.g=this.target=_,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var h=!1,_=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const L=()=>{};l.addEventListener("test",L,_),l.removeEventListener("test",L,_)}catch{}return h}();function K(h,_){if(F.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var L=this.type=h.type,J=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=_,_=h.relatedTarget){if(ne){e:{try{V(_.nodeName);var ye=!0;break e}catch{}ye=!1}ye||(_=null)}}else L=="mouseover"?_=h.fromElement:L=="mouseout"&&(_=h.toElement);this.relatedTarget=_,J?(this.clientX=J.clientX!==void 0?J.clientX:J.pageX,this.clientY=J.clientY!==void 0?J.clientY:J.pageY,this.screenX=J.screenX||0,this.screenY=J.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:te[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&K.aa.h.call(this)}}E(K,F);var te={2:"touch",3:"pen",4:"mouse"};K.prototype.h=function(){K.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var oe="closure_listenable_"+(1e6*Math.random()|0),he=0;function pe(h,_,L,J,ye){this.listener=h,this.proxy=null,this.src=_,this.type=L,this.capture=!!J,this.ha=ye,this.key=++he,this.da=this.fa=!1}function ve(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ee(h){this.src=h,this.g={},this.h=0}Ee.prototype.add=function(h,_,L,J,ye){var _e=h.toString();h=this.g[_e],h||(h=this.g[_e]=[],this.h++);var Be=ze(h,_,J,ye);return-1<Be?(_=h[Be],L||(_.fa=!1)):(_=new pe(_,this.src,_e,!!J,ye),_.fa=L,h.push(_)),_};function Ve(h,_){var L=_.type;if(L in h.g){var J=h.g[L],ye=Array.prototype.indexOf.call(J,_,void 0),_e;(_e=0<=ye)&&Array.prototype.splice.call(J,ye,1),_e&&(ve(_),h.g[L].length==0&&(delete h.g[L],h.h--))}}function ze(h,_,L,J){for(var ye=0;ye<h.length;++ye){var _e=h[ye];if(!_e.da&&_e.listener==_&&_e.capture==!!L&&_e.ha==J)return ye}return-1}var Ne="closure_lm_"+(1e6*Math.random()|0),ae={};function ht(h,_,L,J,ye){if(Array.isArray(_)){for(var _e=0;_e<_.length;_e++)ht(h,_[_e],L,J,ye);return null}return L=Et(L),h&&h[oe]?h.K(_,L,u(J)?!!J.capture:!1,ye):et(h,_,L,!1,J,ye)}function et(h,_,L,J,ye,_e){if(!_)throw Error("Invalid event type");var Be=u(ye)?!!ye.capture:!!ye,$t=Pe(h);if($t||(h[Ne]=$t=new Ee(h)),L=$t.add(_,L,J,Be,_e),L.proxy)return L;if(J=He(),L.proxy=J,J.src=h,J.listener=L,h.addEventListener)D||(ye=Be),ye===void 0&&(ye=!1),h.addEventListener(_.toString(),J,ye);else if(h.attachEvent)h.attachEvent($e(_.toString()),J);else if(h.addListener&&h.removeListener)h.addListener(J);else throw Error("addEventListener and attachEvent are unavailable.");return L}function He(){function h(L){return _.call(h.src,h.listener,L)}const _=Oe;return h}function Re(h,_,L,J,ye){if(Array.isArray(_))for(var _e=0;_e<_.length;_e++)Re(h,_[_e],L,J,ye);else J=u(J)?!!J.capture:!!J,L=Et(L),h&&h[oe]?(h=h.i,_=String(_).toString(),_ in h.g&&(_e=h.g[_],L=ze(_e,L,J,ye),-1<L&&(ve(_e[L]),Array.prototype.splice.call(_e,L,1),_e.length==0&&(delete h.g[_],h.h--)))):h&&(h=Pe(h))&&(_=h.g[_.toString()],h=-1,_&&(h=ze(_,L,J,ye)),(L=-1<h?_[h]:null)&&Xe(L))}function Xe(h){if(typeof h!="number"&&h&&!h.da){var _=h.src;if(_&&_[oe])Ve(_.i,h);else{var L=h.type,J=h.proxy;_.removeEventListener?_.removeEventListener(L,J,h.capture):_.detachEvent?_.detachEvent($e(L),J):_.addListener&&_.removeListener&&_.removeListener(J),(L=Pe(_))?(Ve(L,h),L.h==0&&(L.src=null,_[Ne]=null)):ve(h)}}}function $e(h){return h in ae?ae[h]:ae[h]="on"+h}function Oe(h,_){if(h.da)h=!0;else{_=new K(_,this);var L=h.listener,J=h.ha||h.src;h.fa&&Xe(h),h=L.call(J,_)}return h}function Pe(h){return h=h[Ne],h instanceof Ee?h:null}var qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Et(h){return typeof h=="function"?h:(h[qt]||(h[qt]=function(_){return h.handleEvent(_)}),h[qt])}function it(){w.call(this),this.i=new Ee(this),this.M=this,this.F=null}E(it,w),it.prototype[oe]=!0,it.prototype.removeEventListener=function(h,_,L,J){Re(this,h,_,L,J)};function Tt(h,_){var L,J=h.F;if(J)for(L=[];J;J=J.F)L.push(J);if(h=h.M,J=_.type||_,typeof _=="string")_=new F(_,h);else if(_ instanceof F)_.target=_.target||h;else{var ye=_;_=new F(J,h),N(_,ye)}if(ye=!0,L)for(var _e=L.length-1;0<=_e;_e--){var Be=_.g=L[_e];ye=wt(Be,J,!0,_)&&ye}if(Be=_.g=h,ye=wt(Be,J,!0,_)&&ye,ye=wt(Be,J,!1,_)&&ye,L)for(_e=0;_e<L.length;_e++)Be=_.g=L[_e],ye=wt(Be,J,!1,_)&&ye}it.prototype.N=function(){if(it.aa.N.call(this),this.i){var h=this.i,_;for(_ in h.g){for(var L=h.g[_],J=0;J<L.length;J++)ve(L[J]);delete h.g[_],h.h--}}this.F=null},it.prototype.K=function(h,_,L,J){return this.i.add(String(h),_,!1,L,J)},it.prototype.L=function(h,_,L,J){return this.i.add(String(h),_,!0,L,J)};function wt(h,_,L,J){if(_=h.i.g[String(_)],!_)return!0;_=_.concat();for(var ye=!0,_e=0;_e<_.length;++_e){var Be=_[_e];if(Be&&!Be.da&&Be.capture==L){var $t=Be.listener,Un=Be.ha||Be.src;Be.fa&&Ve(h.i,Be),ye=$t.call(Un,J)!==!1&&ye}}return ye&&!J.defaultPrevented}function at(h,_,L){if(typeof h=="function")L&&(h=v(h,L));else if(h&&typeof h.handleEvent=="function")h=v(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:l.setTimeout(h,_||0)}function vt(h){h.g=at(()=>{h.g=null,h.i&&(h.i=!1,vt(h))},h.l);const _=h.h;h.h=null,h.m.apply(null,_)}class ut extends w{constructor(_,L){super(),this.m=_,this.l=L,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:vt(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function en(h){w.call(this),this.h=h,this.g={}}E(en,w);var Gt=[];function tt(h){le(h.g,function(_,L){this.g.hasOwnProperty(L)&&Xe(_)},h),h.g={}}en.prototype.N=function(){en.aa.N.call(this),tt(this)},en.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _t=l.JSON.stringify,an=l.JSON.parse,pt=class{stringify(h){return l.JSON.stringify(h,void 0)}parse(h){return l.JSON.parse(h,void 0)}};function Dt(){}Dt.prototype.h=null;function At(h){return h.h||(h.h=h.i())}function In(){}var Sn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function nn(){F.call(this,"d")}E(nn,F);function yt(){F.call(this,"c")}E(yt,F);var Ot={},zs=null;function Xn(){return zs=zs||new it}Ot.La="serverreachability";function ts(h){F.call(this,Ot.La,h)}E(ts,F);function Br(h){const _=Xn();Tt(_,new ts(_))}Ot.STAT_EVENT="statevent";function mt(h,_){F.call(this,Ot.STAT_EVENT,h),this.stat=_}E(mt,F);function En(h){const _=Xn();Tt(_,new mt(_,h))}Ot.Ma="timingevent";function ns(h,_){F.call(this,Ot.Ma,h),this.size=_}E(ns,F);function wr(h,_){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){h()},_)}function _r(){this.g=!0}_r.prototype.xa=function(){this.g=!1};function Pn(h,_,L,J,ye,_e){h.info(function(){if(h.g)if(_e)for(var Be="",$t=_e.split("&"),Un=0;Un<$t.length;Un++){var Ft=$t[Un].split("=");if(1<Ft.length){var Mt=Ft[0];Ft=Ft[1];var wn=Mt.split("_");Be=2<=wn.length&&wn[1]=="type"?Be+(Mt+"="+Ft+"&"):Be+(Mt+"=redacted&")}}else Be=null;else Be=_e;return"XMLHTTP REQ ("+J+") [attempt "+ye+"]: "+_+`
`+L+`
`+Be})}function cr(h,_,L,J,ye,_e,Be){h.info(function(){return"XMLHTTP RESP ("+J+") [ attempt "+ye+"]: "+_+`
`+L+`
`+_e+" "+Be})}function Rn(h,_,L,J){h.info(function(){return"XMLHTTP TEXT ("+_+"): "+qs(h,L)+(J?" "+J:"")})}function Ea(h,_){h.info(function(){return"TIMEOUT: "+_})}_r.prototype.info=function(){};function qs(h,_){if(!h.g)return _;if(!_)return null;try{var L=JSON.parse(_);if(L){for(h=0;h<L.length;h++)if(Array.isArray(L[h])){var J=L[h];if(!(2>J.length)){var ye=J[1];if(Array.isArray(ye)&&!(1>ye.length)){var _e=ye[0];if(_e!="noop"&&_e!="stop"&&_e!="close")for(var Be=1;Be<ye.length;Be++)ye[Be]=""}}}}return _t(L)}catch{return _}}var zr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ii={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ai;function qr(){}E(qr,Dt),qr.prototype.g=function(){return new XMLHttpRequest},qr.prototype.i=function(){return{}},ai=new qr;function Jn(h,_,L,J){this.j=h,this.i=_,this.l=L,this.R=J||1,this.U=new en(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new $s}function $s(){this.i=null,this.g="",this.h=!1}var Pi={},xs={};function Hs(h,_,L){h.L=1,h.v=ka(oi(_)),h.m=L,h.P=!0,Aa(h,null)}function Aa(h,_){h.F=Date.now(),Ws(h),h.A=oi(h.v);var L=h.A,J=h.R;Array.isArray(J)||(J=[String(J)]),xt(L.i,"t",J),h.C=0,L=h.j.J,h.h=new $s,h.g=Hn(h.j,L?_:null,!h.m),0<h.O&&(h.M=new ut(v(h.Y,h,h.g),h.O)),_=h.U,L=h.g,J=h.ca;var ye="readystatechange";Array.isArray(ye)||(ye&&(Gt[0]=ye.toString()),ye=Gt);for(var _e=0;_e<ye.length;_e++){var Be=ht(L,ye[_e],J||_.handleEvent,!1,_.h||_);if(!Be)break;_.g[Be.key]=Be}_=h.H?T(h.H):{},h.m?(h.u||(h.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,_)):(h.u="GET",h.g.ea(h.A,h.u,null,_)),Br(),Pn(h.i,h.u,h.A,h.l,h.R,h.m)}Jn.prototype.ca=function(h){h=h.target;const _=this.M;_&&xi(h)==3?_.j():this.Y(h)},Jn.prototype.Y=function(h){try{if(h==this.g)e:{const wn=xi(this.g);var _=this.g.Ba();const Mi=this.g.Z();if(!(3>wn)&&(wn!=3||this.g&&(this.h.h||this.g.oa()||Rl(this.g)))){this.J||wn!=4||_==7||(_==8||0>=Mi?Br(3):Br(2)),fo(this);var L=this.g.Z();this.X=L;t:if(ja(this)){var J=Rl(this.g);h="";var ye=J.length,_e=xi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ri(this),Nr(this);var Be="";break t}this.h.i=new l.TextDecoder}for(_=0;_<ye;_++)this.h.h=!0,h+=this.h.i.decode(J[_],{stream:!(_e&&_==ye-1)});J.length=0,this.h.g+=h,this.C=0,Be=this.h.g}else Be=this.g.oa();if(this.o=L==200,cr(this.i,this.u,this.A,this.l,this.R,wn,L),this.o){if(this.T&&!this.K){t:{if(this.g){var $t,Un=this.g;if(($t=Un.g?Un.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I($t)){var Ft=$t;break t}}Ft=null}if(L=Ft)Rn(this.i,this.l,L,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,mo(this,L);else{this.o=!1,this.s=3,En(12),Ri(this),Nr(this);break e}}if(this.P){L=!0;let $r;for(;!this.J&&this.C<Be.length;)if($r=Uu(this,Be),$r==xs){wn==4&&(this.s=4,En(14),L=!1),Rn(this.i,this.l,null,"[Incomplete Response]");break}else if($r==Pi){this.s=4,En(15),Rn(this.i,this.l,Be,"[Invalid Chunk]"),L=!1;break}else Rn(this.i,this.l,$r,null),mo(this,$r);if(ja(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),wn!=4||Be.length!=0||this.h.h||(this.s=1,En(16),L=!1),this.o=this.o&&L,!L)Rn(this.i,this.l,Be,"[Invalid Chunked Response]"),Ri(this),Nr(this);else if(0<Be.length&&!this.W){this.W=!0;var Mt=this.j;Mt.g==this&&Mt.ba&&!Mt.M&&(Mt.j.info("Great, no buffering proxy detected. Bytes received: "+Be.length),Ge(Mt),Mt.M=!0,En(11))}}else Rn(this.i,this.l,Be,null),mo(this,Be);wn==4&&Ri(this),this.o&&!this.J&&(wn==4?Nt(this.j,this):(this.o=!1,Ws(this)))}else Ns(this.g),L==400&&0<Be.indexOf("Unknown SID")?(this.s=3,En(12)):(this.s=0,En(13)),Ri(this),Nr(this)}}}catch{}finally{}};function ja(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Uu(h,_){var L=h.C,J=_.indexOf(`
`,L);return J==-1?xs:(L=Number(_.substring(L,J)),isNaN(L)?Pi:(J+=1,J+L>_.length?xs:(_=_.slice(J,J+L),h.C=J+L,_)))}Jn.prototype.cancel=function(){this.J=!0,Ri(this)};function Ws(h){h.S=Date.now()+h.I,_l(h,h.I)}function _l(h,_){if(h.B!=null)throw Error("WatchDog timer not null");h.B=wr(v(h.ba,h),_)}function fo(h){h.B&&(l.clearTimeout(h.B),h.B=null)}Jn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(Ea(this.i,this.A),this.L!=2&&(Br(),En(17)),Ri(this),this.s=2,Nr(this)):_l(this,this.S-h)};function Nr(h){h.j.G==0||h.J||Nt(h.j,h)}function Ri(h){fo(h);var _=h.M;_&&typeof _.ma=="function"&&_.ma(),h.M=null,tt(h.U),h.g&&(_=h.g,h.g=null,_.abort(),_.ma())}function mo(h,_){try{var L=h.j;if(L.G!=0&&(L.g==h||Gs(L.h,h))){if(!h.K&&Gs(L.h,h)&&L.G==3){try{var J=L.Da.g.parse(_)}catch{J=null}if(Array.isArray(J)&&J.length==3){var ye=J;if(ye[0]==0){e:if(!L.u){if(L.g)if(L.g.F+3e3<h.F)gt(L),ss(L);else break e;Ce(L),En(18)}}else L.za=ye[1],0<L.za-L.T&&37500>ye[2]&&L.F&&L.v==0&&!L.C&&(L.C=wr(v(L.Za,L),6e3));if(1>=Al(L.h)&&L.ca){try{L.ca()}catch{}L.ca=void 0}}else rn(L,11)}else if((h.K||L.g==h)&&gt(L),!I(_))for(ye=L.Da.g.parse(_),_=0;_<ye.length;_++){let Ft=ye[_];if(L.T=Ft[0],Ft=Ft[1],L.G==2)if(Ft[0]=="c"){L.K=Ft[1],L.ia=Ft[2];const Mt=Ft[3];Mt!=null&&(L.la=Mt,L.j.info("VER="+L.la));const wn=Ft[4];wn!=null&&(L.Aa=wn,L.j.info("SVER="+L.Aa));const Mi=Ft[5];Mi!=null&&typeof Mi=="number"&&0<Mi&&(J=1.5*Mi,L.L=J,L.j.info("backChannelRequestTimeoutMs_="+J)),J=L;const $r=h.g;if($r){const Cr=$r.g?$r.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Cr){var _e=J.h;_e.g||Cr.indexOf("spdy")==-1&&Cr.indexOf("quic")==-1&&Cr.indexOf("h2")==-1||(_e.j=_e.l,_e.g=new Set,_e.h&&(jl(_e,_e.h),_e.h=null))}if(J.D){const Ss=$r.g?$r.g.getResponseHeader("X-HTTP-Session-Id"):null;Ss&&(J.ya=Ss,Ut(J.I,J.D,Ss))}}L.G=3,L.l&&L.l.ua(),L.ba&&(L.R=Date.now()-h.F,L.j.info("Handshake RTT: "+L.R+"ms")),J=L;var Be=h;if(J.qa=ln(J,J.J?J.ia:null,J.W),Be.K){On(J.h,Be);var $t=Be,Un=J.L;Un&&($t.I=Un),$t.B&&(fo($t),Ws($t)),J.g=Be}else Ae(J);0<L.i.length&&y(L)}else Ft[0]!="stop"&&Ft[0]!="close"||rn(L,7);else L.G==3&&(Ft[0]=="stop"||Ft[0]=="close"?Ft[0]=="stop"?rn(L,7):wo(L):Ft[0]!="noop"&&L.l&&L.l.ta(Ft),L.v=0)}}Br(4)}catch{}}var Nl=class{constructor(h,_){this.g=h,this.map=_}};function Sl(h){this.l=h||10,l.PerformanceNavigationTiming?(h=l.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function El(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Al(h){return h.h?1:h.g?h.g.size:0}function Gs(h,_){return h.h?h.h==_:h.g?h.g.has(_):!1}function jl(h,_){h.g?h.g.add(_):h.h=_}function On(h,_){h.h&&h.h==_?h.h=null:h.g&&h.g.has(_)&&h.g.delete(_)}Sl.prototype.cancel=function(){if(this.i=Tl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Tl(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let _=h.i;for(const L of h.g.values())_=_.concat(L.D);return _}return A(h.i)}function Ec(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(c(h)){for(var _=[],L=h.length,J=0;J<L;J++)_.push(h[J]);return _}_=[],L=0;for(J in h)_[L++]=h[J];return _}function bs(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(c(h)||typeof h=="string"){var _=[];h=h.length;for(var L=0;L<h;L++)_.push(L);return _}_=[],L=0;for(const J in h)_[L++]=J;return _}}}function Ks(h,_){if(h.forEach&&typeof h.forEach=="function")h.forEach(_,void 0);else if(c(h)||typeof h=="string")Array.prototype.forEach.call(h,_,void 0);else for(var L=bs(h),J=Ec(h),ye=J.length,_e=0;_e<ye;_e++)_.call(void 0,J[_e],L&&L[_e],h)}var gi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ta(h,_){if(h){h=h.split("&");for(var L=0;L<h.length;L++){var J=h[L].indexOf("="),ye=null;if(0<=J){var _e=h[L].substring(0,J);ye=h[L].substring(J+1)}else _e=h[L];_(_e,ye?decodeURIComponent(ye.replace(/\+/g," ")):"")}}}function on(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof on){this.h=h.h,po(this,h.j),this.o=h.o,this.g=h.g,go(this,h.s),this.l=h.l;var _=h.i,L=new yi;L.i=_.i,_.g&&(L.g=new Map(_.g),L.h=_.h),Ac(this,L),this.m=h.m}else h&&(_=String(h).match(gi))?(this.h=!1,po(this,_[1]||"",!0),this.o=Ys(_[2]||""),this.g=Ys(_[3]||"",!0),go(this,_[4]),this.l=Ys(_[5]||"",!0),Ac(this,_[6]||"",!0),this.m=Ys(_[7]||"")):(this.h=!1,this.i=new yi(null,this.h))}on.prototype.toString=function(){var h=[],_=this.j;_&&h.push(vi(_,jc,!0),":");var L=this.g;return(L||_=="file")&&(h.push("//"),(_=this.o)&&h.push(vi(_,jc,!0),"@"),h.push(encodeURIComponent(String(L)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),L=this.s,L!=null&&h.push(":",String(L))),(L=this.l)&&(this.g&&L.charAt(0)!="/"&&h.push("/"),h.push(vi(L,L.charAt(0)=="/"?zu:Bu,!0))),(L=this.i.toString())&&h.push("?",L),(L=this.m)&&h.push("#",vi(L,Ca)),h.join("")};function oi(h){return new on(h)}function po(h,_,L){h.j=L?Ys(_,!0):_,h.j&&(h.j=h.j.replace(/:$/,""))}function go(h,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);h.s=_}else h.s=null}function Ac(h,_,L){_ instanceof yi?(h.i=_,qu(h.i,h.h)):(L||(_=vi(_,Cl)),h.i=new yi(_,h.h))}function Ut(h,_,L){h.i.set(_,L)}function ka(h){return Ut(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Ys(h,_){return h?_?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function vi(h,_,L){return typeof h=="string"?(h=encodeURI(h).replace(_,kl),L&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function kl(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var jc=/[#\/\?@]/g,Bu=/[#\?:]/g,zu=/[#\?]/g,Cl=/[#\?@]/g,Ca=/#/g;function yi(h,_){this.h=this.g=null,this.i=h||null,this.j=!!_}function rs(h){h.g||(h.g=new Map,h.h=0,h.i&&Ta(h.i,function(_,L){h.add(decodeURIComponent(_.replace(/\+/g," ")),L)}))}t=yi.prototype,t.add=function(h,_){rs(this),this.i=null,h=Xs(this,h);var L=this.g.get(h);return L||this.g.set(h,L=[]),L.push(_),this.h+=1,this};function Qs(h,_){rs(h),_=Xs(h,_),h.g.has(_)&&(h.i=null,h.h-=h.g.get(_).length,h.g.delete(_))}function vo(h,_){return rs(h),_=Xs(h,_),h.g.has(_)}t.forEach=function(h,_){rs(this),this.g.forEach(function(L,J){L.forEach(function(ye){h.call(_,ye,J,this)},this)},this)},t.na=function(){rs(this);const h=Array.from(this.g.values()),_=Array.from(this.g.keys()),L=[];for(let J=0;J<_.length;J++){const ye=h[J];for(let _e=0;_e<ye.length;_e++)L.push(_[J])}return L},t.V=function(h){rs(this);let _=[];if(typeof h=="string")vo(this,h)&&(_=_.concat(this.g.get(Xs(this,h))));else{h=Array.from(this.g.values());for(let L=0;L<h.length;L++)_=_.concat(h[L])}return _},t.set=function(h,_){return rs(this),this.i=null,h=Xs(this,h),vo(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[_]),this.h+=1,this},t.get=function(h,_){return h?(h=this.V(h),0<h.length?String(h[0]):_):_};function xt(h,_,L){Qs(h,_),0<L.length&&(h.i=null,h.g.set(Xs(h,_),A(L)),h.h+=L.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],_=Array.from(this.g.keys());for(var L=0;L<_.length;L++){var J=_[L];const _e=encodeURIComponent(String(J)),Be=this.V(J);for(J=0;J<Be.length;J++){var ye=_e;Be[J]!==""&&(ye+="="+encodeURIComponent(String(Be[J]))),h.push(ye)}}return this.i=h.join("&")};function Xs(h,_){return _=String(_),h.j&&(_=_.toLowerCase()),_}function qu(h,_){_&&!h.j&&(rs(h),h.i=null,h.g.forEach(function(L,J){var ye=J.toLowerCase();J!=ye&&(Qs(this,J),xt(this,ye,L))},h)),h.j=_}function $u(h,_){const L=new _r;if(l.Image){const J=new Image;J.onload=m(Sr,L,"TestLoadImage: loaded",!0,_,J),J.onerror=m(Sr,L,"TestLoadImage: error",!1,_,J),J.onabort=m(Sr,L,"TestLoadImage: abort",!1,_,J),J.ontimeout=m(Sr,L,"TestLoadImage: timeout",!1,_,J),l.setTimeout(function(){J.ontimeout&&J.ontimeout()},1e4),J.src=h}else _(!1)}function Hu(h,_){const L=new _r,J=new AbortController,ye=setTimeout(()=>{J.abort(),Sr(L,"TestPingServer: timeout",!1,_)},1e4);fetch(h,{signal:J.signal}).then(_e=>{clearTimeout(ye),_e.ok?Sr(L,"TestPingServer: ok",!0,_):Sr(L,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(ye),Sr(L,"TestPingServer: error",!1,_)})}function Sr(h,_,L,J,ye){try{ye&&(ye.onload=null,ye.onerror=null,ye.onabort=null,ye.ontimeout=null),J(L)}catch{}}function ws(){this.g=new pt}function Wu(h,_,L){const J=L||"";try{Ks(h,function(ye,_e){let Be=ye;u(ye)&&(Be=_t(ye)),_.push(J+_e+"="+encodeURIComponent(Be))})}catch(ye){throw _.push(J+"type="+encodeURIComponent("_badmap")),ye}}function yo(h){this.l=h.Ub||null,this.j=h.eb||!1}E(yo,Dt),yo.prototype.g=function(){return new _s(this.l,this.j)},yo.prototype.i=function(h){return function(){return h}}({});function _s(h,_){it.call(this),this.D=h,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(_s,it),t=_s.prototype,t.open=function(h,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=_,this.readyState=1,is(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(_.body=h),(this.D||l).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Li(this)),this.readyState=0},t.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,is(this)),this.g&&(this.readyState=3,is(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;xo(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function xo(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}t.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var _=h.value?h.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!h.done}))&&(this.response=this.responseText+=_)}h.done?Li(this):is(this),this.readyState==3&&xo(this)}},t.Ra=function(h){this.g&&(this.response=this.responseText=h,Li(this))},t.Qa=function(h){this.g&&(this.response=h,Li(this))},t.ga=function(){this.g&&Li(this)};function Li(h){h.readyState=4,h.l=null,h.j=null,h.v=null,is(h)}t.setRequestHeader=function(h,_){this.u.append(h,_)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],_=this.h.entries();for(var L=_.next();!L.done;)L=L.value,h.push(L[0]+": "+L[1]),L=_.next();return h.join(`\r
`)};function is(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(_s.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Ia(h){let _="";return le(h,function(L,J){_+=J,_+=":",_+=L,_+=`\r
`}),_}function Il(h,_,L){e:{for(J in L){var J=!1;break e}J=!0}J||(L=Ia(L),typeof h=="string"?L!=null&&encodeURIComponent(String(L)):Ut(h,_,L))}function pn(h){it.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(pn,it);var Pl=/^https?$/i,Pa=["POST","PUT"];t=pn.prototype,t.Ha=function(h){this.J=h},t.ea=function(h,_,L,J){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);_=_?_.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ai.g(),this.v=this.o?At(this.o):At(ai),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(_,String(h),!0),this.B=!1}catch(_e){Js(this,_e);return}if(h=L||"",L=new Map(this.headers),J)if(Object.getPrototypeOf(J)===Object.prototype)for(var ye in J)L.set(ye,J[ye]);else if(typeof J.keys=="function"&&typeof J.get=="function")for(const _e of J.keys())L.set(_e,J.get(_e));else throw Error("Unknown input type for opt_headers: "+String(J));J=Array.from(L.keys()).find(_e=>_e.toLowerCase()=="content-type"),ye=l.FormData&&h instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Pa,_,void 0))||J||ye||L.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[_e,Be]of L)this.g.setRequestHeader(_e,Be);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ea(this),this.u=!0,this.g.send(h),this.u=!1}catch(_e){Js(this,_e)}};function Js(h,_){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=_,h.m=5,bo(h),Zs(h)}function bo(h){h.A||(h.A=!0,Tt(h,"complete"),Tt(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Tt(this,"complete"),Tt(this,"abort"),Zs(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zs(this,!0)),pn.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ra(this):this.bb())},t.bb=function(){Ra(this)};function Ra(h){if(h.h&&typeof o<"u"&&(!h.v[1]||xi(h)!=4||h.Z()!=2)){if(h.u&&xi(h)==4)at(h.Ea,0,h);else if(Tt(h,"readystatechange"),xi(h)==4){h.h=!1;try{const Be=h.Z();e:switch(Be){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var L;if(!(L=_)){var J;if(J=Be===0){var ye=String(h.D).match(gi)[1]||null;!ye&&l.self&&l.self.location&&(ye=l.self.location.protocol.slice(0,-1)),J=!Pl.test(ye?ye.toLowerCase():"")}L=J}if(L)Tt(h,"complete"),Tt(h,"success");else{h.m=6;try{var _e=2<xi(h)?h.g.statusText:""}catch{_e=""}h.l=_e+" ["+h.Z()+"]",bo(h)}}finally{Zs(h)}}}}function Zs(h,_){if(h.g){ea(h);const L=h.g,J=h.v[0]?()=>{}:null;h.g=null,h.v=null,_||Tt(h,"ready");try{L.onreadystatechange=J}catch{}}}function ea(h){h.I&&(l.clearTimeout(h.I),h.I=null)}t.isActive=function(){return!!this.g};function xi(h){return h.g?h.g.readyState:0}t.Z=function(){try{return 2<xi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(h){if(this.g){var _=this.g.responseText;return h&&_.indexOf(h)==0&&(_=_.substring(h.length)),an(_)}};function Rl(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Ns(h){const _={};h=(h.g&&2<=xi(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let J=0;J<h.length;J++){if(I(h[J]))continue;var L=S(h[J]);const ye=L[0];if(L=L[1],typeof L!="string")continue;L=L.trim();const _e=_[ye]||[];_[ye]=_e,_e.push(L)}z(_,function(J){return J.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function li(h,_,L){return L&&L.internalChannelParams&&L.internalChannelParams[h]||_}function Ll(h){this.Aa=0,this.i=[],this.j=new _r,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=li("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=li("baseRetryDelayMs",5e3,h),this.cb=li("retryDelaySeedMs",1e4,h),this.Wa=li("forwardChannelMaxRetries",2,h),this.wa=li("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new Sl(h&&h.concurrentRequestLimit),this.Da=new ws,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Ll.prototype,t.la=8,t.G=1,t.connect=function(h,_,L,J){En(0),this.W=h,this.H=_||{},L&&J!==void 0&&(this.H.OSID=L,this.H.OAID=J),this.F=this.X,this.I=ln(this,null,this.W),y(this)};function wo(h){if(Dl(h),h.G==3){var _=h.U++,L=oi(h.I);if(Ut(L,"SID",h.K),Ut(L,"RID",_),Ut(L,"TYPE","terminate"),ce(h,L),_=new Jn(h,h.j,_),_.L=2,_.v=ka(oi(L)),L=!1,l.navigator&&l.navigator.sendBeacon)try{L=l.navigator.sendBeacon(_.v.toString(),"")}catch{}!L&&l.Image&&(new Image().src=_.v,L=!0),L||(_.g=Hn(_.j,null),_.g.ea(_.v)),_.F=Date.now(),Ws(_)}Fn(h)}function ss(h){h.g&&(Ge(h),h.g.cancel(),h.g=null)}function Dl(h){ss(h),h.u&&(l.clearTimeout(h.u),h.u=null),gt(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&l.clearTimeout(h.s),h.s=null)}function y(h){if(!El(h.h)&&!h.s){h.s=!0;var _=h.Ga;M||fe(),U||(M(),U=!0),ee.add(_,h),h.B=0}}function B(h,_){return Al(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=_.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=wr(v(h.Ga,h,_),Kt(h,h.B)),h.B++,!0)}t.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const ye=new Jn(this,this.j,h);let _e=this.o;if(this.S&&(_e?(_e=T(_e),N(_e,this.S)):_e=this.S),this.m!==null||this.O||(ye.H=_e,_e=null),this.P)e:{for(var _=0,L=0;L<this.i.length;L++){t:{var J=this.i[L];if("__data__"in J.map&&(J=J.map.__data__,typeof J=="string")){J=J.length;break t}J=void 0}if(J===void 0)break;if(_+=J,4096<_){_=L;break e}if(_===4096||L===this.i.length-1){_=L+1;break e}}_=1e3}else _=1e3;_=ge(this,ye,_),L=oi(this.I),Ut(L,"RID",h),Ut(L,"CVER",22),this.D&&Ut(L,"X-HTTP-Session-Id",this.D),ce(this,L),_e&&(this.O?_="headers="+encodeURIComponent(String(Ia(_e)))+"&"+_:this.m&&Il(L,this.m,_e)),jl(this.h,ye),this.Ua&&Ut(L,"TYPE","init"),this.P?(Ut(L,"$req",_),Ut(L,"SID","null"),ye.T=!0,Hs(ye,L,null)):Hs(ye,L,_),this.G=2}}else this.G==3&&(h?re(this,h):this.i.length==0||El(this.h)||re(this))};function re(h,_){var L;_?L=_.l:L=h.U++;const J=oi(h.I);Ut(J,"SID",h.K),Ut(J,"RID",L),Ut(J,"AID",h.T),ce(h,J),h.m&&h.o&&Il(J,h.m,h.o),L=new Jn(h,h.j,L,h.B+1),h.m===null&&(L.H=h.o),_&&(h.i=_.D.concat(h.i)),_=ge(h,L,1e3),L.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),jl(h.h,L),Hs(L,J,_)}function ce(h,_){h.H&&le(h.H,function(L,J){Ut(_,J,L)}),h.l&&Ks({},function(L,J){Ut(_,J,L)})}function ge(h,_,L){L=Math.min(h.i.length,L);var J=h.l?v(h.l.Na,h.l,h):null;e:{var ye=h.i;let _e=-1;for(;;){const Be=["count="+L];_e==-1?0<L?(_e=ye[0].g,Be.push("ofs="+_e)):_e=0:Be.push("ofs="+_e);let $t=!0;for(let Un=0;Un<L;Un++){let Ft=ye[Un].g;const Mt=ye[Un].map;if(Ft-=_e,0>Ft)_e=Math.max(0,ye[Un].g-100),$t=!1;else try{Wu(Mt,Be,"req"+Ft+"_")}catch{J&&J(Mt)}}if($t){J=Be.join("&");break e}}}return h=h.i.splice(0,L),_.D=h,J}function Ae(h){if(!h.g&&!h.u){h.Y=1;var _=h.Fa;M||fe(),U||(M(),U=!0),ee.add(_,h),h.v=0}}function Ce(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=wr(v(h.Fa,h),Kt(h,h.v)),h.v++,!0)}t.Fa=function(){if(this.u=null,Je(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=wr(v(this.ab,this),h)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,En(10),ss(this),Je(this))};function Ge(h){h.A!=null&&(l.clearTimeout(h.A),h.A=null)}function Je(h){h.g=new Jn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var _=oi(h.qa);Ut(_,"RID","rpc"),Ut(_,"SID",h.K),Ut(_,"AID",h.T),Ut(_,"CI",h.F?"0":"1"),!h.F&&h.ja&&Ut(_,"TO",h.ja),Ut(_,"TYPE","xmlhttp"),ce(h,_),h.m&&h.o&&Il(_,h.m,h.o),h.L&&(h.g.I=h.L);var L=h.g;h=h.ia,L.L=1,L.v=ka(oi(_)),L.m=null,L.P=!0,Aa(L,h)}t.Za=function(){this.C!=null&&(this.C=null,ss(this),Ce(this),En(19))};function gt(h){h.C!=null&&(l.clearTimeout(h.C),h.C=null)}function Nt(h,_){var L=null;if(h.g==_){gt(h),Ge(h),h.g=null;var J=2}else if(Gs(h.h,_))L=_.D,On(h.h,_),J=1;else return;if(h.G!=0){if(_.o)if(J==1){L=_.m?_.m.length:0,_=Date.now()-_.F;var ye=h.B;J=Xn(),Tt(J,new ns(J,L)),y(h)}else Ae(h);else if(ye=_.s,ye==3||ye==0&&0<_.X||!(J==1&&B(h,_)||J==2&&Ce(h)))switch(L&&0<L.length&&(_=h.h,_.i=_.i.concat(L)),ye){case 1:rn(h,5);break;case 4:rn(h,10);break;case 3:rn(h,6);break;default:rn(h,2)}}}function Kt(h,_){let L=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(L*=2),L*_}function rn(h,_){if(h.j.info("Error code "+_),_==2){var L=v(h.fb,h),J=h.Xa;const ye=!J;J=new on(J||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||po(J,"https"),ka(J),ye?$u(J.toString(),L):Hu(J.toString(),L)}else En(2);h.G=0,h.l&&h.l.sa(_),Fn(h),Dl(h)}t.fb=function(h){h?(this.j.info("Successfully pinged google.com"),En(2)):(this.j.info("Failed to ping google.com"),En(1))};function Fn(h){if(h.G=0,h.ka=[],h.l){const _=Tl(h.h);(_.length!=0||h.i.length!=0)&&(C(h.ka,_),C(h.ka,h.i),h.h.i.length=0,A(h.i),h.i.length=0),h.l.ra()}}function ln(h,_,L){var J=L instanceof on?oi(L):new on(L);if(J.g!="")_&&(J.g=_+"."+J.g),go(J,J.s);else{var ye=l.location;J=ye.protocol,_=_?_+"."+ye.hostname:ye.hostname,ye=+ye.port;var _e=new on(null);J&&po(_e,J),_&&(_e.g=_),ye&&go(_e,ye),L&&(_e.l=L),J=_e}return L=h.D,_=h.ya,L&&_&&Ut(J,L,_),Ut(J,"VER",h.la),ce(h,J),J}function Hn(h,_,L){if(_&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=h.Ca&&!h.pa?new pn(new yo({eb:L})):new pn(h.pa),_.Ha(h.J),_}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Vn(){}t=Vn.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Wn(){}Wn.prototype.g=function(h,_){return new bn(h,_)};function bn(h,_){it.call(this),this.g=new Ll(_),this.l=h,this.h=_&&_.messageUrlParams||null,h=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(h?h["X-WebChannel-Content-Type"]=_.messageContentType:h={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(h?h["X-WebChannel-Client-Profile"]=_.va:h={"X-WebChannel-Client-Profile":_.va}),this.g.S=h,(h=_&&_.Sb)&&!I(h)&&(this.g.m=h),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!I(_)&&(this.g.D=_,h=this.h,h!==null&&_ in h&&(h=this.h,_ in h&&delete h[_])),this.j=new Di(this)}E(bn,it),bn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},bn.prototype.close=function(){wo(this.g)},bn.prototype.o=function(h){var _=this.g;if(typeof h=="string"){var L={};L.__data__=h,h=L}else this.u&&(L={},L.__data__=_t(h),h=L);_.i.push(new Nl(_.Ya++,h)),_.G==3&&y(_)},bn.prototype.N=function(){this.g.l=null,delete this.j,wo(this.g),delete this.g,bn.aa.N.call(this)};function kr(h){nn.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var _=h.__sm__;if(_){e:{for(const L in _){h=L;break e}h=void 0}(this.i=h)&&(h=this.i,_=_!==null&&h in _?_[h]:void 0),this.data=_}else this.data=h}E(kr,nn);function Ml(){yt.call(this),this.status=1}E(Ml,yt);function Di(h){this.g=h}E(Di,Vn),Di.prototype.ua=function(){Tt(this.g,"a")},Di.prototype.ta=function(h){Tt(this.g,new kr(h))},Di.prototype.sa=function(h){Tt(this.g,new Ml)},Di.prototype.ra=function(){Tt(this.g,"b")},Wn.prototype.createWebChannel=Wn.prototype.g,bn.prototype.send=bn.prototype.o,bn.prototype.open=bn.prototype.m,bn.prototype.close=bn.prototype.close,D4=function(){return new Wn},L4=function(){return Xn()},R4=Ot,A1={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},zr.NO_ERROR=0,zr.TIMEOUT=8,zr.HTTP_ERROR=6,tm=zr,Ii.COMPLETE="complete",P4=Ii,In.EventType=Sn,Sn.OPEN="a",Sn.CLOSE="b",Sn.ERROR="c",Sn.MESSAGE="d",it.prototype.listen=it.prototype.K,Sd=In,pn.prototype.listenOnce=pn.prototype.L,pn.prototype.getLastError=pn.prototype.Ka,pn.prototype.getLastErrorCode=pn.prototype.Ba,pn.prototype.getStatus=pn.prototype.Z,pn.prototype.getResponseJson=pn.prototype.Oa,pn.prototype.getResponseText=pn.prototype.oa,pn.prototype.send=pn.prototype.ea,pn.prototype.setWithCredentials=pn.prototype.Ha,I4=pn}).apply(typeof Ef<"u"?Ef:typeof self<"u"?self:typeof window<"u"?window:{});const vb="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Zr.UNAUTHENTICATED=new Zr(null),Zr.GOOGLE_CREDENTIALS=new Zr("google-credentials-uid"),Zr.FIRST_PARTY=new Zr("first-party-uid"),Zr.MOCK_USER=new Zr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lu="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uc=new Kv("@firebase/firestore");function pd(){return uc.logLevel}function Ze(t,...e){if(uc.logLevel<=Wt.DEBUG){const n=e.map(sy);uc.debug(`Firestore (${Lu}): ${t}`,...n)}}function ao(t,...e){if(uc.logLevel<=Wt.ERROR){const n=e.map(sy);uc.error(`Firestore (${Lu}): ${t}`,...n)}}function Nu(t,...e){if(uc.logLevel<=Wt.WARN){const n=e.map(sy);uc.warn(`Firestore (${Lu}): ${t}`,...n)}}function sy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jt(t="Unexpected state"){const e=`FIRESTORE (${Lu}) INTERNAL ASSERTION FAILED: `+t;throw ao(e),new Error(e)}function mn(t,e){t||jt()}function It(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ke={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class We extends wa{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class aI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Zr.UNAUTHENTICATED))}shutdown(){}}class oI{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class lI{constructor(e){this.t=e,this.currentUser=Zr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){mn(this.o===void 0);let r=this.i;const i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let s=new Xa;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Xa,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},l=c=>{Ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Xa)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(mn(typeof r.accessToken=="string"),new M4(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return mn(e===null||typeof e=="string"),new Zr(e)}}class cI{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Zr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class uI{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new cI(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Zr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class dI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class hI{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){mn(this.o===void 0);const r=s=>{s.error!=null&&Ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,Ze("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(mn(typeof n.token=="string"),this.R=n.token,new dI(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O4{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=fI(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function tn(t,e){return t<e?-1:t>e?1:0}function Su(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new We(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new We(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new We(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new We(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return dt.fromMillis(Date.now())}static fromDate(e){return dt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new dt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?tn(this.nanoseconds,e.nanoseconds):tn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ct(e)}static min(){return new Ct(new dt(0,0))}static max(){return new Ct(new dt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(e,n,r){n===void 0?n=0:n>e.length&&jt(),r===void 0?r=e.length-n:r>e.length-n&&jt(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ch.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ch?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Tn extends ch{construct(e,n,r){return new Tn(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new We(ke.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Tn(n)}static emptyPath(){return new Tn([])}}const mI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Mr extends ch{construct(e,n,r){return new Mr(e,n,r)}static isValidIdentifier(e){return mI.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Mr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Mr(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new We(ke.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new We(ke.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new We(ke.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new We(ke.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Mr(n)}static emptyPath(){return new Mr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.path=e}static fromPath(e){return new ft(Tn.fromString(e))}static fromName(e){return new ft(Tn.fromString(e).popFirst(5))}static empty(){return new ft(Tn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Tn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Tn.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ft(new Tn(e.slice()))}}function pI(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ct.fromTimestamp(r===1e9?new dt(n+1,0):new dt(n,r));return new hl(i,ft.empty(),e)}function gI(t){return new hl(t.readTime,t.key,-1)}class hl{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new hl(Ct.min(),ft.empty(),-1)}static max(){return new hl(Ct.max(),ft.empty(),-1)}}function vI(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ft.comparator(t.documentKey,e.documentKey),n!==0?n:tn(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ih(t){if(t.code!==ke.FAILED_PRECONDITION||t.message!==yI)throw t;Ze("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&jt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Le((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Le?n:Le.resolve(n)}catch(n){return Le.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Le.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Le.reject(n)}static resolve(e){return new Le((n,r)=>{n(e)})}static reject(e){return new Le((n,r)=>{r(e)})}static waitFor(e){return new Le((n,r)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=Le.resolve(!1);for(const r of e)n=n.next(i=>i?Le.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new Le((r,i)=>{const s=e.length,o=new Array(s);let l=0;for(let c=0;c<s;c++){const u=c;n(e[u]).next(f=>{o[u]=f,++l,l===s&&r(o)},f=>i(f))}})}static doWhile(e,n){return new Le((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function bI(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ph(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}ay.oe=-1;function Rp(t){return t==null}function Wm(t){return t===0&&1/t==-1/0}function wI(t){return typeof t=="number"&&Number.isInteger(t)&&!Wm(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yb(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function wc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function F4(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e,n){this.comparator=e,this.root=n||Dr.EMPTY}insert(e,n){return new $n(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Dr.BLACK,null,null))}remove(e){return new $n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Dr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Af(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Af(this.root,e,this.comparator,!1)}getReverseIterator(){return new Af(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Af(this.root,e,this.comparator,!0)}}class Af{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Dr{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Dr.RED,this.left=i??Dr.EMPTY,this.right=s??Dr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Dr(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Dr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Dr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Dr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Dr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw jt();const e=this.left.check();if(e!==this.right.check())throw jt();return e+(this.isRed()?0:1)}}Dr.EMPTY=null,Dr.RED=!0,Dr.BLACK=!1;Dr.EMPTY=new class{constructor(){this.size=0}get key(){throw jt()}get value(){throw jt()}get color(){throw jt()}get left(){throw jt()}get right(){throw jt()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Dr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e){this.comparator=e,this.data=new $n(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new xb(this.data.getIterator())}getIteratorFrom(e){return new xb(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Fr)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Fr(this.comparator);return n.data=e,n}}class xb{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e){this.fields=e,e.sort(Mr.comparator)}static empty(){return new Ki([])}unionWith(e){let n=new Fr(Mr.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Ki(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Su(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V4 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new V4("Invalid base64 string: "+s):s}}(e);return new Ur(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Ur(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ur.EMPTY_BYTE_STRING=new Ur("");const _I=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fl(t){if(mn(!!t),typeof t=="string"){let e=0;const n=_I.exec(t);if(mn(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:rr(t.seconds),nanos:rr(t.nanos)}}function rr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function dc(t){return typeof t=="string"?Ur.fromBase64String(t):Ur.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oy(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function ly(t){const e=t.mapValue.fields.__previous_value__;return oy(e)?ly(e):e}function uh(t){const e=fl(t.mapValue.fields.__local_write_time__.timestampValue);return new dt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NI{constructor(e,n,r,i,s,o,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class dh{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new dh("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof dh&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jf={mapValue:{}};function hc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?oy(t)?4:EI(t)?9007199254740991:SI(t)?10:11:jt()}function va(t,e){if(t===e)return!0;const n=hc(t);if(n!==hc(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return uh(t).isEqual(uh(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=fl(i.timestampValue),l=fl(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return dc(i.bytesValue).isEqual(dc(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return rr(i.geoPointValue.latitude)===rr(s.geoPointValue.latitude)&&rr(i.geoPointValue.longitude)===rr(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return rr(i.integerValue)===rr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=rr(i.doubleValue),l=rr(s.doubleValue);return o===l?Wm(o)===Wm(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Su(t.arrayValue.values||[],e.arrayValue.values||[],va);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(yb(o)!==yb(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!va(o[c],l[c])))return!1;return!0}(t,e);default:return jt()}}function hh(t,e){return(t.values||[]).find(n=>va(n,e))!==void 0}function Eu(t,e){if(t===e)return 0;const n=hc(t),r=hc(e);if(n!==r)return tn(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return tn(t.booleanValue,e.booleanValue);case 2:return function(s,o){const l=rr(s.integerValue||s.doubleValue),c=rr(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return bb(t.timestampValue,e.timestampValue);case 4:return bb(uh(t),uh(e));case 5:return tn(t.stringValue,e.stringValue);case 6:return function(s,o){const l=dc(s),c=dc(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const f=tn(l[u],c[u]);if(f!==0)return f}return tn(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const l=tn(rr(s.latitude),rr(o.latitude));return l!==0?l:tn(rr(s.longitude),rr(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return wb(t.arrayValue,e.arrayValue);case 10:return function(s,o){var l,c,u,f;const g=s.fields||{},v=o.fields||{},m=(l=g.value)===null||l===void 0?void 0:l.arrayValue,E=(c=v.value)===null||c===void 0?void 0:c.arrayValue,A=tn(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((f=E==null?void 0:E.values)===null||f===void 0?void 0:f.length)||0);return A!==0?A:wb(m,E)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===jf.mapValue&&o===jf.mapValue)return 0;if(s===jf.mapValue)return 1;if(o===jf.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),u=o.fields||{},f=Object.keys(u);c.sort(),f.sort();for(let g=0;g<c.length&&g<f.length;++g){const v=tn(c[g],f[g]);if(v!==0)return v;const m=Eu(l[c[g]],u[f[g]]);if(m!==0)return m}return tn(c.length,f.length)}(t.mapValue,e.mapValue);default:throw jt()}}function bb(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return tn(t,e);const n=fl(t),r=fl(e),i=tn(n.seconds,r.seconds);return i!==0?i:tn(n.nanos,r.nanos)}function wb(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Eu(n[i],r[i]);if(s)return s}return tn(n.length,r.length)}function Au(t){return j1(t)}function j1(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=fl(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return dc(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ft.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=j1(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${j1(n.fields[o])}`;return i+"}"}(t.mapValue):jt()}function _b(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function T1(t){return!!t&&"integerValue"in t}function cy(t){return!!t&&"arrayValue"in t}function Nb(t){return!!t&&"nullValue"in t}function Sb(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function nm(t){return!!t&&"mapValue"in t}function SI(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Fd(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return wc(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Fd(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Fd(t.arrayValue.values[n]);return e}return Object.assign({},t)}function EI(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e){this.value=e}static empty(){return new Ni({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!nm(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Fd(n)}setAll(e){let n=Mr.emptyPath(),r={},i=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=l.popLast()}o?r[l.lastSegment()]=Fd(o):i.push(l.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());nm(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return va(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];nm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){wc(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Ni(Fd(this.value))}}function U4(t){const e=[];return wc(t.fields,(n,r)=>{const i=new Mr([n]);if(nm(r)){const s=U4(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Ki(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e,n,r,i,s,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new ti(e,0,Ct.min(),Ct.min(),Ct.min(),Ni.empty(),0)}static newFoundDocument(e,n,r,i){return new ti(e,1,n,Ct.min(),r,i,0)}static newNoDocument(e,n){return new ti(e,2,n,Ct.min(),Ct.min(),Ni.empty(),0)}static newUnknownDocument(e,n){return new ti(e,3,n,Ct.min(),Ct.min(),Ni.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ct.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ni.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ni.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ct.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ti&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ti(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(e,n){this.position=e,this.inclusive=n}}function Eb(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=ft.comparator(ft.fromName(o.referenceValue),n.key):r=Eu(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ab(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!va(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(e,n="asc"){this.field=e,this.dir=n}}function AI(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{}class hr extends B4{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new TI(e,n,r):n==="array-contains"?new II(e,r):n==="in"?new PI(e,r):n==="not-in"?new RI(e,r):n==="array-contains-any"?new LI(e,r):new hr(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new kI(e,r):new CI(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Eu(n,this.value)):n!==null&&hc(this.value)===hc(n)&&this.matchesComparison(Eu(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return jt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Fs extends B4{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Fs(e,n)}matches(e){return z4(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function z4(t){return t.op==="and"}function q4(t){return jI(t)&&z4(t)}function jI(t){for(const e of t.filters)if(e instanceof Fs)return!1;return!0}function k1(t){if(t instanceof hr)return t.field.canonicalString()+t.op.toString()+Au(t.value);if(q4(t))return t.filters.map(e=>k1(e)).join(",");{const e=t.filters.map(n=>k1(n)).join(",");return`${t.op}(${e})`}}function $4(t,e){return t instanceof hr?function(r,i){return i instanceof hr&&r.op===i.op&&r.field.isEqual(i.field)&&va(r.value,i.value)}(t,e):t instanceof Fs?function(r,i){return i instanceof Fs&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,l)=>s&&$4(o,i.filters[l]),!0):!1}(t,e):void jt()}function H4(t){return t instanceof hr?function(n){return`${n.field.canonicalString()} ${n.op} ${Au(n.value)}`}(t):t instanceof Fs?function(n){return n.op.toString()+" {"+n.getFilters().map(H4).join(" ,")+"}"}(t):"Filter"}class TI extends hr{constructor(e,n,r){super(e,n,r),this.key=ft.fromName(r.referenceValue)}matches(e){const n=ft.comparator(e.key,this.key);return this.matchesComparison(n)}}class kI extends hr{constructor(e,n){super(e,"in",n),this.keys=W4("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class CI extends hr{constructor(e,n){super(e,"not-in",n),this.keys=W4("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function W4(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ft.fromName(r.referenceValue))}class II extends hr{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return cy(n)&&hh(n.arrayValue,this.value)}}class PI extends hr{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&hh(this.value.arrayValue,n)}}class RI extends hr{constructor(e,n){super(e,"not-in",n)}matches(e){if(hh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!hh(this.value.arrayValue,n)}}class LI extends hr{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!cy(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>hh(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{constructor(e,n=null,r=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function jb(t,e=null,n=[],r=[],i=null,s=null,o=null){return new DI(t,e,n,r,i,s,o)}function uy(t){const e=It(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>k1(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Rp(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Au(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Au(r)).join(",")),e.ue=n}return e.ue}function dy(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!AI(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!$4(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ab(t.startAt,e.startAt)&&Ab(t.endAt,e.endAt)}function C1(t){return ft.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,n=null,r=[],i=[],s=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function MI(t,e,n,r,i,s,o,l){return new Du(t,e,n,r,i,s,o,l)}function Lp(t){return new Du(t)}function Tb(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function G4(t){return t.collectionGroup!==null}function Vd(t){const e=It(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Fr(Mr.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new fh(s,r))}),n.has(Mr.keyField().canonicalString())||e.ce.push(new fh(Mr.keyField(),r))}return e.ce}function pa(t){const e=It(t);return e.le||(e.le=OI(e,Vd(t))),e.le}function OI(t,e){if(t.limitType==="F")return jb(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new fh(i.field,s)});const n=t.endAt?new Gm(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Gm(t.startAt.position,t.startAt.inclusive):null;return jb(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function I1(t,e){const n=t.filters.concat([e]);return new Du(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Km(t,e,n){return new Du(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Dp(t,e){return dy(pa(t),pa(e))&&t.limitType===e.limitType}function K4(t){return`${uy(pa(t))}|lt:${t.limitType}`}function Dc(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>H4(i)).join(", ")}]`),Rp(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Au(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Au(i)).join(",")),`Target(${r})`}(pa(t))}; limitType=${t.limitType})`}function Mp(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ft.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Vd(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,l,c){const u=Eb(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,Vd(r),i)||r.endAt&&!function(o,l,c){const u=Eb(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,Vd(r),i))}(t,e)}function FI(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Y4(t){return(e,n)=>{let r=!1;for(const i of Vd(t)){const s=VI(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function VI(t,e,n){const r=t.field.isKeyField()?ft.comparator(e.key,n.key):function(s,o,l){const c=o.data.field(s),u=l.data.field(s);return c!==null&&u!==null?Eu(c,u):jt()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return jt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){wc(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return F4(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI=new $n(ft.comparator);function oo(){return UI}const Q4=new $n(ft.comparator);function Ed(...t){let e=Q4;for(const n of t)e=e.insert(n.key,n);return e}function X4(t){let e=Q4;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Xl(){return Ud()}function J4(){return Ud()}function Ud(){return new Mu(t=>t.toString(),(t,e)=>t.isEqual(e))}const BI=new $n(ft.comparator),zI=new Fr(ft.comparator);function Bt(...t){let e=zI;for(const n of t)e=e.add(n);return e}const qI=new Fr(tn);function $I(){return qI}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wm(e)?"-0":e}}function Z4(t){return{integerValue:""+t}}function HI(t,e){return wI(e)?Z4(e):hy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{constructor(){this._=void 0}}function WI(t,e,n){return t instanceof Ym?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&oy(s)&&(s=ly(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof mh?t3(t,e):t instanceof ph?n3(t,e):function(i,s){const o=e3(i,s),l=kb(o)+kb(i.Pe);return T1(o)&&T1(i.Pe)?Z4(l):hy(i.serializer,l)}(t,e)}function GI(t,e,n){return t instanceof mh?t3(t,e):t instanceof ph?n3(t,e):n}function e3(t,e){return t instanceof Qm?function(r){return T1(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Ym extends Op{}class mh extends Op{constructor(e){super(),this.elements=e}}function t3(t,e){const n=r3(e);for(const r of t.elements)n.some(i=>va(i,r))||n.push(r);return{arrayValue:{values:n}}}class ph extends Op{constructor(e){super(),this.elements=e}}function n3(t,e){let n=r3(e);for(const r of t.elements)n=n.filter(i=>!va(i,r));return{arrayValue:{values:n}}}class Qm extends Op{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function kb(t){return rr(t.integerValue||t.doubleValue)}function r3(t){return cy(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function KI(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof mh&&i instanceof mh||r instanceof ph&&i instanceof ph?Su(r.elements,i.elements,va):r instanceof Qm&&i instanceof Qm?va(r.Pe,i.Pe):r instanceof Ym&&i instanceof Ym}(t.transform,e.transform)}class YI{constructor(e,n){this.version=e,this.transformResults=n}}class ps{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ps}static exists(e){return new ps(void 0,e)}static updateTime(e){return new ps(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function rm(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Fp{}function i3(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new fy(t.key,ps.none()):new Rh(t.key,t.data,ps.none());{const n=t.data,r=Ni.empty();let i=new Fr(Mr.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new wl(t.key,r,new Ki(i.toArray()),ps.none())}}function QI(t,e,n){t instanceof Rh?function(i,s,o){const l=i.value.clone(),c=Ib(i.fieldTransforms,s,o.transformResults);l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof wl?function(i,s,o){if(!rm(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=Ib(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(s3(i)),c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Bd(t,e,n,r){return t instanceof Rh?function(s,o,l,c){if(!rm(s.precondition,o))return l;const u=s.value.clone(),f=Pb(s.fieldTransforms,c,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof wl?function(s,o,l,c){if(!rm(s.precondition,o))return l;const u=Pb(s.fieldTransforms,c,o),f=o.data;return f.setAll(s3(s)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(s,o,l){return rm(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function XI(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=e3(r.transform,i||null);s!=null&&(n===null&&(n=Ni.empty()),n.set(r.field,s))}return n||null}function Cb(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Su(r,i,(s,o)=>KI(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Rh extends Fp{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class wl extends Fp{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function s3(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Ib(t,e,n){const r=new Map;mn(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,l=e.data.field(s.field);r.set(s.field,GI(o,l,n[i]))}return r}function Pb(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,WI(s,o,e))}return r}class fy extends Fp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class JI extends Fp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&QI(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Bd(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Bd(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=J4();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=n.has(i.key)?null:l;const c=i3(o,l);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Ct.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Bt())}isEqual(e){return this.batchId===e.batchId&&Su(this.mutations,e.mutations,(n,r)=>Cb(n,r))&&Su(this.baseMutations,e.baseMutations,(n,r)=>Cb(n,r))}}class my{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){mn(e.mutations.length===r.length);let i=function(){return BI}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new my(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ur,Qt;function nP(t){switch(t){default:return jt();case ke.CANCELLED:case ke.UNKNOWN:case ke.DEADLINE_EXCEEDED:case ke.RESOURCE_EXHAUSTED:case ke.INTERNAL:case ke.UNAVAILABLE:case ke.UNAUTHENTICATED:return!1;case ke.INVALID_ARGUMENT:case ke.NOT_FOUND:case ke.ALREADY_EXISTS:case ke.PERMISSION_DENIED:case ke.FAILED_PRECONDITION:case ke.ABORTED:case ke.OUT_OF_RANGE:case ke.UNIMPLEMENTED:case ke.DATA_LOSS:return!0}}function a3(t){if(t===void 0)return ao("GRPC error has no .code"),ke.UNKNOWN;switch(t){case ur.OK:return ke.OK;case ur.CANCELLED:return ke.CANCELLED;case ur.UNKNOWN:return ke.UNKNOWN;case ur.DEADLINE_EXCEEDED:return ke.DEADLINE_EXCEEDED;case ur.RESOURCE_EXHAUSTED:return ke.RESOURCE_EXHAUSTED;case ur.INTERNAL:return ke.INTERNAL;case ur.UNAVAILABLE:return ke.UNAVAILABLE;case ur.UNAUTHENTICATED:return ke.UNAUTHENTICATED;case ur.INVALID_ARGUMENT:return ke.INVALID_ARGUMENT;case ur.NOT_FOUND:return ke.NOT_FOUND;case ur.ALREADY_EXISTS:return ke.ALREADY_EXISTS;case ur.PERMISSION_DENIED:return ke.PERMISSION_DENIED;case ur.FAILED_PRECONDITION:return ke.FAILED_PRECONDITION;case ur.ABORTED:return ke.ABORTED;case ur.OUT_OF_RANGE:return ke.OUT_OF_RANGE;case ur.UNIMPLEMENTED:return ke.UNIMPLEMENTED;case ur.DATA_LOSS:return ke.DATA_LOSS;default:return jt()}}(Qt=ur||(ur={}))[Qt.OK=0]="OK",Qt[Qt.CANCELLED=1]="CANCELLED",Qt[Qt.UNKNOWN=2]="UNKNOWN",Qt[Qt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qt[Qt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qt[Qt.NOT_FOUND=5]="NOT_FOUND",Qt[Qt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qt[Qt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qt[Qt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qt[Qt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qt[Qt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qt[Qt.ABORTED=10]="ABORTED",Qt[Qt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qt[Qt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qt[Qt.INTERNAL=13]="INTERNAL",Qt[Qt.UNAVAILABLE=14]="UNAVAILABLE",Qt[Qt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP=new ec([4294967295,4294967295],0);function Rb(t){const e=rP().encode(t),n=new C4;return n.update(e),new Uint8Array(n.digest())}function Lb(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ec([n,r],0),new ec([i,s],0)]}class py{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ad(`Invalid padding: ${n}`);if(r<0)throw new Ad(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ad(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ad(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=ec.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(ec.fromNumber(r)));return i.compare(iP)===1&&(i=new ec([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Rb(e),[r,i]=Lb(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new py(s,i,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=Rb(e),[r,i]=Lb(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ad extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Lh.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Vp(Ct.min(),i,new $n(tn),oo(),Bt())}}class Lh{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Lh(r,n,Bt(),Bt(),Bt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class im{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class o3{constructor(e,n){this.targetId=e,this.me=n}}class l3{constructor(e,n,r=Ur.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class Db{constructor(){this.fe=0,this.ge=Ob(),this.pe=Ur.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Bt(),n=Bt(),r=Bt();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:jt()}}),new Lh(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Ob()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,mn(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class sP{constructor(e){this.Le=e,this.Be=new Map,this.ke=oo(),this.qe=Mb(),this.Qe=new $n(tn)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:jt()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(C1(s))if(r===0){const o=new ft(s.path);this.Ue(n,o,ti.newNoDocument(o,Ct.min()))}else mn(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,l;try{o=dc(r).toUint8Array()}catch(c){if(c instanceof V4)return Nu("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new py(o,i,s)}catch(c){return Nu(c instanceof Ad?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&C1(l.target)){const c=new ft(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,ti.newNoDocument(c,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=Bt();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new Vp(e,n,this.Qe,this.ke,r);return this.ke=oo(),this.qe=Mb(),this.Qe=new $n(tn),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Db,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Fr(tn),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||Ze("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Db),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Mb(){return new $n(ft.comparator)}function Ob(){return new $n(ft.comparator)}const aP={asc:"ASCENDING",desc:"DESCENDING"},oP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lP={and:"AND",or:"OR"};class cP{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function P1(t,e){return t.useProto3Json||Rp(e)?e:{value:e}}function Xm(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function c3(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function uP(t,e){return Xm(t,e.toTimestamp())}function ga(t){return mn(!!t),Ct.fromTimestamp(function(n){const r=fl(n);return new dt(r.seconds,r.nanos)}(t))}function gy(t,e){return R1(t,e).canonicalString()}function R1(t,e){const n=function(i){return new Tn(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function u3(t){const e=Tn.fromString(t);return mn(p3(e)),e}function L1(t,e){return gy(t.databaseId,e.path)}function Xg(t,e){const n=u3(e);if(n.get(1)!==t.databaseId.projectId)throw new We(ke.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new We(ke.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ft(h3(n))}function d3(t,e){return gy(t.databaseId,e)}function dP(t){const e=u3(t);return e.length===4?Tn.emptyPath():h3(e)}function D1(t){return new Tn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function h3(t){return mn(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Fb(t,e,n){return{name:L1(t,e),fields:n.value.mapValue.fields}}function hP(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:jt()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(mn(f===void 0||typeof f=="string"),Ur.fromBase64String(f||"")):(mn(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Ur.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const f=u.code===void 0?ke.UNKNOWN:a3(u.code);return new We(f,u.message||"")}(o);n=new l3(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Xg(t,r.document.name),s=ga(r.document.updateTime),o=r.document.createTime?ga(r.document.createTime):Ct.min(),l=new Ni({mapValue:{fields:r.document.fields}}),c=ti.newFoundDocument(i,s,o,l),u=r.targetIds||[],f=r.removedTargetIds||[];n=new im(u,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Xg(t,r.document),s=r.readTime?ga(r.readTime):Ct.min(),o=ti.newNoDocument(i,s),l=r.removedTargetIds||[];n=new im([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Xg(t,r.document),s=r.removedTargetIds||[];n=new im([],s,i,null)}else{if(!("filter"in e))return jt();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new tP(i,s),l=r.targetId;n=new o3(l,o)}}return n}function fP(t,e){let n;if(e instanceof Rh)n={update:Fb(t,e.key,e.value)};else if(e instanceof fy)n={delete:L1(t,e.key)};else if(e instanceof wl)n={update:Fb(t,e.key,e.data),updateMask:_P(e.fieldMask)};else{if(!(e instanceof JI))return jt();n={verify:L1(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const l=o.transform;if(l instanceof Ym)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof mh)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ph)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Qm)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw jt()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:uP(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:jt()}(t,e.precondition)),n}function mP(t,e){return t&&t.length>0?(mn(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?ga(i.updateTime):ga(s);return o.isEqual(Ct.min())&&(o=ga(s)),new YI(o,i.transformResults||[])}(n,e))):[]}function pP(t,e){return{documents:[d3(t,e.path)]}}function gP(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=d3(t,i);const s=function(u){if(u.length!==0)return m3(Fs.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(f=>function(v){return{field:Mc(v.field),direction:xP(v.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=P1(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:i}}function vP(t){let e=dP(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){mn(r===1);const f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(g){const v=f3(g);return v instanceof Fs&&q4(v)?v.getFilters():[v]}(n.where));let o=[];n.orderBy&&(o=function(g){return g.map(v=>function(E){return new fh(Oc(E.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(v))}(n.orderBy));let l=null;n.limit&&(l=function(g){let v;return v=typeof g=="object"?g.value:g,Rp(v)?null:v}(n.limit));let c=null;n.startAt&&(c=function(g){const v=!!g.before,m=g.values||[];return new Gm(m,v)}(n.startAt));let u=null;return n.endAt&&(u=function(g){const v=!g.before,m=g.values||[];return new Gm(m,v)}(n.endAt)),MI(e,i,o,s,l,"F",c,u)}function yP(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return jt()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function f3(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Oc(n.unaryFilter.field);return hr.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Oc(n.unaryFilter.field);return hr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Oc(n.unaryFilter.field);return hr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Oc(n.unaryFilter.field);return hr.create(o,"!=",{nullValue:"NULL_VALUE"});default:return jt()}}(t):t.fieldFilter!==void 0?function(n){return hr.create(Oc(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return jt()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Fs.create(n.compositeFilter.filters.map(r=>f3(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return jt()}}(n.compositeFilter.op))}(t):jt()}function xP(t){return aP[t]}function bP(t){return oP[t]}function wP(t){return lP[t]}function Mc(t){return{fieldPath:t.canonicalString()}}function Oc(t){return Mr.fromServerFormat(t.fieldPath)}function m3(t){return t instanceof hr?function(n){if(n.op==="=="){if(Sb(n.value))return{unaryFilter:{field:Mc(n.field),op:"IS_NAN"}};if(Nb(n.value))return{unaryFilter:{field:Mc(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Sb(n.value))return{unaryFilter:{field:Mc(n.field),op:"IS_NOT_NAN"}};if(Nb(n.value))return{unaryFilter:{field:Mc(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mc(n.field),op:bP(n.op),value:n.value}}}(t):t instanceof Fs?function(n){const r=n.getFilters().map(i=>m3(i));return r.length===1?r[0]:{compositeFilter:{op:wP(n.op),filters:r}}}(t):jt()}function _P(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function p3(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(e,n,r,i,s=Ct.min(),o=Ct.min(),l=Ur.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Yo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Yo(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Yo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Yo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(e){this.ct=e}}function SP(t){const e=vP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Km(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(){this.un=new AP}addToCollectionParentIndex(e,n){return this.un.add(n),Le.resolve()}getCollectionParents(e,n){return Le.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return Le.resolve()}deleteFieldIndex(e,n){return Le.resolve()}deleteAllFieldIndexes(e){return Le.resolve()}createTargetIndexes(e,n){return Le.resolve()}getDocumentsMatchingTarget(e,n){return Le.resolve(null)}getIndexType(e,n){return Le.resolve(0)}getFieldIndexes(e,n){return Le.resolve([])}getNextCollectionGroupToUpdate(e){return Le.resolve(null)}getMinOffset(e,n){return Le.resolve(hl.min())}getMinOffsetFromCollectionGroup(e,n){return Le.resolve(hl.min())}updateCollectionGroup(e,n,r){return Le.resolve()}updateIndexEntries(e,n){return Le.resolve()}}class AP{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Fr(Tn.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Fr(Tn.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ju(0)}static kn(){return new ju(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jP{constructor(){this.changes=new Mu(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ti.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?Le.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Bd(r.mutation,i,Ki.empty(),dt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Bt()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Bt()){const i=Xl();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Ed();return s.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Xl();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Bt()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,i){let s=oo();const o=Ud(),l=function(){return Ud()}();return n.forEach((c,u)=>{const f=r.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof wl)?s=s.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),Bd(f.mutation,u,f.mutation.getFieldMask(),dt.now())):o.set(u.key,Ki.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,f)=>o.set(u,f)),n.forEach((u,f)=>{var g;return l.set(u,new TP(f,(g=o.get(u))!==null&&g!==void 0?g:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Ud();let i=new $n((o,l)=>o-l),s=Bt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let f=r.get(c)||Ki.empty();f=l.applyToLocalView(u,f),r.set(c,f);const g=(i.get(l.batchId)||Bt()).add(c);i=i.insert(l.batchId,g)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,f=c.value,g=J4();f.forEach(v=>{if(!s.has(v)){const m=i3(n.get(v),r.get(v));m!==null&&g.set(v,m),s=s.add(v)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,g))}return Le.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return ft.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):G4(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):Le.resolve(Xl());let l=-1,c=s;return o.next(u=>Le.forEach(u,(f,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),s.get(f)?Le.resolve():this.remoteDocumentCache.getEntry(e,f).next(v=>{c=c.insert(f,v)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,Bt())).next(f=>({batchId:l,changes:X4(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ft(n)).next(r=>{let i=Ed();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Ed();return this.indexManager.getCollectionParents(e,s).next(l=>Le.forEach(l,c=>{const u=function(g,v){return new Du(v,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(f=>{f.forEach((g,v)=>{o=o.insert(g,v)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,u)=>{const f=u.getKey();o.get(f)===null&&(o=o.insert(f,ti.newInvalidDocument(f)))});let l=Ed();return o.forEach((c,u)=>{const f=s.get(c);f!==void 0&&Bd(f.mutation,u,Ki.empty(),dt.now()),Mp(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return Le.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:ga(i.createTime)}}(n)),Le.resolve()}getNamedQuery(e,n){return Le.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:SP(i.bundledQuery),readTime:ga(i.readTime)}}(n)),Le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(){this.overlays=new $n(ft.comparator),this.Ir=new Map}getOverlay(e,n){return Le.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Xl();return Le.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),Le.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),Le.resolve()}getOverlaysForCollection(e,n,r){const i=Xl(),s=n.length+1,o=new ft(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return Le.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new $n((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let f=s.get(u.largestBatchId);f===null&&(f=Xl(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const l=Xl(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,f)=>l.set(u,f)),!(l.size()>=i)););return Le.resolve(l)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new eP(n,r));let s=this.Ir.get(n);s===void 0&&(s=Bt(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(){this.sessionToken=Ur.EMPTY_BYTE_STRING}getSessionToken(e){return Le.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{constructor(){this.Tr=new Fr(Er.Er),this.dr=new Fr(Er.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Er(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Er(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ft(new Tn([])),r=new Er(n,e),i=new Er(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ft(new Tn([])),r=new Er(n,e),i=new Er(n,e+1);let s=Bt();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Er(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Er{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ft.comparator(e.key,n.key)||tn(e.wr,n.wr)}static Ar(e,n){return tn(e.wr,n.wr)||ft.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Fr(Er.Er)}checkEmpty(e){return Le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new ZI(s,n,r,i);this.mutationQueue.push(o);for(const l of i)this.br=this.br.add(new Er(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Le.resolve(o)}lookupMutationBatch(e,n){return Le.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return Le.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Le.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Er(n,0),i=new Er(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const l=this.Dr(o.wr);s.push(l)}),Le.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Fr(tn);return n.forEach(i=>{const s=new Er(i,0),o=new Er(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{r=r.add(l.wr)})}),Le.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ft.isDocumentKey(s)||(s=s.child(""));const o=new Er(new ft(s),0);let l=new Fr(tn);return this.br.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(l=l.add(c.wr)),!0)},o),Le.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){mn(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return Le.forEach(n.mutations,i=>{const s=new Er(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Er(n,0),i=this.br.firstAfterOrEqual(r);return Le.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Le.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(e){this.Mr=e,this.docs=function(){return new $n(ft.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return Le.resolve(r?r.document.mutableCopy():ti.newInvalidDocument(n))}getEntries(e,n){let r=oo();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ti.newInvalidDocument(i))}),Le.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=oo();const o=n.path,l=new ft(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:f}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||vI(gI(f),r)<=0||(i.has(f.key)||Mp(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Le.resolve(s)}getAllFromCollectionGroup(e,n,r,i){jt()}Or(e,n){return Le.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new DP(this)}getSize(e){return Le.resolve(this.size)}}class DP extends jP{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),Le.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(e){this.persistence=e,this.Nr=new Mu(n=>uy(n),dy),this.lastRemoteSnapshotVersion=Ct.min(),this.highestTargetId=0,this.Lr=0,this.Br=new vy,this.targetCount=0,this.kr=ju.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),Le.resolve()}getLastRemoteSnapshotVersion(e){return Le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Le.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Le.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),Le.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ju(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,Le.resolve()}updateTargetData(e,n){return this.Kn(n),Le.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,Le.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),Le.waitFor(s).next(()=>i)}getTargetCount(e){return Le.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return Le.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),Le.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),Le.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),Le.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return Le.resolve(r)}containsKey(e,n){return Le.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e,n){this.qr={},this.overlays={},this.Qr=new ay(0),this.Kr=!1,this.Kr=!0,this.$r=new PP,this.referenceDelegate=e(this),this.Ur=new MP(this),this.indexManager=new EP,this.remoteDocumentCache=function(i){return new LP(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new NP(n),this.Gr=new CP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new IP,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new RP(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){Ze("MemoryPersistence","Starting transaction:",e);const i=new FP(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return Le.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class FP extends xI{constructor(e){super(),this.currentSequenceNumber=e}}class yy{constructor(e){this.persistence=e,this.Jr=new vy,this.Yr=null}static Zr(e){return new yy(e)}get Xr(){if(this.Yr)return this.Yr;throw jt()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),Le.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),Le.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),Le.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Le.forEach(this.Xr,r=>{const i=ft.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,Ct.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return Le.or([()=>Le.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=Bt(),i=Bt();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new xy(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return TT()?8:bI(si())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new VP;return this.Xi(e,n,o).next(l=>{if(s.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(pd()<=Wt.DEBUG&&Ze("QueryEngine","SDK will not create cache indexes for query:",Dc(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Le.resolve()):(pd()<=Wt.DEBUG&&Ze("QueryEngine","Query:",Dc(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(pd()<=Wt.DEBUG&&Ze("QueryEngine","The SDK decides to create cache indexes for query:",Dc(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pa(n))):Le.resolve())}Yi(e,n){if(Tb(n))return Le.resolve(null);let r=pa(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Km(n,null,"F"),r=pa(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Bt(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ts(n,l);return this.ns(n,u,o,c.readTime)?this.Yi(e,Km(n,null,"F")):this.rs(e,u,n,c)}))})))}Zi(e,n,r,i){return Tb(n)||i.isEqual(Ct.min())?Le.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?Le.resolve(null):(pd()<=Wt.DEBUG&&Ze("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Dc(n)),this.rs(e,o,n,pI(i,-1)).next(l=>l))})}ts(e,n){let r=new Fr(Y4(e));return n.forEach((i,s)=>{Mp(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return pd()<=Wt.DEBUG&&Ze("QueryEngine","Using full collection scan to execute query:",Dc(n)),this.Ji.getDocumentsMatchingQuery(e,n,hl.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new $n(tn),this._s=new Mu(s=>uy(s),dy),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new kP(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function zP(t,e,n,r){return new BP(t,e,n,r)}async function g3(t,e){const n=It(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],l=[];let c=Bt();for(const u of i){o.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}for(const u of s){l.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}return n.localDocuments.getDocuments(r,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function qP(t,e){const n=It(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,f){const g=u.batch,v=g.keys();let m=Le.resolve();return v.forEach(E=>{m=m.next(()=>f.getEntry(c,E)).next(A=>{const C=u.docVersions.get(E);mn(C!==null),A.version.compareTo(C)<0&&(g.applyToRemoteDocument(A,u),A.isValidDocument()&&(A.setReadTime(u.commitVersion),f.addEntry(A)))})}),m.next(()=>l.mutationQueue.removeMutationBatch(c,g))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=Bt();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function v3(t){const e=It(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function $P(t,e){const n=It(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const l=[];e.targetChanges.forEach((f,g)=>{const v=i.get(g);if(!v)return;l.push(n.Ur.removeMatchingKeys(s,f.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(s,f.addedDocuments,g)));let m=v.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?m=m.withResumeToken(Ur.EMPTY_BYTE_STRING,Ct.min()).withLastLimboFreeSnapshotVersion(Ct.min()):f.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(f.resumeToken,r)),i=i.insert(g,m),function(A,C,b){return A.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(v,m,f)&&l.push(n.Ur.updateTargetData(s,m))});let c=oo(),u=Bt();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),l.push(HP(s,o,e.documentUpdates).next(f=>{c=f.Ps,u=f.Is})),!r.isEqual(Ct.min())){const f=n.Ur.getLastRemoteSnapshotVersion(s).next(g=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(f)}return Le.waitFor(l).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(n.os=i,s))}function HP(t,e,n){let r=Bt(),i=Bt();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=oo();return n.forEach((l,c)=>{const u=s.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(Ct.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Ze("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function WP(t,e){const n=It(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function GP(t,e){const n=It(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,Le.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new Yo(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function M1(t,e,n){const r=It(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Ph(o))throw o;Ze("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function Vb(t,e,n){const r=It(t);let i=Ct.min(),s=Bt();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,f){const g=It(c),v=g._s.get(f);return v!==void 0?Le.resolve(g.os.get(v)):g.Ur.getTargetData(u,f)}(r,o,pa(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:Ct.min(),n?s:Bt())).next(l=>(KP(r,FI(e),l),{documents:l,Ts:s})))}function KP(t,e,n){let r=t.us.get(e)||Ct.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}class Ub{constructor(){this.activeTargetIds=$I()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class YP{constructor(){this.so=new Ub,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Ub,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Ze("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Ze("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tf=null;function Jg(){return Tf===null?Tf=function(){return 268435456+Math.round(2147483648*Math.random())}():Tf++,"0x"+Tf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kr="WebChannelConnection";class ZP extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const l=Jg(),c=this.xo(n,r.toUriEncodedString());Ze("RestConnection",`Sending RPC '${n}' ${l}:`,c,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(n,c,u,i).then(f=>(Ze("RestConnection",`Received RPC '${n}' ${l}: `,f),f),f=>{throw Nu("RestConnection",`RPC '${n}' ${l} failed with error: `,f,"url: ",c,"request:",i),f})}Lo(n,r,i,s,o,l){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Lu}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=XP[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=Jg();return new Promise((o,l)=>{const c=new I4;c.setWithCredentials(!0),c.listenOnce(P4.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case tm.NO_ERROR:const f=c.getResponseJson();Ze(Kr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case tm.TIMEOUT:Ze(Kr,`RPC '${e}' ${s} timed out`),l(new We(ke.DEADLINE_EXCEEDED,"Request time out"));break;case tm.HTTP_ERROR:const g=c.getStatus();if(Ze(Kr,`RPC '${e}' ${s} failed with status:`,g,"response text:",c.getResponseText()),g>0){let v=c.getResponseJson();Array.isArray(v)&&(v=v[0]);const m=v==null?void 0:v.error;if(m&&m.status&&m.message){const E=function(C){const b=C.toLowerCase().replace(/_/g,"-");return Object.values(ke).indexOf(b)>=0?b:ke.UNKNOWN}(m.status);l(new We(E,m.message))}else l(new We(ke.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new We(ke.UNAVAILABLE,"Connection failed."));break;default:jt()}}finally{Ze(Kr,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);Ze(Kr,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",u,r,15)})}Bo(e,n,r){const i=Jg(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=D4(),l=L4(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const f=s.join("");Ze(Kr,`Creating RPC '${e}' stream ${i}: ${f}`,c);const g=o.createWebChannel(f,c);let v=!1,m=!1;const E=new JP({Io:C=>{m?Ze(Kr,`Not sending because RPC '${e}' stream ${i} is closed:`,C):(v||(Ze(Kr,`Opening RPC '${e}' stream ${i} transport.`),g.open(),v=!0),Ze(Kr,`RPC '${e}' stream ${i} sending:`,C),g.send(C))},To:()=>g.close()}),A=(C,b,I)=>{C.listen(b,O=>{try{I(O)}catch(V){setTimeout(()=>{throw V},0)}})};return A(g,Sd.EventType.OPEN,()=>{m||(Ze(Kr,`RPC '${e}' stream ${i} transport opened.`),E.yo())}),A(g,Sd.EventType.CLOSE,()=>{m||(m=!0,Ze(Kr,`RPC '${e}' stream ${i} transport closed`),E.So())}),A(g,Sd.EventType.ERROR,C=>{m||(m=!0,Nu(Kr,`RPC '${e}' stream ${i} transport errored:`,C),E.So(new We(ke.UNAVAILABLE,"The operation could not be completed")))}),A(g,Sd.EventType.MESSAGE,C=>{var b;if(!m){const I=C.data[0];mn(!!I);const O=I,V=O.error||((b=O[0])===null||b===void 0?void 0:b.error);if(V){Ze(Kr,`RPC '${e}' stream ${i} received error:`,V);const ne=V.status;let le=function(k){const N=ur[k];if(N!==void 0)return a3(N)}(ne),z=V.message;le===void 0&&(le=ke.INTERNAL,z="Unknown error status: "+ne+" with message "+V.message),m=!0,E.So(new We(le,z)),g.close()}else Ze(Kr,`RPC '${e}' stream ${i} received:`,I),E.bo(I)}}),A(l,R4.STAT_EVENT,C=>{C.stat===A1.PROXY?Ze(Kr,`RPC '${e}' stream ${i} detected buffering proxy`):C.stat===A1.NOPROXY&&Ze(Kr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.wo()},0),E}}function Zg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Up(t){return new cP(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y3{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&Ze("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x3{constructor(e,n,r,i,s,o,l,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new y3(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===ke.RESOURCE_EXHAUSTED?(ao(n.toString()),ao("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===ke.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new We(ke.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Ze("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(Ze("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class eR extends x3{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=hP(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ct.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ct.min():o.readTime?ga(o.readTime):Ct.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=D1(this.serializer),n.addTarget=function(s,o){let l;const c=o.target;if(l=C1(c)?{documents:pP(s,c)}:{query:gP(s,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=c3(s,o.resumeToken);const u=P1(s,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(Ct.min())>0){l.readTime=Xm(s,o.snapshotVersion.toTimestamp());const u=P1(s,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=yP(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=D1(this.serializer),n.removeTarget=e,this.a_(n)}}class tR extends x3{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return mn(!!e.streamToken),this.lastStreamToken=e.streamToken,mn(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){mn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=mP(e.writeResults,e.commitTime),r=ga(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=D1(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>fP(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new We(ke.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,R1(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new We(ke.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,R1(n,r),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new We(ke.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class rR{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ao(n),this.D_=!1):Ze("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{_c(this)&&(Ze("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=It(c);u.L_.add(4),await Dh(u),u.q_.set("Unknown"),u.L_.delete(4),await Bp(u)}(this))})}),this.q_=new rR(r,i)}}async function Bp(t){if(_c(t))for(const e of t.B_)await e(!0)}async function Dh(t){for(const e of t.B_)await e(!1)}function b3(t,e){const n=It(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Ny(n)?_y(n):Ou(n).r_()&&wy(n,e))}function by(t,e){const n=It(t),r=Ou(n);n.N_.delete(e),r.r_()&&w3(n,e),n.N_.size===0&&(r.r_()?r.o_():_c(n)&&n.q_.set("Unknown"))}function wy(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ct.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ou(t).A_(e)}function w3(t,e){t.Q_.xe(e),Ou(t).R_(e)}function _y(t){t.Q_=new sP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Ou(t).start(),t.q_.v_()}function Ny(t){return _c(t)&&!Ou(t).n_()&&t.N_.size>0}function _c(t){return It(t).L_.size===0}function _3(t){t.Q_=void 0}async function sR(t){t.q_.set("Online")}async function aR(t){t.N_.forEach((e,n)=>{wy(t,e)})}async function oR(t,e){_3(t),Ny(t)?(t.q_.M_(e),_y(t)):t.q_.set("Unknown")}async function lR(t,e,n){if(t.q_.set("Online"),e instanceof l3&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.N_.delete(l),i.Q_.removeTarget(l))}(t,e)}catch(r){Ze("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Jm(t,r)}else if(e instanceof im?t.Q_.Ke(e):e instanceof o3?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Ct.min()))try{const r=await v3(t.localStore);n.compareTo(r)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const f=s.N_.get(u);f&&s.N_.set(u,f.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const f=s.N_.get(c);if(!f)return;s.N_.set(c,f.withResumeToken(Ur.EMPTY_BYTE_STRING,f.snapshotVersion)),w3(s,c);const g=new Yo(f.target,c,u,f.sequenceNumber);wy(s,g)}),s.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Ze("RemoteStore","Failed to raise snapshot:",r),await Jm(t,r)}}async function Jm(t,e,n){if(!Ph(e))throw e;t.L_.add(1),await Dh(t),t.q_.set("Offline"),n||(n=()=>v3(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ze("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Bp(t)})}function N3(t,e){return e().catch(n=>Jm(t,n,e))}async function zp(t){const e=It(t),n=ml(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;cR(e);)try{const i=await WP(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,uR(e,i)}catch(i){await Jm(e,i)}S3(e)&&E3(e)}function cR(t){return _c(t)&&t.O_.length<10}function uR(t,e){t.O_.push(e);const n=ml(t);n.r_()&&n.V_&&n.m_(e.mutations)}function S3(t){return _c(t)&&!ml(t).n_()&&t.O_.length>0}function E3(t){ml(t).start()}async function dR(t){ml(t).p_()}async function hR(t){const e=ml(t);for(const n of t.O_)e.m_(n.mutations)}async function fR(t,e,n){const r=t.O_.shift(),i=my.from(r,e,n);await N3(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await zp(t)}async function mR(t,e){e&&ml(t).V_&&await async function(r,i){if(function(o){return nP(o)&&o!==ke.ABORTED}(i.code)){const s=r.O_.shift();ml(r).s_(),await N3(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await zp(r)}}(t,e),S3(t)&&E3(t)}async function zb(t,e){const n=It(t);n.asyncQueue.verifyOperationInProgress(),Ze("RemoteStore","RemoteStore received new credentials");const r=_c(n);n.L_.add(3),await Dh(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Bp(n)}async function pR(t,e){const n=It(t);e?(n.L_.delete(2),await Bp(n)):e||(n.L_.add(2),await Dh(n),n.q_.set("Unknown"))}function Ou(t){return t.K_||(t.K_=function(n,r,i){const s=It(n);return s.w_(),new eR(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:sR.bind(null,t),Ro:aR.bind(null,t),mo:oR.bind(null,t),d_:lR.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Ny(t)?_y(t):t.q_.set("Unknown")):(await t.K_.stop(),_3(t))})),t.K_}function ml(t){return t.U_||(t.U_=function(n,r,i){const s=It(n);return s.w_(),new tR(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:dR.bind(null,t),mo:mR.bind(null,t),f_:hR.bind(null,t),g_:fR.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await zp(t)):(await t.U_.stop(),t.O_.length>0&&(Ze("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sy{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Xa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,l=new Sy(e,n,o,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new We(ke.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ey(t,e){if(ao("AsyncQueue",`${e}: ${t}`),Ph(t))return new We(ke.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ft.comparator(n.key,r.key):(n,r)=>ft.comparator(n.key,r.key),this.keyedMap=Ed(),this.sortedSet=new $n(this.comparator)}static emptySet(e){return new cu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof cu)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new cu;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{constructor(){this.W_=new $n(ft.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):jt():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Tu{constructor(e,n,r,i,s,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Tu(e,n,cu.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Dp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class vR{constructor(){this.queries=$b(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=It(n),s=i.queries;i.queries=$b(),s.forEach((o,l)=>{for(const c of l.j_)c.onError(r)})})(this,new We(ke.ABORTED,"Firestore shutting down"))}}function $b(){return new Mu(t=>K4(t),Dp)}async function Ay(t,e){const n=It(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new gR,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const l=Ey(o,`Initialization of query '${Dc(e.query)}' failed`);return void e.onError(l)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&Ty(n)}async function jy(t,e){const n=It(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function yR(t,e){const n=It(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const l of o.j_)l.X_(i)&&(r=!0);o.z_=i}}r&&Ty(n)}function xR(t,e,n){const r=It(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function Ty(t){t.Y_.forEach(e=>{e.next()})}var O1,Hb;(Hb=O1||(O1={})).ea="default",Hb.Cache="cache";class ky{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Tu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Tu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==O1.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A3{constructor(e){this.key=e}}class j3{constructor(e){this.key=e}}class bR{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Bt(),this.mutatedKeys=Bt(),this.Aa=Y4(e),this.Ra=new cu(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new qb,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,g)=>{const v=i.get(f),m=Mp(this.query,g)?g:null,E=!!v&&this.mutatedKeys.has(v.key),A=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let C=!1;v&&m?v.data.isEqual(m.data)?E!==A&&(r.track({type:3,doc:m}),C=!0):this.ga(v,m)||(r.track({type:2,doc:m}),C=!0,(c&&this.Aa(m,c)>0||u&&this.Aa(m,u)<0)&&(l=!0)):!v&&m?(r.track({type:0,doc:m}),C=!0):v&&!m&&(r.track({type:1,doc:v}),C=!0,(c||u)&&(l=!0)),C&&(m?(o=o.add(m),s=A?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{Ra:o,fa:r,ns:l,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((f,g)=>function(m,E){const A=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return jt()}};return A(m)-A(E)}(f.type,g.type)||this.Aa(f.doc,g.doc)),this.pa(r),i=i!=null&&i;const l=n&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new Tu(this.query,e.Ra,s,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new qb,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Bt(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new j3(r))}),this.da.forEach(r=>{e.has(r)||n.push(new A3(r))}),n}ba(e){this.Ta=e.Ts,this.da=Bt();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Tu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class wR{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class _R{constructor(e){this.key=e,this.va=!1}}class NR{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Mu(l=>K4(l),Dp),this.Ma=new Map,this.xa=new Set,this.Oa=new $n(ft.comparator),this.Na=new Map,this.La=new vy,this.Ba={},this.ka=new Map,this.qa=ju.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function SR(t,e,n=!0){const r=R3(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await T3(r,e,n,!0),i}async function ER(t,e){const n=R3(t);await T3(n,e,!0,!1)}async function T3(t,e,n,r){const i=await GP(t.localStore,pa(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let l;return r&&(l=await AR(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&b3(t.remoteStore,i),l}async function AR(t,e,n,r,i){t.Ka=(g,v,m)=>async function(A,C,b,I){let O=C.view.ma(b);O.ns&&(O=await Vb(A.localStore,C.query,!1).then(({documents:z})=>C.view.ma(z,O)));const V=I&&I.targetChanges.get(C.targetId),ne=I&&I.targetMismatches.get(C.targetId)!=null,le=C.view.applyChanges(O,A.isPrimaryClient,V,ne);return Gb(A,C.targetId,le.wa),le.snapshot}(t,g,v,m);const s=await Vb(t.localStore,e,!0),o=new bR(e,s.Ts),l=o.ma(s.documents),c=Lh.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(l,t.isPrimaryClient,c);Gb(t,n,u.wa);const f=new wR(e,n,o);return t.Fa.set(e,f),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),u.snapshot}async function jR(t,e,n){const r=It(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Dp(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await M1(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&by(r.remoteStore,i.targetId),F1(r,i.targetId)}).catch(Ih)):(F1(r,i.targetId),await M1(r.localStore,i.targetId,!0))}async function TR(t,e){const n=It(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),by(n.remoteStore,r.targetId))}async function kR(t,e,n){const r=MR(t);try{const i=await function(o,l){const c=It(o),u=dt.now(),f=l.reduce((m,E)=>m.add(E.key),Bt());let g,v;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let E=oo(),A=Bt();return c.cs.getEntries(m,f).next(C=>{E=C,E.forEach((b,I)=>{I.isValidDocument()||(A=A.add(b))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,E)).next(C=>{g=C;const b=[];for(const I of l){const O=XI(I,g.get(I.key).overlayedDocument);O!=null&&b.push(new wl(I.key,O,U4(O.value.mapValue),ps.exists(!0)))}return c.mutationQueue.addMutationBatch(m,u,b,l)}).next(C=>{v=C;const b=C.applyToLocalDocumentSet(g,A);return c.documentOverlayCache.saveOverlays(m,C.batchId,b)})}).then(()=>({batchId:v.batchId,changes:X4(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new $n(tn)),u=u.insert(l,c),o.Ba[o.currentUser.toKey()]=u}(r,i.batchId,n),await Mh(r,i.changes),await zp(r.remoteStore)}catch(i){const s=Ey(i,"Failed to persist write");n.reject(s)}}async function k3(t,e){const n=It(t);try{const r=await $P(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&(mn(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?mn(o.va):i.removedDocuments.size>0&&(mn(o.va),o.va=!1))}),await Mh(n,r,e)}catch(r){await Ih(r)}}function Wb(t,e,n){const r=It(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const c=It(o);c.onlineState=l;let u=!1;c.queries.forEach((f,g)=>{for(const v of g.j_)v.Z_(l)&&(u=!0)}),u&&Ty(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function CR(t,e,n){const r=It(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new $n(ft.comparator);o=o.insert(s,ti.newNoDocument(s,Ct.min()));const l=Bt().add(s),c=new Vp(Ct.min(),new Map,new $n(tn),o,l);await k3(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),Cy(r)}else await M1(r.localStore,e,!1).then(()=>F1(r,e,n)).catch(Ih)}async function IR(t,e){const n=It(t),r=e.batch.batchId;try{const i=await qP(n.localStore,e);I3(n,r,null),C3(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Mh(n,i)}catch(i){await Ih(i)}}async function PR(t,e,n){const r=It(t);try{const i=await function(o,l){const c=It(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return c.mutationQueue.lookupMutationBatch(u,l).next(g=>(mn(g!==null),f=g.keys(),c.mutationQueue.removeMutationBatch(u,g))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,f,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>c.localDocuments.getDocuments(u,f))})}(r.localStore,e);I3(r,e,n),C3(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Mh(r,i)}catch(i){await Ih(i)}}function C3(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function I3(t,e,n){const r=It(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function F1(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||P3(t,r)})}function P3(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(by(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Cy(t))}function Gb(t,e,n){for(const r of n)r instanceof A3?(t.La.addReference(r.key,e),RR(t,r)):r instanceof j3?(Ze("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||P3(t,r.key)):jt()}function RR(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(Ze("SyncEngine","New document in limbo: "+n),t.xa.add(r),Cy(t))}function Cy(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ft(Tn.fromString(e)),r=t.qa.next();t.Na.set(r,new _R(n)),t.Oa=t.Oa.insert(n,r),b3(t.remoteStore,new Yo(pa(Lp(n.path)),r,"TargetPurposeLimboResolution",ay.oe))}}async function Mh(t,e,n){const r=It(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{o.push(r.Ka(c,e,n).then(u=>{var f;if((u||n)&&r.isPrimaryClient){const g=u?!u.fromCache:(f=n==null?void 0:n.targetChanges.get(c.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(c.targetId,g?"current":"not-current")}if(u){i.push(u);const g=xy.Wi(c.targetId,u);s.push(g)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(c,u){const f=It(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>Le.forEach(u,v=>Le.forEach(v.$i,m=>f.persistence.referenceDelegate.addReference(g,v.targetId,m)).next(()=>Le.forEach(v.Ui,m=>f.persistence.referenceDelegate.removeReference(g,v.targetId,m)))))}catch(g){if(!Ph(g))throw g;Ze("LocalStore","Failed to update sequence numbers: "+g)}for(const g of u){const v=g.targetId;if(!g.fromCache){const m=f.os.get(v),E=m.snapshotVersion,A=m.withLastLimboFreeSnapshotVersion(E);f.os=f.os.insert(v,A)}}}(r.localStore,s))}async function LR(t,e){const n=It(t);if(!n.currentUser.isEqual(e)){Ze("SyncEngine","User change. New user:",e.toKey());const r=await g3(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(c=>{c.reject(new We(ke.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Mh(n,r.hs)}}function DR(t,e){const n=It(t),r=n.Na.get(e);if(r&&r.va)return Bt().add(r.key);{let i=Bt();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const l=n.Fa.get(o);i=i.unionWith(l.view.Va)}return i}}function R3(t){const e=It(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=k3.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=DR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=CR.bind(null,e),e.Ca.d_=yR.bind(null,e.eventManager),e.Ca.$a=xR.bind(null,e.eventManager),e}function MR(t){const e=It(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=PR.bind(null,e),e}class Zm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Up(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return zP(this.persistence,new UP,e.initialUser,this.serializer)}Ga(e){return new OP(yy.Zr,this.serializer)}Wa(e){return new YP}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Zm.provider={build:()=>new Zm};class V1{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Wb(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=LR.bind(null,this.syncEngine),await pR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new vR}()}createDatastore(e){const n=Up(e.databaseInfo.databaseId),r=function(s){return new ZP(s)}(e.databaseInfo);return function(s,o,l,c){return new nR(s,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,l){return new iR(r,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Wb(this.syncEngine,n,0),function(){return Bb.D()?new Bb:new QP}())}createSyncEngine(e,n){return function(i,s,o,l,c,u,f){const g=new NR(i,s,o,l,c,u);return f&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=It(i);Ze("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Dh(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}V1.provider={build:()=>new V1};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ao("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Zr.UNAUTHENTICATED,this.clientId=O4.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{Ze("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Ze("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Ey(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function e0(t,e){t.asyncQueue.verifyOperationInProgress(),Ze("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await g3(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Kb(t,e){t.asyncQueue.verifyOperationInProgress();const n=await FR(t);Ze("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>zb(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>zb(e.remoteStore,i)),t._onlineComponents=e}async function FR(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ze("FirestoreClient","Using user provided OfflineComponentProvider");try{await e0(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===ke.FAILED_PRECONDITION||i.code===ke.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Nu("Error using user provided cache. Falling back to memory cache: "+n),await e0(t,new Zm)}}else Ze("FirestoreClient","Using default OfflineComponentProvider"),await e0(t,new Zm);return t._offlineComponents}async function L3(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ze("FirestoreClient","Using user provided OnlineComponentProvider"),await Kb(t,t._uninitializedComponentsProvider._online)):(Ze("FirestoreClient","Using default OnlineComponentProvider"),await Kb(t,new V1))),t._onlineComponents}function VR(t){return L3(t).then(e=>e.syncEngine)}async function ep(t){const e=await L3(t),n=e.eventManager;return n.onListen=SR.bind(null,e.syncEngine),n.onUnlisten=jR.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=ER.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=TR.bind(null,e.syncEngine),n}function UR(t,e,n={}){const r=new Xa;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,u){const f=new Iy({next:v=>{f.Za(),o.enqueueAndForget(()=>jy(s,g));const m=v.docs.has(l);!m&&v.fromCache?u.reject(new We(ke.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&v.fromCache&&c&&c.source==="server"?u.reject(new We(ke.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(v)},error:v=>u.reject(v)}),g=new ky(Lp(l.path),f,{includeMetadataChanges:!0,_a:!0});return Ay(s,g)}(await ep(t),t.asyncQueue,e,n,r)),r.promise}function BR(t,e,n={}){const r=new Xa;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,u){const f=new Iy({next:v=>{f.Za(),o.enqueueAndForget(()=>jy(s,g)),v.fromCache&&c.source==="server"?u.reject(new We(ke.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(v)},error:v=>u.reject(v)}),g=new ky(l,f,{includeMetadataChanges:!0,_a:!0});return Ay(s,g)}(await ep(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D3(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M3(t,e,n){if(!n)throw new We(ke.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function zR(t,e,n,r){if(e===!0&&r===!0)throw new We(ke.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Qb(t){if(!ft.isDocumentKey(t))throw new We(ke.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Xb(t){if(ft.isDocumentKey(t))throw new We(ke.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function qp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":jt()}function Ti(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new We(ke.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=qp(t);throw new We(ke.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new We(ke.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new We(ke.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}zR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=D3((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new We(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new We(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new We(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class $p{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jb({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new We(ke.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new We(ke.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jb(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new aI;switch(r.type){case"firstParty":return new uI(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new We(ke.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Yb.get(n);r&&(Ze("ComponentProvider","Removing Datastore"),Yb.delete(n),r.terminate())}(this),Promise.resolve()}}function qR(t,e,n,r={}){var i;const s=(t=Ti(t,$p))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Nu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=Zr.MOCK_USER;else{l=qN(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new We(ke.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Zr(u)}t._authCredentials=new oI(new M4(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ho(this.firestore,e,this._query)}}class ri{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ol(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ri(this.firestore,e,this._key)}}class ol extends ho{constructor(e,n,r){super(e,n,Lp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ri(this.firestore,null,new ft(e))}withConverter(e){return new ol(this.firestore,e,this._path)}}function zt(t,e,...n){if(t=Mn(t),M3("collection","path",e),t instanceof $p){const r=Tn.fromString(e,...n);return Xb(r),new ol(t,null,r)}{if(!(t instanceof ri||t instanceof ol))throw new We(ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Tn.fromString(e,...n));return Xb(r),new ol(t.firestore,null,r)}}function ct(t,e,...n){if(t=Mn(t),arguments.length===1&&(e=O4.newId()),M3("doc","path",e),t instanceof $p){const r=Tn.fromString(e,...n);return Qb(r),new ri(t,null,new ft(r))}{if(!(t instanceof ri||t instanceof ol))throw new We(ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Tn.fromString(e,...n));return Qb(r),new ri(t.firestore,t instanceof ol?t.converter:null,new ft(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zb{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new y3(this,"async_queue_retry"),this.Vu=()=>{const r=Zg();r&&Ze("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Zg();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Zg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Xa;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ph(e))throw e;Ze("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw ao("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=Sy.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&jt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function e5(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class lo extends $p{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Zb,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Zb(e),this._firestoreClient=void 0,await e}}}function $R(t,e){const n=typeof t=="object"?t:Tp(),r=typeof t=="string"?t:"(default)",i=Ah(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=Gv("firestore");s&&qR(i,...s)}return i}function Hp(t){if(t._terminated)throw new We(ke.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||HR(t),t._firestoreClient}function HR(t){var e,n,r;const i=t._freezeSettings(),s=function(l,c,u,f){return new NI(l,c,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,D3(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new OR(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ku(Ur.fromBase64String(e))}catch(n){throw new We(ke.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ku(Ur.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new We(ke.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Mr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new We(ke.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new We(ke.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return tn(this._lat,e._lat)||tn(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR=/^__.*__$/;class GR{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new wl(e,this.data,this.fieldMask,n,this.fieldTransforms):new Rh(e,this.data,n,this.fieldTransforms)}}class O3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new wl(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function F3(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw jt()}}class Dy{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Dy(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return tp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(F3(this.Cu)&&WR.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class KR{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Up(e)}Qu(e,n,r,i=!1){return new Dy({Cu:e,methodName:n,qu:r,path:Mr.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Gp(t){const e=t._freezeSettings(),n=Up(t._databaseId);return new KR(t._databaseId,!!e.ignoreUndefinedProperties,n)}function V3(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);My("Data must be an object, but it was:",o,r);const l=U3(r,o);let c,u;if(s.merge)c=new Ki(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const g of s.mergeFields){const v=U1(e,g,n);if(!o.contains(v))throw new We(ke.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);z3(f,v)||f.push(v)}c=new Ki(f),u=o.fieldTransforms.filter(g=>c.covers(g.field))}else c=null,u=o.fieldTransforms;return new GR(new Ni(l),c,u)}class Kp extends Py{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Kp}}function YR(t,e,n,r){const i=t.Qu(1,e,n);My("Data must be an object, but it was:",i,r);const s=[],o=Ni.empty();wc(r,(c,u)=>{const f=Oy(e,c,n);u=Mn(u);const g=i.Nu(f);if(u instanceof Kp)s.push(f);else{const v=Oh(u,g);v!=null&&(s.push(f),o.set(f,v))}});const l=new Ki(s);return new O3(o,l,i.fieldTransforms)}function QR(t,e,n,r,i,s){const o=t.Qu(1,e,n),l=[U1(e,r,n)],c=[i];if(s.length%2!=0)throw new We(ke.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<s.length;v+=2)l.push(U1(e,s[v])),c.push(s[v+1]);const u=[],f=Ni.empty();for(let v=l.length-1;v>=0;--v)if(!z3(u,l[v])){const m=l[v];let E=c[v];E=Mn(E);const A=o.Nu(m);if(E instanceof Kp)u.push(m);else{const C=Oh(E,A);C!=null&&(u.push(m),f.set(m,C))}}const g=new Ki(u);return new O3(f,g,o.fieldTransforms)}function XR(t,e,n,r=!1){return Oh(n,t.Qu(r?4:3,e))}function Oh(t,e){if(B3(t=Mn(t)))return My("Unsupported field value:",e,t),U3(t,e);if(t instanceof Py)return function(r,i){if(!F3(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const l of r){let c=Oh(l,i.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Mn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return HI(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=dt.fromDate(r);return{timestampValue:Xm(i.serializer,s)}}if(r instanceof dt){const s=new dt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Xm(i.serializer,s)}}if(r instanceof Ry)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ku)return{bytesValue:c3(i.serializer,r._byteString)};if(r instanceof ri){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:gy(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Ly)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return hy(l.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${qp(r)}`)}(t,e)}function U3(t,e){const n={};return F4(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wc(t,(r,i)=>{const s=Oh(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function B3(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof dt||t instanceof Ry||t instanceof ku||t instanceof ri||t instanceof Py||t instanceof Ly)}function My(t,e,n){if(!B3(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=qp(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function U1(t,e,n){if((e=Mn(e))instanceof Wp)return e._internalPath;if(typeof e=="string")return Oy(t,e);throw tp("Field path arguments must be of type string or ",t,!1,void 0,n)}const JR=new RegExp("[~\\*/\\[\\]]");function Oy(t,e,n){if(e.search(JR)>=0)throw tp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Wp(...e.split("."))._internalPath}catch{throw tp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function tp(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new We(ke.INVALID_ARGUMENT,l+t+c)}function z3(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q3{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ri(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ZR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Yp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class ZR extends q3{data(){return super.data()}}function Yp(t,e){return typeof e=="string"?Oy(t,e):e instanceof Wp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $3(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new We(ke.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Fy{}class Vy extends Fy{}function lr(t,e,...n){let r=[];e instanceof Fy&&r.push(e),r=r.concat(n),function(s){const o=s.filter(c=>c instanceof Uy).length,l=s.filter(c=>c instanceof Qp).length;if(o>1||o>0&&l>0)throw new We(ke.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Qp extends Vy{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Qp(e,n,r)}_apply(e){const n=this._parse(e);return W3(e._query,n),new ho(e.firestore,e.converter,I1(e._query,n))}_parse(e){const n=Gp(e.firestore);return function(s,o,l,c,u,f,g){let v;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new We(ke.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){n5(g,f);const m=[];for(const E of g)m.push(t5(c,s,E));v={arrayValue:{values:m}}}else v=t5(c,s,g)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||n5(g,f),v=XR(l,o,g,f==="in"||f==="not-in");return hr.create(u,f,v)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function ni(t,e,n){const r=e,i=Yp("where",t);return Qp._create(i,r,n)}class Uy extends Fy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Uy(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Fs.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const l=s.getFlattenedFilters();for(const c of l)W3(o,c),o=I1(o,c)}(e._query,n),new ho(e.firestore,e.converter,I1(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class By extends Vy{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new By(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new We(ke.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new We(ke.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new fh(s,o)}(e._query,this._field,this._direction);return new ho(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Du(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function Fh(t,e="asc"){const n=e,r=Yp("orderBy",t);return By._create(r,n)}class zy extends Vy{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new zy(e,n,r)}_apply(e){return new ho(e.firestore,e.converter,Km(e._query,this._limit,this._limitType))}}function H3(t){return zy._create("limit",t,"F")}function t5(t,e,n){if(typeof(n=Mn(n))=="string"){if(n==="")throw new We(ke.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!G4(e)&&n.indexOf("/")!==-1)throw new We(ke.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Tn.fromString(n));if(!ft.isDocumentKey(r))throw new We(ke.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return _b(t,new ft(r))}if(n instanceof ri)return _b(t,n._key);throw new We(ke.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${qp(n)}.`)}function n5(t,e){if(!Array.isArray(t)||t.length===0)throw new We(ke.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function W3(t,e){const n=function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new We(ke.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new We(ke.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class eL{convertValue(e,n="none"){switch(hc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(dc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw jt()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return wc(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>rr(o.doubleValue));return new Ly(s)}convertGeoPoint(e){return new Ry(rr(e.latitude),rr(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=ly(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(uh(e));default:return null}}convertTimestamp(e){const n=fl(e);return new dt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Tn.fromString(e);mn(p3(r));const i=new dh(r.get(1),r.get(3)),s=new ft(r.popFirst(5));return i.isEqual(n)||ao(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G3(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class K3 extends q3{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new sm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Yp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class sm extends K3{data(e={}){return super.data(e)}}class Y3{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new jd(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new sm(this._firestore,this._userDataWriter,r.key,r,new jd(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new We(ke.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const c=new sm(i._firestore,i._userDataWriter,l.doc.key,l.doc,new jd(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const c=new sm(i._firestore,i._userDataWriter,l.doc.key,l.doc,new jd(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:tL(l.type),doc:c,oldIndex:u,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function tL(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return jt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ja(t){t=Ti(t,ri);const e=Ti(t.firestore,lo);return UR(Hp(e),t._key).then(n=>Q3(e,t,n))}class qy extends eL{constructor(e){super(),this.firestore=e}convertBytes(e){return new ku(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ri(this.firestore,null,n)}}function ya(t){t=Ti(t,ho);const e=Ti(t.firestore,lo),n=Hp(e),r=new qy(e);return $3(t._query),BR(n,t._query).then(i=>new Y3(e,r,t,i))}function ki(t,e,n){t=Ti(t,ri);const r=Ti(t.firestore,lo),i=G3(t.converter,e,n);return Xp(r,[V3(Gp(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,ps.none())])}function fr(t,e,n,...r){t=Ti(t,ri);const i=Ti(t.firestore,lo),s=Gp(i);let o;return o=typeof(e=Mn(e))=="string"||e instanceof Wp?QR(s,"updateDoc",t._key,e,n,r):YR(s,"updateDoc",t._key,e),Xp(i,[o.toMutation(t._key,ps.exists(!0))])}function fc(t){return Xp(Ti(t.firestore,lo),[new fy(t._key,ps.none())])}function xa(t,e){const n=Ti(t.firestore,lo),r=ct(t),i=G3(t.converter,e);return Xp(n,[V3(Gp(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,ps.exists(!1))]).then(()=>r)}function Zt(t,...e){var n,r,i;t=Mn(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||e5(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(e5(e[o])){const g=e[o];e[o]=(n=g.next)===null||n===void 0?void 0:n.bind(g),e[o+1]=(r=g.error)===null||r===void 0?void 0:r.bind(g),e[o+2]=(i=g.complete)===null||i===void 0?void 0:i.bind(g)}let c,u,f;if(t instanceof ri)u=Ti(t.firestore,lo),f=Lp(t._key.path),c={next:g=>{e[o]&&e[o](Q3(u,t,g))},error:e[o+1],complete:e[o+2]};else{const g=Ti(t,ho);u=Ti(g.firestore,lo),f=g._query;const v=new qy(u);c={next:m=>{e[o]&&e[o](new Y3(u,v,g,m))},error:e[o+1],complete:e[o+2]},$3(t._query)}return function(v,m,E,A){const C=new Iy(A),b=new ky(m,C,E);return v.asyncQueue.enqueueAndForget(async()=>Ay(await ep(v),b)),()=>{C.Za(),v.asyncQueue.enqueueAndForget(async()=>jy(await ep(v),b))}}(Hp(u),f,l,c)}function Xp(t,e){return function(r,i){const s=new Xa;return r.asyncQueue.enqueueAndForget(async()=>kR(await VR(r),i,s)),s.promise}(Hp(t),e)}function Q3(t,e,n){const r=n.docs.get(e._key),i=new qy(t);return new K3(t,i,e._key,r,new jd(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(i){Lu=i})(xc),dl(new ro("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new lo(new lI(r.getProvider("auth-internal")),new hI(r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new We(ke.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new dh(u.options.projectId,f)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),ms(vb,"4.7.3",e),ms(vb,"4.7.3","esm2017")})();var nL="firebase",rL="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ms(nL,rL,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X3="firebasestorage.googleapis.com",iL="storageBucket",sL=2*60*1e3,aL=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na extends wa{constructor(e,n,r=0){super(t0(e),`Firebase Storage: ${n} (${t0(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Na.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return t0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ba;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ba||(ba={}));function t0(t){return"storage/"+t}function oL(){const t="An unknown error occurred, please check the error payload for server response.";return new Na(ba.UNKNOWN,t)}function lL(){return new Na(ba.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function cL(){return new Na(ba.CANCELED,"User canceled the upload/download.")}function uL(t){return new Na(ba.INVALID_URL,"Invalid URL '"+t+"'.")}function dL(t){return new Na(ba.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function r5(t){return new Na(ba.INVALID_ARGUMENT,t)}function J3(){return new Na(ba.APP_DELETED,"The Firebase app was deleted.")}function hL(t){return new Na(ba.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Rs.makeFromUrl(e,n)}catch{return new Rs(e,"")}if(r.path==="")return r;throw dL(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(V){V.path.charAt(V.path.length-1)==="/"&&(V.path_=V.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function u(V){V.path_=decodeURIComponent(V.path)}const f="v[A-Za-z0-9_]+",g=n.replace(/[.]/g,"\\."),v="(/([^?#]*).*)?$",m=new RegExp(`^https?://${g}/${f}/b/${i}/o${v}`,"i"),E={bucket:1,path:3},A=n===X3?"(?:storage.googleapis.com|storage.cloud.google.com)":n,C="([^?#]*)",b=new RegExp(`^https?://${A}/${i}/${C}`,"i"),O=[{regex:l,indices:c,postModify:s},{regex:m,indices:E,postModify:u},{regex:b,indices:{bucket:1,path:2},postModify:u}];for(let V=0;V<O.length;V++){const ne=O[V],le=ne.regex.exec(e);if(le){const z=le[ne.indices.bucket];let T=le[ne.indices.path];T||(T=""),r=new Rs(z,T),ne.postModify(r);break}}if(r==null)throw uL(e);return r}}class fL{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mL(t,e,n){let r=1,i=null,s=null,o=!1,l=0;function c(){return l===2}let u=!1;function f(...C){u||(u=!0,e.apply(null,C))}function g(C){i=setTimeout(()=>{i=null,t(m,c())},C)}function v(){s&&clearTimeout(s)}function m(C,...b){if(u){v();return}if(C){v(),f.call(null,C,...b);return}if(c()||o){v(),f.call(null,C,...b);return}r<64&&(r*=2);let O;l===1?(l=2,O=0):O=(r+Math.random())*1e3,g(O)}let E=!1;function A(C){E||(E=!0,v(),!u&&(i!==null?(C||(l=2),clearTimeout(i),g(0)):C||(l=1)))}return g(0),s=setTimeout(()=>{o=!0,A(!0)},n),A}function pL(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gL(t){return t!==void 0}function i5(t,e,n,r){if(r<e)throw r5(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw r5(`Invalid value for '${t}'. Expected ${n} or less.`)}function vL(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var np;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(np||(np={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yL(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xL{constructor(e,n,r,i,s,o,l,c,u,f,g,v=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=f,this.connectionFactory_=g,this.retry=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((m,E)=>{this.resolve_=m,this.reject_=E,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new kf(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===np.NO_ERROR,c=s.getStatus();if(!l||yL(c,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===np.ABORT;r(!1,new kf(!1,null,f));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new kf(u,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,l=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());gL(c)?s(c):s()}catch(c){o(c)}else if(l!==null){const c=oL();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(i.canceled){const c=this.appDelete_?J3():cL();o(c)}else{const c=lL();o(c)}};this.canceled_?n(!1,new kf(!1,null,!0)):this.backoffId_=mL(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&pL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class kf{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function bL(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function wL(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function _L(t,e){e&&(t["X-Firebase-GMPID"]=e)}function NL(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function SL(t,e,n,r,i,s,o=!0){const l=vL(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return _L(u,e),bL(u,n),wL(u,s),NL(u,r),new xL(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EL(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function AL(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(e,n){this._service=e,n instanceof Rs?this._location=n:this._location=Rs.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new rp(e,n)}get root(){const e=new Rs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return AL(this._location.path)}get storage(){return this._service}get parent(){const e=EL(this._location.path);if(e===null)return null;const n=new Rs(this._location.bucket,e);return new rp(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw hL(e)}}function s5(t,e){const n=e==null?void 0:e[iL];return n==null?null:Rs.makeFromBucketSpec(n,t)}function jL(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:qN(i,t.app.options.projectId))}class TL{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=X3,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=sL,this._maxUploadRetryTime=aL,this._requests=new Set,i!=null?this._bucket=Rs.makeFromBucketSpec(i,this._host):this._bucket=s5(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Rs.makeFromBucketSpec(this._url,e):this._bucket=s5(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){i5("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){i5("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new rp(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new fL(J3());{const o=SL(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const a5="@firebase/storage",o5="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z3="storage";function kL(t=Tp(),e){t=Mn(t);const r=Ah(t,Z3).getImmediate({identifier:e}),i=Gv("storage");return i&&CL(r,...i),r}function CL(t,e,n,r={}){jL(t,e,n,r)}function IL(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new TL(n,r,i,e,xc)}function PL(){dl(new ro(Z3,IL,"PUBLIC").setMultipleInstances(!0)),ms(a5,o5,""),ms(a5,o5,"esm2017")}PL();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eS="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RL{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||n.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B1="us-central1";class LL{constructor(e,n,r,i,s=B1,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new RL(n,r,i),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(s);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=B1}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function DL(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const l5="@firebase/functions",c5="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ML="auth-internal",OL="app-check-internal",FL="messaging-internal";function VL(t,e){const n=(r,{instanceIdentifier:i})=>{const s=r.getProvider("app").getImmediate(),o=r.getProvider(ML),l=r.getProvider(FL),c=r.getProvider(OL);return new LL(s,o,l,c,i,t)};dl(new ro(eS,n,"PUBLIC").setMultipleInstances(!0)),ms(l5,c5,e),ms(l5,c5,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UL(t=Tp(),e=B1){const r=Ah(Mn(t),eS).getImmediate({identifier:e}),i=Gv("functions");return i&&BL(r,...i),r}function BL(t,e,n){DL(Mn(t),e,n)}VL(fetch.bind(self));const zL={apiKey:"AIzaSyB1ddVOczgt5n2NkoIq3H_5x_eB0Aqw2HI",authDomain:"alojamientos-3c46b.firebaseapp.com",projectId:"alojamientos-3c46b",storageBucket:"alojamientos-3c46b.appspot.com",messagingSenderId:"858434059981",appId:"1:858434059981:web:f235cea133b874f985b384"},Me="alojamientos-3c46b",Jp=WN(zL),xr=iI(Jp),Ue=$R(Jp);kL(Jp);UL(Jp);const tS=async()=>{console.log(" DIAGNSTICO COMPLETO DE FIREBASE"),console.log("=====================================");try{console.log(" App ID:",Me),console.log(`
 Verificando estructura de base de datos...`);const t=zt(Ue,"artifacts",Me,"public","data","users");console.log(" Ruta de usuarios:",`artifacts/${Me}/public/data/users`);try{const e=await ya(t);if(console.log(" Total de usuarios encontrados:",e.size),e.empty)return console.log(" No hay usuarios en la coleccin"),{hasUsers:!1,users:[]};const n=[];e.docs.forEach((s,o)=>{const l=s.data(),c={id:s.id,email:l.email||"Sin email",role:l.role||"Sin rol",status:l.status||"Sin estado",createdAt:l.createdAt||"Sin fecha",fullName:l.fullName||"Sin nombre"};n.push(c),console.log(` Usuario ${o+1}:`,c)}),console.log(`
 Verificando configuracin de empresa...`);const r=ct(Ue,"artifacts",Me,"public","data","settings","company_info"),i=await Ja(r);i.exists()?(console.log(" Configuracin de empresa encontrada"),console.log(" Configuracin:",i.data())):console.log(" No hay configuracin de empresa"),console.log(`
 Verificando permisos...`);try{const s=lr(t,H3(1));await ya(s),console.log(" Permisos de lectura OK")}catch(s){console.error(" Error de permisos:",s)}return{hasUsers:!0,users:n,hasSettings:i.exists(),settings:i.exists()?i.data():null}}catch(e){return console.error(" Error accediendo a usuarios:",e),{hasUsers:!1,error:e.message}}}catch(t){return console.error(" Error en diagnstico:",t),{hasUsers:!1,error:t.message}}},qL=async()=>{try{console.log(" Buscando usuario ms antiguo...");const t=zt(Ue,"artifacts",Me,"public","data","users");try{const i=lr(t,Fh("createdAt","asc"),H3(1)),s=await ya(i);if(!s.empty){const o=s.docs[0],l=o.data();return console.log(" Usuario ms antiguo (con ordenamiento):",{id:o.id,email:l.email,role:l.role,createdAt:l.createdAt}),{user:o,data:l}}}catch(i){console.warn(" Error con ordenamiento, usando mtodo alternativo:",i)}const e=await ya(t);if(e.empty)return console.log(" No hay usuarios"),null;let n=null,r=null;return e.docs.forEach(i=>{const s=i.data(),o=s.createdAt;o&&(!r||o<r)&&(r=o,n={user:i,data:s})}),n?console.log(" Usuario ms antiguo (mtodo alternativo):",{id:n.user.id,email:n.data.email,role:n.data.role,createdAt:n.data.createdAt}):console.log(" No se pudo determinar el usuario ms antiguo"),n}catch(t){return console.error(" Error buscando usuario ms antiguo:",t),null}},$L=async()=>{try{console.log(" Verificando usuarios en Authentication...");const t=xr.currentUser;return t?(console.log(" Usuario autenticado encontrado:",t.email),!0):(console.log(" No hay usuario autenticado, pero asumiendo que hay usuarios en el sistema"),!0)}catch(t){return console.error(" Error verificando Authentication:",t),!1}},nS=ue.createContext();function HL({message:t,type:e,onClose:n}){const r=e==="success"?"bg-green-500":"bg-red-500";return ue.useEffect(()=>{const i=setTimeout(n,4e3);return()=>clearTimeout(i)},[n]),a.jsx("div",{className:`fixed top-5 right-5 ${r} text-white py-2 px-4 rounded-lg shadow-lg animate-fade-in-down`,children:t})}function WL({children:t}){const[e,n]=ue.useState([]),r=(s,o="success")=>{const l=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;n(c=>[...c,{id:l,message:s,type:o}])},i=s=>{n(o=>o.filter(l=>l.id!==s))};return a.jsxs(nS.Provider,{value:{addNotification:r},children:[t,a.jsx("div",{className:"fixed top-5 right-5 z-50 space-y-2",children:e.map(s=>a.jsx(HL,{message:s.message,type:s.type,onClose:()=>i(s.id)},s.id))})]})}const xn=()=>ue.useContext(nS);function GL(t,e=10,n=!0){const r=ue.useRef(null),i=ue.useRef(Date.now()),s=ue.useCallback(()=>{if(!n||!t)return;r.current&&clearTimeout(r.current);const o=e*60*1e3;i.current=Date.now(),r.current=setTimeout(()=>{console.log(` Sesin cerrada por inactividad (${e} minutos)`),t&&t()},o)},[t,e,n]);ue.useEffect(()=>{if(!n||!t)return;const o=["mousedown","mousemove","keypress","scroll","touchstart","click","keydown"],l=()=>{Date.now()-i.current>1e3&&s()};return o.forEach(c=>{window.addEventListener(c,l,{passive:!0})}),s(),()=>{o.forEach(c=>{window.removeEventListener(c,l)}),r.current&&clearTimeout(r.current)}},[s,n,t]),ue.useEffect(()=>{n&&t&&s()},[e,n,s,t])}const Vh=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),rS=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),KL=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),YL=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M15 21a6 6 0 00-9-5.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-3-5.197m0 0A4 4 0 0112 4.354a4 4 0 013 3.249m-3 7.586a4 4 0 01-3-3.25"})}),ip=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),am=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),iS=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h7"})}),Zp=()=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),tc=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),QL=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),XL=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})}),Fu=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})}),JL=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),ZL=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-5 5v-5zM4.828 7l2.586 2.586a2 2 0 002.828 0L12 7H4.828zM4.828 17h5l-5-5v5zM12 7l2.586 2.586a2 2 0 002.828 0L20 7h-8z"})}),Xi=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),uu=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"})}),sS=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),sp=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),ll=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),aS=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),ds=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),pl=()=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),gh=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),ap=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),e8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),t8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})});function Uh({children:t}){const[e,n]=ue.useState(!1),[r,i]=ue.useState({top:0,left:0,position:"bottom-right"}),s=ue.useRef(null),o=ue.useRef(null);ue.useEffect(()=>{const c=u=>{s.current&&!s.current.contains(u.target)&&n(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[s]),ue.useEffect(()=>{if(e&&o.current){const c=o.current.getBoundingClientRect(),u=window.innerHeight,f=window.innerWidth,g=u-c.bottom,v=c.top,m=f-c.right,E=c.left;let A=c.bottom+8,C=c.right-224,b="bottom-right";g<200&&v>g&&(A=c.top-8,b=m>224?"top-right":"top-left"),m<224&&E>224&&(C=c.left-224,b=g>200?"bottom-left":"top-left"),C<8&&(C=8),C+224>f-8&&(C=f-232),A<8&&(A=8),A+200>u-8&&(A=u-208),i({top:A,left:C,position:b})}},[e]);const l=()=>"fixed w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50";return a.jsxs("div",{className:"relative inline-block text-left",ref:s,children:[a.jsxs("button",{ref:o,onClick:()=>n(!e),className:"inline-flex justify-center w-full rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:["Acciones ",a.jsx(XL,{className:"-mr-1 ml-2 h-5 w-5"})]}),e&&a.jsx("div",{className:l(),style:{top:`${r.top}px`,left:`${r.left}px`},children:a.jsx("div",{className:"py-1",role:"menu","aria-orientation":"vertical",onClick:()=>n(!1),children:t})})]})}function n8({isOpen:t,onClose:e,onSave:n,service:r,clients:i,isDemo:s}){var $;const{addNotification:o}=xn(),[l,c]=ue.useState({}),[u,f]=ue.useState(""),[g,v]=ue.useState(""),[m,E]=ue.useState(""),[A,C]=ue.useState(!1),[b,I]=ue.useState(""),[O,V]=ue.useState(!1),ne=["Activo","Periodo de Gracia Vencido","Pendiente Pago","Pago","Cancelado"],le=()=>{const H=new Date,Y=H.getFullYear().toString().slice(-2),M=(H.getMonth()+1).toString().padStart(2,"0"),U=H.getDate().toString().padStart(2,"0"),ee=H.getTime().toString().slice(-6);return`SRV-${Y}${M}${U}-${ee}`},z=(H,Y)=>{if(!H||H==="One-Time"||!Y)return{startDate:"",endDate:""};const M=new Date(Y);let U=new Date(M);switch(H){case"Monthly":U.setMonth(U.getMonth()+1);break;case"Semiannually":U.setMonth(U.getMonth()+6);break;case"Annually":U.setFullYear(U.getFullYear()+1);break;case"Biennially":U.setFullYear(U.getFullYear()+2);break;case"Triennially":U.setFullYear(U.getFullYear()+3);break;case"Custom":return{startDate:M.toISOString().split("T")[0],endDate:""};default:if(H&&H!=="Custom"&&H!=="One-Time"){const ee=H.match(/(\d+)\s*mes/i),fe=H.match(/(\d+)\s*ao/i);if(ee){const Q=parseInt(ee[1]);U.setMonth(U.getMonth()+Q)}else if(fe){const Q=parseInt(fe[1]);U.setFullYear(U.getFullYear()+Q)}else return{startDate:M.toISOString().split("T")[0],endDate:""}}else return{startDate:"",endDate:""};break}return{startDate:M.toISOString().split("T")[0],endDate:U.toISOString().split("T")[0]}},T=()=>[{value:"One-Time",label:"Pago nico"},{value:"Monthly",label:"Mensual"},{value:"Semiannually",label:"Semestral"},{value:"Annually",label:"Anual"},{value:"Biennially",label:"Bianual (2 aos)"},{value:"Triennially",label:"Trienal (3 aos)"},{value:"Custom",label:"Otros"}];ue.useEffect(()=>{const H={clientName:"",clientEmail:"",serviceType:"Hosting",description:"",amount:"",currency:"USD",dueDate:"",billingCycle:"One-Time",status:"Activo",clientNotes:"",adminNotes:"",assignedUserId:""};if(r){c({...r,dueDate:r.dueDate?new Date(r.dueDate.seconds*1e3).toISOString().split("T")[0]:"",assignedUserId:r.assignedUserId||""}),v(r.serviceNumber||"");const Y=["Hosting","Dominio","Dominio + Hosting"];r.serviceType&&!Y.includes(r.serviceType)?(I(r.serviceType),V(!0)):(I(""),V(!1));const M=["One-Time","Monthly","Semiannually","Annually","Biennially","Triennially"];if(r.billingCycle&&!M.includes(r.billingCycle)?(E(r.billingCycle),C(!0)):(E(""),C(!1)),r.assignedUserId){const U=i.find(ee=>ee.id===r.assignedUserId);U&&f(U.email)}}else{const Y=le();c(H),f(""),v(Y),I(""),V(!1),E(""),C(!1)}},[r,i]);const k=H=>{const{name:Y,value:M}=H.target;c(U=>({...U,[Y]:M})),Y==="billingCycle"&&(M==="Custom"?C(!0):(C(!1),E(""))),Y==="serviceType"&&(M==="Otro"?V(!0):(V(!1),I("")))},N=H=>{const Y=H.target.value;E(Y),c(M=>({...M,billingCycle:Y||"Custom"}))},S=H=>{const Y=H.target.value;I(Y),c(M=>({...M,serviceType:Y||"Otro"}))},P=H=>{f(H);const Y=i.find(M=>M.email===H);c(Y?M=>({...M,clientEmail:Y.email,clientName:Y.fullName||Y.email.split("@")[0],assignedUserId:Y.id}):M=>({...M,assignedUserId:""}))},R=async H=>{if(H.preventDefault(),s){o("Funcin no disponible en modo demo.","error");return}try{const Y={...l,amount:parseFloat(l.amount),dueDate:dt.fromDate(new Date(l.dueDate)),serviceNumber:g};await n(Y),o(`Servicio ${r?"actualizado":"creado"} exitosamente.`,"success"),e()}catch(Y){o("Error al guardar el servicio.","error"),console.error(Y)}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:r?"Editar Servicio":"Aadir Nuevo Servicio"}),a.jsxs("form",{onSubmit:R,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nmero de Servicio"}),a.jsx("input",{type:"text",value:g,onChange:H=>v(H.target.value),className:"w-full p-2 border rounded-md bg-gray-50 font-mono",placeholder:"SRV-YYMMDD-XXXXXX",required:!0}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Identificador nico del servicio"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asignar a Cliente Existente"}),a.jsxs("select",{value:u,onChange:H=>P(H.target.value),className:"w-full p-2 border rounded-md bg-gray-50",children:[a.jsx("option",{value:"",children:"-- Opcional --"}),i.map(H=>a.jsx("option",{value:H.email,children:H.fullName||H.email},H.id))]}),u&&a.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[" Servicio asignado a: ",(($=i.find(H=>H.email===u))==null?void 0:$.fullName)||u]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"clientName",value:l.clientName||"",onChange:k,placeholder:"Nombre del Cliente",className:"w-full p-2 border rounded-md",required:!0}),a.jsx("input",{name:"clientEmail",type:"email",value:l.clientEmail||"",onChange:k,placeholder:"Email del Cliente",className:"w-full p-2 border rounded-md",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Servicio"}),a.jsxs("select",{name:"serviceType",value:l.serviceType||"Hosting",onChange:k,className:"w-full p-2 border rounded-md",children:[a.jsx("option",{children:"Hosting"}),a.jsx("option",{children:"Dominio"}),a.jsx("option",{children:"Dominio + Hosting"}),a.jsx("option",{children:"Otro"})]}),O&&a.jsxs("div",{className:"mt-2",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Especificar tipo de servicio personalizado"}),a.jsx("input",{type:"text",value:b,onChange:S,placeholder:"Ej: VPS, Cloud Storage, SSL, etc.",className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Escribe el tipo de servicio especfico que ofreces"})]})]}),a.jsx("input",{name:"description",value:l.description||"",onChange:k,placeholder:"Descripcin (ej: plan, dominio.com)",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx("input",{name:"amount",type:"number",step:"0.01",value:l.amount||"",onChange:k,placeholder:"Monto",className:"w-full p-2 border rounded-md",required:!0}),a.jsxs("select",{name:"currency",value:l.currency||"USD",onChange:k,className:"w-full p-2 border rounded-md",children:[a.jsx("option",{children:"USD"}),a.jsx("option",{children:"COP"})]}),a.jsx("input",{name:"dueDate",type:"date",value:l.dueDate||"",onChange:k,className:"w-full p-2 border rounded-md",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ciclo de Facturacin"}),a.jsx("select",{name:"billingCycle",value:l.billingCycle||"One-Time",onChange:k,className:"w-full p-2 border rounded-md",children:T().map(H=>a.jsx("option",{value:H.value,children:H.label},H.value))}),A&&a.jsxs("div",{className:"mt-2",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Especificar ciclo personalizado"}),a.jsx("input",{type:"text",value:m,onChange:N,placeholder:"Ej: 6 meses, 18 meses, 2 aos, etc.",className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Puedes escribir el perodo en meses o aos (ej: "6 meses", "2 aos")'})]})]}),a.jsx("select",{name:"status",value:l.status||"Activo",onChange:k,className:"w-full p-2 border rounded-md",children:ne.map(H=>a.jsx("option",{value:H,children:H},H))})]}),l.billingCycle&&l.billingCycle!=="One-Time"&&l.dueDate&&a.jsxs("div",{className:"bg-blue-50 p-4 rounded-md",children:[a.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Perodo del Servicio"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-blue-700 mb-1",children:"Fecha de Inicio"}),a.jsx("input",{type:"date",value:z(l.billingCycle,l.dueDate).startDate,readOnly:!0,className:"w-full p-2 border border-blue-200 rounded-md bg-blue-50 text-blue-800"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-blue-700 mb-1",children:"Fecha de Vencimiento"}),a.jsx("input",{type:"date",value:z(l.billingCycle,l.dueDate).endDate,readOnly:!0,className:"w-full p-2 border border-blue-200 rounded-md bg-blue-50 text-blue-800"})]})]})]}),l.billingCycle==="One-Time"&&a.jsxs("div",{className:"bg-yellow-50 p-4 rounded-md",children:[a.jsx("h4",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Pago nico"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"radio",id:"activation-only",name:"oneTimeType",value:"activation-only",className:"text-yellow-600"}),a.jsx("label",{htmlFor:"activation-only",className:"text-sm text-yellow-700",children:"Solo fecha de activacin (sin expiracin)"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"radio",id:"with-expiration",name:"oneTimeType",value:"with-expiration",className:"text-yellow-600"}),a.jsx("label",{htmlFor:"with-expiration",className:"text-sm text-yellow-700",children:"Con fecha de expiracin"})]}),a.jsxs("div",{className:"ml-6",children:[a.jsx("label",{className:"block text-xs font-medium text-yellow-700 mb-1",children:"Hasta qu fecha expira"}),a.jsx("input",{type:"date",name:"expirationDate",value:l.expirationDate||"",onChange:k,className:"w-full p-2 border border-yellow-200 rounded-md"})]})]})]}),a.jsx("textarea",{name:"clientNotes",value:l.clientNotes||"",onChange:k,placeholder:"Notas para el cliente (visible en su portal)",rows:"3",className:"w-full p-2 border rounded-md"}),a.jsx("textarea",{name:"adminNotes",value:l.adminNotes||"",onChange:k,placeholder:"Notas internas (solo para administrador)",rows:"3",className:"w-full p-2 border rounded-md"}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Guardar Servicio"})]})]})]})}):null}function r8({isOpen:t,onClose:e,onSend:n,service:r,templates:i,companySettings:s,isDemo:o}){const{addNotification:l}=xn(),[c,u]=ue.useState(""),[f,g]=ue.useState(""),[v,m]=ue.useState("");if(ue.useEffect(()=>{var A;i.length>0&&t&&u(((A=i[0])==null?void 0:A.id)||"")},[i,t]),ue.useEffect(()=>{var A;if(c&&r){const C=i.find(b=>b.id===c);if(C){const b=r.dueDate?new Date(r.dueDate.seconds*1e3).toLocaleDateString():"N/A",I={"{clientName}":r.clientName||"","{serviceType}":r.serviceType||"","{description}":r.description||"","{amount}":`$${(A=r.amount)==null?void 0:A.toFixed(2)} ${r.currency}`||"","{dueDate}":b,"{companyName}":s.companyName||"Tu Empresa"};let O=C.subject,V=C.body;for(const ne in I){const le=new RegExp(ne.replace(/[-\\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g");O=O.replace(le,I[ne]),V=V.replace(le,I[ne])}g(O),m(V)}}},[c,r,i,s]),!t)return null;const E=()=>{var A;n({to:r.clientEmail,subject:f,body:v,reason:`Notificacin Manual: ${((A=i.find(C=>C.id===c))==null?void 0:A.name)||"Mensaje Personalizado"}`}),e()};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full",children:[a.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Enviar Notificacin a ",r.clientName]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Seleccionar Plantilla"}),a.jsx("select",{value:c,onChange:A=>u(A.target.value),className:"mt-1 w-full p-2 border rounded-md",children:i.map(A=>a.jsx("option",{value:A.id,children:A.name},A.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Asunto"}),a.jsx("input",{type:"text",value:f,onChange:A=>g(A.target.value),className:"mt-1 w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cuerpo del Mensaje (Editable)"}),a.jsx("textarea",{value:v,onChange:A=>m(A.target.value),rows:"10",className:"mt-1 w-full p-2 border rounded-md font-mono text-sm"})]})]}),a.jsxs("div",{className:"flex justify-end gap-4 mt-8",children:[a.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),a.jsx("button",{onClick:E,className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Enviar"})]})]})})}function i8({isDemo:t,userRole:e}){const{addNotification:n}=xn(),[r,i]=ue.useState([]),[s,o]=ue.useState([]),[l,c]=ue.useState(!1),[u,f]=ue.useState(null),[g,v]=ue.useState("Todos"),[m,E]=ue.useState(""),[A,C]=ue.useState(!1),[b,I]=ue.useState([]),[O,V]=ue.useState({}),ne=["Activo","Periodo de Gracia Vencido","Pendiente Pago","Pago","Cancelado"];ue.useEffect(()=>{if(t){const te=dt.fromDate(new Date);i([{id:"s1",clientName:"Juan Perez (Demo)",clientEmail:"juan@demo.com",serviceType:"Hosting",description:"Plan Pro",amount:25,currency:"USD",dueDate:te,billingCycle:"Monthly",status:"Pendiente Pago",clientNotes:"A la espera del pago.",adminNotes:"Contactado por telfono."},{id:"s2",clientName:"Maria Garcia (Demo)",clientEmail:"maria@demo.com",serviceType:"Dominio",description:"nuevositio.co",amount:5e4,currency:"COP",dueDate:te,billingCycle:"Annually",status:"Pago",clientNotes:"",adminNotes:""},{id:"s3",clientName:"Carlos Lopez (Demo)",clientEmail:"carlos@demo.com",serviceType:"Mantenimiento",description:"Sitio Web",amount:150,currency:"USD",dueDate:te,billingCycle:"Monthly",status:"Activo",clientNotes:"Servicio funcionando correctamente.",adminNotes:"Cliente satisfecho."},{id:"s4",clientName:"Ana Rodriguez (Demo)",clientEmail:"ana@demo.com",serviceType:"Hosting",description:"Plan Bsico",amount:15,currency:"USD",dueDate:te,billingCycle:"Monthly",status:"Periodo de Gracia Vencido",clientNotes:"Necesita renovar pronto.",adminNotes:"Enviar recordatorio urgente."},{id:"s5",clientName:"Pedro Martinez (Demo)",clientEmail:"pedro@demo.com",serviceType:"Dominio",description:"tiendaonline.com",amount:12e4,currency:"COP",dueDate:te,billingCycle:"Annually",status:"Cancelado",clientNotes:"Cliente cancel el servicio.",adminNotes:"Cancelacin por solicitud del cliente."}]),o([{id:"c1",email:"juan@demo.com",fullName:"Juan Perez (Demo)"},{id:"c2",email:"maria@demo.com",fullName:"Maria Garcia (Demo)"}]),I([{id:"t1",name:"Recordatorio General (Demo)",subject:"Recordatorio de pago",body:"Hola {clientName}, recuerda pagar..."}]),V({companyName:"Tu Empresa (Demo)"});return}const Y=zt(Ue,"artifacts",Me,"public","data","services"),M=lr(Y,Fh("dueDate","desc")),U=Zt(M,te=>{i(te.docs.map(oe=>({id:oe.id,...oe.data()})))}),ee=zt(Ue,"artifacts",Me,"public","data","users"),fe=lr(ee,ni("role","==","client")),Q=Zt(fe,te=>{o(te.docs.map(oe=>({id:oe.id,...oe.data()})))}),w=zt(Ue,"artifacts",Me,"public","data","messageTemplates"),F=Zt(w,te=>{I(te.docs.map(oe=>({id:oe.id,...oe.data()})))}),D=ct(Ue,"artifacts",Me,"public","data","settings","company"),K=Zt(D,te=>{te.exists()&&V(te.data())});return()=>{U(),Q(),F(),K()}},[t]);const le=async Y=>{if(t){n("Funcin no disponible en modo demo.","error");return}const M=zt(Ue,"artifacts",Me,"public","data","services");try{if(Y.id){const{id:U,...ee}=Y;await fr(ct(M,U),ee)}else await xa(M,{...Y,createdAt:dt.now()})}catch(U){throw U}},z=async Y=>{if(t){n("Funcin no disponible en modo demo.","error");return}if(window.confirm("Seguro que quieres eliminar este servicio?"))try{await fc(ct(Ue,"artifacts",Me,"public","data","services",Y)),n("Servicio eliminado.","success")}catch{n("Error al eliminar el servicio.","error")}},T=async Y=>{if(t){n(`Simulacin: Enviando correo a ${Y.to}.`,"success");return}try{await xa(zt(Ue,"artifacts",Me,"public","data","messageHistory"),{...Y,sentAt:dt.now()}),n("Notificacin registrada en el historial.","success")}catch{n("Error al registrar la notificacin.","error")}},k=async(Y,M)=>{if(t){n("Funcin no disponible en modo demo.","error");return}try{await fr(ct(Ue,"artifacts",Me,"public","data","services",Y),{status:M}),n("Estado actualizado.","success")}catch{n("Error al actualizar estado.","error")}},N=Y=>Y.status==="Pendiente Pago"&&Y.dueDate&&Y.dueDate.toDate()<new Date?"Periodo de Gracia Vencido":Y.status,S=(Y,M)=>{if(!M)return"text-gray-500";const U=new Date,fe=(M.toDate()-U)/(1e3*60*60*24);return Y==="Pago"?"text-green-600":Y==="Cancelado"?"text-gray-500":Y==="Periodo de Gracia Vencido"||fe<0?"text-red-600 font-bold":Y==="Pendiente Pago"&&fe<7?"text-yellow-600 font-semibold":Y==="Activo"?"text-blue-600":"text-gray-700"},P=Y=>{if(!Y.dueDate||!Y.billingCycle||Y.billingCycle==="One-Time")return Y.expirationDate?Y.expirationDate.toDate().toLocaleDateString():"N/A";const M=Y.dueDate.toDate();let U=new Date(M);switch(Y.billingCycle){case"Monthly":U.setMonth(U.getMonth()+1);break;case"Semiannually":U.setMonth(U.getMonth()+6);break;case"Annually":U.setFullYear(U.getFullYear()+1);break;case"Biennially":U.setFullYear(U.getFullYear()+2);break;case"Triennially":U.setFullYear(U.getFullYear()+3);break;default:return"N/A"}return U.toLocaleDateString()},R=Y=>({"One-Time":"Pago nico",Monthly:"Mensual",Semiannually:"Semestral",Annually:"Anual",Biennially:"Bianual",Triennially:"Trienal",Custom:"Personalizado"})[Y]||Y,$=Y=>{f(Y),C(!0)},H=r.filter(Y=>g==="Todos"||N(Y)===g).filter(Y=>{var ee,fe,Q,w,F,D,K,te,oe,he;if(!m)return!0;const M=m.toLowerCase(),U=N(Y);return((ee=Y.clientName)==null?void 0:ee.toLowerCase().includes(M))||((fe=Y.clientEmail)==null?void 0:fe.toLowerCase().includes(M))||((Q=Y.serviceType)==null?void 0:Q.toLowerCase().includes(M))||((w=Y.description)==null?void 0:w.toLowerCase().includes(M))||((F=Y.amount)==null?void 0:F.toString().includes(M))||((D=Y.currency)==null?void 0:D.toLowerCase().includes(M))||((K=Y.billingCycle)==null?void 0:K.toLowerCase().includes(M))||(U==null?void 0:U.toLowerCase().includes(M))||((te=Y.clientNotes)==null?void 0:te.toLowerCase().includes(M))||((oe=Y.adminNotes)==null?void 0:oe.toLowerCase().includes(M))||Y.dueDate&&new Date(Y.dueDate.seconds*1e3).toLocaleDateString().includes(M)||Y.dueDate&&((he=Y.dueDate.seconds)==null?void 0:he.toString().includes(M))});return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[["Todos",...ne].map(Y=>a.jsx("button",{onClick:()=>v(Y),className:`px-4 py-2 rounded-full text-sm font-semibold transition-colors ${g===Y?"bg-blue-600 text-white shadow-lg":"bg-white hover:bg-gray-100"}`,children:Y},Y)),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar en toda la tabla...",value:m,onChange:Y=>E(Y.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full sm:w-64"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Fu,{})})]})]}),a.jsxs("button",{onClick:()=>{f(null),c(!0)},className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700",children:[a.jsx(Vh,{})," ",a.jsx("span",{className:"hidden sm:inline",children:"Nuevo Servicio"})]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Nmero","Cliente","Servicio","Monto","Ciclo","Fecha de Inicio","Fecha de Vencimiento","Notas","Estado","Acciones"].map(Y=>a.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:Y},Y))})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:H.map(Y=>{var U;const M=N(Y);return a.jsxs("tr",{children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:Y.serviceNumber||"N/A"})}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-medium",children:Y.clientName}),a.jsx("div",{className:"text-sm text-gray-500",children:Y.clientEmail})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-semibold",children:Y.serviceType}),a.jsx("div",{className:"text-sm text-gray-600",children:Y.description})]}),a.jsxs("td",{className:"px-6 py-4 font-semibold",children:[(U=Y.amount)==null?void 0:U.toFixed(2)," ",Y.currency]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:R(Y.billingCycle)}),Y.billingCycle==="Custom"&&Y.customBillingCycle&&a.jsxs("div",{className:"text-xs text-gray-500",children:["(",Y.customBillingCycle,")"]})]}),a.jsxs("td",{className:`px-6 py-4 ${S(M,Y.dueDate)}`,children:[a.jsx("div",{className:"text-sm",children:Y.dueDate?Y.dueDate.toDate().toLocaleDateString():"N/A"}),a.jsx("div",{className:"text-xs text-gray-500",children:"Inicio"})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:P(Y)}),a.jsx("div",{className:"text-xs text-gray-500",children:"Vencimiento"})]}),a.jsxs("td",{className:"px-6 py-4 text-xs max-w-xs",children:[Y.clientNotes&&a.jsxs("div",{className:"truncate",title:Y.clientNotes,children:[a.jsx("strong",{children:"Cliente:"})," ",Y.clientNotes]}),Y.adminNotes&&a.jsxs("div",{className:"truncate text-purple-600 mt-1",title:Y.adminNotes,children:[a.jsx("strong",{children:"Admin:"})," ",Y.adminNotes]})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("select",{value:Y.status,onChange:ee=>k(Y.id,ee.target.value),className:"p-1 text-xs rounded-md border-gray-300 bg-white shadow-sm w-full",children:ne.map(ee=>a.jsx("option",{value:ee,children:ee},ee))})}),a.jsx("td",{className:"px-6 py-4 text-center",children:a.jsxs(Uh,{children:[a.jsx("button",{onClick:()=>{f(Y),c(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Editar"}),a.jsx("button",{onClick:()=>$(Y),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Enviar Notificacin"}),a.jsx("button",{onClick:()=>z(Y.id),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"Eliminar"})]})})]},Y.id)})})]})}),a.jsx(n8,{isOpen:l,onClose:()=>c(!1),onSave:le,service:u,clients:s,isDemo:t}),a.jsx(r8,{isOpen:A,onClose:()=>C(!1),onSend:T,service:u,templates:b,companySettings:O,isDemo:t})]})}function s8({isOpen:t,onClose:e,onSave:n,user:r,isDemo:i}){const{addNotification:s}=xn(),[o,l]=ue.useState({});ue.useEffect(()=>{r&&l(r)},[r]);const c=f=>{const{name:g,value:v}=f.target;l(m=>({...m,[g]:v}))},u=async f=>{f.preventDefault();try{await n(o),s("Usuario actualizado.","success"),e()}catch{s("Error al actualizar usuario.","error")}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-lg w-full",children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Editar Usuario"}),a.jsxs("form",{onSubmit:u,className:"space-y-4",children:[a.jsx("input",{name:"fullName",value:o.fullName||"",onChange:c,placeholder:"Nombre Completo",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"identification",value:o.identification||"",onChange:c,placeholder:"Identificacin",className:"w-full p-2 border rounded-md"}),a.jsx("input",{type:"email",value:o.email||"",readOnly:!0,disabled:!0,className:"w-full p-2 border rounded-md bg-gray-100"}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Guardar Cambios"})]})]})]})}):null}function a8({isOpen:t,onClose:e,onSave:n,isDemo:r}){const{addNotification:i}=xn(),[s,o]=ue.useState(""),[l,c]=ue.useState(""),[u,f]=ue.useState(""),[g,v]=ue.useState(""),[m,E]=ue.useState("client"),[A,C]=ue.useState("active"),[b,I]=ue.useState(!1),[O,V]=ue.useState(""),ne=[{value:"client",label:"Cliente"},{value:"admin",label:"Administrador"},{value:"superadmin",label:"Super Administrador"}],le=[{value:"active",label:"Activo"},{value:"inactive",label:"Inactivo"},{value:"pending",label:"Pendiente"}],z=()=>{o(""),c(""),f(""),v(""),E("client"),C("active"),I(!1),V("")},T=()=>{z(),e()},k=async N=>{if(N.preventDefault(),l.length<6){V("La contrasea debe tener al menos 6 caracteres.");return}V("");try{await n({email:s,password:l,notify:b,fullName:u,identification:g,role:m,status:A}),e()}catch{i("Error al crear usuario.","error")}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-md w-full",children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Crear Nuevo Usuario"}),a.jsxs("form",{onSubmit:k,className:"space-y-4",children:[a.jsx("input",{type:"email",value:s,onChange:N=>o(N.target.value),placeholder:"Email del nuevo usuario",className:"w-full p-2 border rounded-md",required:!0}),a.jsx("input",{type:"password",value:l,onChange:N=>c(N.target.value),placeholder:"Contrasea temporal",className:"w-full p-2 border rounded-md",required:!0}),a.jsx("input",{value:u,onChange:N=>f(N.target.value),placeholder:"Nombre Completo",className:"w-full p-2 border rounded-md"}),a.jsx("input",{value:g,onChange:N=>v(N.target.value),placeholder:"Identificacin",className:"w-full p-2 border rounded-md"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),a.jsx("select",{value:m,onChange:N=>E(N.target.value),className:"w-full p-2 border rounded-md",required:!0,children:ne.map(N=>a.jsx("option",{value:N.value,children:N.label},N.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),a.jsx("select",{value:A,onChange:N=>C(N.target.value),className:"w-full p-2 border rounded-md",required:!0,children:le.map(N=>a.jsx("option",{value:N.value,children:N.label},N.value))})]})]}),O&&a.jsx("p",{className:"text-red-500 text-sm",children:O}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{id:"notify",type:"checkbox",checked:b,onChange:N=>I(N.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),a.jsx("label",{htmlFor:"notify",className:"ml-2 block text-sm text-gray-900",children:"Notificar al usuario por correo"})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[a.jsx("button",{type:"button",onClick:T,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Crear Usuario"})]})]})]})}):null}function o8({isOpen:t,onClose:e,user:n,onActivate:r}){const{addNotification:i}=xn(),[s,o]=ue.useState(""),[l,c]=ue.useState(!1),u=`Hola ${(n==null?void 0:n.fullName)||(n==null?void 0:n.email)},

Tu cuenta ha sido activada exitosamente en nuestro sistema de gestin de cobros.

Ahora puedes:
 Ver tus servicios contratados
 Crear tickets de soporte
 Gestionar tu perfil

Para acceder, simplemente inicia sesin con tu email y contrasea.

Bienvenido!

Equipo de Soporte`,f=async()=>{c(!0);try{await r(),await xa(zt(Ue,"artifacts",Me,"public","data","messageHistory"),{to:n.email,subject:"Cuenta Activada - Sistema de Gestin de Cobros",body:s||u,reason:"Activacin de Usuario",sentAt:dt.now(),type:"activation"}),i(`Usuario ${n.email} activado y notificado exitosamente`,"success"),e()}catch(g){i("Error al activar usuario","error"),console.error("Error activating user:",g)}finally{c(!1)}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Activar Usuario"}),a.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"Usuario a Activar:"}),a.jsxs("p",{className:"text-blue-700",children:[a.jsx("strong",{children:"Email:"})," ",n==null?void 0:n.email,a.jsx("br",{}),a.jsx("strong",{children:"Nombre:"})," ",(n==null?void 0:n.fullName)||"Sin especificar",a.jsx("br",{}),a.jsx("strong",{children:"Rol:"})," ",(n==null?void 0:n.role)||"Cliente"]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje de Notificacin (Opcional)"}),a.jsx("textarea",{value:s,onChange:g=>o(g.target.value),rows:"8",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",placeholder:u}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Si no escribes un mensaje personalizado, se enviar el mensaje por defecto."})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:[a.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"Qu suceder?"}),a.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[a.jsx("li",{children:" El usuario ser activado inmediatamente"}),a.jsx("li",{children:" Se enviar una notificacin por email"}),a.jsx("li",{children:" El usuario podr iniciar sesin"}),a.jsx("li",{children:" Si es cliente, deber completar su perfil"})]})]}),a.jsxs("div",{className:"flex justify-end space-x-4",children:[a.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),a.jsx("button",{onClick:f,disabled:l,className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 flex items-center gap-2",children:l?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Activando..."]}):"Activar y Notificar"})]})]})}):null}function l8({isDemo:t,userRole:e}){const{addNotification:n}=xn(),[r,i]=ue.useState([]),[s,o]=ue.useState(""),[l,c]=ue.useState(!1),[u,f]=ue.useState(!1),[g,v]=ue.useState(!1),[m,E]=ue.useState(null),[A,C]=ue.useState(null);ue.useEffect(()=>{if(t){i([{id:"u1",email:"superadmin@demo.com",role:"superadmin",status:"active",fullName:"Super Admin",identification:"123"},{id:"u2",email:"admin@demo.com",role:"admin",status:"active",fullName:"Admin User",identification:"456"},{id:"u3",email:"cliente1@demo.com",role:"client",status:"pending",fullName:"Cliente Pendiente",identification:"789"},{id:"u4",email:"cliente2@demo.com",role:"client",status:"disabled",fullName:"Cliente Deshabilitado",identification:"101"}]);return}const N=zt(Ue,"artifacts",Me,"public","data","users");return Zt(lr(N,Fh("email")),P=>{i(P.docs.map(R=>({id:R.id,...R.data()})))})},[t]);const b=async N=>{if(t){n("Funcin no disponible en modo demo.","error");return}const{id:S,...P}=N,R=ct(Ue,"artifacts",Me,"public","data","users",S);await fr(R,P)},I=async N=>{if(t){n(`Simulacin: Creando usuario ${N.email} con rol ${N.role}.`,"success");return}try{const S=lr(zt(Ue,"artifacts",Me,"public","data","users"),ni("email","==",N.email));if(!(await ya(S)).empty){n("El email ya est registrado en el sistema","error");return}const $=(await Cp(xr,N.email,N.password)).user,H={email:N.email,fullName:N.fullName||"",identification:N.identification||"",role:N.role||"client",status:N.status||"active",isProfileComplete:!0,createdAt:dt.now(),requiresPasswordChange:!0},Y=ct(Ue,"artifacts",Me,"public","data","users",$.uid);if(await ki(Y,H),N.notify)try{await x4($),n(`Usuario ${N.email} creado exitosamente. Email de verificacin enviado.`,"success")}catch{n(`Usuario ${N.email} creado exitosamente, pero no se pudo enviar el email de verificacin.`,"warning")}else n(`Usuario ${N.email} creado exitosamente.`,"success")}catch(S){console.error("Error creating user:",S);let P="Error al crear usuario";throw S.code==="auth/email-already-in-use"?P="El email ya est registrado en el sistema":S.code==="auth/invalid-email"?P="El email no es vlido":S.code==="auth/weak-password"?P="La contrasea es muy dbil":P=`Error al crear usuario: ${S.message}`,n(P,"error"),S}},O=async()=>{if(A)try{const N=ct(Ue,"artifacts",Me,"public","data","users",A.id);await fr(N,{status:"active"}),n(`Usuario ${A.email} activado exitosamente.`,"success")}catch(N){n("Error al activar usuario","error"),console.error("Error activating user:",N)}},V=async(N,S)=>{if(t||e!=="superadmin"){n("Accin no permitida.","error");return}const P=ct(Ue,"artifacts",Me,"public","data","users",N.id);try{switch(S){case"activate":C(N),v(!0);break;case"notify":const R=`${window.location.origin}?uid=${N.id}&email=${encodeURIComponent(N.email)}&name=${encodeURIComponent(N.fullName||"")}&id=${encodeURIComponent(N.identification||"")}`;console.log("Link de activacin:",R),n(`Link de activacin generado para ${N.email}. Copia el link desde la consola.`,"success"),navigator.clipboard.writeText(R),n("Link copiado al portapapeles","info");break;case"disable":window.confirm(`Deshabilitar a ${N.email}?`)&&(await fr(P,{status:"disabled"}),n(`Usuario ${N.email} deshabilitado.`,"success"));break;case"makeAdmin":window.confirm(`Convertir a ${N.email} en administrador?`)&&(await fr(P,{role:"admin"}),n(`${N.email} ahora es administrador.`,"success"));break;case"makeClient":window.confirm(`Convertir a ${N.email} en cliente?`)&&(await fr(P,{role:"client"}),n(`${N.email} ahora es cliente.`,"success"));break;case"delete":if(window.confirm(`Eliminar permanentemente a ${N.email}? Esta accin no se puede deshacer.`))try{await fc(P),n(`Usuario ${N.email} eliminado de la base de datos.`,"success"),n("Nota: El usuario permanece en Authentication. Contacta al administrador para eliminacin completa.","info")}catch($){console.error("Error deleting user:",$),n("Error al eliminar el usuario: "+$.message,"error")}break;default:n("Accin no reconocida.","error")}}catch(R){n("Ocurri un error al realizar la accin.","error"),console.error("Error in user action:",R)}},ne=r.filter(N=>{const S=s.toLowerCase();return!S||N.email.toLowerCase().includes(S)||N.fullName&&N.fullName.toLowerCase().includes(S)||N.identification&&N.identification.includes(S)}),le=N=>({active:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",disabled:"bg-red-100 text-red-800"})[N]||"bg-gray-100 text-gray-800",z=N=>({superadmin:"bg-red-100 text-red-800 font-bold",admin:"bg-blue-100 text-blue-800 font-semibold",client:"bg-gray-100 text-gray-800"})[N]||"bg-gray-100 text-gray-800",T=N=>({active:"Activo",pending:"Pendiente",disabled:"Deshabilitado"})[N]||N,k=N=>({superadmin:"Super Admin",admin:"Administrador",client:"Cliente"})[N]||N;return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar por email, nombre, ID...",value:s,onChange:N=>o(N.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full sm:w-64"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Fu,{})})]}),e==="superadmin"&&a.jsxs("button",{onClick:()=>c(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700",children:[a.jsx(Vh,{})," ",a.jsx("span",{className:"hidden sm:inline",children:"Crear Usuario"})]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Nombre","Email","Identificacin","Rol","Estado","Fecha Creacin","Acciones"].map(N=>a.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:N},N))})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:ne.map(N=>a.jsxs("tr",{children:[a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-medium text-gray-900",children:N.fullName||"Sin nombre"}),N.fullName&&a.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",N.id.slice(0,8),"..."]})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm text-gray-900",children:N.email}),N.requiresPasswordChange&&a.jsx("div",{className:"text-xs text-orange-600",children:"Requiere cambio de contrasea"})]}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:N.identification||"--"}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${z(N.role)}`,children:k(N.role)})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${le(N.status)}`,children:T(N.status)})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:N.createdAt?new Date(N.createdAt.seconds*1e3).toLocaleDateString():"--"}),a.jsx("td",{className:"px-6 py-4",children:e==="superadmin"&&N.role!=="superadmin"&&a.jsxs(Uh,{children:[a.jsx("button",{onClick:()=>{E(N),f(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:" Editar Datos"}),a.jsx("button",{onClick:()=>V(N,"notify"),className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:" Notificar Activacin"}),N.status==="pending"&&a.jsx("button",{onClick:()=>V(N,"activate"),className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:" Activar Usuario"}),N.status==="active"&&a.jsx("button",{onClick:()=>V(N,"disable"),className:"block w-full text-left px-4 py-2 text-sm text-yellow-700 hover:bg-yellow-50",children:" Deshabilitar"}),N.status==="disabled"&&a.jsx("button",{onClick:()=>V(N,"activate"),className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:" Re-Activar"}),N.role==="client"?a.jsx("button",{onClick:()=>V(N,"makeAdmin"),className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:" Hacer Administrador"}):a.jsx("button",{onClick:()=>V(N,"makeClient"),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:" Hacer Cliente"}),a.jsx("button",{onClick:()=>V(N,"delete"),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:" Eliminar Permanentemente"})]})})]},N.id))})]})}),a.jsx(a8,{isOpen:l,onClose:()=>c(!1),onSave:I,isDemo:t}),a.jsx(s8,{isOpen:u,onClose:()=>f(!1),onSave:b,user:m,isDemo:t}),a.jsx(o8,{isOpen:g,onClose:()=>{v(!1),C(null)},onActivate:O,user:A})]})}function c8({isDemo:t}){const{addNotification:e}=xn(),[n,r]=ue.useState([]),[i,s]=ue.useState(null),[o,l]=ue.useState(""),[c,u]=ue.useState(""),[f,g]=ue.useState(""),[v,m]=ue.useState(!1),[E,A]=ue.useState([]),[C,b]=ue.useState({preVencimiento:{enabled:!1,days:7,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]},periodoGracia:{enabled:!1,days:3,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]},vencido:{enabled:!1,days:0,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]},suspendido:{enabled:!1,days:0,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]}}),[I,O]=ue.useState("templates"),V={preVencimiento:{name:"Aviso de Prximo Vencimiento",subject:"Recordatorio de Renovacin de Servicio: {description}",body:`Estimado/a {clientName},

Le escribimos para recordarle que su servicio '{description}' est programado para vencer el prximo {dueDate}.

El monto correspondiente a la renovacin es de {amount} {currency}.

Para garantizar la continuidad de su servicio, le recomendamos realizar el pago antes de la fecha de vencimiento. Puede gestionarlo a travs de nuestro portal de clientes.

Si tiene alguna consulta, no dude en contactarnos.

Atentamente,
{companyName}`},vencido:{name:"Notificacin de Servicio Vencido",subject:"Importante: Su servicio {description} ha vencido",body:`Estimado/a {clientName},

Le informamos que la factura correspondiente a su servicio '{description}', con fecha de vencimiento {dueDate}, se encuentra pendiente de pago.

Su servicio ha entrado en un perodo de gracia. Para evitar la suspensin del mismo, le solicitamos regularizar su situacin a la brevedad posible. El monto pendiente es de {amount} {currency}.

Si usted ya ha realizado el pago, por favor, omita esta notificacin.

Cordialmente,
{companyName}`},suspendido:{name:"Aviso de Suspensin de Servicio",subject:"Accin Requerida: Suspensin del servicio {description}",body:`Estimado/a {clientName},

Lamentamos informarle que, debido a la falta de pago, su servicio '{description}' ha sido suspendido.

Para proceder con la reactivacin y recuperar el acceso, es necesario saldar el monto pendiente de {amount} {currency}. Por favor, contctenos para coordinar el pago y la restauracin del servicio.

Quedamos a su disposicin.

Atentamente,
{companyName}`},pagoRecibido:{name:"Confirmacin de Pago Recibido",subject:"Confirmacin: Pago recibido para {description}",body:`Estimado/a {clientName},

Hemos recibido y procesado exitosamente su pago por {amount} {currency} correspondiente al servicio '{description}'.

Su servicio est activo y funcionando correctamente. La prxima fecha de vencimiento ser {dueDate}.

Gracias por su confianza y por mantener sus pagos al da.

Atentamente,
{companyName}`},bienvenida:{name:"Bienvenida a Nuevo Cliente",subject:"Bienvenido a {companyName} - Servicio {description}",body:`Estimado/a {clientName},

Bienvenido a {companyName}!

Nos complace confirmar que su servicio '{description}' ha sido activado exitosamente.

Detalles del servicio:
- Descripcin: {description}
- Monto: {amount} {currency}
- Prximo vencimiento: {dueDate}

Puede acceder a su portal de cliente en cualquier momento para gestionar su cuenta y realizar pagos.

Si tiene alguna pregunta, no dude en contactarnos.

Gracias por elegirnos!

Atentamente,
{companyName}`},adminPreVencimiento:{name:"Alerta Admin: Prximo Vencimiento",subject:"ALERTA: Servicio prximo a vencer - {clientName}",body:`Estimado/a Administrador,

Se ha generado una alerta automtica para el siguiente servicio:

 INFORMACIN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto: {amount} {currency}
- Fecha de vencimiento: {dueDate}
- Ciclo de facturacin: {billingCycle}
- Das restantes: {daysRemaining}

 ESTADO ACTUAL:
- Estado: Prximo a vencer
- Notificacin enviada al cliente: 
- Plantilla utilizada: Aviso de Prximo Vencimiento

 ACCIONES RECOMENDADAS:
1. Verificar que el cliente haya recibido la notificacin
2. Contactar al cliente si es necesario
3. Preparar seguimiento post-vencimiento

 ESTADSTICAS:
- Total de servicios prximos a vencer: {totalPending}
- Ingresos potenciales: {potentialRevenue}

Este es un mensaje automtico del sistema de gestin de cobros.

Sistema de Gestin - {companyName}`},adminPeriodoGracia:{name:"Alerta Admin: Perodo de Gracia",subject:"URGENTE: Servicio en perodo de gracia - {clientName}",body:`Estimado/a Administrador,

 ALERTA URGENTE - Servicio en perodo de gracia:

 INFORMACIN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto pendiente: {amount} {currency}
- Fecha de vencimiento original: {dueDate}
- Das en perodo de gracia: {graceDays}
- Das restantes de gracia: {remainingGraceDays}

 ESTADO ACTUAL:
- Estado: Perodo de Gracia Vencido
- Notificacin enviada al cliente: 
- Plantilla utilizada: Notificacin de Servicio Vencido
- Riesgo de suspensin: ALTO

 ACCIONES INMEDIATAS:
1. Contactar al cliente por telfono
2. Enviar recordatorio personalizado
3. Evaluar opciones de pago flexibles
4. Preparar suspensin si no hay respuesta

 IMPACTO:
- Ingresos en riesgo: {amount} {currency}
- Tiempo de mora: {daysOverdue} das
- Historial de pagos: {paymentHistory}

 PRXIMOS PASOS:
- Si no se paga en {remainingGraceDays} das: Suspender servicio
- Seguimiento diario hasta resolucin
- Documentar todas las comunicaciones

Este es un mensaje automtico del sistema de gestin de cobros.

Sistema de Gestin - {companyName}`},adminVencido:{name:"Alerta Admin: Servicio Vencido",subject:"INMEDIATO: Servicio vencido - {clientName}",body:`Estimado/a Administrador,

 ALERTA INMEDIATA - Servicio vencido:

 INFORMACIN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto vencido: {amount} {currency}
- Fecha de vencimiento: {dueDate}
- Das de atraso: {daysOverdue}
- Ciclo de facturacin: {billingCycle}

 ESTADO ACTUAL:
- Estado: Vencido
- Notificacin enviada al cliente: 
- Plantilla utilizada: Notificacin de Servicio Vencido
- Prximo paso: Perodo de gracia

 ACCIONES REQUERIDAS:
1. Verificar recepcin de notificacin por cliente
2. Iniciar perodo de gracia ({gracePeriod} das)
3. Contacto directo con el cliente
4. Evaluar historial de pagos del cliente
5. Preparar estrategia de cobro

 ANLISIS:
- Cliente desde: {clientSince}
- Pagos anteriores: {previousPayments}
- Patrn de pago: {paymentPattern}
- Riesgo de prdida: {riskLevel}

 CONTACTOS:
- Telfono: {clientPhone}
- Email: {clientEmail}
- ltima comunicacin: {lastContact}

Este es un mensaje automtico del sistema de gestin de cobros.

Sistema de Gestin - {companyName}`},adminSuspendido:{name:"Alerta Admin: Servicio Suspendido",subject:"SUSPENDIDO: Servicio cancelado por falta de pago - {clientName}",body:`Estimado/a Administrador,

 SERVICIO SUSPENDIDO - Accin requerida:

 INFORMACIN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto pendiente: {amount} {currency}
- Fecha de vencimiento: {dueDate}
- Das de atraso: {daysOverdue}
- Perodo de gracia agotado: {gracePeriod} das

 ESTADO ACTUAL:
- Estado: Cancelado
- Motivo: Falta de pago
- Notificacin enviada al cliente: 
- Plantilla utilizada: Aviso de Suspensin de Servicio
- Fecha de suspensin: {suspensionDate}

 ACCIONES INMEDIATAS:
1. Suspender acceso del cliente al servicio
2. Documentar suspensin en el sistema
3. Enviar notificacin de suspensin
4. Iniciar proceso de recuperacin de cobros
5. Evaluar reactivacin futura

 ANLISIS FINANCIERO:
- Prdida de ingresos: {amount} {currency}
- Costo de reactivacin: {reactivationCost}
- Valor del cliente: {clientValue}
- Probabilidad de recuperacin: {recoveryProbability}%

 SEGUIMIENTO:
- Contactar para negociacin de pago
- Ofrecer planes de pago flexibles
- Documentar todas las comunicaciones
- Evaluar cancelacin definitiva

 DOCUMENTACIN:
- Historial de pagos: {paymentHistory}
- Comunicaciones previas: {communicationHistory}
- Trminos del servicio: {serviceTerms}
- Poltica de suspensin: {suspensionPolicy}

Este es un mensaje automtico del sistema de gestin de cobros.

Sistema de Gestin - {companyName}`},adminPagoRecibido:{name:"Notificacin Admin: Pago Recibido",subject:"CONFIRMADO: Pago recibido - {clientName}",body:`Estimado/a Administrador,

 PAGO CONFIRMADO - Servicio reactivado:

 INFORMACIN DEL PAGO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Monto recibido: {amount} {currency}
- Fecha de pago: {paymentDate}
- Mtodo de pago: {paymentMethod}
- Referencia: {paymentReference}

 ESTADO ACTUAL:
- Estado: Activo
- Servicio reactivado: 
- Notificacin enviada al cliente: 
- Plantilla utilizada: Confirmacin de Pago Recibido
- Prximo vencimiento: {nextDueDate}

 ACCIONES COMPLETADAS:
1. Pago procesado y verificado
2. Servicio reactivado automticamente
3. Cliente notificado del pago
4. Prxima fecha de vencimiento actualizada
5. Historial de pagos actualizado

 IMPACTO POSITIVO:
- Ingresos recuperados: {amount} {currency}
- Cliente retenido: 
- Servicio activo: 
- Prximo ciclo iniciado

 ESTADSTICAS:
- Tiempo de pago: {paymentTime} das
- Eficiencia de cobro: {collectionEfficiency}%
- Satisfaccin del cliente: {clientSatisfaction}
- Ingresos mensuales: {monthlyRevenue}

 SEGUIMIENTO:
- Monitorear estabilidad del servicio
- Preparar prximo recordatorio
- Actualizar perfil del cliente
- Documentar xito de cobro

Este es un mensaje automtico del sistema de gestin de cobros.

Sistema de Gestin - {companyName}`},adminNuevoCliente:{name:"Notificacin Admin: Nuevo Cliente",subject:"NUEVO CLIENTE: {clientName} - Servicio {description}",body:`Estimado/a Administrador,

 NUEVO CLIENTE REGISTRADO:

 INFORMACIN DEL CLIENTE:
- Nombre: {clientName}
- Email: {clientEmail}
- Identificacin: {clientId}
- Telfono: {clientPhone}
- Fecha de registro: {registrationDate}

 INFORMACIN DEL SERVICIO:
- Descripcin: {description}
- Tipo: {serviceType}
- Monto: {amount} {currency}
- Ciclo de facturacin: {billingCycle}
- Fecha de vencimiento: {dueDate}
- Estado: Activo

 CONFIGURACIN:
- Servicio activado: 
- Notificacin de bienvenida enviada: 
- Plantilla utilizada: Bienvenida a Nuevo Cliente
- Portal de cliente habilitado: 
- Mtodo de pago configurado: {paymentMethod}

 ACCIONES INICIALES:
1. Verificar activacin del servicio
2. Confirmar recepcin de bienvenida
3. Programar seguimiento inicial
4. Configurar recordatorios automticos
5. Documentar preferencias del cliente

 ANLISIS:
- Valor del cliente: {clientValue}
- Potencial de crecimiento: {growthPotential}
- Segmento: {clientSegment}
- Fuente de adquisicin: {acquisitionSource}

 PRXIMOS PASOS:
- Seguimiento en 7 das
- Verificar satisfaccin inicial
- Preparar prximo recordatorio
- Monitorear uso del servicio

Este es un mensaje automtico del sistema de gestin de cobros.

Sistema de Gestin - {companyName}`}},ne=H=>{s(null),m(!1),l(H.name),u(H.subject),g(H.body),e("Sugerencia cargada en el editor.","success")};ue.useEffect(()=>{if(t){A([{id:"admin1",email:"admin@demo.com",fullName:"Admin Demo",role:"admin"},{id:"super1",email:"super@demo.com",fullName:"Super Admin Demo",role:"superadmin"}]);return}const H=zt(Ue,"artifacts",Me,"public","data","users");return Zt(lr(H,ni("role","in",["admin","superadmin"])),M=>{A(M.docs.map(U=>({id:U.id,...U.data()})))})},[t]),ue.useEffect(()=>{if(t){b({preVencimiento:{enabled:!0,days:7,clientTemplate:"t1",adminTemplate:"t1",notifyAdmins:!0,selectedAdmins:["admin1"]},periodoGracia:{enabled:!0,days:3,clientTemplate:"t2",adminTemplate:"t2",notifyAdmins:!0,selectedAdmins:["admin1"]},vencido:{enabled:!0,days:0,clientTemplate:"t2",adminTemplate:"t2",notifyAdmins:!0,selectedAdmins:["admin1"]},suspendido:{enabled:!1,days:0,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]}});return}const H=ct(Ue,"artifacts",Me,"public","data","settings","alertSettings");return Zt(H,M=>{M.exists()&&b(M.data())})},[t]),ue.useEffect(()=>{if(t){r([{id:"t1",name:"Recordatorio General (Demo)",subject:"Recordatorio de pago",body:"Hola {clientName}, recuerda pagar tu servicio {description} por {amount} {currency} antes del {dueDate}. Gracias, {companyName}",createdAt:new Date},{id:"t2",name:"Servicio Vencido (Demo)",subject:"Servicio vencido: {description}",body:"Estimado {clientName}, su servicio {description} ha vencido. Por favor regularice su pago de {amount} {currency}. Atentamente, {companyName}",createdAt:new Date}]);return}const H=zt(Ue,"artifacts",Me,"public","data","messageTemplates");return Zt(lr(H,Fh("name")),M=>{r(M.docs.map(U=>({id:U.id,...U.data()})))})},[t]),ue.useEffect(()=>{i?(l(i.name),u(i.subject),g(i.body),m(!0)):(l(""),u(""),g(""),m(!1))},[i]);const le=async()=>{if(t){e("Funcin no disponible en modo demo.","error");return}if(!o.trim()||!c.trim()||!f.trim()){e("Por favor, complete todos los campos de la plantilla.","error");return}const H={name:o.trim(),subject:c.trim(),body:f.trim(),updatedAt:new Date},Y=zt(Ue,"artifacts",Me,"public","data","messageTemplates");try{i?(await fr(ct(Y,i.id),H),e("Plantilla actualizada exitosamente.","success")):(await xa(Y,{...H,createdAt:new Date}),e("Plantilla creada exitosamente.","success")),s(null)}catch(M){console.error("Error saving template:",M),e("Error al guardar la plantilla.","error")}},z=async H=>{if(t){e("Funcin no disponible en modo demo.","error");return}if(window.confirm("Seguro que quieres eliminar esta plantilla?"))try{await fc(ct(Ue,"artifacts",Me,"public","data","messageTemplates",H)),e("Plantilla eliminada.","success"),s(null)}catch(Y){console.error("Error deleting template:",Y),e("Error al eliminar la plantilla.","error")}},T=()=>{s(null),m(!1),l(""),u(""),g("")},k=H=>{s(H),m(!0)},N=(H,Y,M)=>{b(U=>({...U,[H]:{...U[H],[Y]:M}}))},S=(H,Y,M)=>{b(U=>({...U,[H]:{...U[H],selectedAdmins:M?[...U[H].selectedAdmins,Y]:U[H].selectedAdmins.filter(ee=>ee!==Y)}}))},P=async()=>{if(t){e("Configuracin de alertas guardada (modo demo).","success");return}try{const H=ct(Ue,"artifacts",Me,"public","data","settings","alertSettings");await ki(H,C,{merge:!0}),e("Configuracin de alertas guardada exitosamente.","success")}catch(H){console.error("Error saving alert settings:",H),e("Error al guardar la configuracin de alertas.","error")}},R=["{clientName}","{serviceType}","{description}","{amount}","{currency}","{dueDate}","{companyName}","{billingCycle}","{clientEmail}"],$=["{clientName}","{clientEmail}","{clientPhone}","{clientId}","{serviceType}","{description}","{amount}","{currency}","{dueDate}","{billingCycle}","{companyName}","{daysRemaining}","{daysOverdue}","{graceDays}","{remainingGraceDays}","{totalPending}","{potentialRevenue}","{paymentHistory}","{clientSince}","{previousPayments}","{paymentPattern}","{riskLevel}","{lastContact}","{suspensionDate}","{reactivationCost}","{clientValue}","{recoveryProbability}","{paymentDate}","{paymentMethod}","{paymentReference}","{nextDueDate}","{paymentTime}","{collectionEfficiency}","{clientSatisfaction}","{monthlyRevenue}","{registrationDate}","{growthPotential}","{clientSegment}","{acquisitionSource}","{gracePeriod}","{communicationHistory}","{serviceTerms}","{suspensionPolicy}"];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Plantillas y Alertas"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Gestiona las plantillas de correo y configura alertas automticas"})]}),a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-8",children:[a.jsxs("button",{onClick:()=>O("templates"),className:`py-2 px-1 border-b-2 font-medium text-sm ${I==="templates"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(iS,{}),a.jsx("span",{className:"ml-2",children:"Plantillas"})]}),a.jsxs("button",{onClick:()=>O("alerts"),className:`py-2 px-1 border-b-2 font-medium text-sm ${I==="alerts"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(ZL,{}),a.jsx("span",{className:"ml-2",children:"Alertas Automticas"})]})]})})}),I==="templates"&&a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Plantillas Guardadas"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Haz clic para editar una plantilla"})]}),a.jsx("div",{className:"max-h-80 overflow-y-auto",children:n.length===0?a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx("p",{children:"No hay plantillas guardadas"}),a.jsx("p",{className:"text-sm",children:"Crea tu primera plantilla"})]}):n.map(H=>a.jsx("div",{className:"p-4 border-b hover:bg-gray-50 transition-colors",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-gray-900 truncate",children:H.name}),a.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:H.subject}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:H.createdAt?new Date(H.createdAt.seconds*1e3).toLocaleDateString():"Sin fecha"})]}),a.jsxs("div",{className:"flex space-x-2 ml-2",children:[a.jsx("button",{onClick:()=>k(H),className:"text-blue-600 hover:text-blue-800 p-1",title:"Editar plantilla",children:a.jsx(JL,{})}),a.jsx("button",{onClick:()=>z(H.id),className:"text-red-600 hover:text-red-800 p-1",title:"Eliminar plantilla",children:a.jsx(rS,{})})]})]})},H.id))}),a.jsx("div",{className:"p-4",children:a.jsxs("button",{onClick:T,className:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(Vh,{}),a.jsx("span",{className:"ml-2",children:"Nueva Plantilla"})]})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Plantillas para Clientes"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Mensajes dirigidos a los clientes"})]}),a.jsxs("div",{className:"p-4 space-y-2",children:[a.jsxs("button",{onClick:()=>ne(V.preVencimiento),className:"w-full text-left p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-blue-900",children:"Aviso de Prximo Vencimiento"}),a.jsx("div",{className:"text-sm text-blue-700",children:"Recordatorio antes del vencimiento"})]}),a.jsxs("button",{onClick:()=>ne(V.vencido),className:"w-full text-left p-3 bg-yellow-50 hover:bg-yellow-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-yellow-900",children:"Servicio Vencido"}),a.jsx("div",{className:"text-sm text-yellow-700",children:"Notificacin de perodo de gracia"})]}),a.jsxs("button",{onClick:()=>ne(V.suspendido),className:"w-full text-left p-3 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-red-900",children:"Aviso de Suspensin"}),a.jsx("div",{className:"text-sm text-red-700",children:"Servicio suspendido por falta de pago"})]}),a.jsxs("button",{onClick:()=>ne(V.pagoRecibido),className:"w-full text-left p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-green-900",children:"Confirmacin de Pago"}),a.jsx("div",{className:"text-sm text-green-700",children:"Confirmacin de pago recibido"})]}),a.jsxs("button",{onClick:()=>ne(V.bienvenida),className:"w-full text-left p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-purple-900",children:"Bienvenida"}),a.jsx("div",{className:"text-sm text-purple-700",children:"Mensaje de bienvenida a nuevos clientes"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Plantillas para Administradores"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Alertas y notificaciones internas"})]}),a.jsxs("div",{className:"p-4 space-y-2",children:[a.jsxs("button",{onClick:()=>ne(V.adminPreVencimiento),className:"w-full text-left p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-blue-900",children:" Alerta: Prximo Vencimiento"}),a.jsx("div",{className:"text-sm text-blue-700",children:"Notificacin interna de servicios prximos a vencer"})]}),a.jsxs("button",{onClick:()=>ne(V.adminPeriodoGracia),className:"w-full text-left p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-orange-900",children:" Alerta: Perodo de Gracia"}),a.jsx("div",{className:"text-sm text-orange-700",children:"Alerta urgente de servicios en perodo de gracia"})]}),a.jsxs("button",{onClick:()=>ne(V.adminVencido),className:"w-full text-left p-3 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-red-900",children:" Alerta: Servicio Vencido"}),a.jsx("div",{className:"text-sm text-red-700",children:"Notificacin inmediata de servicios vencidos"})]}),a.jsxs("button",{onClick:()=>ne(V.adminSuspendido),className:"w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-gray-900",children:" Alerta: Servicio Suspendido"}),a.jsx("div",{className:"text-sm text-gray-700",children:"Notificacin de servicios cancelados por falta de pago"})]}),a.jsxs("button",{onClick:()=>ne(V.adminPagoRecibido),className:"w-full text-left p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-green-900",children:" Notificacin: Pago Recibido"}),a.jsx("div",{className:"text-sm text-green-700",children:"Confirmacin interna de pagos procesados"})]}),a.jsxs("button",{onClick:()=>ne(V.adminNuevoCliente),className:"w-full text-left p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-purple-900",children:" Notificacin: Nuevo Cliente"}),a.jsx("div",{className:"text-sm text-purple-700",children:"Alerta de nuevos clientes registrados"})]})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Variables para Clientes"}),a.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[a.jsx("p",{className:"font-medium",children:"Informacin bsica:"}),a.jsx("p",{children:R.slice(0,3).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Informacin del servicio:"}),a.jsx("p",{children:R.slice(3,6).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Informacin adicional:"}),a.jsx("p",{children:R.slice(6).join(", ")})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Variables para Administradores"}),a.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[a.jsx("p",{className:"font-medium",children:"Informacin del cliente:"}),a.jsx("p",{children:$.slice(0,4).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Informacin del servicio:"}),a.jsx("p",{children:$.slice(4,11).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Fechas y tiempos:"}),a.jsx("p",{children:$.slice(11,15).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Estadsticas:"}),a.jsx("p",{children:$.slice(15,19).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Anlisis de riesgo:"}),a.jsx("p",{children:$.slice(19,23).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Informacin de pago:"}),a.jsx("p",{children:$.slice(23,27).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Mtricas de rendimiento:"}),a.jsx("p",{children:$.slice(27,31).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Informacin de registro:"}),a.jsx("p",{children:$.slice(31,35).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Configuracin:"}),a.jsx("p",{children:$.slice(35).join(", ")})]})]})]}),a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-6 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:v?"Editando Plantilla":"Nueva Plantilla"}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:v?"Modifica los campos de la plantilla":"Completa los campos para crear una nueva plantilla"})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de la Plantilla"}),a.jsx("input",{type:"text",value:o,onChange:H=>l(H.target.value),placeholder:"Ej: Primer Recordatorio de Pago",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Asunto del Correo"}),a.jsx("input",{type:"text",value:c,onChange:H=>u(H.target.value),placeholder:"Ej: Recordatorio de Renovacin: {description}",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cuerpo del Mensaje"}),a.jsx("textarea",{value:f,onChange:H=>g(H.target.value),placeholder:"Escribe el contenido del mensaje aqu...",rows:"12",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm"})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{onClick:T,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Limpiar"}),a.jsx("button",{onClick:le,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:v?"Guardar Cambios":"Crear Plantilla"})]})]})]})})]}),I==="alerts"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-6 border-b",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-3"}),"Alerta de Prximo Vencimiento"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Notificaciones antes del vencimiento del servicio"})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Activar alerta"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Enviar notificaciones antes del vencimiento"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:C.preVencimiento.enabled,onChange:H=>N("preVencimiento","enabled",H.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),C.preVencimiento.enabled&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Das antes del vencimiento"}),a.jsx("input",{type:"number",min:"1",max:"30",value:C.preVencimiento.days,onChange:H=>N("preVencimiento","days",parseInt(H.target.value)),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para cliente"}),a.jsxs("select",{value:C.preVencimiento.clientTemplate,onChange:H=>N("preVencimiento","clientTemplate",H.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(H=>a.jsx("option",{value:H.id,children:H.name},H.id))]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notificar administradores"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Enviar copia a administradores seleccionados"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:C.preVencimiento.notifyAdmins,onChange:H=>N("preVencimiento","notifyAdmins",H.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),C.preVencimiento.notifyAdmins&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para administradores"}),a.jsxs("select",{value:C.preVencimiento.adminTemplate,onChange:H=>N("preVencimiento","adminTemplate",H.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(H=>a.jsx("option",{value:H.id,children:H.name},H.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Administradores a notificar"}),a.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-3",children:E.map(H=>a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:C.preVencimiento.selectedAdmins.includes(H.id),onChange:Y=>S("preVencimiento",H.id,Y.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("span",{className:"text-sm text-gray-700",children:[H.fullName," (",H.email,")"]})]},H.id))})]})]})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-6 border-b",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full mr-3"}),"Perodo de Gracia"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Notificaciones durante el perodo de gracia despus del vencimiento"})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Activar perodo de gracia"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Tiempo adicional para pagar antes de suspender"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:C.periodoGracia.enabled,onChange:H=>N("periodoGracia","enabled",H.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),C.periodoGracia.enabled&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Das de gracia"}),a.jsx("input",{type:"number",min:"1",max:"30",value:C.periodoGracia.days,onChange:H=>N("periodoGracia","days",parseInt(H.target.value)),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para cliente"}),a.jsxs("select",{value:C.periodoGracia.clientTemplate,onChange:H=>N("periodoGracia","clientTemplate",H.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(H=>a.jsx("option",{value:H.id,children:H.name},H.id))]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notificar administradores"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Enviar copia a administradores seleccionados"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:C.periodoGracia.notifyAdmins,onChange:H=>N("periodoGracia","notifyAdmins",H.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),C.periodoGracia.notifyAdmins&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para administradores"}),a.jsxs("select",{value:C.periodoGracia.adminTemplate,onChange:H=>N("periodoGracia","adminTemplate",H.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(H=>a.jsx("option",{value:H.id,children:H.name},H.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Administradores a notificar"}),a.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-3",children:E.map(H=>a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:C.periodoGracia.selectedAdmins.includes(H.id),onChange:Y=>S("periodoGracia",H.id,Y.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("span",{className:"text-sm text-gray-700",children:[H.fullName," (",H.email,")"]})]},H.id))})]})]})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-6 border-b",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-3"}),"Servicio Vencido"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Notificaciones cuando el servicio ha vencido"})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Activar alerta"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Enviar notificaciones cuando el servicio vence"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:C.vencido.enabled,onChange:H=>N("vencido","enabled",H.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),C.vencido.enabled&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para cliente"}),a.jsxs("select",{value:C.vencido.clientTemplate,onChange:H=>N("vencido","clientTemplate",H.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(H=>a.jsx("option",{value:H.id,children:H.name},H.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para administradores"}),a.jsxs("select",{value:C.vencido.adminTemplate,onChange:H=>N("vencido","adminTemplate",H.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),n.map(H=>a.jsx("option",{value:H.id,children:H.name},H.id))]})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notificar administradores"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Enviar copia a administradores seleccionados"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:C.vencido.notifyAdmins,onChange:H=>N("vencido","notifyAdmins",H.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),C.vencido.notifyAdmins&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Administradores a notificar"}),a.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-3",children:E.map(H=>a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:C.vencido.selectedAdmins.includes(H.id),onChange:Y=>S("vencido",H.id,Y.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("span",{className:"text-sm text-gray-700",children:[H.fullName," (",H.email,")"]})]},H.id))})]})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{onClick:P,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center",children:[a.jsx(Zp,{}),a.jsx("span",{className:"ml-2",children:"Guardar Configuracin de Alertas"})]})})]})]})}function oS({isDemo:t}){const{addNotification:e}=xn(),[n,r]=ue.useState({bold:{enabled:!1,apiKey:"",environment:"sandbox",webhookSecret:"",autoApprove:!1},paypal:{enabled:!1,clientId:"",clientSecret:"",environment:"sandbox",autoApprove:!1},payu:{enabled:!1,merchantId:"",apiKey:"",apiLogin:"",environment:"sandbox",autoApprove:!1},bankTransfer:{enabled:!1,accounts:[],autoApprove:!1,requireConfirmation:!0},general:{currency:"USD",defaultGateway:"bold"}}),[i,s]=ue.useState(!1);ue.useEffect(()=>{if(t){r({bold:{enabled:!0,apiKey:"demo_key",environment:"sandbox",webhookSecret:"demo_secret",autoApprove:!1},paypal:{enabled:!1,clientId:"",clientSecret:"",environment:"sandbox",autoApprove:!1},payu:{enabled:!1,merchantId:"",apiKey:"",apiLogin:"",environment:"sandbox",autoApprove:!1},bankTransfer:{enabled:!0,accounts:[{id:"1",bankName:"Banco Nacional",accountNumber:"1234567890",accountHolder:"Empresa Demo",accountType:"Ahorros"},{id:"2",bankName:"Banco Popular",accountNumber:"0987654321",accountHolder:"Empresa Demo",accountType:"Corriente"}],autoApprove:!1,requireConfirmation:!0},general:{currency:"USD",defaultGateway:"bold"}});return}const m=ct(Ue,"artifacts",Me,"public","data","settings","paymentConfig"),E=Zt(m,A=>{A.exists()&&r(A.data())});return()=>E()},[t]);const o=(m,E,A)=>{r(C=>({...C,[m]:{...C[m],[E]:A}}))},l=(m,E)=>{r(A=>({...A,general:{...A.general,[m]:E}}))},c=()=>{const m={id:Date.now().toString(),bankName:"",accountNumber:"",accountHolder:"",accountType:"Ahorros"};r(E=>({...E,bankTransfer:{...E.bankTransfer,accounts:[...E.bankTransfer.accounts,m]}}))},u=(m,E,A)=>{r(C=>({...C,bankTransfer:{...C.bankTransfer,accounts:C.bankTransfer.accounts.map(b=>b.id===m?{...b,[E]:A}:b)}}))},f=m=>{r(E=>({...E,bankTransfer:{...E.bankTransfer,accounts:E.bankTransfer.accounts.filter(A=>A.id!==m)}}))},g=async()=>{if(t){e("Configuracin guardada (modo demo)","success");return}s(!0);try{const m=ct(Ue,"artifacts",Me,"public","data","settings","paymentConfig");await ki(m,n),e("Configuracin de pagos guardada exitosamente","success")}catch(m){console.error("Error saving payment config:",m),e("Error al guardar la configuracin","error")}s(!1)},v=(m,E,A)=>a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[a.jsx(Xi,{}),E]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:n[m].enabled,onChange:C=>o(m,"enabled",C.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Habilitado"})]})]}),n[m].enabled&&a.jsxs("div",{className:"space-y-4",children:[A.map(C=>a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:C.label}),C.type==="select"?a.jsx("select",{value:n[m][C.name],onChange:b=>o(m,C.name,b.target.value),className:"w-full p-2 border rounded-md",children:C.options.map(b=>a.jsx("option",{value:b.value,children:b.label},b.value))}):a.jsx("input",{type:C.type,value:n[m][C.name],onChange:b=>o(m,C.name,b.target.value),placeholder:C.placeholder,className:"w-full p-2 border rounded-md"}),C.help&&a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:C.help})]},C.name)),a.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-md",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:n[m].autoApprove,onChange:C=>o(m,"autoApprove",C.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Aprobar pagos automticamente"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Los pagos de esta pasarela se marcarn como "Completado" automticamente'})]})]})]});return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(Zp,{}),"Configuracin de Pagos"]}),a.jsx("button",{onClick:g,disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:i?"Guardando...":"Guardar Configuracin"})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuracin General"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Moneda por Defecto"}),a.jsxs("select",{value:n.general.currency,onChange:m=>l("currency",m.target.value),className:"w-full p-2 border rounded-md",children:[a.jsx("option",{value:"USD",children:"USD - Dlar Americano"}),a.jsx("option",{value:"COP",children:"COP - Peso Colombiano"}),a.jsx("option",{value:"EUR",children:"EUR - Euro"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pasarela por Defecto"}),a.jsxs("select",{value:n.general.defaultGateway,onChange:m=>l("defaultGateway",m.target.value),className:"w-full p-2 border rounded-md",children:[a.jsx("option",{value:"bold",children:"Bold"}),a.jsx("option",{value:"paypal",children:"PayPal"}),a.jsx("option",{value:"payu",children:"PayU"}),a.jsx("option",{value:"bankTransfer",children:"Transferencia Bancaria"})]})]})]}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Cada pasarela tiene su propia configuracin de auto-aprobacin independiente."})]}),v("bold","Bold",[{name:"apiKey",label:"API Key",type:"password",placeholder:"Ingresa tu API Key de Bold"},{name:"environment",label:"Ambiente",type:"select",options:[{value:"sandbox",label:"Sandbox (Pruebas)"},{value:"production",label:"Produccin"}]},{name:"webhookSecret",label:"Webhook Secret",type:"password",placeholder:"Secreto para webhooks"}]),v("paypal","PayPal",[{name:"clientId",label:"Client ID",type:"text",placeholder:"Ingresa tu Client ID de PayPal"},{name:"clientSecret",label:"Client Secret",type:"password",placeholder:"Ingresa tu Client Secret"},{name:"environment",label:"Ambiente",type:"select",options:[{value:"sandbox",label:"Sandbox (Pruebas)"},{value:"live",label:"Live (Produccin)"}]}]),v("payu","PayU",[{name:"merchantId",label:"Merchant ID",type:"text",placeholder:"ID del comerciante"},{name:"apiKey",label:"API Key",type:"password",placeholder:"API Key de PayU"},{name:"apiLogin",label:"API Login",type:"text",placeholder:"API Login de PayU"},{name:"environment",label:"Ambiente",type:"select",options:[{value:"sandbox",label:"Sandbox (Pruebas)"},{value:"production",label:"Produccin"}]}]),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[a.jsx(Xi,{}),"Transferencias Bancarias"]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:n.bankTransfer.enabled,onChange:m=>o("bankTransfer","enabled",m.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Habilitado"})]})]}),n.bankTransfer.enabled&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"p-3 bg-gray-50 rounded-md",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:n.bankTransfer.autoApprove,onChange:m=>o("bankTransfer","autoApprove",m.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Aprobar transferencias automticamente"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Las transferencias se marcarn como "Completado" automticamente'})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h4",{className:"text-md font-medium text-gray-800",children:"Cuentas Bancarias"}),a.jsx("button",{onClick:c,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700",children:"+ Agregar Cuenta"})]}),a.jsx("div",{className:"space-y-4",children:n.bankTransfer.accounts.map((m,E)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h5",{className:"font-medium text-gray-700",children:["Cuenta ",E+1]}),a.jsx("button",{onClick:()=>f(m.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Eliminar"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Banco"}),a.jsx("input",{type:"text",value:m.bankName,onChange:A=>u(m.id,"bankName",A.target.value),placeholder:"Ej: Banco Nacional",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nmero de Cuenta"}),a.jsx("input",{type:"text",value:m.accountNumber,onChange:A=>u(m.id,"accountNumber",A.target.value),placeholder:"1234567890",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titular de la Cuenta"}),a.jsx("input",{type:"text",value:m.accountHolder,onChange:A=>u(m.id,"accountHolder",A.target.value),placeholder:"Nombre del titular",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Cuenta"}),a.jsxs("select",{value:m.accountType,onChange:A=>u(m.id,"accountType",A.target.value),className:"w-full p-2 border rounded-md",children:[a.jsx("option",{value:"Ahorros",children:"Ahorros"}),a.jsx("option",{value:"Corriente",children:"Corriente"})]})]})]})]},m.id))}),n.bankTransfer.accounts.length===0&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("p",{children:"No hay cuentas bancarias configuradas"}),a.jsx("p",{className:"text-sm",children:'Haz clic en "Agregar Cuenta" para comenzar'})]})]})]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:" Informacin Importante"}),a.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[a.jsx("li",{children:" Las credenciales se almacenan de forma segura en Firestore"}),a.jsx("li",{children:" Siempre prueba en modo sandbox antes de usar en produccin"}),a.jsx("li",{children:" Mantn tus claves API seguras y no las compartas"}),a.jsx("li",{children:" Los webhooks deben configurarse en cada pasarela de pago"})]})]})]})}let st=null;const mc=async()=>{try{const t=ct(Ue,"artifacts",Me,"public","data","settings","email_config"),e=await Ja(t);return e.exists()?(st=e.data(),st):(st={provider:"smtp",smtpHost:"",smtpPort:587,smtpSecure:!1,smtpUser:"",smtpPassword:"",zohoClientId:"",zohoClientSecret:"",zohoRefreshToken:"",zohoAccessToken:"",zohoAccessTokenExpiry:null,fromEmail:"",fromName:"",enabled:!1},st)}catch(t){return console.error("Error loading email config:",t),null}},u8=async()=>{try{const t=ct(Ue,"artifacts",Me,"public","data","settings","notification_settings"),e=await Ja(t);return e.exists()?e.data():{admin:{payments:{approval:!0,rejection:!0,newPayment:!0},services:{expirationReminder:!0,newService:!0},users:{newUser:!0,userActivation:!0},tickets:{newTicket:!0,ticketUpdate:!0},renewals:{renewalRequest:!0}},client:{payments:{approval:!0,rejection:!0,pendingPayment:!0},services:{expirationReminder:!0,serviceActivated:!0,serviceExpired:!0},tickets:{ticketReply:!0,ticketResolved:!0},renewals:{renewalReminder:!0,renewalConfirmed:!0}}}}catch(t){return console.error("Error loading notification settings:",t),null}},d8=async(t,e,n)=>{var i,s;const r=await u8();return r?((s=(i=r[t])==null?void 0:i[e])==null?void 0:s[n])??!0:!0},gl=async({to:t,toName:e,subject:n,html:r,text:i,type:s="Notificacin",recipientType:o="Cliente",module:l="system",event:c="notification",metadata:u={}})=>{try{if(!st||!st.enabled){console.warn(" Email service not configured or disabled"),console.log(" Registrando mensaje como fallido en historial");const g=await Bl({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Fallido",errorMessage:"Servicio de email no configurado",module:l,event:c,metadata:u});return console.log(" Mensaje registrado con ID:",g),{success:!1,error:"Email service not configured",messageId:g}}if(!await d8(o==="Cliente"?"client":"admin",l,c))return console.log(`Notification disabled: ${o}/${l}/${c}`),await Bl({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Cancelado",errorMessage:"Notificacin deshabilitada por configuracin",module:l,event:c,metadata:u}),{success:!1,error:"Notification disabled"};try{if(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")return console.warn(" Modo desarrollo: El endpoint PHP no est disponible localmente. El email se registrar como simulado."),{success:!0,messageId:await Bl({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Simulado",simulated:!0,errorMessage:" Email no enviado. En desarrollo local, el servidor PHP no est disponible. Despliega en produccin para envo real.",module:l,event:c,metadata:u}),simulated:!0,warning:"En desarrollo local, el email no se enva realmente. Despliega en produccin para envo real."};const v=st.provider||"smtp";let m="/send-email.php",E={};if(v==="zoho"){if(m="/send-zoho.php",!st.zohoClientId||!st.zohoClientSecret||!st.zohoRefreshToken||!st.fromEmail)throw new Error("Configuracin de Zoho Mail incompleta. Verifica Client ID, Client Secret, Refresh Token y From Email.");E={to:t,toName:e,subject:n,html:r,text:i,zohoConfig:{clientId:st.zohoClientId,clientSecret:st.zohoClientSecret,refreshToken:st.zohoRefreshToken,fromEmail:st.fromEmail,fromName:st.fromName}}}else E={to:t,toName:e,subject:n,html:r,text:i,smtpConfig:{smtpHost:st.smtpHost,smtpPort:st.smtpPort,smtpSecure:st.smtpSecure,smtpUser:st.smtpUser,smtpPassword:st.smtpPassword,fromEmail:st.fromEmail,fromName:st.fromName}};const A=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)}).catch(I=>{throw console.error("Error de red al llamar send-email.php:",I),new Error(`No se pudo conectar con el servidor PHP. Verifica que send-email.php est en el servidor. Error: ${I.message}`)});if(!A.ok){const I=await A.text().catch(()=>"No se pudo leer la respuesta del servidor");throw console.error("Error HTTP:",A.status,I),A.status===404?new Error("El archivo send-email.php no se encontr en el servidor (404). Verifica que est en el directorio raz."):new Error(`Error del servidor (${A.status}): ${I.substring(0,200)}`)}const C=A.headers.get("content-type");if(!C||!C.includes("application/json")){const I=await A.text().catch(()=>"No se pudo leer la respuesta");throw console.error("Respuesta no es JSON:",I.substring(0,200)),I.includes("<html")||I.includes("<!DOCTYPE")?new Error("El servidor devolvi HTML en lugar de JSON. Posiblemente PHP no est configurado o hay un error en send-email.php."):new Error(`El servidor no devolvi JSON. Respuesta: ${I.substring(0,200)}`)}let b;try{b=await A.json()}catch(I){const O=await A.text().catch(()=>"No se pudo leer la respuesta");throw console.error("Error al parsear JSON:",I,"Respuesta:",O.substring(0,200)),new Error(`Respuesta invlida del servidor (no es JSON vlido): ${O.substring(0,200)}`)}if(b.success){if(v==="zoho"&&b.accessToken&&b.expiresAt)try{const O=ct(Ue,"artifacts",Me,"public","data","settings","email_config");await ki(O,{zohoAccessToken:b.accessToken,zohoAccessTokenExpiry:b.expiresAt},{merge:!0}),st.zohoAccessToken=b.accessToken,st.zohoAccessTokenExpiry=b.expiresAt}catch(O){console.warn("No se pudo actualizar el access token en Firestore:",O)}return{success:!0,messageId:await Bl({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Enviado",module:l,event:c,metadata:u,provider:v,externalId:b.zohoMessageId||null}),sent:!0,provider:v}}else{const I=b.error||"Error desconocido al enviar email",O=b.details||"",V=O?`${I}

${O}`:I,ne=await Bl({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Fallido",errorMessage:V,module:l,event:c,metadata:u});return{success:!1,error:I,details:O,smtpInfo:b.smtp_host?{host:b.smtp_host,port:b.smtp_port,user:b.smtp_user}:null,messageId:ne}}}catch(g){console.error("Error al llamar a send-email.php:",g);const v=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",m=v?` Servidor PHP no disponible en desarrollo local: ${g.message}`:` Error al enviar email: ${g.message}`,E=await Bl({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:v?"Simulado":"Fallido",simulated:v,errorMessage:m,module:l,event:c,metadata:u});return{success:!1,error:m,messageId:E,simulated:v}}}catch(f){return console.error("Error sending email:",f),await Bl({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Fallido",errorMessage:f.message,module:l,event:c,metadata:u}),{success:!1,error:f.message}}},Bl=async t=>{try{console.log(" Registrando mensaje en Firestore:",{to:t.to,subject:t.subject,type:t.type,recipientType:t.recipientType,module:t.module,event:t.event});const e=zt(Ue,"artifacts",Me,"public","data","messages"),n=(st==null?void 0:st.provider)||"smtp",r={...t,channel:"email",provider:n,sentAt:dt.now(),createdAt:dt.now(),updatedAt:dt.now()};console.log(" Datos del mensaje a guardar:",r);const i=await xa(e,r);return console.log(" Mensaje registrado exitosamente con ID:",i.id),i.id}catch(e){return console.error(" Error registering message:",e),console.error(" Detalles del error:",e.message,e.code,e.stack),null}},h8=async t=>{try{if(await mc(),!st||!st.enabled)return{success:!1,error:"Email service not configured or disabled"};const e=st.provider||"smtp";if(e==="zoho"){if(!st.zohoClientId||!st.zohoClientSecret||!st.zohoRefreshToken||!st.fromEmail)return{success:!1,error:"Configuracin de Zoho Mail incompleta. Verifica Client ID, Client Secret, Refresh Token y From Email."}}else if(!st.smtpHost||!st.smtpUser||!st.fromEmail)return{success:!1,error:"Configuracin SMTP incompleta. Verifica todos los campos."};const n=" Prueba de Configuracin - Gestor de Cobros",r=new Date().toLocaleString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"}),i=`
      <!DOCTYPE html>
      <html lang="es">
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
          body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
          .container { max-width: 600px; margin: 0 auto; padding: 20px; background-color: #f9fafb; }
          .header { background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; }
          .content { background: white; padding: 30px; border-radius: 0 0 10px 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
          .success-badge { display: inline-block; background-color: #10b981; color: white; padding: 8px 16px; border-radius: 20px; font-size: 14px; font-weight: bold; margin-bottom: 20px; }
          .info-box { background-color: #eff6ff; border-left: 4px solid #2563eb; padding: 15px; margin: 20px 0; border-radius: 4px; }
          .config-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
          .config-table td { padding: 10px; border-bottom: 1px solid #e5e7eb; }
          .config-table td:first-child { font-weight: bold; color: #374151; width: 40%; }
          .config-table td:last-child { color: #6b7280; font-family: monospace; }
          .footer { text-align: center; color: #6b7280; font-size: 12px; margin-top: 30px; padding-top: 20px; border-top: 1px solid #e5e7eb; }
          .highlight { background-color: #fef3c7; padding: 2px 6px; border-radius: 3px; }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="header">
            <h1 style="margin: 0; font-size: 28px;"> Prueba de Configuracin</h1>
            <p style="margin: 10px 0 0 0; opacity: 0.9;">Gestor de Cobros - Sistema de Email</p>
          </div>
          
          <div class="content">
            <div class="success-badge"> Configuracin Exitosa</div>
            
            <h2 style="color: #1f2937; margin-top: 0;">Email de Prueba Enviado Correctamente!</h2>
            
            <p>Este es un email de prueba para verificar que tu configuracin SMTP est funcionando correctamente.</p>
            
            <div class="info-box">
              <strong> Informacin Importante:</strong><br>
              Si recibiste este email, significa que tu servidor SMTP est configurado y funcionando perfectamente.
              Los emails del sistema ahora se enviarn realmente a tus clientes y administradores.
            </div>
            
            <h3 style="color: #374151; margin-top: 30px;"> Detalles de Configuracin ${e==="zoho"?"Zoho Mail API":"SMTP"}</h3>
            
            <table class="config-table">
              ${e==="zoho"?`
              <tr>
                <td>Proveedor:</td>
                <td><span class="highlight">Zoho Mail API</span></td>
              </tr>
              <tr>
                <td>Client ID:</td>
                <td><span class="highlight">${st.zohoClientId?st.zohoClientId.substring(0,20)+"...":"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Email Remitente:</td>
                <td><span class="highlight">${st.fromEmail||"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Nombre Remitente:</td>
                <td><span class="highlight">${st.fromName||"No configurado"}</span></td>
              </tr>
              `:`
              <tr>
                <td>Proveedor:</td>
                <td><span class="highlight">SMTP</span></td>
              </tr>
              <tr>
                <td>Servidor SMTP:</td>
                <td><span class="highlight">${st.smtpHost||"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Puerto:</td>
                <td><span class="highlight">${st.smtpPort||"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Seguridad:</td>
                <td><span class="highlight">${st.smtpSecure?"SSL/TLS ":"No seguro"}</span></td>
              </tr>
              <tr>
                <td>Usuario SMTP:</td>
                <td><span class="highlight">${st.smtpUser||"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Email Remitente:</td>
                <td><span class="highlight">${st.fromEmail||"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Nombre Remitente:</td>
                <td><span class="highlight">${st.fromName||"No configurado"}</span></td>
              </tr>
              `}
            </table>
            
            <h3 style="color: #374151; margin-top: 30px;"> Informacin del Envo</h3>
            
            <table class="config-table">
              <tr>
                <td>Destinatario:</td>
                <td><span class="highlight">${t}</span></td>
              </tr>
              <tr>
                <td>Fecha y Hora:</td>
                <td>${r}</td>
              </tr>
              <tr>
                <td>Estado:</td>
                <td><strong style="color: #10b981;"> Enviado Exitosamente</strong></td>
              </tr>
            </table>
            
            <div class="info-box" style="background-color: #f0fdf4; border-left-color: #10b981; margin-top: 30px;">
              <strong> Prximos Pasos:</strong><br>
              <ul style="margin: 10px 0 0 20px; padding-left: 0;">
                <li>Verifica que este email lleg correctamente (revisa tambin spam)</li>
                <li>Los emails del sistema ahora se enviarn automticamente</li>
                <li>Puedes verificar el historial de mensajes en el panel de administracin</li>
                <li>Si necesitas cambiar la configuracin, ve a <strong>Mensajes  Configuracin de Email</strong></li>
              </ul>
            </div>
            
            <div class="footer">
              <p style="margin: 0;">
                <strong>Gestor de Cobros</strong><br>
                Sistema de Gestin de Servicios y Pagos<br>
                ${new Date().getFullYear()}  Todos los derechos reservados
              </p>
              <p style="margin: 10px 0 0 0; font-size: 11px; color: #9ca3af;">
                Este es un email automtico del sistema. Por favor, no respondas a este mensaje.
              </p>
            </div>
          </div>
        </div>
      </body>
      </html>
    `,s=`

  PRUEBA DE CONFIGURACIN - GESTOR DE COBROS


Email de Prueba Enviado Correctamente!

Este es un email de prueba para verificar que tu configuracin SMTP est funcionando correctamente.

 INFORMACIN IMPORTANTE:

Si recibiste este email, significa que tu servidor SMTP est configurado y funcionando perfectamente. Los emails del sistema ahora se enviarn realmente a tus clientes y administradores.

 DETALLES DE CONFIGURACIN ${e==="zoho"?"ZOHO MAIL API":"SMTP"}:

${e==="zoho"?`
Proveedor: Zoho Mail API
Client ID: ${st.zohoClientId?st.zohoClientId.substring(0,20)+"...":"No configurado"}
Email Remitente: ${st.fromEmail||"No configurado"}
Nombre Remitente: ${st.fromName||"No configurado"}
`:`
Proveedor: SMTP
Servidor SMTP: ${st.smtpHost||"No configurado"}
Puerto: ${st.smtpPort||"No configurado"}
Seguridad: ${st.smtpSecure?"SSL/TLS ":"No seguro"}
Usuario SMTP: ${st.smtpUser||"No configurado"}
Email Remitente: ${st.fromEmail||"No configurado"}
Nombre Remitente: ${st.fromName||"No configurado"}
`}

 INFORMACIN DEL ENVO:

Destinatario: ${t}
Fecha y Hora: ${r}
Estado:  Enviado Exitosamente

 PRXIMOS PASOS:

 Verifica que este email lleg correctamente (revisa tambin spam)
 Los emails del sistema ahora se enviarn automticamente
 Puedes verificar el historial de mensajes en el panel de administracin
 Si necesitas cambiar la configuracin, ve a Mensajes  Configuracin de Email


Gestor de Cobros
Sistema de Gestin de Servicios y Pagos
${new Date().getFullYear()}  Todos los derechos reservados

Este es un email automtico del sistema. Por favor, no respondas a este mensaje.

    `;return await gl({to:t,toName:"Usuario de Prueba",subject:n,html:i,text:s,type:"Sistema",recipientType:"Administrador",module:"system",event:"test",metadata:{isTest:!0}})}catch(e){return console.error("Error testing email:",e),{success:!1,error:e.message}}};mc().then(t=>{st=t});function f8({isDemo:t}){const{addNotification:e}=xn(),[n,r]=ue.useState({renewalSettings:{enabled:!0,maxRenewalYears:3,autoRenewal:!0,gracePeriodDays:7,reminderDays:3},discounts:{monthly:{enabled:!1,discount:0,description:"Descuento por pago mensual"},quarterly:{enabled:!1,discount:5,description:"Descuento por pago trimestral"},semiAnnual:{enabled:!1,discount:10,description:"Descuento por pago semestral"},annual:{enabled:!1,discount:15,description:"Descuento por pago anual"},biennial:{enabled:!1,discount:25,description:"Descuento por pago bienal (2 aos)"},triennial:{enabled:!1,discount:35,description:"Descuento por pago trienal (3 aos)"}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"},documentSettings:{invoiceName:"Factura",receiptName:"Remisin",invoicePrefix:"FAC",receiptPrefix:"REM",invoiceNumberFormat:"FAC-{year}-{month}-{number}",receiptNumberFormat:"REM-{year}-{month}-{number}"},pricingSettings:{roundToNearest:100,minimumAmount:1e3,maximumAmount:1e7}}),[i,s]=ue.useState(!1);ue.useEffect(()=>{if(t){r({renewalSettings:{enabled:!0,maxRenewalYears:3,autoRenewal:!0,gracePeriodDays:7,reminderDays:3},discounts:{monthly:{enabled:!1,discount:0,description:"Descuento por pago mensual"},quarterly:{enabled:!0,discount:5,description:"Descuento por pago trimestral"},semiAnnual:{enabled:!0,discount:10,description:"Descuento por pago semestral"},annual:{enabled:!0,discount:15,description:"Descuento por pago anual"},biennial:{enabled:!0,discount:25,description:"Descuento por pago bienal (2 aos)"},triennial:{enabled:!0,discount:35,description:"Descuento por pago trienal (3 aos)"}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"},documentSettings:{invoiceName:"Factura",receiptName:"Remisin",invoicePrefix:"FAC",receiptPrefix:"REM",invoiceNumberFormat:"FAC-{year}-{month}-{number}",receiptNumberFormat:"REM-{year}-{month}-{number}"},pricingSettings:{roundToNearest:100,minimumAmount:1e3,maximumAmount:1e7}});return}const m=ct(Ue,"artifacts",Me,"public","data","settings","renewalConfig"),E=Zt(m,A=>{A.exists()&&r(A.data())});return()=>E()},[t]);const o=(m,E,A)=>{r(C=>({...C,[m]:{...C[m],[E]:A}}))},l=(m,E,A)=>{r(C=>({...C,discounts:{...C.discounts,[m]:{...C.discounts[m],[E]:A}}}))},c=async()=>{if(t){e("Configuracin guardada (modo demo)","success");return}s(!0);try{const m=ct(Ue,"artifacts",Me,"public","data","settings","renewalConfig");await ki(m,n),e("Configuracin de renovaciones guardada exitosamente","success")}catch(m){console.error("Error saving renewal config:",m),e("Error al guardar la configuracin","error")}s(!1)},u=(m,E)=>{const A=n.discounts[E];if(!A.enabled)return m;const C=m*A.discount/100,b=m-C,I=Math.round(b/n.pricingSettings.roundToNearest)*n.pricingSettings.roundToNearest;return Math.max(I,n.pricingSettings.minimumAmount)},f=m=>{if(!n.taxSettings.ivaEnabled||n.taxSettings.ivaIncluded)return m;{const E=m*n.taxSettings.ivaPercentage/100;return m+E}},g=m=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(m),v=[{key:"monthly",label:"Mensual",months:1},{key:"quarterly",label:"Trimestral",months:3},{key:"semiAnnual",label:"Semestral",months:6},{key:"annual",label:"Anual",months:12},{key:"biennial",label:"Bienal (2 aos)",months:24},{key:"triennial",label:"Trienal (3 aos)",months:36}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(ll,{}),"Configuracin de Renovaciones"]}),a.jsx("button",{onClick:c,disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:i?"Guardando...":"Guardar Configuracin"})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(Zp,{}),"Configuracin General"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx("div",{children:a.jsxs("label",{className:"flex items-center mb-2",children:[a.jsx("input",{type:"checkbox",checked:n.renewalSettings.enabled,onChange:m=>o("renewalSettings","enabled",m.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Habilitar renovaciones automticas"})]})}),a.jsx("div",{children:a.jsxs("label",{className:"flex items-center mb-2",children:[a.jsx("input",{type:"checkbox",checked:n.renewalSettings.autoRenewal,onChange:m=>o("renewalSettings","autoRenewal",m.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Renovacin automtica"})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mximo de aos para renovacin"}),a.jsxs("select",{value:n.renewalSettings.maxRenewalYears,onChange:m=>o("renewalSettings","maxRenewalYears",parseInt(m.target.value)),className:"w-full p-2 border rounded-md",children:[a.jsx("option",{value:1,children:"1 ao"}),a.jsx("option",{value:2,children:"2 aos"}),a.jsx("option",{value:3,children:"3 aos"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Das de gracia"}),a.jsx("input",{type:"number",value:n.renewalSettings.gracePeriodDays,onChange:m=>o("renewalSettings","gracePeriodDays",parseInt(m.target.value)),className:"w-full p-2 border rounded-md",min:"0",max:"30"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Das de recordatorio"}),a.jsx("input",{type:"number",value:n.renewalSettings.reminderDays,onChange:m=>o("renewalSettings","reminderDays",parseInt(m.target.value)),className:"w-full p-2 border rounded-md",min:"1",max:"30"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(aS,{}),"Descuentos por Perodo de Renovacin"]}),a.jsx("div",{className:"space-y-4",children:v.map(m=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:m.label}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:n.discounts[m.key].enabled,onChange:E=>l(m.key,"enabled",E.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Habilitado"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descuento (%)"}),a.jsx("input",{type:"number",value:n.discounts[m.key].discount,onChange:E=>l(m.key,"discount",parseFloat(E.target.value)),className:"w-full p-2 border rounded-md",min:"0",max:"100",step:"0.1",disabled:!n.discounts[m.key].enabled})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin"}),a.jsx("input",{type:"text",value:n.discounts[m.key].description,onChange:E=>l(m.key,"description",E.target.value),className:"w-full p-2 border rounded-md",disabled:!n.discounts[m.key].enabled})]})]}),n.discounts[m.key].enabled&&a.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-md",children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Simulacin de Precio"}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsxs("div",{children:["Precio original: ",g(1e5)]}),a.jsxs("div",{children:["Descuento (",n.discounts[m.key].discount,"%): ",g(1e5-u(1e5,m.key))]}),a.jsxs("div",{className:"font-semibold text-green-600",children:["Precio final: ",g(u(1e5,m.key))]})]})]})]},m.key))})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(Xi,{}),"Configuracin de Impuestos"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx("div",{children:a.jsxs("label",{className:"flex items-center mb-2",children:[a.jsx("input",{type:"checkbox",checked:n.taxSettings.ivaEnabled,onChange:m=>o("taxSettings","ivaEnabled",m.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Habilitar IVA"})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Porcentaje de IVA (%)"}),a.jsx("input",{type:"number",value:n.taxSettings.ivaPercentage,onChange:m=>o("taxSettings","ivaPercentage",parseFloat(m.target.value)),className:"w-full p-2 border rounded-md",min:"0",max:"100",step:"0.1",disabled:!n.taxSettings.ivaEnabled})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de IVA"}),a.jsxs("select",{value:n.taxSettings.ivaIncluded?"included":"excluded",onChange:m=>o("taxSettings","ivaIncluded",m.target.value==="included"),className:"w-full p-2 border rounded-md",disabled:!n.taxSettings.ivaEnabled,children:[a.jsx("option",{value:"excluded",children:"IVA se suma al precio"}),a.jsx("option",{value:"included",children:"IVA incluido en el precio"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del impuesto"}),a.jsx("input",{type:"text",value:n.taxSettings.taxName,onChange:m=>o("taxSettings","taxName",m.target.value),className:"w-full p-2 border rounded-md",disabled:!n.taxSettings.ivaEnabled})]})]}),n.taxSettings.ivaEnabled&&a.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Simulacin de Impuestos"}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsxs("div",{children:["Precio base: ",g(1e5)]}),!n.taxSettings.ivaIncluded&&a.jsxs("div",{children:["IVA (",n.taxSettings.ivaPercentage,"%): ",g(1e5*n.taxSettings.ivaPercentage/100)]}),a.jsxs("div",{className:"font-semibold text-blue-600",children:["Precio final: ",g(f(1e5))]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuracin de Documentos"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de Factura"}),a.jsx("input",{type:"text",value:n.documentSettings.invoiceName,onChange:m=>o("documentSettings","invoiceName",m.target.value),className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de Remisin"}),a.jsx("input",{type:"text",value:n.documentSettings.receiptName,onChange:m=>o("documentSettings","receiptName",m.target.value),className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prefijo de Factura"}),a.jsx("input",{type:"text",value:n.documentSettings.invoicePrefix,onChange:m=>o("documentSettings","invoicePrefix",m.target.value),className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prefijo de Remisin"}),a.jsx("input",{type:"text",value:n.documentSettings.receiptPrefix,onChange:m=>o("documentSettings","receiptPrefix",m.target.value),className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Formato de Nmero de Factura"}),a.jsx("input",{type:"text",value:n.documentSettings.invoiceNumberFormat,onChange:m=>o("documentSettings","invoiceNumberFormat",m.target.value),className:"w-full p-2 border rounded-md",placeholder:"FAC-{year}-{month}-{number}"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables disponibles: ","{year}",", ","{month}",", ","{number}"]})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Formato de Nmero de Remisin"}),a.jsx("input",{type:"text",value:n.documentSettings.receiptNumberFormat,onChange:m=>o("documentSettings","receiptNumberFormat",m.target.value),className:"w-full p-2 border rounded-md",placeholder:"REM-{year}-{month}-{number}"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables disponibles: ","{year}",", ","{month}",", ","{number}"]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuracin de Precios"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Redondear al mltiplo ms cercano"}),a.jsx("input",{type:"number",value:n.pricingSettings.roundToNearest,onChange:m=>o("pricingSettings","roundToNearest",parseInt(m.target.value)),className:"w-full p-2 border rounded-md",min:"1"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ej: 100 para redondear a centenas"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto mnimo"}),a.jsx("input",{type:"number",value:n.pricingSettings.minimumAmount,onChange:m=>o("pricingSettings","minimumAmount",parseInt(m.target.value)),className:"w-full p-2 border rounded-md",min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto mximo"}),a.jsx("input",{type:"number",value:n.pricingSettings.maximumAmount,onChange:m=>o("pricingSettings","maximumAmount",parseInt(m.target.value)),className:"w-full p-2 border rounded-md",min:"0"})]})]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:" Informacin Importante"}),a.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[a.jsx("li",{children:" Los descuentos se aplican automticamente segn el perodo de renovacin seleccionado"}),a.jsx("li",{children:" Los precios se redondean automticamente para evitar decimales"}),a.jsx("li",{children:" El IVA se calcula segn la configuracin establecida"}),a.jsx("li",{children:" Los nombres de documentos se pueden personalizar segn las necesidades"})]})]})]})}const m8="modulepreload",p8=function(t){return"/"+t},u5={},n0=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(c=>{if(c=p8(c),c in u5)return;u5[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":m8,u||(g.as="script"),g.crossOrigin="",g.href=c,l&&g.setAttribute("nonce",l),document.head.appendChild(g),u)return new Promise((v,m)=>{g.addEventListener("load",v),g.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};function hn(t){"@babel/helpers - typeof";return hn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hn(t)}var Vs=Uint8Array,Yi=Uint16Array,$y=Int32Array,Hy=new Vs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Wy=new Vs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),d5=new Vs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),lS=function(t,e){for(var n=new Yi(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var i=new $y(n[30]),r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return{b:n,r:i}},cS=lS(Hy,2),g8=cS.b,z1=cS.r;g8[28]=258,z1[258]=28;var v8=lS(Wy,0),h5=v8.r,q1=new Yi(32768);for(var kn=0;kn<32768;++kn){var Oo=(kn&43690)>>1|(kn&21845)<<1;Oo=(Oo&52428)>>2|(Oo&13107)<<2,Oo=(Oo&61680)>>4|(Oo&3855)<<4,q1[kn]=((Oo&65280)>>8|(Oo&255)<<8)>>1}var zd=function(t,e,n){for(var r=t.length,i=0,s=new Yi(e);i<r;++i)t[i]&&++s[t[i]-1];var o=new Yi(e);for(i=1;i<e;++i)o[i]=o[i-1]+s[i-1]<<1;var l;if(n){l=new Yi(1<<e);var c=15-e;for(i=0;i<r;++i)if(t[i])for(var u=i<<4|t[i],f=e-t[i],g=o[t[i]-1]++<<f,v=g|(1<<f)-1;g<=v;++g)l[q1[g]>>c]=u}else for(l=new Yi(r),i=0;i<r;++i)t[i]&&(l[i]=q1[o[t[i]-1]++]>>15-t[i]);return l},pc=new Vs(288);for(var kn=0;kn<144;++kn)pc[kn]=8;for(var kn=144;kn<256;++kn)pc[kn]=9;for(var kn=256;kn<280;++kn)pc[kn]=7;for(var kn=280;kn<288;++kn)pc[kn]=8;var op=new Vs(32);for(var kn=0;kn<32;++kn)op[kn]=5;var y8=zd(pc,9,0),x8=zd(op,5,0),uS=function(t){return(t+7)/8|0},b8=function(t,e,n){return(n==null||n>t.length)&&(n=t.length),new Vs(t.subarray(e,n))},Va=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8},gd=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8,t[r+2]|=n>>16},r0=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var i=n.length,s=n.slice();if(!i)return{t:hS,l:0};if(i==1){var o=new Vs(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort(function(ne,le){return ne.f-le.f}),n.push({s:-1,f:25001});var l=n[0],c=n[1],u=0,f=1,g=2;for(n[0]={s:-1,f:l.f+c.f,l,r:c};f!=i-1;)l=n[n[u].f<n[g].f?u++:g++],c=n[u!=f&&n[u].f<n[g].f?u++:g++],n[f++]={s:-1,f:l.f+c.f,l,r:c};for(var v=s[0].s,r=1;r<i;++r)s[r].s>v&&(v=s[r].s);var m=new Yi(v+1),E=$1(n[f-1],m,0);if(E>e){var r=0,A=0,C=E-e,b=1<<C;for(s.sort(function(le,z){return m[z.s]-m[le.s]||le.f-z.f});r<i;++r){var I=s[r].s;if(m[I]>e)A+=b-(1<<E-m[I]),m[I]=e;else break}for(A>>=C;A>0;){var O=s[r].s;m[O]<e?A-=1<<e-m[O]++-1:++r}for(;r>=0&&A;--r){var V=s[r].s;m[V]==e&&(--m[V],++A)}E=e}return{t:new Vs(m),l:E}},$1=function(t,e,n){return t.s==-1?Math.max($1(t.l,e,n+1),$1(t.r,e,n+1)):e[t.s]=n},f5=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new Yi(++e),r=0,i=t[0],s=1,o=function(c){n[r++]=c},l=1;l<=e;++l)if(t[l]==i&&l!=e)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=t[l]}return{c:n.subarray(0,r),n:e}},vd=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},dS=function(t,e,n){var r=n.length,i=uS(e+2);t[i]=r&255,t[i+1]=r>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var s=0;s<r;++s)t[i+s+4]=n[s];return(i+4+r)*8},m5=function(t,e,n,r,i,s,o,l,c,u,f){Va(e,f++,n),++i[256];for(var g=r0(i,15),v=g.t,m=g.l,E=r0(s,15),A=E.t,C=E.l,b=f5(v),I=b.c,O=b.n,V=f5(A),ne=V.c,le=V.n,z=new Yi(19),T=0;T<I.length;++T)++z[I[T]&31];for(var T=0;T<ne.length;++T)++z[ne[T]&31];for(var k=r0(z,7),N=k.t,S=k.l,P=19;P>4&&!N[d5[P-1]];--P);var R=u+5<<3,$=vd(i,pc)+vd(s,op)+o,H=vd(i,v)+vd(s,A)+o+14+3*P+vd(z,N)+2*z[16]+3*z[17]+7*z[18];if(c>=0&&R<=$&&R<=H)return dS(e,f,t.subarray(c,c+u));var Y,M,U,ee;if(Va(e,f,1+(H<$)),f+=2,H<$){Y=zd(v,m,0),M=v,U=zd(A,C,0),ee=A;var fe=zd(N,S,0);Va(e,f,O-257),Va(e,f+5,le-1),Va(e,f+10,P-4),f+=14;for(var T=0;T<P;++T)Va(e,f+3*T,N[d5[T]]);f+=3*P;for(var Q=[I,ne],w=0;w<2;++w)for(var F=Q[w],T=0;T<F.length;++T){var D=F[T]&31;Va(e,f,fe[D]),f+=N[D],D>15&&(Va(e,f,F[T]>>5&127),f+=F[T]>>12)}}else Y=y8,M=pc,U=x8,ee=op;for(var T=0;T<l;++T){var K=r[T];if(K>255){var D=K>>18&31;gd(e,f,Y[D+257]),f+=M[D+257],D>7&&(Va(e,f,K>>23&31),f+=Hy[D]);var te=K&31;gd(e,f,U[te]),f+=ee[te],te>3&&(gd(e,f,K>>5&8191),f+=Wy[te])}else gd(e,f,Y[K]),f+=M[K]}return gd(e,f,Y[256]),f+M[256]},w8=new $y([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),hS=new Vs(0),_8=function(t,e,n,r,i,s){var o=s.z||t.length,l=new Vs(r+o+5*(1+Math.ceil(o/7e3))+i),c=l.subarray(r,l.length-i),u=s.l,f=(s.r||0)&7;if(e){f&&(c[0]=s.r>>3);for(var g=w8[e-1],v=g>>13,m=g&8191,E=(1<<n)-1,A=s.p||new Yi(32768),C=s.h||new Yi(E+1),b=Math.ceil(n/3),I=2*b,O=function(Ne){return(t[Ne]^t[Ne+1]<<b^t[Ne+2]<<I)&E},V=new $y(25e3),ne=new Yi(288),le=new Yi(32),z=0,T=0,k=s.i||0,N=0,S=s.w||0,P=0;k+2<o;++k){var R=O(k),$=k&32767,H=C[R];if(A[$]=H,C[R]=$,S<=k){var Y=o-k;if((z>7e3||N>24576)&&(Y>423||!u)){f=m5(t,c,0,V,ne,le,T,N,P,k-P,f),N=z=T=0,P=k;for(var M=0;M<286;++M)ne[M]=0;for(var M=0;M<30;++M)le[M]=0}var U=2,ee=0,fe=m,Q=$-H&32767;if(Y>2&&R==O(k-Q))for(var w=Math.min(v,Y)-1,F=Math.min(32767,k),D=Math.min(258,Y);Q<=F&&--fe&&$!=H;){if(t[k+U]==t[k+U-Q]){for(var K=0;K<D&&t[k+K]==t[k+K-Q];++K);if(K>U){if(U=K,ee=Q,K>w)break;for(var te=Math.min(Q,K-2),oe=0,M=0;M<te;++M){var he=k-Q+M&32767,pe=A[he],ve=he-pe&32767;ve>oe&&(oe=ve,H=he)}}}$=H,H=A[$],Q+=$-H&32767}if(ee){V[N++]=268435456|z1[U]<<18|h5[ee];var Ee=z1[U]&31,Ve=h5[ee]&31;T+=Hy[Ee]+Wy[Ve],++ne[257+Ee],++le[Ve],S=k+U,++z}else V[N++]=t[k],++ne[t[k]]}}for(k=Math.max(k,S);k<o;++k)V[N++]=t[k],++ne[t[k]];f=m5(t,c,u,V,ne,le,T,N,P,k-P,f),u||(s.r=f&7|c[f/8|0]<<3,f-=7,s.h=C,s.p=A,s.i=k,s.w=S)}else{for(var k=s.w||0;k<o+u;k+=65535){var ze=k+65535;ze>=o&&(c[f/8|0]=u,ze=o),f=dS(c,f+1,t.subarray(k,ze))}s.i=o}return b8(l,0,r+uS(f)+i)},fS=function(){var t=1,e=0;return{p:function(n){for(var r=t,i=e,s=n.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)i+=r+=n[o];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}t=r,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},N8=function(t,e,n,r,i){if(!i&&(i={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),o=new Vs(s.length+t.length);o.set(s),o.set(t,s.length),t=o,i.w=s.length}return _8(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,r,i)},mS=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},S8=function(t,e){var n=e.level,r=n==0?0:n<6?1:n==9?3:2;if(t[0]=120,t[1]=r<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=fS();i.p(e.dictionary),mS(t,2,i.d())}};function H1(t,e){e||(e={});var n=fS();n.p(t);var r=N8(t,e,e.dictionary?6:2,4);return S8(r,e),mS(r,r.length-4,n.d()),r}var E8=typeof TextDecoder<"u"&&new TextDecoder,A8=0;try{E8.decode(hS,{stream:!0}),A8=1}catch{}function j8(t){if(Array.isArray(t))return t}function T8(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,o,l=[],c=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(c=(r=s.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(f){u=!0,i=f}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function p5(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function k8(t,e){if(t){if(typeof t=="string")return p5(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p5(t,e):void 0}}function C8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function g5(t,e){return j8(t)||T8(t,e)||k8(t,e)||C8()}function v5(t,e="utf8"){return new TextDecoder(e).decode(t)}const I8=new TextEncoder;function P8(t){return I8.encode(t)}const R8=1024*8,L8=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),i0={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Gy{constructor(e=R8,n={}){dn(this,"buffer");dn(this,"byteLength");dn(this,"byteOffset");dn(this,"length");dn(this,"offset");dn(this,"lastWrittenByte");dn(this,"littleEndian");dn(this,"_data");dn(this,"_mark");dn(this,"_marks");let r=!1;typeof e=="number"?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);const i=n.offset?n.offset>>>0:0,s=e.byteLength-i;let o=i;(ArrayBuffer.isView(e)||e instanceof Gy)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+i),e=e.buffer),r?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const r=(this.offset+e)*2,i=new Uint8Array(r);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,n){const r=i0[n].BYTES_PER_ELEMENT*e,i=this.byteOffset+this.offset,s=this.buffer.slice(i,i+r);if(this.littleEndian===L8&&n!=="uint8"&&n!=="int8"){const l=new Uint8Array(this.buffer.slice(i,i+r));l.reverse();const c=new i0[n](l.buffer);return this.offset+=r,c.reverse(),c}const o=new i0[n](s);return this.offset+=r,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let n="";for(let r=0;r<e;r++)n+=this.readChar();return n}readUtf8(e=1){return v5(this.readBytes(e))}decodeText(e=1,n="utf8"){return v5(this.readBytes(e),n)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let n=0;n<e.length;n++)this._data.setUint8(this.offset++,e[n]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let n=0;n<e.length;n++)this.writeUint8(e.charCodeAt(n));return this}writeUtf8(e){return this.writeBytes(P8(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Vu(t){let e=t.length;for(;--e>=0;)t[e]=0}const D8=3,M8=258,pS=29,O8=256,F8=O8+1+pS,gS=30,V8=512,U8=new Array((F8+2)*2);Vu(U8);const B8=new Array(gS*2);Vu(B8);const z8=new Array(V8);Vu(z8);const q8=new Array(M8-D8+1);Vu(q8);const $8=new Array(pS);Vu($8);const H8=new Array(gS);Vu(H8);const W8=(t,e,n,r)=>{let i=t&65535|0,s=t>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do i=i+e[r++]|0,s=s+i|0;while(--o);i%=65521,s%=65521}return i|s<<16|0};var W1=W8;const G8=()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e},K8=new Uint32Array(G8()),Y8=(t,e,n,r)=>{const i=K8,s=r+n;t^=-1;for(let o=r;o<s;o++)t=t>>>8^i[(t^e[o])&255];return t^-1};var sa=Y8,G1={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},vS={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Q8=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var X8=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)Q8(n,r)&&(t[r]=n[r])}}return t},J8=t=>{let e=0;for(let r=0,i=t.length;r<i;r++)e+=t[r].length;const n=new Uint8Array(e);for(let r=0,i=0,s=t.length;r<s;r++){let o=t[r];n.set(o,i),i+=o.length}return n},yS={assign:X8,flattenChunks:J8};let xS=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{xS=!1}const vh=new Uint8Array(256);for(let t=0;t<256;t++)vh[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;vh[254]=vh[254]=1;var Z8=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,n,r,i,s,o=t.length,l=0;for(i=0;i<o;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<o&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(l),s=0,i=0;s<l;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<o&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|n&63):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|n&63):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|n&63);return e};const e7=(t,e)=>{if(e<65534&&t.subarray&&xS)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n};var t7=(t,e)=>{const n=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let r,i;const s=new Array(n*2);for(i=0,r=0;r<n;){let o=t[r++];if(o<128){s[i++]=o;continue}let l=vh[o];if(l>4){s[i++]=65533,r+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&r<n;)o=o<<6|t[r++]&63,l--;if(l>1){s[i++]=65533;continue}o<65536?s[i++]=o:(o-=65536,s[i++]=55296|o>>10&1023,s[i++]=56320|o&1023)}return e7(s,i)},n7=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let n=e-1;for(;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?e:n+vh[t[n]]>e?n:e},K1={string2buf:Z8,buf2string:t7,utf8border:n7};function r7(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var i7=r7;const Cf=16209,s7=16191;var a7=function(e,n){let r,i,s,o,l,c,u,f,g,v,m,E,A,C,b,I,O,V,ne,le,z,T,k,N;const S=e.state;r=e.next_in,k=e.input,i=r+(e.avail_in-5),s=e.next_out,N=e.output,o=s-(n-e.avail_out),l=s+(e.avail_out-257),c=S.dmax,u=S.wsize,f=S.whave,g=S.wnext,v=S.window,m=S.hold,E=S.bits,A=S.lencode,C=S.distcode,b=(1<<S.lenbits)-1,I=(1<<S.distbits)-1;e:do{E<15&&(m+=k[r++]<<E,E+=8,m+=k[r++]<<E,E+=8),O=A[m&b];t:for(;;){if(V=O>>>24,m>>>=V,E-=V,V=O>>>16&255,V===0)N[s++]=O&65535;else if(V&16){ne=O&65535,V&=15,V&&(E<V&&(m+=k[r++]<<E,E+=8),ne+=m&(1<<V)-1,m>>>=V,E-=V),E<15&&(m+=k[r++]<<E,E+=8,m+=k[r++]<<E,E+=8),O=C[m&I];n:for(;;){if(V=O>>>24,m>>>=V,E-=V,V=O>>>16&255,V&16){if(le=O&65535,V&=15,E<V&&(m+=k[r++]<<E,E+=8,E<V&&(m+=k[r++]<<E,E+=8)),le+=m&(1<<V)-1,le>c){e.msg="invalid distance too far back",S.mode=Cf;break e}if(m>>>=V,E-=V,V=s-o,le>V){if(V=le-V,V>f&&S.sane){e.msg="invalid distance too far back",S.mode=Cf;break e}if(z=0,T=v,g===0){if(z+=u-V,V<ne){ne-=V;do N[s++]=v[z++];while(--V);z=s-le,T=N}}else if(g<V){if(z+=u+g-V,V-=g,V<ne){ne-=V;do N[s++]=v[z++];while(--V);if(z=0,g<ne){V=g,ne-=V;do N[s++]=v[z++];while(--V);z=s-le,T=N}}}else if(z+=g-V,V<ne){ne-=V;do N[s++]=v[z++];while(--V);z=s-le,T=N}for(;ne>2;)N[s++]=T[z++],N[s++]=T[z++],N[s++]=T[z++],ne-=3;ne&&(N[s++]=T[z++],ne>1&&(N[s++]=T[z++]))}else{z=s-le;do N[s++]=N[z++],N[s++]=N[z++],N[s++]=N[z++],ne-=3;while(ne>2);ne&&(N[s++]=N[z++],ne>1&&(N[s++]=N[z++]))}}else if(V&64){e.msg="invalid distance code",S.mode=Cf;break e}else{O=C[(O&65535)+(m&(1<<V)-1)];continue n}break}}else if(V&64)if(V&32){S.mode=s7;break e}else{e.msg="invalid literal/length code",S.mode=Cf;break e}else{O=A[(O&65535)+(m&(1<<V)-1)];continue t}break}}while(r<i&&s<l);ne=E>>3,r-=ne,E-=ne<<3,m&=(1<<E)-1,e.next_in=r,e.next_out=s,e.avail_in=r<i?5+(i-r):5-(r-i),e.avail_out=s<l?257+(l-s):257-(s-l),S.hold=m,S.bits=E};const Pc=15,y5=852,x5=592,b5=0,s0=1,w5=2,o7=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),l7=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),c7=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),u7=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),d7=(t,e,n,r,i,s,o,l)=>{const c=l.bits;let u=0,f=0,g=0,v=0,m=0,E=0,A=0,C=0,b=0,I=0,O,V,ne,le,z,T=null,k;const N=new Uint16Array(Pc+1),S=new Uint16Array(Pc+1);let P=null,R,$,H;for(u=0;u<=Pc;u++)N[u]=0;for(f=0;f<r;f++)N[e[n+f]]++;for(m=c,v=Pc;v>=1&&N[v]===0;v--);if(m>v&&(m=v),v===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,l.bits=1,0;for(g=1;g<v&&N[g]===0;g++);for(m<g&&(m=g),C=1,u=1;u<=Pc;u++)if(C<<=1,C-=N[u],C<0)return-1;if(C>0&&(t===b5||v!==1))return-1;for(S[1]=0,u=1;u<Pc;u++)S[u+1]=S[u]+N[u];for(f=0;f<r;f++)e[n+f]!==0&&(o[S[e[n+f]]++]=f);if(t===b5?(T=P=o,k=20):t===s0?(T=o7,P=l7,k=257):(T=c7,P=u7,k=0),I=0,f=0,u=g,z=s,E=m,A=0,ne=-1,b=1<<m,le=b-1,t===s0&&b>y5||t===w5&&b>x5)return 1;for(;;){R=u-A,o[f]+1<k?($=0,H=o[f]):o[f]>=k?($=P[o[f]-k],H=T[o[f]-k]):($=96,H=0),O=1<<u-A,V=1<<E,g=V;do V-=O,i[z+(I>>A)+V]=R<<24|$<<16|H|0;while(V!==0);for(O=1<<u-1;I&O;)O>>=1;if(O!==0?(I&=O-1,I+=O):I=0,f++,--N[u]===0){if(u===v)break;u=e[n+o[f]]}if(u>m&&(I&le)!==ne){for(A===0&&(A=m),z+=g,E=u-A,C=1<<E;E+A<v&&(C-=N[E+A],!(C<=0));)E++,C<<=1;if(b+=1<<E,t===s0&&b>y5||t===w5&&b>x5)return 1;ne=I&le,i[ne]=m<<24|E<<16|z-s|0}}return I!==0&&(i[z+I]=u-A<<24|64<<16|0),l.bits=m,0};var qd=d7;const h7=0,bS=1,wS=2,{Z_FINISH:_5,Z_BLOCK:f7,Z_TREES:If,Z_OK:gc,Z_STREAM_END:m7,Z_NEED_DICT:p7,Z_STREAM_ERROR:ys,Z_DATA_ERROR:_S,Z_MEM_ERROR:NS,Z_BUF_ERROR:g7,Z_DEFLATED:N5}=vS,eg=16180,S5=16181,E5=16182,A5=16183,j5=16184,T5=16185,k5=16186,C5=16187,I5=16188,P5=16189,lp=16190,Ua=16191,a0=16192,R5=16193,o0=16194,L5=16195,D5=16196,M5=16197,O5=16198,Pf=16199,Rf=16200,F5=16201,V5=16202,U5=16203,B5=16204,z5=16205,l0=16206,q5=16207,$5=16208,Ln=16209,SS=16210,ES=16211,v7=852,y7=592,x7=15,b7=x7,H5=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function w7(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Nc=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<eg||e.mode>ES?1:0},AS=t=>{if(Nc(t))return ys;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=eg,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(v7),e.distcode=e.distdyn=new Int32Array(y7),e.sane=1,e.back=-1,gc},jS=t=>{if(Nc(t))return ys;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,AS(t)},TS=(t,e)=>{let n;if(Nc(t))return ys;const r=t.state;return e<0?(n=0,e=-e):(n=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?ys:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,jS(t))},kS=(t,e)=>{if(!t)return ys;const n=new w7;t.state=n,n.strm=t,n.window=null,n.mode=eg;const r=TS(t,e);return r!==gc&&(t.state=null),r},_7=t=>kS(t,b7);let W5=!0,c0,u0;const N7=t=>{if(W5){c0=new Int32Array(512),u0=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(qd(bS,t.lens,0,288,c0,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;qd(wS,t.lens,0,32,u0,0,t.work,{bits:5}),W5=!1}t.lencode=c0,t.lenbits=9,t.distcode=u0,t.distbits=5},CS=(t,e,n,r)=>{let i;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(e.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(e.subarray(n-r,n-r+i),s.wnext),r-=i,r?(s.window.set(e.subarray(n-r,n),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},S7=(t,e)=>{let n,r,i,s,o,l,c,u,f,g,v,m,E,A,C=0,b,I,O,V,ne,le,z,T;const k=new Uint8Array(4);let N,S;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Nc(t)||!t.output||!t.input&&t.avail_in!==0)return ys;n=t.state,n.mode===Ua&&(n.mode=a0),o=t.next_out,i=t.output,c=t.avail_out,s=t.next_in,r=t.input,l=t.avail_in,u=n.hold,f=n.bits,g=l,v=c,T=gc;e:for(;;)switch(n.mode){case eg:if(n.wrap===0){n.mode=a0;break}for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.wrap&2&&u===35615){n.wbits===0&&(n.wbits=15),n.check=0,k[0]=u&255,k[1]=u>>>8&255,n.check=sa(n.check,k,2,0),u=0,f=0,n.mode=S5;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",n.mode=Ln;break}if((u&15)!==N5){t.msg="unknown compression method",n.mode=Ln;break}if(u>>>=4,f-=4,z=(u&15)+8,n.wbits===0&&(n.wbits=z),z>15||z>n.wbits){t.msg="invalid window size",n.mode=Ln;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=u&512?P5:Ua,u=0,f=0;break;case S5:for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.flags=u,(n.flags&255)!==N5){t.msg="unknown compression method",n.mode=Ln;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=Ln;break}n.head&&(n.head.text=u>>8&1),n.flags&512&&n.wrap&4&&(k[0]=u&255,k[1]=u>>>8&255,n.check=sa(n.check,k,2,0)),u=0,f=0,n.mode=E5;case E5:for(;f<32;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.head&&(n.head.time=u),n.flags&512&&n.wrap&4&&(k[0]=u&255,k[1]=u>>>8&255,k[2]=u>>>16&255,k[3]=u>>>24&255,n.check=sa(n.check,k,4,0)),u=0,f=0,n.mode=A5;case A5:for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.head&&(n.head.xflags=u&255,n.head.os=u>>8),n.flags&512&&n.wrap&4&&(k[0]=u&255,k[1]=u>>>8&255,n.check=sa(n.check,k,2,0)),u=0,f=0,n.mode=j5;case j5:if(n.flags&1024){for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.length=u,n.head&&(n.head.extra_len=u),n.flags&512&&n.wrap&4&&(k[0]=u&255,k[1]=u>>>8&255,n.check=sa(n.check,k,2,0)),u=0,f=0}else n.head&&(n.head.extra=null);n.mode=T5;case T5:if(n.flags&1024&&(m=n.length,m>l&&(m=l),m&&(n.head&&(z=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(s,s+m),z)),n.flags&512&&n.wrap&4&&(n.check=sa(n.check,r,m,s)),l-=m,s+=m,n.length-=m),n.length))break e;n.length=0,n.mode=k5;case k5:if(n.flags&2048){if(l===0)break e;m=0;do z=r[s+m++],n.head&&z&&n.length<65536&&(n.head.name+=String.fromCharCode(z));while(z&&m<l);if(n.flags&512&&n.wrap&4&&(n.check=sa(n.check,r,m,s)),l-=m,s+=m,z)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=C5;case C5:if(n.flags&4096){if(l===0)break e;m=0;do z=r[s+m++],n.head&&z&&n.length<65536&&(n.head.comment+=String.fromCharCode(z));while(z&&m<l);if(n.flags&512&&n.wrap&4&&(n.check=sa(n.check,r,m,s)),l-=m,s+=m,z)break e}else n.head&&(n.head.comment=null);n.mode=I5;case I5:if(n.flags&512){for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.wrap&4&&u!==(n.check&65535)){t.msg="header crc mismatch",n.mode=Ln;break}u=0,f=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=Ua;break;case P5:for(;f<32;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}t.adler=n.check=H5(u),u=0,f=0,n.mode=lp;case lp:if(n.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,n.hold=u,n.bits=f,p7;t.adler=n.check=1,n.mode=Ua;case Ua:if(e===f7||e===If)break e;case a0:if(n.last){u>>>=f&7,f-=f&7,n.mode=l0;break}for(;f<3;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}switch(n.last=u&1,u>>>=1,f-=1,u&3){case 0:n.mode=R5;break;case 1:if(N7(n),n.mode=Pf,e===If){u>>>=2,f-=2;break e}break;case 2:n.mode=D5;break;case 3:t.msg="invalid block type",n.mode=Ln}u>>>=2,f-=2;break;case R5:for(u>>>=f&7,f-=f&7;f<32;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if((u&65535)!==(u>>>16^65535)){t.msg="invalid stored block lengths",n.mode=Ln;break}if(n.length=u&65535,u=0,f=0,n.mode=o0,e===If)break e;case o0:n.mode=L5;case L5:if(m=n.length,m){if(m>l&&(m=l),m>c&&(m=c),m===0)break e;i.set(r.subarray(s,s+m),o),l-=m,s+=m,c-=m,o+=m,n.length-=m;break}n.mode=Ua;break;case D5:for(;f<14;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.nlen=(u&31)+257,u>>>=5,f-=5,n.ndist=(u&31)+1,u>>>=5,f-=5,n.ncode=(u&15)+4,u>>>=4,f-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=Ln;break}n.have=0,n.mode=M5;case M5:for(;n.have<n.ncode;){for(;f<3;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.lens[P[n.have++]]=u&7,u>>>=3,f-=3}for(;n.have<19;)n.lens[P[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,N={bits:n.lenbits},T=qd(h7,n.lens,0,19,n.lencode,0,n.work,N),n.lenbits=N.bits,T){t.msg="invalid code lengths set",n.mode=Ln;break}n.have=0,n.mode=O5;case O5:for(;n.have<n.nlen+n.ndist;){for(;C=n.lencode[u&(1<<n.lenbits)-1],b=C>>>24,I=C>>>16&255,O=C&65535,!(b<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(O<16)u>>>=b,f-=b,n.lens[n.have++]=O;else{if(O===16){for(S=b+2;f<S;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(u>>>=b,f-=b,n.have===0){t.msg="invalid bit length repeat",n.mode=Ln;break}z=n.lens[n.have-1],m=3+(u&3),u>>>=2,f-=2}else if(O===17){for(S=b+3;f<S;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}u>>>=b,f-=b,z=0,m=3+(u&7),u>>>=3,f-=3}else{for(S=b+7;f<S;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}u>>>=b,f-=b,z=0,m=11+(u&127),u>>>=7,f-=7}if(n.have+m>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=Ln;break}for(;m--;)n.lens[n.have++]=z}}if(n.mode===Ln)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=Ln;break}if(n.lenbits=9,N={bits:n.lenbits},T=qd(bS,n.lens,0,n.nlen,n.lencode,0,n.work,N),n.lenbits=N.bits,T){t.msg="invalid literal/lengths set",n.mode=Ln;break}if(n.distbits=6,n.distcode=n.distdyn,N={bits:n.distbits},T=qd(wS,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,N),n.distbits=N.bits,T){t.msg="invalid distances set",n.mode=Ln;break}if(n.mode=Pf,e===If)break e;case Pf:n.mode=Rf;case Rf:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,n.hold=u,n.bits=f,a7(t,v),o=t.next_out,i=t.output,c=t.avail_out,s=t.next_in,r=t.input,l=t.avail_in,u=n.hold,f=n.bits,n.mode===Ua&&(n.back=-1);break}for(n.back=0;C=n.lencode[u&(1<<n.lenbits)-1],b=C>>>24,I=C>>>16&255,O=C&65535,!(b<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(I&&!(I&240)){for(V=b,ne=I,le=O;C=n.lencode[le+((u&(1<<V+ne)-1)>>V)],b=C>>>24,I=C>>>16&255,O=C&65535,!(V+b<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}u>>>=V,f-=V,n.back+=V}if(u>>>=b,f-=b,n.back+=b,n.length=O,I===0){n.mode=z5;break}if(I&32){n.back=-1,n.mode=Ua;break}if(I&64){t.msg="invalid literal/length code",n.mode=Ln;break}n.extra=I&15,n.mode=F5;case F5:if(n.extra){for(S=n.extra;f<S;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,f-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=V5;case V5:for(;C=n.distcode[u&(1<<n.distbits)-1],b=C>>>24,I=C>>>16&255,O=C&65535,!(b<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(!(I&240)){for(V=b,ne=I,le=O;C=n.distcode[le+((u&(1<<V+ne)-1)>>V)],b=C>>>24,I=C>>>16&255,O=C&65535,!(V+b<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}u>>>=V,f-=V,n.back+=V}if(u>>>=b,f-=b,n.back+=b,I&64){t.msg="invalid distance code",n.mode=Ln;break}n.offset=O,n.extra=I&15,n.mode=U5;case U5:if(n.extra){for(S=n.extra;f<S;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,f-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=Ln;break}n.mode=B5;case B5:if(c===0)break e;if(m=v-c,n.offset>m){if(m=n.offset-m,m>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=Ln;break}m>n.wnext?(m-=n.wnext,E=n.wsize-m):E=n.wnext-m,m>n.length&&(m=n.length),A=n.window}else A=i,E=o-n.offset,m=n.length;m>c&&(m=c),c-=m,n.length-=m;do i[o++]=A[E++];while(--m);n.length===0&&(n.mode=Rf);break;case z5:if(c===0)break e;i[o++]=n.length,c--,n.mode=Rf;break;case l0:if(n.wrap){for(;f<32;){if(l===0)break e;l--,u|=r[s++]<<f,f+=8}if(v-=c,t.total_out+=v,n.total+=v,n.wrap&4&&v&&(t.adler=n.check=n.flags?sa(n.check,i,v,o-v):W1(n.check,i,v,o-v)),v=c,n.wrap&4&&(n.flags?u:H5(u))!==n.check){t.msg="incorrect data check",n.mode=Ln;break}u=0,f=0}n.mode=q5;case q5:if(n.wrap&&n.flags){for(;f<32;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.wrap&4&&u!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=Ln;break}u=0,f=0}n.mode=$5;case $5:T=m7;break e;case Ln:T=_S;break e;case SS:return NS;case ES:default:return ys}return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,n.hold=u,n.bits=f,(n.wsize||v!==t.avail_out&&n.mode<Ln&&(n.mode<l0||e!==_5))&&CS(t,t.output,t.next_out,v-t.avail_out),g-=t.avail_in,v-=t.avail_out,t.total_in+=g,t.total_out+=v,n.total+=v,n.wrap&4&&v&&(t.adler=n.check=n.flags?sa(n.check,i,v,t.next_out-v):W1(n.check,i,v,t.next_out-v)),t.data_type=n.bits+(n.last?64:0)+(n.mode===Ua?128:0)+(n.mode===Pf||n.mode===o0?256:0),(g===0&&v===0||e===_5)&&T===gc&&(T=g7),T},E7=t=>{if(Nc(t))return ys;let e=t.state;return e.window&&(e.window=null),t.state=null,gc},A7=(t,e)=>{if(Nc(t))return ys;const n=t.state;return n.wrap&2?(n.head=e,e.done=!1,gc):ys},j7=(t,e)=>{const n=e.length;let r,i,s;return Nc(t)||(r=t.state,r.wrap!==0&&r.mode!==lp)?ys:r.mode===lp&&(i=1,i=W1(i,e,n,0),i!==r.check)?_S:(s=CS(t,e,n,n),s?(r.mode=SS,NS):(r.havedict=1,gc))};var T7=jS,k7=TS,C7=AS,I7=_7,P7=kS,R7=S7,L7=E7,D7=A7,M7=j7,O7="pako inflate (from Nodeca project)",qa={inflateReset:T7,inflateReset2:k7,inflateResetKeep:C7,inflateInit:I7,inflateInit2:P7,inflate:R7,inflateEnd:L7,inflateGetHeader:D7,inflateSetDictionary:M7,inflateInfo:O7};function F7(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var V7=F7;const IS=Object.prototype.toString,{Z_NO_FLUSH:U7,Z_FINISH:B7,Z_OK:yh,Z_STREAM_END:d0,Z_NEED_DICT:h0,Z_STREAM_ERROR:z7,Z_DATA_ERROR:G5,Z_MEM_ERROR:q7}=vS;function Bh(t){this.options=yS.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i7,this.strm.avail_out=0;let n=qa.inflateInit2(this.strm,e.windowBits);if(n!==yh)throw new Error(G1[n]);if(this.header=new V7,qa.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=K1.string2buf(e.dictionary):IS.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=qa.inflateSetDictionary(this.strm,e.dictionary),n!==yh)))throw new Error(G1[n])}Bh.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?B7:U7,IS.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),s=qa.inflate(n,o),s===h0&&i&&(s=qa.inflateSetDictionary(n,i),s===yh?s=qa.inflate(n,o):s===G5&&(s=h0));n.avail_in>0&&s===d0&&n.state.wrap>0&&t[n.next_in]!==0;)qa.inflateReset(n),s=qa.inflate(n,o);switch(s){case z7:case G5:case h0:case q7:return this.onEnd(s),this.ended=!0,!1}if(l=n.avail_out,n.next_out&&(n.avail_out===0||s===d0))if(this.options.to==="string"){let c=K1.utf8border(n.output,n.next_out),u=n.next_out-c,f=K1.buf2string(n.output,c);n.next_out=u,n.avail_out=r-u,u&&n.output.set(n.output.subarray(c,c+u),0),this.onData(f)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(s===yh&&l===0)){if(s===d0)return s=qa.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};Bh.prototype.onData=function(t){this.chunks.push(t)};Bh.prototype.onEnd=function(t){t===yh&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=yS.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function $7(t,e){const n=new Bh(e);if(n.push(t),n.err)throw n.msg||G1[n.err];return n.result}var H7=Bh,W7=$7,G7={Inflate:H7,inflate:W7};const{Inflate:K7,inflate:Y7}=G7;var K5=K7,Q7=Y7;const PS=[];for(let t=0;t<256;t++){let e=t;for(let n=0;n<8;n++)e&1?e=3988292384^e>>>1:e=e>>>1;PS[t]=e}const Y5=4294967295;function X7(t,e,n){let r=t;for(let i=0;i<n;i++)r=PS[(r^e[i])&255]^r>>>8;return r}function J7(t,e){return(X7(Y5,t,e)^Y5)>>>0}function Q5(t,e,n){const r=t.readUint32(),i=J7(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(i!==r)throw new Error(`CRC mismatch for chunk ${n}. Expected ${r}, found ${i}`)}function RS(t,e,n){for(let r=0;r<n;r++)e[r]=t[r]}function LS(t,e,n,r){let i=0;for(;i<r;i++)e[i]=t[i];for(;i<n;i++)e[i]=t[i]+e[i-r]&255}function DS(t,e,n,r){let i=0;if(n.length===0)for(;i<r;i++)e[i]=t[i];else for(;i<r;i++)e[i]=t[i]+n[i]&255}function MS(t,e,n,r,i){let s=0;if(n.length===0){for(;s<i;s++)e[s]=t[s];for(;s<r;s++)e[s]=t[s]+(e[s-i]>>1)&255}else{for(;s<i;s++)e[s]=t[s]+(n[s]>>1)&255;for(;s<r;s++)e[s]=t[s]+(e[s-i]+n[s]>>1)&255}}function OS(t,e,n,r,i){let s=0;if(n.length===0){for(;s<i;s++)e[s]=t[s];for(;s<r;s++)e[s]=t[s]+e[s-i]&255}else{for(;s<i;s++)e[s]=t[s]+n[s]&255;for(;s<r;s++)e[s]=t[s]+Z7(e[s-i],n[s],n[s-i])&255}}function Z7(t,e,n){const r=t+e-n,i=Math.abs(r-t),s=Math.abs(r-e),o=Math.abs(r-n);return i<=s&&i<=o?t:s<=o?e:n}function eD(t,e,n,r,i,s){switch(t){case 0:RS(e,n,i);break;case 1:LS(e,n,i,s);break;case 2:DS(e,n,r,i);break;case 3:MS(e,n,r,i,s);break;case 4:OS(e,n,r,i,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const tD=new Uint16Array([255]),nD=new Uint8Array(tD.buffer),rD=nD[0]===255;function iD(t){const{data:e,width:n,height:r,channels:i,depth:s}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*i,c=new Uint8Array(r*n*l);let u=0;for(let f=0;f<7;f++){const g=o[f],v=Math.ceil((n-g.x)/g.xStep),m=Math.ceil((r-g.y)/g.yStep);if(v<=0||m<=0)continue;const E=v*l,A=new Uint8Array(E);for(let C=0;C<m;C++){const b=e[u++],I=e.subarray(u,u+E);u+=E;const O=new Uint8Array(E);eD(b,I,O,A,E,l),A.set(O);for(let V=0;V<v;V++){const ne=g.x+V*g.xStep,le=g.y+C*g.yStep;if(!(ne>=n||le>=r))for(let z=0;z<l;z++)c[(le*n+ne)*l+z]=O[V*l+z]}}}if(s===16){const f=new Uint16Array(c.buffer);if(rD)for(let g=0;g<f.length;g++)f[g]=sD(f[g]);return f}else return c}function sD(t){return(t&255)<<8|t>>8&255}const aD=new Uint16Array([255]),oD=new Uint8Array(aD.buffer),lD=oD[0]===255,cD=new Uint8Array(0);function X5(t){const{data:e,width:n,height:r,channels:i,depth:s}=t,o=Math.ceil(s/8)*i,l=Math.ceil(s/8*i*n),c=new Uint8Array(r*l);let u=cD,f=0,g,v;for(let m=0;m<r;m++){switch(g=e.subarray(f+1,f+1+l),v=c.subarray(m*l,(m+1)*l),e[f]){case 0:RS(g,v,l);break;case 1:LS(g,v,l,o);break;case 2:DS(g,v,u,l);break;case 3:MS(g,v,u,l,o);break;case 4:OS(g,v,u,l,o);break;default:throw new Error(`Unsupported filter: ${e[f]}`)}u=v,f+=l+1}if(s===16){const m=new Uint16Array(c.buffer);if(lD)for(let E=0;E<m.length;E++)m[E]=uD(m[E]);return m}else return c}function uD(t){return(t&255)<<8|t>>8&255}const om=Uint8Array.of(137,80,78,71,13,10,26,10);function J5(t){if(!dD(t.readBytes(om.length)))throw new Error("wrong PNG signature")}function dD(t){if(t.length<om.length)return!1;for(let e=0;e<om.length;e++)if(t[e]!==om[e])return!1;return!0}const hD="tEXt",fD=0,FS=new TextDecoder("latin1");function mD(t){if(gD(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const pD=/^[\u0000-\u00FF]*$/;function gD(t){if(!pD.test(t))throw new Error("invalid latin1 text")}function vD(t,e,n){const r=VS(e);t[r]=yD(e,n-r.length-1)}function VS(t){for(t.mark();t.readByte()!==fD;);const e=t.offset;t.reset();const n=FS.decode(t.readBytes(e-t.offset-1));return t.skip(1),mD(n),n}function yD(t,e){return FS.decode(t.readBytes(e))}const Hi={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},f0={UNKNOWN:-1,DEFLATE:0},Z5={UNKNOWN:-1,ADAPTIVE:0},m0={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Lf={NONE:0,BACKGROUND:1,PREVIOUS:2},p0={SOURCE:0,OVER:1};class xD extends Gy{constructor(n,r={}){super(n);dn(this,"_checkCrc");dn(this,"_inflator");dn(this,"_png");dn(this,"_apng");dn(this,"_end");dn(this,"_hasPalette");dn(this,"_palette");dn(this,"_hasTransparency");dn(this,"_transparency");dn(this,"_compressionMethod");dn(this,"_filterMethod");dn(this,"_interlaceMethod");dn(this,"_colorType");dn(this,"_isAnimated");dn(this,"_numberOfFrames");dn(this,"_numberOfPlays");dn(this,"_frames");dn(this,"_writingDataChunks");const{checkCrc:i=!1}=r;this._checkCrc=i,this._inflator=new K5,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=f0.UNKNOWN,this._filterMethod=Z5.UNKNOWN,this._interlaceMethod=m0.UNKNOWN,this._colorType=Hi.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(J5(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeChunk(n,r)}return this.decodeImage(),this._png}decodeApng(){for(J5(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(n,r)}return this.decodeApngImage(),this._apng}decodeChunk(n,r){const i=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(n);break;case"IDAT":this.decodeIDAT(n);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(n);break;case"iCCP":this.decodeiCCP(n);break;case hD:vD(this._png.text,this,n);break;case"pHYs":this.decodepHYs();break;default:this.skip(n);break}if(this.offset-i!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?Q5(this,n+4,r):this.skip(4)}decodeApngChunk(n,r){const i=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(n);break;default:this.decodeChunk(n,r),this.offset=i+n;break}if(this.offset-i!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?Q5(this,n+4,r):this.skip(4)}decodeIHDR(){const n=this._png;n.width=this.readUint32(),n.height=this.readUint32(),n.depth=bD(this.readUint8());const r=this.readUint8();this._colorType=r;let i;switch(r){case Hi.GREYSCALE:i=1;break;case Hi.TRUECOLOUR:i=3;break;case Hi.INDEXED_COLOUR:i=1;break;case Hi.GREYSCALE_ALPHA:i=2;break;case Hi.TRUECOLOUR_ALPHA:i=4;break;case Hi.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==f0.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const n={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(n)}decodePLTE(n){if(n%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${n}`);const r=n/3;this._hasPalette=!0;const i=[];this._palette=i;for(let s=0;s<r;s++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(n){this._writingDataChunks=!0;const r=n,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodeFDAT(n){this._writingDataChunks=!0;let r=n,i=this.offset+this.byteOffset;if(i+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,i,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodetRNS(n){switch(this._colorType){case Hi.GREYSCALE:case Hi.TRUECOLOUR:{if(n%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${n}`);if(n/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${n/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(n/2);for(let r=0;r<n/2;r++)this._transparency[r]=this.readUint16();break}case Hi.INDEXED_COLOUR:{if(n>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${n} vs ${this._palette.length})`);let r=0;for(;r<n;r++){const i=this.readByte();this._palette[r].push(i)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case Hi.UNKNOWN:case Hi.GREYSCALE_ALPHA:case Hi.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(n){const r=VS(this),i=this.readUint8();if(i!==f0.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const s=this.readBytes(n-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:Q7(s)}}decodepHYs(){const n=this.readUint32(),r=this.readUint32(),i=this.readByte();this._png.resolution={x:n,y:r,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let n=0;n<this._numberOfFrames;n++){const r={sequenceNumber:this._frames[n].sequenceNumber,delayNumber:this._frames[n].delayNumber,delayDenominator:this._frames[n].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(n);if(i){if(i.data=X5({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),n===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)r.data=i.data;else{const s=this._apng.frames.at(n-1);this.disposeFrame(i,s,r),this.addFrameDataToCanvas(r,i)}this._apng.frames.push(r)}}return this._apng}disposeFrame(n,r,i){switch(n.disposeOp){case Lf.NONE:break;case Lf.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*n.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)i.data[l+c]=0}break;case Lf.PREVIOUS:i.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(n,r){const i=1<<this._png.depth,s=(o,l)=>{const c=((o+r.yOffset)*this._png.width+r.xOffset+l)*this._png.channels,u=(o*r.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(r.blendOp){case p0.SOURCE:for(let o=0;o<r.height;o++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let f=0;f<this._png.channels;f++)n.data[c+f]=r.data[u+f]}break;case p0.OVER:for(let o=0;o<r.height;o++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let f=0;f<this._png.channels;f++){const g=r.data[u+this._png.channels-1]/i,v=f%(this._png.channels-1)===0?1:r.data[u+f],m=Math.floor(g*v+(1-g)*n.data[c+f]);n.data[c+f]+=m}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var r;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const n=this._isAnimated?((r=this._frames)==null?void 0:r.at(0)).data:this._inflator.result;if(this._filterMethod!==Z5.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===m0.NO_INTERLACE)this._png.data=X5({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===m0.ADAM7)this._png.data=iD({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const n=this._inflator.result,r=this._frames.at(-1);r?r.data=n:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Lf.NONE,blendOp:p0.SOURCE,data:n}),this._inflator=new K5,this._writingDataChunks=!1}}function bD(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var ew;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(ew||(ew={}));function wD(t,e){return new xD(t,e).decode()}var St=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function g0(){St.console&&typeof St.console.log=="function"&&St.console.log.apply(St.console,arguments)}var yn={log:g0,warn:function(t){St.console&&(typeof St.console.warn=="function"?St.console.warn.apply(St.console,arguments):g0.call(null,arguments))},error:function(t){St.console&&(typeof St.console.error=="function"?St.console.error.apply(St.console,arguments):g0(t))}};function v0(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){Hl(r.response,e,n)},r.onerror=function(){yn.error("could not download file")},r.send()}function tw(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Df(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Hl=St.saveAs||((typeof window>"u"?"undefined":hn(window))!=="object"||window!==St?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var r=St.URL||St.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?tw(i.href)?v0(t,e,n):Df(i,i.target="_blank"):Df(i)):(i.href=r.createObjectURL(t),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){Df(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t=="string")if(tw(t))v0(t,e,n);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout(function(){Df(r)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:hn(s)!=="object"&&(yn.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(t,n),e)}:function(t,e,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof t=="string")return v0(t,e,n);var i=t.type==="application/octet-stream",s=/constructor/i.test(St.HTMLElement)||St.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&s)&&(typeof FileReader>"u"?"undefined":hn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var f=l.result;f=o?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=f:location=f,r=null},l.readAsDataURL(t)}else{var c=St.URL||St.webkitURL,u=c.createObjectURL(t);r?r.location=u:location.href=u,r=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function US(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],r=0;r<n.length;r++){var i=n[r].re,s=n[r].process,o=i.exec(t);o&&(e=s(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var lm=St.atob.bind(St),nw=St.btoa.bind(St);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function y0(t,e){var n=t[0],r=t[1],i=t[2],s=t[3];n=Yr(n,r,i,s,e[0],7,-680876936),s=Yr(s,n,r,i,e[1],12,-389564586),i=Yr(i,s,n,r,e[2],17,606105819),r=Yr(r,i,s,n,e[3],22,-1044525330),n=Yr(n,r,i,s,e[4],7,-176418897),s=Yr(s,n,r,i,e[5],12,1200080426),i=Yr(i,s,n,r,e[6],17,-1473231341),r=Yr(r,i,s,n,e[7],22,-45705983),n=Yr(n,r,i,s,e[8],7,1770035416),s=Yr(s,n,r,i,e[9],12,-1958414417),i=Yr(i,s,n,r,e[10],17,-42063),r=Yr(r,i,s,n,e[11],22,-1990404162),n=Yr(n,r,i,s,e[12],7,1804603682),s=Yr(s,n,r,i,e[13],12,-40341101),i=Yr(i,s,n,r,e[14],17,-1502002290),n=Qr(n,r=Yr(r,i,s,n,e[15],22,1236535329),i,s,e[1],5,-165796510),s=Qr(s,n,r,i,e[6],9,-1069501632),i=Qr(i,s,n,r,e[11],14,643717713),r=Qr(r,i,s,n,e[0],20,-373897302),n=Qr(n,r,i,s,e[5],5,-701558691),s=Qr(s,n,r,i,e[10],9,38016083),i=Qr(i,s,n,r,e[15],14,-660478335),r=Qr(r,i,s,n,e[4],20,-405537848),n=Qr(n,r,i,s,e[9],5,568446438),s=Qr(s,n,r,i,e[14],9,-1019803690),i=Qr(i,s,n,r,e[3],14,-187363961),r=Qr(r,i,s,n,e[8],20,1163531501),n=Qr(n,r,i,s,e[13],5,-1444681467),s=Qr(s,n,r,i,e[2],9,-51403784),i=Qr(i,s,n,r,e[7],14,1735328473),n=Xr(n,r=Qr(r,i,s,n,e[12],20,-1926607734),i,s,e[5],4,-378558),s=Xr(s,n,r,i,e[8],11,-2022574463),i=Xr(i,s,n,r,e[11],16,1839030562),r=Xr(r,i,s,n,e[14],23,-35309556),n=Xr(n,r,i,s,e[1],4,-1530992060),s=Xr(s,n,r,i,e[4],11,1272893353),i=Xr(i,s,n,r,e[7],16,-155497632),r=Xr(r,i,s,n,e[10],23,-1094730640),n=Xr(n,r,i,s,e[13],4,681279174),s=Xr(s,n,r,i,e[0],11,-358537222),i=Xr(i,s,n,r,e[3],16,-722521979),r=Xr(r,i,s,n,e[6],23,76029189),n=Xr(n,r,i,s,e[9],4,-640364487),s=Xr(s,n,r,i,e[12],11,-421815835),i=Xr(i,s,n,r,e[15],16,530742520),n=Jr(n,r=Xr(r,i,s,n,e[2],23,-995338651),i,s,e[0],6,-198630844),s=Jr(s,n,r,i,e[7],10,1126891415),i=Jr(i,s,n,r,e[14],15,-1416354905),r=Jr(r,i,s,n,e[5],21,-57434055),n=Jr(n,r,i,s,e[12],6,1700485571),s=Jr(s,n,r,i,e[3],10,-1894986606),i=Jr(i,s,n,r,e[10],15,-1051523),r=Jr(r,i,s,n,e[1],21,-2054922799),n=Jr(n,r,i,s,e[8],6,1873313359),s=Jr(s,n,r,i,e[15],10,-30611744),i=Jr(i,s,n,r,e[6],15,-1560198380),r=Jr(r,i,s,n,e[13],21,1309151649),n=Jr(n,r,i,s,e[4],6,-145523070),s=Jr(s,n,r,i,e[11],10,-1120210379),i=Jr(i,s,n,r,e[2],15,718787259),r=Jr(r,i,s,n,e[9],21,-343485551),t[0]=Qo(n,t[0]),t[1]=Qo(r,t[1]),t[2]=Qo(i,t[2]),t[3]=Qo(s,t[3])}function tg(t,e,n,r,i,s){return e=Qo(Qo(e,t),Qo(r,s)),Qo(e<<i|e>>>32-i,n)}function Yr(t,e,n,r,i,s,o){return tg(e&n|~e&r,t,e,i,s,o)}function Qr(t,e,n,r,i,s,o){return tg(e&r|n&~r,t,e,i,s,o)}function Xr(t,e,n,r,i,s,o){return tg(e^n^r,t,e,i,s,o)}function Jr(t,e,n,r,i,s,o){return tg(n^(e|~r),t,e,i,s,o)}function BS(t){var e,n=t.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)y0(r,_D(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(y0(r,i),e=0;e<16;e++)i[e]=0;return i[14]=8*n,y0(r,i),r}function _D(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}var rw="0123456789abcdef".split("");function ND(t){for(var e="",n=0;n<4;n++)e+=rw[t>>8*n+4&15]+rw[t>>8*n&15];return e}function SD(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Y1(t){return BS(t).map(SD).join("")}var ED=function(t){for(var e=0;e<t.length;e++)t[e]=ND(t[e]);return t.join("")}(BS("hello"))!="5d41402abc4b2a76b9719d911017c592";function Qo(t,e){if(ED){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Q1(t,e){var n,r,i,s;if(t!==n){for(var o=(i=t,s=1+(256/t.length|0),new Array(s+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var f=l[c];u=(u+f+o.charCodeAt(c))%256,l[c]=l[u],l[u]=f}n=t,r=l}else l=r;var g=e.length,v=0,m=0,E="";for(c=0;c<g;c++)m=(m+(f=l[v=(v+1)%256]))%256,l[v]=l[m],l[m]=f,o=l[(l[v]+l[m])%256],E+=String.fromCharCode(e.charCodeAt(c)^o);return E}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var iw={print:4,modify:8,copy:16,"annot-forms":32};function Fc(t,e,n,r){this.v=1,this.r=2;var i=192;t.forEach(function(l){if(iw.perm!==void 0)throw new Error("Invalid permission: "+l);i+=iw[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),o=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^i)),this.encryptionKey=Y1(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Q1(this.encryptionKey,this.padding)}function Vc(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,r=0;r<n;r++){var i=t.charCodeAt(r);e+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):t[r]}return e}function sw(t){if(hn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(n,r,i){if(i=i||!1,typeof n!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(n)||(e[n]={});var s=Math.random().toString(35);return e[n][s]=[r,!!i],s},this.unsubscribe=function(n){for(var r in e)if(e[r][n])return delete e[r][n],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var s in e[n]){var o=e[n][s];try{o[0].apply(t,r)}catch(l){St.console&&yn.error("jsPDF PubSub Error",l.message,l)}o[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function cp(t){if(!(this instanceof cp))return new cp(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function zS(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Wl(t,e,n,r,i){if(!(this instanceof Wl))return new Wl(t,e,n,r,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=n,zS.call(this,r,i)}function Zc(t,e,n,r,i){if(!(this instanceof Zc))return new Zc(t,e,n,r,i);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,zS.call(this,r,i)}function lt(t){var e,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],s=arguments[3],o=[],l=1,c=16,u="S",f=null;hn(t=t||{})==="object"&&(n=t.orientation,r=t.unit||r,i=t.format||i,s=t.compress||t.compressPdf||s,(f=t.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),o=t.filters||(s===!0?["FlateEncode"]:o),r=r||"mm",n=(""+(n||"P")).toLowerCase();var g=t.putOnlyUsedFonts||!1,v={},m={internal:{},__private__:{}};m.__private__.PubSub=sw;var E="1.3",A=m.__private__.getPdfVersion=function(){return E};m.__private__.setPdfVersion=function(y){E=y};var C={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return C};var b=m.__private__.getPageFormat=function(y){return C[y]};i=i||"a4";var I="compat",O="advanced",V=I;function ne(){this.saveGraphicsState(),ae(new mt(vt,0,0,-vt,0,ss()*vt).toString()+" cm"),this.setFontSize(this.getFontSize()/vt),u="n",V=O}function le(){this.restoreGraphicsState(),u="S",V=I}var z=m.__private__.combineFontStyleAndFontWeight=function(y,B){if(y=="bold"&&B=="normal"||y=="bold"&&B==400||y=="normal"&&B=="italic"||y=="bold"&&B=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return B&&(y=B==400||B==="normal"?y==="italic"?"italic":"normal":B!=700&&B!=="bold"||y!=="normal"?(B==700?"bold":B)+""+y:"bold"),y};m.advancedAPI=function(y){var B=V===I;return B&&ne.call(this),typeof y!="function"||(y(this),B&&le.call(this)),this},m.compatAPI=function(y){var B=V===O;return B&&le.call(this),typeof y!="function"||(y(this),B&&ne.call(this)),this},m.isAdvancedAPI=function(){return V===O};var T,k=function(y){if(V!==O)throw new Error(y+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},N=m.roundToPrecision=m.__private__.roundToPrecision=function(y,B){var re=e||B;if(isNaN(y)||isNaN(re))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return y.toFixed(re).replace(/0+$/,"")};T=m.hpf=m.__private__.hpf=typeof c=="number"?function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return N(y,c)}:c==="smart"?function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return N(y,y>-1&&y<1?16:5)}:function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return N(y,16)};var S=m.f2=m.__private__.f2=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.f2");return N(y,2)},P=m.__private__.f3=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.f3");return N(y,3)},R=m.scale=m.__private__.scale=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.scale");return V===I?y*vt:V===O?y:void 0},$=function(y){return R(function(B){return V===I?ss()-B:V===O?B:void 0}(y))};m.__private__.setPrecision=m.setPrecision=function(y){typeof parseInt(y,10)=="number"&&(e=parseInt(y,10))};var H,Y="00000000000000000000000000000000",M=m.__private__.getFileId=function(){return Y},U=m.__private__.setFileId=function(y){return Y=y!==void 0&&/^[a-fA-F0-9]{32}$/.test(y)?y.toUpperCase():Y.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(on=new Fc(f.userPermissions,f.userPassword,f.ownerPassword,Y)),Y};m.setFileId=function(y){return U(y),this},m.getFileId=function(){return M()};var ee=m.__private__.convertDateToPDFDate=function(y){var B=y.getTimezoneOffset(),re=B<0?"+":"-",ce=Math.floor(Math.abs(B/60)),ge=Math.abs(B%60),Ae=[re,D(ce),"'",D(ge),"'"].join("");return["D:",y.getFullYear(),D(y.getMonth()+1),D(y.getDate()),D(y.getHours()),D(y.getMinutes()),D(y.getSeconds()),Ae].join("")},fe=m.__private__.convertPDFDateToDate=function(y){var B=parseInt(y.substr(2,4),10),re=parseInt(y.substr(6,2),10)-1,ce=parseInt(y.substr(8,2),10),ge=parseInt(y.substr(10,2),10),Ae=parseInt(y.substr(12,2),10),Ce=parseInt(y.substr(14,2),10);return new Date(B,re,ce,ge,Ae,Ce,0)},Q=m.__private__.setCreationDate=function(y){var B;if(y===void 0&&(y=new Date),y instanceof Date)B=ee(y);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(y))throw new Error("Invalid argument passed to jsPDF.setCreationDate");B=y}return H=B},w=m.__private__.getCreationDate=function(y){var B=H;return y==="jsDate"&&(B=fe(H)),B};m.setCreationDate=function(y){return Q(y),this},m.getCreationDate=function(y){return w(y)};var F,D=m.__private__.padd2=function(y){return("0"+parseInt(y)).slice(-2)},K=m.__private__.padd2Hex=function(y){return("00"+(y=y.toString())).substr(y.length)},te=0,oe=[],he=[],pe=0,ve=[],Ee=[],Ve=!1,ze=he;m.__private__.setCustomOutputDestination=function(y){Ve=!0,ze=y};var Ne=function(y){Ve||(ze=y)};m.__private__.resetCustomOutputDestination=function(){Ve=!1,ze=he};var ae=m.__private__.out=function(y){return y=y.toString(),pe+=y.length+1,ze.push(y),ze},ht=m.__private__.write=function(y){return ae(arguments.length===1?y.toString():Array.prototype.join.call(arguments," "))},et=m.__private__.getArrayBuffer=function(y){for(var B=y.length,re=new ArrayBuffer(B),ce=new Uint8Array(re);B--;)ce[B]=y.charCodeAt(B);return re},He=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return He};var Re=t.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(y){return Re=V===O?y/vt:y,this};var Xe,$e=m.__private__.getFontSize=m.getFontSize=function(){return V===I?Re:Re*vt},Oe=t.R2L||!1;m.__private__.setR2L=m.setR2L=function(y){return Oe=y,this},m.__private__.getR2L=m.getR2L=function(){return Oe};var Pe,qt=m.__private__.setZoomMode=function(y){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(y))Xe=y;else if(isNaN(y)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(y)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+y+'" is not recognized.');Xe=y}else Xe=parseInt(y,10)};m.__private__.getZoomMode=function(){return Xe};var Et,it=m.__private__.setPageMode=function(y){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(y)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+y+'" is not recognized.');Pe=y};m.__private__.getPageMode=function(){return Pe};var Tt=m.__private__.setLayoutMode=function(y){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(y)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+y+'" is not recognized.');Et=y};m.__private__.getLayoutMode=function(){return Et},m.__private__.setDisplayMode=m.setDisplayMode=function(y,B,re){return qt(y),Tt(B),it(re),this};var wt={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(y){if(Object.keys(wt).indexOf(y)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return wt[y]},m.__private__.getDocumentProperties=function(){return wt},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(y){for(var B in wt)wt.hasOwnProperty(B)&&y[B]&&(wt[B]=y[B]);return this},m.__private__.setDocumentProperty=function(y,B){if(Object.keys(wt).indexOf(y)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return wt[y]=B};var at,vt,ut,en,Gt,tt={},_t={},an=[],pt={},Dt={},At={},In={},Sn=null,nn=0,yt=[],Ot=new sw(m),zs=t.hotfixes||[],Xn={},ts={},Br=[],mt=function y(B,re,ce,ge,Ae,Ce){if(!(this instanceof y))return new y(B,re,ce,ge,Ae,Ce);isNaN(B)&&(B=1),isNaN(re)&&(re=0),isNaN(ce)&&(ce=0),isNaN(ge)&&(ge=1),isNaN(Ae)&&(Ae=0),isNaN(Ce)&&(Ce=0),this._matrix=[B,re,ce,ge,Ae,Ce]};Object.defineProperty(mt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(y){this._matrix[0]=y}}),Object.defineProperty(mt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(y){this._matrix[1]=y}}),Object.defineProperty(mt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(y){this._matrix[2]=y}}),Object.defineProperty(mt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(y){this._matrix[3]=y}}),Object.defineProperty(mt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(y){this._matrix[4]=y}}),Object.defineProperty(mt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(y){this._matrix[5]=y}}),Object.defineProperty(mt.prototype,"a",{get:function(){return this._matrix[0]},set:function(y){this._matrix[0]=y}}),Object.defineProperty(mt.prototype,"b",{get:function(){return this._matrix[1]},set:function(y){this._matrix[1]=y}}),Object.defineProperty(mt.prototype,"c",{get:function(){return this._matrix[2]},set:function(y){this._matrix[2]=y}}),Object.defineProperty(mt.prototype,"d",{get:function(){return this._matrix[3]},set:function(y){this._matrix[3]=y}}),Object.defineProperty(mt.prototype,"e",{get:function(){return this._matrix[4]},set:function(y){this._matrix[4]=y}}),Object.defineProperty(mt.prototype,"f",{get:function(){return this._matrix[5]},set:function(y){this._matrix[5]=y}}),Object.defineProperty(mt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(mt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(mt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(mt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),mt.prototype.join=function(y){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(T).join(y)},mt.prototype.multiply=function(y){var B=y.sx*this.sx+y.shy*this.shx,re=y.sx*this.shy+y.shy*this.sy,ce=y.shx*this.sx+y.sy*this.shx,ge=y.shx*this.shy+y.sy*this.sy,Ae=y.tx*this.sx+y.ty*this.shx+this.tx,Ce=y.tx*this.shy+y.ty*this.sy+this.ty;return new mt(B,re,ce,ge,Ae,Ce)},mt.prototype.decompose=function(){var y=this.sx,B=this.shy,re=this.shx,ce=this.sy,ge=this.tx,Ae=this.ty,Ce=Math.sqrt(y*y+B*B),Ge=(y/=Ce)*re+(B/=Ce)*ce;re-=y*Ge,ce-=B*Ge;var Je=Math.sqrt(re*re+ce*ce);return Ge/=Je,y*(ce/=Je)<B*(re/=Je)&&(y=-y,B=-B,Ge=-Ge,Ce=-Ce),{scale:new mt(Ce,0,0,Je,0,0),translate:new mt(1,0,0,1,ge,Ae),rotate:new mt(y,B,-B,y,0,0),skew:new mt(1,0,Ge,1,0,0)}},mt.prototype.toString=function(y){return this.join(" ")},mt.prototype.inversed=function(){var y=this.sx,B=this.shy,re=this.shx,ce=this.sy,ge=this.tx,Ae=this.ty,Ce=1/(y*ce-B*re),Ge=ce*Ce,Je=-B*Ce,gt=-re*Ce,Nt=y*Ce;return new mt(Ge,Je,gt,Nt,-Ge*ge-gt*Ae,-Je*ge-Nt*Ae)},mt.prototype.applyToPoint=function(y){var B=y.x*this.sx+y.y*this.shx+this.tx,re=y.x*this.shy+y.y*this.sy+this.ty;return new Js(B,re)},mt.prototype.applyToRectangle=function(y){var B=this.applyToPoint(y),re=this.applyToPoint(new Js(y.x+y.w,y.y+y.h));return new bo(B.x,B.y,re.x-B.x,re.y-B.y)},mt.prototype.clone=function(){var y=this.sx,B=this.shy,re=this.shx,ce=this.sy,ge=this.tx,Ae=this.ty;return new mt(y,B,re,ce,ge,Ae)},m.Matrix=mt;var En=m.matrixMult=function(y,B){return B.multiply(y)},ns=new mt(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=ns;var wr=function(y,B){if(!Dt[y]){var re=(B instanceof Wl?"Sh":"P")+(Object.keys(pt).length+1).toString(10);B.id=re,Dt[y]=re,pt[re]=B,Ot.publish("addPattern",B)}};m.ShadingPattern=Wl,m.TilingPattern=Zc,m.addShadingPattern=function(y,B){return k("addShadingPattern()"),wr(y,B),this},m.beginTilingPattern=function(y){k("beginTilingPattern()"),Zs(y.boundingBox[0],y.boundingBox[1],y.boundingBox[2]-y.boundingBox[0],y.boundingBox[3]-y.boundingBox[1],y.matrix)},m.endTilingPattern=function(y,B){k("endTilingPattern()"),B.stream=Ee[F].join(`
`),wr(y,B),Ot.publish("endTilingPattern",B),Br.pop().restore()};var _r,Pn=m.__private__.newObject=function(){var y=cr();return Rn(y,!0),y},cr=m.__private__.newObjectDeferred=function(){return te++,oe[te]=function(){return pe},te},Rn=function(y,B){return B=typeof B=="boolean"&&B,oe[y]=pe,B&&ae(y+" 0 obj"),y},Ea=m.__private__.newAdditionalObject=function(){var y={objId:cr(),content:""};return ve.push(y),y},qs=cr(),zr=cr(),Ii=m.__private__.decodeColorString=function(y){var B=y.split(" ");if(B.length!==2||B[1]!=="g"&&B[1]!=="G")B.length!==5||B[4]!=="k"&&B[4]!=="K"||(B=[(1-B[0])*(1-B[3]),(1-B[1])*(1-B[3]),(1-B[2])*(1-B[3]),"r"]);else{var re=parseFloat(B[0]);B=[re,re,re,"r"]}for(var ce="#",ge=0;ge<3;ge++)ce+=("0"+Math.floor(255*parseFloat(B[ge])).toString(16)).slice(-2);return ce},ai=m.__private__.encodeColorString=function(y){var B;typeof y=="string"&&(y={ch1:y});var re=y.ch1,ce=y.ch2,ge=y.ch3,Ae=y.ch4,Ce=y.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof re=="string"&&re.charAt(0)!=="#"){var Ge=new US(re);if(Ge.ok)re=Ge.toHex();else if(!/^\d*\.?\d*$/.test(re))throw new Error('Invalid color "'+re+'" passed to jsPDF.encodeColorString.')}if(typeof re=="string"&&/^#[0-9A-Fa-f]{3}$/.test(re)&&(re="#"+re[1]+re[1]+re[2]+re[2]+re[3]+re[3]),typeof re=="string"&&/^#[0-9A-Fa-f]{6}$/.test(re)){var Je=parseInt(re.substr(1),16);re=Je>>16&255,ce=Je>>8&255,ge=255&Je}if(ce===void 0||Ae===void 0&&re===ce&&ce===ge)B=typeof re=="string"?re+" "+Ce[0]:y.precision===2?S(re/255)+" "+Ce[0]:P(re/255)+" "+Ce[0];else if(Ae===void 0||hn(Ae)==="object"){if(Ae&&!isNaN(Ae.a)&&Ae.a===0)return["1.","1.","1.",Ce[1]].join(" ");B=typeof re=="string"?[re,ce,ge,Ce[1]].join(" "):y.precision===2?[S(re/255),S(ce/255),S(ge/255),Ce[1]].join(" "):[P(re/255),P(ce/255),P(ge/255),Ce[1]].join(" ")}else B=typeof re=="string"?[re,ce,ge,Ae,Ce[2]].join(" "):y.precision===2?[S(re),S(ce),S(ge),S(Ae),Ce[2]].join(" "):[P(re),P(ce),P(ge),P(Ae),Ce[2]].join(" ");return B},qr=m.__private__.getFilters=function(){return o},Jn=m.__private__.putStream=function(y){var B=(y=y||{}).data||"",re=y.filters||qr(),ce=y.alreadyAppliedFilters||[],ge=y.addLength1||!1,Ae=B.length,Ce=y.objectId,Ge=function(Hn){return Hn};if(f!==null&&Ce===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(Ge=on.encryptor(Ce,0));var Je={};re===!0&&(re=["FlateEncode"]);var gt=y.additionalKeyValues||[],Nt=(Je=lt.API.processDataByFilters!==void 0?lt.API.processDataByFilters(B,re):{data:B,reverseChain:[]}).reverseChain+(Array.isArray(ce)?ce.join(" "):ce.toString());if(Je.data.length!==0&&(gt.push({key:"Length",value:Je.data.length}),ge===!0&&gt.push({key:"Length1",value:Ae})),Nt.length!=0)if(Nt.split("/").length-1==1)gt.push({key:"Filter",value:Nt});else{gt.push({key:"Filter",value:"["+Nt+"]"});for(var Kt=0;Kt<gt.length;Kt+=1)if(gt[Kt].key==="DecodeParms"){for(var rn=[],Fn=0;Fn<Je.reverseChain.split("/").length-1;Fn+=1)rn.push("null");rn.push(gt[Kt].value),gt[Kt].value="["+rn.join(" ")+"]"}}ae("<<");for(var ln=0;ln<gt.length;ln++)ae("/"+gt[ln].key+" "+gt[ln].value);ae(">>"),Je.data.length!==0&&(ae("stream"),ae(Ge(Je.data)),ae("endstream"))},$s=m.__private__.putPage=function(y){var B=y.number,re=y.data,ce=y.objId,ge=y.contentsObjId;Rn(ce,!0),ae("<</Type /Page"),ae("/Parent "+y.rootDictionaryObjId+" 0 R"),ae("/Resources "+y.resourceDictionaryObjId+" 0 R"),ae("/MediaBox ["+parseFloat(T(y.mediaBox.bottomLeftX))+" "+parseFloat(T(y.mediaBox.bottomLeftY))+" "+T(y.mediaBox.topRightX)+" "+T(y.mediaBox.topRightY)+"]"),y.cropBox!==null&&ae("/CropBox ["+T(y.cropBox.bottomLeftX)+" "+T(y.cropBox.bottomLeftY)+" "+T(y.cropBox.topRightX)+" "+T(y.cropBox.topRightY)+"]"),y.bleedBox!==null&&ae("/BleedBox ["+T(y.bleedBox.bottomLeftX)+" "+T(y.bleedBox.bottomLeftY)+" "+T(y.bleedBox.topRightX)+" "+T(y.bleedBox.topRightY)+"]"),y.trimBox!==null&&ae("/TrimBox ["+T(y.trimBox.bottomLeftX)+" "+T(y.trimBox.bottomLeftY)+" "+T(y.trimBox.topRightX)+" "+T(y.trimBox.topRightY)+"]"),y.artBox!==null&&ae("/ArtBox ["+T(y.artBox.bottomLeftX)+" "+T(y.artBox.bottomLeftY)+" "+T(y.artBox.topRightX)+" "+T(y.artBox.topRightY)+"]"),typeof y.userUnit=="number"&&y.userUnit!==1&&ae("/UserUnit "+y.userUnit),Ot.publish("putPage",{objId:ce,pageContext:yt[B],pageNumber:B,page:re}),ae("/Contents "+ge+" 0 R"),ae(">>"),ae("endobj");var Ae=re.join(`
`);return V===O&&(Ae+=`
Q`),Rn(ge,!0),Jn({data:Ae,filters:qr(),objectId:ge}),ae("endobj"),ce},Pi=m.__private__.putPages=function(){var y,B,re=[];for(y=1;y<=nn;y++)yt[y].objId=cr(),yt[y].contentsObjId=cr();for(y=1;y<=nn;y++)re.push($s({number:y,data:Ee[y],objId:yt[y].objId,contentsObjId:yt[y].contentsObjId,mediaBox:yt[y].mediaBox,cropBox:yt[y].cropBox,bleedBox:yt[y].bleedBox,trimBox:yt[y].trimBox,artBox:yt[y].artBox,userUnit:yt[y].userUnit,rootDictionaryObjId:qs,resourceDictionaryObjId:zr}));Rn(qs,!0),ae("<</Type /Pages");var ce="/Kids [";for(B=0;B<nn;B++)ce+=re[B]+" 0 R ";ae(ce+"]"),ae("/Count "+nn),ae(">>"),ae("endobj"),Ot.publish("postPutPages")},xs=function(y){Ot.publish("putFont",{font:y,out:ae,newObject:Pn,putStream:Jn}),y.isAlreadyPutted!==!0&&(y.objectNumber=Pn(),ae("<<"),ae("/Type /Font"),ae("/BaseFont /"+Vc(y.postScriptName)),ae("/Subtype /Type1"),typeof y.encoding=="string"&&ae("/Encoding /"+y.encoding),ae("/FirstChar 32"),ae("/LastChar 255"),ae(">>"),ae("endobj"))},Hs=function(y){y.objectNumber=Pn();var B=[];B.push({key:"Type",value:"/XObject"}),B.push({key:"Subtype",value:"/Form"}),B.push({key:"BBox",value:"["+[T(y.x),T(y.y),T(y.x+y.width),T(y.y+y.height)].join(" ")+"]"}),B.push({key:"Matrix",value:"["+y.matrix.toString()+"]"});var re=y.pages[1].join(`
`);Jn({data:re,additionalKeyValues:B,objectId:y.objectNumber}),ae("endobj")},Aa=function(y,B){B||(B=21);var re=Pn(),ce=function(Ce,Ge){var Je,gt=[],Nt=1/(Ge-1);for(Je=0;Je<1;Je+=Nt)gt.push(Je);if(gt.push(1),Ce[0].offset!=0){var Kt={offset:0,color:Ce[0].color};Ce.unshift(Kt)}if(Ce[Ce.length-1].offset!=1){var rn={offset:1,color:Ce[Ce.length-1].color};Ce.push(rn)}for(var Fn="",ln=0,Hn=0;Hn<gt.length;Hn++){for(Je=gt[Hn];Je>Ce[ln+1].offset;)ln++;var Vn=Ce[ln].offset,Wn=(Je-Vn)/(Ce[ln+1].offset-Vn),bn=Ce[ln].color,kr=Ce[ln+1].color;Fn+=K(Math.round((1-Wn)*bn[0]+Wn*kr[0]).toString(16))+K(Math.round((1-Wn)*bn[1]+Wn*kr[1]).toString(16))+K(Math.round((1-Wn)*bn[2]+Wn*kr[2]).toString(16))}return Fn.trim()}(y.colors,B),ge=[];ge.push({key:"FunctionType",value:"0"}),ge.push({key:"Domain",value:"[0.0 1.0]"}),ge.push({key:"Size",value:"["+B+"]"}),ge.push({key:"BitsPerSample",value:"8"}),ge.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ge.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Jn({data:ce,additionalKeyValues:ge,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:re}),ae("endobj"),y.objectNumber=Pn(),ae("<< /ShadingType "+y.type),ae("/ColorSpace /DeviceRGB");var Ae="/Coords ["+T(parseFloat(y.coords[0]))+" "+T(parseFloat(y.coords[1]))+" ";y.type===2?Ae+=T(parseFloat(y.coords[2]))+" "+T(parseFloat(y.coords[3])):Ae+=T(parseFloat(y.coords[2]))+" "+T(parseFloat(y.coords[3]))+" "+T(parseFloat(y.coords[4]))+" "+T(parseFloat(y.coords[5])),ae(Ae+="]"),y.matrix&&ae("/Matrix ["+y.matrix.toString()+"]"),ae("/Function "+re+" 0 R"),ae("/Extend [true true]"),ae(">>"),ae("endobj")},ja=function(y,B){var re=cr(),ce=Pn();B.push({resourcesOid:re,objectOid:ce}),y.objectNumber=ce;var ge=[];ge.push({key:"Type",value:"/Pattern"}),ge.push({key:"PatternType",value:"1"}),ge.push({key:"PaintType",value:"1"}),ge.push({key:"TilingType",value:"1"}),ge.push({key:"BBox",value:"["+y.boundingBox.map(T).join(" ")+"]"}),ge.push({key:"XStep",value:T(y.xStep)}),ge.push({key:"YStep",value:T(y.yStep)}),ge.push({key:"Resources",value:re+" 0 R"}),y.matrix&&ge.push({key:"Matrix",value:"["+y.matrix.toString()+"]"}),Jn({data:y.stream,additionalKeyValues:ge,objectId:y.objectNumber}),ae("endobj")},Uu=function(y){for(var B in y.objectNumber=Pn(),ae("<<"),y)switch(B){case"opacity":ae("/ca "+S(y[B]));break;case"stroke-opacity":ae("/CA "+S(y[B]))}ae(">>"),ae("endobj")},Ws=function(y){Rn(y.resourcesOid,!0),ae("<<"),ae("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var B in ae("/Font <<"),tt)tt.hasOwnProperty(B)&&(g===!1||g===!0&&v.hasOwnProperty(B))&&ae("/"+B+" "+tt[B].objectNumber+" 0 R");ae(">>")}(),function(){if(Object.keys(pt).length>0){for(var B in ae("/Shading <<"),pt)pt.hasOwnProperty(B)&&pt[B]instanceof Wl&&pt[B].objectNumber>=0&&ae("/"+B+" "+pt[B].objectNumber+" 0 R");Ot.publish("putShadingPatternDict"),ae(">>")}}(),function(B){if(Object.keys(pt).length>0){for(var re in ae("/Pattern <<"),pt)pt.hasOwnProperty(re)&&pt[re]instanceof m.TilingPattern&&pt[re].objectNumber>=0&&pt[re].objectNumber<B&&ae("/"+re+" "+pt[re].objectNumber+" 0 R");Ot.publish("putTilingPatternDict"),ae(">>")}}(y.objectOid),function(){if(Object.keys(At).length>0){var B;for(B in ae("/ExtGState <<"),At)At.hasOwnProperty(B)&&At[B].objectNumber>=0&&ae("/"+B+" "+At[B].objectNumber+" 0 R");Ot.publish("putGStateDict"),ae(">>")}}(),function(){for(var B in ae("/XObject <<"),Xn)Xn.hasOwnProperty(B)&&Xn[B].objectNumber>=0&&ae("/"+B+" "+Xn[B].objectNumber+" 0 R");Ot.publish("putXobjectDict"),ae(">>")}(),ae(">>"),ae("endobj")},_l=function(y){_t[y.fontName]=_t[y.fontName]||{},_t[y.fontName][y.fontStyle]=y.id},fo=function(y,B,re,ce,ge){var Ae={id:"F"+(Object.keys(tt).length+1).toString(10),postScriptName:y,fontName:B,fontStyle:re,encoding:ce,isStandardFont:ge||!1,metadata:{}};return Ot.publish("addFont",{font:Ae,instance:this}),tt[Ae.id]=Ae,_l(Ae),Ae.id},Nr=m.__private__.pdfEscape=m.pdfEscape=function(y,B){return function(re,ce){var ge,Ae,Ce,Ge,Je,gt,Nt,Kt,rn;if(Ce=(ce=ce||{}).sourceEncoding||"Unicode",Je=ce.outputEncoding,(ce.autoencode||Je)&&tt[at].metadata&&tt[at].metadata[Ce]&&tt[at].metadata[Ce].encoding&&(Ge=tt[at].metadata[Ce].encoding,!Je&&tt[at].encoding&&(Je=tt[at].encoding),!Je&&Ge.codePages&&(Je=Ge.codePages[0]),typeof Je=="string"&&(Je=Ge[Je]),Je)){for(Nt=!1,gt=[],ge=0,Ae=re.length;ge<Ae;ge++)(Kt=Je[re.charCodeAt(ge)])?gt.push(String.fromCharCode(Kt)):gt.push(re[ge]),gt[ge].charCodeAt(0)>>8&&(Nt=!0);re=gt.join("")}for(ge=re.length;Nt===void 0&&ge!==0;)re.charCodeAt(ge-1)>>8&&(Nt=!0),ge--;if(!Nt)return re;for(gt=ce.noBOM?[]:[254,255],ge=0,Ae=re.length;ge<Ae;ge++){if((rn=(Kt=re.charCodeAt(ge))>>8)>>8)throw new Error("Character at position "+ge+" of string '"+re+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");gt.push(rn),gt.push(Kt-(rn<<8))}return String.fromCharCode.apply(void 0,gt)}(y,B).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ri=m.__private__.beginPage=function(y){Ee[++nn]=[],yt[nn]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(y[0]),topRightY:Number(y[1])}},Sl(nn),Ne(Ee[F])},mo=function(y,B){var re,ce,ge;switch(n=B||n,typeof y=="string"&&(re=b(y.toLowerCase()),Array.isArray(re)&&(ce=re[0],ge=re[1])),Array.isArray(y)&&(ce=y[0]*vt,ge=y[1]*vt),isNaN(ce)&&(ce=i[0],ge=i[1]),(ce>14400||ge>14400)&&(yn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ce=Math.min(14400,ce),ge=Math.min(14400,ge)),i=[ce,ge],n.substr(0,1)){case"l":ge>ce&&(i=[ge,ce]);break;case"p":ce>ge&&(i=[ge,ce])}Ri(i),Xs(vo),ae(_s),pn!==0&&ae(pn+" J"),Pl!==0&&ae(Pl+" j"),Ot.publish("addPage",{pageNumber:nn})},Nl=function(y){y>0&&y<=nn&&(Ee.splice(y,1),yt.splice(y,1),nn--,F>nn&&(F=nn),this.setPage(F))},Sl=function(y){y>0&&y<=nn&&(F=y)},El=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return Ee.length-1},Al=function(y,B,re){var ce,ge=void 0;return re=re||{},y=y!==void 0?y:tt[at].fontName,B=B!==void 0?B:tt[at].fontStyle,ce=y.toLowerCase(),_t[ce]!==void 0&&_t[ce][B]!==void 0?ge=_t[ce][B]:_t[y]!==void 0&&_t[y][B]!==void 0?ge=_t[y][B]:re.disableWarning===!1&&yn.warn("Unable to look up font label for font '"+y+"', '"+B+"'. Refer to getFontList() for available fonts."),ge||re.noFallback||(ge=_t.times[B])==null&&(ge=_t.times.normal),ge},Gs=m.__private__.putInfo=function(){var y=Pn(),B=function(ce){return ce};for(var re in f!==null&&(B=on.encryptor(y,0)),ae("<<"),ae("/Producer ("+Nr(B("jsPDF "+lt.version))+")"),wt)wt.hasOwnProperty(re)&&wt[re]&&ae("/"+re.substr(0,1).toUpperCase()+re.substr(1)+" ("+Nr(B(wt[re]))+")");ae("/CreationDate ("+Nr(B(H))+")"),ae(">>"),ae("endobj")},jl=m.__private__.putCatalog=function(y){var B=(y=y||{}).rootDictionaryObjId||qs;switch(Pn(),ae("<<"),ae("/Type /Catalog"),ae("/Pages "+B+" 0 R"),Xe||(Xe="fullwidth"),Xe){case"fullwidth":ae("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ae("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ae("/OpenAction [3 0 R /Fit]");break;case"original":ae("/OpenAction [3 0 R /XYZ null null 1]");break;default:var re=""+Xe;re.substr(re.length-1)==="%"&&(Xe=parseInt(Xe)/100),typeof Xe=="number"&&ae("/OpenAction [3 0 R /XYZ null null "+S(Xe)+"]")}switch(Et||(Et="continuous"),Et){case"continuous":ae("/PageLayout /OneColumn");break;case"single":ae("/PageLayout /SinglePage");break;case"two":case"twoleft":ae("/PageLayout /TwoColumnLeft");break;case"tworight":ae("/PageLayout /TwoColumnRight")}Pe&&ae("/PageMode /"+Pe),Ot.publish("putCatalog"),ae(">>"),ae("endobj")},On=m.__private__.putTrailer=function(){ae("trailer"),ae("<<"),ae("/Size "+(te+1)),ae("/Root "+te+" 0 R"),ae("/Info "+(te-1)+" 0 R"),f!==null&&ae("/Encrypt "+on.oid+" 0 R"),ae("/ID [ <"+Y+"> <"+Y+"> ]"),ae(">>")},Tl=m.__private__.putHeader=function(){ae("%PDF-"+E),ae("%")},Ec=m.__private__.putXRef=function(){var y="0000000000";ae("xref"),ae("0 "+(te+1)),ae("0000000000 65535 f ");for(var B=1;B<=te;B++)typeof oe[B]=="function"?ae((y+oe[B]()).slice(-10)+" 00000 n "):oe[B]!==void 0?ae((y+oe[B]).slice(-10)+" 00000 n "):ae("0000000000 00000 n ")},bs=m.__private__.buildDocument=function(){var y;te=0,pe=0,he=[],oe=[],ve=[],qs=cr(),zr=cr(),Ne(he),Ot.publish("buildDocument"),Tl(),Pi(),function(){Ot.publish("putAdditionalObjects");for(var re=0;re<ve.length;re++){var ce=ve[re];Rn(ce.objId,!0),ae(ce.content),ae("endobj")}Ot.publish("postPutAdditionalObjects")}(),y=[],function(){for(var re in tt)tt.hasOwnProperty(re)&&(g===!1||g===!0&&v.hasOwnProperty(re))&&xs(tt[re])}(),function(){var re;for(re in At)At.hasOwnProperty(re)&&Uu(At[re])}(),function(){for(var re in Xn)Xn.hasOwnProperty(re)&&Hs(Xn[re])}(),function(re){var ce;for(ce in pt)pt.hasOwnProperty(ce)&&(pt[ce]instanceof Wl?Aa(pt[ce]):pt[ce]instanceof Zc&&ja(pt[ce],re))}(y),Ot.publish("putResources"),y.forEach(Ws),Ws({resourcesOid:zr,objectOid:Number.MAX_SAFE_INTEGER}),Ot.publish("postPutResources"),f!==null&&(on.oid=Pn(),ae("<<"),ae("/Filter /Standard"),ae("/V "+on.v),ae("/R "+on.r),ae("/U <"+on.toHexString(on.U)+">"),ae("/O <"+on.toHexString(on.O)+">"),ae("/P "+on.P),ae(">>"),ae("endobj")),Gs(),jl();var B=pe;return Ec(),On(),ae("startxref"),ae(""+B),ae("%%EOF"),Ne(Ee[F]),he.join(`
`)},Ks=m.__private__.getBlob=function(y){return new Blob([et(y)],{type:"application/pdf"})},gi=m.output=m.__private__.output=(_r=function(y,B){switch(typeof(B=B||{})=="string"?B={filename:B}:B.filename=B.filename||"generated.pdf",y){case void 0:return bs();case"save":m.save(B.filename);break;case"arraybuffer":return et(bs());case"blob":return Ks(bs());case"bloburi":case"bloburl":if(St.URL!==void 0&&typeof St.URL.createObjectURL=="function")return St.URL&&St.URL.createObjectURL(Ks(bs()))||void 0;yn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var re="",ce=bs();try{re=nw(ce)}catch{re=nw(unescape(encodeURIComponent(ce)))}return"data:application/pdf;filename="+B.filename+";base64,"+re;case"pdfobjectnewwindow":if(Object.prototype.toString.call(St)==="[object Window]"){var ge="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ae=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';B.pdfObjectUrl&&(ge=B.pdfObjectUrl,Ae="");var Ce='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ge+'"'+Ae+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(B)+");<\/script></body></html>",Ge=St.open();return Ge!==null&&Ge.document.write(Ce),Ge}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(St)==="[object Window]"){var Je='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(B.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+B.filename+'" width="500px" height="400px" /></body></html>',gt=St.open();if(gt!==null){gt.document.write(Je);var Nt=this;gt.document.documentElement.querySelector("#pdfViewer").onload=function(){gt.document.title=B.filename,gt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Nt.output("bloburl"))}}return gt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(St)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Kt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",B)+'"></iframe></body></html>',rn=St.open();if(rn!==null&&(rn.document.write(Kt),rn.document.title=B.filename),rn||typeof safari>"u")return rn;break;case"datauri":case"dataurl":return St.document.location.href=this.output("datauristring",B);default:return null}},_r.foo=function(){try{return _r.apply(this,arguments)}catch(re){var y=re.stack||"";~y.indexOf(" at ")&&(y=y.split(" at ")[1]);var B="Error in function "+y.split(`
`)[0].split("<")[0]+": "+re.message;if(!St.console)throw new Error(B);St.console.error(B,re),St.alert&&alert(B)}},_r.foo.bar=_r,_r.foo),Ta=function(y){return Array.isArray(zs)===!0&&zs.indexOf(y)>-1};switch(r){case"pt":vt=1;break;case"mm":vt=72/25.4;break;case"cm":vt=72/2.54;break;case"in":vt=72;break;case"px":vt=Ta("px_scaling")==1?.75:96/72;break;case"pc":case"em":vt=12;break;case"ex":vt=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);vt=r}var on=null;Q(),U();var oi=m.__private__.getPageInfo=m.getPageInfo=function(y){if(isNaN(y)||y%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:yt[y].objId,pageNumber:y,pageContext:yt[y]}},po=m.__private__.getPageInfoByObjId=function(y){if(isNaN(y)||y%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var B in yt)if(yt[B].objId===y)break;return oi(B)},go=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:yt[F].objId,pageNumber:F,pageContext:yt[F]}};m.addPage=function(){return mo.apply(this,arguments),this},m.setPage=function(){return Sl.apply(this,arguments),Ne.call(this,Ee[F]),this},m.insertPage=function(y){return this.addPage(),this.movePage(F,y),this},m.movePage=function(y,B){var re,ce;if(y>B){re=Ee[y],ce=yt[y];for(var ge=y;ge>B;ge--)Ee[ge]=Ee[ge-1],yt[ge]=yt[ge-1];Ee[B]=re,yt[B]=ce,this.setPage(B)}else if(y<B){re=Ee[y],ce=yt[y];for(var Ae=y;Ae<B;Ae++)Ee[Ae]=Ee[Ae+1],yt[Ae]=yt[Ae+1];Ee[B]=re,yt[B]=ce,this.setPage(B)}return this},m.deletePage=function(){return Nl.apply(this,arguments),this},m.__private__.text=m.text=function(y,B,re,ce,ge){var Ae,Ce,Ge,Je,gt,Nt,Kt,rn,Fn,ln=(ce=ce||{}).scope||this;if(typeof y=="number"&&typeof B=="number"&&(typeof re=="string"||Array.isArray(re))){var Hn=re;re=B,B=y,y=Hn}if(arguments[3]instanceof mt==0?(Ge=arguments[4],Je=arguments[5],hn(Kt=arguments[3])==="object"&&Kt!==null||(typeof Ge=="string"&&(Je=Ge,Ge=null),typeof Kt=="string"&&(Je=Kt,Kt=null),typeof Kt=="number"&&(Ge=Kt,Kt=null),ce={flags:Kt,angle:Ge,align:Je})):(k("The transform parameter of text() with a Matrix value"),Fn=ge),isNaN(B)||isNaN(re)||y==null)throw new Error("Invalid arguments passed to jsPDF.text");if(y.length===0)return ln;var Vn,Wn="",bn=typeof ce.lineHeightFactor=="number"?ce.lineHeightFactor:Qs,kr=ln.internal.scaleFactor;function Ml(sn){return sn=sn.split("	").join(Array(ce.TabLen||9).join(" ")),Nr(sn,Kt)}function Di(sn){for(var gn,er=sn.concat(),mr=[],Da=er.length;Da--;)typeof(gn=er.shift())=="string"?mr.push(gn):Array.isArray(sn)&&(gn.length===1||gn[1]===void 0&&gn[2]===void 0)?mr.push(gn[0]):mr.push([gn[0],gn[1],gn[2]]);return mr}function h(sn,gn){var er;if(typeof sn=="string")er=gn(sn)[0];else if(Array.isArray(sn)){for(var mr,Da,ed=sn.concat(),kc=[],qh=ed.length;qh--;)typeof(mr=ed.shift())=="string"?kc.push(gn(mr)[0]):Array.isArray(mr)&&typeof mr[0]=="string"&&(Da=gn(mr[0],mr[1],mr[2]),kc.push([Da[0],Da[1],Da[2]]));er=kc}return er}var _=!1,L=!0;if(typeof y=="string")_=!0;else if(Array.isArray(y)){var J=y.concat();Ce=[];for(var ye,_e=J.length;_e--;)(typeof(ye=J.shift())!="string"||Array.isArray(ye)&&typeof ye[0]!="string")&&(L=!1);_=L}if(_===!1)throw new Error('Type of text must be string or Array. "'+y+'" is not recognized.');typeof y=="string"&&(y=y.match(/[\r?\n]/)?y.split(/\r\n|\r|\n/g):[y]);var Be=Re/ln.internal.scaleFactor,$t=Be*(bn-1);switch(ce.baseline){case"bottom":re-=$t;break;case"top":re+=Be-$t;break;case"hanging":re+=Be-2*$t;break;case"middle":re+=Be/2-$t}if((Nt=ce.maxWidth||0)>0&&(typeof y=="string"?y=ln.splitTextToSize(y,Nt):Object.prototype.toString.call(y)==="[object Array]"&&(y=y.reduce(function(sn,gn){return sn.concat(ln.splitTextToSize(gn,Nt))},[]))),Ae={text:y,x:B,y:re,options:ce,mutex:{pdfEscape:Nr,activeFontKey:at,fonts:tt,activeFontSize:Re}},Ot.publish("preProcessText",Ae),y=Ae.text,Ge=(ce=Ae.options).angle,Fn instanceof mt==0&&Ge&&typeof Ge=="number"){Ge*=Math.PI/180,ce.rotationDirection===0&&(Ge=-Ge),V===O&&(Ge=-Ge);var Un=Math.cos(Ge),Ft=Math.sin(Ge);Fn=new mt(Un,Ft,-Ft,Un,0,0)}else Ge&&Ge instanceof mt&&(Fn=Ge);V!==O||Fn||(Fn=ns),(gt=ce.charSpace||Ia)!==void 0&&(Wn+=T(R(gt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(rn=ce.horizontalScale)!==void 0&&(Wn+=T(100*rn)+` Tz
`),ce.lang;var Mt=-1,wn=ce.renderingMode!==void 0?ce.renderingMode:ce.stroke,Mi=ln.internal.getCurrentPageInfo().pageContext;switch(wn){case 0:case!1:case"fill":Mt=0;break;case 1:case!0:case"stroke":Mt=1;break;case 2:case"fillThenStroke":Mt=2;break;case 3:case"invisible":Mt=3;break;case 4:case"fillAndAddForClipping":Mt=4;break;case 5:case"strokeAndAddPathForClipping":Mt=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Mt=6;break;case 7:case"addToPathForClipping":Mt=7}var $r=Mi.usedRenderingMode!==void 0?Mi.usedRenderingMode:-1;Mt!==-1?Wn+=Mt+` Tr
`:$r!==-1&&(Wn+=`0 Tr
`),Mt!==-1&&(Mi.usedRenderingMode=Mt),Je=ce.align||"left";var Cr,Ss=Re*bn,Gu=ln.internal.pageSize.getWidth(),Ku=tt[at];gt=ce.charSpace||Ia,Nt=ce.maxWidth||0,Kt=Object.assign({autoencode:!0,noBOM:!0},ce.flags);var _o=[],Ol=function(sn){return ln.getStringUnitWidth(sn,{font:Ku,charSpace:gt,fontSize:Re,doKerning:!1})*Re/kr};if(Object.prototype.toString.call(y)==="[object Array]"){var Oi;Ce=Di(y),Je!=="left"&&(Cr=Ce.map(Ol));var Fi,No=0;if(Je==="right"){B-=Cr[0],y=[],_e=Ce.length;for(var La=0;La<_e;La++)La===0?(Fi=Sr(B),Oi=ws(re)):(Fi=R(No-Cr[La]),Oi=-Ss),y.push([Ce[La],Fi,Oi]),No=Cr[La]}else if(Je==="center"){B-=Cr[0]/2,y=[],_e=Ce.length;for(var So=0;So<_e;So++)So===0?(Fi=Sr(B),Oi=ws(re)):(Fi=R((No-Cr[So])/2),Oi=-Ss),y.push([Ce[So],Fi,Oi]),No=Cr[So]}else if(Je==="left"){y=[],_e=Ce.length;for(var Yu=0;Yu<_e;Yu++)y.push(Ce[Yu])}else if(Je==="justify"&&Ku.encoding==="Identity-H"){y=[],_e=Ce.length,Nt=Nt!==0?Nt:Gu;for(var Tc=0,Zn=0;Zn<_e;Zn++)if(Oi=Zn===0?ws(re):-Ss,Fi=Zn===0?Sr(B):Tc,Zn<_e-1){var zh=R((Nt-Cr[Zn])/(Ce[Zn].split(" ").length-1)),ta=Ce[Zn].split(" ");y.push([ta[0]+" ",Fi,Oi]),Tc=0;for(var na=1;na<ta.length;na++){var Qu=(Ol(ta[na-1]+" "+ta[na])-Ol(ta[na]))*kr+zh;na==ta.length-1?y.push([ta[na],Qu,0]):y.push([ta[na]+" ",Qu,0]),Tc-=Qu}}else y.push([Ce[Zn],Fi,Oi]);y.push(["",Tc,0])}else{if(Je!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(y=[],_e=Ce.length,Nt=Nt!==0?Nt:Gu,Zn=0;Zn<_e;Zn++){Oi=Zn===0?ws(re):-Ss,Fi=Zn===0?Sr(B):0;var Xu=Ce[Zn].split(" ").length-1,Ju=Xu>0?(Nt-Cr[Zn])/Xu:0;Zn<_e-1?_o.push(T(R(Ju))):_o.push(0),y.push([Ce[Zn],Fi,Oi])}}}(typeof ce.R2L=="boolean"?ce.R2L:Oe)===!0&&(y=h(y,function(sn,gn,er){return[sn.split("").reverse().join(""),gn,er]})),Ae={text:y,x:B,y:re,options:ce,mutex:{pdfEscape:Nr,activeFontKey:at,fonts:tt,activeFontSize:Re}},Ot.publish("postProcessText",Ae),y=Ae.text,Vn=Ae.mutex.isHex||!1;var Zu=tt[at].encoding;Zu!=="WinAnsiEncoding"&&Zu!=="StandardEncoding"||(y=h(y,function(sn,gn,er){return[Ml(sn),gn,er]})),Ce=Di(y),y=[];for(var Eo,Ao,jo,Fl=Array.isArray(Ce[0])?1:0,To="",Vl=function(sn,gn,er){var mr="";return er instanceof mt?(er=typeof ce.angle=="number"?En(er,new mt(1,0,0,1,sn,gn)):En(new mt(1,0,0,1,sn,gn),er),V===O&&(er=En(new mt(1,0,0,-1,0,0),er)),mr=er.join(" ")+` Tm
`):mr=T(sn)+" "+T(gn)+` Td
`,mr},as=0;as<Ce.length;as++){switch(To="",Fl){case 1:jo=(Vn?"<":"(")+Ce[as][0]+(Vn?">":")"),Eo=parseFloat(Ce[as][1]),Ao=parseFloat(Ce[as][2]);break;case 0:jo=(Vn?"<":"(")+Ce[as]+(Vn?">":")"),Eo=Sr(B),Ao=ws(re)}_o!==void 0&&_o[as]!==void 0&&(To=_o[as]+` Tw
`),as===0?y.push(To+Vl(Eo,Ao,Fn)+jo):Fl===0?y.push(To+jo):Fl===1&&y.push(To+Vl(Eo,Ao,Fn)+jo)}y=Fl===0?y.join(` Tj
T* `):y.join(` Tj
`),y+=` Tj
`;var ra=`BT
/`;return ra+=at+" "+Re+` Tf
`,ra+=T(Re*bn)+` TL
`,ra+=Li+`
`,ra+=Wn,ra+=y,ae(ra+="ET"),v[at]=!0,ln};var Ac=m.__private__.clip=m.clip=function(y){return ae(y==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return Ac("evenodd")},m.__private__.discardPath=m.discardPath=function(){return ae("n"),this};var Ut=m.__private__.isValidStyle=function(y){var B=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(y)!==-1&&(B=!0),B};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(y){return Ut(y)&&(u=y),this};var ka=m.__private__.getStyle=m.getStyle=function(y){var B=u;switch(y){case"D":case"S":B="S";break;case"F":B="f";break;case"FD":case"DF":B="B";break;case"f":case"f*":case"B":case"B*":B=y}return B},Ys=m.close=function(){return ae("h"),this};m.stroke=function(){return ae("S"),this},m.fill=function(y){return vi("f",y),this},m.fillEvenOdd=function(y){return vi("f*",y),this},m.fillStroke=function(y){return vi("B",y),this},m.fillStrokeEvenOdd=function(y){return vi("B*",y),this};var vi=function(y,B){hn(B)==="object"?Bu(B,y):ae(y)},kl=function(y){y===null||V===O&&y===void 0||(y=ka(y),ae(y))};function jc(y,B,re,ce,ge){var Ae=new Zc(B||this.boundingBox,re||this.xStep,ce||this.yStep,this.gState,ge||this.matrix);Ae.stream=this.stream;var Ce=y+"$$"+this.cloneIndex+++"$$";return wr(Ce,Ae),Ae}var Bu=function(y,B){var re=Dt[y.key],ce=pt[re];if(ce instanceof Wl)ae("q"),ae(zu(B)),ce.gState&&m.setGState(ce.gState),ae(y.matrix.toString()+" cm"),ae("/"+re+" sh"),ae("Q");else if(ce instanceof Zc){var ge=new mt(1,0,0,-1,0,ss());y.matrix&&(ge=ge.multiply(y.matrix||ns),re=jc.call(ce,y.key,y.boundingBox,y.xStep,y.yStep,ge).id),ae("q"),ae("/Pattern cs"),ae("/"+re+" scn"),ce.gState&&m.setGState(ce.gState),ae(B),ae("Q")}},zu=function(y){switch(y){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Cl=m.moveTo=function(y,B){return ae(T(R(y))+" "+T($(B))+" m"),this},Ca=m.lineTo=function(y,B){return ae(T(R(y))+" "+T($(B))+" l"),this},yi=m.curveTo=function(y,B,re,ce,ge,Ae){return ae([T(R(y)),T($(B)),T(R(re)),T($(ce)),T(R(ge)),T($(Ae)),"c"].join(" ")),this};m.__private__.line=m.line=function(y,B,re,ce,ge){if(isNaN(y)||isNaN(B)||isNaN(re)||isNaN(ce)||!Ut(ge))throw new Error("Invalid arguments passed to jsPDF.line");return V===I?this.lines([[re-y,ce-B]],y,B,[1,1],ge||"S"):this.lines([[re-y,ce-B]],y,B,[1,1]).stroke()},m.__private__.lines=m.lines=function(y,B,re,ce,ge,Ae){var Ce,Ge,Je,gt,Nt,Kt,rn,Fn,ln,Hn,Vn,Wn;if(typeof y=="number"&&(Wn=re,re=B,B=y,y=Wn),ce=ce||[1,1],Ae=Ae||!1,isNaN(B)||isNaN(re)||!Array.isArray(y)||!Array.isArray(ce)||!Ut(ge)||typeof Ae!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Cl(B,re),Ce=ce[0],Ge=ce[1],gt=y.length,Hn=B,Vn=re,Je=0;Je<gt;Je++)(Nt=y[Je]).length===2?(Hn=Nt[0]*Ce+Hn,Vn=Nt[1]*Ge+Vn,Ca(Hn,Vn)):(Kt=Nt[0]*Ce+Hn,rn=Nt[1]*Ge+Vn,Fn=Nt[2]*Ce+Hn,ln=Nt[3]*Ge+Vn,Hn=Nt[4]*Ce+Hn,Vn=Nt[5]*Ge+Vn,yi(Kt,rn,Fn,ln,Hn,Vn));return Ae&&Ys(),kl(ge),this},m.path=function(y){for(var B=0;B<y.length;B++){var re=y[B],ce=re.c;switch(re.op){case"m":Cl(ce[0],ce[1]);break;case"l":Ca(ce[0],ce[1]);break;case"c":yi.apply(this,ce);break;case"h":Ys()}}return this},m.__private__.rect=m.rect=function(y,B,re,ce,ge){if(isNaN(y)||isNaN(B)||isNaN(re)||isNaN(ce)||!Ut(ge))throw new Error("Invalid arguments passed to jsPDF.rect");return V===I&&(ce=-ce),ae([T(R(y)),T($(B)),T(R(re)),T(R(ce)),"re"].join(" ")),kl(ge),this},m.__private__.triangle=m.triangle=function(y,B,re,ce,ge,Ae,Ce){if(isNaN(y)||isNaN(B)||isNaN(re)||isNaN(ce)||isNaN(ge)||isNaN(Ae)||!Ut(Ce))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[re-y,ce-B],[ge-re,Ae-ce],[y-ge,B-Ae]],y,B,[1,1],Ce,!0),this},m.__private__.roundedRect=m.roundedRect=function(y,B,re,ce,ge,Ae,Ce){if(isNaN(y)||isNaN(B)||isNaN(re)||isNaN(ce)||isNaN(ge)||isNaN(Ae)||!Ut(Ce))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ge=4/3*(Math.SQRT2-1);return ge=Math.min(ge,.5*re),Ae=Math.min(Ae,.5*ce),this.lines([[re-2*ge,0],[ge*Ge,0,ge,Ae-Ae*Ge,ge,Ae],[0,ce-2*Ae],[0,Ae*Ge,-ge*Ge,Ae,-ge,Ae],[2*ge-re,0],[-ge*Ge,0,-ge,-Ae*Ge,-ge,-Ae],[0,2*Ae-ce],[0,-Ae*Ge,ge*Ge,-Ae,ge,-Ae]],y+ge,B,[1,1],Ce,!0),this},m.__private__.ellipse=m.ellipse=function(y,B,re,ce,ge){if(isNaN(y)||isNaN(B)||isNaN(re)||isNaN(ce)||!Ut(ge))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ae=4/3*(Math.SQRT2-1)*re,Ce=4/3*(Math.SQRT2-1)*ce;return Cl(y+re,B),yi(y+re,B-Ce,y+Ae,B-ce,y,B-ce),yi(y-Ae,B-ce,y-re,B-Ce,y-re,B),yi(y-re,B+Ce,y-Ae,B+ce,y,B+ce),yi(y+Ae,B+ce,y+re,B+Ce,y+re,B),kl(ge),this},m.__private__.circle=m.circle=function(y,B,re,ce){if(isNaN(y)||isNaN(B)||isNaN(re)||!Ut(ce))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(y,B,re,re,ce)},m.setFont=function(y,B,re){return re&&(B=z(B,re)),at=Al(y,B,{disableWarning:!1}),this};var rs=m.__private__.getFont=m.getFont=function(){return tt[Al.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var y,B,re={};for(y in _t)if(_t.hasOwnProperty(y))for(B in re[y]=[],_t[y])_t[y].hasOwnProperty(B)&&re[y].push(B);return re},m.addFont=function(y,B,re,ce,ge){var Ae=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ae.indexOf(arguments[3])!==-1?ge=arguments[3]:arguments[3]&&Ae.indexOf(arguments[3])==-1&&(re=z(re,ce)),fo.call(this,y,B,re,ge=ge||"Identity-H")};var Qs,vo=t.lineWidth||.200025,xt=m.__private__.getLineWidth=m.getLineWidth=function(){return vo},Xs=m.__private__.setLineWidth=m.setLineWidth=function(y){return vo=y,ae(T(R(y))+" w"),this};m.__private__.setLineDash=lt.API.setLineDash=lt.API.setLineDashPattern=function(y,B){if(y=y||[],B=B||0,isNaN(B)||!Array.isArray(y))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return y=y.map(function(re){return T(R(re))}).join(" "),B=T(R(B)),ae("["+y+"] "+B+" d"),this};var qu=m.__private__.getLineHeight=m.getLineHeight=function(){return Re*Qs};m.__private__.getLineHeight=m.getLineHeight=function(){return Re*Qs};var $u=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(y){return typeof(y=y||1.15)=="number"&&(Qs=y),this},Hu=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return Qs};$u(t.lineHeight);var Sr=m.__private__.getHorizontalCoordinate=function(y){return R(y)},ws=m.__private__.getVerticalCoordinate=function(y){return V===O?y:yt[F].mediaBox.topRightY-yt[F].mediaBox.bottomLeftY-R(y)},Wu=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(y){return T(Sr(y))},yo=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(y){return T(ws(y))},_s=t.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return Ii(_s)},m.__private__.setStrokeColor=m.setDrawColor=function(y,B,re,ce){return _s=ai({ch1:y,ch2:B,ch3:re,ch4:ce,pdfColorType:"draw",precision:2}),ae(_s),this};var xo=t.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return Ii(xo)},m.__private__.setFillColor=m.setFillColor=function(y,B,re,ce){return xo=ai({ch1:y,ch2:B,ch3:re,ch4:ce,pdfColorType:"fill",precision:2}),ae(xo),this};var Li=t.textColor||"0 g",is=m.__private__.getTextColor=m.getTextColor=function(){return Ii(Li)};m.__private__.setTextColor=m.setTextColor=function(y,B,re,ce){return Li=ai({ch1:y,ch2:B,ch3:re,ch4:ce,pdfColorType:"text",precision:3}),this};var Ia=t.charSpace,Il=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(Ia||0)};m.__private__.setCharSpace=m.setCharSpace=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ia=y,this};var pn=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(y){var B=m.CapJoinStyles[y];if(B===void 0)throw new Error("Line cap style of '"+y+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return pn=B,ae(B+" J"),this};var Pl=0;m.__private__.setLineJoin=m.setLineJoin=function(y){var B=m.CapJoinStyles[y];if(B===void 0)throw new Error("Line join style of '"+y+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Pl=B,ae(B+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(y){if(y=y||0,isNaN(y))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ae(T(R(y))+" M"),this},m.GState=cp,m.setGState=function(y){(y=typeof y=="string"?At[In[y]]:Pa(null,y)).equals(Sn)||(ae("/"+y.id+" gs"),Sn=y)};var Pa=function(y,B){if(!y||!In[y]){var re=!1;for(var ce in At)if(At.hasOwnProperty(ce)&&At[ce].equals(B)){re=!0;break}if(re)B=At[ce];else{var ge="GS"+(Object.keys(At).length+1).toString(10);At[ge]=B,B.id=ge}return y&&(In[y]=B.id),Ot.publish("addGState",B),B}};m.addGState=function(y,B){return Pa(y,B),this},m.saveGraphicsState=function(){return ae("q"),an.push({key:at,size:Re,color:Li}),this},m.restoreGraphicsState=function(){ae("Q");var y=an.pop();return at=y.key,Re=y.size,Li=y.color,Sn=null,this},m.setCurrentTransformationMatrix=function(y){return ae(y.toString()+" cm"),this},m.comment=function(y){return ae("#"+y),this};var Js=function(y,B){var re=y||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return re},set:function(Ae){isNaN(Ae)||(re=parseFloat(Ae))}});var ce=B||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ce},set:function(Ae){isNaN(Ae)||(ce=parseFloat(Ae))}});var ge="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ge},set:function(Ae){ge=Ae.toString()}}),this},bo=function(y,B,re,ce){Js.call(this,y,B),this.type="rect";var ge=re||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ge},set:function(Ce){isNaN(Ce)||(ge=parseFloat(Ce))}});var Ae=ce||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ae},set:function(Ce){isNaN(Ce)||(Ae=parseFloat(Ce))}}),this},Ra=function(){this.page=nn,this.currentPage=F,this.pages=Ee.slice(0),this.pagesContext=yt.slice(0),this.x=ut,this.y=en,this.matrix=Gt,this.width=xi(F),this.height=Ns(F),this.outputDestination=ze,this.id="",this.objectNumber=-1};Ra.prototype.restore=function(){nn=this.page,F=this.currentPage,yt=this.pagesContext,Ee=this.pages,ut=this.x,en=this.y,Gt=this.matrix,Rl(F,this.width),li(F,this.height),ze=this.outputDestination};var Zs=function(y,B,re,ce,ge){Br.push(new Ra),nn=F=0,Ee=[],ut=y,en=B,Gt=ge,Ri([re,ce])};for(var ea in m.beginFormObject=function(y,B,re,ce,ge){return Zs(y,B,re,ce,ge),this},m.endFormObject=function(y){return function(B){if(ts[B])Br.pop().restore();else{var re=new Ra,ce="Xo"+(Object.keys(Xn).length+1).toString(10);re.id=ce,ts[B]=ce,Xn[ce]=re,Ot.publish("addFormObject",re),Br.pop().restore()}}(y),this},m.doFormObject=function(y,B){var re=Xn[ts[y]];return ae("q"),ae(B.toString()+" cm"),ae("/"+re.id+" Do"),ae("Q"),this},m.getFormObject=function(y){var B=Xn[ts[y]];return{x:B.x,y:B.y,width:B.width,height:B.height,matrix:B.matrix}},m.save=function(y,B){return y=y||"generated.pdf",(B=B||{}).returnPromise=B.returnPromise||!1,B.returnPromise===!1?(Hl(Ks(bs()),y),typeof Hl.unload=="function"&&St.setTimeout&&setTimeout(Hl.unload,911),this):new Promise(function(re,ce){try{var ge=Hl(Ks(bs()),y);typeof Hl.unload=="function"&&St.setTimeout&&setTimeout(Hl.unload,911),re(ge)}catch(Ae){ce(Ae.message)}})},lt.API)lt.API.hasOwnProperty(ea)&&(ea==="events"&&lt.API.events.length?function(y,B){var re,ce,ge;for(ge=B.length-1;ge!==-1;ge--)re=B[ge][0],ce=B[ge][1],y.subscribe.apply(y,[re].concat(typeof ce=="function"?[ce]:ce))}(Ot,lt.API.events):m[ea]=lt.API[ea]);function xi(y){return yt[y].mediaBox.topRightX-yt[y].mediaBox.bottomLeftX}function Rl(y,B){yt[y].mediaBox.topRightX=B+yt[y].mediaBox.bottomLeftX}function Ns(y){return yt[y].mediaBox.topRightY-yt[y].mediaBox.bottomLeftY}function li(y,B){yt[y].mediaBox.topRightY=B+yt[y].mediaBox.bottomLeftY}var Ll=m.getPageWidth=function(y){return xi(y=y||F)/vt},wo=m.setPageWidth=function(y,B){Rl(y,B*vt)},ss=m.getPageHeight=function(y){return Ns(y=y||F)/vt},Dl=m.setPageHeight=function(y,B){li(y,B*vt)};return m.internal={pdfEscape:Nr,getStyle:ka,getFont:rs,getFontSize:$e,getCharSpace:Il,getTextColor:is,getLineHeight:qu,getLineHeightFactor:Hu,getLineWidth:xt,write:ht,getHorizontalCoordinate:Sr,getVerticalCoordinate:ws,getCoordinateString:Wu,getVerticalCoordinateString:yo,collections:{},newObject:Pn,newAdditionalObject:Ea,newObjectDeferred:cr,newObjectDeferredBegin:Rn,getFilters:qr,putStream:Jn,events:Ot,scaleFactor:vt,pageSize:{getWidth:function(){return Ll(F)},setWidth:function(y){wo(F,y)},getHeight:function(){return ss(F)},setHeight:function(y){Dl(F,y)}},encryptionOptions:f,encryption:on,getEncryptor:function(y){return f!==null?on.encryptor(y,0):function(B){return B}},output:gi,getNumberOfPages:El,pages:Ee,out:ae,f2:S,f3:P,getPageInfo:oi,getPageInfoByObjId:po,getCurrentPageInfo:go,getPDFVersion:A,Point:Js,Rectangle:bo,Matrix:mt,hasHotfix:Ta},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return Ll(F)},set:function(y){wo(F,y)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return ss(F)},set:function(y){Dl(F,y)},enumerable:!0,configurable:!0}),(function(y){for(var B=0,re=He.length;B<re;B++){var ce=fo.call(this,y[B][0],y[B][1],y[B][2],He[B][3],!0);g===!1&&(v[ce]=!0);var ge=y[B][0].split("-");_l({id:ce,fontName:ge[0],fontStyle:ge[1]||""})}Ot.publish("addFonts",{fonts:tt,dictionary:_t})}).call(m,He),at="F1",mo(i,n),Ot.publish("initialized"),m}Fc.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Fc.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Fc.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},Fc.prototype.processOwnerPassword=function(t,e){return Q1(Y1(e).substr(0,5),t)},Fc.prototype.encryptor=function(t,e){var n=Y1(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return Q1(n,r)}},cp.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||hn(t)!==hn(this))return!1;var r=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;r++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&r--;return r===0},lt.API={events:[]},lt.version="3.0.3";var Yn=lt.API,Ky=1,Sc=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Rc=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},kt=function(t){return t.toFixed(2)},Fo=function(t){return t.toFixed(5)};Yn.__acroform__={};var Ci=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},aw=function(t){return t*Ky},aa=function(t){var e=new $S,n=Qe.internal.getHeight(t)||0,r=Qe.internal.getWidth(t)||0;return e.BBox=[0,0,Number(kt(r)),Number(kt(n))],e},AD=Yn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},jD=Yn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},TD=Yn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},sr=Yn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return TD(t,e-1)},ar=Yn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return AD(t,e-1)},or=Yn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return jD(t,e-1)},kD=Yn.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,i=t[0],s=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=n(i)||0,c.lowerLeft_Y=r(s+l)||0,c.upperRight_X=n(i+o)||0,c.upperRight_Y=r(s)||0,[Number(kt(c.lowerLeft_X)),Number(kt(c.lowerLeft_Y)),Number(kt(c.upperRight_X)),Number(kt(c.upperRight_Y))]},CD=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,r=X1(t,n),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+kt(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=aa(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},X1=function(t,e){var n=t.fontSize===0?t.maxFontSize:t.fontSize,r={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(S){return S.split(`
`)}):i.map(function(S){return[S]});var s=n,o=Qe.internal.getHeight(t)||0;o=o<0?-o:o;var l=Qe.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(S,P,R){if(S+1<i.length){var $=P+" "+i[S+1][0];return Mf($,t,R).width<=l-4}return!1};s++;e:for(;s>0;){e="",s--;var u,f,g=Mf("3",t,s).height,v=t.multiline?o-s:(o-g)/2,m=v+=2,E=0,A=0,C=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+Mf(e,t,s=12).width+", FieldWidth:"+l+`
`;break}for(var b="",I=0,O=0;O<i.length;O++)if(i.hasOwnProperty(O)){var V=!1;if(i[O].length!==1&&C!==i[O].length-1){if((g+2)*(I+2)+2>o)continue e;b+=i[O][C],V=!0,A=O,O--}else{b=(b+=i[O][C]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var ne=parseInt(O),le=c(ne,b,s),z=O>=i.length-1;if(le&&!z){b+=" ",C=0;continue}if(le||z){if(z)A=ne;else if(t.multiline&&(g+2)*(I+2)+2>o)continue e}else{if(!t.multiline||(g+2)*(I+2)+2>o)continue e;A=ne}}for(var T="",k=E;k<=A;k++){var N=i[k];if(t.multiline){if(k===A){T+=N[C]+" ",C=(C+1)%N.length;continue}if(k===E){T+=N[N.length-1]+" ";continue}}T+=N[0]+" "}switch(T=T.substr(T.length-1)==" "?T.substr(0,T.length-1):T,f=Mf(T,t,s).width,t.textAlign){case"right":u=l-f-2;break;case"center":u=(l-f)/2;break;default:u=2}e+=kt(u)+" "+kt(m)+` Td
`,e+="("+Sc(T)+`) Tj
`,e+=-kt(u)+` 0 Td
`,m=-(s+2),f=0,E=V?A:A+1,I++,b=""}break}return r.text=e,r.fontSize=s,r},Mf=function(t,e,n){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:i}},ID={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},PD=function(t,e){var n={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},RD=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Us.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(ID)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Ky=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new HS,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var s=r[i];s.objId=void 0,s.hasAnnotation&&PD(s,n)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(n){(function(r,i){var s=!r;for(var o in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(o)){var l=r[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=kD(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Qe.createDefaultAppearanceStream(l),hn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var f=CD(l);c.push({key:"AP",value:"<</N "+f+">>"}),i.internal.acroformPlugin.xForms.push(f)}if(l.appearanceStreamContent){var g="";for(var v in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(v)){var m=l.appearanceStreamContent[v];if(g+="/"+v+" ",g+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var o in m)if(m.hasOwnProperty(o)){var E=m[o];typeof E=="function"&&(E=E.call(i,l)),g+="/"+o+" "+E+" ",i.internal.acroformPlugin.xForms.indexOf(E)>=0||i.internal.acroformPlugin.xForms.push(E)}}else typeof(E=m)=="function"&&(E=E.call(i,l)),g+="/"+o+" "+E,i.internal.acroformPlugin.xForms.indexOf(E)>=0||i.internal.acroformPlugin.xForms.push(E);g+=">>"}c.push({key:"AP",value:`<<
`+g+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}s&&function(A,C){for(var b in A)if(A.hasOwnProperty(b)){var I=b,O=A[b];C.internal.newObjectDeferredBegin(O.objId,!0),hn(O)==="object"&&typeof O.putStream=="function"&&O.putStream(),delete A[I]}}(i.internal.acroformPlugin.xForms,i)})(n,t)}),t.internal.acroformPlugin.isInitialized=!0}},qS=Yn.__acroform__.arrayToPdfArray=function(t,e,n){var r=function(o){return o};if(Array.isArray(t)){for(var i="[",s=0;s<t.length;s++)switch(s!==0&&(i+=" "),hn(t[s])){case"boolean":case"number":case"object":i+=t[s].toString();break;case"string":t[s].substr(0,1)!=="/"?(e!==void 0&&n&&(r=n.internal.getEncryptor(e)),i+="("+Sc(r(t[s].toString()))+")"):i+=t[s].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},x0=function(t,e,n){var r=function(i){return i};return e!==void 0&&n&&(r=n.internal.getEncryptor(e)),(t=t||"").toString(),"("+Sc(r(t))+")"},ua=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ua.prototype.toString=function(){return this.objId+" 0 R"},ua.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},ua.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var r=e[n],i=this[r];i&&(Array.isArray(i)?t.push({key:r,value:qS(i,this.objId,this.scope)}):i instanceof ua?(i.scope=this.scope,t.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:r,value:i}))}return t};var $S=function(){ua.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){t=n.trim()},get:function(){return t||null}})};Ci($S,ua);var HS=function(){ua.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Sc(n(t))+")"}},set:function(n){t=n}})};Ci(HS,ua);var Us=function t(){ua.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');e=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!sr(e,3)},set:function(b){b?this.F=ar(e,3):this.F=or(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');n=b}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(b){r=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(b){r[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(b){r[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(b){r[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(b){r[3]=b}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof up)return;s="FieldObject"+t.FieldNum++}var b=function(I){return I};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+Sc(b(s))+")"},set:function(b){s=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(b){s=b}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(b){o=b}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(b){l=b}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(b){c=b}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/Ky:u},set:function(b){u=b}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(b){f=b}});var g="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!g||this instanceof up||this instanceof nc))return x0(g,this.objId,this.scope)},set:function(b){b=b.toString(),g=b}});var v=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(v)return this instanceof jr==0?x0(v,this.objId,this.scope):v},set:function(b){b=b.toString(),v=this instanceof jr==0?b.substr(0,1)==="("?Rc(b.substr(1,b.length-2)):Rc(b):b}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof jr==1?Rc(v.substr(1,v.length-1)):v},set:function(b){b=b.toString(),v=this instanceof jr==1?"/"+b:b}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof jr==0?x0(m,this.objId,this.scope):m},set:function(b){b=b.toString(),m=this instanceof jr==0?b.substr(0,1)==="("?Rc(b.substr(1,b.length-2)):Rc(b):b}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof jr==1?Rc(m.substr(1,m.length-1)):m},set:function(b){b=b.toString(),m=this instanceof jr==1?"/"+b:b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var E,A=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return A},set:function(b){b=!!b,A=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(E)return E},set:function(b){E=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,1)},set:function(b){b?this.Ff=ar(this.Ff,1):this.Ff=or(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,2)},set:function(b){b?this.Ff=ar(this.Ff,2):this.Ff=or(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,3)},set:function(b){b?this.Ff=ar(this.Ff,3):this.Ff=or(this.Ff,3)}});var C=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(C!==null)return C},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');C=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(C){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:C=2;break;case"center":case 1:C=1;break;default:C=0}}})};Ci(Us,ua);var du=function(){Us.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){t=n}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return qS(e,this.objId,this.scope)},set:function(n){var r,i;i=[],typeof(r=n)=="string"&&(i=function(s,o,l){l||(l=1);for(var c,u=[];c=o.exec(s);)u.push(c[l]);return u}(r,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(n){e=n,this.sort&&e.sort()},this.addOption=function(n){n=(n=n||"").toString(),e.push(n),this.sort&&e.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();e.indexOf(n)!==-1&&(e.splice(e.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,18)},set:function(n){n?this.Ff=ar(this.Ff,18):this.Ff=or(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=ar(this.Ff,19):this.Ff=or(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,20)},set:function(n){n?(this.Ff=ar(this.Ff,20),e.sort()):this.Ff=or(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,22)},set:function(n){n?this.Ff=ar(this.Ff,22):this.Ff=or(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,23)},set:function(n){n?this.Ff=ar(this.Ff,23):this.Ff=or(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,27)},set:function(n){n?this.Ff=ar(this.Ff,27):this.Ff=or(this.Ff,27)}}),this.hasAppearanceStream=!1};Ci(du,Us);var hu=function(){du.call(this),this.fontName="helvetica",this.combo=!1};Ci(hu,du);var fu=function(){hu.call(this),this.combo=!0};Ci(fu,hu);var cm=function(){fu.call(this),this.edit=!0};Ci(cm,fu);var jr=function(){Us.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,15)},set:function(n){n?this.Ff=ar(this.Ff,15):this.Ff=or(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,16)},set:function(n){n?this.Ff=ar(this.Ff,16):this.Ff=or(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,17)},set:function(n){n?this.Ff=ar(this.Ff,17):this.Ff=or(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,26)},set:function(n){n?this.Ff=ar(this.Ff,26):this.Ff=or(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(s){return s};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,i=[];for(r in i.push("<<"),e)i.push("/"+r+" ("+Sc(n(e[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(n){hn(n)==="object"&&(e=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(n){typeof n=="string"&&(e.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+n}})};Ci(jr,Us);var um=function(){jr.call(this),this.pushButton=!0};Ci(um,jr);var mu=function(){jr.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Ci(mu,jr);var up=function(){var t,e;Us.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),r)o.push("/"+s+" ("+Sc(i(r[s]))+")");return o.push(">>"),o.join(`
`)},set:function(i){hn(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(i){n=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(i){n="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Qe.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ci(up,Us),mu.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},mu.prototype.createOption=function(t){var e=new up;return e.Parent=this,e.optionName=t,this.Kids.push(e),LD.call(this.scope,e),e};var dm=function(){jr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Qe.CheckBox.createAppearanceStream()};Ci(dm,jr);var nc=function(){Us.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,13)},set:function(e){e?this.Ff=ar(this.Ff,13):this.Ff=or(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,21)},set:function(e){e?this.Ff=ar(this.Ff,21):this.Ff=or(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,23)},set:function(e){e?this.Ff=ar(this.Ff,23):this.Ff=or(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,24)},set:function(e){e?this.Ff=ar(this.Ff,24):this.Ff=or(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,25)},set:function(e){e?this.Ff=ar(this.Ff,25):this.Ff=or(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,26)},set:function(e){e?this.Ff=ar(this.Ff,26):this.Ff=or(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ci(nc,Us);var hm=function(){nc.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!sr(this.Ff,14)},set:function(t){t?this.Ff=ar(this.Ff,14):this.Ff=or(this.Ff,14)}}),this.password=!0};Ci(hm,nc);var Qe={CheckBox:{createAppearanceStream:function(){return{N:{On:Qe.CheckBox.YesNormal},D:{On:Qe.CheckBox.YesPushDown,Off:Qe.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=aa(t);e.scope=t.scope;var n=[],r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),s=X1(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+kt(Qe.internal.getWidth(t))+" "+kt(Qe.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+kt(s.fontSize)+" Tf "+i),n.push("BT"),n.push(s.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(t){var e=aa(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),i=[],s=Qe.internal.getHeight(t),o=Qe.internal.getWidth(t),l=X1(t,t.caption);return i.push("1 g"),i.push("0 0 "+kt(o)+" "+kt(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+kt(o-1)+" "+kt(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+n+" "+kt(l.fontSize)+" Tf "+r),i.push(l.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=aa(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+kt(Qe.internal.getWidth(t))+" "+kt(Qe.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Qe.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Qe.RadioButton.Circle.YesNormal,e.D[t]=Qe.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=aa(t);e.scope=t.scope;var n=[],r=Qe.internal.getWidth(t)<=Qe.internal.getHeight(t)?Qe.internal.getWidth(t)/4:Qe.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Qe.internal.Bezier_C,s=Number((r*i).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Fo(Qe.internal.getWidth(t)/2)+" "+Fo(Qe.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),n.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),n.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),n.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=aa(t);e.scope=t.scope;var n=[],r=Qe.internal.getWidth(t)<=Qe.internal.getHeight(t)?Qe.internal.getWidth(t)/4:Qe.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Qe.internal.Bezier_C).toFixed(5)),o=Number((r*Qe.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Fo(Qe.internal.getWidth(t)/2)+" "+Fo(Qe.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Fo(Qe.internal.getWidth(t)/2)+" "+Fo(Qe.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),n.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),n.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),n.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=aa(t);e.scope=t.scope;var n=[],r=Qe.internal.getWidth(t)<=Qe.internal.getHeight(t)?Qe.internal.getWidth(t)/4:Qe.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Qe.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Fo(Qe.internal.getWidth(t)/2)+" "+Fo(Qe.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Qe.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Qe.RadioButton.Cross.YesNormal,e.D[t]=Qe.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=aa(t);e.scope=t.scope;var n=[],r=Qe.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+kt(Qe.internal.getWidth(t)-2)+" "+kt(Qe.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(kt(r.x1.x)+" "+kt(r.x1.y)+" m"),n.push(kt(r.x2.x)+" "+kt(r.x2.y)+" l"),n.push(kt(r.x4.x)+" "+kt(r.x4.y)+" m"),n.push(kt(r.x3.x)+" "+kt(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=aa(t);e.scope=t.scope;var n=Qe.internal.calculateCross(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+kt(Qe.internal.getWidth(t))+" "+kt(Qe.internal.getHeight(t))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+kt(Qe.internal.getWidth(t)-2)+" "+kt(Qe.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(kt(n.x1.x)+" "+kt(n.x1.y)+" m"),r.push(kt(n.x2.x)+" "+kt(n.x2.y)+" l"),r.push(kt(n.x4.x)+" "+kt(n.x4.y)+" m"),r.push(kt(n.x3.x)+" "+kt(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=aa(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+kt(Qe.internal.getWidth(t))+" "+kt(Qe.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};Qe.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Qe.internal.getWidth(t),n=Qe.internal.getHeight(t),r=Math.min(e,n);return{x1:{x:(e-r)/2,y:(n-r)/2+r},x2:{x:(e-r)/2+r,y:(n-r)/2},x3:{x:(e-r)/2,y:(n-r)/2},x4:{x:(e-r)/2+r,y:(n-r)/2+r}}}},Qe.internal.getWidth=function(t){var e=0;return hn(t)==="object"&&(e=aw(t.Rect[2])),e},Qe.internal.getHeight=function(t){var e=0;return hn(t)==="object"&&(e=aw(t.Rect[3])),e};var LD=Yn.addField=function(t){if(RD(this,t),!(t instanceof Us))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Yn.AcroFormChoiceField=du,Yn.AcroFormListBox=hu,Yn.AcroFormComboBox=fu,Yn.AcroFormEditBox=cm,Yn.AcroFormButton=jr,Yn.AcroFormPushButton=um,Yn.AcroFormRadioButton=mu,Yn.AcroFormCheckBox=dm,Yn.AcroFormTextField=nc,Yn.AcroFormPasswordField=hm,Yn.AcroFormAppearance=Qe,Yn.AcroForm={ChoiceField:du,ListBox:hu,ComboBox:fu,EditBox:cm,Button:jr,PushButton:um,RadioButton:mu,CheckBox:dm,TextField:nc,PasswordField:hm,Appearance:Qe},lt.AcroForm={ChoiceField:du,ListBox:hu,ComboBox:fu,EditBox:cm,Button:jr,PushButton:um,RadioButton:mu,CheckBox:dm,TextField:nc,PasswordField:hm,Appearance:Qe};lt.AcroForm;function WS(t){return t.reduce(function(e,n,r){return e[n]=r,e},{})}(function(t){var e="addImage_";t.__addimage__={};var n="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=t.__addimage__.getImageFileTypeByImageData=function(S,P){var R,$,H,Y,M,U=n;if((P=P||n)==="RGBA"||S.data!==void 0&&S.data instanceof Uint8ClampedArray&&"height"in S&&"width"in S)return"RGBA";if(le(S))for(M in r)for(H=r[M],R=0;R<H.length;R+=1){for(Y=!0,$=0;$<H[R].length;$+=1)if(H[R][$]!==void 0&&H[R][$]!==S[$]){Y=!1;break}if(Y===!0){U=M;break}}else for(M in r)for(H=r[M],R=0;R<H.length;R+=1){for(Y=!0,$=0;$<H[R].length;$+=1)if(H[R][$]!==void 0&&H[R][$]!==S.charCodeAt($)){Y=!1;break}if(Y===!0){U=M;break}}return U===n&&P!==n&&(U=P),U},s=function S(P){for(var R=this.internal.write,$=this.internal.putStream,H=(0,this.internal.getFilters)();H.indexOf("FlateEncode")!==-1;)H.splice(H.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var Y=[];if(Y.push({key:"Type",value:"/XObject"}),Y.push({key:"Subtype",value:"/Image"}),Y.push({key:"Width",value:P.width}),Y.push({key:"Height",value:P.height}),P.colorSpace===b.INDEXED?Y.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(Y.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===b.DEVICE_CMYK&&Y.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Y.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&Y.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)&&P.transparency.length>0){for(var M="",U=0,ee=P.transparency.length;U<ee;U++)M+=P.transparency[U]+" "+P.transparency[U]+" ";Y.push({key:"Mask",value:"["+M+"]"})}P.sMask!==void 0&&Y.push({key:"SMask",value:P.objectId+1+" 0 R"});var fe=P.filter!==void 0?["/"+P.filter]:void 0;if($({data:P.data,additionalKeyValues:Y,alreadyAppliedFilters:fe,objectId:P.objectId}),R("endobj"),"sMask"in P&&P.sMask!==void 0){var Q,w=(Q=P.sMaskBitsPerComponent)!==null&&Q!==void 0?Q:P.bitsPerComponent,F={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:w,data:P.sMask};"filter"in P&&(F.decodeParameters="/Predictor ".concat(P.predictor," /Colors 1 /BitsPerComponent ").concat(w," /Columns ").concat(P.width),F.filter=P.filter),S.call(this,F)}if(P.colorSpace===b.INDEXED){var D=this.internal.newObject();$({data:T(new Uint8Array(P.palette)),objectId:D}),R("endobj")}},o=function(){var S=this.internal.collections[e+"images"];for(var P in S)s.call(this,S[P])},l=function(){var S,P=this.internal.collections[e+"images"],R=this.internal.write;for(var $ in P)R("/I"+(S=P[$]).index,S.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var S=this.internal.collections[e+"images"];return c.call(this),S},f=function(){return Object.keys(this.internal.collections[e+"images"]).length},g=function(S){return typeof t["process"+S.toUpperCase()]=="function"},v=function(S){return hn(S)==="object"&&S.nodeType===1},m=function(S,P){if(S.nodeName==="IMG"&&S.hasAttribute("src")){var R=""+S.getAttribute("src");if(R.indexOf("data:image/")===0)return lm(unescape(R).split("base64,").pop());var $=t.loadFile(R,!0);if($!==void 0)return $}if(S.nodeName==="CANVAS"){if(S.width===0||S.height===0)throw new Error("Given canvas must have data. Canvas width: "+S.width+", height: "+S.height);var H;switch(P){case"PNG":H="image/png";break;case"WEBP":H="image/webp";break;default:H="image/jpeg"}return lm(S.toDataURL(H,1).split("base64,").pop())}},E=function(S){var P=this.internal.collections[e+"images"];if(P){for(var R in P)if(S===P[R].alias)return P[R]}},A=function(S,P,R){return S||P||(S=-96,P=-96),S<0&&(S=-1*R.width*72/S/this.internal.scaleFactor),P<0&&(P=-1*R.height*72/P/this.internal.scaleFactor),S===0&&(S=P*R.width/R.height),P===0&&(P=S*R.height/R.width),[S,P]},C=function(S,P,R,$,H,Y){var M=A.call(this,R,$,H),U=this.internal.getCoordinateString,ee=this.internal.getVerticalCoordinateString,fe=u.call(this);if(R=M[0],$=M[1],fe[H.index]=H,Y){Y*=Math.PI/180;var Q=Math.cos(Y),w=Math.sin(Y),F=function(K){return K.toFixed(4)},D=[F(Q),F(w),F(-1*w),F(Q),0,0,"cm"]}this.internal.write("q"),Y?(this.internal.write([1,"0","0",1,U(S),ee(P+$),"cm"].join(" ")),this.internal.write(D.join(" ")),this.internal.write([U(R),"0","0",U($),"0","0","cm"].join(" "))):this.internal.write([U(R),"0","0",U($),U(S),ee(P+$),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+H.index+" Do"),this.internal.write("Q")},b=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var I=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},O=t.__addimage__.sHashCode=function(S){var P,R,$=0;if(typeof S=="string")for(R=S.length,P=0;P<R;P++)$=($<<5)-$+S.charCodeAt(P),$|=0;else if(le(S))for(R=S.byteLength/2,P=0;P<R;P++)$=($<<5)-$+S[P],$|=0;return $},V=t.__addimage__.validateStringAsBase64=function(S){(S=S||"").toString().trim();var P=!0;return S.length===0&&(P=!1),S.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(S.substr(0,S.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(S.substr(-2))===!1&&(P=!1),P},ne=t.__addimage__.extractImageFromDataUrl=function(S){if(S==null||!(S=S.trim()).startsWith("data:"))return null;var P=S.indexOf(",");return P<0?null:S.substring(0,P).trim().endsWith("base64")?S.substring(P+1):null};t.__addimage__.isArrayBuffer=function(S){return S instanceof ArrayBuffer};var le=t.__addimage__.isArrayBufferView=function(S){return S instanceof Int8Array||S instanceof Uint8Array||S instanceof Uint8ClampedArray||S instanceof Int16Array||S instanceof Uint16Array||S instanceof Int32Array||S instanceof Uint32Array||S instanceof Float32Array||S instanceof Float64Array},z=t.__addimage__.binaryStringToUint8Array=function(S){for(var P=S.length,R=new Uint8Array(P),$=0;$<P;$++)R[$]=S.charCodeAt($);return R},T=t.__addimage__.arrayBufferToBinaryString=function(S){for(var P="",R=le(S)?S:new Uint8Array(S),$=0;$<R.length;$+=8192)P+=String.fromCharCode.apply(null,R.subarray($,$+8192));return P};t.addImage=function(){var S,P,R,$,H,Y,M,U,ee;if(typeof arguments[1]=="number"?(P=n,R=arguments[1],$=arguments[2],H=arguments[3],Y=arguments[4],M=arguments[5],U=arguments[6],ee=arguments[7]):(P=arguments[1],R=arguments[2],$=arguments[3],H=arguments[4],Y=arguments[5],M=arguments[6],U=arguments[7],ee=arguments[8]),hn(S=arguments[0])==="object"&&!v(S)&&"imageData"in S){var fe=S;S=fe.imageData,P=fe.format||P||n,R=fe.x||R||0,$=fe.y||$||0,H=fe.w||fe.width||H,Y=fe.h||fe.height||Y,M=fe.alias||M,U=fe.compression||U,ee=fe.rotation||fe.angle||ee}var Q=this.internal.getFilters();if(U===void 0&&Q.indexOf("FlateEncode")!==-1&&(U="SLOW"),isNaN(R)||isNaN($))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var w=k.call(this,S,P,M,U);return C.call(this,R,$,H,Y,w,ee),this};var k=function(S,P,R,$){var H,Y,M;if(typeof S=="string"&&i(S)===n){S=unescape(S);var U=N(S,!1);(U!==""||(U=t.loadFile(S,!0))!==void 0)&&(S=U)}if(v(S)&&(S=m(S,P)),P=i(S,P),!g(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((M=R)==null||M.length===0)&&(R=function(ee){return typeof ee=="string"||le(ee)?O(ee):le(ee.data)?O(ee.data):null}(S)),(H=E.call(this,R))||(S instanceof Uint8Array||P==="RGBA"||(Y=S,S=z(S)),H=this["process"+P.toUpperCase()](S,f.call(this),R,function(ee){return ee&&typeof ee=="string"&&(ee=ee.toUpperCase()),ee in t.image_compression?ee:I.NONE}($),Y)),!H)throw new Error("An unknown error occurred whilst processing the image.");return H},N=t.__addimage__.convertBase64ToBinaryString=function(S,P){P=typeof P!="boolean"||P;var R,$="";if(typeof S=="string"){var H;R=(H=ne(S))!==null&&H!==void 0?H:S;try{$=lm(R)}catch(Y){if(P)throw V(R)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Y.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return $};t.getImageProperties=function(S){var P,R,$="";if(v(S)&&(S=m(S)),typeof S=="string"&&i(S)===n&&(($=N(S,!1))===""&&($=t.loadFile(S)||""),S=$),R=i(S),!g(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(S instanceof Uint8Array||(S=z(S)),!(P=this["process"+R.toUpperCase()](S)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=R,P}})(lt.API),function(t){var e=function(n){if(n!==void 0&&n!="")return!0};lt.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(n){for(var r,i,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(n.objId),u=n.pageContext.annotations,f=!1,g=0;g<u.length&&!f;g++)switch((r=u[g]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var v=0;v<u.length;v++){r=u[v];var m=this.internal.pdfEscape,E=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var A=this.internal.newAdditionalObject(),C=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(A.objId),I=r.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(r.bounds.x)+" "+l(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y)+"] ")+"/Contents ("+m(b(r.contents))+")",s+=" /Popup "+C.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+m(b(I))+") >>",A.content=s;var O=A.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(r.bounds.x+30)+" "+l(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w+30)+" "+l(r.bounds.y)+"] ")+" /Parent "+O,r.open&&(s+=" /Open true"),s+=" >>",C.content=s,this.internal.write(A.objId,"0 R",C.objId,"0 R");break;case"freetext":i="/Rect ["+o(r.bounds.x)+" "+l(r.bounds.y)+" "+o(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y+r.bounds.h)+"] ";var V=r.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+m(E(r.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+V+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(r.options.name){var ne=this.annotations._nameMap[r.options.name];r.options.pageNumber=ne.page,r.options.top=ne.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",s="",r.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+m(E(r.options.url))+") >>";else if(r.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,s+=" /FitV "+r.options.left+"]";break;default:var le=l(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),s+=" /XYZ "+r.options.left+" "+le+" "+r.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},t.link=function(n,r,i,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(n),y:u(r),w:c(n+i),h:u(r+s)},options:o,type:"link"})},t.textWithLink=function(n,r,i,s){var o,l,c=this.getTextWidth(n),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var f=this.splitTextToSize(n,l).length;o=Math.ceil(u*f)}else l=c,o=u;return this.text(n,r,i,s),i+=.2*u,s.align==="center"&&(r-=c/2),s.align==="right"&&(r-=c),this.link(r,i-u,l,o,s),c},t.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}}(lt.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(A){return e[A.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(A){return typeof A=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(A)},l=t.__arabicParser__.isArabicEndLetter=function(A){return o(A)&&s(A)&&e[A.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(A){return o(A)&&i.indexOf(A.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(A){return o(A)&&s(A)&&e[A.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(A){return o(A)&&s(A)&&e[A.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(A){return o(A)&&s(A)&&e[A.charCodeAt(0)].length>=3};var f=t.__arabicParser__.arabicLetterHasMedialForm=function(A){return o(A)&&s(A)&&e[A.charCodeAt(0)].length==4},g=t.__arabicParser__.resolveLigatures=function(A){var C=0,b=n,I="",O=0;for(C=0;C<A.length;C+=1)b[A.charCodeAt(C)]!==void 0?(O++,typeof(b=b[A.charCodeAt(C)])=="number"&&(I+=String.fromCharCode(b),b=n,O=0),C===A.length-1&&(b=n,I+=A.charAt(C-(O-1)),C-=O-1,O=0)):(b=n,I+=A.charAt(C-O),C-=O,O=0);return I};t.__arabicParser__.isArabicDiacritic=function(A){return A!==void 0&&r[A.charCodeAt(0)]!==void 0};var v=t.__arabicParser__.getCorrectForm=function(A,C,b){return o(A)?s(A)===!1?-1:!u(A)||!o(C)&&!o(b)||!o(b)&&l(C)||l(A)&&!o(C)||l(A)&&c(C)||l(A)&&l(C)?0:f(A)&&o(C)&&!l(C)&&o(b)&&u(b)?3:l(A)||!o(b)?1:2:-1},m=function(A){var C=0,b=0,I=0,O="",V="",ne="",le=(A=A||"").split("\\s+"),z=[];for(C=0;C<le.length;C+=1){for(z.push(""),b=0;b<le[C].length;b+=1)O=le[C][b],V=le[C][b-1],ne=le[C][b+1],o(O)?(I=v(O,V,ne),z[C]+=I!==-1?String.fromCharCode(e[O.charCodeAt(0)][I]):O):z[C]+=O;z[C]=g(z[C])}return z.join(" ")},E=t.__arabicParser__.processArabic=t.processArabic=function(){var A,C=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(C)){var I=0;for(b=[],I=0;I<C.length;I+=1)Array.isArray(C[I])?b.push([m(C[I][0]),C[I][1],C[I][2]]):b.push([m(C[I])]);A=b}else A=m(C);return typeof arguments[0]=="string"?A:(arguments[0].text=A,arguments[0])};t.events.push(["preProcessText",E])}(lt.API),lt.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(t){var e=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(l){n=l}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(l){r=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(n,r){var i;if((n=n||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(lt.API),function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(A){c=A}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(A){u=A}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(A){f=A}});var g=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return g},set:function(A){g=A}});var v=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return v},set:function(A){v=A}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(A){m=A}});var E=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return E},set:function(A){E=A}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return r.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){r.call(this);var f=(u=u||{}).fontSize||this.getFontSize(),g=u.font||this.getFont(),v=u.scaleFactor||this.internal.scaleFactor,m=0,E=0,A=0,C=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var b=u.maxWidth;b>0?typeof c=="string"?c=this.splitTextToSize(c,b):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(O,V){return O.concat(C.splitTextToSize(V,b))},[])):c=Array.isArray(c)?c:[c];for(var I=0;I<c.length;I++)m<(A=this.getStringUnitWidth(c[I],{font:g})*f)&&(m=A);return m!==0&&(E=c.length),{w:m/=v,h:Math.max((E*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/v,0)}},t.cellAddPage=function(){r.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var u=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,g=this.internal.__cell__.margins||e,v=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+g.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=g.top,m&&v&&(this.printHeaderRow(c.lineNumber,!0),c.y+=v[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,n===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-f,c.y+f,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+f,{align:"center",baseline:"top",maxWidth:c.width-f-f}):this.text(c.text,c.x+f,c.y+f,{align:"left",baseline:"top",maxWidth:c.width-f-f})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,f,g,v){if(r.call(this),!f)throw new Error("No data for PDF table.");var m,E,A,C,b=[],I=[],O=[],V={},ne={},le=[],z=[],T=(v=v||{}).autoSize||!1,k=v.printHeaders!==!1,N=v.css&&v.css["font-size"]!==void 0?16*v.css["font-size"]:v.fontSize||12,S=v.margins||Object.assign({width:this.getPageWidth()},e),P=typeof v.padding=="number"?v.padding:3,R=v.headerBackgroundColor||"#c8c8c8",$=v.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=k,this.internal.__cell__.margins=S,this.internal.__cell__.table_font_size=N,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=R,this.internal.__cell__.headerTextColor=$,this.setFontSize(N),g==null)I=b=Object.keys(f[0]),O=b.map(function(){return"left"});else if(Array.isArray(g)&&hn(g[0])==="object")for(b=g.map(function(fe){return fe.name}),I=g.map(function(fe){return fe.prompt||fe.name||""}),O=g.map(function(fe){return fe.align||"left"}),m=0;m<g.length;m+=1)ne[g[m].name]=.7499990551181103*g[m].width;else Array.isArray(g)&&typeof g[0]=="string"&&(I=b=g,O=b.map(function(){return"left"}));if(T||Array.isArray(g)&&typeof g[0]=="string")for(m=0;m<b.length;m+=1){for(V[C=b[m]]=f.map(function(fe){return fe[C]}),this.setFont(void 0,"bold"),le.push(this.getTextDimensions(I[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),E=V[C],this.setFont(void 0,"normal"),A=0;A<E.length;A+=1)le.push(this.getTextDimensions(E[A],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);ne[C]=Math.max.apply(null,le)+P+P,le=[]}if(k){var H={};for(m=0;m<b.length;m+=1)H[b[m]]={},H[b[m]].text=I[m],H[b[m]].align=O[m];var Y=l.call(this,H,ne);z=b.map(function(fe){return new s(c,u,ne[fe],Y,H[fe].text,void 0,H[fe].align)}),this.setTableHeaderRow(z),this.printHeaderRow(1,!1)}var M=g.reduce(function(fe,Q){return fe[Q.name]=Q.align,fe},{});for(m=0;m<f.length;m+=1){"rowStart"in v&&v.rowStart instanceof Function&&v.rowStart({row:m,data:f[m]},this);var U=l.call(this,f[m],ne);for(A=0;A<b.length;A+=1){var ee=f[m][b[A]];"cellStart"in v&&v.cellStart instanceof Function&&v.cellStart({row:m,col:A,data:ee},this),o.call(this,new s(c,u,ne[b[A]],U,ee,m+2,M[b[A]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var f=this.internal.__cell__.padding,g=this.internal.__cell__.table_font_size,v=this.internal.scaleFactor;return Object.keys(c).map(function(m){var E=c[m];return this.splitTextToSize(E.hasOwnProperty("text")?E.text:E,u[m]-f-f)},this).map(function(m){return this.getLineHeightFactor()*m.length*g/v+f+f},this).reduce(function(m,E){return Math.max(m,E)},0)};t.setTableHeaderRow=function(c){r.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var g=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(g[0],g[1],g[2],g[3],void 0,-1)}this.setFont(void 0,"bold");for(var v=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){f=this.internal.__cell__.tableHeaderRow[m].clone(),u&&(f.y=this.internal.__cell__.margins.top||0,v.push(f)),f.lineNumber=c;var E=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,f),this.setTextColor(E)}v.length>0&&this.setTableHeaderRow(v),this.setFont(void 0,"normal"),n=!1}}(lt.API);var GS={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},KS=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],J1=WS(KS),YS=[100,200,300,400,500,600,700,800,900],DD=WS(YS);function b0(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=function(s){return GS[s=s||"normal"]?s:"normal"}(t.style),r=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(t.weight),i=function(s){return typeof J1[s=s||"normal"]=="number"?s:"normal"}(t.stretch);return{family:e,style:n,weight:r,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,n,r].join(" ")}}}function ow(t,e,n,r){var i;for(i=n;i>=0&&i<e.length;i+=r)if(t[e[i]])return t[e[i]];for(i=n;i>=0&&i<e.length;i-=r)if(t[e[i]])return t[e[i]]}var MD={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},lw={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function cw(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function uw(t){return t.trimLeft()}function OD(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function FD(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Of,dw,hw,Lc,Ff,fw,mw,pw,w0=["times"];function gw(t,e,n,r,i){var s=4,o=yw;switch(i){case lt.API.image_compression.FAST:s=1,o=vw;break;case lt.API.image_compression.MEDIUM:s=6,o=xw;break;case lt.API.image_compression.SLOW:s=9,o=bw}t=function(c,u,f,g){for(var v,m=c.length/u,E=new Uint8Array(c.length+m),A=[VD,vw,yw,xw,bw],C=0;C<m;C+=1){var b=C*u,I=c.subarray(b,b+u);if(g)E.set(g(I,f,v),b+C);else{for(var O=A.length,V=[],ne=0;ne<O;ne+=1)V[ne]=A[ne](I,f,v);var le=BD(V.concat());E.set(V[le],b+C)}v=I}return E}(t,e,Math.ceil(n*r/8),o);var l=H1(t,{level:s});return lt.API.__addimage__.arrayBufferToBinaryString(l)}function VD(t){var e=Array.apply([],t);return e.unshift(0),e}function vw(t,e){var n=t.length,r=[];r[0]=1;for(var i=0;i<n;i+=1){var s=t[i-e]||0;r[i+1]=t[i]-s+256&255}return r}function yw(t,e,n){var r=t.length,i=[];i[0]=2;for(var s=0;s<r;s+=1){var o=n&&n[s]||0;i[s+1]=t[s]-o+256&255}return i}function xw(t,e,n){var r=t.length,i=[];i[0]=3;for(var s=0;s<r;s+=1){var o=t[s-e]||0,l=n&&n[s]||0;i[s+1]=t[s]+256-(o+l>>>1)&255}return i}function bw(t,e,n){var r=t.length,i=[];i[0]=4;for(var s=0;s<r;s+=1){var o=UD(t[s-e]||0,n&&n[s]||0,n&&n[s-e]||0);i[s+1]=t[s]-o+256&255}return i}function UD(t,e,n){if(t===e&&e===n)return t;var r=Math.abs(e-n),i=Math.abs(t-n),s=Math.abs(t+e-n-n);return r<=i&&r<=s?t:i<=s?e:n}function BD(t){var e=t.map(function(n){return n.reduce(function(r,i){return r+Math.abs(i)},0)});return e.indexOf(Math.min.apply(null,e))}function _0(t,e,n){var r=e*n,i=Math.floor(r/8),s=16-(r-8*i+n),o=(1<<n)-1;return QS(t,i)>>s&o}function ww(t,e,n,r){var i=n*r,s=Math.floor(i/8),o=16-(i-8*s+r),l=(1<<r)-1,c=(e&l)<<o;(function(u,f,g){if(f+1<u.byteLength)u.setUint16(f,g,!1);else{var v=g>>8&255;u.setUint8(f,v)}})(t,s,QS(t,s)&~(l<<o)&65535|c)}function QS(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function zD(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,r=t[e++]|t[e++]<<8,i=t[e++],s=i>>7,o=1<<1+(7&i);t[e++],t[e++];var l=null,c=null;s&&(l=e,c=o,e+=3*o);var u=!0,f=[],g=0,v=null,m=0,E=null;for(this.width=n,this.height=r;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,E=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((S=t[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var A=t[e++];g=t[e++]|t[e++]<<8,v=t[e++],1&A||(v=null),m=A>>2&7,e++;break;case 254:for(;;){if(!((S=t[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var C=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,I=t[e++]|t[e++]<<8,O=t[e++]|t[e++]<<8,V=t[e++],ne=V>>6&1,le=1<<1+(7&V),z=l,T=c,k=!1;V>>7&&(k=!0,z=e,T=le,e+=3*le);var N=e;for(e++;;){var S;if(!((S=t[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}f.push({x:C,y:b,width:I,height:O,has_local_palette:k,palette_offset:z,palette_size:T,data_offset:N,data_length:e-N,transparent_index:v,interlaced:!!ne,delay:g,disposal:m});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return E},this.frameInfo=function(P){if(P<0||P>=f.length)throw new Error("Frame index out of range.");return f[P]},this.decodeAndBlitFrameBGRA=function(P,R){var $=this.frameInfo(P),H=$.width*$.height,Y=new Uint8Array(H);_w(t,$.data_offset,Y,H);var M=$.palette_offset,U=$.transparent_index;U===null&&(U=256);var ee=$.width,fe=n-ee,Q=ee,w=4*($.y*n+$.x),F=4*(($.y+$.height)*n+$.x),D=w,K=4*fe;$.interlaced===!0&&(K+=4*n*7);for(var te=8,oe=0,he=Y.length;oe<he;++oe){var pe=Y[oe];if(Q===0&&(Q=ee,(D+=K)>=F&&(K=4*fe+4*n*(te-1),D=w+(ee+fe)*(te<<1),te>>=1)),pe===U)D+=4;else{var ve=t[M+3*pe],Ee=t[M+3*pe+1],Ve=t[M+3*pe+2];R[D++]=Ve,R[D++]=Ee,R[D++]=ve,R[D++]=255}--Q}},this.decodeAndBlitFrameRGBA=function(P,R){var $=this.frameInfo(P),H=$.width*$.height,Y=new Uint8Array(H);_w(t,$.data_offset,Y,H);var M=$.palette_offset,U=$.transparent_index;U===null&&(U=256);var ee=$.width,fe=n-ee,Q=ee,w=4*($.y*n+$.x),F=4*(($.y+$.height)*n+$.x),D=w,K=4*fe;$.interlaced===!0&&(K+=4*n*7);for(var te=8,oe=0,he=Y.length;oe<he;++oe){var pe=Y[oe];if(Q===0&&(Q=ee,(D+=K)>=F&&(K=4*fe+4*n*(te-1),D=w+(ee+fe)*(te<<1),te>>=1)),pe===U)D+=4;else{var ve=t[M+3*pe],Ee=t[M+3*pe+1],Ve=t[M+3*pe+2];R[D++]=ve,R[D++]=Ee,R[D++]=Ve,R[D++]=255}--Q}}}function _w(t,e,n,r){for(var i=t[e++],s=1<<i,o=s+1,l=o+1,c=i+1,u=(1<<c)-1,f=0,g=0,v=0,m=t[e++],E=new Int32Array(4096),A=null;;){for(;f<16&&m!==0;)g|=t[e++]<<f,f+=8,m===1?m=t[e++]:--m;if(f<c)break;var C=g&u;if(g>>=c,f-=c,C!==s){if(C===o)break;for(var b=C<l?C:A,I=0,O=b;O>s;)O=E[O]>>8,++I;var V=O;if(v+I+(b!==C?1:0)>r)return void yn.log("Warning, gif stream longer than expected.");n[v++]=V;var ne=v+=I;for(b!==C&&(n[v++]=V),O=b;I--;)O=E[O],n[--ne]=255&O,O>>=8;A!==null&&l<4096&&(E[l++]=A<<8|V,l>=u+1&&c<12&&(++c,u=u<<1|1)),A=C}else l=o+1,u=(1<<(c=i+1))-1,A=null}return v!==r&&yn.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function N0(t){var e,n,r,i,s,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),f=new Array(64),g=new Array(65535),v=new Array(65535),m=new Array(64),E=new Array(64),A=[],C=0,b=7,I=new Array(64),O=new Array(64),V=new Array(64),ne=new Array(256),le=new Array(2048),z=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],T=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],k=[0,1,2,3,4,5,6,7,8,9,10,11],N=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],S=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],$=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],H=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Y(w,F){for(var D=0,K=0,te=new Array,oe=1;oe<=16;oe++){for(var he=1;he<=w[oe];he++)te[F[K]]=[],te[F[K]][0]=D,te[F[K]][1]=oe,K++,D++;D*=2}return te}function M(w){for(var F=w[0],D=w[1]-1;D>=0;)F&1<<D&&(C|=1<<b),D--,--b<0&&(C==255?(U(255),U(0)):U(C),b=7,C=0)}function U(w){A.push(w)}function ee(w){U(w>>8&255),U(255&w)}function fe(w,F,D,K,te){for(var oe,he=te[0],pe=te[240],ve=function(Re,Xe){var $e,Oe,Pe,qt,Et,it,Tt,wt,at,vt,ut=0;for(at=0;at<8;++at){$e=Re[ut],Oe=Re[ut+1],Pe=Re[ut+2],qt=Re[ut+3],Et=Re[ut+4],it=Re[ut+5],Tt=Re[ut+6];var en=$e+(wt=Re[ut+7]),Gt=$e-wt,tt=Oe+Tt,_t=Oe-Tt,an=Pe+it,pt=Pe-it,Dt=qt+Et,At=qt-Et,In=en+Dt,Sn=en-Dt,nn=tt+an,yt=tt-an;Re[ut]=In+nn,Re[ut+4]=In-nn;var Ot=.707106781*(yt+Sn);Re[ut+2]=Sn+Ot,Re[ut+6]=Sn-Ot;var zs=.382683433*((In=At+pt)-(yt=_t+Gt)),Xn=.5411961*In+zs,ts=1.306562965*yt+zs,Br=.707106781*(nn=pt+_t),mt=Gt+Br,En=Gt-Br;Re[ut+5]=En+Xn,Re[ut+3]=En-Xn,Re[ut+1]=mt+ts,Re[ut+7]=mt-ts,ut+=8}for(ut=0,at=0;at<8;++at){$e=Re[ut],Oe=Re[ut+8],Pe=Re[ut+16],qt=Re[ut+24],Et=Re[ut+32],it=Re[ut+40],Tt=Re[ut+48];var ns=$e+(wt=Re[ut+56]),wr=$e-wt,_r=Oe+Tt,Pn=Oe-Tt,cr=Pe+it,Rn=Pe-it,Ea=qt+Et,qs=qt-Et,zr=ns+Ea,Ii=ns-Ea,ai=_r+cr,qr=_r-cr;Re[ut]=zr+ai,Re[ut+32]=zr-ai;var Jn=.707106781*(qr+Ii);Re[ut+16]=Ii+Jn,Re[ut+48]=Ii-Jn;var $s=.382683433*((zr=qs+Rn)-(qr=Pn+wr)),Pi=.5411961*zr+$s,xs=1.306562965*qr+$s,Hs=.707106781*(ai=Rn+Pn),Aa=wr+Hs,ja=wr-Hs;Re[ut+40]=ja+Pi,Re[ut+24]=ja-Pi,Re[ut+8]=Aa+xs,Re[ut+56]=Aa-xs,ut++}for(at=0;at<64;++at)vt=Re[at]*Xe[at],m[at]=vt>0?vt+.5|0:vt-.5|0;return m}(w,F),Ee=0;Ee<64;++Ee)E[z[Ee]]=ve[Ee];var Ve=E[0]-D;D=E[0],Ve==0?M(K[0]):(M(K[v[oe=32767+Ve]]),M(g[oe]));for(var ze=63;ze>0&&E[ze]==0;)ze--;if(ze==0)return M(he),D;for(var Ne,ae=1;ae<=ze;){for(var ht=ae;E[ae]==0&&ae<=ze;)++ae;var et=ae-ht;if(et>=16){Ne=et>>4;for(var He=1;He<=Ne;++He)M(pe);et&=15}oe=32767+E[ae],M(te[(et<<4)+v[oe]]),M(g[oe]),ae++}return ze!=63&&M(he),D}function Q(w){w=Math.min(Math.max(w,1),100),s!=w&&(function(F){for(var D=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],K=0;K<64;K++){var te=o((D[K]*F+50)/100);te=Math.min(Math.max(te,1),255),l[z[K]]=te}for(var oe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],he=0;he<64;he++){var pe=o((oe[he]*F+50)/100);pe=Math.min(Math.max(pe,1),255),c[z[he]]=pe}for(var ve=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ee=0,Ve=0;Ve<8;Ve++)for(var ze=0;ze<8;ze++)u[Ee]=1/(l[z[Ee]]*ve[Ve]*ve[ze]*8),f[Ee]=1/(c[z[Ee]]*ve[Ve]*ve[ze]*8),Ee++}(w<50?Math.floor(5e3/w):Math.floor(200-2*w)),s=w)}this.encode=function(w,F){F&&Q(F),A=new Array,C=0,b=7,ee(65496),ee(65504),ee(16),U(74),U(70),U(73),U(70),U(0),U(1),U(1),U(0),ee(1),ee(1),U(0),U(0),function(){ee(65499),ee(132),U(0);for(var Oe=0;Oe<64;Oe++)U(l[Oe]);U(1);for(var Pe=0;Pe<64;Pe++)U(c[Pe])}(),function(Oe,Pe){ee(65472),ee(17),U(8),ee(Pe),ee(Oe),U(3),U(1),U(17),U(0),U(2),U(17),U(1),U(3),U(17),U(1)}(w.width,w.height),function(){ee(65476),ee(418),U(0);for(var Oe=0;Oe<16;Oe++)U(T[Oe+1]);for(var Pe=0;Pe<=11;Pe++)U(k[Pe]);U(16);for(var qt=0;qt<16;qt++)U(N[qt+1]);for(var Et=0;Et<=161;Et++)U(S[Et]);U(1);for(var it=0;it<16;it++)U(P[it+1]);for(var Tt=0;Tt<=11;Tt++)U(R[Tt]);U(17);for(var wt=0;wt<16;wt++)U($[wt+1]);for(var at=0;at<=161;at++)U(H[at])}(),ee(65498),ee(12),U(3),U(1),U(0),U(2),U(17),U(3),U(17),U(0),U(63),U(0);var D=0,K=0,te=0;C=0,b=7,this.encode.displayName="_encode_";for(var oe,he,pe,ve,Ee,Ve,ze,Ne,ae,ht=w.data,et=w.width,He=w.height,Re=4*et,Xe=0;Xe<He;){for(oe=0;oe<Re;){for(Ee=Re*Xe+oe,ze=-1,Ne=0,ae=0;ae<64;ae++)Ve=Ee+(Ne=ae>>3)*Re+(ze=4*(7&ae)),Xe+Ne>=He&&(Ve-=Re*(Xe+1+Ne-He)),oe+ze>=Re&&(Ve-=oe+ze-Re+4),he=ht[Ve++],pe=ht[Ve++],ve=ht[Ve++],I[ae]=(le[he]+le[pe+256|0]+le[ve+512|0]>>16)-128,O[ae]=(le[he+768|0]+le[pe+1024|0]+le[ve+1280|0]>>16)-128,V[ae]=(le[he+1280|0]+le[pe+1536|0]+le[ve+1792|0]>>16)-128;D=fe(I,u,D,e,r),K=fe(O,f,K,n,i),te=fe(V,f,te,n,i),oe+=32}Xe+=8}if(b>=0){var $e=[];$e[1]=b+1,$e[0]=(1<<b+1)-1,M($e)}return ee(65497),new Uint8Array(A)},t=t||50,function(){for(var w=String.fromCharCode,F=0;F<256;F++)ne[F]=w(F)}(),e=Y(T,k),n=Y(P,R),r=Y(N,S),i=Y($,H),function(){for(var w=1,F=2,D=1;D<=15;D++){for(var K=w;K<F;K++)v[32767+K]=D,g[32767+K]=[],g[32767+K][1]=D,g[32767+K][0]=K;for(var te=-(F-1);te<=-w;te++)v[32767+te]=D,g[32767+te]=[],g[32767+te][1]=D,g[32767+te][0]=F-1+te;w<<=1,F<<=1}}(),function(){for(var w=0;w<256;w++)le[w]=19595*w,le[w+256|0]=38470*w,le[w+512|0]=7471*w+32768,le[w+768|0]=-11059*w,le[w+1024|0]=-21709*w,le[w+1280|0]=32768*w+8421375,le[w+1536|0]=-27439*w,le[w+1792|0]=-5329*w}(),Q(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ks(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Nw(t){function e(k){if(!k)throw Error("assert :P")}function n(k,N,S){for(var P=0;4>P;P++)if(k[N+P]!=S.charCodeAt(P))return!0;return!1}function r(k,N,S,P,R){for(var $=0;$<R;$++)k[N+$]=S[P+$]}function i(k,N,S,P){for(var R=0;R<P;R++)k[N+R]=S}function s(k){return new Int32Array(k)}function o(k,N){for(var S=[],P=0;P<k;P++)S.push(new N);return S}function l(k,N){var S=[];return function P(R,$,H){for(var Y=H[$],M=0;M<Y&&(R.push(H.length>$+1?[]:new N),!(H.length<$+1));M++)P(R[M],$+1,H)}(S,0,k),S}var c=function(){var k=this;function N(d,p){for(var x=1<<p-1>>>0;d&x;)x>>>=1;return x?(d&x-1)+x:d}function S(d,p,x,j,q){e(!(j%x));do d[p+(j-=x)]=q;while(0<j)}function P(d,p,x,j,q){if(e(2328>=q),512>=q)var W=s(512);else if((W=s(q))==null)return 0;return function(G,X,Z,ie,de,we){var se,me,xe=X,Se=1<<Z,be=s(16),je=s(16);for(e(de!=0),e(ie!=null),e(G!=null),e(0<Z),me=0;me<de;++me){if(15<ie[me])return 0;++be[ie[me]]}if(be[0]==de)return 0;for(je[1]=0,se=1;15>se;++se){if(be[se]>1<<se)return 0;je[se+1]=je[se]+be[se]}for(me=0;me<de;++me)se=ie[me],0<ie[me]&&(we[je[se]++]=me);if(je[15]==1)return(ie=new R).g=0,ie.value=we[0],S(G,xe,1,Se,ie),Se;var Te,De=-1,Ie=Se-1,ot=0,Ye=1,Rt=1,nt=1<<Z;for(me=0,se=1,de=2;se<=Z;++se,de<<=1){if(Ye+=Rt<<=1,0>(Rt-=be[se]))return 0;for(;0<be[se];--be[se])(ie=new R).g=se,ie.value=we[me++],S(G,xe+ot,de,nt,ie),ot=N(ot,se)}for(se=Z+1,de=2;15>=se;++se,de<<=1){if(Ye+=Rt<<=1,0>(Rt-=be[se]))return 0;for(;0<be[se];--be[se]){if(ie=new R,(ot&Ie)!=De){for(xe+=nt,Te=1<<(De=se)-Z;15>De&&!(0>=(Te-=be[De]));)++De,Te<<=1;Se+=nt=1<<(Te=De-Z),G[X+(De=ot&Ie)].g=Te+Z,G[X+De].value=xe-X-De}ie.g=se-Z,ie.value=we[me++],S(G,xe+(ot>>Z),de,nt,ie),ot=N(ot,se)}}return Ye!=2*je[15]-1?0:Se}(d,p,x,j,q,W)}function R(){this.value=this.g=0}function $(){this.value=this.g=0}function H(){this.G=o(5,R),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Ol,$)}function Y(d,p,x,j){e(d!=null),e(p!=null),e(2147483648>j),d.Ca=254,d.I=0,d.b=-8,d.Ka=0,d.oa=p,d.pa=x,d.Jd=p,d.Yc=x+j,d.Zc=4<=j?x+j-4+1:x,he(d)}function M(d,p){for(var x=0;0<p--;)x|=ve(d,128)<<p;return x}function U(d,p){var x=M(d,p);return pe(d)?-x:x}function ee(d,p,x,j){var q,W=0;for(e(d!=null),e(p!=null),e(4294967288>j),d.Sb=j,d.Ra=0,d.u=0,d.h=0,4<j&&(j=4),q=0;q<j;++q)W+=p[x+q]<<8*q;d.Ra=W,d.bb=j,d.oa=p,d.pa=x}function fe(d){for(;8<=d.u&&d.bb<d.Sb;)d.Ra>>>=8,d.Ra+=d.oa[d.pa+d.bb]<<No-8>>>0,++d.bb,d.u-=8;K(d)&&(d.h=1,d.u=0)}function Q(d,p){if(e(0<=p),!d.h&&p<=Fi){var x=D(d)&Oi[p];return d.u+=p,fe(d),x}return d.h=1,d.u=0}function w(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function F(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function D(d){return d.Ra>>>(d.u&No-1)>>>0}function K(d){return e(d.bb<=d.Sb),d.h||d.bb==d.Sb&&d.u>No}function te(d,p){d.u=p,d.h=K(d)}function oe(d){d.u>=La&&(e(d.u>=La),fe(d))}function he(d){e(d!=null&&d.oa!=null),d.pa<d.Zc?(d.I=(d.oa[d.pa++]|d.I<<8)>>>0,d.b+=8):(e(d!=null&&d.oa!=null),d.pa<d.Yc?(d.b+=8,d.I=d.oa[d.pa++]|d.I<<8):d.Ka?d.b=0:(d.I<<=8,d.b+=8,d.Ka=1))}function pe(d){return M(d,1)}function ve(d,p){var x=d.Ca;0>d.b&&he(d);var j=d.b,q=x*p>>>8,W=(d.I>>>j>q)+0;for(W?(x-=q,d.I-=q+1<<j>>>0):x=q+1,j=x,q=0;256<=j;)q+=8,j>>=8;return j=7^q+So[j],d.b-=j,d.Ca=(x<<j)-1,W}function Ee(d,p,x){d[p+0]=x>>24&255,d[p+1]=x>>16&255,d[p+2]=x>>8&255,d[p+3]=255&x}function Ve(d,p){return d[p+0]|d[p+1]<<8}function ze(d,p){return Ve(d,p)|d[p+2]<<16}function Ne(d,p){return Ve(d,p)|Ve(d,p+2)<<16}function ae(d,p){var x=1<<p;return e(d!=null),e(0<p),d.X=s(x),d.X==null?0:(d.Mb=32-p,d.Xa=p,1)}function ht(d,p){e(d!=null),e(p!=null),e(d.Xa==p.Xa),r(p.X,0,d.X,0,1<<p.Xa)}function et(){this.X=[],this.Xa=this.Mb=0}function He(d,p,x,j){e(x!=null),e(j!=null);var q=x[0],W=j[0];return q==0&&(q=(d*W+p/2)/p),W==0&&(W=(p*q+d/2)/d),0>=q||0>=W?0:(x[0]=q,j[0]=W,1)}function Re(d,p){return d+(1<<p)-1>>>p}function Xe(d,p){return((4278255360&d)+(4278255360&p)>>>0&4278255360)+((16711935&d)+(16711935&p)>>>0&16711935)>>>0}function $e(d,p){k[p]=function(x,j,q,W,G,X,Z){var ie;for(ie=0;ie<G;++ie){var de=k[d](X[Z+ie-1],q,W+ie);X[Z+ie]=Xe(x[j+ie],de)}}}function Oe(){this.ud=this.hd=this.jd=0}function Pe(d,p){return((4278124286&(d^p))>>>1)+(d&p)>>>0}function qt(d){return 0<=d&&256>d?d:0>d?0:255<d?255:void 0}function Et(d,p){return qt(d+(d-p+.5>>1))}function it(d,p,x){return Math.abs(p-x)-Math.abs(d-x)}function Tt(d,p,x,j,q,W,G){for(j=W[G-1],x=0;x<q;++x)W[G+x]=j=Xe(d[p+x],j)}function wt(d,p,x,j,q){var W;for(W=0;W<x;++W){var G=d[p+W],X=G>>8&255,Z=16711935&(Z=(Z=16711935&G)+((X<<16)+X));j[q+W]=(4278255360&G)+Z>>>0}}function at(d,p){p.jd=255&d,p.hd=d>>8&255,p.ud=d>>16&255}function vt(d,p,x,j,q,W){var G;for(G=0;G<j;++G){var X=p[x+G],Z=X>>>8,ie=X,de=255&(de=(de=X>>>16)+((d.jd<<24>>24)*(Z<<24>>24)>>>5));ie=255&(ie=(ie+=(d.hd<<24>>24)*(Z<<24>>24)>>>5)+((d.ud<<24>>24)*(de<<24>>24)>>>5)),q[W+G]=(4278255360&X)+(de<<16)+ie}}function ut(d,p,x,j,q){k[p]=function(W,G,X,Z,ie,de,we,se,me){for(Z=we;Z<se;++Z)for(we=0;we<me;++we)ie[de++]=q(X[j(W[G++])])},k[d]=function(W,G,X,Z,ie,de,we){var se=8>>W.b,me=W.Ea,xe=W.K[0],Se=W.w;if(8>se)for(W=(1<<W.b)-1,Se=(1<<se)-1;G<X;++G){var be,je=0;for(be=0;be<me;++be)be&W||(je=j(Z[ie++])),de[we++]=q(xe[je&Se]),je>>=se}else k["VP8LMapColor"+x](Z,ie,xe,Se,de,we,G,X,me)}}function en(d,p,x,j,q){for(x=p+x;p<x;){var W=d[p++];j[q++]=W>>16&255,j[q++]=W>>8&255,j[q++]=255&W}}function Gt(d,p,x,j,q){for(x=p+x;p<x;){var W=d[p++];j[q++]=W>>16&255,j[q++]=W>>8&255,j[q++]=255&W,j[q++]=W>>24&255}}function tt(d,p,x,j,q){for(x=p+x;p<x;){var W=(G=d[p++])>>16&240|G>>12&15,G=240&G|G>>28&15;j[q++]=W,j[q++]=G}}function _t(d,p,x,j,q){for(x=p+x;p<x;){var W=(G=d[p++])>>16&248|G>>13&7,G=G>>5&224|G>>3&31;j[q++]=W,j[q++]=G}}function an(d,p,x,j,q){for(x=p+x;p<x;){var W=d[p++];j[q++]=255&W,j[q++]=W>>8&255,j[q++]=W>>16&255}}function pt(d,p,x,j,q,W){if(W==0)for(x=p+x;p<x;)Ee(j,((W=d[p++])[0]>>24|W[1]>>8&65280|W[2]<<8&16711680|W[3]<<24)>>>0),q+=32;else r(j,q,d,p,x)}function Dt(d,p){k[p][0]=k[d+"0"],k[p][1]=k[d+"1"],k[p][2]=k[d+"2"],k[p][3]=k[d+"3"],k[p][4]=k[d+"4"],k[p][5]=k[d+"5"],k[p][6]=k[d+"6"],k[p][7]=k[d+"7"],k[p][8]=k[d+"8"],k[p][9]=k[d+"9"],k[p][10]=k[d+"10"],k[p][11]=k[d+"11"],k[p][12]=k[d+"12"],k[p][13]=k[d+"13"],k[p][14]=k[d+"0"],k[p][15]=k[d+"0"]}function At(d){return d==ig||d==sg||d==Yh||d==ag}function In(){this.eb=[],this.size=this.A=this.fb=0}function Sn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function nn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new In,this.f.kb=new Sn,this.sd=null}function yt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ot(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function zs(d){return alert("todo:WebPSamplerProcessPlane"),d.T}function Xn(d,p){var x=d.T,j=p.ba.f.RGBA,q=j.eb,W=j.fb+d.ka*j.A,G=ls[p.ba.S],X=d.y,Z=d.O,ie=d.f,de=d.N,we=d.ea,se=d.W,me=p.cc,xe=p.dc,Se=p.Mc,be=p.Nc,je=d.ka,Te=d.ka+d.T,De=d.U,Ie=De+1>>1;for(je==0?G(X,Z,null,null,ie,de,we,se,ie,de,we,se,q,W,null,null,De):(G(p.ec,p.fc,X,Z,me,xe,Se,be,ie,de,we,se,q,W-j.A,q,W,De),++x);je+2<Te;je+=2)me=ie,xe=de,Se=we,be=se,de+=d.Rc,se+=d.Rc,W+=2*j.A,G(X,(Z+=2*d.fa)-d.fa,X,Z,me,xe,Se,be,ie,de,we,se,q,W-j.A,q,W,De);return Z+=d.fa,d.j+Te<d.o?(r(p.ec,p.fc,X,Z,De),r(p.cc,p.dc,ie,de,Ie),r(p.Mc,p.Nc,we,se,Ie),x--):1&Te||G(X,Z,null,null,ie,de,we,se,ie,de,we,se,q,W+j.A,null,null,De),x}function ts(d,p,x){var j=d.F,q=[d.J];if(j!=null){var W=d.U,G=p.ba.S,X=G==Kh||G==Yh;p=p.ba.f.RGBA;var Z=[0],ie=d.ka;Z[0]=d.T,d.Kb&&(ie==0?--Z[0]:(--ie,q[0]-=d.width),d.j+d.ka+d.T==d.o&&(Z[0]=d.o-d.j-ie));var de=p.eb;ie=p.fb+ie*p.A,d=n2(j,q[0],d.width,W,Z,de,ie+(X?0:3),p.A),e(x==Z),d&&At(G)&&td(de,ie,X,W,Z,p.A)}return 0}function Br(d){var p=d.ma,x=p.ba.S,j=11>x,q=x==Wh||x==Gh||x==Kh||x==rg||x==12||At(x);if(p.memory=null,p.Ib=null,p.Jb=null,p.Nd=null,!Gu(p.Oa,d,q?11:12))return 0;if(q&&At(x)&&Ml(),d.da)alert("todo:use_scaling");else{if(j){if(p.Ib=zs,d.Kb){if(x=d.U+1>>1,p.memory=s(d.U+2*x),p.memory==null)return 0;p.ec=p.memory,p.fc=0,p.cc=p.ec,p.dc=p.fc+d.U,p.Mc=p.cc,p.Nc=p.dc+x,p.Ib=Xn,Ml()}}else alert("todo:EmitYUV");q&&(p.Jb=ts,j&&bn())}if(j&&!y2){for(d=0;256>d;++d)xE[d]=89858*(d-128)+Xh>>Qh,_E[d]=-22014*(d-128)+Xh,wE[d]=-45773*(d-128),bE[d]=113618*(d-128)+Xh>>Qh;for(d=rd;d<cg;++d)p=76283*(d-16)+Xh>>Qh,NE[d-rd]=Mt(p,255),SE[d-rd]=Mt(p+8>>4,15);y2=1}return 1}function mt(d){var p=d.ma,x=d.U,j=d.T;return e(!(1&d.ka)),0>=x||0>=j?0:(x=p.Ib(d,p),p.Jb!=null&&p.Jb(d,p,x),p.Dc+=x,1)}function En(d){d.ma.memory=null}function ns(d,p,x,j){return Q(d,8)!=47?0:(p[0]=Q(d,14)+1,x[0]=Q(d,14)+1,j[0]=Q(d,1),Q(d,3)!=0?0:!d.h)}function wr(d,p){if(4>d)return d+1;var x=d-2>>1;return(2+(1&d)<<x)+Q(p,x)+1}function _r(d,p){return 120<p?p-120:1<=(x=((x=sE[p-1])>>4)*d+(8-(15&x)))?x:1;var x}function Pn(d,p,x){var j=D(x),q=d[p+=255&j].g-8;return 0<q&&(te(x,x.u+8),j=D(x),p+=d[p].value,p+=j&(1<<q)-1),te(x,x.u+d[p].g),d[p].value}function cr(d,p,x){return x.g+=d.g,x.value+=d.value<<p>>>0,e(8>=x.g),d.g}function Rn(d,p,x){var j=d.xc;return e((p=j==0?0:d.vc[d.md*(x>>j)+(p>>j)])<d.Wb),d.Ya[p]}function Ea(d,p,x,j){var q=d.ab,W=d.c*p,G=d.C;p=G+p;var X=x,Z=j;for(j=d.Ta,x=d.Ua;0<q--;){var ie=d.gc[q],de=G,we=p,se=X,me=Z,xe=(Z=j,X=x,ie.Ea);switch(e(de<we),e(we<=ie.nc),ie.hc){case 2:Zn(se,me,(we-de)*xe,Z,X);break;case 0:var Se=de,be=we,je=Z,Te=X,De=(nt=ie).Ea;Se==0&&(Yu(se,me,null,null,1,je,Te),Tt(se,me+1,0,0,De-1,je,Te+1),me+=De,Te+=De,++Se);for(var Ie=1<<nt.b,ot=Ie-1,Ye=Re(De,nt.b),Rt=nt.K,nt=nt.w+(Se>>nt.b)*Ye;Se<be;){var Ht=Rt,pr=nt,Lt=1;for(Tc(se,me,je,Te-De,1,je,Te);Lt<De;){var rt=(Lt&~ot)+Ie;rt>De&&(rt=De),(0,Xu[Ht[pr++]>>8&15])(se,me+ +Lt,je,Te+Lt-De,rt-Lt,je,Te+Lt),Lt=rt}me+=De,Te+=De,++Se&ot||(nt+=Ye)}we!=ie.nc&&r(Z,X-xe,Z,X+(we-de-1)*xe,xe);break;case 1:for(xe=se,be=me,De=(se=ie.Ea)-(Te=se&~(je=(me=1<<ie.b)-1)),Se=Re(se,ie.b),Ie=ie.K,ie=ie.w+(de>>ie.b)*Se;de<we;){for(ot=Ie,Ye=ie,Rt=new Oe,nt=be+Te,Ht=be+se;be<nt;)at(ot[Ye++],Rt),Ju(Rt,xe,be,me,Z,X),be+=me,X+=me;be<Ht&&(at(ot[Ye++],Rt),Ju(Rt,xe,be,De,Z,X),be+=De,X+=De),++de&je||(ie+=Se)}break;case 3:if(se==Z&&me==X&&0<ie.b){for(be=Z,se=xe=X+(we-de)*xe-(Te=(we-de)*Re(ie.Ea,ie.b)),me=Z,je=X,Se=[],Te=(De=Te)-1;0<=Te;--Te)Se[Te]=me[je+Te];for(Te=De-1;0<=Te;--Te)be[se+Te]=Se[Te];zh(ie,de,we,Z,xe,Z,X)}else zh(ie,de,we,se,me,Z,X)}X=j,Z=x}Z!=x&&r(j,x,X,Z,W)}function qs(d,p){var x=d.V,j=d.Ba+d.c*d.C,q=p-d.C;if(e(p<=d.l.o),e(16>=q),0<q){var W=d.l,G=d.Ta,X=d.Ua,Z=W.width;if(Ea(d,q,x,j),q=X=[X],e((x=d.C)<(j=p)),e(W.v<W.va),j>W.o&&(j=W.o),x<W.j){var ie=W.j-x;x=W.j,q[0]+=ie*Z}if(x>=j?x=0:(q[0]+=4*W.v,W.ka=x-W.j,W.U=W.va-W.v,W.T=j-x,x=1),x){if(X=X[0],11>(x=d.ca).S){var de=x.f.RGBA,we=(j=x.S,q=W.U,W=W.T,ie=de.eb,de.A),se=W;for(de=de.fb+d.Ma*de.A;0<se--;){var me=G,xe=X,Se=q,be=ie,je=de;switch(j){case Hh:Zu(me,xe,Se,be,je);break;case Wh:Eo(me,xe,Se,be,je);break;case ig:Eo(me,xe,Se,be,je),td(be,je,0,Se,1,0);break;case c2:Fl(me,xe,Se,be,je);break;case Gh:pt(me,xe,Se,be,je,1);break;case sg:pt(me,xe,Se,be,je,1),td(be,je,0,Se,1,0);break;case Kh:pt(me,xe,Se,be,je,0);break;case Yh:pt(me,xe,Se,be,je,0),td(be,je,1,Se,1,0);break;case rg:Ao(me,xe,Se,be,je);break;case ag:Ao(me,xe,Se,be,je),t2(be,je,Se,1,0);break;case u2:jo(me,xe,Se,be,je);break;default:e(0)}X+=Z,de+=we}d.Ma+=W}else alert("todo:EmitRescaledRowsYUVA");e(d.Ma<=x.height)}}d.C=p,e(d.C<=d.i)}function zr(d){var p;if(0<d.ua)return 0;for(p=0;p<d.Wb;++p){var x=d.Ya[p].G,j=d.Ya[p].H;if(0<x[1][j[1]+0].g||0<x[2][j[2]+0].g||0<x[3][j[3]+0].g)return 0}return 1}function Ii(d,p,x,j,q,W){if(d.Z!=0){var G=d.qd,X=d.rd;for(e(Co[d.Z]!=null);p<x;++p)Co[d.Z](G,X,j,q,j,q,W),G=j,X=q,q+=W;d.qd=G,d.rd=X}}function ai(d,p){var x=d.l.ma,j=x.Z==0||x.Z==1?d.l.j:d.C;if(j=d.C<j?j:d.C,e(p<=d.l.o),p>j){var q=d.l.width,W=x.ca,G=x.tb+q*j,X=d.V,Z=d.Ba+d.c*j,ie=d.gc;e(d.ab==1),e(ie[0].hc==3),na(ie[0],j,p,X,Z,W,G),Ii(x,j,p,W,G,q)}d.C=d.Ma=p}function qr(d,p,x,j,q,W,G){var X=d.$/j,Z=d.$%j,ie=d.m,de=d.s,we=x+d.$,se=we;q=x+j*q;var me=x+j*W,xe=280+de.ua,Se=d.Pb?X:16777216,be=0<de.ua?de.Wa:null,je=de.wc,Te=we<me?Rn(de,Z,X):null;e(d.C<W),e(me<=q);var De=!1;e:for(;;){for(;De||we<me;){var Ie=0;if(X>=Se){var ot=we-x;e((Se=d).Pb),Se.wd=Se.m,Se.xd=ot,0<Se.s.ua&&ht(Se.s.Wa,Se.s.vb),Se=X+oE}if(Z&je||(Te=Rn(de,Z,X)),e(Te!=null),Te.Qb&&(p[we]=Te.qb,De=!0),!De)if(oe(ie),Te.jc){Ie=ie,ot=p;var Ye=we,Rt=Te.pd[D(Ie)&Ol-1];e(Te.jc),256>Rt.g?(te(Ie,Ie.u+Rt.g),ot[Ye]=Rt.value,Ie=0):(te(Ie,Ie.u+Rt.g-256),e(256<=Rt.value),Ie=Rt.value),Ie==0&&(De=!0)}else Ie=Pn(Te.G[0],Te.H[0],ie);if(ie.h)break;if(De||256>Ie){if(!De)if(Te.nd)p[we]=(Te.qb|Ie<<8)>>>0;else{if(oe(ie),De=Pn(Te.G[1],Te.H[1],ie),oe(ie),ot=Pn(Te.G[2],Te.H[2],ie),Ye=Pn(Te.G[3],Te.H[3],ie),ie.h)break;p[we]=(Ye<<24|De<<16|Ie<<8|ot)>>>0}if(De=!1,++we,++Z>=j&&(Z=0,++X,G!=null&&X<=W&&!(X%16)&&G(d,X),be!=null))for(;se<we;)Ie=p[se++],be.X[(506832829*Ie&4294967295)>>>be.Mb]=Ie}else if(280>Ie){if(Ie=wr(Ie-256,ie),ot=Pn(Te.G[4],Te.H[4],ie),oe(ie),ot=_r(j,ot=wr(ot,ie)),ie.h)break;if(we-x<ot||q-we<Ie)break e;for(Ye=0;Ye<Ie;++Ye)p[we+Ye]=p[we+Ye-ot];for(we+=Ie,Z+=Ie;Z>=j;)Z-=j,++X,G!=null&&X<=W&&!(X%16)&&G(d,X);if(e(we<=q),Z&je&&(Te=Rn(de,Z,X)),be!=null)for(;se<we;)Ie=p[se++],be.X[(506832829*Ie&4294967295)>>>be.Mb]=Ie}else{if(!(Ie<xe))break e;for(De=Ie-280,e(be!=null);se<we;)Ie=p[se++],be.X[(506832829*Ie&4294967295)>>>be.Mb]=Ie;Ie=we,e(!(De>>>(ot=be).Xa)),p[Ie]=ot.X[De],De=!0}De||e(ie.h==K(ie))}if(d.Pb&&ie.h&&we<q)e(d.m.h),d.a=5,d.m=d.wd,d.$=d.xd,0<d.s.ua&&ht(d.s.vb,d.s.Wa);else{if(ie.h)break e;G!=null&&G(d,X>W?W:X),d.a=0,d.$=we-x}return 1}return d.a=3,0}function Jn(d){e(d!=null),d.vc=null,d.yc=null,d.Ya=null;var p=d.Wa;p!=null&&(p.X=null),d.vb=null,e(d!=null)}function $s(){var d=new Je;return d==null?null:(d.a=0,d.xb=f2,Dt("Predictor","VP8LPredictors"),Dt("Predictor","VP8LPredictors_C"),Dt("PredictorAdd","VP8LPredictorsAdd"),Dt("PredictorAdd","VP8LPredictorsAdd_C"),Zn=wt,Ju=vt,Zu=en,Eo=Gt,Ao=tt,jo=_t,Fl=an,k.VP8LMapColor32b=ta,k.VP8LMapColor8b=Qu,d)}function Pi(d,p,x,j,q){var W=1,G=[d],X=[p],Z=j.m,ie=j.s,de=null,we=0;e:for(;;){if(x)for(;W&&Q(Z,1);){var se=G,me=X,xe=j,Se=1,be=xe.m,je=xe.gc[xe.ab],Te=Q(be,2);if(xe.Oc&1<<Te)W=0;else{switch(xe.Oc|=1<<Te,je.hc=Te,je.Ea=se[0],je.nc=me[0],je.K=[null],++xe.ab,e(4>=xe.ab),Te){case 0:case 1:je.b=Q(be,3)+2,Se=Pi(Re(je.Ea,je.b),Re(je.nc,je.b),0,xe,je.K),je.K=je.K[0];break;case 3:var De,Ie=Q(be,8)+1,ot=16<Ie?0:4<Ie?1:2<Ie?2:3;if(se[0]=Re(je.Ea,ot),je.b=ot,De=Se=Pi(Ie,1,0,xe,je.K)){var Ye,Rt=Ie,nt=je,Ht=1<<(8>>nt.b),pr=s(Ht);if(pr==null)De=0;else{var Lt=nt.K[0],rt=nt.w;for(pr[0]=nt.K[0][0],Ye=1;Ye<1*Rt;++Ye)pr[Ye]=Xe(Lt[rt+Ye],pr[Ye-1]);for(;Ye<4*Ht;++Ye)pr[Ye]=0;nt.K[0]=null,nt.K[0]=pr,De=1}}Se=De;break;case 2:break;default:e(0)}W=Se}}if(G=G[0],X=X[0],W&&Q(Z,1)&&!(W=1<=(we=Q(Z,4))&&11>=we)){j.a=3;break e}var qe;if(qe=W)t:{var tr,Pt,Yt,An=j,Ir=G,ci=X,Gn=we,Hr=x,ui=An.m,gr=An.s,Xt=[null],cn=1,Kn=0,un=aE[Gn];n:for(;;){if(Hr&&Q(ui,1)){var Pr=Q(ui,3)+2,As=Re(Ir,Pr),nr=Re(ci,Pr),bi=As*nr;if(!Pi(As,nr,0,An,Xt))break n;for(Xt=Xt[0],gr.xc=Pr,tr=0;tr<bi;++tr){var vn=Xt[tr]>>8&65535;Xt[tr]=vn,vn>=cn&&(cn=vn+1)}}if(ui.h)break n;for(Pt=0;5>Pt;++Pt){var vr=d2[Pt];!Pt&&0<Gn&&(vr+=1<<Gn),Kn<vr&&(Kn=vr)}var Ui=o(cn*un,R),di=cn,Bi=o(di,H);if(Bi==null)var zi=null;else e(65536>=di),zi=Bi;var wi=s(Kn);if(zi==null||wi==null||Ui==null){An.a=1;break n}var qi=Ui;for(tr=Yt=0;tr<cn;++tr){var _n=zi[tr],$i=_n.G,js=_n.H,Ul=0,Oa=1,Rr=0;for(Pt=0;5>Pt;++Pt){vr=d2[Pt],$i[Pt]=qi,js[Pt]=Yt,!Pt&&0<Gn&&(vr+=1<<Gn);i:{var Zh,ug=vr,ef=An,id=wi,jE=qi,TE=Yt,dg=0,Io=ef.m,kE=Q(Io,1);if(i(id,0,0,ug),kE){var CE=Q(Io,1)+1,IE=Q(Io,1),w2=Q(Io,IE==0?1:8);id[w2]=1,CE==2&&(id[w2=Q(Io,8)]=1);var tf=1}else{var _2=s(19),N2=Q(Io,4)+4;if(19<N2){ef.a=3;var nf=0;break i}for(Zh=0;Zh<N2;++Zh)_2[iE[Zh]]=Q(Io,3);var hg=void 0,sd=void 0,S2=ef,PE=_2,rf=ug,E2=id,fg=0,Po=S2.m,A2=8,j2=o(128,R);r:for(;P(j2,0,7,PE,19);){if(Q(Po,1)){var RE=2+2*Q(Po,3);if((hg=2+Q(Po,RE))>rf)break r}else hg=rf;for(sd=0;sd<rf&&hg--;){oe(Po);var T2=j2[0+(127&D(Po))];te(Po,Po.u+T2.g);var Cc=T2.value;if(16>Cc)E2[sd++]=Cc,Cc!=0&&(A2=Cc);else{var LE=Cc==16,k2=Cc-16,DE=nE[k2],C2=Q(Po,tE[k2])+DE;if(sd+C2>rf)break r;for(var ME=LE?A2:0;0<C2--;)E2[sd++]=ME}}fg=1;break r}fg||(S2.a=3),tf=fg}(tf=tf&&!Io.h)&&(dg=P(jE,TE,8,id,ug)),tf&&dg!=0?nf=dg:(ef.a=3,nf=0)}if(nf==0)break n;if(Oa&&rE[Pt]==1&&(Oa=qi[Yt].g==0),Ul+=qi[Yt].g,Yt+=nf,3>=Pt){var ad,mg=wi[0];for(ad=1;ad<vr;++ad)wi[ad]>mg&&(mg=wi[ad]);Rr+=mg}}if(_n.nd=Oa,_n.Qb=0,Oa&&(_n.qb=($i[3][js[3]+0].value<<24|$i[1][js[1]+0].value<<16|$i[2][js[2]+0].value)>>>0,Ul==0&&256>$i[0][js[0]+0].value&&(_n.Qb=1,_n.qb+=$i[0][js[0]+0].value<<8)),_n.jc=!_n.Qb&&6>Rr,_n.jc){var sf,Fa=_n;for(sf=0;sf<Ol;++sf){var Ro=sf,Lo=Fa.pd[Ro],af=Fa.G[0][Fa.H[0]+Ro];256<=af.value?(Lo.g=af.g+256,Lo.value=af.value):(Lo.g=0,Lo.value=0,Ro>>=cr(af,8,Lo),Ro>>=cr(Fa.G[1][Fa.H[1]+Ro],16,Lo),Ro>>=cr(Fa.G[2][Fa.H[2]+Ro],0,Lo),cr(Fa.G[3][Fa.H[3]+Ro],24,Lo))}}}gr.vc=Xt,gr.Wb=cn,gr.Ya=zi,gr.yc=Ui,qe=1;break t}qe=0}if(!(W=qe)){j.a=3;break e}if(0<we){if(ie.ua=1<<we,!ae(ie.Wa,we)){j.a=1,W=0;break e}}else ie.ua=0;var pg=j,I2=G,OE=X,gg=pg.s,vg=gg.xc;if(pg.c=I2,pg.i=OE,gg.md=Re(I2,vg),gg.wc=vg==0?-1:(1<<vg)-1,x){j.xb=mE;break e}if((de=s(G*X))==null){j.a=1,W=0;break e}W=(W=qr(j,de,0,G,X,X,null))&&!Z.h;break e}return W?(q!=null?q[0]=de:(e(de==null),e(x)),j.$=0,x||Jn(ie)):Jn(ie),W}function xs(d,p){var x=d.c*d.i,j=x+p+16*p;return e(d.c<=p),d.V=s(j),d.V==null?(d.Ta=null,d.Ua=0,d.a=1,0):(d.Ta=d.V,d.Ua=d.Ba+x+p,1)}function Hs(d,p){var x=d.C,j=p-x,q=d.V,W=d.Ba+d.c*x;for(e(p<=d.l.o);0<j;){var G=16<j?16:j,X=d.l.ma,Z=d.l.width,ie=Z*G,de=X.ca,we=X.tb+Z*x,se=d.Ta,me=d.Ua;Ea(d,G,q,W),r2(se,me,de,we,ie),Ii(X,x,x+G,de,we,Z),j-=G,q+=G*d.c,x+=G}e(x==p),d.C=d.Ma=p}function Aa(){this.ub=this.yd=this.td=this.Rb=0}function ja(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Uu(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Ws(){this.Yb=function(){var d=[];return function p(x,j,q){for(var W=q[j],G=0;G<W&&(x.push(q.length>j+1?[]:0),!(q.length<j+1));G++)p(x[G],j+1,q)}(d,0,[3,11]),d}()}function _l(){this.jb=s(3),this.Wc=l([4,8],Ws),this.Xc=l([4,17],Ws)}function fo(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Nr(){this.ld=this.La=this.dd=this.tc=0}function Ri(){this.Na=this.la=0}function mo(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Nl(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Sl(){this.uc=this.M=this.Nb=0,this.wa=Array(new Nr),this.Y=0,this.ya=Array(new Nl),this.aa=0,this.l=new Gs}function El(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Al(){this.cb=this.a=0,this.sc="",this.m=new w,this.Od=new Aa,this.Kc=new ja,this.ed=new fo,this.Qa=new Uu,this.Ic=this.$c=this.Aa=0,this.D=new Sl,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,w),this.ia=0,this.pb=o(4,mo),this.Pa=new _l,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new El),this.Hd=0,this.rb=Array(new Ri),this.sb=0,this.wa=Array(new Nr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Nl),this.L=this.aa=0,this.gd=l([4,2],Nr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Gs(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function jl(){var d=new Al;return d!=null&&(d.a=0,d.sc="OK",d.cb=0,d.Xb=0,nd||(nd=bs)),d}function On(d,p,x){return d.a==0&&(d.a=p,d.sc=x,d.cb=0),0}function Tl(d,p,x){return 3<=x&&d[p+0]==157&&d[p+1]==1&&d[p+2]==42}function Ec(d,p){if(d==null)return 0;if(d.a=0,d.sc="OK",p==null)return On(d,2,"null VP8Io passed to VP8GetHeaders()");var x=p.data,j=p.w,q=p.ha;if(4>q)return On(d,7,"Truncated header.");var W=x[j+0]|x[j+1]<<8|x[j+2]<<16,G=d.Od;if(G.Rb=!(1&W),G.td=W>>1&7,G.yd=W>>4&1,G.ub=W>>5,3<G.td)return On(d,3,"Incorrect keyframe parameters.");if(!G.yd)return On(d,4,"Frame not displayable.");j+=3,q-=3;var X=d.Kc;if(G.Rb){if(7>q)return On(d,7,"cannot parse picture header");if(!Tl(x,j,q))return On(d,3,"Bad code word");X.c=16383&(x[j+4]<<8|x[j+3]),X.Td=x[j+4]>>6,X.i=16383&(x[j+6]<<8|x[j+5]),X.Ud=x[j+6]>>6,j+=7,q-=7,d.za=X.c+15>>4,d.Ub=X.i+15>>4,p.width=X.c,p.height=X.i,p.Da=0,p.j=0,p.v=0,p.va=p.width,p.o=p.height,p.da=0,p.ib=p.width,p.hb=p.height,p.U=p.width,p.T=p.height,i((W=d.Pa).jb,0,255,W.jb.length),e((W=d.Qa)!=null),W.Cb=0,W.Bb=0,W.Fb=1,i(W.Zb,0,0,W.Zb.length),i(W.Lb,0,0,W.Lb)}if(G.ub>q)return On(d,7,"bad partition length");Y(W=d.m,x,j,G.ub),j+=G.ub,q-=G.ub,G.Rb&&(X.Ld=pe(W),X.Kd=pe(W)),X=d.Qa;var Z,ie=d.Pa;if(e(W!=null),e(X!=null),X.Cb=pe(W),X.Cb){if(X.Bb=pe(W),pe(W)){for(X.Fb=pe(W),Z=0;4>Z;++Z)X.Zb[Z]=pe(W)?U(W,7):0;for(Z=0;4>Z;++Z)X.Lb[Z]=pe(W)?U(W,6):0}if(X.Bb)for(Z=0;3>Z;++Z)ie.jb[Z]=pe(W)?M(W,8):255}else X.Bb=0;if(W.Ka)return On(d,3,"cannot parse segment header");if((X=d.ed).zd=pe(W),X.Tb=M(W,6),X.wb=M(W,3),X.Pc=pe(W),X.Pc&&pe(W)){for(ie=0;4>ie;++ie)pe(W)&&(X.vd[ie]=U(W,6));for(ie=0;4>ie;++ie)pe(W)&&(X.od[ie]=U(W,6))}if(d.L=X.Tb==0?0:X.zd?1:2,W.Ka)return On(d,3,"cannot parse filter header");var de=q;if(q=Z=j,j=Z+de,X=de,d.Xb=(1<<M(d.m,2))-1,de<3*(ie=d.Xb))x=7;else{for(Z+=3*ie,X-=3*ie,de=0;de<ie;++de){var we=x[q+0]|x[q+1]<<8|x[q+2]<<16;we>X&&(we=X),Y(d.Jc[+de],x,Z,we),Z+=we,X-=we,q+=3}Y(d.Jc[+ie],x,Z,X),x=Z<j?0:5}if(x!=0)return On(d,x,"cannot parse partitions");for(x=M(Z=d.m,7),q=pe(Z)?U(Z,4):0,j=pe(Z)?U(Z,4):0,X=pe(Z)?U(Z,4):0,ie=pe(Z)?U(Z,4):0,Z=pe(Z)?U(Z,4):0,de=d.Qa,we=0;4>we;++we){if(de.Cb){var se=de.Zb[we];de.Fb||(se+=x)}else{if(0<we){d.pb[we]=d.pb[0];continue}se=x}var me=d.pb[we];me.Sc[0]=og[Mt(se+q,127)],me.Sc[1]=lg[Mt(se+0,127)],me.Eb[0]=2*og[Mt(se+j,127)],me.Eb[1]=101581*lg[Mt(se+X,127)]>>16,8>me.Eb[1]&&(me.Eb[1]=8),me.Qc[0]=og[Mt(se+ie,117)],me.Qc[1]=lg[Mt(se+Z,127)],me.lc=se+Z}if(!G.Rb)return On(d,4,"Not a key frame.");for(pe(W),G=d.Pa,x=0;4>x;++x){for(q=0;8>q;++q)for(j=0;3>j;++j)for(X=0;11>X;++X)ie=ve(W,hE[x][q][j][X])?M(W,8):uE[x][q][j][X],G.Wc[x][q].Yb[j][X]=ie;for(q=0;17>q;++q)G.Xc[x][q]=G.Wc[x][fE[q]]}return d.kc=pe(W),d.kc&&(d.Bd=M(W,8)),d.cb=1}function bs(d,p,x,j,q,W,G){var X=p[q].Yb[x];for(x=0;16>q;++q){if(!ve(d,X[x+0]))return q;for(;!ve(d,X[x+1]);)if(X=p[++q].Yb[0],x=0,q==16)return 16;var Z=p[q+1].Yb;if(ve(d,X[x+2])){var ie=d,de=0;if(ve(ie,(se=X)[(we=x)+3]))if(ve(ie,se[we+6])){for(X=0,we=2*(de=ve(ie,se[we+8]))+(se=ve(ie,se[we+9+de])),de=0,se=lE[we];se[X];++X)de+=de+ve(ie,se[X]);de+=3+(8<<we)}else ve(ie,se[we+7])?(de=7+2*ve(ie,165),de+=ve(ie,145)):de=5+ve(ie,159);else de=ve(ie,se[we+4])?3+ve(ie,se[we+5]):2;X=Z[2]}else de=1,X=Z[1];Z=G+cE[q],0>(ie=d).b&&he(ie);var we,se=ie.b,me=(we=ie.Ca>>1)-(ie.I>>se)>>31;--ie.b,ie.Ca+=me,ie.Ca|=1,ie.I-=(we+1&me)<<se,W[Z]=((de^me)-me)*j[(0<q)+0]}return 16}function Ks(d){var p=d.rb[d.sb-1];p.la=0,p.Na=0,i(d.zc,0,0,d.zc.length),d.ja=0}function gi(d,p,x,j,q){q=d[p+x+32*j]+(q>>3),d[p+x+32*j]=-256&q?0>q?0:255:q}function Ta(d,p,x,j,q,W){gi(d,p,0,x,j+q),gi(d,p,1,x,j+W),gi(d,p,2,x,j-W),gi(d,p,3,x,j-q)}function on(d){return(20091*d>>16)+d}function oi(d,p,x,j){var q,W=0,G=s(16);for(q=0;4>q;++q){var X=d[p+0]+d[p+8],Z=d[p+0]-d[p+8],ie=(35468*d[p+4]>>16)-on(d[p+12]),de=on(d[p+4])+(35468*d[p+12]>>16);G[W+0]=X+de,G[W+1]=Z+ie,G[W+2]=Z-ie,G[W+3]=X-de,W+=4,p++}for(q=W=0;4>q;++q)X=(d=G[W+0]+4)+G[W+8],Z=d-G[W+8],ie=(35468*G[W+4]>>16)-on(G[W+12]),gi(x,j,0,0,X+(de=on(G[W+4])+(35468*G[W+12]>>16))),gi(x,j,1,0,Z+ie),gi(x,j,2,0,Z-ie),gi(x,j,3,0,X-de),W++,j+=32}function po(d,p,x,j){var q=d[p+0]+4,W=35468*d[p+4]>>16,G=on(d[p+4]),X=35468*d[p+1]>>16;Ta(x,j,0,q+G,d=on(d[p+1]),X),Ta(x,j,1,q+W,d,X),Ta(x,j,2,q-W,d,X),Ta(x,j,3,q-G,d,X)}function go(d,p,x,j,q){oi(d,p,x,j),q&&oi(d,p+16,x,j+4)}function Ac(d,p,x,j){Vl(d,p+0,x,j,1),Vl(d,p+32,x,j+128,1)}function Ut(d,p,x,j){var q;for(d=d[p+0]+4,q=0;4>q;++q)for(p=0;4>p;++p)gi(x,j,p,q,d)}function ka(d,p,x,j){d[p+0]&&sn(d,p+0,x,j),d[p+16]&&sn(d,p+16,x,j+4),d[p+32]&&sn(d,p+32,x,j+128),d[p+48]&&sn(d,p+48,x,j+128+4)}function Ys(d,p,x,j){var q,W=s(16);for(q=0;4>q;++q){var G=d[p+0+q]+d[p+12+q],X=d[p+4+q]+d[p+8+q],Z=d[p+4+q]-d[p+8+q],ie=d[p+0+q]-d[p+12+q];W[0+q]=G+X,W[8+q]=G-X,W[4+q]=ie+Z,W[12+q]=ie-Z}for(q=0;4>q;++q)G=(d=W[0+4*q]+3)+W[3+4*q],X=W[1+4*q]+W[2+4*q],Z=W[1+4*q]-W[2+4*q],ie=d-W[3+4*q],x[j+0]=G+X>>3,x[j+16]=ie+Z>>3,x[j+32]=G-X>>3,x[j+48]=ie-Z>>3,j+=64}function vi(d,p,x){var j,q=p-32,W=Vi,G=255-d[q-1];for(j=0;j<x;++j){var X,Z=W,ie=G+d[p-1];for(X=0;X<x;++X)d[p+X]=Z[ie+d[q+X]];p+=32}}function kl(d,p){vi(d,p,4)}function jc(d,p){vi(d,p,8)}function Bu(d,p){vi(d,p,16)}function zu(d,p){var x;for(x=0;16>x;++x)r(d,p+32*x,d,p-32,16)}function Cl(d,p){var x;for(x=16;0<x;--x)i(d,p,d[p-1],16),p+=32}function Ca(d,p,x){var j;for(j=0;16>j;++j)i(p,x+32*j,d,16)}function yi(d,p){var x,j=16;for(x=0;16>x;++x)j+=d[p-1+32*x]+d[p+x-32];Ca(j>>5,d,p)}function rs(d,p){var x,j=8;for(x=0;16>x;++x)j+=d[p-1+32*x];Ca(j>>4,d,p)}function Qs(d,p){var x,j=8;for(x=0;16>x;++x)j+=d[p+x-32];Ca(j>>4,d,p)}function vo(d,p){Ca(128,d,p)}function xt(d,p,x){return d+2*p+x+2>>2}function Xs(d,p){var x,j=p-32;for(j=new Uint8Array([xt(d[j-1],d[j+0],d[j+1]),xt(d[j+0],d[j+1],d[j+2]),xt(d[j+1],d[j+2],d[j+3]),xt(d[j+2],d[j+3],d[j+4])]),x=0;4>x;++x)r(d,p+32*x,j,0,j.length)}function qu(d,p){var x=d[p-1],j=d[p-1+32],q=d[p-1+64],W=d[p-1+96];Ee(d,p+0,16843009*xt(d[p-1-32],x,j)),Ee(d,p+32,16843009*xt(x,j,q)),Ee(d,p+64,16843009*xt(j,q,W)),Ee(d,p+96,16843009*xt(q,W,W))}function $u(d,p){var x,j=4;for(x=0;4>x;++x)j+=d[p+x-32]+d[p-1+32*x];for(j>>=3,x=0;4>x;++x)i(d,p+32*x,j,4)}function Hu(d,p){var x=d[p-1+0],j=d[p-1+32],q=d[p-1+64],W=d[p-1-32],G=d[p+0-32],X=d[p+1-32],Z=d[p+2-32],ie=d[p+3-32];d[p+0+96]=xt(j,q,d[p-1+96]),d[p+1+96]=d[p+0+64]=xt(x,j,q),d[p+2+96]=d[p+1+64]=d[p+0+32]=xt(W,x,j),d[p+3+96]=d[p+2+64]=d[p+1+32]=d[p+0+0]=xt(G,W,x),d[p+3+64]=d[p+2+32]=d[p+1+0]=xt(X,G,W),d[p+3+32]=d[p+2+0]=xt(Z,X,G),d[p+3+0]=xt(ie,Z,X)}function Sr(d,p){var x=d[p+1-32],j=d[p+2-32],q=d[p+3-32],W=d[p+4-32],G=d[p+5-32],X=d[p+6-32],Z=d[p+7-32];d[p+0+0]=xt(d[p+0-32],x,j),d[p+1+0]=d[p+0+32]=xt(x,j,q),d[p+2+0]=d[p+1+32]=d[p+0+64]=xt(j,q,W),d[p+3+0]=d[p+2+32]=d[p+1+64]=d[p+0+96]=xt(q,W,G),d[p+3+32]=d[p+2+64]=d[p+1+96]=xt(W,G,X),d[p+3+64]=d[p+2+96]=xt(G,X,Z),d[p+3+96]=xt(X,Z,Z)}function ws(d,p){var x=d[p-1+0],j=d[p-1+32],q=d[p-1+64],W=d[p-1-32],G=d[p+0-32],X=d[p+1-32],Z=d[p+2-32],ie=d[p+3-32];d[p+0+0]=d[p+1+64]=W+G+1>>1,d[p+1+0]=d[p+2+64]=G+X+1>>1,d[p+2+0]=d[p+3+64]=X+Z+1>>1,d[p+3+0]=Z+ie+1>>1,d[p+0+96]=xt(q,j,x),d[p+0+64]=xt(j,x,W),d[p+0+32]=d[p+1+96]=xt(x,W,G),d[p+1+32]=d[p+2+96]=xt(W,G,X),d[p+2+32]=d[p+3+96]=xt(G,X,Z),d[p+3+32]=xt(X,Z,ie)}function Wu(d,p){var x=d[p+0-32],j=d[p+1-32],q=d[p+2-32],W=d[p+3-32],G=d[p+4-32],X=d[p+5-32],Z=d[p+6-32],ie=d[p+7-32];d[p+0+0]=x+j+1>>1,d[p+1+0]=d[p+0+64]=j+q+1>>1,d[p+2+0]=d[p+1+64]=q+W+1>>1,d[p+3+0]=d[p+2+64]=W+G+1>>1,d[p+0+32]=xt(x,j,q),d[p+1+32]=d[p+0+96]=xt(j,q,W),d[p+2+32]=d[p+1+96]=xt(q,W,G),d[p+3+32]=d[p+2+96]=xt(W,G,X),d[p+3+64]=xt(G,X,Z),d[p+3+96]=xt(X,Z,ie)}function yo(d,p){var x=d[p-1+0],j=d[p-1+32],q=d[p-1+64],W=d[p-1+96];d[p+0+0]=x+j+1>>1,d[p+2+0]=d[p+0+32]=j+q+1>>1,d[p+2+32]=d[p+0+64]=q+W+1>>1,d[p+1+0]=xt(x,j,q),d[p+3+0]=d[p+1+32]=xt(j,q,W),d[p+3+32]=d[p+1+64]=xt(q,W,W),d[p+3+64]=d[p+2+64]=d[p+0+96]=d[p+1+96]=d[p+2+96]=d[p+3+96]=W}function _s(d,p){var x=d[p-1+0],j=d[p-1+32],q=d[p-1+64],W=d[p-1+96],G=d[p-1-32],X=d[p+0-32],Z=d[p+1-32],ie=d[p+2-32];d[p+0+0]=d[p+2+32]=x+G+1>>1,d[p+0+32]=d[p+2+64]=j+x+1>>1,d[p+0+64]=d[p+2+96]=q+j+1>>1,d[p+0+96]=W+q+1>>1,d[p+3+0]=xt(X,Z,ie),d[p+2+0]=xt(G,X,Z),d[p+1+0]=d[p+3+32]=xt(x,G,X),d[p+1+32]=d[p+3+64]=xt(j,x,G),d[p+1+64]=d[p+3+96]=xt(q,j,x),d[p+1+96]=xt(W,q,j)}function xo(d,p){var x;for(x=0;8>x;++x)r(d,p+32*x,d,p-32,8)}function Li(d,p){var x;for(x=0;8>x;++x)i(d,p,d[p-1],8),p+=32}function is(d,p,x){var j;for(j=0;8>j;++j)i(p,x+32*j,d,8)}function Ia(d,p){var x,j=8;for(x=0;8>x;++x)j+=d[p+x-32]+d[p-1+32*x];is(j>>4,d,p)}function Il(d,p){var x,j=4;for(x=0;8>x;++x)j+=d[p+x-32];is(j>>3,d,p)}function pn(d,p){var x,j=4;for(x=0;8>x;++x)j+=d[p-1+32*x];is(j>>3,d,p)}function Pl(d,p){is(128,d,p)}function Pa(d,p,x){var j=d[p-x],q=d[p+0],W=3*(q-j)+ng[1020+d[p-2*x]-d[p+x]],G=$h[112+(W+4>>3)];d[p-x]=Vi[255+j+$h[112+(W+3>>3)]],d[p+0]=Vi[255+q-G]}function Js(d,p,x,j){var q=d[p+0],W=d[p+x];return os[255+d[p-2*x]-d[p-x]]>j||os[255+W-q]>j}function bo(d,p,x,j){return 4*os[255+d[p-x]-d[p+0]]+os[255+d[p-2*x]-d[p+x]]<=j}function Ra(d,p,x,j,q){var W=d[p-3*x],G=d[p-2*x],X=d[p-x],Z=d[p+0],ie=d[p+x],de=d[p+2*x],we=d[p+3*x];return 4*os[255+X-Z]+os[255+G-ie]>j?0:os[255+d[p-4*x]-W]<=q&&os[255+W-G]<=q&&os[255+G-X]<=q&&os[255+we-de]<=q&&os[255+de-ie]<=q&&os[255+ie-Z]<=q}function Zs(d,p,x,j){var q=2*j+1;for(j=0;16>j;++j)bo(d,p+j,x,q)&&Pa(d,p+j,x)}function ea(d,p,x,j){var q=2*j+1;for(j=0;16>j;++j)bo(d,p+j*x,1,q)&&Pa(d,p+j*x,1)}function xi(d,p,x,j){var q;for(q=3;0<q;--q)Zs(d,p+=4*x,x,j)}function Rl(d,p,x,j){var q;for(q=3;0<q;--q)ea(d,p+=4,x,j)}function Ns(d,p,x,j,q,W,G,X){for(W=2*W+1;0<q--;){if(Ra(d,p,x,W,G))if(Js(d,p,x,X))Pa(d,p,x);else{var Z=d,ie=p,de=x,we=Z[ie-2*de],se=Z[ie-de],me=Z[ie+0],xe=Z[ie+de],Se=Z[ie+2*de],be=27*(Te=ng[1020+3*(me-se)+ng[1020+we-xe]])+63>>7,je=18*Te+63>>7,Te=9*Te+63>>7;Z[ie-3*de]=Vi[255+Z[ie-3*de]+Te],Z[ie-2*de]=Vi[255+we+je],Z[ie-de]=Vi[255+se+be],Z[ie+0]=Vi[255+me-be],Z[ie+de]=Vi[255+xe-je],Z[ie+2*de]=Vi[255+Se-Te]}p+=j}}function li(d,p,x,j,q,W,G,X){for(W=2*W+1;0<q--;){if(Ra(d,p,x,W,G))if(Js(d,p,x,X))Pa(d,p,x);else{var Z=d,ie=p,de=x,we=Z[ie-de],se=Z[ie+0],me=Z[ie+de],xe=$h[112+(4+(Se=3*(se-we))>>3)],Se=$h[112+(Se+3>>3)],be=xe+1>>1;Z[ie-2*de]=Vi[255+Z[ie-2*de]+be],Z[ie-de]=Vi[255+we+Se],Z[ie+0]=Vi[255+se-xe],Z[ie+de]=Vi[255+me-be]}p+=j}}function Ll(d,p,x,j,q,W){Ns(d,p,x,1,16,j,q,W)}function wo(d,p,x,j,q,W){Ns(d,p,1,x,16,j,q,W)}function ss(d,p,x,j,q,W){var G;for(G=3;0<G;--G)li(d,p+=4*x,x,1,16,j,q,W)}function Dl(d,p,x,j,q,W){var G;for(G=3;0<G;--G)li(d,p+=4,1,x,16,j,q,W)}function y(d,p,x,j,q,W,G,X){Ns(d,p,q,1,8,W,G,X),Ns(x,j,q,1,8,W,G,X)}function B(d,p,x,j,q,W,G,X){Ns(d,p,1,q,8,W,G,X),Ns(x,j,1,q,8,W,G,X)}function re(d,p,x,j,q,W,G,X){li(d,p+4*q,q,1,8,W,G,X),li(x,j+4*q,q,1,8,W,G,X)}function ce(d,p,x,j,q,W,G,X){li(d,p+4,1,q,8,W,G,X),li(x,j+4,1,q,8,W,G,X)}function ge(){this.ba=new nn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ot,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ae(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ce(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ge(){this.ua=0,this.Wa=new et,this.vb=new et,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new H,this.yc=new R}function Je(){this.xb=this.a=0,this.l=new Gs,this.ca=new nn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new F,this.Pb=0,this.wd=new F,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ge,this.ab=0,this.gc=o(4,Ce),this.Oc=0}function gt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Gs,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Nt(d,p,x,j,q,W,G){for(d=d==null?0:d[p+0],p=0;p<G;++p)q[W+p]=d+x[j+p]&255,d=q[W+p]}function Kt(d,p,x,j,q,W,G){var X;if(d==null)Nt(null,null,x,j,q,W,G);else for(X=0;X<G;++X)q[W+X]=d[p+X]+x[j+X]&255}function rn(d,p,x,j,q,W,G){if(d==null)Nt(null,null,x,j,q,W,G);else{var X,Z=d[p+0],ie=Z,de=Z;for(X=0;X<G;++X)ie=de+(Z=d[p+X])-ie,de=x[j+X]+(-256&ie?0>ie?0:255:ie)&255,ie=Z,q[W+X]=de}}function Fn(d,p,x,j){var q=p.width,W=p.o;if(e(d!=null&&p!=null),0>x||0>=j||x+j>W)return null;if(!d.Cc){if(d.ga==null){var G;if(d.ga=new gt,(G=d.ga==null)||(G=p.width*p.o,e(d.Gb.length==0),d.Gb=s(G),d.Uc=0,d.Gb==null?G=0:(d.mb=d.Gb,d.nb=d.Uc,d.rc=null,G=1),G=!G),!G){G=d.ga;var X=d.Fa,Z=d.P,ie=d.qc,de=d.mb,we=d.nb,se=Z+1,me=ie-1,xe=G.l;if(e(X!=null&&de!=null&&p!=null),Co[0]=null,Co[1]=Nt,Co[2]=Kt,Co[3]=rn,G.ca=de,G.tb=we,G.c=p.width,G.i=p.height,e(0<G.c&&0<G.i),1>=ie)p=0;else if(G.$a=3&X[Z+0],G.Z=X[Z+0]>>2&3,G.Lc=X[Z+0]>>4&3,Z=X[Z+0]>>6&3,0>G.$a||1<G.$a||4<=G.Z||1<G.Lc||Z)p=0;else if(xe.put=mt,xe.ac=Br,xe.bc=En,xe.ma=G,xe.width=p.width,xe.height=p.height,xe.Da=p.Da,xe.v=p.v,xe.va=p.va,xe.j=p.j,xe.o=p.o,G.$a)e:{e(G.$a==1),p=$s();t:for(;;){if(p==null){p=0;break e}if(e(G!=null),G.mc=p,p.c=G.c,p.i=G.i,p.l=G.l,p.l.ma=G,p.l.width=G.c,p.l.height=G.i,p.a=0,ee(p.m,X,se,me),!Pi(G.c,G.i,1,p,null)||(p.ab==1&&p.gc[0].hc==3&&zr(p.s)?(G.ic=1,X=p.c*p.i,p.Ta=null,p.Ua=0,p.V=s(X),p.Ba=0,p.V==null?(p.a=1,p=0):p=1):(G.ic=0,p=xs(p,G.c)),!p))break t;p=1;break e}G.mc=null,p=0}else p=me>=G.c*G.i;G=!p}if(G)return null;d.ga.Lc!=1?d.Ga=0:j=W-x}e(d.ga!=null),e(x+j<=W);e:{if(p=(X=d.ga).c,W=X.l.o,X.$a==0){if(se=d.rc,me=d.Vc,xe=d.Fa,Z=d.P+1+x*p,ie=d.mb,de=d.nb+x*p,e(Z<=d.P+d.qc),X.Z!=0)for(e(Co[X.Z]!=null),G=0;G<j;++G)Co[X.Z](se,me,xe,Z,ie,de,p),se=ie,me=de,de+=p,Z+=p;else for(G=0;G<j;++G)r(ie,de,xe,Z,p),se=ie,me=de,de+=p,Z+=p;d.rc=se,d.Vc=me}else{if(e(X.mc!=null),p=x+j,e((G=X.mc)!=null),e(p<=G.i),G.C>=p)p=1;else if(X.ic||bn(),X.ic){X=G.V,se=G.Ba,me=G.c;var Se=G.i,be=(xe=1,Z=G.$/me,ie=G.$%me,de=G.m,we=G.s,G.$),je=me*Se,Te=me*p,De=we.wc,Ie=be<Te?Rn(we,ie,Z):null;e(be<=je),e(p<=Se),e(zr(we));t:for(;;){for(;!de.h&&be<Te;){if(ie&De||(Ie=Rn(we,ie,Z)),e(Ie!=null),oe(de),256>(Se=Pn(Ie.G[0],Ie.H[0],de)))X[se+be]=Se,++be,++ie>=me&&(ie=0,++Z<=p&&!(Z%16)&&ai(G,Z));else{if(!(280>Se)){xe=0;break t}Se=wr(Se-256,de);var ot,Ye=Pn(Ie.G[4],Ie.H[4],de);if(oe(de),!(be>=(Ye=_r(me,Ye=wr(Ye,de)))&&je-be>=Se)){xe=0;break t}for(ot=0;ot<Se;++ot)X[se+be+ot]=X[se+be+ot-Ye];for(be+=Se,ie+=Se;ie>=me;)ie-=me,++Z<=p&&!(Z%16)&&ai(G,Z);be<Te&&ie&De&&(Ie=Rn(we,ie,Z))}e(de.h==K(de))}ai(G,Z>p?p:Z);break t}!xe||de.h&&be<je?(xe=0,G.a=de.h?5:3):G.$=be,p=xe}else p=qr(G,G.V,G.Ba,G.c,G.i,p,Hs);if(!p){j=0;break e}}x+j>=W&&(d.Cc=1),j=1}if(!j)return null;if(d.Cc&&((j=d.ga)!=null&&(j.mc=null),d.ga=null,0<d.Ga))return alert("todo:WebPDequantizeLevels"),null}return d.nb+x*q}function ln(d,p,x,j,q,W){for(;0<q--;){var G,X=d,Z=p+(x?1:0),ie=d,de=p+(x?0:3);for(G=0;G<j;++G){var we=ie[de+4*G];we!=255&&(we*=32897,X[Z+4*G+0]=X[Z+4*G+0]*we>>23,X[Z+4*G+1]=X[Z+4*G+1]*we>>23,X[Z+4*G+2]=X[Z+4*G+2]*we>>23)}p+=W}}function Hn(d,p,x,j,q){for(;0<j--;){var W;for(W=0;W<x;++W){var G=d[p+2*W+0],X=15&(ie=d[p+2*W+1]),Z=4369*X,ie=(240&ie|ie>>4)*Z>>16;d[p+2*W+0]=(240&G|G>>4)*Z>>16&240|(15&G|G<<4)*Z>>16>>4&15,d[p+2*W+1]=240&ie|X}p+=q}}function Vn(d,p,x,j,q,W,G,X){var Z,ie,de=255;for(ie=0;ie<q;++ie){for(Z=0;Z<j;++Z){var we=d[p+Z];W[G+4*Z]=we,de&=we}p+=x,G+=X}return de!=255}function Wn(d,p,x,j,q){var W;for(W=0;W<q;++W)x[j+W]=d[p+W]>>8}function bn(){td=ln,t2=Hn,n2=Vn,r2=Wn}function kr(d,p,x){k[d]=function(j,q,W,G,X,Z,ie,de,we,se,me,xe,Se,be,je,Te,De){var Ie,ot=De-1>>1,Ye=X[Z+0]|ie[de+0]<<16,Rt=we[se+0]|me[xe+0]<<16;e(j!=null);var nt=3*Ye+Rt+131074>>2;for(p(j[q+0],255&nt,nt>>16,Se,be),W!=null&&(nt=3*Rt+Ye+131074>>2,p(W[G+0],255&nt,nt>>16,je,Te)),Ie=1;Ie<=ot;++Ie){var Ht=X[Z+Ie]|ie[de+Ie]<<16,pr=we[se+Ie]|me[xe+Ie]<<16,Lt=Ye+Ht+Rt+pr+524296,rt=Lt+2*(Ht+Rt)>>3;nt=rt+Ye>>1,Ye=(Lt=Lt+2*(Ye+pr)>>3)+Ht>>1,p(j[q+2*Ie-1],255&nt,nt>>16,Se,be+(2*Ie-1)*x),p(j[q+2*Ie-0],255&Ye,Ye>>16,Se,be+(2*Ie-0)*x),W!=null&&(nt=Lt+Rt>>1,Ye=rt+pr>>1,p(W[G+2*Ie-1],255&nt,nt>>16,je,Te+(2*Ie-1)*x),p(W[G+2*Ie+0],255&Ye,Ye>>16,je,Te+(2*Ie+0)*x)),Ye=Ht,Rt=pr}1&De||(nt=3*Ye+Rt+131074>>2,p(j[q+De-1],255&nt,nt>>16,Se,be+(De-1)*x),W!=null&&(nt=3*Rt+Ye+131074>>2,p(W[G+De-1],255&nt,nt>>16,je,Te+(De-1)*x)))}}function Ml(){ls[Hh]=pE,ls[Wh]=m2,ls[c2]=gE,ls[Gh]=p2,ls[Kh]=g2,ls[rg]=v2,ls[u2]=vE,ls[ig]=m2,ls[sg]=p2,ls[Yh]=g2,ls[ag]=v2}function Di(d){return d&-16384?0>d?0:255:d>>yE}function h(d,p){return Di((19077*d>>8)+(26149*p>>8)-14234)}function _(d,p,x){return Di((19077*d>>8)-(6419*p>>8)-(13320*x>>8)+8708)}function L(d,p){return Di((19077*d>>8)+(33050*p>>8)-17685)}function J(d,p,x,j,q){j[q+0]=h(d,x),j[q+1]=_(d,p,x),j[q+2]=L(d,p)}function ye(d,p,x,j,q){j[q+0]=L(d,p),j[q+1]=_(d,p,x),j[q+2]=h(d,x)}function _e(d,p,x,j,q){var W=_(d,p,x);p=W<<3&224|L(d,p)>>3,j[q+0]=248&h(d,x)|W>>5,j[q+1]=p}function Be(d,p,x,j,q){var W=240&L(d,p)|15;j[q+0]=240&h(d,x)|_(d,p,x)>>4,j[q+1]=W}function $t(d,p,x,j,q){j[q+0]=255,J(d,p,x,j,q+1)}function Un(d,p,x,j,q){ye(d,p,x,j,q),j[q+3]=255}function Ft(d,p,x,j,q){J(d,p,x,j,q),j[q+3]=255}function Mt(d,p){return 0>d?0:d>p?p:d}function wn(d,p,x){k[d]=function(j,q,W,G,X,Z,ie,de,we){for(var se=de+(-2&we)*x;de!=se;)p(j[q+0],W[G+0],X[Z+0],ie,de),p(j[q+1],W[G+0],X[Z+0],ie,de+x),q+=2,++G,++Z,de+=2*x;1&we&&p(j[q+0],W[G+0],X[Z+0],ie,de)}}function Mi(d,p,x){return x==0?d==0?p==0?6:5:p==0?4:0:x}function $r(d,p,x,j,q){switch(d>>>30){case 3:Vl(p,x,j,q,0);break;case 2:as(p,x,j,q);break;case 1:sn(p,x,j,q)}}function Cr(d,p){var x,j,q=p.M,W=p.Nb,G=d.oc,X=d.pc+40,Z=d.oc,ie=d.pc+584,de=d.oc,we=d.pc+600;for(x=0;16>x;++x)G[X+32*x-1]=129;for(x=0;8>x;++x)Z[ie+32*x-1]=129,de[we+32*x-1]=129;for(0<q?G[X-1-32]=Z[ie-1-32]=de[we-1-32]=129:(i(G,X-32-1,127,21),i(Z,ie-32-1,127,9),i(de,we-32-1,127,9)),j=0;j<d.za;++j){var se=p.ya[p.aa+j];if(0<j){for(x=-1;16>x;++x)r(G,X+32*x-4,G,X+32*x+12,4);for(x=-1;8>x;++x)r(Z,ie+32*x-4,Z,ie+32*x+4,4),r(de,we+32*x-4,de,we+32*x+4,4)}var me=d.Gd,xe=d.Hd+j,Se=se.ad,be=se.Hc;if(0<q&&(r(G,X-32,me[xe].y,0,16),r(Z,ie-32,me[xe].f,0,8),r(de,we-32,me[xe].ea,0,8)),se.Za){var je=G,Te=X-32+16;for(0<q&&(j>=d.za-1?i(je,Te,me[xe].y[15],4):r(je,Te,me[xe+1].y,0,4)),x=0;4>x;x++)je[Te+128+x]=je[Te+256+x]=je[Te+384+x]=je[Te+0+x];for(x=0;16>x;++x,be<<=2)je=G,Te=X+x2[x],Es[se.Ob[x]](je,Te),$r(be,Se,16*+x,je,Te)}else if(je=Mi(j,q,se.Ob[0]),ko[je](G,X),be!=0)for(x=0;16>x;++x,be<<=2)$r(be,Se,16*+x,G,X+x2[x]);for(x=se.Gc,je=Mi(j,q,se.Dd),Ma[je](Z,ie),Ma[je](de,we),be=Se,je=Z,Te=ie,255&(se=0|x)&&(170&se?ra(be,256,je,Te):gn(be,256,je,Te)),se=de,be=we,255&(x>>=8)&&(170&x?ra(Se,320,se,be):gn(Se,320,se,be)),q<d.Ub-1&&(r(me[xe].y,0,G,X+480,16),r(me[xe].f,0,Z,ie+224,8),r(me[xe].ea,0,de,we+224,8)),x=8*W*d.B,me=d.sa,xe=d.ta+16*j+16*W*d.R,Se=d.qa,se=d.ra+8*j+x,be=d.Ha,je=d.Ia+8*j+x,x=0;16>x;++x)r(me,xe+x*d.R,G,X+32*x,16);for(x=0;8>x;++x)r(Se,se+x*d.B,Z,ie+32*x,8),r(be,je+x*d.B,de,we+32*x,8)}}function Ss(d,p,x,j,q,W,G,X,Z){var ie=[0],de=[0],we=0,se=Z!=null?Z.kd:0,me=Z??new Ae;if(d==null||12>x)return 7;me.data=d,me.w=p,me.ha=x,p=[p],x=[x],me.gb=[me.gb];e:{var xe=p,Se=x,be=me.gb;if(e(d!=null),e(Se!=null),e(be!=null),be[0]=0,12<=Se[0]&&!n(d,xe[0],"RIFF")){if(n(d,xe[0]+8,"WEBP")){be=3;break e}var je=Ne(d,xe[0]+4);if(12>je||4294967286<je){be=3;break e}if(se&&je>Se[0]-8){be=7;break e}be[0]=je,xe[0]+=12,Se[0]-=12}be=0}if(be!=0)return be;for(je=0<me.gb[0],x=x[0];;){e:{var Te=d;Se=p,be=x;var De=ie,Ie=de,ot=xe=[0];if((nt=we=[we])[0]=0,8>be[0])be=7;else{if(!n(Te,Se[0],"VP8X")){if(Ne(Te,Se[0]+4)!=10){be=3;break e}if(18>be[0]){be=7;break e}var Ye=Ne(Te,Se[0]+8),Rt=1+ze(Te,Se[0]+12);if(2147483648<=Rt*(Te=1+ze(Te,Se[0]+15))){be=3;break e}ot!=null&&(ot[0]=Ye),De!=null&&(De[0]=Rt),Ie!=null&&(Ie[0]=Te),Se[0]+=18,be[0]-=18,nt[0]=1}be=0}}if(we=we[0],xe=xe[0],be!=0)return be;if(Se=!!(2&xe),!je&&we)return 3;if(W!=null&&(W[0]=!!(16&xe)),G!=null&&(G[0]=Se),X!=null&&(X[0]=0),G=ie[0],xe=de[0],we&&Se&&Z==null){be=0;break}if(4>x){be=7;break}if(je&&we||!je&&!we&&!n(d,p[0],"ALPH")){x=[x],me.na=[me.na],me.P=[me.P],me.Sa=[me.Sa];e:{Ye=d,be=p,je=x;var nt=me.gb;De=me.na,Ie=me.P,ot=me.Sa,Rt=22,e(Ye!=null),e(je!=null),Te=be[0];var Ht=je[0];for(e(De!=null),e(ot!=null),De[0]=null,Ie[0]=null,ot[0]=0;;){if(be[0]=Te,je[0]=Ht,8>Ht){be=7;break e}var pr=Ne(Ye,Te+4);if(4294967286<pr){be=3;break e}var Lt=8+pr+1&-2;if(Rt+=Lt,0<nt&&Rt>nt){be=3;break e}if(!n(Ye,Te,"VP8 ")||!n(Ye,Te,"VP8L")){be=0;break e}if(Ht[0]<Lt){be=7;break e}n(Ye,Te,"ALPH")||(De[0]=Ye,Ie[0]=Te+8,ot[0]=pr),Te+=Lt,Ht-=Lt}}if(x=x[0],me.na=me.na[0],me.P=me.P[0],me.Sa=me.Sa[0],be!=0)break}x=[x],me.Ja=[me.Ja],me.xa=[me.xa];e:if(nt=d,be=p,je=x,De=me.gb[0],Ie=me.Ja,ot=me.xa,Ye=be[0],Te=!n(nt,Ye,"VP8 "),Rt=!n(nt,Ye,"VP8L"),e(nt!=null),e(je!=null),e(Ie!=null),e(ot!=null),8>je[0])be=7;else{if(Te||Rt){if(nt=Ne(nt,Ye+4),12<=De&&nt>De-12){be=3;break e}if(se&&nt>je[0]-8){be=7;break e}Ie[0]=nt,be[0]+=8,je[0]-=8,ot[0]=Rt}else ot[0]=5<=je[0]&&nt[Ye+0]==47&&!(nt[Ye+4]>>5),Ie[0]=je[0];be=0}if(x=x[0],me.Ja=me.Ja[0],me.xa=me.xa[0],p=p[0],be!=0)break;if(4294967286<me.Ja)return 3;if(X==null||Se||(X[0]=me.xa?2:1),G=[G],xe=[xe],me.xa){if(5>x){be=7;break}X=G,se=xe,Se=W,d==null||5>x?d=0:5<=x&&d[p+0]==47&&!(d[p+4]>>5)?(je=[0],nt=[0],De=[0],ee(Ie=new F,d,p,x),ns(Ie,je,nt,De)?(X!=null&&(X[0]=je[0]),se!=null&&(se[0]=nt[0]),Se!=null&&(Se[0]=De[0]),d=1):d=0):d=0}else{if(10>x){be=7;break}X=xe,d==null||10>x||!Tl(d,p+3,x-3)?d=0:(se=d[p+0]|d[p+1]<<8|d[p+2]<<16,Se=16383&(d[p+7]<<8|d[p+6]),d=16383&(d[p+9]<<8|d[p+8]),1&se||3<(se>>1&7)||!(se>>4&1)||se>>5>=me.Ja||!Se||!d?d=0:(G&&(G[0]=Se),X&&(X[0]=d),d=1))}if(!d||(G=G[0],xe=xe[0],we&&(ie[0]!=G||de[0]!=xe)))return 3;Z!=null&&(Z[0]=me,Z.offset=p-Z.w,e(4294967286>p-Z.w),e(Z.offset==Z.ha-x));break}return be==0||be==7&&we&&Z==null?(W!=null&&(W[0]|=me.na!=null&&0<me.na.length),j!=null&&(j[0]=G),q!=null&&(q[0]=xe),0):be}function Gu(d,p,x){var j=p.width,q=p.height,W=0,G=0,X=j,Z=q;if(p.Da=d!=null&&0<d.Da,p.Da&&(X=d.cd,Z=d.bd,W=d.v,G=d.j,11>x||(W&=-2,G&=-2),0>W||0>G||0>=X||0>=Z||W+X>j||G+Z>q))return 0;if(p.v=W,p.j=G,p.va=W+X,p.o=G+Z,p.U=X,p.T=Z,p.da=d!=null&&0<d.da,p.da){if(!He(X,Z,x=[d.ib],W=[d.hb]))return 0;p.ib=x[0],p.hb=W[0]}return p.ob=d!=null&&d.ob,p.Kb=d==null||!d.Sd,p.da&&(p.ob=p.ib<3*j/4&&p.hb<3*q/4,p.Kb=0),1}function Ku(d){if(d==null)return 2;if(11>d.S){var p=d.f.RGBA;p.fb+=(d.height-1)*p.A,p.A=-p.A}else p=d.f.kb,d=d.height,p.O+=(d-1)*p.fa,p.fa=-p.fa,p.N+=(d-1>>1)*p.Ab,p.Ab=-p.Ab,p.W+=(d-1>>1)*p.Db,p.Db=-p.Db,p.F!=null&&(p.J+=(d-1)*p.lb,p.lb=-p.lb);return 0}function _o(d,p,x,j){if(j==null||0>=d||0>=p)return 2;if(x!=null){if(x.Da){var q=x.cd,W=x.bd,G=-2&x.v,X=-2&x.j;if(0>G||0>X||0>=q||0>=W||G+q>d||X+W>p)return 2;d=q,p=W}if(x.da){if(!He(d,p,q=[x.ib],W=[x.hb]))return 2;d=q[0],p=W[0]}}j.width=d,j.height=p;e:{var Z=j.width,ie=j.height;if(d=j.S,0>=Z||0>=ie||!(d>=Hh&&13>d))d=2;else{if(0>=j.Rd&&j.sd==null){G=W=q=p=0;var de=(X=Z*b2[d])*ie;if(11>d||(W=(ie+1)/2*(p=(Z+1)/2),d==12&&(G=(q=Z)*ie)),(ie=s(de+2*W+G))==null){d=1;break e}j.sd=ie,11>d?((Z=j.f.RGBA).eb=ie,Z.fb=0,Z.A=X,Z.size=de):((Z=j.f.kb).y=ie,Z.O=0,Z.fa=X,Z.Fd=de,Z.f=ie,Z.N=0+de,Z.Ab=p,Z.Cd=W,Z.ea=ie,Z.W=0+de+W,Z.Db=p,Z.Ed=W,d==12&&(Z.F=ie,Z.J=0+de+2*W),Z.Tc=G,Z.lb=q)}if(p=1,q=j.S,W=j.width,G=j.height,q>=Hh&&13>q)if(11>q)d=j.f.RGBA,p&=(X=Math.abs(d.A))*(G-1)+W<=d.size,p&=X>=W*b2[q],p&=d.eb!=null;else{d=j.f.kb,X=(W+1)/2,de=(G+1)/2,Z=Math.abs(d.fa),ie=Math.abs(d.Ab);var we=Math.abs(d.Db),se=Math.abs(d.lb),me=se*(G-1)+W;p&=Z*(G-1)+W<=d.Fd,p&=ie*(de-1)+X<=d.Cd,p=(p&=we*(de-1)+X<=d.Ed)&Z>=W&ie>=X&we>=X,p&=d.y!=null,p&=d.f!=null,p&=d.ea!=null,q==12&&(p&=se>=W,p&=me<=d.Tc,p&=d.F!=null)}else p=0;d=p?0:2}}return d!=0||x!=null&&x.fd&&(d=Ku(j)),d}var Ol=64,Oi=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Fi=24,No=32,La=8,So=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];$e("Predictor0","PredictorAdd0"),k.Predictor0=function(){return 4278190080},k.Predictor1=function(d){return d},k.Predictor2=function(d,p,x){return p[x+0]},k.Predictor3=function(d,p,x){return p[x+1]},k.Predictor4=function(d,p,x){return p[x-1]},k.Predictor5=function(d,p,x){return Pe(Pe(d,p[x+1]),p[x+0])},k.Predictor6=function(d,p,x){return Pe(d,p[x-1])},k.Predictor7=function(d,p,x){return Pe(d,p[x+0])},k.Predictor8=function(d,p,x){return Pe(p[x-1],p[x+0])},k.Predictor9=function(d,p,x){return Pe(p[x+0],p[x+1])},k.Predictor10=function(d,p,x){return Pe(Pe(d,p[x-1]),Pe(p[x+0],p[x+1]))},k.Predictor11=function(d,p,x){var j=p[x+0];return 0>=it(j>>24&255,d>>24&255,(p=p[x-1])>>24&255)+it(j>>16&255,d>>16&255,p>>16&255)+it(j>>8&255,d>>8&255,p>>8&255)+it(255&j,255&d,255&p)?j:d},k.Predictor12=function(d,p,x){var j=p[x+0];return(qt((d>>24&255)+(j>>24&255)-((p=p[x-1])>>24&255))<<24|qt((d>>16&255)+(j>>16&255)-(p>>16&255))<<16|qt((d>>8&255)+(j>>8&255)-(p>>8&255))<<8|qt((255&d)+(255&j)-(255&p)))>>>0},k.Predictor13=function(d,p,x){var j=p[x-1];return(Et((d=Pe(d,p[x+0]))>>24&255,j>>24&255)<<24|Et(d>>16&255,j>>16&255)<<16|Et(d>>8&255,j>>8&255)<<8|Et(255&d,255&j))>>>0};var Yu=k.PredictorAdd0;k.PredictorAdd1=Tt,$e("Predictor2","PredictorAdd2"),$e("Predictor3","PredictorAdd3"),$e("Predictor4","PredictorAdd4"),$e("Predictor5","PredictorAdd5"),$e("Predictor6","PredictorAdd6"),$e("Predictor7","PredictorAdd7"),$e("Predictor8","PredictorAdd8"),$e("Predictor9","PredictorAdd9"),$e("Predictor10","PredictorAdd10"),$e("Predictor11","PredictorAdd11"),$e("Predictor12","PredictorAdd12"),$e("Predictor13","PredictorAdd13");var Tc=k.PredictorAdd2;ut("ColorIndexInverseTransform","MapARGB","32b",function(d){return d>>8&255},function(d){return d}),ut("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(d){return d},function(d){return d>>8&255});var Zn,zh=k.ColorIndexInverseTransform,ta=k.MapARGB,na=k.VP8LColorIndexInverseTransformAlpha,Qu=k.MapAlpha,Xu=k.VP8LPredictorsAdd=[];Xu.length=16,(k.VP8LPredictors=[]).length=16,(k.VP8LPredictorsAdd_C=[]).length=16,(k.VP8LPredictors_C=[]).length=16;var Ju,Zu,Eo,Ao,jo,Fl,To,Vl,as,ra,sn,gn,er,mr,Da,ed,kc,qh,Yy,Qy,Xy,Jy,Zy,e2,td,t2,n2,r2,i2=s(511),s2=s(2041),a2=s(225),o2=s(767),l2=0,ng=s2,$h=a2,Vi=o2,os=i2,Hh=0,Wh=1,c2=2,Gh=3,Kh=4,rg=5,u2=6,ig=7,sg=8,Yh=9,ag=10,tE=[2,3,7],nE=[3,3,11],d2=[280,256,256,256,40],rE=[0,1,1,1,0],iE=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],sE=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],aE=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],oE=8,og=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],lg=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],nd=null,lE=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],cE=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],h2=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],uE=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],dE=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],hE=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],fE=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ko=[],Es=[],Ma=[],mE=1,f2=2,Co=[],ls=[];kr("UpsampleRgbLinePair",J,3),kr("UpsampleBgrLinePair",ye,3),kr("UpsampleRgbaLinePair",Ft,4),kr("UpsampleBgraLinePair",Un,4),kr("UpsampleArgbLinePair",$t,4),kr("UpsampleRgba4444LinePair",Be,2),kr("UpsampleRgb565LinePair",_e,2);var pE=k.UpsampleRgbLinePair,gE=k.UpsampleBgrLinePair,m2=k.UpsampleRgbaLinePair,p2=k.UpsampleBgraLinePair,g2=k.UpsampleArgbLinePair,v2=k.UpsampleRgba4444LinePair,vE=k.UpsampleRgb565LinePair,Qh=16,Xh=1<<Qh-1,rd=-227,cg=482,yE=6,y2=0,xE=s(256),bE=s(256),wE=s(256),_E=s(256),NE=s(cg-rd),SE=s(cg-rd);wn("YuvToRgbRow",J,3),wn("YuvToBgrRow",ye,3),wn("YuvToRgbaRow",Ft,4),wn("YuvToBgraRow",Un,4),wn("YuvToArgbRow",$t,4),wn("YuvToRgba4444Row",Be,2),wn("YuvToRgb565Row",_e,2);var x2=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Jh=[0,2,8],EE=[8,7,6,4,4,2,2,2,1,1,1,1],AE=1;this.WebPDecodeRGBA=function(d,p,x,j,q){var W=Wh,G=new ge,X=new nn;G.ba=X,X.S=W,X.width=[X.width],X.height=[X.height];var Z=X.width,ie=X.height,de=new yt;if(de==null||d==null)var we=2;else e(de!=null),we=Ss(d,p,x,de.width,de.height,de.Pd,de.Qd,de.format,null);if(we!=0?Z=0:(Z!=null&&(Z[0]=de.width[0]),ie!=null&&(ie[0]=de.height[0]),Z=1),Z){X.width=X.width[0],X.height=X.height[0],j!=null&&(j[0]=X.width),q!=null&&(q[0]=X.height);e:{if(j=new Gs,(q=new Ae).data=d,q.w=p,q.ha=x,q.kd=1,p=[0],e(q!=null),((d=Ss(q.data,q.w,q.ha,null,null,null,p,null,q))==0||d==7)&&p[0]&&(d=4),(p=d)==0){if(e(G!=null),j.data=q.data,j.w=q.w+q.offset,j.ha=q.ha-q.offset,j.put=mt,j.ac=Br,j.bc=En,j.ma=G,q.xa){if((d=$s())==null){G=1;break e}if(function(se,me){var xe=[0],Se=[0],be=[0];t:for(;;){if(se==null)return 0;if(me==null)return se.a=2,0;if(se.l=me,se.a=0,ee(se.m,me.data,me.w,me.ha),!ns(se.m,xe,Se,be)){se.a=3;break t}if(se.xb=f2,me.width=xe[0],me.height=Se[0],!Pi(xe[0],Se[0],1,se,null))break t;return 1}return e(se.a!=0),0}(d,j)){if(j=(p=_o(j.width,j.height,G.Oa,G.ba))==0){t:{j=d;n:for(;;){if(j==null){j=0;break t}if(e(j.s.yc!=null),e(j.s.Ya!=null),e(0<j.s.Wb),e((x=j.l)!=null),e((q=x.ma)!=null),j.xb!=0){if(j.ca=q.ba,j.tb=q.tb,e(j.ca!=null),!Gu(q.Oa,x,Gh)){j.a=2;break n}if(!xs(j,x.width)||x.da)break n;if((x.da||At(j.ca.S))&&bn(),11>j.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),j.ca.f.kb.F!=null&&bn()),j.Pb&&0<j.s.ua&&j.s.vb.X==null&&!ae(j.s.vb,j.s.Wa.Xa)){j.a=1;break n}j.xb=0}if(!qr(j,j.V,j.Ba,j.c,j.i,x.o,qs))break n;q.Dc=j.Ma,j=1;break t}e(j.a!=0),j=0}j=!j}j&&(p=d.a)}else p=d.a}else{if((d=new jl)==null){G=1;break e}if(d.Fa=q.na,d.P=q.P,d.qc=q.Sa,Ec(d,j)){if((p=_o(j.width,j.height,G.Oa,G.ba))==0){if(d.Aa=0,x=G.Oa,e((q=d)!=null),x!=null){if(0<(Z=0>(Z=x.Md)?0:100<Z?255:255*Z/100)){for(ie=de=0;4>ie;++ie)12>(we=q.pb[ie]).lc&&(we.ia=Z*EE[0>we.lc?0:we.lc]>>3),de|=we.ia;de&&(alert("todo:VP8InitRandom"),q.ia=1)}q.Ga=x.Id,100<q.Ga?q.Ga=100:0>q.Ga&&(q.Ga=0)}(function(se,me){if(se==null)return 0;if(me==null)return On(se,2,"NULL VP8Io parameter in VP8Decode().");if(!se.cb&&!Ec(se,me))return 0;if(e(se.cb),me.ac==null||me.ac(me)){me.ob&&(se.L=0);var xe=Jh[se.L];if(se.L==2?(se.yb=0,se.zb=0):(se.yb=me.v-xe>>4,se.zb=me.j-xe>>4,0>se.yb&&(se.yb=0),0>se.zb&&(se.zb=0)),se.Va=me.o+15+xe>>4,se.Hb=me.va+15+xe>>4,se.Hb>se.za&&(se.Hb=se.za),se.Va>se.Ub&&(se.Va=se.Ub),0<se.L){var Se=se.ed;for(xe=0;4>xe;++xe){var be;if(se.Qa.Cb){var je=se.Qa.Lb[xe];se.Qa.Fb||(je+=Se.Tb)}else je=Se.Tb;for(be=0;1>=be;++be){var Te=se.gd[xe][be],De=je;if(Se.Pc&&(De+=Se.vd[0],be&&(De+=Se.od[0])),0<(De=0>De?0:63<De?63:De)){var Ie=De;0<Se.wb&&(Ie=4<Se.wb?Ie>>2:Ie>>1)>9-Se.wb&&(Ie=9-Se.wb),1>Ie&&(Ie=1),Te.dd=Ie,Te.tc=2*De+Ie,Te.ld=40<=De?2:15<=De?1:0}else Te.tc=0;Te.La=be}}}xe=0}else On(se,6,"Frame setup failed"),xe=se.a;if(xe=xe==0){if(xe){se.$c=0,0<se.Aa||(se.Ic=AE);t:{xe=se.Ic,Se=4*(Ie=se.za);var ot=32*Ie,Ye=Ie+1,Rt=0<se.L?Ie*(0<se.Aa?2:1):0,nt=(se.Aa==2?2:1)*Ie;if((Te=Se+832+(be=3*(16*xe+Jh[se.L])/2*ot)+(je=se.Fa!=null&&0<se.Fa.length?se.Kc.c*se.Kc.i:0))!=Te)xe=0;else{if(Te>se.Vb){if(se.Vb=0,se.Ec=s(Te),se.Fc=0,se.Ec==null){xe=On(se,1,"no memory during frame initialization.");break t}se.Vb=Te}Te=se.Ec,De=se.Fc,se.Ac=Te,se.Bc=De,De+=Se,se.Gd=o(ot,El),se.Hd=0,se.rb=o(Ye+1,Ri),se.sb=1,se.wa=Rt?o(Rt,Nr):null,se.Y=0,se.D.Nb=0,se.D.wa=se.wa,se.D.Y=se.Y,0<se.Aa&&(se.D.Y+=Ie),e(!0),se.oc=Te,se.pc=De,De+=832,se.ya=o(nt,Nl),se.aa=0,se.D.ya=se.ya,se.D.aa=se.aa,se.Aa==2&&(se.D.aa+=Ie),se.R=16*Ie,se.B=8*Ie,Ie=(ot=Jh[se.L])*se.R,ot=ot/2*se.B,se.sa=Te,se.ta=De+Ie,se.qa=se.sa,se.ra=se.ta+16*xe*se.R+ot,se.Ha=se.qa,se.Ia=se.ra+8*xe*se.B+ot,se.$c=0,De+=be,se.mb=je?Te:null,se.nb=je?De:null,e(De+je<=se.Fc+se.Vb),Ks(se),i(se.Ac,se.Bc,0,Se),xe=1}}if(xe){if(me.ka=0,me.y=se.sa,me.O=se.ta,me.f=se.qa,me.N=se.ra,me.ea=se.Ha,me.Vd=se.Ia,me.fa=se.R,me.Rc=se.B,me.F=null,me.J=0,!l2){for(xe=-255;255>=xe;++xe)i2[255+xe]=0>xe?-xe:xe;for(xe=-1020;1020>=xe;++xe)s2[1020+xe]=-128>xe?-128:127<xe?127:xe;for(xe=-112;112>=xe;++xe)a2[112+xe]=-16>xe?-16:15<xe?15:xe;for(xe=-255;510>=xe;++xe)o2[255+xe]=0>xe?0:255<xe?255:xe;l2=1}To=Ys,Vl=go,ra=Ac,sn=Ut,gn=ka,as=po,er=Ll,mr=wo,Da=y,ed=B,kc=ss,qh=Dl,Yy=re,Qy=ce,Xy=Zs,Jy=ea,Zy=xi,e2=Rl,Es[0]=$u,Es[1]=kl,Es[2]=Xs,Es[3]=qu,Es[4]=Hu,Es[5]=ws,Es[6]=Sr,Es[7]=Wu,Es[8]=_s,Es[9]=yo,ko[0]=yi,ko[1]=Bu,ko[2]=zu,ko[3]=Cl,ko[4]=rs,ko[5]=Qs,ko[6]=vo,Ma[0]=Ia,Ma[1]=jc,Ma[2]=xo,Ma[3]=Li,Ma[4]=pn,Ma[5]=Il,Ma[6]=Pl,xe=1}else xe=0}xe&&(xe=function(Ht,pr){for(Ht.M=0;Ht.M<Ht.Va;++Ht.M){var Lt,rt=Ht.Jc[Ht.M&Ht.Xb],qe=Ht.m,tr=Ht;for(Lt=0;Lt<tr.za;++Lt){var Pt=qe,Yt=tr,An=Yt.Ac,Ir=Yt.Bc+4*Lt,ci=Yt.zc,Gn=Yt.ya[Yt.aa+Lt];if(Yt.Qa.Bb?Gn.$b=ve(Pt,Yt.Pa.jb[0])?2+ve(Pt,Yt.Pa.jb[2]):ve(Pt,Yt.Pa.jb[1]):Gn.$b=0,Yt.kc&&(Gn.Ad=ve(Pt,Yt.Bd)),Gn.Za=!ve(Pt,145)+0,Gn.Za){var Hr=Gn.Ob,ui=0;for(Yt=0;4>Yt;++Yt){var gr,Xt=ci[0+Yt];for(gr=0;4>gr;++gr){Xt=dE[An[Ir+gr]][Xt];for(var cn=h2[ve(Pt,Xt[0])];0<cn;)cn=h2[2*cn+ve(Pt,Xt[cn])];Xt=-cn,An[Ir+gr]=Xt}r(Hr,ui,An,Ir,4),ui+=4,ci[0+Yt]=Xt}}else Xt=ve(Pt,156)?ve(Pt,128)?1:3:ve(Pt,163)?2:0,Gn.Ob[0]=Xt,i(An,Ir,Xt,4),i(ci,0,Xt,4);Gn.Dd=ve(Pt,142)?ve(Pt,114)?ve(Pt,183)?1:3:2:0}if(tr.m.Ka)return On(Ht,7,"Premature end-of-partition0 encountered.");for(;Ht.ja<Ht.za;++Ht.ja){if(tr=rt,Pt=(qe=Ht).rb[qe.sb-1],An=qe.rb[qe.sb+qe.ja],Lt=qe.ya[qe.aa+qe.ja],Ir=qe.kc?Lt.Ad:0)Pt.la=An.la=0,Lt.Za||(Pt.Na=An.Na=0),Lt.Hc=0,Lt.Gc=0,Lt.ia=0;else{var Kn,un;if(Pt=An,An=tr,Ir=qe.Pa.Xc,ci=qe.ya[qe.aa+qe.ja],Gn=qe.pb[ci.$b],Yt=ci.ad,Hr=0,ui=qe.rb[qe.sb-1],Xt=gr=0,i(Yt,Hr,0,384),ci.Za)var Pr=0,As=Ir[3];else{cn=s(16);var nr=Pt.Na+ui.Na;if(nr=nd(An,Ir[1],nr,Gn.Eb,0,cn,0),Pt.Na=ui.Na=(0<nr)+0,1<nr)To(cn,0,Yt,Hr);else{var bi=cn[0]+3>>3;for(cn=0;256>cn;cn+=16)Yt[Hr+cn]=bi}Pr=1,As=Ir[0]}var vn=15&Pt.la,vr=15&ui.la;for(cn=0;4>cn;++cn){var Ui=1&vr;for(bi=un=0;4>bi;++bi)vn=vn>>1|(Ui=(nr=nd(An,As,nr=Ui+(1&vn),Gn.Sc,Pr,Yt,Hr))>Pr)<<7,un=un<<2|(3<nr?3:1<nr?2:Yt[Hr+0]!=0),Hr+=16;vn>>=4,vr=vr>>1|Ui<<7,gr=(gr<<8|un)>>>0}for(As=vn,Pr=vr>>4,Kn=0;4>Kn;Kn+=2){for(un=0,vn=Pt.la>>4+Kn,vr=ui.la>>4+Kn,cn=0;2>cn;++cn){for(Ui=1&vr,bi=0;2>bi;++bi)nr=Ui+(1&vn),vn=vn>>1|(Ui=0<(nr=nd(An,Ir[2],nr,Gn.Qc,0,Yt,Hr)))<<3,un=un<<2|(3<nr?3:1<nr?2:Yt[Hr+0]!=0),Hr+=16;vn>>=2,vr=vr>>1|Ui<<5}Xt|=un<<4*Kn,As|=vn<<4<<Kn,Pr|=(240&vr)<<Kn}Pt.la=As,ui.la=Pr,ci.Hc=gr,ci.Gc=Xt,ci.ia=43690&Xt?0:Gn.ia,Ir=!(gr|Xt)}if(0<qe.L&&(qe.wa[qe.Y+qe.ja]=qe.gd[Lt.$b][Lt.Za],qe.wa[qe.Y+qe.ja].La|=!Ir),tr.Ka)return On(Ht,7,"Premature end-of-file encountered.")}if(Ks(Ht),qe=pr,tr=1,Lt=(rt=Ht).D,Pt=0<rt.L&&rt.M>=rt.zb&&rt.M<=rt.Va,rt.Aa==0)t:{if(Lt.M=rt.M,Lt.uc=Pt,Cr(rt,Lt),tr=1,Lt=(un=rt.D).Nb,Pt=(Xt=Jh[rt.L])*rt.R,An=Xt/2*rt.B,cn=16*Lt*rt.R,bi=8*Lt*rt.B,Ir=rt.sa,ci=rt.ta-Pt+cn,Gn=rt.qa,Yt=rt.ra-An+bi,Hr=rt.Ha,ui=rt.Ia-An+bi,vr=(vn=un.M)==0,gr=vn>=rt.Va-1,rt.Aa==2&&Cr(rt,un),un.uc)for(Ui=(nr=rt).D.M,e(nr.D.uc),un=nr.yb;un<nr.Hb;++un){Pr=un,As=Ui;var di=(Bi=(Rr=nr).D).Nb;Kn=Rr.R;var Bi=Bi.wa[Bi.Y+Pr],zi=Rr.sa,wi=Rr.ta+16*di*Kn+16*Pr,qi=Bi.dd,_n=Bi.tc;if(_n!=0)if(e(3<=_n),Rr.L==1)0<Pr&&Jy(zi,wi,Kn,_n+4),Bi.La&&e2(zi,wi,Kn,_n),0<As&&Xy(zi,wi,Kn,_n+4),Bi.La&&Zy(zi,wi,Kn,_n);else{var $i=Rr.B,js=Rr.qa,Ul=Rr.ra+8*di*$i+8*Pr,Oa=Rr.Ha,Rr=Rr.Ia+8*di*$i+8*Pr;di=Bi.ld,0<Pr&&(mr(zi,wi,Kn,_n+4,qi,di),ed(js,Ul,Oa,Rr,$i,_n+4,qi,di)),Bi.La&&(qh(zi,wi,Kn,_n,qi,di),Qy(js,Ul,Oa,Rr,$i,_n,qi,di)),0<As&&(er(zi,wi,Kn,_n+4,qi,di),Da(js,Ul,Oa,Rr,$i,_n+4,qi,di)),Bi.La&&(kc(zi,wi,Kn,_n,qi,di),Yy(js,Ul,Oa,Rr,$i,_n,qi,di))}}if(rt.ia&&alert("todo:DitherRow"),qe.put!=null){if(un=16*vn,vn=16*(vn+1),vr?(qe.y=rt.sa,qe.O=rt.ta+cn,qe.f=rt.qa,qe.N=rt.ra+bi,qe.ea=rt.Ha,qe.W=rt.Ia+bi):(un-=Xt,qe.y=Ir,qe.O=ci,qe.f=Gn,qe.N=Yt,qe.ea=Hr,qe.W=ui),gr||(vn-=Xt),vn>qe.o&&(vn=qe.o),qe.F=null,qe.J=null,rt.Fa!=null&&0<rt.Fa.length&&un<vn&&(qe.J=Fn(rt,qe,un,vn-un),qe.F=rt.mb,qe.F==null&&qe.F.length==0)){tr=On(rt,3,"Could not decode alpha data.");break t}un<qe.j&&(Xt=qe.j-un,un=qe.j,e(!(1&Xt)),qe.O+=rt.R*Xt,qe.N+=rt.B*(Xt>>1),qe.W+=rt.B*(Xt>>1),qe.F!=null&&(qe.J+=qe.width*Xt)),un<vn&&(qe.O+=qe.v,qe.N+=qe.v>>1,qe.W+=qe.v>>1,qe.F!=null&&(qe.J+=qe.v),qe.ka=un-qe.j,qe.U=qe.va-qe.v,qe.T=vn-un,tr=qe.put(qe))}Lt+1!=rt.Ic||gr||(r(rt.sa,rt.ta-Pt,Ir,ci+16*rt.R,Pt),r(rt.qa,rt.ra-An,Gn,Yt+8*rt.B,An),r(rt.Ha,rt.Ia-An,Hr,ui+8*rt.B,An))}if(!tr)return On(Ht,6,"Output aborted.")}return 1}(se,me)),me.bc!=null&&me.bc(me),xe&=1}return xe?(se.cb=0,xe):0})(d,j)||(p=d.a)}}else p=d.a}p==0&&G.Oa!=null&&G.Oa.fd&&(p=Ku(G.ba))}G=p}W=G!=0?null:11>W?X.f.RGBA.eb:X.f.kb.y}else W=null;return W};var b2=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(k,N){for(var S="",P=0;P<4;P++)S+=String.fromCharCode(k[N++]);return S}function f(k,N){return k[N+0]|k[N+1]<<8}function g(k,N){return(k[N+0]|k[N+1]<<8|k[N+2]<<16)>>>0}function v(k,N){return(k[N+0]|k[N+1]<<8|k[N+2]<<16|k[N+3]<<24)>>>0}new c;var m=[0],E=[0],A=[],C=new c,b=t,I=function(k,N){var S={},P=0,R=!1,$=0,H=0;if(S.frames=[],!function(w,F){for(var D=0;D<4;D++)if(w[F+D]!="RIFF".charCodeAt(D))return!0;return!1}(k,N)){for(v(k,N+=4),N+=8;N<k.length;){var Y=u(k,N),M=v(k,N+=4);N+=4;var U=M+(1&M);switch(Y){case"VP8 ":case"VP8L":S.frames[P]===void 0&&(S.frames[P]={}),(Q=S.frames[P]).src_off=R?H:N-8,Q.src_size=$+M+8,P++,R&&(R=!1,$=0,H=0);break;case"VP8X":(Q=S.header={}).feature_flags=k[N];var ee=N+4;Q.canvas_width=1+g(k,ee),ee+=3,Q.canvas_height=1+g(k,ee),ee+=3;break;case"ALPH":R=!0,$=U+8,H=N-8;break;case"ANIM":(Q=S.header).bgcolor=v(k,N),ee=N+4,Q.loop_count=f(k,ee),ee+=2;break;case"ANMF":var fe,Q;(Q=S.frames[P]={}).offset_x=2*g(k,N),N+=3,Q.offset_y=2*g(k,N),N+=3,Q.width=1+g(k,N),N+=3,Q.height=1+g(k,N),N+=3,Q.duration=g(k,N),N+=3,fe=k[N++],Q.dispose=1&fe,Q.blend=fe>>1&1}Y!="ANMF"&&(N+=U)}return S}}(b,0);I.response=b,I.rgbaoutput=!0,I.dataurl=!1;var O=I.header?I.header:null,V=I.frames?I.frames:null;if(O){O.loop_counter=O.loop_count,m=[O.canvas_height],E=[O.canvas_width];for(var ne=0;ne<V.length&&V[ne].blend!=0;ne++);}var le=V[0],z=C.WebPDecodeRGBA(b,le.src_off,le.src_size,E,m);le.rgba=z,le.imgwidth=E[0],le.imgheight=m[0];for(var T=0;T<E[0]*m[0]*4;T++)A[T]=z[T];return this.width=E,this.height=m,this.data=A,this}(function(t){var e,n,r,i,s,o,l,c,u,f=function(w){return w=w||{},this.isStrokeTransparent=w.isStrokeTransparent||!1,this.strokeOpacity=w.strokeOpacity||1,this.strokeStyle=w.strokeStyle||"#000000",this.fillStyle=w.fillStyle||"#000000",this.isFillTransparent=w.isFillTransparent||!1,this.fillOpacity=w.fillOpacity||1,this.font=w.font||"10px sans-serif",this.textBaseline=w.textBaseline||"alphabetic",this.textAlign=w.textAlign||"left",this.lineWidth=w.lineWidth||1,this.lineJoin=w.lineJoin||"miter",this.lineCap=w.lineCap||"butt",this.path=w.path||[],this.transform=w.transform!==void 0?w.transform.clone():new c,this.globalCompositeOperation=w.globalCompositeOperation||"normal",this.globalAlpha=w.globalAlpha||1,this.clip_path=w.clip_path||[],this.currentPoint=w.currentPoint||new o,this.miterLimit=w.miterLimit||10,this.lastPoint=w.lastPoint||new o,this.lineDashOffset=w.lineDashOffset||0,this.lineDash=w.lineDash||[],this.margin=w.margin||[0,0,0,0],this.prevPageLastElemOffset=w.prevPageLastElemOffset||0,this.ignoreClearRect=typeof w.ignoreClearRect!="boolean"||w.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new g(this),e=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new f}]);var g=function(w){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var F=w;Object.defineProperty(this,"pdf",{get:function(){return F}});var D=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return D},set:function(Ne){D=!!Ne}});var K=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return K},set:function(Ne){K=!!Ne}});var te=0;Object.defineProperty(this,"posX",{get:function(){return te},set:function(Ne){isNaN(Ne)||(te=Ne)}});var oe=0;Object.defineProperty(this,"posY",{get:function(){return oe},set:function(Ne){isNaN(Ne)||(oe=Ne)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(Ne){var ae;typeof Ne=="number"?ae=[Ne,Ne,Ne,Ne]:((ae=new Array(4))[0]=Ne[0],ae[1]=Ne.length>=2?Ne[1]:ae[0],ae[2]=Ne.length>=3?Ne[2]:ae[0],ae[3]=Ne.length>=4?Ne[3]:ae[1]),u.margin=ae}});var he=!1;Object.defineProperty(this,"autoPaging",{get:function(){return he},set:function(Ne){he=Ne}});var pe=0;Object.defineProperty(this,"lastBreak",{get:function(){return pe},set:function(Ne){pe=Ne}});var ve=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ve},set:function(Ne){ve=Ne}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(Ne){Ne instanceof f&&(u=Ne)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(Ne){u.path=Ne}});var Ee=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ee},set:function(Ne){Ee=Ne}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Ne){var ae;ae=v(Ne),this.ctx.fillStyle=ae.style,this.ctx.isFillTransparent=ae.a===0,this.ctx.fillOpacity=ae.a,this.pdf.setFillColor(ae.r,ae.g,ae.b,{a:ae.a}),this.pdf.setTextColor(ae.r,ae.g,ae.b,{a:ae.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Ne){var ae=v(Ne);this.ctx.strokeStyle=ae.style,this.ctx.isStrokeTransparent=ae.a===0,this.ctx.strokeOpacity=ae.a,ae.a===0?this.pdf.setDrawColor(255,255,255):(ae.a,this.pdf.setDrawColor(ae.r,ae.g,ae.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Ne){["butt","round","square"].indexOf(Ne)!==-1&&(this.ctx.lineCap=Ne,this.pdf.setLineCap(Ne))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Ne){isNaN(Ne)||(this.ctx.lineWidth=Ne,this.pdf.setLineWidth(Ne))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Ne){["bevel","round","miter"].indexOf(Ne)!==-1&&(this.ctx.lineJoin=Ne,this.pdf.setLineJoin(Ne))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Ne){isNaN(Ne)||(this.ctx.miterLimit=Ne,this.pdf.setMiterLimit(Ne))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Ne){this.ctx.textBaseline=Ne}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Ne){["right","end","center","left","start"].indexOf(Ne)!==-1&&(this.ctx.textAlign=Ne)}});var Ve=null,ze=null;Object.defineProperty(this,"fontFaces",{get:function(){return ze},set:function(Ne){Ve=null,ze=Ne}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Ne){var ae;if(this.ctx.font=Ne,(ae=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Ne))!==null){var ht=ae[1];ae[2];var et=ae[3],He=ae[4];ae[5];var Re=ae[6],Xe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(He)[2];He=Math.floor(Xe==="px"?parseFloat(He)*this.pdf.internal.scaleFactor:Xe==="em"?parseFloat(He)*this.pdf.getFontSize():parseFloat(He)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(He);var $e=function(vt){var ut,en,Gt=[],tt=vt.trim();if(tt==="")return w0;if(tt in lw)return[lw[tt]];for(;tt!=="";){switch(en=null,ut=(tt=uw(tt)).charAt(0)){case'"':case"'":en=OD(tt.substring(1),ut);break;default:en=FD(tt)}if(en===null||(Gt.push(en[0]),(tt=uw(en[1]))!==""&&tt.charAt(0)!==","))return w0;tt=tt.replace(/^,/,"")}return Gt}(Re);if(this.fontFaces){var Oe=function(vt,ut){if(Ve===null){var en=function(Gt){var tt=[];return Object.keys(Gt).forEach(function(_t){Gt[_t].forEach(function(an){var pt=null;switch(an){case"bold":pt={family:_t,weight:"bold"};break;case"italic":pt={family:_t,style:"italic"};break;case"bolditalic":pt={family:_t,weight:"bold",style:"italic"};break;case"":case"normal":pt={family:_t}}pt!==null&&(pt.ref={name:_t,style:an},tt.push(pt))})}),tt}(vt.getFontList());Ve=function(Gt){for(var tt={},_t=0;_t<Gt.length;++_t){var an=b0(Gt[_t]),pt=an.family,Dt=an.stretch,At=an.style,In=an.weight;tt[pt]=tt[pt]||{},tt[pt][Dt]=tt[pt][Dt]||{},tt[pt][Dt][At]=tt[pt][Dt][At]||{},tt[pt][Dt][At][In]=an}return tt}(en.concat(ut))}return Ve}(this.pdf,this.fontFaces),Pe=$e.map(function(vt){return{family:vt,stretch:"normal",weight:et,style:ht}}),qt=function(vt,ut,en){for(var Gt=(en=en||{}).defaultFontFamily||"times",tt=Object.assign({},MD,en.genericFontFamilies||{}),_t=null,an=null,pt=0;pt<ut.length;++pt)if(tt[(_t=b0(ut[pt])).family]&&(_t.family=tt[_t.family]),vt.hasOwnProperty(_t.family)){an=vt[_t.family];break}if(!(an=an||vt[Gt]))throw new Error("Could not find a font-family for the rule '"+cw(_t)+"' and default family '"+Gt+"'.");if(an=function(Dt,At){if(At[Dt])return At[Dt];var In=J1[Dt],Sn=In<=J1.normal?-1:1,nn=ow(At,KS,In,Sn);if(!nn)throw new Error("Could not find a matching font-stretch value for "+Dt);return nn}(_t.stretch,an),an=function(Dt,At){if(At[Dt])return At[Dt];for(var In=GS[Dt],Sn=0;Sn<In.length;++Sn)if(At[In[Sn]])return At[In[Sn]];throw new Error("Could not find a matching font-style for "+Dt)}(_t.style,an),!(an=function(Dt,At){if(At[Dt])return At[Dt];if(Dt===400&&At[500])return At[500];if(Dt===500&&At[400])return At[400];var In=DD[Dt],Sn=ow(At,YS,In,Dt<400?-1:1);if(!Sn)throw new Error("Could not find a matching font-weight for value "+Dt);return Sn}(_t.weight,an)))throw new Error("Failed to resolve a font for the rule '"+cw(_t)+"'.");return an}(Oe,Pe);this.pdf.setFont(qt.ref.name,qt.ref.style)}else{var Et="";(et==="bold"||parseInt(et,10)>=700||ht==="bold")&&(Et="bold"),ht==="italic"&&(Et+="italic"),Et.length===0&&(Et="normal");for(var it="",Tt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},wt=0;wt<$e.length;wt++){if(this.pdf.internal.getFont($e[wt],Et,{noFallback:!0,disableWarning:!0})!==void 0){it=$e[wt];break}if(Et==="bolditalic"&&this.pdf.internal.getFont($e[wt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)it=$e[wt],Et="bold";else if(this.pdf.internal.getFont($e[wt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){it=$e[wt],Et="normal";break}}if(it===""){for(var at=0;at<$e.length;at++)if(Tt[$e[at]]){it=Tt[$e[at]];break}}it=it===""?"Times":it,this.pdf.setFont(it,Et)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Ne){this.ctx.globalCompositeOperation=Ne}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Ne){this.ctx.globalAlpha=Ne}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Ne){this.ctx.lineDashOffset=Ne,Q.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Ne){this.ctx.lineDash=Ne,Q.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Ne){this.ctx.ignoreClearRect=!!Ne}})};g.prototype.setLineDash=function(w){this.lineDash=w},g.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},g.prototype.fill=function(){V.call(this,"fill",!1)},g.prototype.stroke=function(){V.call(this,"stroke",!1)},g.prototype.beginPath=function(){this.path=[{type:"begin"}]},g.prototype.moveTo=function(w,F){if(isNaN(w)||isNaN(F))throw yn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var D=this.ctx.transform.applyToPoint(new o(w,F));this.path.push({type:"mt",x:D.x,y:D.y}),this.ctx.lastPoint=new o(w,F)},g.prototype.closePath=function(){var w=new o(0,0),F=0;for(F=this.path.length-1;F!==-1;F--)if(this.path[F].type==="begin"&&hn(this.path[F+1])==="object"&&typeof this.path[F+1].x=="number"){w=new o(this.path[F+1].x,this.path[F+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(w.x,w.y)},g.prototype.lineTo=function(w,F){if(isNaN(w)||isNaN(F))throw yn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var D=this.ctx.transform.applyToPoint(new o(w,F));this.path.push({type:"lt",x:D.x,y:D.y}),this.ctx.lastPoint=new o(D.x,D.y)},g.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),V.call(this,null,!0)},g.prototype.quadraticCurveTo=function(w,F,D,K){if(isNaN(D)||isNaN(K)||isNaN(w)||isNaN(F))throw yn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var te=this.ctx.transform.applyToPoint(new o(D,K)),oe=this.ctx.transform.applyToPoint(new o(w,F));this.path.push({type:"qct",x1:oe.x,y1:oe.y,x:te.x,y:te.y}),this.ctx.lastPoint=new o(te.x,te.y)},g.prototype.bezierCurveTo=function(w,F,D,K,te,oe){if(isNaN(te)||isNaN(oe)||isNaN(w)||isNaN(F)||isNaN(D)||isNaN(K))throw yn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var he=this.ctx.transform.applyToPoint(new o(te,oe)),pe=this.ctx.transform.applyToPoint(new o(w,F)),ve=this.ctx.transform.applyToPoint(new o(D,K));this.path.push({type:"bct",x1:pe.x,y1:pe.y,x2:ve.x,y2:ve.y,x:he.x,y:he.y}),this.ctx.lastPoint=new o(he.x,he.y)},g.prototype.arc=function(w,F,D,K,te,oe){if(isNaN(w)||isNaN(F)||isNaN(D)||isNaN(K)||isNaN(te))throw yn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(oe=!!oe,!this.ctx.transform.isIdentity){var he=this.ctx.transform.applyToPoint(new o(w,F));w=he.x,F=he.y;var pe=this.ctx.transform.applyToPoint(new o(0,D)),ve=this.ctx.transform.applyToPoint(new o(0,0));D=Math.sqrt(Math.pow(pe.x-ve.x,2)+Math.pow(pe.y-ve.y,2))}Math.abs(te-K)>=2*Math.PI&&(K=0,te=2*Math.PI),this.path.push({type:"arc",x:w,y:F,radius:D,startAngle:K,endAngle:te,counterclockwise:oe})},g.prototype.arcTo=function(w,F,D,K,te){throw new Error("arcTo not implemented.")},g.prototype.rect=function(w,F,D,K){if(isNaN(w)||isNaN(F)||isNaN(D)||isNaN(K))throw yn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(w,F),this.lineTo(w+D,F),this.lineTo(w+D,F+K),this.lineTo(w,F+K),this.lineTo(w,F),this.lineTo(w+D,F),this.lineTo(w,F)},g.prototype.fillRect=function(w,F,D,K){if(isNaN(w)||isNaN(F)||isNaN(D)||isNaN(K))throw yn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var te={};this.lineCap!=="butt"&&(te.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(te.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(w,F,D,K),this.fill(),te.hasOwnProperty("lineCap")&&(this.lineCap=te.lineCap),te.hasOwnProperty("lineJoin")&&(this.lineJoin=te.lineJoin)}},g.prototype.strokeRect=function(w,F,D,K){if(isNaN(w)||isNaN(F)||isNaN(D)||isNaN(K))throw yn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");E.call(this)||(this.beginPath(),this.rect(w,F,D,K),this.stroke())},g.prototype.clearRect=function(w,F,D,K){if(isNaN(w)||isNaN(F)||isNaN(D)||isNaN(K))throw yn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(w,F,D,K))},g.prototype.save=function(w){w=typeof w!="boolean"||w;for(var F=this.pdf.internal.getCurrentPageInfo().pageNumber,D=0;D<this.pdf.internal.getNumberOfPages();D++)this.pdf.setPage(D+1),this.pdf.internal.out("q");if(this.pdf.setPage(F),w){this.ctx.fontSize=this.pdf.internal.getFontSize();var K=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=K}},g.prototype.restore=function(w){w=typeof w!="boolean"||w;for(var F=this.pdf.internal.getCurrentPageInfo().pageNumber,D=0;D<this.pdf.internal.getNumberOfPages();D++)this.pdf.setPage(D+1),this.pdf.internal.out("Q");this.pdf.setPage(F),w&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},g.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var v=function(w){var F,D,K,te;if(w.isCanvasGradient===!0&&(w=w.getColor()),!w)return{r:0,g:0,b:0,a:0,style:w};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(w))F=0,D=0,K=0,te=0;else{var oe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(w);if(oe!==null)F=parseInt(oe[1]),D=parseInt(oe[2]),K=parseInt(oe[3]),te=1;else if((oe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(w))!==null)F=parseInt(oe[1]),D=parseInt(oe[2]),K=parseInt(oe[3]),te=parseFloat(oe[4]);else{if(te=1,typeof w=="string"&&w.charAt(0)!=="#"){var he=new US(w);w=he.ok?he.toHex():"#000000"}w.length===4?(F=w.substring(1,2),F+=F,D=w.substring(2,3),D+=D,K=w.substring(3,4),K+=K):(F=w.substring(1,3),D=w.substring(3,5),K=w.substring(5,7)),F=parseInt(F,16),D=parseInt(D,16),K=parseInt(K,16)}}return{r:F,g:D,b:K,a:te,style:w}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},E=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};g.prototype.fillText=function(w,F,D,K){if(isNaN(F)||isNaN(D)||typeof w!="string")throw yn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(K=isNaN(K)?void 0:K,!m.call(this)){var te=U(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;P.call(this,{text:w,x:F,y:D,scale:oe,angle:te,align:this.textAlign,maxWidth:K})}},g.prototype.strokeText=function(w,F,D,K){if(isNaN(F)||isNaN(D)||typeof w!="string")throw yn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!E.call(this)){K=isNaN(K)?void 0:K;var te=U(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;P.call(this,{text:w,x:F,y:D,scale:oe,renderingMode:"stroke",angle:te,align:this.textAlign,maxWidth:K})}},g.prototype.measureText=function(w){if(typeof w!="string")throw yn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var F=this.pdf,D=this.pdf.internal.scaleFactor,K=F.internal.getFontSize(),te=F.getStringUnitWidth(w)*K/F.internal.scaleFactor;return new function(oe){var he=(oe=oe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return he}}),this}({width:te*=Math.round(96*D/72*1e4)/1e4})},g.prototype.scale=function(w,F){if(isNaN(w)||isNaN(F))throw yn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var D=new c(w,0,0,F,0,0);this.ctx.transform=this.ctx.transform.multiply(D)},g.prototype.rotate=function(w){if(isNaN(w))throw yn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var F=new c(Math.cos(w),Math.sin(w),-Math.sin(w),Math.cos(w),0,0);this.ctx.transform=this.ctx.transform.multiply(F)},g.prototype.translate=function(w,F){if(isNaN(w)||isNaN(F))throw yn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var D=new c(1,0,0,1,w,F);this.ctx.transform=this.ctx.transform.multiply(D)},g.prototype.transform=function(w,F,D,K,te,oe){if(isNaN(w)||isNaN(F)||isNaN(D)||isNaN(K)||isNaN(te)||isNaN(oe))throw yn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var he=new c(w,F,D,K,te,oe);this.ctx.transform=this.ctx.transform.multiply(he)},g.prototype.setTransform=function(w,F,D,K,te,oe){w=isNaN(w)?1:w,F=isNaN(F)?0:F,D=isNaN(D)?0:D,K=isNaN(K)?1:K,te=isNaN(te)?0:te,oe=isNaN(oe)?0:oe,this.ctx.transform=new c(w,F,D,K,te,oe)};var A=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};g.prototype.drawImage=function(w,F,D,K,te,oe,he,pe,ve){var Ee=this.pdf.getImageProperties(w),Ve=1,ze=1,Ne=1,ae=1;K!==void 0&&pe!==void 0&&(Ne=pe/K,ae=ve/te,Ve=Ee.width/K*pe/K,ze=Ee.height/te*ve/te),oe===void 0&&(oe=F,he=D,F=0,D=0),K!==void 0&&pe===void 0&&(pe=K,ve=te),K===void 0&&pe===void 0&&(pe=Ee.width,ve=Ee.height);for(var ht,et=this.ctx.transform.decompose(),He=U(et.rotate.shx),Re=new c,Xe=(Re=(Re=(Re=Re.multiply(et.translate)).multiply(et.skew)).multiply(et.scale)).applyToRectangle(new l(oe-F*Ne,he-D*ae,K*Ve,te*ze)),$e=C.call(this,Xe),Oe=[],Pe=0;Pe<$e.length;Pe+=1)Oe.indexOf($e[Pe])===-1&&Oe.push($e[Pe]);if(O(Oe),this.autoPaging)for(var qt=Oe[0],Et=Oe[Oe.length-1],it=qt;it<Et+1;it++){this.pdf.setPage(it);var Tt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],wt=it===1?this.posY+this.margin[0]:this.margin[0],at=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],vt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ut=it===1?0:at+(it-2)*vt;if(this.ctx.clip_path.length!==0){var en=this.path;ht=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=I(ht,this.posX+this.margin[3],-ut+wt+this.ctx.prevPageLastElemOffset),ne.call(this,"fill",!0),this.path=en}var Gt=JSON.parse(JSON.stringify(Xe));Gt=I([Gt],this.posX+this.margin[3],-ut+wt+this.ctx.prevPageLastElemOffset)[0];var tt=(it>qt||it<Et)&&A.call(this);tt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Tt,vt,null).clip().discardPath()),this.pdf.addImage(w,"JPEG",Gt.x,Gt.y,Gt.w,Gt.h,null,null,He),tt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(w,"JPEG",Xe.x,Xe.y,Xe.w,Xe.h,null,null,He)};var C=function(w,F,D){var K=[];F=F||this.pdf.internal.pageSize.width,D=D||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var te=this.posY+this.ctx.prevPageLastElemOffset;switch(w.type){default:case"mt":case"lt":K.push(Math.floor((w.y+te)/D)+1);break;case"arc":K.push(Math.floor((w.y+te-w.radius)/D)+1),K.push(Math.floor((w.y+te+w.radius)/D)+1);break;case"qct":var oe=ee(this.ctx.lastPoint.x,this.ctx.lastPoint.y,w.x1,w.y1,w.x,w.y);K.push(Math.floor((oe.y+te)/D)+1),K.push(Math.floor((oe.y+oe.h+te)/D)+1);break;case"bct":var he=fe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,w.x1,w.y1,w.x2,w.y2,w.x,w.y);K.push(Math.floor((he.y+te)/D)+1),K.push(Math.floor((he.y+he.h+te)/D)+1);break;case"rect":K.push(Math.floor((w.y+te)/D)+1),K.push(Math.floor((w.y+w.h+te)/D)+1)}for(var pe=0;pe<K.length;pe+=1)for(;this.pdf.internal.getNumberOfPages()<K[pe];)b.call(this);return K},b=function(){var w=this.fillStyle,F=this.strokeStyle,D=this.font,K=this.lineCap,te=this.lineWidth,oe=this.lineJoin;this.pdf.addPage(),this.fillStyle=w,this.strokeStyle=F,this.font=D,this.lineCap=K,this.lineWidth=te,this.lineJoin=oe},I=function(w,F,D){for(var K=0;K<w.length;K++)switch(w[K].type){case"bct":w[K].x2+=F,w[K].y2+=D;case"qct":w[K].x1+=F,w[K].y1+=D;default:w[K].x+=F,w[K].y+=D}return w},O=function(w){return w.sort(function(F,D){return F-D})},V=function(w,F){for(var D,K,te=this.fillStyle,oe=this.strokeStyle,he=this.lineCap,pe=this.lineWidth,ve=Math.abs(pe*this.ctx.transform.scaleX),Ee=this.lineJoin,Ve=JSON.parse(JSON.stringify(this.path)),ze=JSON.parse(JSON.stringify(this.path)),Ne=[],ae=0;ae<ze.length;ae++)if(ze[ae].x!==void 0)for(var ht=C.call(this,ze[ae]),et=0;et<ht.length;et+=1)Ne.indexOf(ht[et])===-1&&Ne.push(ht[et]);for(var He=0;He<Ne.length;He++)for(;this.pdf.internal.getNumberOfPages()<Ne[He];)b.call(this);if(O(Ne),this.autoPaging)for(var Re=Ne[0],Xe=Ne[Ne.length-1],$e=Re;$e<Xe+1;$e++){this.pdf.setPage($e),this.fillStyle=te,this.strokeStyle=oe,this.lineCap=he,this.lineWidth=ve,this.lineJoin=Ee;var Oe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Pe=$e===1?this.posY+this.margin[0]:this.margin[0],qt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Et=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],it=$e===1?0:qt+($e-2)*Et;if(this.ctx.clip_path.length!==0){var Tt=this.path;D=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=I(D,this.posX+this.margin[3],-it+Pe+this.ctx.prevPageLastElemOffset),ne.call(this,w,!0),this.path=Tt}if(K=JSON.parse(JSON.stringify(Ve)),this.path=I(K,this.posX+this.margin[3],-it+Pe+this.ctx.prevPageLastElemOffset),F===!1||$e===0){var wt=($e>Re||$e<Xe)&&A.call(this);wt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Oe,Et,null).clip().discardPath()),ne.call(this,w,F),wt&&this.pdf.restoreGraphicsState()}this.lineWidth=pe}else this.lineWidth=ve,ne.call(this,w,F),this.lineWidth=pe;this.path=Ve},ne=function(w,F){if((w!=="stroke"||F||!E.call(this))&&(w==="stroke"||F||!m.call(this))){for(var D,K,te=[],oe=this.path,he=0;he<oe.length;he++){var pe=oe[he];switch(pe.type){case"begin":te.push({begin:!0});break;case"close":te.push({close:!0});break;case"mt":te.push({start:pe,deltas:[],abs:[]});break;case"lt":var ve=te.length;if(oe[he-1]&&!isNaN(oe[he-1].x)&&(D=[pe.x-oe[he-1].x,pe.y-oe[he-1].y],ve>0)){for(;ve>=0;ve--)if(te[ve-1].close!==!0&&te[ve-1].begin!==!0){te[ve-1].deltas.push(D),te[ve-1].abs.push(pe);break}}break;case"bct":D=[pe.x1-oe[he-1].x,pe.y1-oe[he-1].y,pe.x2-oe[he-1].x,pe.y2-oe[he-1].y,pe.x-oe[he-1].x,pe.y-oe[he-1].y],te[te.length-1].deltas.push(D);break;case"qct":var Ee=oe[he-1].x+2/3*(pe.x1-oe[he-1].x),Ve=oe[he-1].y+2/3*(pe.y1-oe[he-1].y),ze=pe.x+2/3*(pe.x1-pe.x),Ne=pe.y+2/3*(pe.y1-pe.y),ae=pe.x,ht=pe.y;D=[Ee-oe[he-1].x,Ve-oe[he-1].y,ze-oe[he-1].x,Ne-oe[he-1].y,ae-oe[he-1].x,ht-oe[he-1].y],te[te.length-1].deltas.push(D);break;case"arc":te.push({deltas:[],abs:[],arc:!0}),Array.isArray(te[te.length-1].abs)&&te[te.length-1].abs.push(pe)}}K=F?null:w==="stroke"?"stroke":"fill";for(var et=!1,He=0;He<te.length;He++)if(te[He].arc)for(var Re=te[He].abs,Xe=0;Xe<Re.length;Xe++){var $e=Re[Xe];$e.type==="arc"?T.call(this,$e.x,$e.y,$e.radius,$e.startAngle,$e.endAngle,$e.counterclockwise,void 0,F,!et):R.call(this,$e.x,$e.y),et=!0}else if(te[He].close===!0)this.pdf.internal.out("h"),et=!1;else if(te[He].begin!==!0){var Oe=te[He].start.x,Pe=te[He].start.y;$.call(this,te[He].deltas,Oe,Pe),et=!0}K&&k.call(this,K),F&&N.call(this)}},le=function(w){var F=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,D=F*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return w-D;case"top":return w+F-D;case"hanging":return w+F-2*D;case"middle":return w+F/2-D;default:return w}},z=function(w){return w+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};g.prototype.createLinearGradient=function(){var w=function(){};return w.colorStops=[],w.addColorStop=function(F,D){this.colorStops.push([F,D])},w.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},w.isCanvasGradient=!0,w},g.prototype.createPattern=function(){return this.createLinearGradient()},g.prototype.createRadialGradient=function(){return this.createLinearGradient()};var T=function(w,F,D,K,te,oe,he,pe,ve){for(var Ee=Y.call(this,D,K,te,oe),Ve=0;Ve<Ee.length;Ve++){var ze=Ee[Ve];Ve===0&&(ve?S.call(this,ze.x1+w,ze.y1+F):R.call(this,ze.x1+w,ze.y1+F)),H.call(this,w,F,ze.x2,ze.y2,ze.x3,ze.y3,ze.x4,ze.y4)}pe?N.call(this):k.call(this,he)},k=function(w){switch(w){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},N=function(){this.pdf.clip(),this.pdf.discardPath()},S=function(w,F){this.pdf.internal.out(n(w)+" "+r(F)+" m")},P=function(w){var F;switch(w.align){case"right":case"end":F="right";break;case"center":F="center";break;default:F="left"}var D=this.pdf.getTextDimensions(w.text),K=le.call(this,w.y),te=z.call(this,K)-D.h,oe=this.ctx.transform.applyToPoint(new o(w.x,K)),he=this.ctx.transform.decompose(),pe=new c;pe=(pe=(pe=pe.multiply(he.translate)).multiply(he.skew)).multiply(he.scale);for(var ve,Ee,Ve,ze=this.ctx.transform.applyToRectangle(new l(w.x,K,D.w,D.h)),Ne=pe.applyToRectangle(new l(w.x,te,D.w,D.h)),ae=C.call(this,Ne),ht=[],et=0;et<ae.length;et+=1)ht.indexOf(ae[et])===-1&&ht.push(ae[et]);if(O(ht),this.autoPaging)for(var He=ht[0],Re=ht[ht.length-1],Xe=He;Xe<Re+1;Xe++){this.pdf.setPage(Xe);var $e=Xe===1?this.posY+this.margin[0]:this.margin[0],Oe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Pe=this.pdf.internal.pageSize.height-this.margin[2],qt=Pe-this.margin[0],Et=this.pdf.internal.pageSize.width-this.margin[1],it=Et-this.margin[3],Tt=Xe===1?0:Oe+(Xe-2)*qt;if(this.ctx.clip_path.length!==0){var wt=this.path;ve=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=I(ve,this.posX+this.margin[3],-1*Tt+$e),ne.call(this,"fill",!0),this.path=wt}var at=I([JSON.parse(JSON.stringify(Ne))],this.posX+this.margin[3],-Tt+$e+this.ctx.prevPageLastElemOffset)[0];w.scale>=.01&&(Ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ee*w.scale),Ve=this.lineWidth,this.lineWidth=Ve*w.scale);var vt=this.autoPaging!=="text";if(vt||at.y+at.h<=Pe){if(vt||at.y>=$e&&at.x<=Et){var ut=vt?w.text:this.pdf.splitTextToSize(w.text,w.maxWidth||Et-at.x)[0],en=I([JSON.parse(JSON.stringify(ze))],this.posX+this.margin[3],-Tt+$e+this.ctx.prevPageLastElemOffset)[0],Gt=vt&&(Xe>He||Xe<Re)&&A.call(this);Gt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],it,qt,null).clip().discardPath()),this.pdf.text(ut,en.x,en.y,{angle:w.angle,align:F,renderingMode:w.renderingMode}),Gt&&this.pdf.restoreGraphicsState()}}else at.y<Pe&&(this.ctx.prevPageLastElemOffset+=Pe-at.y);w.scale>=.01&&(this.pdf.setFontSize(Ee),this.lineWidth=Ve)}else w.scale>=.01&&(Ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ee*w.scale),Ve=this.lineWidth,this.lineWidth=Ve*w.scale),this.pdf.text(w.text,oe.x+this.posX,oe.y+this.posY,{angle:w.angle,align:F,renderingMode:w.renderingMode,maxWidth:w.maxWidth}),w.scale>=.01&&(this.pdf.setFontSize(Ee),this.lineWidth=Ve)},R=function(w,F,D,K){D=D||0,K=K||0,this.pdf.internal.out(n(w+D)+" "+r(F+K)+" l")},$=function(w,F,D){return this.pdf.lines(w,F,D,null,null)},H=function(w,F,D,K,te,oe,he,pe){this.pdf.internal.out([e(i(D+w)),e(s(K+F)),e(i(te+w)),e(s(oe+F)),e(i(he+w)),e(s(pe+F)),"c"].join(" "))},Y=function(w,F,D,K){for(var te=2*Math.PI,oe=Math.PI/2;F>D;)F-=te;var he=Math.abs(D-F);he<te&&K&&(he=te-he);for(var pe=[],ve=K?-1:1,Ee=F;he>1e-5;){var Ve=Ee+ve*Math.min(he,oe);pe.push(M.call(this,w,Ee,Ve)),he-=Math.abs(Ve-Ee),Ee=Ve}return pe},M=function(w,F,D){var K=(D-F)/2,te=w*Math.cos(K),oe=w*Math.sin(K),he=te,pe=-oe,ve=he*he+pe*pe,Ee=ve+he*te+pe*oe,Ve=4/3*(Math.sqrt(2*ve*Ee)-Ee)/(he*oe-pe*te),ze=he-Ve*pe,Ne=pe+Ve*he,ae=ze,ht=-Ne,et=K+F,He=Math.cos(et),Re=Math.sin(et);return{x1:w*Math.cos(F),y1:w*Math.sin(F),x2:ze*He-Ne*Re,y2:ze*Re+Ne*He,x3:ae*He-ht*Re,y3:ae*Re+ht*He,x4:w*Math.cos(D),y4:w*Math.sin(D)}},U=function(w){return 180*w/Math.PI},ee=function(w,F,D,K,te,oe){var he=w+.5*(D-w),pe=F+.5*(K-F),ve=te+.5*(D-te),Ee=oe+.5*(K-oe),Ve=Math.min(w,te,he,ve),ze=Math.max(w,te,he,ve),Ne=Math.min(F,oe,pe,Ee),ae=Math.max(F,oe,pe,Ee);return new l(Ve,Ne,ze-Ve,ae-Ne)},fe=function(w,F,D,K,te,oe,he,pe){var ve,Ee,Ve,ze,Ne,ae,ht,et,He,Re,Xe,$e,Oe,Pe,qt=D-w,Et=K-F,it=te-D,Tt=oe-K,wt=he-te,at=pe-oe;for(Ee=0;Ee<41;Ee++)He=(ht=(Ve=w+(ve=Ee/40)*qt)+ve*((Ne=D+ve*it)-Ve))+ve*(Ne+ve*(te+ve*wt-Ne)-ht),Re=(et=(ze=F+ve*Et)+ve*((ae=K+ve*Tt)-ze))+ve*(ae+ve*(oe+ve*at-ae)-et),Ee==0?(Xe=He,$e=Re,Oe=He,Pe=Re):(Xe=Math.min(Xe,He),$e=Math.min($e,Re),Oe=Math.max(Oe,He),Pe=Math.max(Pe,Re));return new l(Math.round(Xe),Math.round($e),Math.round(Oe-Xe),Math.round(Pe-$e))},Q=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var w,F,D=(w=this.ctx.lineDash,F=this.ctx.lineDashOffset,JSON.stringify({lineDash:w,lineDashOffset:F}));this.prevLineDash!==D&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=D)}}})(lt.API),function(t){var e=function(o){var l,c,u,f,g,v,m,E,A,C;for(c=[],u=0,f=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;f>u;u+=4)(g=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(v=(g=((g=((g=((g=(g-(C=g%85))/85)-(A=g%85))/85)-(E=g%85))/85)-(m=g%85))/85)%85,c.push(v+33,m+33,E+33,A+33,C+33)):c.push(122);return function(b,I){for(var O=I;O>0;O--)b.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},n=function(o){var l,c,u,f,g,v=String,m="length",E=255,A="charCodeAt",C="slice",b="replace";for(o[C](-2),o=o[C](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),u=[],f=0,g=(o+=l="uuuuu"[C](o[m]%5||5))[m];g>f;f+=5)c=52200625*(o[A](f)-33)+614125*(o[A](f+1)-33)+7225*(o[A](f+2)-33)+85*(o[A](f+3)-33)+(o[A](f+4)-33),u.push(E&c>>24,E&c>>16,E&c>>8,E&c);return function(I,O){for(var V=O;V>0;V--)I.pop()}(u,l[m]),v.fromCharCode.apply(v,u)},r=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=H1(l)).reduce(function(u,f){return u+String.fromCharCode(f)},"")};t.processDataByFilters=function(o,l){var c=0,u=o||"",f=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=n(u),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=i(u),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=r(u),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:f.reverse().join(" ")}}}(lt.API),function(t){t.loadFile=function(e,n,r){return function(i,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,f){var g=new XMLHttpRequest,v=0,m=function(E){var A=E.length,C=[],b=String.fromCharCode;for(v=0;v<A;v+=1)C.push(b(255&E.charCodeAt(v)));return C.join("")};if(g.open("GET",c,!u),g.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(g.onload=function(){g.status===200?f(m(this.responseText)):f(void 0)}),g.send(null),u&&g.status===200)return m(g.responseText)}(i,s,o)}catch{}return l}(e,n,r)},t.loadImageFile=t.loadFile}(lt.API),function(t){function e(){return(St.html2canvas?Promise.resolve(St.html2canvas):n0(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function n(){return(St.DOMPurify?Promise.resolve(St.DOMPurify):n0(()=>import("./purify.es-B6FQ9oRL.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var r=function(l){var c=hn(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},i=function(l,c){var u=document.createElement(l);for(var f in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[f]=c.style[f];return u},s=function l(c,u){for(var f=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),g=c.firstChild;g;g=g.nextSibling)u!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||f.appendChild(l(g,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(f.value=c.value),f.addEventListener("load",function(){f.scrollTop=c.scrollTop,f.scrollLeft=c.scrollLeft},!0)),f},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),f=l.convert(Promise.resolve(),u);return(f=f.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(r(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(n).then(function(u){return this.set({src:i("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=this.opt.jsPDF,f=this.opt.fontFaces,g=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,v=Object.assign({async:!0,allowTaint:!0,scale:g,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete v.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=f,f)for(var m=0;m<f.length;++m){var E=f[m],A=E.src.find(function(C){return C.format==="truetype"});A&&u.addFont(A.url,E.ref.name,E.ref.style)}return v.windowHeight=v.windowHeight||0,v.windowHeight=v.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):v.windowHeight,u.context2d.save(!0),c(this.prop.container,v)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(r(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(r(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,f){return Math.floor(u*f/72*96)}return this.then(function(){(l=l||lt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,f){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,f){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,f?this.progress.stack.concat(f):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(f,g){return u.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(v){return u.updateProgress(null,f),v}).then(f,g).then(function(v){return u.updateProgress(1),v})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var f=this;l&&(l=l.bind(f)),c&&(c=c.bind(f));var g=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:o.convert(Object.assign({},f),Promise.prototype),v=u.call(g,l,c);return o.convert(v,f.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,lt.getPageSize=function(l,c,u){if(hn(l)==="object"){var f=l;l=f.orientation,c=f.unit||c,u=f.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var g,v=(""+u).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":g=1;break;case"mm":g=72/25.4;break;case"cm":g=72/2.54;break;case"in":g=72;break;case"px":g=.75;break;case"pc":case"em":g=12;break;case"ex":g=6;break;default:throw"Invalid unit: "+c}var E,A=0,C=0;if(m.hasOwnProperty(v))A=m[v][1]/g,C=m[v][0]/g;else try{A=u[1],C=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",C>A&&(E=C,C=A,A=E);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",A>C&&(E=C,C=A,A=E)}return{width:C,height:A,unit:c,k:g,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(b0):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(lt.API),lt.API.addJS=function(t){return hw=t,this.internal.events.subscribe("postPutResources",function(){Of=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Of+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),dw=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+hw+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Of!==void 0&&dw!==void 0&&this.internal.out("/Names <</JavaScript "+Of+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=n.outline.render().split(/\r\n/),s=0;s<i.length;s++){var o=i[s],l=r.exec(o);if(l!=null){var c=l[1];n.internal.newObjectDeferredBegin(c,!1)}n.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,f=[];for(s=0;s<u;s++){var g=n.internal.newObject();f.push(g);var v=n.internal.getPageInfo(s+1);n.internal.write("<< /D["+v.objId+" 0 R /XYZ null null null]>> endobj")}var m=n.internal.newObject();for(n.internal.write("<< /Names [ "),s=0;s<f.length;s++)n.internal.write("(page_"+(s+1)+")"+f[s]+" 0 R");n.internal.write(" ] >>","endobj"),e=n.internal.newObject(),n.internal.write("<< /Dests "+m+" 0 R"),n.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,i,s){var o={title:i,options:s,children:[]};return r==null&&(r=this.root),r.children.push(o),o},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<r.children.length;s++){var o=r.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(r)),s>0&&this.line("/Prev "+this.makeRef(r.children[s-1])),s<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=n.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<r.children.length;u++)this.renderItems(r.children[u])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,i){for(var s=0;s<i.children.length;s++)r.count++,this.count_r(r,i.children[s]);return r.count}}])}(lt.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(n,r,i,s,o,l){var c,u=this.decode.DCT_DECODE,f=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=o||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,c=function(g){for(var v,m=256*g.charCodeAt(4)+g.charCodeAt(5),E=g.length,A={width:0,height:0,numcomponents:1},C=4;C<E;C+=2){if(C+=m,e.indexOf(g.charCodeAt(C+1))!==-1){v=256*g.charCodeAt(C+5)+g.charCodeAt(C+6),A={width:256*g.charCodeAt(C+7)+g.charCodeAt(C+8),height:v,numcomponents:g.charCodeAt(C+9)};break}m=256*g.charCodeAt(C+2)+g.charCodeAt(C+3)}return A}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}f={data:n,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:r,alias:i}}return f}}(lt.API),lt.API.processPNG=function(t,e,n,r){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var i,s=wD(t,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,u=s.palette,f=s.depth;i=u&&c===1?function(T){for(var k=T.width,N=T.height,S=T.data,P=T.palette,R=T.depth,$=!1,H=[],Y=[],M=void 0,U=!1,ee=0,fe=0;fe<P.length;fe++){var Q=g5(P[fe],4),w=Q[0],F=Q[1],D=Q[2],K=Q[3];H.push(w,F,D),K!=null&&(K===0?(ee++,Y.length<1&&Y.push(fe)):K<255&&(U=!0))}if(U||ee>1){$=!0,Y=void 0;var te=k*N;M=new Uint8Array(te);for(var oe=new DataView(S.buffer),he=0;he<te;he++){var pe=_0(oe,he,R),ve=g5(P[pe],4)[3];M[he]=ve}}else ee===0&&(Y=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:$?8:void 0,colorBytes:S,alphaBytes:M,needSMask:$,palette:H,mask:Y}}(s):c===2||c===4?function(T){for(var k=T.data,N=T.width,S=T.height,P=T.channels,R=T.depth,$=P===2?"DeviceGray":"DeviceRGB",H=P-1,Y=N*S,M=H,U=Y*M,ee=1*Y,fe=Math.ceil(U*R/8),Q=Math.ceil(ee*R/8),w=new Uint8Array(fe),F=new Uint8Array(Q),D=new DataView(k.buffer),K=new DataView(w.buffer),te=new DataView(F.buffer),oe=!1,he=0;he<Y;he++){for(var pe=he*P,ve=0;ve<M;ve++)ww(K,_0(D,pe+ve,R),he*M+ve,R);var Ee=_0(D,pe+M,R);Ee<(1<<R)-1&&(oe=!0),ww(te,Ee,1*he,R)}return{colorSpace:$,colorsPerPixel:H,sMaskBitsPerComponent:oe?R:void 0,colorBytes:w,alphaBytes:F,needSMask:oe}}(s):function(T){var k=T.data,N=T.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:N,colorsPerPixel:N==="DeviceGray"?1:3,colorBytes:k instanceof Uint16Array?function(S){for(var P=S.length,R=new Uint8Array(2*P),$=new DataView(R.buffer,R.byteOffset,R.byteLength),H=0;H<P;H++)$.setUint16(2*H,S[H],!1);return R}(k):k,needSMask:!1}}(s);var g,v,m,E=i,A=E.colorSpace,C=E.colorsPerPixel,b=E.sMaskBitsPerComponent,I=E.colorBytes,O=E.alphaBytes,V=E.needSMask,ne=E.palette,le=E.mask,z=null;return r!==lt.API.image_compression.NONE&&typeof H1=="function"?(z=function(T){var k;switch(T){case lt.API.image_compression.FAST:k=11;break;case lt.API.image_compression.MEDIUM:k=13;break;case lt.API.image_compression.SLOW:k=14;break;default:k=12}return k}(r),g=this.decode.FLATE_DECODE,v="/Predictor ".concat(z," /Colors ").concat(C," /BitsPerComponent ").concat(f," /Columns ").concat(o),t=gw(I,Math.ceil(o*C*f/8),C,f,r),V&&(m=gw(O,Math.ceil(o*b/8),1,b,r))):(g=void 0,v=void 0,t=I,V&&(m=O)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(m&&this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),{alias:n,data:t,index:e,filter:g,decodeParameters:v,transparency:le,palette:ne,sMask:m,predictor:z,width:o,height:l,bitsPerComponent:f,sMaskBitsPerComponent:b,colorSpace:A}}},function(t){t.processGIF89A=function(e,n,r,i){var s=new zD(e),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},f=new N0(100).encode(u,100);return t.processJPEG.call(this,f,n,r,i)},t.processGIF87A=t.processGIF89A}(lt.API),ks.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:r,blue:n,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ks.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(n){yn.log("bit decode error:"+n)}},ks.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}n!==0&&(this.pos+=4-n)}},ks.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<t;i++){var s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+2*i*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*i+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},ks.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+4*r;if(i<this.palette.length){var o=this.palette[i];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},ks.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,l=(s>>5&e)/e*255|0,c=(s>>10&e)/e*255|0,u=s>>15?255:0,f=r*this.width*4+4*i;this.data[f]=c,this.data[f+1]=l,this.data[f+2]=o,this.data[f+3]=u}this.pos+=t}},ks.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&n)/n*255|0,u=(o>>11)/e*255|0,f=i*this.width*4+4*s;this.data[f]=u,this.data[f+1]=c,this.data[f+2]=l,this.data[f+3]=255}this.pos+=t}},ks.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*n;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=r,this.data[o+3]=255}this.pos+=this.width%4}},ks.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*n;this.data[l]=s,this.data[l+1]=i,this.data[l+2]=r,this.data[l+3]=o}},ks.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,n,r,i){var s=new ks(e,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new N0(100).encode(c,100);return t.processJPEG.call(this,u,n,r,i)}}(lt.API),Nw.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,n,r,i){var s=new Nw(e),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new N0(100).encode(c,100);return t.processJPEG.call(this,u,n,r,i)}}(lt.API),lt.API.processRGBA=function(t,e,n){for(var r=t.data,i=r.length,s=new Uint8Array(i/4*3),o=new Uint8Array(i/4),l=0,c=0,u=0;u<i;u+=4){var f=r[u],g=r[u+1],v=r[u+2],m=r[u+3];s[l++]=f,s[l++]=g,s[l++]=v,o[c++]=m}var E=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:E,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},lt.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Lc=lt.API,Ff=Lc.getCharWidthsArray=function(t,e){var n,r,i=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:i.metadata.Unicode.kerning,f=u.fof?u.fof:1,g=e.doKerning!==!1,v=0,m=t.length,E=0,A=l[0]||c,C=[];for(n=0;n<m;n++)r=t.charCodeAt(n),typeof i.metadata.widthOfString=="function"?C.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+o*(1e3/s)||0)/1e3):(v=g&&hn(u[r])==="object"&&!isNaN(parseInt(u[r][E],10))?u[r][E]/f:0,C.push((l[r]||A)/c+v)),E=r;return C},fw=Lc.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return Lc.processArabic&&(t=Lc.processArabic(t)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(t,n,i)/n:Ff.apply(this,arguments).reduce(function(s,o){return s+o},0)},mw=function(t,e,n,r){for(var i=[],s=0,o=t.length,l=0;s!==o&&l+e[s]<n;)l+=e[s],s++;i.push(t.slice(0,s));var c=s;for(l=0;s!==o;)l+e[s]>r&&(i.push(t.slice(c,s)),l=0,c=s),l+=e[s],s++;return c!==s&&i.push(t.slice(c,s)),i},pw=function(t,e,n){n||(n={});var r,i,s,o,l,c,u,f=[],g=[f],v=n.textIndent||0,m=0,E=0,A=t.split(" "),C=Ff.apply(this,[" ",n])[0];if(c=n.lineIndent===-1?A[0].length+2:n.lineIndent||0){var b=Array(c).join(" "),I=[];A.map(function(V){(V=V.split(/\s*\n/)).length>1?I=I.concat(V.map(function(ne,le){return(le&&ne.length?`
`:"")+ne})):I.push(V[0])}),A=I,c=fw.apply(this,[b,n])}for(s=0,o=A.length;s<o;s++){var O=0;if(r=A[s],c&&r[0]==`
`&&(r=r.substr(1),O=1),v+m+(E=(i=Ff.apply(this,[r,n])).reduce(function(V,ne){return V+ne},0))>e||O){if(E>e){for(l=mw.apply(this,[r,i,e-(v+m),e]),f.push(l.shift()),f=[l.pop()];l.length;)g.push([l.shift()]);E=i.slice(r.length-(f[0]?f[0].length:0)).reduce(function(V,ne){return V+ne},0)}else f=[r];g.push(f),v=E+c,m=C}else f.push(r),v+=m+E,m=C}return u=c?function(V,ne){return(ne?b:"")+V.join(" ")}:function(V){return V.join(" ")},g.map(u)},Lc.splitTextToSize=function(t,e,n){var r,i=(n=n||{}).fontSize||this.internal.getFontSize(),s=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var g=this.internal.getFont(f.fontName,f.fontStyle),v="Unicode";return g.metadata[v]?{widths:g.metadata[v].widths||{0:1},kerning:g.metadata[v].kerning||{}}:{font:g.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/i;s.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=n.lineIndent;var l,c,u=[];for(l=0,c=r.length;l<c;l++)u=u.concat(pw.apply(this,[r[l],o,s]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",n="klmnopqrstuvwxyz",r={},i={},s=0;s<16;s++)r[n[s]]=e[s],i[e[s]]=n[s];var o=function(v){return"0x"+parseInt(v,10).toString(16)},l=t.__fontmetrics__.compress=function(v){var m,E,A,C,b=["{"];for(var I in v){if(m=v[I],isNaN(parseInt(I,10))?E="'"+I+"'":(I=parseInt(I,10),E=(E=o(I).slice(2)).slice(0,-1)+i[E.slice(-1)]),typeof m=="number")m<0?(A=o(m).slice(3),C="-"):(A=o(m).slice(2),C=""),A=C+A.slice(0,-1)+i[A.slice(-1)];else{if(hn(m)!=="object")throw new Error("Don't know what to do with value type "+hn(m)+".");A=l(m)}b.push(E+A)}return b.push("}"),b.join("")},c=t.__fontmetrics__.uncompress=function(v){if(typeof v!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,E,A,C,b={},I=1,O=b,V=[],ne="",le="",z=v.length-1,T=1;T<z;T+=1)(C=v[T])=="'"?m?(A=m.join(""),m=void 0):m=[]:m?m.push(C):C=="{"?(V.push([O,A]),O={},A=void 0):C=="}"?((E=V.pop())[0][E[1]]=O,A=void 0,O=E[0]):C=="-"?I=-1:A===void 0?r.hasOwnProperty(C)?(ne+=r[C],A=parseInt(ne,16)*I,I=1,ne=""):ne+=C:r.hasOwnProperty(C)?(le+=r[C],O[A]=parseInt(le,16)*I,I=1,A=void 0,le=""):le+=C;return b},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},g={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(v){var m=v.font,E=g.Unicode[m.postScriptName];E&&(m.metadata.Unicode={},m.metadata.Unicode.widths=E.widths,m.metadata.Unicode.kerning=E.kerning);var A=f.Unicode[m.postScriptName];A&&(m.metadata.Unicode.encoding=A,m.encoding=A.codePages[0])}])}(lt.API),function(t){var e=function(n){for(var r=n.length,i=new Uint8Array(r),s=0;s<r;s++)i[s]=n.charCodeAt(s);return i};t.API.events.push(["addFont",function(n){var r=void 0,i=n.font,s=n.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(lm(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,r)}}])}(lt),lt.API.addSvgAsImage=function(t,e,n,r,i,s,o,l){if(isNaN(e)||isNaN(n))throw yn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(i))throw yn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=r,c.height=i;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},g=this;return(St.canvg?Promise.resolve(St.canvg):n0(()=>import("./index.es-BovebeUw.js"),[])).catch(function(v){return Promise.reject(new Error("Could not load canvg: "+v))}).then(function(v){return v.default?v.default:v}).then(function(v){return v.fromString(u,t,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(v){return v.render(f)}).then(function(){g.addImage(c.toDataURL("image/jpeg",1),e,n,r,i,o,l)})},lt.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(e,n);return this},lt.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var r,i,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,f=0,g=0;function v(E,A){var C,b=!1;for(C=0;C<E.length;C+=1)E[C]===A&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var m=l.length;for(g=0;g<m;g+=1)n[l[g]].value=n[l[g]].defaultValue,n[l[g]].explicitSet=!1}if(hn(t)==="object"){for(i in t)if(s=t[i],v(l,i)&&s!==void 0){if(n[i].type==="boolean"&&typeof s=="boolean")n[i].value=s;else if(n[i].type==="name"&&v(n[i].valueSet,s))n[i].value=s;else if(n[i].type==="integer"&&Number.isInteger(s))n[i].value=s;else if(n[i].type==="array"){for(u=0;u<s.length;u+=1)if(r=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(f=0;f<s[u].length;f+=1)typeof s[u][f]!="number"&&(r=!1);r===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}n[i].value="["+c.join(" ")+"]"}else n[i].value=n[i].defaultValue;n[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var E,A=[];for(E in n)n[E].explicitSet===!0&&(n[E].type==="name"?A.push("/"+E+" /"+n[E].value):A.push("/"+E+" "+n[E].value));A.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+A.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(t){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(r)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+o.length+l.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(i+s+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(r,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",e)),this}}(lt.API),function(t){var e=t.API,n=e.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],f=[""],g=0,v=s.length;g<v;++g){if(l=o.metadata.characterToGlyph(s.charCodeAt(g)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(g),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return f.join("");l=l.toString(16),f.push(u[4-l.length],l)}return f.join("")},r=function(s){var o,l,c,u,f,g,v;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],g=0,v=(l=Object.keys(s).sort(function(m,E){return m-E})).length;g<v;g++)o=l[g],c.length>=100&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,f=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var g=l.metadata.Unicode.widths,v=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),m="",E=0;E<v.length;E++)m+=String.fromCharCode(v[E]);var A=u();f({data:m,addLength1:!0,objectId:A}),c("endobj");var C=u();f({data:r(l.metadata.toUnicode),addLength1:!0,objectId:C}),c("endobj");var b=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Vc(l.fontName)),c("/FontFile2 "+A+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var I=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Vc(l.fontName)),c("/FontDescriptor "+b+" 0 R"),c("/W "+t.API.PDFObject.convert(g)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+C+" 0 R"),c("/BaseFont /"+Vc(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+I+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,f=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var g=l.metadata.rawData,v="",m=0;m<g.length;m++)v+=String.fromCharCode(g[m]);var E=u();f({data:v,addLength1:!0,objectId:E}),c("endobj");var A=u();f({data:r(l.metadata.toUnicode),addLength1:!0,objectId:A}),c("endobj");var C=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+E+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Vc(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var b=0;b<l.metadata.hmtx.widths.length;b++)l.metadata.hmtx.widths[b]=parseInt(l.metadata.hmtx.widths[b]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+A+" 0 R/BaseFont/"+Vc(l.fontName)+"/FontDescriptor "+C+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var i=function(s){var o,l=s.text||"",c=s.x,u=s.y,f=s.options||{},g=s.mutex||{},v=g.pdfEscape,m=g.activeFontKey,E=g.fonts,A=m,C="",b=0,I="",O=E[A].encoding;if(E[A].encoding!=="Identity-H")return{text:l,x:c,y:u,options:f,mutex:g};for(I=l,A=m,Array.isArray(l)&&(I=l[0]),b=0;b<I.length;b+=1)E[A].metadata.hasOwnProperty("cmap")&&(o=E[A].metadata.cmap.unicode.codeMap[I[b].charCodeAt(0)]),o||I[b].charCodeAt(0)<256&&E[A].metadata.hasOwnProperty("Unicode")?C+=I[b]:C+="";var V="";return parseInt(A.slice(1))<14||O==="WinAnsiEncoding"?V=v(C,A).split("").map(function(ne){return ne.charCodeAt(0).toString(16)}).join(""):O==="Identity-H"&&(V=n(C,E[A])),g.isHex=!0,{text:V,x:c,y:u,options:f,mutex:g}};e.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([i(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(i(Object.assign({},c,{text:o[u]})).text);s.text=l}else s.text=i(Object.assign({},c,{text:o})).text}])}(lt),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0},t.addFileToVFS=function(n,r){return e.call(this),this.internal.vFS[n]=r,this},t.getFileFromVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(lt.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(r){var i,s,o,l,c,u,f,g=e,v=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],E={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},A={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},C=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),I=!1,O=0;this.__bidiEngine__={};var V=function(S){var P=S.charCodeAt(),R=P>>8,$=A[R];return $!==void 0?g[256*$+(255&P)]:R===252||R===253?"AL":b.test(R)?"L":R===8?"R":"N"},ne=function(S){for(var P,R=0;R<S.length;R++){if((P=V(S.charAt(R)))==="L")return!1;if(P==="R")return!0}return!1},le=function(S,P,R,$){var H,Y,M,U,ee=P[$];switch(ee){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":I=!1;break;case"N":case"AN":break;case"EN":I&&(ee="AN");break;case"AL":I=!0,ee="R";break;case"WS":case"BN":ee="N";break;case"CS":$<1||$+1>=P.length||(H=R[$-1])!=="EN"&&H!=="AN"||(Y=P[$+1])!=="EN"&&Y!=="AN"?ee="N":I&&(Y="AN"),ee=Y===H?Y:"N";break;case"ES":ee=(H=$>0?R[$-1]:"B")==="EN"&&$+1<P.length&&P[$+1]==="EN"?"EN":"N";break;case"ET":if($>0&&R[$-1]==="EN"){ee="EN";break}if(I){ee="N";break}for(M=$+1,U=P.length;M<U&&P[M]==="ET";)M++;ee=M<U&&P[M]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(U=P.length,M=$+1;M<U&&P[M]==="NSM";)M++;if(M<U){var fe=S[$],Q=fe>=1425&&fe<=2303||fe===64286;if(H=P[M],Q&&(H==="R"||H==="AL")){ee="R";break}}}ee=$<1||(H=P[$-1])==="B"?"N":R[$-1];break;case"B":I=!1,i=!0,ee=O;break;case"S":s=!0,ee="N"}return ee},z=function(S,P,R){var $=S.split("");return R&&T($,R,{hiLevel:O}),$.reverse(),P&&P.reverse(),$.join("")},T=function(S,P,R){var $,H,Y,M,U,ee=-1,fe=S.length,Q=0,w=[],F=O?m:v,D=[];for(I=!1,i=!1,s=!1,H=0;H<fe;H++)D[H]=V(S[H]);for(Y=0;Y<fe;Y++){if(U=Q,w[Y]=le(S,D,w,Y),$=240&(Q=F[U][E[w[Y]]]),Q&=15,P[Y]=M=F[Q][5],$>0)if($===16){for(H=ee;H<Y;H++)P[H]=1;ee=-1}else ee=-1;if(F[Q][6])ee===-1&&(ee=Y);else if(ee>-1){for(H=ee;H<Y;H++)P[H]=M;ee=-1}D[Y]==="B"&&(P[Y]=0),R.hiLevel|=M}s&&function(K,te,oe){for(var he=0;he<oe;he++)if(K[he]==="S"){te[he]=O;for(var pe=he-1;pe>=0&&K[pe]==="WS";pe--)te[pe]=O}}(D,P,fe)},k=function(S,P,R,$,H){if(!(H.hiLevel<S)){if(S===1&&O===1&&!i)return P.reverse(),void(R&&R.reverse());for(var Y,M,U,ee,fe=P.length,Q=0;Q<fe;){if($[Q]>=S){for(U=Q+1;U<fe&&$[U]>=S;)U++;for(ee=Q,M=U-1;ee<M;ee++,M--)Y=P[ee],P[ee]=P[M],P[M]=Y,R&&(Y=R[ee],R[ee]=R[M],R[M]=Y);Q=U}Q++}}},N=function(S,P,R){var $=S.split(""),H={hiLevel:O};return R||(R=[]),T($,R,H),function(Y,M,U){if(U.hiLevel!==0&&f)for(var ee,fe=0;fe<Y.length;fe++)M[fe]===1&&(ee=C.indexOf(Y[fe]))>=0&&(Y[fe]=C[ee+1])}($,R,H),k(2,$,P,R,H),k(1,$,P,R,H),$.join("")};return this.__bidiEngine__.doBidiReorder=function(S,P,R){if(function(H,Y){if(Y)for(var M=0;M<H.length;M++)Y[M]=M;l===void 0&&(l=ne(H)),u===void 0&&(u=ne(H))}(S,P),o||!c||u)if(o&&c&&l^u)O=l?1:0,S=z(S,P,R);else if(!o&&c&&u)O=l?1:0,S=N(S,P,R),S=z(S,P);else if(!o||l||c||u){if(o&&!c&&l^u)S=z(S,P),l?(O=0,S=N(S,P,R)):(O=1,S=N(S,P,R),S=z(S,P));else if(o&&l&&!c&&u)O=1,S=N(S,P,R),S=z(S,P);else if(!o&&!c&&l^u){var $=f;l?(O=1,S=N(S,P,R),O=0,f=!1,S=N(S,P,R),f=$):(O=0,S=N(S,P,R),S=z(S,P),O=1,f=!1,S=N(S,P,R),f=$,S=z(S,P))}}else O=0,S=N(S,P,R);else O=l?1:0,S=N(S,P,R);return S},this.__bidiEngine__.setOptions=function(S){S&&(o=S.isInputVisual,c=S.isOutputVisual,l=S.isInputRtl,u=S.isOutputRtl,f=S.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(r){var i=r.text;r.x,r.y;var s=r.options||{};r.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,n.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(o=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?o.push([n.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):o.push([n.doBidiReorder(i[l])]);r.text=o}else r.text=n.doBidiReorder(i);n.setOptions({isInputVisual:!0})}])}(lt),lt.API.TTFFont=function(){function t(e){var n;if(this.rawData=e,n=this.contents=new vl(e),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new rM(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new qD(this.contents),this.head=new HD(this),this.name=new QD(this),this.cmap=new XS(this),this.toUnicode={},this.hhea=new WD(this),this.maxp=new XD(this),this.hmtx=new JD(this),this.post=new KD(this),this.os2=new GD(this),this.loca=new nM(this),this.glyf=new ZD(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,n,r,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),32768&(n=i>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var n;return((n=this.cmap.unicode)!=null?n.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*n},t.prototype.widthOfString=function(e,n,r){var i,s,o,l;for(o=0,s=0,l=(e=""+e).length;0<=l?s<l:s>l;s=0<=l?++s:--s)i=e.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/n)||0;return o*(n/1e3)},t.prototype.lineHeight=function(e,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},t}();var Bs,vl=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var n,r;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},t.prototype.writeString=function(e){var n,r,i;for(i=[],n=0,r=e.length;0<=r?n<r:n>r;n=0<=r?++n:--n)i.push(this.writeByte(e.charCodeAt(n)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,n,r,i,s,o,l,c;return e=this.readByte(),n=this.readByte(),r=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*n+1099511627776*r+4294967296*i+16777216*s+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var n,r;return n=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var n,r;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n.push(this.readByte());return n},t.prototype.write=function(e){var n,r,i,s;for(s=[],r=0,i=e.length;r<i;r++)n=e[r],s.push(this.writeByte(n));return s},t}(),qD=function(){var t;function e(n){var r,i,s;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(n){var r,i,s,o,l,c,u,f,g,v,m,E,A;for(A in m=Object.keys(n).length,c=Math.log(2),g=16*Math.floor(Math.log(m)/c),o=Math.floor(g/c),f=16*m-g,(i=new vl).writeInt(this.scalarType),i.writeShort(m),i.writeShort(g),i.writeShort(o),i.writeShort(f),s=16*m,u=i.pos+s,l=null,E=[],n)for(v=n[A],i.writeString(A),i.writeInt(t(v)),i.writeInt(u),i.writeInt(v.length),E=E.concat(v),A==="head"&&(l=u),u+=v.length;u%4;)E.push(0),u++;return i.write(E),r=2981146554-t(i.data),i.pos=l+8,i.writeUInt32(r),i.data},t=function(n){var r,i,s,o;for(n=JS.call(n);n.length%4;)n.push(0);for(s=new vl(n),i=0,r=0,o=n.length;r<o;r=r+=4)i+=s.readUInt32();return 4294967295&i},e}(),$D={}.hasOwnProperty,Sa=function(t,e){for(var n in e)$D.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Bs=function(){function t(e){var n;this.file=e,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var HD=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sa(t,Bs),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new vl).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t}(),Sw=function(){function t(e,n){var r,i,s,o,l,c,u,f,g,v,m,E,A,C,b,I,O;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=n+e.readInt(),g=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(m=e.readUInt16(),v=m/2,e.pos+=6,s=function(){var V,ne;for(ne=[],c=V=0;0<=v?V<v:V>v;c=0<=v?++V:--V)ne.push(e.readUInt16());return ne}(),e.pos+=2,A=function(){var V,ne;for(ne=[],c=V=0;0<=v?V<v:V>v;c=0<=v?++V:--V)ne.push(e.readUInt16());return ne}(),u=function(){var V,ne;for(ne=[],c=V=0;0<=v?V<v:V>v;c=0<=v?++V:--V)ne.push(e.readUInt16());return ne}(),f=function(){var V,ne;for(ne=[],c=V=0;0<=v?V<v:V>v;c=0<=v?++V:--V)ne.push(e.readUInt16());return ne}(),i=(this.length-e.pos+this.offset)/2,l=function(){var V,ne;for(ne=[],c=V=0;0<=i?V<i:V>i;c=0<=i?++V:--V)ne.push(e.readUInt16());return ne}(),c=b=0,O=s.length;b<O;c=++b)for(C=s[c],r=I=E=A[c];E<=C?I<=C:I>=C;r=E<=C?++I:--I)f[c]===0?o=r+u[c]:(o=l[f[c]/2+(r-E)-(v-c)]||0)!==0&&(o+=u[c]),this.codeMap[r]=65535&o}e.pos=g}return t.encode=function(e,n){var r,i,s,o,l,c,u,f,g,v,m,E,A,C,b,I,O,V,ne,le,z,T,k,N,S,P,R,$,H,Y,M,U,ee,fe,Q,w,F,D,K,te,oe,he,pe,ve,Ee,Ve;switch($=new vl,o=Object.keys(e).sort(function(ze,Ne){return ze-Ne}),n){case"macroman":for(A=0,C=function(){var ze=[];for(E=0;E<256;++E)ze.push(0);return ze}(),I={0:0},s={},H=0,ee=o.length;H<ee;H++)I[pe=e[i=o[H]]]==null&&(I[pe]=++A),s[i]={old:e[i],new:I[e[i]]},C[i]=I[e[i]];return $.writeUInt16(1),$.writeUInt16(0),$.writeUInt32(12),$.writeUInt16(0),$.writeUInt16(262),$.writeUInt16(0),$.write(C),{charMap:s,subtable:$.data,maxGlyphID:A+1};case"unicode":for(P=[],g=[],O=0,I={},r={},b=u=null,Y=0,fe=o.length;Y<fe;Y++)I[ne=e[i=o[Y]]]==null&&(I[ne]=++O),r[i]={old:ne,new:I[ne]},l=I[ne]-i,b!=null&&l===u||(b&&g.push(b),P.push(i),u=l),b=i;for(b&&g.push(b),g.push(65535),P.push(65535),N=2*(k=P.length),T=2*Math.pow(Math.log(k)/Math.LN2,2),v=Math.log(T/2)/Math.LN2,z=2*k-T,c=[],le=[],m=[],E=M=0,Q=P.length;M<Q;E=++M){if(S=P[E],f=g[E],S===65535){c.push(0),le.push(0);break}if(S-(R=r[S].new)>=32768)for(c.push(0),le.push(2*(m.length+k-E)),i=U=S;S<=f?U<=f:U>=f;i=S<=f?++U:--U)m.push(r[i].new);else c.push(R-S),le.push(0)}for($.writeUInt16(3),$.writeUInt16(1),$.writeUInt32(12),$.writeUInt16(4),$.writeUInt16(16+8*k+2*m.length),$.writeUInt16(0),$.writeUInt16(N),$.writeUInt16(T),$.writeUInt16(v),$.writeUInt16(z),oe=0,w=g.length;oe<w;oe++)i=g[oe],$.writeUInt16(i);for($.writeUInt16(0),he=0,F=P.length;he<F;he++)i=P[he],$.writeUInt16(i);for(ve=0,D=c.length;ve<D;ve++)l=c[ve],$.writeUInt16(l);for(Ee=0,K=le.length;Ee<K;Ee++)V=le[Ee],$.writeUInt16(V);for(Ve=0,te=m.length;Ve<te;Ve++)A=m[Ve],$.writeUInt16(A);return{charMap:r,subtable:$.data,maxGlyphID:O+1}}},t}(),XS=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sa(t,Bs),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,r,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=i?r<i:r>i;r=0<=i?++r:--r)n=new Sw(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var r,i;return n==null&&(n="macroman"),r=Sw.encode(e,n),(i=new vl).writeUInt16(0),i.writeUInt16(1),r.table=i.data.concat(r.subtable),r},t}(),WD=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sa(t,Bs),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),GD=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sa(t,Bs),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var n,r;for(r=[],n=0;n<10;++n)r.push(e.readByte());return r}(),this.charRange=function(){var n,r;for(r=[],n=0;n<4;++n)r.push(e.readInt());return r}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var n,r;for(r=[],n=0;n<2;n=++n)r.push(e.readInt());return r}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),KD=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sa(t,Bs),t.prototype.tag="post",t.prototype.parse=function(e){var n,r,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(r=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)n=e.readByte(),i.push(this.names.push(e.readString(n)));return i;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t}(),YD=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},QD=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sa(t,Bs),t.prototype.tag="name",t.prototype.parse=function(e){var n,r,i,s,o,l,c,u,f,g,v;for(e.pos=this.offset,e.readShort(),n=e.readShort(),l=e.readShort(),r=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},s=f=0,g=r.length;f<g;s=++f)i=r[s],e.pos=i.offset,u=e.readString(i.length),o=new YD(u,i),c[v=i.nameID]==null&&(c[v]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),XD=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sa(t,Bs),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),JD=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sa(t,Bs),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,r,i,s,o,l,c;for(e.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,f;for(f=[],n=u=0;0<=i?u<i:u>i;n=0<=i?++u:--u)f.push(e.readInt16());return f}(),this.widths=(function(){var u,f,g,v;for(v=[],u=0,f=(g=this.metrics).length;u<f;u++)s=g[u],v.push(s.advance);return v}).call(this),r=this.widths[this.widths.length-1],c=[],n=o=0;0<=i?o<i:o>i;n=0<=i?++o:--o)c.push(this.widths.push(r));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),JS=[].slice,ZD=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sa(t,Bs),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,r,i,s,o,l,c,u,f,g;return e in this.cache?this.cache[e]:(s=this.file.loca,n=this.file.contents,r=s.indexOf(e),(i=s.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+r,o=(l=new vl(n.read(i))).readShort(),u=l.readShort(),g=l.readShort(),c=l.readShort(),f=l.readShort(),this.cache[e]=o===-1?new tM(l,u,g,c,f):new eM(l,o,u,g,c,f),this.cache[e]))},t.prototype.encode=function(e,n,r){var i,s,o,l,c;for(o=[],s=[],l=0,c=n.length;l<c;l++)i=e[n[l]],s.push(o.length),i&&(o=o.concat(i.encode(r)));return s.push(o.length),{table:o,offsets:s}},t}(),eM=function(){function t(e,n,r,i,s,o){this.raw=e,this.numberOfContours=n,this.xMin=r,this.yMin=i,this.xMax=s,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),tM=function(){function t(e,n,r,i,s){var o,l;for(this.raw=e,this.xMin=n,this.yMin=r,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,n,r;for(n=new vl(JS.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)n.pos=this.glyphOffsets[e];return n.data},t}(),nM=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sa(t,Bs),t.prototype.tag="loca",t.prototype.parse=function(e){var n,r;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,s;for(s=[],r=0,i=this.length;r<i;r+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],r=0,i=this.length;r<i;r+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var r=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<r.length;++o)if(r[o]=i,s<n.length&&n[s]==o){++s,r[o]=i;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(i+=c)}for(var u=new Array(4*r.length),f=0;f<r.length;++f)u[4*f+3]=255&r[f],u[4*f+2]=(65280&r[f])>>8,u[4*f+1]=(16711680&r[f])>>16,u[4*f]=(4278190080&r[f])>>24;return u},t}(),rM=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,n,r,i,s;for(n in i=this.font.cmap.tables[0].codeMap,e={},s=this.subset)r=s[n],e[n]=i[r];return e},t.prototype.glyphsFor=function(e){var n,r,i,s,o,l,c;for(i={},o=0,l=e.length;o<l;o++)i[s=e[o]]=this.font.glyf.glyphFor(s);for(s in n=[],i)(r=i[s])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(s in c=this.glyphsFor(n))r=c[s],i[s]=r;return i},t.prototype.encode=function(e,n){var r,i,s,o,l,c,u,f,g,v,m,E,A,C,b;for(i in r=XS.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),m={0:0},b=r.charMap)m[(c=b[i]).old]=c.new;for(E in v=r.maxGlyphID,o)E in m||(m[E]=v++);return f=function(I){var O,V;for(O in V={},I)V[I[O]]=O;return V}(m),g=Object.keys(f).sort(function(I,O){return I-O}),A=function(){var I,O,V;for(V=[],I=0,O=g.length;I<O;I++)l=g[I],V.push(f[l]);return V}(),s=this.font.glyf.encode(o,A,m),u=this.font.loca.encode(s.offsets,A),C={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(C["OS/2"]=this.font.os2.raw()),this.font.directory.encode(C)},t}();lt.API.PDFObject=function(){var t;function e(){}return t=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},e.convert=function(n){var r,i,s,o;if(Array.isArray(n))return"["+function(){var l,c,u;for(u=[],l=0,c=n.length;l<c;l++)r=n[l],u.push(e.convert(r));return u}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(i in s=["<<"],n)o=n[i],s.push("/"+i+" "+e.convert(o));return s.push(">>"),s.join(`
`)}return""+n},e}();function iM({isDemo:t,userRole:e}){const{addNotification:n}=xn(),[r,i]=ue.useState([]),[s,o]=ue.useState([]),[l,c]=ue.useState(""),[u,f]=ue.useState("Todos"),[g,v]=ue.useState("Todos"),[m,E]=ue.useState(!0),[A,C]=ue.useState("history"),[b,I]=ue.useState(null),[O,V]=ue.useState(!1),ne=["Todos","Pendiente","Procesando","Completado","Fallido","Cancelado","Reembolsado"],le=["Todos","Bold","PayPal","PayU","Transferencia Bancaria","Manual"];ue.useEffect(()=>{if(t){i([{id:"demo1",serviceNumber:"SRV-241017-123456",clientName:"Juan Prez",clientEmail:"juan@ejemplo.com",amount:10.99,currency:"USD",status:"Completado",gateway:"Bold",transactionId:"bold_txn_123456",createdAt:{seconds:Date.now()/1e3-86400},completedAt:{seconds:Date.now()/1e3-3600}},{id:"demo2",serviceNumber:"SRV-241017-789012",clientName:"Mara Garca",clientEmail:"maria@ejemplo.com",amount:25,currency:"USD",status:"Pendiente",gateway:"PayPal",transactionId:"paypal_txn_789012",createdAt:{seconds:Date.now()/1e3-7200}},{id:"demo3",serviceNumber:"SRV-241017-345678",clientName:"Carlos Lpez",clientEmail:"carlos@ejemplo.com",amount:50,currency:"USD",status:"Completado",gateway:"Transferencia Bancaria",transactionId:"TRF-123456789",createdAt:{seconds:Date.now()/1e3-10800},completedAt:{seconds:Date.now()/1e3-9e3}}]),o([{id:"client1",fullName:"Juan Prez",email:"juan@ejemplo.com"},{id:"client2",fullName:"Mara Garca",email:"maria@ejemplo.com"}]),E(!1);return}const M=zt(Ue,"artifacts",Me,"public","data","payments"),U=Zt(M,Q=>{console.log("Admin payments snapshot:",Q.size,"documents");const w=Q.docs.map(F=>{const D=F.data();return console.log("Payment doc:",F.id,D),{id:F.id,...D}});w.sort((F,D)=>{var oe,he;const K=((oe=F.createdAt)==null?void 0:oe.seconds)||0;return(((he=D.createdAt)==null?void 0:he.seconds)||0)-K}),console.log("Admin payments loaded:",w.length,w),i(w),E(!1)},Q=>{console.error("Error loading payments:",Q),n("Error al cargar los pagos","error"),E(!1)}),ee=lr(zt(Ue,"artifacts",Me,"public","data","users"),ni("role","==","client")),fe=Zt(ee,Q=>{const w=Q.docs.map(F=>({id:F.id,...F.data()}));o(w)});return()=>{U(),fe()}},[t,n]);const z=r.filter(M=>{var Q,w,F,D;const U=((Q=M.serviceNumber)==null?void 0:Q.toLowerCase().includes(l.toLowerCase()))||((w=M.clientName)==null?void 0:w.toLowerCase().includes(l.toLowerCase()))||((F=M.clientEmail)==null?void 0:F.toLowerCase().includes(l.toLowerCase()))||((D=M.transactionId)==null?void 0:D.toLowerCase().includes(l.toLowerCase())),ee=u==="Todos"||M.status===u,fe=g==="Todos"||M.gateway===g;return U&&ee&&fe}),T=async(M,U=null)=>{try{if(U!=null&&U.exchangeRate)return Number(U.exchangeRate);const ee=M instanceof Date?M:new Date(M),fe=ee.toISOString().split("T")[0];try{if(Math.floor((new Date-ee)/(1e3*60*60*24))<=7){const F=await fetch("https://api.exchangerate.host/latest?base=USD&symbols=COP");if(F.ok){const D=await F.json();if(D.success&&D.rates&&D.rates.COP)return Number(D.rates.COP)}}else{const F=await fetch(`https://api.exchangerate.host/${fe}?base=USD&symbols=COP`);if(F.ok){const D=await F.json();if(D.success&&D.rates&&D.rates.COP)return Number(D.rates.COP)}}}catch(Q){console.warn("Error obteniendo tasa de cambio de API:",Q)}return console.warn("Usando tasa de cambio predeterminada (4000 COP/USD). Para tasas histricas precisas, configure una API key."),4e3}catch(ee){return console.error("Error en getExchangeRate:",ee),4e3}},k=async M=>{var U;try{if(!M||!M.id){console.error("Payment invlido para generar invoice:",M);return}const fe="INV-"+String(M.id||"").slice(-8).toUpperCase(),Q=(U=M.createdAt)!=null&&U.seconds?new Date(M.createdAt.seconds*1e3):new Date,w=Q.toLocaleDateString("es-ES"),F=M.dueDate?new Date(M.dueDate.seconds*1e3).toLocaleDateString("es-ES"):"N/A",D=String(M.clientName||"Cliente"),K=String(M.clientEmail||"N/A"),te=String(M.serviceNumber||"N/A"),oe=String(M.serviceType||"Servicio"),he=String(M.description||"Descripcin del servicio"),pe=Number(M.amount||0),ve=String(M.currency||"USD"),Ee=String(M.gateway||"N/A"),Ve=String(M.transactionId||"N/A"),ze=String(M.paymentMethod||"N/A");let Ne=pe,ae=ve,ht=null,et=null,He=null;ve&&ve.toUpperCase()==="USD"?(et=await T(Q,M),He=Q.toLocaleDateString("es-ES"),ht=pe,Ne=pe*et,ae="COP"):(ve&&ve.toUpperCase()==="COP"||(console.warn("Pago sin moneda definida, asumiendo USD"),et=await T(Q,M),He=Q.toLocaleDateString("es-ES"),ht=pe,Ne=pe*et),ae="COP");const Re=Ne.toLocaleString("es-CO",{minimumFractionDigits:2,maximumFractionDigits:2}),Xe=ht?ht.toFixed(2):null,$e=et?et.toLocaleString("es-CO",{minimumFractionDigits:2,maximumFractionDigits:2}):null,Oe=new lt;let Pe=20;return Oe.setFontSize(24),Oe.setTextColor(37,99,235),Oe.text("Gestor de Cobros",105,Pe,{align:"center"}),Pe+=10,Oe.setFontSize(18),Oe.setTextColor(102,102,102),Oe.text("FACTURA",105,Pe,{align:"center"}),Pe+=20,Oe.setFontSize(12),Oe.setTextColor(0,0,0),Oe.setFont(void 0,"bold"),Oe.text("Cliente:",20,Pe),Oe.setFont(void 0,"normal"),Oe.text(D,60,Pe),Pe+=7,Oe.text(K,60,Pe),Pe+=15,Oe.setFont(void 0,"bold"),Oe.text("Detalles de la Factura:",20,Pe),Pe+=7,Oe.setFont(void 0,"normal"),Oe.text("Nmero: "+fe,20,Pe),Pe+=7,Oe.text("Fecha: "+w,20,Pe),Pe+=7,Oe.text("Vencimiento: "+F,20,Pe),Pe+=7,Oe.text("Estado: Completado",20,Pe),Pe+=15,Oe.setFont(void 0,"bold"),Oe.text("Detalles del Servicio:",20,Pe),Pe+=10,Oe.setFillColor(248,249,250),Oe.rect(20,Pe-5,170,8,"F"),Oe.setFont(void 0,"bold"),Oe.text("Servicio",25,Pe),Oe.text("Descripcin",70,Pe),Oe.text("Monto",165,Pe,{align:"right"}),Pe+=10,Oe.setFont(void 0,"normal"),Oe.text(oe,25,Pe),Oe.text(he.substring(0,35),70,Pe),Oe.text(ae+" "+Re,165,Pe,{align:"right"}),Pe+=10,ht&&et&&(Oe.setFontSize(8),Oe.setTextColor(102,102,102),Oe.text("Equivale a USD "+Xe+" (Tasa: "+$e+" COP/USD del "+He+")",165,Pe,{align:"right"}),Pe+=10),Pe+=5,Oe.setFontSize(16),Oe.setFont(void 0,"bold"),Oe.setTextColor(37,99,235),Oe.text("Total: "+ae+" "+Re,165,Pe,{align:"right"}),Pe+=20,Oe.setFontSize(10),Oe.setTextColor(102,102,102),Oe.setFont(void 0,"normal"),Oe.text("Mtodo de Pago: "+ze,20,Pe),Pe+=6,Oe.text("Gateway: "+Ee,20,Pe),Pe+=6,Ve!=="N/A"&&(Oe.text("ID de Transaccin: "+Ve,20,Pe),Pe+=6),Oe.text("Gracias por su negocio",105,Pe,{align:"center"}),Oe.save("invoice-"+fe+".pdf"),Oe}catch(ee){return console.error("Error generando PDF:",ee),n("Error al generar el PDF del invoice","error"),null}},N=async(M,U)=>{if(t){n("Funcin no disponible en modo demo","error");return}try{const ee=ct(Ue,"artifacts",Me,"public","data","payments",M),fe=await Ja(ee);if(!fe.exists()){n("No se encontr el pago","error");return}const Q={id:M,...fe.data()};if(await fr(ee,{status:U,updatedAt:dt.now(),...U==="Completado"?{completedAt:dt.now()}:{}}),U==="Completado"){const w=await Ja(ee),F={id:M,...w.data(),clientName:w.data().clientName||Q.clientName||"Cliente",clientEmail:w.data().clientEmail||Q.clientEmail||"N/A",serviceNumber:w.data().serviceNumber||Q.serviceNumber||"N/A",serviceType:w.data().serviceType||Q.serviceType||"Servicio",description:w.data().description||Q.description||"Descripcin del servicio",amount:w.data().amount||Q.amount||0,currency:w.data().currency||Q.currency||"USD",gateway:w.data().gateway||Q.gateway||"N/A",transactionId:w.data().transactionId||Q.transactionId||"N/A",paymentMethod:w.data().paymentMethod||Q.paymentMethod||"N/A",createdAt:w.data().createdAt||Q.createdAt,dueDate:w.data().dueDate||Q.dueDate};await k(F);try{const K=F.clientEmail||F.userEmail,te=F.clientName||"Cliente";if(K&&K!=="N/A"){const oe="INV-"+M.slice(-8).toUpperCase(),he=F.currency==="COP"?new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(F.amount):new Intl.NumberFormat("es-ES",{style:"currency",currency:"USD"}).format(F.amount),pe=`Pago Aprobado - ${F.serviceNumber||"N/A"}`,ve=`
              <div style="font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: 0 auto;">
                <h2 style="color: #059669;"> Pago Aprobado</h2>
                <p>Estimado/a <strong>${te}</strong>,</p>
                <p>Su pago por el servicio <strong>${F.serviceNumber||"N/A"}</strong> ha sido aprobado exitosamente.</p>
                <div style="background-color: #f3f4f6; padding: 15px; border-radius: 8px; margin: 20px 0;">
                  <h3 style="margin-top: 0;">Detalles del Pago:</h3>
                  <ul style="list-style: none; padding: 0;">
                    <li><strong>Servicio:</strong> ${F.serviceType||"N/A"}</li>
                    <li><strong>Monto:</strong> ${he}</li>
                    <li><strong>Mtodo:</strong> ${F.gateway||F.paymentMethod||"N/A"}</li>
                    <li><strong>Factura:</strong> ${oe}</li>
                    <li><strong>Fecha:</strong> ${new Date().toLocaleDateString("es-ES")}</li>
                  </ul>
                </div>
                <p>Su servicio est ahora activo. Puede descargar la factura desde su panel de pagos.</p>
                <p style="margin-top: 30px;">Gracias por su pago.</p>
                <p style="color: #6b7280; font-size: 12px; margin-top: 20px;">
                  Este es un email automtico, por favor no responda.
                </p>
              </div>
            `,Ee=`
Pago Aprobado

Estimado/a ${te},

Su pago por el servicio ${F.serviceNumber||"N/A"} ha sido aprobado exitosamente.

Detalles del Pago:
- Servicio: ${F.serviceType||"N/A"}
- Monto: ${he}
- Mtodo: ${F.gateway||F.paymentMethod||"N/A"}
- Factura: ${oe}
- Fecha: ${new Date().toLocaleDateString("es-ES")}

Su servicio est ahora activo. Puede descargar la factura desde su panel de pagos.

Gracias por su pago.
            `;await gl({to:K,toName:te,subject:pe,html:ve,text:Ee,type:"Aprobacin",recipientType:"Cliente",module:"payments",event:"approval",metadata:{paymentId:M,serviceId:F.serviceId,invoiceNumber:oe}})}}catch(K){console.error("Error enviando email de aprobacin:",K)}const D=F.serviceId;if(D)try{const K=ct(Ue,"artifacts",Me,"public","data","services",D),te=await Ja(K);if(te.exists()){const oe=te.data(),he={updatedAt:dt.now()};F.isRenewal||F.paymentType==="Renovacin"?(F.startDate&&(he.dueDate=F.startDate),F.endDate&&(he.expirationDate=F.endDate),he.status="Activo"):(oe.billingCycle==="One-Time"||F.paymentType==="Pago nico")&&(he.paidDate=dt.now(),he.status="Completado"),Object.keys(he).length>1&&await fr(K,he)}}catch(K){console.error("Error actualizando servicio despus de completar pago:",K)}n("Pago completado, servicio actualizado e invoice generado","success")}else if(U==="Fallido"||U==="Cancelado"){try{const w=Q.clientEmail||Q.userEmail,F=Q.clientName||"Cliente";if(w&&w!=="N/A"){const D=`Actualizacin de Pago - ${Q.serviceNumber||"N/A"}`,K=`
              <div style="font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: 0 auto;">
                <h2 style="color: #dc2626;"> ${U==="Fallido"?"Pago Fallido":"Pago Cancelado"}</h2>
                <p>Estimado/a <strong>${F}</strong>,</p>
                <p>Lamentamos informarle que su pago por el servicio <strong>${Q.serviceNumber||"N/A"}</strong> ha sido ${U==="Fallido"?"rechazado":"cancelado"}.</p>
                <div style="background-color: #fef2f2; padding: 15px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #dc2626;">
                  <p style="margin: 0;"><strong>Por favor, verifique:</strong></p>
                  <ul style="list-style: none; padding: 0; margin: 10px 0 0 0;">
                    <li> Los datos de su mtodo de pago</li>
                    <li> Que tenga fondos suficientes</li>
                    <li> Que su mtodo de pago est activo</li>
                  </ul>
                </div>
                <p>Si necesita ayuda, por favor contacte a nuestro equipo de soporte.</p>
                <p style="margin-top: 30px;">Gracias por su comprensin.</p>
                <p style="color: #6b7280; font-size: 12px; margin-top: 20px;">
                  Este es un email automtico, por favor no responda.
                </p>
              </div>
            `,te=`
${U==="Fallido"?"Pago Fallido":"Pago Cancelado"}

Estimado/a ${F},

Lamentamos informarle que su pago por el servicio ${Q.serviceNumber||"N/A"} ha sido ${U==="Fallido"?"rechazado":"cancelado"}.

Por favor, verifique:
- Los datos de su mtodo de pago
- Que tenga fondos suficientes
- Que su mtodo de pago est activo

Si necesita ayuda, por favor contacte a nuestro equipo de soporte.

Gracias por su comprensin.
            `;await gl({to:w,toName:F,subject:D,html:K,text:te,type:"Rechazo",recipientType:"Cliente",module:"payments",event:"rejection",metadata:{paymentId:M,serviceId:Q.serviceId,status:U}})}}catch(w){console.error("Error enviando email de rechazo:",w)}n(`Estado del pago actualizado a ${U}`,"success")}else n(`Estado del pago actualizado a ${U}`,"success")}catch(ee){console.error("Error updating payment status:",ee),n("Error al actualizar el estado del pago","error")}},S=async M=>{try{await k(M),n("Invoice PDF descargado exitosamente","success")}catch(U){console.error("Error descargando invoice:",U),n("Error al generar el invoice PDF","error")}},P=async M=>{if(t){n("Funcin no disponible en modo demo","error");return}if(window.confirm("Ests seguro de que quieres eliminar este pago? Esta accin no se puede deshacer."))try{await fc(ct(Ue,"artifacts",Me,"public","data","payments",M)),n("Pago eliminado exitosamente","success")}catch(U){console.error("Error deleting payment:",U),n("Error al eliminar el pago","error")}},R=M=>({Pendiente:"bg-yellow-100 text-yellow-800",Procesando:"bg-blue-100 text-blue-800",Completado:"bg-green-100 text-green-800",Fallido:"bg-red-100 text-red-800",Cancelado:"bg-gray-100 text-gray-800",Reembolsado:"bg-purple-100 text-purple-800"})[M]||"bg-gray-100 text-gray-800",$=M=>({Bold:"bg-blue-100 text-blue-800",PayPal:"bg-yellow-100 text-yellow-800",PayU:"bg-green-100 text-green-800","Transferencia Bancaria":"bg-purple-100 text-purple-800",Manual:"bg-gray-100 text-gray-800"})[M]||"bg-gray-100 text-gray-800",H=M=>M?new Date(M.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",Y=(M,U)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:U||"USD"}).format(M);return m?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsx("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(Xi,{}),"Gestin de Pagos"]})}),a.jsx("div",{className:"border-b border-gray-200 mb-6",children:a.jsxs("nav",{className:"-mb-px flex space-x-8",children:[a.jsxs("button",{onClick:()=>C("history"),className:`${A==="history"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(Xi,{}),"Historial de Pagos"]}),a.jsxs("button",{onClick:()=>C("renewal"),className:`${A==="renewal"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(ll,{}),"Renovaciones"]}),e==="superadmin"&&a.jsxs("button",{onClick:()=>C("config"),className:`${A==="config"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(Zp,{}),"Configuracin"]})]})}),A==="renewal"?a.jsxs("div",{className:"p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Configuracin de Renovaciones"}),a.jsx(f8,{isDemo:t})]}):A==="config"?a.jsx(oS,{isDemo:t}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:a.jsxs("div",{className:"text-sm text-gray-500",children:[z.length," pago",z.length!==1?"s":""," encontrado",z.length!==1?"s":""]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar por servicio, cliente, email o transaccin...",value:l,onChange:M=>c(M.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Fu,{})})]}),a.jsx("select",{value:u,onChange:M=>f(M.target.value),className:"w-full p-2 border rounded-md",children:ne.map(M=>a.jsx("option",{value:M,children:M},M))}),a.jsx("select",{value:g,onChange:M=>v(M.target.value),className:"w-full p-2 border rounded-md",children:le.map(M=>a.jsx("option",{value:M,children:M},M))}),a.jsxs("button",{className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:[a.jsx(uu,{}),"Filtros"]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Servicio","Cliente","Monto","Estado","Pasarela","Transaccin","Fecha","Acciones"].map(M=>a.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:M},M))})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:z.map(M=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:M.serviceNumber||M.id}),a.jsx("div",{className:"text-sm text-gray-600",children:M.serviceName||M.serviceType||"N/A"}),M.serviceDescription&&a.jsx("div",{className:"text-xs text-gray-500 truncate max-w-xs",children:M.serviceDescription}),M.isRenewal&&a.jsxs("div",{className:"text-xs text-green-600 font-medium",children:["Renovacin: ",M.renewalPeriod||"N/A"]})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-medium text-gray-900",children:M.clientName}),a.jsx("div",{className:"text-sm text-gray-500",children:M.clientEmail})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"font-semibold text-gray-900",children:Y(M.amount,M.currency)})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${R(M.status)}`,children:M.status})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${$(M.gateway)}`,children:M.gateway})}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-mono text-sm text-gray-600",children:M.transactionId||"N/A"}),M.proofUrl&&a.jsx("div",{className:"mt-2",children:a.jsx("button",{onClick:()=>{I(M),V(!0)},className:"px-2 py-1 text-xs bg-purple-100 text-purple-700 rounded hover:bg-purple-200",children:"Ver Comprobante"})})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsxs("div",{className:"text-sm text-gray-900 flex items-center gap-2",children:[H(M.createdAt),M.proofUrl&&a.jsx("span",{className:"ml-2 inline-flex px-2 py-0.5 text-xs rounded-full bg-purple-100 text-purple-700",title:"Comprobante adjunto",children:"Comprobante"})]}),M.completedAt&&a.jsxs("div",{className:"text-xs text-gray-500",children:["Completado: ",H(M.completedAt)]}),M.startDate&&M.endDate&&a.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[a.jsxs("div",{children:["Inicio: ",H(M.startDate)]}),a.jsxs("div",{children:["Fin: ",H(M.endDate)]})]})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[M.proofUrl&&a.jsx("button",{onClick:()=>{I(M),V(!0)},className:"p-2 text-purple-600 hover:bg-purple-50 rounded-md",title:"Ver comprobante de pago",children:a.jsx(pl,{})}),e==="superadmin"&&a.jsx(a.Fragment,{children:a.jsxs(Uh,{children:[a.jsx("select",{value:M.status,onChange:U=>N(M.id,U.target.value),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 border-none bg-transparent",children:ne.filter(U=>U!=="Todos").map(U=>a.jsx("option",{value:U,children:U},U))}),a.jsxs("button",{onClick:()=>S(M),className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50 flex items-center",children:[a.jsx(pl,{className:"h-4 w-4 mr-2"}),"Descargar Invoice"]}),a.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:"Ver Detalles"}),a.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-yellow-700 hover:bg-yellow-50",children:"Reembolsar"}),a.jsxs("button",{onClick:()=>P(M.id),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50 flex items-center",children:[a.jsx(rS,{className:"h-4 w-4 mr-2"}),"Eliminar Pago"]})]})})]})})]},M.id))})]})}),z.length===0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(Xi,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron pagos"}),a.jsx("p",{className:"text-gray-500",children:"No hay pagos que coincidan con los filtros seleccionados."})]})]}),O&&(b==null?void 0:b.proofUrl)&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-4 flex justify-between items-center border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Comprobante de Pago"}),a.jsx("button",{onClick:()=>{V(!1),I(null)},className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsx("div",{className:"p-4",children:a.jsx("img",{src:b.proofUrl,alt:"Comprobante",className:"max-w-full h-auto rounded"})})]})})]})}function sM({isDemo:t}){const{addNotification:e}=xn(),[n,r]=ue.useState({provider:"smtp",smtpHost:"",smtpPort:587,smtpSecure:!1,smtpUser:"",smtpPassword:"",zohoClientId:"",zohoClientSecret:"",zohoRefreshToken:"",zohoAccessToken:"",zohoAccessTokenExpiry:null,fromEmail:"",fromName:"",enabled:!1}),[i,s]=ue.useState(!1),[o,l]=ue.useState("");ue.useEffect(()=>{if(t){r({provider:"smtp",smtpHost:"smtp.gmail.com",smtpPort:587,smtpSecure:!1,smtpUser:"demo@example.com",smtpPassword:"****",zohoClientId:"",zohoClientSecret:"",zohoRefreshToken:"",fromEmail:"noreply@empresa.com",fromName:"Gestor de Cobros",enabled:!1});return}const g=ct(Ue,"artifacts",Me,"public","data","settings","email_config"),v=Zt(g,m=>{if(m.exists()){const E=m.data();r({...E,smtpUser:E.smtpUser?E.smtpUser.trim():"",smtpHost:E.smtpHost?E.smtpHost.trim():"",fromEmail:E.fromEmail?E.fromEmail.trim():""})}},m=>{console.error("Error loading email config:",m),m.code==="permission-denied"&&e("Error de permisos al cargar configuracin de email. Verifica las reglas de Firestore.","error")});return()=>v()},[t]);const c=g=>{const{name:v,value:m,type:E,checked:A}=g.target;let C=m;E==="text"&&(v==="smtpUser"||v==="smtpHost"||v==="fromEmail")&&(C=m.trim()),r(b=>({...b,[v]:E==="checkbox"?A:E==="number"?parseInt(m)||0:C}))},u=async()=>{if(t){e("Funcin no disponible en modo demo","error");return}try{const g=ct(Ue,"artifacts",Me,"public","data","settings","email_config");await ki(g,{...n,updatedAt:new Date},{merge:!0}),e("Configuracin de email guardada exitosamente","success")}catch(g){console.error("Error saving email config:",g),e("Error al guardar la configuracin","error")}},f=async()=>{if(!o||!o.includes("@")){e("Ingresa un email vlido para probar","error");return}s(!0);try{const g=ct(Ue,"artifacts",Me,"public","data","settings","email_config");await ki(g,n,{merge:!0}),await new Promise(m=>setTimeout(m,500));const v=await h8(o);if(v.success)if(v.sent)e(` Email de prueba enviado exitosamente a ${o}. Revisa tu bandeja de entrada (y spam).`,"success");else if(v.simulated){const m=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";e(m?" Modo desarrollo: El email se registr pero no se envi (servidor PHP no disponible localmente). Despliega en produccin para envo real.":" Email de prueba registrado en historial. Verifica la configuracin SMTP si no se envi.","warning")}else e(" Email de prueba procesado. Revisa el historial de mensajes para ver el estado.","info");else{const m=v.error||"Error desconocido",E=v.details||"";let A="";m.includes("send-email.php")||m.includes("404")||m.includes("no se encontr")?A=" Verifica que send-email.php est en el servidor y que PHPMailer est instalado. Consulta VERIFICAR-PHP.md":m.includes("PHPMailer")||m.includes("Class")?A=" PHPMailer no est instalado. Ejecuta: composer require phpmailer/phpmailer":m.includes("Could not authenticate")||m.includes("authentication")?A=E||" Verifica: 1) Usuario SMTP debe ser el email completo (ej: noreply@dominio.com), 2) Contrasea correcta, 3) Puerto y conexin segura (587 con TLS o 465 con SSL), 4) Servidor SMTP correcto":(m.includes("SMTP")||m.includes("connect"))&&(A=E||" Verifica la configuracin SMTP (servidor, puerto, usuario, contrasea)");const C=E?` Error al enviar email: ${m}

${E}`:` Error al enviar email: ${m}${A}`;e(C,"error")}}catch(g){console.error("Error testing email:",g),e("Error al enviar email de prueba: "+g.message,"error")}finally{s(!1)}};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Configuracin de Email"}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Proveedor de Email"}),a.jsxs("select",{name:"provider",value:n.provider||"smtp",onChange:c,className:"w-full p-2 border rounded-md",children:[a.jsx("option",{value:"smtp",children:"SMTP (Servidor de Correo)"}),a.jsx("option",{value:"zoho",children:"Zoho Mail API"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n.provider==="zoho"?"Zoho Mail API: Envo directo va API REST, mejor deliverability, sin necesidad de servidor SMTP.":"SMTP: Mtodo tradicional, requiere servidor SMTP configurado (cPanel, Gmail, etc.)."})]}),n.provider==="zoho"?a.jsxs("div",{className:"space-y-4 border-t pt-4",children:[a.jsx("h4",{className:"font-semibold text-gray-800",children:"Configuracin Zoho Mail API"}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[a.jsx("p",{className:"text-sm font-medium text-blue-800 mb-2",children:" Pasos para Configurar Zoho Mail API:"}),a.jsxs("ol",{className:"text-sm text-blue-700 space-y-1 list-decimal list-inside",children:[a.jsxs("li",{children:["Registra tu aplicacin en ",a.jsx("a",{href:"https://api-console.zoho.com",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Zoho API Console"})]}),a.jsx("li",{children:"Obtn tu Client ID y Client Secret"}),a.jsx("li",{children:"Genera un Refresh Token (una vez, no expira)"}),a.jsx("li",{children:"Configura los permisos de Zoho Mail API"}),a.jsx("li",{children:"Ingresa las credenciales a continuacin"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client ID (Zoho)"}),a.jsx("input",{type:"text",name:"zohoClientId",value:n.zohoClientId,onChange:c,placeholder:"1000.XXXXXXXXXX",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Obtn esto desde Zoho API Console"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Secret (Zoho)"}),a.jsx("input",{type:"password",name:"zohoClientSecret",value:n.zohoClientSecret,onChange:c,placeholder:"",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Secreto de tu aplicacin Zoho"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Refresh Token (Zoho)"}),a.jsx("input",{type:"password",name:"zohoRefreshToken",value:n.zohoRefreshToken,onChange:c,placeholder:"1000.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Genera este token una vez desde Zoho API Console. No expira hasta que lo revoques."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Remitente (Zoho)"}),a.jsx("input",{type:"email",name:"fromEmail",value:n.fromEmail,onChange:c,placeholder:"noreply@tudominio.com",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Debe ser un email configurado en tu cuenta Zoho Mail"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Remitente"}),a.jsx("input",{type:"text",name:"fromName",value:n.fromName,onChange:c,placeholder:"Gestor de Cobros",className:"w-full p-2 border rounded-md"})]})]})]}):a.jsxs("div",{className:"space-y-4 border-t pt-4",children:[a.jsx("h4",{className:"font-semibold text-gray-800",children:"Configuracin SMTP"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Servidor SMTP"}),a.jsx("input",{type:"text",name:"smtpHost",value:n.smtpHost,onChange:c,placeholder:"smtp.gmail.com",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ejemplo: smtp.gmail.com, smtp.outlook.com"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Puerto SMTP"}),a.jsx("input",{type:"number",name:"smtpPort",value:n.smtpPort,onChange:c,placeholder:"587",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Puerto comn: 587 (TLS) o 465 (SSL)"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Usuario SMTP"}),a.jsx("input",{type:"text",name:"smtpUser",value:n.smtpUser,onChange:c,placeholder:"tu-email@dominio.com",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrasea SMTP"}),a.jsx("input",{type:"password",name:"smtpPassword",value:n.smtpPassword,onChange:c,placeholder:"",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Para Gmail: usa una "Contrasea de aplicacin"'})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Remitente"}),a.jsx("input",{type:"email",name:"fromEmail",value:n.fromEmail,onChange:c,placeholder:"noreply@tuempresa.com",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Remitente"}),a.jsx("input",{type:"text",name:"fromName",value:n.fromName,onChange:c,placeholder:"Gestor de Cobros",className:"w-full p-2 border rounded-md"})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"smtpSecure",name:"smtpSecure",checked:n.smtpSecure,onChange:c,className:"w-4 h-4 text-blue-600 border-gray-300 rounded"}),a.jsx("label",{htmlFor:"smtpSecure",className:"text-sm font-medium text-gray-700",children:"Usar conexin segura (SSL/TLS)"})]}),a.jsxs("div",{className:"flex items-center space-x-2 pt-4 border-t",children:[a.jsx("input",{type:"checkbox",id:"enabled",name:"enabled",checked:n.enabled,onChange:c,className:"w-4 h-4 text-blue-600 border-gray-300 rounded"}),a.jsx("label",{htmlFor:"enabled",className:"text-sm font-medium text-gray-700",children:"Habilitar servicio de email"})]}),a.jsx("div",{className:"flex justify-end space-x-4 pt-4",children:a.jsx("button",{onClick:u,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Guardar Configuracin"})})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Probar Configuracin"}),window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:[a.jsx("p",{className:"text-sm font-medium text-yellow-800 mb-2",children:" Modo Desarrollo Local:"}),a.jsxs("p",{className:"text-sm text-yellow-700",children:["Ests en desarrollo local. El servidor PHP no est disponible, por lo que los emails se registrarn en el historial pero ",a.jsx("strong",{children:"NO se enviarn realmente"}),". Para probar el envo real, despliega la aplicacin en produccin (Dockge o cPanel)."]})]}):a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:[a.jsx("p",{className:"text-sm font-medium text-green-800 mb-2",children:" Emails Reales Activados:"}),a.jsx("p",{className:"text-sm text-green-700",children:"Los emails se estn enviando realmente usando el servidor SMTP configurado. El email de prueba se enviar a la direccin que especifiques."})]}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"El email de prueba se registrar en el historial (modo desarrollo). En produccin se enviar realmente.":"El email de prueba se enviar realmente usando tu configuracin SMTP. Verifica tu bandeja de entrada."}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("input",{type:"email",value:o,onChange:g=>l(g.target.value),placeholder:"email@ejemplo.com",className:"flex-1 p-2 border rounded-md"}),a.jsx("button",{onClick:f,disabled:i||!n.enabled,className:`px-6 py-2 rounded-md ${i||!n.enabled?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:i?"Enviando...":"Enviar Email de Prueba"})]}),!n.enabled&&a.jsx("p",{className:"text-sm text-yellow-600 mt-2",children:" Debes habilitar el servicio de email primero para poder enviar pruebas."})]})]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.provider==="zoho"?a.jsxs(a.Fragment,{children:[a.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Configuracin de Zoho Mail API"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:" Ventajas de Zoho Mail API"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc list-inside mb-2",children:[a.jsx("li",{children:"No requiere servidor SMTP configurado"}),a.jsx("li",{children:"Mejor deliverability (Zoho maneja la reputacin)"}),a.jsx("li",{children:"Tracking y analytics de emails"}),a.jsx("li",{children:"Sin lmites de conexiones SMTP"}),a.jsx("li",{children:"Respuestas de error ms detalladas"})]})]}),a.jsxs("div",{className:"border-t border-blue-300 pt-3 mt-3",children:[a.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:" Enlaces tiles:"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[a.jsxs("li",{children:[a.jsx("a",{href:"https://api-console.zoho.com",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Zoho API Console"})," - Registra tu aplicacin"]}),a.jsx("li",{children:a.jsx("a",{href:"https://www.zoho.com/mail/help/api/",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Documentacin Zoho Mail API"})}),a.jsx("li",{children:a.jsx("a",{href:"https://www.zoho.com/mail/help/dev-platform/connectors.html",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Gua de OAuth 2.0"})})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Configuracin de SMTP"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:" Usar cPanel (Recomendado si tienes hosting con cPanel)"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc list-inside mb-2",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Servidor SMTP:"})," ",a.jsx("code",{children:"mail.tu-dominio.com"})," o ",a.jsx("code",{children:"smtp.tu-dominio.com"})]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Puerto:"})," ",a.jsx("code",{children:"587"})," (TLS) o ",a.jsx("code",{children:"465"}),' (SSL) - Marca "Usar conexin segura"']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Usuario:"})," Email completo (ej: ",a.jsx("code",{children:"noreply@tu-dominio.com"}),")"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Contrasea:"})," La contrasea del email creado en cPanel"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Email Remitente:"})," El mismo email (ej: ",a.jsx("code",{children:"noreply@tu-dominio.com"}),")"]})]}),a.jsxs("p",{className:"text-xs text-blue-600 mt-2",children:[" ",a.jsx("strong",{children:"Ventaja:"})," No necesitas servicios externos, emails ilimitados desde tu propio dominio."]})]}),a.jsxs("div",{className:"border-t border-blue-300 pt-3 mt-3",children:[a.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:"Otros Servicios:"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc list-inside",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Gmail:"}),' smtp.gmail.com:587, usa "Contrasea de aplicacin"']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Outlook:"})," smtp-mail.outlook.com:587"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Yahoo:"})," smtp.mail.yahoo.com:587"]})]})]})]})})]})}function aM({isDemo:t}){const{addNotification:e}=xn(),n={admin:{payments:{approval:!0,rejection:!0,newPayment:!0},services:{expirationReminder:!0,newService:!0},users:{newUser:!0,userActivation:!0},tickets:{newTicket:!0,ticketUpdate:!0},renewals:{renewalRequest:!0}},client:{payments:{approval:!0,rejection:!0,pendingPayment:!0},services:{expirationReminder:!0,serviceActivated:!0,serviceExpired:!0},tickets:{ticketReply:!0,ticketResolved:!0},renewals:{renewalReminder:!0,renewalConfirmed:!0}}},[r,i]=ue.useState(n),[s,o]=ue.useState(!0);ue.useEffect(()=>{if(t){o(!1);return}const f=ct(Ue,"artifacts",Me,"public","data","settings","notification_settings"),g=Zt(f,v=>{if(v.exists()){const m=v.data();i({admin:{...n.admin,...m.admin},client:{...n.client,...m.client}})}o(!1)});return()=>g()},[t]);const l=(f,g,v)=>{i(m=>{var E;return{...m,[f]:{...m[f],[g]:{...m[f][g],[v]:!((E=m[f][g])!=null&&E[v])}}}})},c=async()=>{if(t){e("Funcin no disponible en modo demo","error");return}try{const f=ct(Ue,"artifacts",Me,"public","data","settings","notification_settings");await ki(f,{...r,updatedAt:new Date},{merge:!0}),e("Configuracin de notificaciones guardada exitosamente","success")}catch(f){console.error("Error saving notification settings:",f),e("Error al guardar la configuracin","error")}},u={payments:{label:"Pagos",icon:"",admin:[{key:"approval",label:"Aprobacin de pago"},{key:"rejection",label:"Rechazo de pago"},{key:"newPayment",label:"Nuevo pago recibido"}],client:[{key:"approval",label:"Pago aprobado"},{key:"rejection",label:"Pago rechazado"},{key:"pendingPayment",label:"Recordatorio de pago pendiente"}]},services:{label:"Servicios",icon:"",admin:[{key:"expirationReminder",label:"Recordatorio de vencimiento"},{key:"newService",label:"Nuevo servicio creado"}],client:[{key:"expirationReminder",label:"Recordatorio de vencimiento"},{key:"serviceActivated",label:"Servicio activado"},{key:"serviceExpired",label:"Servicio vencido"}]},users:{label:"Usuarios",icon:"",admin:[{key:"newUser",label:"Nuevo usuario registrado"},{key:"userActivation",label:"Activacin de usuario"}],client:[]},tickets:{label:"Tickets",icon:"",admin:[{key:"newTicket",label:"Nuevo ticket creado"},{key:"ticketUpdate",label:"Actualizacin de ticket"}],client:[{key:"ticketReply",label:"Respuesta a ticket"},{key:"ticketResolved",label:"Ticket resuelto"}]},renewals:{label:"Renovaciones",icon:"",admin:[{key:"renewalRequest",label:"Solicitud de renovacin"}],client:[{key:"renewalReminder",label:"Recordatorio de renovacin"},{key:"renewalConfirmed",label:"Renovacin confirmada"}]}};return s?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Configuracin de Notificaciones"}),a.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Activa o desactiva las notificaciones por email segn el mdulo y el tipo de usuario."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold mb-4 bg-purple-100 text-purple-800 px-4 py-2 rounded-lg",children:" Notificaciones para Administradores"}),a.jsx("div",{className:"space-y-6",children:Object.entries(u).map(([f,g])=>!g.admin||g.admin.length===0?null:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[a.jsxs("h5",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx("span",{className:"text-2xl",children:g.icon}),g.label]}),a.jsx("div",{className:"space-y-3",children:g.admin.map(({key:v,label:m})=>{var E;return a.jsxs("div",{className:"flex items-center justify-between py-2 border-b",children:[a.jsx("span",{className:"text-sm text-gray-700",children:m}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:((E=r.admin[f])==null?void 0:E[v])??!1,onChange:()=>l("admin",f,v),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},v)})})]},f))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold mb-4 bg-blue-100 text-blue-800 px-4 py-2 rounded-lg",children:" Notificaciones para Clientes"}),a.jsx("div",{className:"space-y-6",children:Object.entries(u).map(([f,g])=>!g.client||g.client.length===0?null:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[a.jsxs("h5",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx("span",{className:"text-2xl",children:g.icon}),g.label]}),a.jsx("div",{className:"space-y-3",children:g.client.map(({key:v,label:m})=>{var E;return a.jsxs("div",{className:"flex items-center justify-between py-2 border-b",children:[a.jsx("span",{className:"text-sm text-gray-700",children:m}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:((E=r.client[f])==null?void 0:E[v])??!1,onChange:()=>l("client",f,v),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},v)})})]},f))})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx("button",{onClick:c,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium",children:"Guardar Configuracin"})})]})}function oM({isDemo:t,userRole:e}){const[n,r]=ue.useState("history"),{addNotification:i}=xn(),[s,o]=ue.useState([]),[l,c]=ue.useState(""),[u,f]=ue.useState("Todos"),[g,v]=ue.useState("Todos"),[m,E]=ue.useState("Todos"),[A,C]=ue.useState(!0),[b,I]=ue.useState(null),[O,V]=ue.useState(!1),[ne,le]=ue.useState(null),z=["Todos","Enviado","Entregado","Simulado","Ledo","Fallido","Cancelado","Pendiente"],T=["Todos","Aprobacin","Rechazo","Recordatorio","Notificacin","Activacin","Sistema"],k=["Todos","Cliente","Administrador","Sistema"];ue.useEffect(()=>{if(t){o([{id:"msg1",type:"Aprobacin",recipientType:"Cliente",recipientName:"Juan Prez",recipientEmail:"juan@ejemplo.com",subject:"Pago Aprobado - SRV-241017-123456",message:`Estimado/a Juan Prez,

Su pago por el servicio SRV-241017-123456 ha sido aprobado exitosamente.

Detalles del pago:
- Servicio: Hosting Bsico
- Monto: $50,000 COP
- Fecha: 17/10/2024
- Mtodo: Bold

Su servicio est ahora activo. Gracias por su pago.

Saludos cordiales,
Equipo de Soporte`,status:"Entregado",sentAt:{seconds:Date.now()/1e3-3600},deliveredAt:{seconds:Date.now()/1e3-3e3},readAt:{seconds:Date.now()/1e3-1800},templateId:"approval_1",paymentId:"pay1",serviceId:"srv1",sentBy:"admin@empresa.com",channel:"email"},{id:"msg2",type:"Recordatorio",recipientType:"Cliente",recipientName:"Mara Garca",recipientEmail:"maria@ejemplo.com",subject:"Recordatorio de Vencimiento - SRV-241017-789012",message:`Hola Mara Garca,

Te recordamos que tu servicio SRV-241017-789012 vence en 3 das.

Para evitar interrupciones, por favor realiza el pago correspondiente.

Gracias por tu atencin.

Equipo de Soporte`,status:"Enviado",sentAt:{seconds:Date.now()/1e3-7200},deliveredAt:null,readAt:null,templateId:"reminder_1",serviceId:"srv2",sentBy:"sistema@empresa.com",channel:"email"},{id:"msg3",type:"Rechazo",recipientType:"Cliente",recipientName:"Carlos Lpez",recipientEmail:"carlos@ejemplo.com",subject:"Pago Rechazado - SRV-241017-345678",message:`Estimado/a Carlos Lpez,

Lamentamos informarle que su pago por el servicio SRV-241017-345678 no pudo ser procesado.

Por favor, verifique los datos de su mtodo de pago e intente nuevamente.

Si necesita ayuda, contacte a nuestro equipo de soporte.

Saludos cordiales,
Equipo de Soporte`,status:"Fallido",sentAt:{seconds:Date.now()/1e3-10800},deliveredAt:null,readAt:null,templateId:"rejection_1",paymentId:"pay3",serviceId:"srv3",sentBy:"admin@empresa.com",channel:"email",errorMessage:"Error de conexin con el servidor de email"},{id:"msg4",type:"Notificacin",recipientType:"Administrador",recipientName:"Admin Principal",recipientEmail:"admin@empresa.com",subject:"Nuevo Pago Recibido",message:`Se ha recibido un nuevo pago:

- Cliente: Ana Martnez
- Servicio: SRV-241017-456789
- Monto: $75,000 COP
- Mtodo: Transferencia Bancaria

Por favor, verifica y aprueba el pago si es necesario.`,status:"Ledo",sentAt:{seconds:Date.now()/1e3-14400},deliveredAt:{seconds:Date.now()/1e3-14300},readAt:{seconds:Date.now()/1e3-14200},templateId:"admin_payment_notification",paymentId:"pay4",serviceId:"srv4",sentBy:"sistema@empresa.com",channel:"email"}]),C(!1);return}const Q=lr(zt(Ue,"artifacts",Me,"public","data","messages"),Fh("sentAt","desc")),w=Zt(Q,F=>{const D=F.docs.map(K=>({id:K.id,...K.data()}));o(D),C(!1)},F=>{console.error("Error loading messages:",F),i("Error al cargar los mensajes.","error"),C(!1)});return()=>w()},[t,i]);const N=async(Q,w)=>{if(t){i("Funcin no disponible en modo demo","error");return}try{const F=ct(Ue,"artifacts",Me,"public","data","messages",Q);await fr(F,{status:w,updatedAt:new Date}),i(`Estado del mensaje actualizado a ${w}`,"success")}catch(F){console.error("Error updating message status:",F),i("Error al actualizar el estado del mensaje","error")}},S=Q=>{I(Q),V(!0)},P=async(Q,w)=>{if(w&&w.stopPropagation(),t){i("Funcin no disponible en modo demo","error");return}if(ne!==Q.id){le(Q.id);try{await mc();const F=Q.recipientEmail||Q.to,D=Q.recipientName||"",K=Q.subject||"Sin asunto",te=Q.message||Q.content||"",oe=te.includes("<")&&te.includes(">"),he=oe?te:te.replace(/\n/g,"<br>"),pe=oe?te.replace(/<[^>]*>/g,""):te;await gl({to:F,toName:D,subject:`[Reenvo] ${K}`,html:he,text:pe,type:Q.type||"Notificacin",recipientType:Q.recipientType||"Cliente",module:Q.module||"system",event:Q.event||"resend",metadata:{originalMessageId:Q.id,originalSentAt:Q.sentAt,resendAt:new Date().toISOString()}}),i(`Mensaje reenviado exitosamente a ${F}`,"success"),O&&(b==null?void 0:b.id)===Q.id&&V(!1)}catch(F){console.error("Error resending message:",F),i(`Error al reenviar mensaje: ${F.message}`,"error")}finally{le(null)}}},R=async(Q,w)=>{if(w&&w.stopPropagation(),t){i("Funcin no disponible en modo demo","error");return}const F=Q.recipientEmail||Q.to||"este mensaje",D=Q.subject||"Sin asunto";if(window.confirm(`Eliminar permanentemente el mensaje "${D}" enviado a ${F}?

Esta accin no se puede deshacer.`))try{const K=ct(Ue,"artifacts",Me,"public","data","messages",Q.id);await fc(K),i("Mensaje eliminado exitosamente","success"),O&&(b==null?void 0:b.id)===Q.id&&(V(!1),I(null))}catch(K){console.error("Error deleting message:",K),i(`Error al eliminar mensaje: ${K.message}`,"error")}},$=Q=>({Enviado:"bg-blue-100 text-blue-800",Entregado:"bg-green-100 text-green-800",Simulado:"bg-orange-100 text-orange-800",Ledo:"bg-purple-100 text-purple-800",Fallido:"bg-red-100 text-red-800",Cancelado:"bg-gray-100 text-gray-800",Pendiente:"bg-yellow-100 text-yellow-800"})[Q]||"bg-gray-100 text-gray-800",H=Q=>({Aprobacin:"bg-green-100 text-green-800",Rechazo:"bg-red-100 text-red-800",Recordatorio:"bg-yellow-100 text-yellow-800",Notificacin:"bg-blue-100 text-blue-800",Activacin:"bg-purple-100 text-purple-800",Sistema:"bg-gray-100 text-gray-800"})[Q]||"bg-gray-100 text-gray-800",Y=Q=>({Cliente:"bg-blue-100 text-blue-800",Administrador:"bg-purple-100 text-purple-800",Sistema:"bg-gray-100 text-gray-800"})[Q]||"bg-gray-100 text-gray-800",M=Q=>Q?new Date(Q.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",U=Q=>{switch(Q){case"Enviado":return a.jsx(ds,{});case"Entregado":return a.jsx(sS,{});case"Simulado":return a.jsx("span",{title:" No enviado realmente",children:""});case"Ledo":return a.jsx(pl,{});case"Fallido":return a.jsx(sp,{});case"Pendiente":return a.jsx(ds,{});default:return a.jsx(ds,{})}},ee=s.filter(Q=>{const w=l===""||Q.recipientName.toLowerCase().includes(l.toLowerCase())||Q.recipientEmail.toLowerCase().includes(l.toLowerCase())||Q.subject.toLowerCase().includes(l.toLowerCase())||Q.message.toLowerCase().includes(l.toLowerCase()),F=u==="Todos"||Q.status===u,D=g==="Todos"||Q.type===g,K=m==="Todos"||Q.recipientType===m;return w&&F&&D&&K});if(A)return a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const fe=()=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Historial de Mensajes"}),a.jsxs("div",{className:"text-sm text-gray-500",children:[ee.length," mensaje",ee.length!==1?"s":""," encontrado",ee.length!==1?"s":""]})]}),a.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6 rounded",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("span",{className:"text-blue-400 text-2xl",children:""})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Emails Reales Activados"}),a.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["Los emails se estn enviando realmente usando el servidor SMTP configurado. El historial muestra el estado de cada envo: ",a.jsx("span",{className:"font-semibold",children:'"Enviado"'}),", ",a.jsx("span",{className:"font-semibold",children:'"Fallido"'})," o ",a.jsx("span",{className:"font-semibold",children:'"Cancelado"'}),"."]})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar por destinatario, asunto o contenido...",value:l,onChange:Q=>c(Q.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Fu,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:u,onChange:Q=>f(Q.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:z.map(Q=>a.jsx("option",{value:Q,children:Q},Q))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(uu,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:g,onChange:Q=>v(Q.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:T.map(Q=>a.jsx("option",{value:Q,children:Q},Q))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(am,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:m,onChange:Q=>E(Q.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:k.map(Q=>a.jsx("option",{value:Q,children:Q},Q))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(uu,{})})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Tipo","Mdulo","Destinatario","Asunto","Estado","Enviado","Entregado","Ledo","Acciones"].map(Q=>a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:Q},Q))})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ee.map(Q=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${H(Q.type)}`,children:Q.type}),a.jsx("span",{className:`ml-2 px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${Y(Q.recipientType)}`,children:Q.recipientType})]})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900 capitalize",children:Q.module||"Sistema"}),Q.event&&a.jsx("div",{className:"text-xs text-gray-500 capitalize",children:Q.event.replace(/([A-Z])/g," $1").trim()}),Q.provider&&a.jsx("div",{className:"text-xs text-blue-600 font-medium mt-1",children:Q.provider==="zoho"?" Zoho Mail API":" SMTP"})]}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:Q.recipientName||"N/A"}),a.jsx("div",{className:"text-sm text-gray-500",children:Q.recipientEmail||Q.to||"N/A"})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",title:Q.subject,children:Q.subject})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${$(Q.status)}`,children:Q.status}),a.jsx("div",{className:"ml-2 text-gray-400",children:U(Q.status)}),Q.status==="Simulado"&&a.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-orange-200 text-orange-800 rounded-full",title:"Email histrico - antes de implementar envo real",children:" Histrico"})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:M(Q.sentAt)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Q.deliveredAt?M(Q.deliveredAt):"--"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Q.readAt?M(Q.readAt):"--"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("button",{onClick:()=>S(Q),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md",title:"Ver mensaje completo",children:a.jsx(pl,{})}),e==="superadmin"&&a.jsxs(Uh,{children:[a.jsx("select",{value:Q.status,onChange:w=>N(Q.id,w.target.value),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 border-none bg-transparent",children:z.filter(w=>w!=="Todos").map(w=>a.jsx("option",{value:w,children:w},w))}),a.jsx("button",{onClick:w=>P(Q,w),disabled:ne===Q.id,className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed",children:ne===Q.id?"Reenviando...":"Reenviar"}),a.jsx("button",{onClick:w=>R(Q,w),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"Eliminar"})]})]})})]},Q.id))})]})}),ee.length===0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(am,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron mensajes"}),a.jsx("p",{className:"text-gray-500",children:"No hay mensajes que coincidan con los filtros seleccionados."})]}),O&&b&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Detalles del Mensaje"}),a.jsx("button",{onClick:()=>V(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tipo"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${H(b.type)}`,children:b.type})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${$(b.status)}`,children:b.status})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Destinatario"}),a.jsx("div",{className:"text-sm text-gray-900",children:b.recipientName}),a.jsx("div",{className:"text-sm text-gray-500",children:b.recipientEmail})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Canal"}),a.jsx("div",{className:"text-sm text-gray-900",children:b.channel||"Email"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto"}),a.jsx("div",{className:"text-sm text-gray-900 p-3 bg-gray-50 rounded-md",children:b.subject})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contenido del Mensaje"}),a.jsx("div",{className:"text-sm text-gray-900 p-4 bg-gray-50 rounded-md whitespace-pre-wrap max-h-64 overflow-y-auto",children:b.message})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Enviado"}),a.jsx("div",{className:"text-gray-900",children:M(b.sentAt)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Entregado"}),a.jsx("div",{className:"text-gray-900",children:b.deliveredAt?M(b.deliveredAt):"No entregado"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ledo"}),a.jsx("div",{className:"text-gray-900",children:b.readAt?M(b.readAt):"No ledo"})]})]}),b.status==="Simulado"&&a.jsxs("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-md",children:[a.jsx("label",{className:"block text-sm font-medium text-orange-700 mb-1",children:" Email Simulado (Histrico)"}),a.jsx("div",{className:"text-sm text-orange-600",children:"Este email fue registrado antes de implementar el envo real. Los nuevos emails se envan realmente."})]}),b.status==="Enviado"&&a.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md",children:[a.jsx("label",{className:"block text-sm font-medium text-green-700 mb-1",children:" Email Enviado"}),a.jsx("div",{className:"text-sm text-green-600",children:"Este email fue enviado exitosamente usando el servidor SMTP configurado."})]}),b.errorMessage&&!b.simulated&&a.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:[a.jsx("label",{className:"block text-sm font-medium text-red-700 mb-1",children:"Error"}),a.jsx("div",{className:"text-sm text-red-600",children:b.errorMessage})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{onClick:()=>V(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cerrar"}),e==="superadmin"&&a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:Q=>{Q.stopPropagation(),P(b,Q)},disabled:ne===b.id,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:ne===b.id?"Reenviando...":"Reenviar Mensaje"}),a.jsx("button",{onClick:Q=>{Q.stopPropagation(),R(b,Q)},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Eliminar Mensaje"})]})]})]})]})})]});return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2 mb-4",children:[a.jsx(am,{}),"Mensajera y Notificaciones"]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"flex space-x-8",children:[a.jsx("button",{onClick:()=>r("history"),className:`py-4 px-1 border-b-2 font-medium text-sm ${n==="history"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:" Historial de Mensajes"}),a.jsx("button",{onClick:()=>r("email"),className:`py-4 px-1 border-b-2 font-medium text-sm ${n==="email"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:" Configuracin de Email"}),a.jsx("button",{onClick:()=>r("notifications"),className:`py-4 px-1 border-b-2 font-medium text-sm ${n==="notifications"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:" Notificaciones por Mdulo"})]})})]}),n==="history"&&a.jsx(fe,{}),n==="email"&&a.jsx(sM,{isDemo:t}),n==="notifications"&&a.jsx(aM,{isDemo:t})]})}function ZS({ticketId:t,isDemo:e,userRole:n,currentUser:r}){const{addNotification:i}=xn(),[s,o]=ue.useState([]),[l,c]=ue.useState(""),[u,f]=ue.useState(!0),[g,v]=ue.useState(!1);ue.useEffect(()=>{if(e){o([{id:"msg1",ticketId:t,content:"Hola, tengo un problema con el acceso a mi panel de cliente. No puedo iniciar sesin desde ayer.",senderId:"client1",senderName:"Juan Prez",senderRole:"client",senderEmail:"juan@ejemplo.com",isInternal:!1,createdAt:{seconds:Date.now()/1e3-3600},attachments:[]},{id:"msg2",ticketId:t,content:"Hola Juan, gracias por contactarnos. He revisado tu cuenta y veo que hay un problema con la configuracin de tu perfil. Voy a solucionarlo ahora mismo.",senderId:"admin1",senderName:"Admin Principal",senderRole:"admin",senderEmail:"admin@empresa.com",isInternal:!1,createdAt:{seconds:Date.now()/1e3-1800},attachments:[]},{id:"msg3",ticketId:t,content:"Nota interna: El cliente tiene un problema de configuracin en su perfil. Necesito revisar la base de datos.",senderId:"admin1",senderName:"Admin Principal",senderRole:"admin",senderEmail:"admin@empresa.com",isInternal:!0,createdAt:{seconds:Date.now()/1e3-900},attachments:[]}]),f(!1);return}if(!t){f(!1);return}const A=lr(zt(Ue,"artifacts",Me,"public","data","ticketMessages"),ni("ticketId","==",t)),C=Zt(A,b=>{const I=b.docs.map(O=>({id:O.id,...O.data()}));I.sort((O,V)=>{var z,T;const ne=((z=O.createdAt)==null?void 0:z.seconds)||0,le=((T=V.createdAt)==null?void 0:T.seconds)||0;return ne-le}),o(I),f(!1)},b=>{console.error("Error loading messages:",b),i("Error al cargar los mensajes","error"),f(!1)});return()=>C()},[t,e,i]);const m=async A=>{if(A.preventDefault(),!!l.trim()){if(v(!0),e){const C={id:`msg_${Date.now()}`,ticketId:t,content:l,senderId:(r==null?void 0:r.uid)||"demo",senderName:(r==null?void 0:r.displayName)||"Usuario Demo",senderRole:n||"client",senderEmail:(r==null?void 0:r.email)||"demo@ejemplo.com",isInternal:!1,createdAt:{seconds:Date.now()/1e3},attachments:[]};o(b=>[...b,C]),c(""),v(!1),i("Mensaje enviado (modo demo)","success"),window.updateTicketReplyCount&&window.updateTicketReplyCount(t,s.length+1);return}try{const C={ticketId:t,content:l.trim(),senderId:r.uid,senderName:r.displayName||r.email,senderRole:n,senderEmail:r.email,isInternal:!1,createdAt:dt.now(),attachments:[]};await xa(zt(Ue,"artifacts",Me,"public","data","ticketMessages"),C);const b=ct(Ue,"artifacts",Me,"public","data","tickets",t);await fr(b,{replyCount:s.length+1,lastReplyAt:dt.now(),lastReplyBy:r.displayName||r.email,updatedAt:dt.now()}),c(""),i("Mensaje enviado","success")}catch(C){console.error("Error sending message:",C),i("Error al enviar el mensaje","error")}finally{v(!1)}}},E=A=>{if(!A)return"--";const C=new Date,b=new Date(A.seconds*1e3),I=C.getTime()-b.getTime(),O=Math.floor(I/(1e3*60*60*24)),V=Math.floor(I/(1e3*60*60)),ne=Math.floor(I/(1e3*60));return O>0?`hace ${O} da${O>1?"s":""}`:V>0?`hace ${V} hora${V>1?"s":""}`:ne>0?`hace ${ne} minuto${ne>1?"s":""}`:"hace unos segundos"};return u?a.jsx("div",{className:"flex justify-center items-center h-32",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:s.length===0?a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(ap,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),a.jsx("p",{children:"No hay mensajes en este ticket"})]}):s.map(A=>a.jsx("div",{className:`flex ${A.senderRole==="client"?"justify-start":"justify-end"}`,children:a.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${A.senderRole==="client"?"bg-gray-100 text-gray-900":A.isInternal?"bg-yellow-100 text-yellow-900 border border-yellow-300":"bg-blue-100 text-blue-900"}`,children:[A.isInternal&&a.jsx("div",{className:"text-xs font-semibold text-yellow-700 mb-1",children:"NOTA INTERNA"}),a.jsx("div",{className:"text-sm whitespace-pre-wrap",children:A.content}),a.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-gray-500",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(gh,{}),a.jsx("span",{children:A.senderName})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ds,{}),a.jsx("span",{children:E(A.createdAt)})]})]}),A.attachments&&A.attachments.length>0&&a.jsx("div",{className:"mt-2 pt-2 border-t border-gray-300",children:a.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[a.jsx(e8,{}),a.jsxs("span",{children:[A.attachments.length," archivo",A.attachments.length!==1?"s":""]})]})})]})},A.id))}),a.jsx("div",{className:"border-t pt-4",children:a.jsxs("form",{onSubmit:m,className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n==="client"?"Responder al ticket":"Responder al cliente"}),a.jsx("textarea",{value:l,onChange:A=>c(A.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:n==="client"?"Escribe tu respuesta aqu...":"Escribe tu respuesta al cliente aqu...",required:!0})]}),n==="admin"||n==="superadmin"?a.jsx("div",{className:"flex items-center gap-4",children:a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Nota interna (solo visible para administradores)"})]})}):null,a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{type:"submit",disabled:g||!l.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Enviando..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ap,{}),"Enviar Mensaje"]})})})]})})]})}function lM({isDemo:t,userRole:e}){const{addNotification:n}=xn(),[r,i]=ue.useState([]),[s,o]=ue.useState([]),[l,c]=ue.useState(""),[u,f]=ue.useState("Todos"),[g,v]=ue.useState("Todos"),[m,E]=ue.useState("Todos"),[A,C]=ue.useState(!0),[b,I]=ue.useState(null),[O,V]=ue.useState(!1),[ne,le]=ue.useState(!1),[z,T]=ue.useState({subject:"",department:"Soporte Tcnico",priority:"Media",description:"",clientId:"",clientName:"",clientEmail:""}),k=["Todos","Abierto","En Progreso","Respondido","Cerrado","Esperando Cliente"],N=["Todos","Baja","Media","Alta","Crtica"],S=["Todos","Soporte Tcnico","Facturacin","Ventas","General"];ue.useEffect(()=>{if(t){i([{id:"ticket1",ticketNumber:"TKT-2024-001",subject:"Problema con el acceso al panel de cliente",description:"No puedo acceder a mi panel de cliente desde ayer. Me aparece un error 500.",status:"Abierto",priority:"Alta",department:"Soporte Tcnico",clientId:"client1",clientName:"Juan Prez",clientEmail:"juan@ejemplo.com",assignedTo:null,assignedToName:null,createdAt:{seconds:Date.now()/1e3-3600},updatedAt:{seconds:Date.now()/1e3-3600},lastReplyAt:{seconds:Date.now()/1e3-3600},lastReplyBy:"Cliente",replyCount:0,attachments:[]},{id:"ticket2",ticketNumber:"TKT-2024-002",subject:"Consulta sobre facturacin",description:"Necesito una copia de mi factura del mes pasado para contabilidad.",status:"Respondido",priority:"Media",department:"Facturacin",clientId:"client2",clientName:"Mara Garca",clientEmail:"maria@ejemplo.com",assignedTo:"admin1",assignedToName:"Admin Principal",createdAt:{seconds:Date.now()/1e3-7200},updatedAt:{seconds:Date.now()/1e3-1800},lastReplyAt:{seconds:Date.now()/1e3-1800},lastReplyBy:"Admin Principal",replyCount:2,attachments:["factura_enero.pdf"]},{id:"ticket3",ticketNumber:"TKT-2024-003",subject:"Solicitud de nuevo servicio",description:"Me gustara contratar un plan de hosting ms grande para mi sitio web.",status:"En Progreso",priority:"Baja",department:"Ventas",clientId:"client3",clientName:"Carlos Lpez",clientEmail:"carlos@ejemplo.com",assignedTo:"admin2",assignedToName:"Admin Ventas",createdAt:{seconds:Date.now()/1e3-10800},updatedAt:{seconds:Date.now()/1e3-900},lastReplyAt:{seconds:Date.now()/1e3-900},lastReplyBy:"Admin Ventas",replyCount:1,attachments:[]},{id:"ticket4",ticketNumber:"TKT-2024-004",subject:"Error crtico en el servidor",description:"Mi sitio web est cado y no responde. Es urgente.",status:"Abierto",priority:"Crtica",department:"Soporte Tcnico",clientId:"client4",clientName:"Ana Martnez",clientEmail:"ana@ejemplo.com",assignedTo:null,assignedToName:null,createdAt:{seconds:Date.now()/1e3-300},updatedAt:{seconds:Date.now()/1e3-300},lastReplyAt:{seconds:Date.now()/1e3-300},lastReplyBy:"Cliente",replyCount:0,attachments:["error_screenshot.png"]}]),o([{id:"client1",fullName:"Juan Prez",email:"juan@ejemplo.com"},{id:"client2",fullName:"Mara Garca",email:"maria@ejemplo.com"},{id:"client3",fullName:"Carlos Lpez",email:"carlos@ejemplo.com"},{id:"client4",fullName:"Ana Martnez",email:"ana@ejemplo.com"}]),C(!1);return}const D=lr(zt(Ue,"artifacts",Me,"public","data","tickets")),K=Zt(D,he=>{const pe=he.docs.map(ve=>({id:ve.id,...ve.data()}));pe.sort((ve,Ee)=>{var Ne,ae;const Ve=((Ne=ve.createdAt)==null?void 0:Ne.seconds)||0;return(((ae=Ee.createdAt)==null?void 0:ae.seconds)||0)-Ve}),i(pe),C(!1)},he=>{console.error("Error loading tickets:",he),n("Error al cargar los tickets.","error"),C(!1)}),te=lr(zt(Ue,"artifacts",Me,"public","data","users"),ni("role","==","client")),oe=Zt(te,he=>{const pe=he.docs.map(ve=>({id:ve.id,...ve.data()}));o(pe)},he=>{console.error("Error loading clients:",he)});return()=>{K(),oe()}},[t,n]);const P=async(D,K)=>{if(t){n("Funcin no disponible en modo demo","error");return}try{const te=ct(Ue,"artifacts",Me,"public","data","tickets",D);await fr(te,{status:K,updatedAt:dt.now()}),n(`Estado del ticket actualizado a ${K}`,"success")}catch(te){console.error("Error updating ticket status:",te),n("Error al actualizar el estado del ticket","error")}},R=async(D,K)=>{if(t){n("Funcin no disponible en modo demo","error");return}try{const te=ct(Ue,"artifacts",Me,"public","data","tickets",D);await fr(te,{assignedTo:K,assignedToName:K?"Admin Actual":null,updatedAt:dt.now()}),n("Ticket asignado correctamente","success")}catch(te){console.error("Error assigning ticket:",te),n("Error al asignar el ticket","error")}},$=D=>{I(D),V(!0)},H=async D=>{if(t){i(K=>K.filter(te=>te.id!==D)),n("Ticket eliminado (modo demo)","success");return}try{await fc(ct(Ue,"artifacts",Me,"public","data","tickets",D));const K=lr(zt(Ue,"artifacts",Me,"public","data","ticketMessages"),ni("ticketId","==",D)),oe=(await ya(K)).docs.map(he=>fc(he.ref));await Promise.all(oe),n("Ticket eliminado exitosamente","success")}catch(K){console.error("Error deleting ticket:",K),n("Error al eliminar el ticket","error")}},Y=async D=>{if(D.preventDefault(),console.log(" [ADMIN] handleCreateTicket llamado - Iniciando creacin de ticket"),t){console.log(" [ADMIN] Modo demo activado - saltando envo de emails");const K={id:`ticket_${Date.now()}`,ticketNumber:`TKT-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,subject:z.subject,description:z.description,status:"Abierto",priority:z.priority,department:z.department,clientId:z.clientId||"demo",clientName:z.clientName||"Cliente Demo",clientEmail:z.clientEmail||"demo@ejemplo.com",assignedTo:null,assignedToName:null,createdAt:{seconds:Date.now()/1e3},updatedAt:{seconds:Date.now()/1e3},lastReplyAt:{seconds:Date.now()/1e3},lastReplyBy:"Cliente",replyCount:0,attachments:[]};i(te=>[K,...te]),n("Ticket creado (modo demo)","success"),le(!1),T({subject:"",department:"Soporte Tcnico",priority:"Media",description:"",clientId:"",clientName:"",clientEmail:""});return}try{console.log(" [ADMIN] Creando ticket en Firestore...");const K={...z,ticketNumber:`TKT-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,status:"Abierto",assignedTo:null,assignedToName:null,createdAt:dt.now(),updatedAt:dt.now(),lastReplyAt:dt.now(),lastReplyBy:"Cliente",replyCount:0,attachments:[]},oe=(await xa(zt(Ue,"artifacts",Me,"public","data","tickets"),K)).id;console.log(" [ADMIN] Ticket creado con ID:",oe);try{console.log(" [ADMIN] Iniciando envo de notificaciones por email para ticket:",oe),await mc(),console.log(" [ADMIN] Configuracin de email cargada");const he=K.clientName||"Cliente",pe=K.clientEmail,ve=K.ticketNumber,Ee=K.subject,Ve=K.description,ze=K.department,Ne=K.priority;if(pe){console.log(" [ADMIN] Enviando email al cliente:",pe);const et=`
            <h2>Ticket Creado Exitosamente</h2>
            <p>Estimado/a <strong>${he}</strong>,</p>
            <p>Hemos recibido tu ticket de soporte. Nuestro equipo lo revisar y te responder pronto.</p>
            <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
              <p><strong>Nmero de Ticket:</strong> ${ve}</p>
              <p><strong>Asunto:</strong> ${Ee}</p>
              <p><strong>Departamento:</strong> ${ze}</p>
              <p><strong>Prioridad:</strong> ${Ne}</p>
              <p><strong>Descripcin:</strong></p>
              <p style="white-space: pre-wrap;">${Ve}</p>
            </div>
            <p>Puedes hacer seguimiento a tu ticket desde tu panel de cliente.</p>
            <p>Saludos cordiales,<br>Equipo de Soporte</p>
          `,He=await gl({to:pe,toName:he,subject:`Ticket Creado - ${ve}`,html:et,text:`Ticket Creado Exitosamente

Estimado/a ${he},

Hemos recibido tu ticket de soporte. Nuestro equipo lo revisar y te responder pronto.

Nmero de Ticket: ${ve}
Asunto: ${Ee}
Departamento: ${ze}
Prioridad: ${Ne}

Descripcin:
${Ve}

Puedes hacer seguimiento a tu ticket desde tu panel de cliente.

Saludos cordiales,
Equipo de Soporte`,type:"Notificacin",recipientType:"Cliente",module:"tickets",event:"ticketReply",metadata:{ticketId:oe,ticketNumber:ve}});console.log(" [ADMIN] Resultado email cliente:",He)}else console.log(" [ADMIN] No se envi email al cliente - no hay email configurado");const ae=await mc(),ht=ae==null?void 0:ae.fromEmail;if(console.log(" [ADMIN] Email del administrador desde config:",ht),ht){console.log(" [ADMIN] Enviando email al administrador:",ht);const et=`
            <h2>Nuevo Ticket Creado</h2>
            <p>Se ha creado un nuevo ticket de soporte que requiere atencin.</p>
            <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
              <p><strong>Nmero de Ticket:</strong> ${ve}</p>
              <p><strong>Cliente:</strong> ${he}${pe?` (${pe})`:""}</p>
              <p><strong>Asunto:</strong> ${Ee}</p>
              <p><strong>Departamento:</strong> ${ze}</p>
              <p><strong>Prioridad:</strong> ${Ne}</p>
              <p><strong>Descripcin:</strong></p>
              <p style="white-space: pre-wrap;">${Ve}</p>
            </div>
            <p>Por favor, revisa y asigna el ticket desde el panel de administracin.</p>
          `,He=await gl({to:ht,toName:(ae==null?void 0:ae.fromName)||"Administrador",subject:`Nuevo Ticket - ${ve} - ${Ee}`,html:et,text:`Nuevo Ticket Creado

Se ha creado un nuevo ticket de soporte que requiere atencin.

Nmero de Ticket: ${ve}
Cliente: ${he}${pe?` (${pe})`:""}
Asunto: ${Ee}
Departamento: ${ze}
Prioridad: ${Ne}

Descripcin:
${Ve}

Por favor, revisa y asigna el ticket desde el panel de administracin.`,type:"Notificacin",recipientType:"Administrador",module:"tickets",event:"newTicket",metadata:{ticketId:oe,ticketNumber:ve,clientEmail:pe,clientName:he}});console.log(" [ADMIN] Resultado email administrador:",He),console.log(" [ADMIN] Notificaciones por email completadas")}else console.log(" [ADMIN] No se envi email al administrador - no hay email configurado en fromEmail")}catch(he){console.error(" [ADMIN] Error sending ticket notification emails:",he),console.error(" [ADMIN] Detalles del error:",he.message,he.stack)}n("Ticket creado exitosamente","success"),le(!1),T({subject:"",department:"Soporte Tcnico",priority:"Media",description:"",clientId:"",clientName:"",clientEmail:""})}catch(K){console.error("Error creating ticket:",K),n("Error al crear el ticket","error")}},M=D=>({Abierto:"bg-red-100 text-red-800","En Progreso":"bg-yellow-100 text-yellow-800",Respondido:"bg-blue-100 text-blue-800",Cerrado:"bg-gray-100 text-gray-800","Esperando Cliente":"bg-orange-100 text-orange-800"})[D]||"bg-gray-100 text-gray-800",U=D=>({Baja:"bg-green-100 text-green-800",Media:"bg-yellow-100 text-yellow-800",Alta:"bg-orange-100 text-orange-800",Crtica:"bg-red-100 text-red-800"})[D]||"bg-gray-100 text-gray-800",ee=D=>({"Soporte Tcnico":"bg-blue-100 text-blue-800",Facturacin:"bg-green-100 text-green-800",Ventas:"bg-purple-100 text-purple-800",General:"bg-gray-100 text-gray-800"})[D]||"bg-gray-100 text-gray-800",fe=D=>D?new Date(D.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",Q=D=>{switch(D){case"Abierto":return a.jsx(ds,{});case"En Progreso":return a.jsx(ds,{});case"Respondido":return a.jsx(sS,{});case"Cerrado":return a.jsx(sp,{});case"Esperando Cliente":return a.jsx(gh,{});default:return a.jsx(ds,{})}},w=D=>{if(!D)return"--";const K=new Date,te=new Date(D.seconds*1e3),oe=K.getTime()-te.getTime(),he=Math.floor(oe/(1e3*60*60*24)),pe=Math.floor(oe/(1e3*60*60)),ve=Math.floor(oe/(1e3*60));return he>0?`hace ${he} da${he>1?"s":""}`:pe>0?`hace ${pe} hora${pe>1?"s":""}`:ve>0?`hace ${ve} minuto${ve>1?"s":""}`:"hace unos segundos"},F=r.filter(D=>{const K=l===""||D.ticketNumber.toLowerCase().includes(l.toLowerCase())||D.subject.toLowerCase().includes(l.toLowerCase())||D.clientName.toLowerCase().includes(l.toLowerCase())||D.clientEmail.toLowerCase().includes(l.toLowerCase())||D.description.toLowerCase().includes(l.toLowerCase()),te=u==="Todos"||D.status===u,oe=g==="Todos"||D.priority===g,he=m==="Todos"||D.department===m;return K&&te&&oe&&he});return A?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(tc,{}),"Sistema de Tickets"]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"text-sm text-gray-500",children:[F.length," ticket",F.length!==1?"s":""," encontrado",F.length!==1?"s":""]}),a.jsxs("button",{onClick:()=>le(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[a.jsx(Vh,{}),"Nuevo Ticket"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:a.jsx(ds,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Abiertos"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(D=>D.status==="Abierto").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:a.jsx(ds,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"En Progreso"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(D=>D.status==="En Progreso").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:a.jsx(gh,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Esperando Cliente"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(D=>D.status==="Esperando Cliente").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:a.jsx(sp,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Crticos"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(D=>D.priority==="Crtica").length})]})]})})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar por nmero, asunto, cliente...",value:l,onChange:D=>c(D.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Fu,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:u,onChange:D=>f(D.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:k.map(D=>a.jsx("option",{value:D,children:D},D))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(uu,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:g,onChange:D=>v(D.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:N.map(D=>a.jsx("option",{value:D,children:D},D))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(uu,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:m,onChange:D=>E(D.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:S.map(D=>a.jsx("option",{value:D,children:D},D))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(uu,{})})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Ticket","Cliente","Asunto","Estado","Prioridad","Departamento","Asignado","ltima Actividad","Respuestas","Acciones"].map(D=>a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:D},D))})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:F.map(D=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:D.ticketNumber}),a.jsx("div",{className:"text-xs text-gray-500",children:fe(D.createdAt)})]}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:D.clientName}),a.jsx("div",{className:"text-sm text-gray-500",children:D.clientEmail})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",title:D.subject,children:D.subject}),a.jsx("div",{className:"text-xs text-gray-500 max-w-xs truncate",title:D.description,children:D.description})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${M(D.status)}`,children:D.status}),a.jsx("div",{className:"ml-2 text-gray-400",children:Q(D.status)})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${U(D.priority)}`,children:D.priority})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ee(D.department)}`,children:D.department})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:D.assignedToName||"Sin asignar"}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[a.jsx("div",{children:w(D.lastReplyAt)}),a.jsxs("div",{className:"text-xs text-gray-400",children:["por ",D.lastReplyBy]})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(ap,{}),a.jsx("span",{className:"ml-1",children:D.replyCount})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("button",{onClick:()=>$(D),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md",title:"Ver ticket completo",children:a.jsx(pl,{})}),e==="superadmin"&&a.jsxs(Uh,{children:[a.jsx("select",{value:D.status,onChange:K=>P(D.id,K.target.value),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 border-none bg-transparent",children:k.filter(K=>K!=="Todos").map(K=>a.jsx("option",{value:K,children:K},K))}),a.jsx("button",{onClick:()=>R(D.id,D.assignedTo?null:"admin"),className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:D.assignedTo?"Desasignar":"Asignar"}),a.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:"Responder"}),a.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-orange-700 hover:bg-orange-50",children:"Cerrar Ticket"}),a.jsx("button",{onClick:()=>{window.confirm("Ests seguro de que quieres eliminar este ticket? Esta accin no se puede deshacer.")&&H(D.id)},className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"Eliminar Ticket"})]})]})})]},D.id))})]})}),F.length===0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(tc,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron tickets"}),a.jsx("p",{className:"text-gray-500",children:"No hay tickets que coincidan con los filtros seleccionados."})]}),O&&b&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:["Ticket ",b.ticketNumber]}),a.jsx("button",{onClick:()=>V(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cliente"}),a.jsx("div",{className:"text-sm text-gray-900",children:b.clientName}),a.jsx("div",{className:"text-sm text-gray-500",children:b.clientEmail})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Asignado a"}),a.jsx("div",{className:"text-sm text-gray-900",children:b.assignedToName||"Sin asignar"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${M(b.status)}`,children:b.status})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prioridad"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${U(b.priority)}`,children:b.priority})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Departamento"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ee(b.department)}`,children:b.department})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Creado"}),a.jsx("div",{className:"text-sm text-gray-900",children:fe(b.createdAt)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto"}),a.jsx("div",{className:"text-sm text-gray-900 p-3 bg-gray-50 rounded-md",children:b.subject})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin"}),a.jsx("div",{className:"text-sm text-gray-900 p-4 bg-gray-50 rounded-md whitespace-pre-wrap",children:b.description})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Historial de Mensajes"}),a.jsx("div",{className:"border border-gray-200 rounded-md p-4",children:a.jsx(ZS,{ticketId:b.id,isDemo:t,userRole:e,currentUser:{uid:"admin",displayName:"Admin",email:"admin@empresa.com"}})})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{onClick:()=>V(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cerrar"}),e==="superadmin"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Responder"}),a.jsx("button",{onClick:()=>{window.confirm("Ests seguro de que quieres eliminar este ticket? Esta accin no se puede deshacer.")&&(H(b.id),V(!1))},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Eliminar Ticket"})]})]})]})]})}),ne&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Crear Nuevo Ticket"}),a.jsx("button",{onClick:()=>le(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cliente"}),a.jsxs("select",{value:z.clientId,onChange:D=>{const K=s.find(te=>te.id===D.target.value);T(te=>({...te,clientId:D.target.value,clientName:(K==null?void 0:K.fullName)||"",clientEmail:(K==null?void 0:K.email)||""}))},className:"w-full p-2 border rounded-md",required:!0,children:[a.jsx("option",{value:"",children:"Seleccionar cliente"}),s.map(D=>a.jsxs("option",{value:D.id,children:[D.fullName," (",D.email,")"]},D.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento"}),a.jsx("select",{value:z.department,onChange:D=>T(K=>({...K,department:D.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:S.filter(D=>D!=="Todos").map(D=>a.jsx("option",{value:D,children:D},D))})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridad"}),a.jsx("select",{value:z.priority,onChange:D=>T(K=>({...K,priority:D.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:N.filter(D=>D!=="Todos").map(D=>a.jsx("option",{value:D,children:D},D))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email del Cliente"}),a.jsx("input",{type:"email",value:z.clientEmail,onChange:D=>T(K=>({...K,clientEmail:D.target.value})),className:"w-full p-2 border rounded-md",placeholder:"email@ejemplo.com",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto *"}),a.jsx("input",{type:"text",value:z.subject,onChange:D=>T(K=>({...K,subject:D.target.value})),className:"w-full p-2 border rounded-md",placeholder:"Describe brevemente el problema o consulta",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin *"}),a.jsx("textarea",{value:z.description,onChange:D=>T(K=>({...K,description:D.target.value})),className:"w-full p-2 border rounded-md",rows:6,placeholder:"Describe el problema o consulta en detalle...",required:!0})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>le(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Crear Ticket"})]})]})]})})]})}function cM({isDemo:t,setIsDemoMode:e,onLogout:n}){const{addNotification:r}=xn(),[i,s]=ue.useState({}),o="company_info";ue.useEffect(()=>{if(t){s({companyName:"Mi Empresa (Demo)",identification:"123.456.789-0",address:"Calle Falsa 123, Ciudad Demo",phone:"+57 300 123 4567",email:"contacto@empresa-demo.com",website:"www.empresa-demo.com",logoUrl:"https://placehold.co/200x80/1d4ed8/ffffff?text=Mi+Logo"});return}const f=ct(Ue,"artifacts",Me,"public","data","settings",o);return Zt(f,v=>{v.exists()&&s(v.data())})},[t]);const l=f=>{const{name:g,value:v}=f.target;s(m=>({...m,[g]:v}))},c=()=>{const f=!t;e(f),f&&r("Modo demo activado. Recuerda guardar la configuracin para aplicar los cambios.","info")},u=async()=>{if(t){r("Funcin no disponible en modo demo.","error");return}try{const f=ct(Ue,"artifacts",Me,"public","data","settings",o),g={...i,isDemoMode:t,allowDemoMode:!0};await ki(f,g,{merge:!0}),r("Configuracin de la empresa guardada.","success"),t&&n&&(r("Modo demo activado. Cerrando sesin para probar los botones de demo...","info"),setTimeout(()=>{n()},2e3))}catch{r("Error al guardar la configuracin.","error")}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Configuracin"}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md max-w-4xl mx-auto space-y-8",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Informacin de Facturacin y Contacto"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx("input",{name:"companyName",value:i.companyName||"",onChange:l,placeholder:"Nombre de la Empresa",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"identification",value:i.identification||"",onChange:l,placeholder:"NIT / Identificacin Fiscal",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"address",value:i.address||"",onChange:l,placeholder:"Direccin",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"phone",value:i.phone||"",onChange:l,placeholder:"Telfono",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"email",type:"email",value:i.email||"",onChange:l,placeholder:"Email de Contacto",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"website",value:i.website||"",onChange:l,placeholder:"Sitio Web",className:"w-full p-2 border rounded-md"})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mt-8 mb-4",children:"Seguridad"}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-[300px]",children:[a.jsx("p",{className:"font-medium text-gray-800 mb-2",children:"Tiempo de Inactividad (minutos)"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Tiempo mximo de inactividad antes de cerrar sesin automticamente. Mnimo: 1 minuto, Mximo: 120 minutos."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",name:"inactivityTimeoutMinutes",value:i.inactivityTimeoutMinutes||10,onChange:l,min:"1",max:"120",className:"w-24 p-2 border border-gray-300 rounded-md text-center focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"10"}),a.jsx("span",{className:"text-gray-600 font-medium",children:"min"})]})]}),a.jsxs("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded",children:[a.jsxs("p",{className:"text-sm text-blue-800 font-medium",children:[a.jsx("strong",{children:" Configuracin Actual:"})," ",i.inactivityTimeoutMinutes||10," minutos de inactividad"]}),a.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"La sesin se cerrar automticamente si no hay actividad del usuario (movimiento del mouse, teclado, clics, scroll)."})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mt-8 mb-4",children:"Branding"}),a.jsx("input",{name:"logoUrl",value:i.logoUrl||"",onChange:l,placeholder:"URL del Logo (enlace a la imagen)",className:"w-full p-2 border rounded-md"}),i.logoUrl&&a.jsx("img",{src:i.logoUrl,alt:"Vista previa del logo",className:"mt-4 max-h-20 bg-gray-100 p-2 rounded"})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Modo de Operacin"}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-800",children:"Activar Modo de Prueba"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Usa datos de ejemplo sin afectar la informacin real. En modo prueba aparecern botones separados para admin y cliente."})]}),a.jsx("label",{htmlFor:"demoToggle",className:"flex items-center cursor-pointer",children:a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"checkbox",id:"demoToggle",className:"sr-only",checked:t,onChange:c}),a.jsx("div",{className:"block bg-gray-600 w-14 h-8 rounded-full"}),a.jsx("div",{className:"dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition"})]})})]}),t&&a.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Modo de Prueba Activado"}),a.jsxs("p",{className:"text-sm text-blue-700 mb-2",children:["En el login aparecern dos botones:",a.jsx("br",{})," ",a.jsx("strong",{children:"Administrador:"})," Acceso completo al sistema",a.jsx("br",{})," ",a.jsx("strong",{children:"Cliente:"})," Vista limitada de servicios y tickets"]}),a.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded",children:a.jsx("p",{className:"text-sm text-yellow-800 font-medium",children:" Recuerda guardar la configuracin para aplicar los cambios. Se cerrar la sesin automticamente para probar los botones de demo."})})]}),a.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[a.jsx("h4",{className:"font-semibold text-green-800 mb-2",children:" Herramientas de Desarrollo"}),a.jsx("p",{className:"text-sm text-green-700 mb-2",children:"Al activar el modo de prueba, tambin se habilitarn:"}),a.jsxs("ul",{className:"text-sm text-green-700 list-disc list-inside space-y-1",children:[a.jsx("li",{children:"Botn de cambio entre modo Demo/Live en el login"}),a.jsx("li",{children:"Botn de diagnstico de Firebase para debugging"}),a.jsx("li",{children:"Acceso a herramientas de desarrollo"})]})]})]}),a.jsx("button",{onClick:u,className:"mt-4 px-5 py-2 bg-blue-600 text-white font-semibold rounded-md shadow-sm hover:bg-blue-700",children:"Guardar Configuracin"})]})]})}function uM({user:t,isDemo:e,setIsDemoMode:n,userRole:r,companySettings:i,onLogout:s}){const[o,l]=ue.useState("services"),c=()=>{switch(o){case"users":return a.jsx(l8,{isDemo:e,userRole:r});case"templates":return a.jsx(c8,{isDemo:e});case"messages":return a.jsx(oM,{isDemo:e,userRole:r});case"tickets":return a.jsx(lM,{isDemo:e,userRole:r});case"payments":return a.jsx(iM,{isDemo:e,userRole:r});case"payment-config":return a.jsx(oS,{isDemo:e});case"settings":return a.jsx(cM,{isDemo:e,setIsDemoMode:n,onLogout:s});case"services":default:return a.jsx(i8,{isDemo:e,userRole:r})}};return a.jsxs("main",{className:"container mx-auto",children:[a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-8 px-4 sm:px-6 lg:px-8","aria-label":"Tabs",children:[a.jsxs("button",{onClick:()=>l("services"),className:`${o==="services"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(ip,{})," Servicios"]}),r==="superadmin"&&a.jsxs("button",{onClick:()=>l("users"),className:`${o==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(YL,{})," Usuarios"]}),a.jsxs("button",{onClick:()=>l("templates"),className:`${o==="templates"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(iS,{})," Plantillas"]}),a.jsxs("button",{onClick:()=>l("messages"),className:`${o==="messages"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(am,{})," Mensajes"]}),a.jsxs("button",{onClick:()=>l("payments"),className:`${o==="payments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(Xi,{})," Pagos"]}),a.jsxs("button",{onClick:()=>l("tickets"),className:`${o==="tickets"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(tc,{})," Tickets"]}),r==="superadmin"&&a.jsxs("button",{onClick:()=>l("settings"),className:`${o==="settings"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(QL,{})," Empresa"]})]})}),c()]})}function dM({isOpen:t,onClose:e,onConfirm:n,service:r,paymentType:i,warningMessage:s}){if(!t)return null;const o=()=>i==="One-Time"?a.jsx(Xi,{className:"h-8 w-8 text-blue-600"}):a.jsx(ll,{className:"h-8 w-8 text-green-600"}),l=()=>i==="One-Time"?"Solicitar Pago nico":"Solicitar Pago de Renovacin",c=()=>i==="One-Time"?"Esta es una solicitud de pago nico que no se renovar automticamente":"Esta solicitud renovar tu servicio por el perodo seleccionado",u=()=>i==="One-Time"?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"bg-green-600 hover:bg-green-700 focus:ring-green-500";return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 transform transition-all",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"flex-shrink-0",children:o()}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:l()}),a.jsx("p",{className:"text-sm text-gray-500",children:c()})]})]})}),a.jsxs("div",{className:"px-6 py-4",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:r.serviceType}),a.jsxs("span",{className:"text-sm font-semibold text-gray-600",children:[r.currency," ",r.amount.toFixed(2)]})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:r.description}),a.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[a.jsxs("span",{children:["Nmero: ",r.serviceNumber]}),i!=="One-Time"&&a.jsxs("span",{children:["Ciclo: ",r.billingCycle]})]})]}),a.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(t8,{className:"h-5 w-5 text-amber-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-medium text-amber-800 mb-1",children:"Informacin Importante"}),a.jsx("p",{className:"text-sm text-amber-700",children:s})]})]})}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Tipo de Pago:"}),a.jsx("span",{className:"font-medium text-gray-900",children:i==="One-Time"?"Pago nico":"Renovacin"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Monto:"}),a.jsxs("span",{className:"font-medium text-gray-900",children:[r.currency," ",r.amount.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Mtodo de Pago:"}),a.jsx("span",{className:"font-medium text-gray-900",children:"Transferencia Bancaria"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Estado Inicial:"}),a.jsx("span",{className:"font-medium text-amber-600",children:"Pendiente"})]})]})]}),a.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-2xl flex justify-end space-x-3",children:[a.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors",children:"Cancelar"}),a.jsx("button",{onClick:n,className:`px-6 py-2 text-sm font-medium text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors ${u()}`,children:i==="One-Time"?"Solicitar Pago nico":"Solicitar Renovacin"})]})]})})}function hM({user:t,isDemo:e,userProfile:n}){const{addNotification:r}=xn(),[i,s]=ue.useState([]),[o,l]=ue.useState(!0),[c,u]=ue.useState(new Set),[f,g]=ue.useState(new Set),[v,m]=ue.useState({}),[E,A]=ue.useState(null),[C,b]=ue.useState({isOpen:!1,service:null}),[I,O]=ue.useState(null),V=$=>{if(!$.dueDate||!$.billingCycle||$.billingCycle==="One-Time")return $.expirationDate?new Date($.expirationDate.seconds*1e3):null;const H=new Date($.dueDate.seconds*1e3);let Y=new Date(H);switch($.billingCycle){case"Monthly":Y.setMonth(Y.getMonth()+1);break;case"Semiannually":Y.setMonth(Y.getMonth()+6);break;case"Annually":Y.setFullYear(Y.getFullYear()+1);break;case"Biennially":Y.setFullYear(Y.getFullYear()+2);break;case"Triennially":Y.setFullYear(Y.getFullYear()+3);break;default:return null}return Y},ne=$=>{const H=V($);return H?H.toLocaleDateString():"N/A"},le=$=>({"One-Time":"Pago nico",Monthly:"Mensual",Semiannually:"Semestral",Annually:"Anual",Biennially:"Bianual",Triennially:"Trienal",Custom:"Personalizado"})[$]||$,z=$=>{if(c.has($.id)){r("Ya se est solicitando un pago para este servicio","warning");return}if(f.has($.id)){r("Ya existe una solicitud de pago pendiente para este servicio","warning");return}b({isOpen:!0,service:$})},T=async $=>{if(e){r("Solicitud de pago creada exitosamente (modo demo)","success"),b({isOpen:!1,service:null});return}u(H=>new Set(H).add($.id));try{let H;if($.billingCycle==="One-Time")H=$.dueDate?new Date($.dueDate.seconds*1e3):new Date,H.setDate(H.getDate()+30);else{const w=V($);w?H=w:H=new Date(Date.now()+30*24*60*60*1e3)}let M=I?(w=>{if(!w)return null;if(w.gateways)return w.gateways;const{bold:F,paypal:D,payu:K,bankTransfer:te}=w,oe={};return F&&(oe.bold={name:"Bold",...F}),D&&(oe.paypal={name:"PayPal",...D}),K&&(oe.payu={name:"PayU",...K}),te&&(oe.bankTransfer={name:"Transferencia Bancaria",...te}),oe})(I):null;M||(M={bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}});const U=M?Object.values(M).filter(w=>w.enabled):[];let ee="Transferencia Bancaria",fe="Transferencia Bancaria";U.length===1?(ee=U[0].name,fe=U[0].name):U.length>1&&(ee="Pendiente de Seleccin",fe=$.billingCycle==="One-Time"?"Pago nico":"Renovacin");const Q={serviceId:$.id,serviceNumber:$.serviceNumber,serviceType:$.serviceType,description:$.description,amount:$.amount,currency:$.currency,status:"Pendiente",gateway:ee,userId:t.uid,clientName:(n==null?void 0:n.fullName)||"Cliente",clientEmail:t.email,dueDate:dt.fromDate(H),createdAt:dt.now(),paymentMethod:fe,notes:`Solicitud de pago automtica para servicio ${$.serviceNumber} - Ciclo: ${le($.billingCycle)}`,billingCycle:$.billingCycle,isAutoGenerated:!0,originalServiceDueDate:$.dueDate?$.dueDate.toDate?$.dueDate:dt.fromDate(new Date($.dueDate)):null,paymentType:$.billingCycle==="One-Time"?"Pago nico":"Renovacin"};await xa(zt(Ue,"artifacts",Me,"public","data","payments"),Q),r("Solicitud de pago creada exitosamente. Revisa la seccin de pagos.","success"),b({isOpen:!1,service:null})}catch(H){console.error("Error generating payment:",H),r("Error al crear la solicitud de pago. Intenta nuevamente.","error")}finally{u(H=>{const Y=new Set(H);return Y.delete($.id),Y})}},k=$=>{localStorage.setItem("selectedServiceForRenewal",JSON.stringify({id:$.id,serviceNumber:$.serviceNumber,serviceType:$.serviceType,description:$.description,amount:$.amount,currency:$.currency,billingCycle:$.billingCycle,dueDate:$.dueDate})),window.location.hash==="#renewals"?(window.location.hash="",setTimeout(()=>{window.location.hash="renewals"},50)):window.location.hash="renewals",r("Redirigiendo a renovaciones para este servicio","success")};ue.useEffect(()=>{if(e){g(new Set(["demo1","demo2"]));return}if(!(t!=null&&t.uid))return;const $=lr(zt(Ue,"artifacts",Me,"public","data","payments"),ni("userId","==",t.uid)),H=Zt($,Y=>{const M=new Set,U={},ee=new Set(["Pendiente","Procesando"]);Y.docs.forEach(fe=>{const Q=fe.data();Q.serviceId&&ee.has(Q.status)&&(M.add(Q.serviceId),U[Q.serviceId]={id:fe.id,...Q})}),g(M),m(U)});return()=>H()},[t==null?void 0:t.uid,e]),ue.useEffect(()=>{if(e){O({gateways:{bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}}});return}const $=ct(Ue,"artifacts",Me,"public","data","settings","paymentConfig"),H=Zt($,Y=>{Y.exists()?O(Y.data()):O({gateways:{bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}}})});return()=>H()},[e]),ue.useEffect(()=>{if(e){A({renewalSettings:{reminderDays:10,gracePeriodDays:7}});return}const $=ct(Ue,"artifacts",Me,"public","data","settings","renewalConfig"),H=Zt($,Y=>{Y.exists()&&A(Y.data())});return()=>H()},[e]);const N=$=>{if(!$||$.billingCycle==="One-Time")return null;const H=V($);if(!H)return null;const Y=new Date;return Math.ceil((H.getTime()-Y.getTime())/(1e3*60*60*24))};ue.useEffect(()=>{if(e||!(E!=null&&E.renewalSettings)||!(t!=null&&t.uid))return;const $=Number(E.renewalSettings.reminderDays??0),H=Number(E.renewalSettings.gracePeriodDays??0);(async()=>{for(const M of i){if(!M||M.billingCycle==="One-Time")continue;const U=N(M);if(U!=null){if(U<=$&&U>=-H&&!f.has(M.id))try{await T(M)}catch(ee){console.error("Auto-generate payment failed:",ee)}if(U<-H){const ee=v[M.id];if(ee!=null&&ee.id)try{await fr(ct(Ue,"artifacts",Me,"public","data","payments",ee.id),{status:"Cancelado",updatedAt:new Date,cancelReason:"Periodo de gracia agotado"}),r(`Solicitud de pago cancelada por perodo de gracia (${M.serviceNumber})`,"warning")}catch(fe){console.error("Auto-cancel payment failed:",fe)}}}}})()},[i,E,f,v,t==null?void 0:t.uid,e]),ue.useEffect(()=>{if(e){s([{id:"demo1",serviceNumber:"SRV-241017-123456",serviceType:"Hosting",description:"Plan Bsico - 1GB",amount:10.99,currency:"USD",status:"Activo",dueDate:{seconds:Date.now()/1e3+30*24*60*60},billingCycle:"Monthly",clientNotes:"Servicio de hosting bsico"},{id:"demo2",serviceNumber:"SRV-241017-789012",serviceType:"Dominio",description:"midominio.com",amount:15,currency:"USD",status:"Pendiente Pago",dueDate:{seconds:Date.now()/1e3+10*24*60*60},billingCycle:"Annually",clientNotes:"Renovacin de dominio"}]),l(!1);return}if(!(t!=null&&t.uid)){l(!1);return}const $=lr(zt(Ue,"artifacts",Me,"public","data","services"),ni("assignedUserId","==",t.uid)),H=Zt($,Y=>{const M=Y.docs.map(U=>({id:U.id,...U.data()}));M.sort((U,ee)=>{var w,F;const fe=((w=U.createdAt)==null?void 0:w.seconds)||0;return(((F=ee.createdAt)==null?void 0:F.seconds)||0)-fe}),s(M),l(!1)},Y=>{console.error("Error loading services:",Y),r("Error al cargar los servicios","error"),l(!1)});return()=>H()},[t==null?void 0:t.uid,e,r]);const S=$=>({Activo:"bg-green-100 text-green-800","Periodo de Gracia Vencido":"bg-yellow-100 text-yellow-800","Pendiente Pago":"bg-red-100 text-red-800",Pago:"bg-blue-100 text-blue-800",Cancelado:"bg-gray-100 text-gray-800"})[$]||"bg-gray-100 text-gray-800",P=$=>$?new Date($.seconds*1e3).toLocaleDateString("es-ES"):"--",R=($,H)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:H||"USD"}).format($);return o?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(ip,{}),"Mis Servicios Contratados"]}),a.jsxs("div",{className:"text-sm text-gray-500",children:[i.length," servicio",i.length!==1?"s":""," encontrado",i.length!==1?"s":""]})]}),i.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(ip,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes servicios asignados"}),a.jsx("p",{className:"text-gray-500",children:"Contacta al administrador para que te asigne servicios."})]}):a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Nmero","Servicio","Descripcin","Monto","Estado","Ciclo","Fecha de Inicio","Fecha de Vencimiento","Notas","Acciones"].map($=>a.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:$},$))})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:i.map($=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:$.serviceNumber||"N/A"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"font-medium text-gray-900",children:$.serviceType})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"text-gray-900",children:$.description})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"font-medium text-gray-900",children:R($.amount,$.currency)})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${S($.status)}`,children:$.status})}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:le($.billingCycle)}),$.billingCycle==="Custom"&&$.customBillingCycle&&a.jsxs("div",{className:"text-xs text-gray-500",children:["(",$.customBillingCycle,")"]})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm text-gray-900",children:P($.dueDate)}),a.jsx("div",{className:"text-xs text-gray-500",children:"Inicio"})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:ne($)}),a.jsx("div",{className:"text-xs text-gray-500",children:"Vencimiento"})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"text-gray-600 text-sm max-w-xs truncate",children:$.clientNotes||"--"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"flex items-center space-x-2",children:f.has($.id)?a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-xs text-orange-600 font-medium mb-1",children:"Por pagar"}),a.jsxs("button",{onClick:()=>window.location.href="#payments",className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700",title:"Ir a Pago",children:[a.jsx(pl,{className:"h-4 w-4 mr-1"}),"Ir a Pago"]})]}):a.jsxs("div",{className:"flex flex-col space-y-2",children:[a.jsxs("button",{onClick:()=>{const H=N($);if($.billingCycle!=="One-Time"&&(H==null||E!=null&&E.renewalSettings&&H>(E.renewalSettings.reminderDays??0))){k($);return}z($)},disabled:c.has($.id),className:`inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${c.has($.id)?"text-gray-400 bg-gray-200 cursor-not-allowed":"text-white bg-blue-600 hover:bg-blue-700"}`,title:c.has($.id)?"Creando solicitud...":$.billingCycle==="One-Time"?"Solicitar de Nuevo":"Solicitar de Nuevo (ir a Renovaciones fuera de ventana)",children:[a.jsx(Xi,{className:"h-4 w-4 mr-1"}),c.has($.id)?"Creando...":f.has($.id)?"Ir a Pago":"Solicitar de Nuevo"]}),$.billingCycle!=="One-Time"&&a.jsxs("button",{onClick:()=>k($),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",title:"Aumentar ciclo de este servicio",children:[a.jsx(ll,{className:"h-4 w-4 mr-1"}),"Aumentar Ciclo"]})]})})})]},$.id))})]})}),C.isOpen&&C.service&&a.jsx(dM,{isOpen:C.isOpen,onClose:()=>b({isOpen:!1,service:null}),onConfirm:()=>T(C.service),service:C.service,paymentType:C.service.billingCycle,warningMessage:C.service.billingCycle==="One-Time"?`Se crear una solicitud de pago nico para el servicio "${C.service.serviceType}". La solicitud vencer en 30 das desde la fecha actual.`:`Se crear una solicitud de pago de renovacin para el servicio "${C.service.serviceType}" con ciclo ${le(C.service.billingCycle)}. La solicitud vencer en la fecha de vencimiento del servicio.`})]})}function fM({bankAccounts:t,serviceNumber:e,amount:n,currency:r,onUpload:i}){const s=(o,l)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:l||"USD"}).format(o);return!t||t.length===0?a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:a.jsx("p",{className:"text-yellow-800",children:"No hay cuentas bancarias configuradas. Contacta al administrador."})}):a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Xi,{}),a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Instrucciones para Transferencia Bancaria"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Informacin del Pago"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Nmero de Servicio:"}),a.jsx("span",{className:"ml-2 font-mono text-blue-600",children:e})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Monto a Pagar:"}),a.jsx("span",{className:"ml-2 font-semibold text-green-600",children:s(n,r)})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Cuentas Disponibles para Transferencia"}),a.jsx("div",{className:"space-y-4",children:t.map((o,l)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h5",{className:"font-medium text-gray-700",children:["Opcin ",l+1]}),a.jsx("span",{className:"text-sm text-gray-500",children:o.accountType})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-600",children:"Banco:"}),a.jsx("span",{className:"ml-2 text-gray-800",children:o.bankName})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-600",children:"Nmero de Cuenta:"}),a.jsx("span",{className:"ml-2 font-mono text-blue-600",children:o.accountNumber})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("span",{className:"font-medium text-gray-600",children:"Titular:"}),a.jsx("span",{className:"ml-2 text-gray-800",children:o.accountHolder})]})]})]},o.id))})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Instrucciones Paso a Paso"}),a.jsxs("ol",{className:"space-y-2 text-sm text-gray-700",children:[a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"1"}),a.jsx("span",{children:"Realiza una transferencia bancaria a cualquiera de las cuentas mostradas arriba"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"2"}),a.jsxs("span",{children:["Usa el ",a.jsx("strong",{children:"Nmero de Servicio"})," como referencia en la transferencia"]})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"3"}),a.jsxs("span",{children:["Transfiere el monto exacto: ",a.jsx("strong",{children:s(n,r)})]})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"4"}),a.jsx("span",{children:"Guarda el comprobante de transferencia"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"5"}),a.jsx("span",{children:"Enva el comprobante por email o sube una foto en el sistema"})]})]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:" Informacin Importante"}),a.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[a.jsx("li",{children:" El pago puede tardar hasta 24 horas en ser procesado"}),a.jsx("li",{children:" Asegrate de incluir el nmero de servicio como referencia"}),a.jsx("li",{children:" El monto debe ser exacto para evitar retrasos"}),a.jsx("li",{children:" Contacta al administrador si tienes alguna duda"})]})]}),a.jsx("div",{className:"text-center",children:a.jsxs("label",{className:"inline-block px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium cursor-pointer",children:["Subir Comprobante de Transferencia",a.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:o=>{var l;return i&&((l=o.target.files)==null?void 0:l[0])&&i(o.target.files[0])}})]})})]})]})}function mM({user:t,isDemo:e,userProfile:n}){const{addNotification:r}=xn(),[i,s]=ue.useState([]),[o,l]=ue.useState(""),[c,u]=ue.useState("Todos"),[f,g]=ue.useState(!0),[v,m]=ue.useState([]),[E,A]=ue.useState(!1),[C,b]=ue.useState(null),[I,O]=ue.useState(null),[V,ne]=ue.useState({}),[le,z]=ue.useState(!1),[T,k]=ue.useState(null),N=()=>{if(!I)return null;if(I.gateways)return I.gateways;const{bold:w,paypal:F,payu:D,bankTransfer:K}=I,te={};return w&&(te.bold={name:"Bold",...w}),F&&(te.paypal={name:"PayPal",...F}),D&&(te.payu={name:"PayU",...D}),K&&(te.bankTransfer={name:"Transferencia Bancaria",...K}),te},S=["Todos","Pendiente","Procesando","Completado","Fallido","Cancelado","Reembolsado"];ue.useEffect(()=>{if(e){O({gateways:{bold:{enabled:!0,name:"Bold",autoApprove:!1},paypal:{enabled:!0,name:"PayPal",autoApprove:!1},payu:{enabled:!0,name:"PayU",autoApprove:!1},bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}},bankAccounts:[{id:"1",bank:"Banco Nacional",accountNumber:"1234567890",accountHolder:"Mi Empresa"},{id:"2",bank:"Banco Popular",accountNumber:"0987654321",accountHolder:"Mi Empresa"}]});return}const w=ct(Ue,"artifacts",Me,"public","data","settings","paymentConfig"),F=Zt(w,D=>{D.exists()?(O(D.data()),console.log("Payment config loaded:",D.data())):(console.log("No payment config found, using defaults"),O({gateways:{bold:{enabled:!0,name:"Bold",autoApprove:!1},paypal:{enabled:!0,name:"PayPal",autoApprove:!1},payu:{enabled:!0,name:"PayU",autoApprove:!1},bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}},bankAccounts:[]}))},D=>{console.error("Error loading payment config:",D)});return()=>F()},[e]),ue.useEffect(()=>{if(e){s([{id:"demo1",serviceNumber:"SRV-241017-123456",serviceType:"Hosting",amount:10.99,currency:"USD",status:"Completado",gateway:"Bold",transactionId:"bold_txn_123456",createdAt:{seconds:Date.now()/1e3-86400},completedAt:{seconds:Date.now()/1e3-3600}},{id:"demo2",serviceNumber:"SRV-241017-789012",serviceType:"Dominio",amount:25,currency:"USD",status:"Pendiente",gateway:"PayPal",transactionId:"paypal_txn_789012",createdAt:{seconds:Date.now()/1e3-7200}},{id:"demo3",serviceNumber:"SRV-241017-345678",serviceType:"Hosting Premium",amount:50,currency:"USD",status:"Completado",gateway:"Transferencia Bancaria",transactionId:"TRF-123456789",createdAt:{seconds:Date.now()/1e3-10800},completedAt:{seconds:Date.now()/1e3-9e3}}]),m([{id:"1",bankName:"Banco Nacional",accountNumber:"1234567890",accountHolder:"Empresa Demo",accountType:"Ahorros"},{id:"2",bankName:"Banco Popular",accountNumber:"0987654321",accountHolder:"Empresa Demo",accountType:"Corriente"}]),g(!1);return}if(!(t!=null&&t.uid)){g(!1);return}const w=lr(zt(Ue,"artifacts",Me,"public","data","payments"),ni("userId","==",t.uid)),F=Zt(w,D=>{const K=D.docs.map(te=>({id:te.id,...te.data()}));console.log("Payments loaded:",K.length,K),K.sort((te,oe)=>{var ve,Ee;const he=((ve=te.createdAt)==null?void 0:ve.seconds)||0;return(((Ee=oe.createdAt)==null?void 0:Ee.seconds)||0)-he}),s(K),g(!1)},D=>{console.error("Error loading payments:",D),r("Error al cargar los pagos","error"),g(!1)});return()=>F()},[t==null?void 0:t.uid,e,r]),ue.useEffect(()=>{if(e)return;const w=ct(Ue,"artifacts",Me,"public","data","settings","paymentConfig"),F=Zt(w,D=>{var K;if(D.exists()){const te=D.data();(K=te.bankTransfer)!=null&&K.accounts&&m(te.bankTransfer.accounts)}});return()=>F()},[e]);const P=i.filter(w=>{const F=o===""||w.serviceNumber&&w.serviceNumber.toLowerCase().includes(o.toLowerCase())||w.serviceType&&w.serviceType.toLowerCase().includes(o.toLowerCase())||w.serviceName&&w.serviceName.toLowerCase().includes(o.toLowerCase())||w.transactionId&&w.transactionId.toLowerCase().includes(o.toLowerCase()),D=c==="Todos"||w.status===c,K=F&&D;return console.log("Payment filter:",{payment:w.id,serviceType:w.serviceType,serviceName:w.serviceName,status:w.status,searchTerm:o,statusFilter:c,matchesSearch:F,matchesStatus:D,result:K}),K}),R=w=>({Pendiente:"bg-yellow-100 text-yellow-800",Procesando:"bg-blue-100 text-blue-800",Completado:"bg-green-100 text-green-800",Fallido:"bg-red-100 text-red-800",Cancelado:"bg-gray-100 text-gray-800",Reembolsado:"bg-purple-100 text-purple-800"})[w]||"bg-gray-100 text-gray-800",$=w=>({Bold:"bg-blue-100 text-blue-800",PayPal:"bg-yellow-100 text-yellow-800",PayU:"bg-green-100 text-green-800","Transferencia Bancaria":"bg-purple-100 text-purple-800",Manual:"bg-gray-100 text-gray-800"})[w]||"bg-gray-100 text-gray-800",H=w=>{const F={invoiceNumber:`INV-${w.id.slice(-8).toUpperCase()}`,date:new Date(w.createdAt.seconds*1e3).toLocaleDateString(),dueDate:w.dueDate?new Date(w.dueDate.seconds*1e3).toLocaleDateString():"N/A",clientName:w.clientName||(n==null?void 0:n.fullName)||"Cliente",clientEmail:w.clientEmail||(t==null?void 0:t.email)||"N/A",serviceNumber:w.serviceNumber||"N/A",serviceType:w.serviceType||"Servicio",description:w.description||"Descripcin del servicio",amount:w.amount||0,currency:w.currency||"USD",status:w.status||"Pendiente",gateway:w.gateway||"N/A",transactionId:w.transactionId||"N/A",paymentMethod:w.paymentMethod||"N/A"},D=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>Invoice ${F.invoiceNumber}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
          .invoice { background: white; max-width: 800px; margin: 0 auto; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
          .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #e5e5e5; padding-bottom: 20px; }
          .company-name { font-size: 24px; font-weight: bold; color: #2563eb; margin-bottom: 5px; }
          .invoice-title { font-size: 18px; color: #666; }
          .invoice-details { display: flex; justify-content: space-between; margin-bottom: 30px; }
          .client-info, .invoice-info { flex: 1; }
          .client-info h3, .invoice-info h3 { margin: 0 0 10px 0; color: #333; font-size: 16px; }
          .client-info p, .invoice-info p { margin: 5px 0; color: #666; font-size: 14px; }
          .service-details { margin-bottom: 30px; }
          .service-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
          .service-table th, .service-table td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e5e5; }
          .service-table th { background: #f8f9fa; font-weight: bold; color: #333; }
          .service-table .amount { text-align: right; font-weight: bold; }
          .total { text-align: right; margin-top: 20px; }
          .total-amount { font-size: 20px; font-weight: bold; color: #2563eb; }
          .status { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; }
          .status.completado { background: #d1fae5; color: #065f46; }
          .status.pendiente { background: #fef3c7; color: #92400e; }
          .status.fallido { background: #fee2e2; color: #991b1b; }
          .status.cancelado { background: #f3f4f6; color: #374151; }
          .footer { margin-top: 40px; text-align: center; color: #666; font-size: 12px; border-top: 1px solid #e5e5e5; padding-top: 20px; }
        </style>
      </head>
      <body>
        <div class="invoice">
          <div class="header">
            <div class="company-name">Gestor de Cobros</div>
            <div class="invoice-title">FACTURA</div>
          </div>
          
          <div class="invoice-details">
            <div class="client-info">
              <h3>Cliente</h3>
              <p><strong>${F.clientName}</strong></p>
              <p>${F.clientEmail}</p>
            </div>
            <div class="invoice-info">
              <h3>Detalles de la Factura</h3>
              <p><strong>Nmero:</strong> ${F.invoiceNumber}</p>
              <p><strong>Fecha:</strong> ${F.date}</p>
              <p><strong>Vencimiento:</strong> ${F.dueDate}</p>
              <p><strong>Estado:</strong> <span class="status ${F.status.toLowerCase()}">${F.status}</span></p>
            </div>
          </div>
          
          <div class="service-details">
            <h3>Detalles del Servicio</h3>
            <table class="service-table">
              <thead>
                <tr>
                  <th>Servicio</th>
                  <th>Descripcin</th>
                  <th>Monto</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>${F.serviceType}</td>
                  <td>${F.description}</td>
                  <td class="amount">${F.currency} ${F.amount.toFixed(2)}</td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <div class="total">
            <div class="total-amount">Total: ${F.currency} ${F.amount.toFixed(2)}</div>
          </div>
          
          <div class="footer">
            <p>Mtodo de Pago: ${F.paymentMethod}</p>
            <p>Gateway: ${F.gateway}</p>
            ${F.transactionId!=="N/A"?`<p>ID de Transaccin: ${F.transactionId}</p>`:""}
            <p>Gracias por su negocio</p>
          </div>
        </div>
      </body>
      </html>
    `,K=new Blob([D],{type:"text/html"}),te=URL.createObjectURL(K),oe=document.createElement("a");oe.href=te,oe.download=`invoice-${F.invoiceNumber}.html`,document.body.appendChild(oe),oe.click(),document.body.removeChild(oe),URL.revokeObjectURL(te),r("Invoice descargado exitosamente","success")},Y=w=>w?new Date(w.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",M=(w,F)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:F||"USD"}).format(w),U=w=>{switch(w){case"Completado":return"";case"Pendiente":return"";case"Procesando":return"";case"Fallido":return"";case"Cancelado":return"";case"Reembolsado":return"";default:return""}},ee=w=>{b(w),A(!0)},fe=async(w,F)=>{const D=N(),K=D==null?void 0:D[F];if(K)if(F==="bankTransfer"){if(w.gateway!=="Transferencia Bancaria")try{const te=ct(Ue,"artifacts",Me,"public","data","payments",w.id);await fr(te,{gateway:"Transferencia Bancaria",updatedAt:new Date}),r("Pasarela cambiada a Transferencia Bancaria","success")}catch{r("No se pudo actualizar la pasarela del pago","error")}ee({...w,gateway:"Transferencia Bancaria"})}else r(`Redirigiendo a ${K.name} para procesar el pago`,"info")},Q=async(w,F)=>{if(!F||!(w!=null&&w.id)){r("Selecciona una imagen vlida","warning");return}try{ne(ve=>({...ve,[w.id]:!0})),console.log(" Iniciando subida de comprobante va PHP...");const D=new FormData;D.append("file",F);const K=window.location.origin+"/upload.php";console.log(" Enviando a:",K);const te=await fetch(K,{method:"POST",body:D});if(console.log(" Respuesta recibida:",te.status,te.statusText),!te.ok){const ve=await te.text();throw console.error(" Error del servidor:",ve),new Error(`upload_failed_${te.status}: ${ve}`)}const oe=await te.json();console.log(" Respuesta JSON:",oe);const he=oe==null?void 0:oe.url;if(!he)throw console.error(" No se recibi URL en la respuesta:",oe),new Error("missing_url");const pe=ct(Ue,"artifacts",Me,"public","data","payments",w.id);await fr(pe,{proofUrl:he,proofUploadedAt:new Date,status:"Procesando"}),console.log(" Comprobante guardado en Firestore:",he),b(ve=>ve&&ve.id===w.id?{...ve,proofUrl:he,status:"Procesando"}:ve),s(ve=>ve.map(Ee=>Ee.id===w.id?{...Ee,proofUrl:he,status:"Procesando"}:Ee)),A(!1),r("Comprobante subido correctamente","success")}catch(D){console.error(" Upload proof failed:",D),r(`No se pudo subir el comprobante: ${D.message}`,"error")}finally{ne(D=>({...D,[w.id]:!1}))}};return f?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(Xi,{}),"Mis Pagos"]}),a.jsxs("div",{className:"text-sm text-gray-500",children:[P.length," pago",P.length!==1?"s":""," encontrado",P.length!==1?"s":""]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar por servicio o transaccin...",value:o,onChange:w=>l(w.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Fu,{})})]}),a.jsx("select",{value:c,onChange:w=>u(w.target.value),className:"w-full p-2 border rounded-md",children:S.map(w=>a.jsx("option",{value:w,children:w},w))})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Total Pagado"}),a.jsx("div",{className:"text-2xl font-bold text-green-600",children:M(i.filter(w=>w.status==="Completado").reduce((w,F)=>w+(F.amount||0),0),"USD")})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Pendientes"}),a.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:i.filter(w=>w.status==="Pendiente").length})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Completados"}),a.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.filter(w=>w.status==="Completado").length})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Fallidos"}),a.jsx("div",{className:"text-2xl font-bold text-red-600",children:i.filter(w=>w.status==="Fallido").length})]})]}),P.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(Xi,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes pagos registrados"}),a.jsx("p",{className:"text-gray-500",children:"Los pagos aparecern aqu una vez que realices una transaccin."})]}):a.jsx("div",{className:"space-y-4",children:P.map(w=>a.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("span",{className:"text-2xl",children:U(w.status)}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:w.serviceName||w.serviceType||"Servicio"}),a.jsx("p",{className:"text-sm text-gray-500 font-mono",children:w.serviceNumber||w.id}),w.serviceDescription&&a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:w.serviceDescription}),w.isRenewal&&a.jsxs("div",{className:"text-xs text-green-600 font-medium mt-1",children:["Renovacin: ",w.renewalPeriod||"N/A"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Monto:"}),a.jsx("div",{className:"font-semibold text-lg text-gray-900",children:M(w.amount,w.currency)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Estado:"}),a.jsx("div",{className:"mt-1",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${R(w.status)}`,children:w.status})})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Pasarela:"}),a.jsx("div",{className:"mt-1",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${$(w.gateway)}`,children:w.gateway})})]})]}),a.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:[a.jsxs("div",{children:["Fecha: ",Y(w.createdAt)]}),w.completedAt&&a.jsxs("div",{children:["Completado: ",Y(w.completedAt)]}),w.startDate&&w.endDate&&a.jsx("div",{className:"text-blue-600 mt-2",children:a.jsxs("div",{children:["Perodo: ",Y(w.startDate)," - ",Y(w.endDate)]})}),w.transactionId&&a.jsxs("div",{className:"font-mono",children:["ID: ",w.transactionId]}),w.isRenewal&&w.renewalMonths&&a.jsxs("div",{className:"text-green-600",children:["Duracin: ",w.renewalMonths," meses"]})]})]}),a.jsxs("div",{className:"mt-4 md:mt-0 md:ml-4 flex flex-wrap gap-2",children:[(w.status==="Completado"||w.status==="Fallido"||w.status==="Cancelado")&&a.jsxs("button",{onClick:()=>H(w),className:"inline-flex items-center px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm",children:[a.jsx(pl,{className:"h-4 w-4 mr-1"}),"Descargar Invoice"]}),w.status==="Pendiente"&&a.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{const F=N();return F?Object.entries(F).map(([D,K])=>K.enabled?a.jsxs("button",{onClick:()=>fe(w,D),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:["Pagar con ",K.name]},D):null):null})()}),w.gateway==="Transferencia Bancaria"&&a.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[w.status==="Pendiente"&&a.jsxs("label",{className:`px-4 py-2 ${V[w.id]?"bg-gray-200 text-gray-400 cursor-wait":"bg-gray-100 text-gray-800 hover:bg-gray-200 cursor-pointer"} rounded-lg text-sm`,children:[V[w.id]?"Subiendo...":"Subir Comprobante",a.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:F=>{var D;return((D=F.target.files)==null?void 0:D[0])&&Q(w,F.target.files[0])}})]}),w.proofUrl&&a.jsx("button",{onClick:()=>{k(w.proofUrl),z(!0)},className:"px-4 py-2 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 text-sm",children:"Ver Comprobante"}),w.status==="Procesando"&&a.jsx("span",{className:"text-sm text-blue-600 font-medium",children:"Comprobante en revisin"})]})]})]})},w.id))}),E&&C&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsx("div",{className:"bg-white rounded-lg shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Instrucciones de Transferencia"}),a.jsx("button",{onClick:()=>A(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsx(fM,{bankAccounts:v,serviceNumber:C.serviceNumber,amount:C.amount,currency:C.currency,onUpload:w=>Q(C,w)})]})})}),le&&T&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-50 flex justify-center items-center p-4",onClick:()=>z(!1),children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-5xl w-full max-h-[95vh] overflow-hidden flex flex-col",onClick:w=>w.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b bg-gray-50",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Comprobante de Pago"}),a.jsx("button",{onClick:()=>z(!1),className:"text-gray-400 hover:text-gray-600 text-2xl font-bold w-8 h-8 flex items-center justify-center","aria-label":"Cerrar",children:""})]}),a.jsx("div",{className:"flex-1 overflow-auto p-4 bg-gray-100 flex justify-center items-center min-h-[400px]",children:a.jsx("img",{src:T,alt:"Comprobante de pago",className:"max-w-full max-h-[80vh] object-contain rounded-lg shadow-lg",onError:w=>{w.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="%23999"%3ENo se pudo cargar la imagen%3C/text%3E%3C/svg%3E'}})}),a.jsxs("div",{className:"p-4 border-t bg-gray-50 flex justify-end gap-2",children:[a.jsx("a",{href:T,target:"_blank",rel:"noreferrer",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:"Abrir en Nueva Pestaa"}),a.jsx("button",{onClick:()=>{const w=document.createElement("a");w.href=T,w.download=`comprobante-${Date.now()}.${T.split(".").pop().split("?")[0]}`,document.body.appendChild(w),w.click(),document.body.removeChild(w)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm",children:"Descargar"}),a.jsx("button",{onClick:()=>z(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 text-sm",children:"Cerrar"})]})]})})]})}function pM({user:t,isDemo:e,userProfile:n}){const{addNotification:r}=xn(),[i,s]=ue.useState([]),[o,l]=ue.useState(null),[c,u]=ue.useState(!0),[f,g]=ue.useState(null),[v,m]=ue.useState(new Set),[E,A]=ue.useState(!1),C=[{key:"monthly",label:"Mensual",months:1},{key:"quarterly",label:"Trimestral",months:3},{key:"semiAnnual",label:"Semestral",months:6},{key:"annual",label:"Anual",months:12},{key:"biennial",label:"Bienal (2 aos)",months:24},{key:"triennial",label:"Trienal (3 aos)",months:36}];ue.useEffect(()=>{if(e){l({discounts:{monthly:{enabled:!1,percentage:0},quarterly:{enabled:!0,percentage:5},semiAnnual:{enabled:!0,percentage:10},annual:{enabled:!0,percentage:15},biennial:{enabled:!0,percentage:25},triennial:{enabled:!0,percentage:35}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"}});return}const M=ct(Ue,"artifacts",Me,"public","data","settings","renewalConfig"),U=Zt(M,ee=>{ee.exists()?(l(ee.data()),console.log("Renewal config loaded:",ee.data())):(console.log("No renewal config found, using defaults"),l({discounts:{monthly:{enabled:!1,percentage:0},quarterly:{enabled:!0,percentage:5},semiAnnual:{enabled:!0,percentage:10},annual:{enabled:!0,percentage:15},biennial:{enabled:!0,percentage:25},triennial:{enabled:!0,percentage:35}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"}}))},ee=>{console.error("Error loading renewal config:",ee)});return()=>U()},[e]),ue.useEffect(()=>{const M=localStorage.getItem("selectedServiceForRenewal");if(M)try{const U=JSON.parse(M);g(U),r(`Servicio "${U.serviceType}" seleccionado para renovacin`,"success"),localStorage.removeItem("selectedServiceForRenewal")}catch(U){console.error("Error parsing selected service:",U)}},[]),ue.useEffect(()=>{if(!f||i.length===0)return;const M=document.getElementById(`service-${f.id}`);M&&M.scrollIntoView({behavior:"smooth",block:"start"})},[f,i]),ue.useEffect(()=>{if(e||!(t!=null&&t.uid))return;const M=lr(zt(Ue,"artifacts",Me,"public","data","payments"),ni("userId","==",t.uid),ni("status","==","Pendiente"),ni("isRenewal","==",!0)),U=Zt(M,ee=>{const fe=new Set;ee.docs.forEach(Q=>{const w=Q.data();w.serviceId&&fe.add(w.serviceId)}),m(fe)},ee=>{console.error("Error loading pending renewals:",ee)});return()=>U()},[t==null?void 0:t.uid,e]);const b=M=>{if(!M.dueDate||!M.billingCycle||M.billingCycle==="One-Time")return M.expirationDate?new Date(M.expirationDate.seconds*1e3):null;const U=new Date(M.dueDate.seconds*1e3);let ee=new Date(U);switch(M.billingCycle){case"Monthly":ee.setMonth(ee.getMonth()+1);break;case"Semiannually":ee.setMonth(ee.getMonth()+6);break;case"Annually":ee.setFullYear(ee.getFullYear()+1);break;case"Biennially":ee.setFullYear(ee.getFullYear()+2);break;case"Triennially":ee.setFullYear(ee.getFullYear()+3);break;default:return null}return ee},I=M=>M.billingCycle==="One-Time"?M.dueDate?new Date(M.dueDate.seconds*1e3):null:b(M);ue.useEffect(()=>{if(e){s([{id:"demo1",serviceNumber:"SRV-241017-123456",serviceType:"Hosting Bsico",description:"Plan Bsico - 1GB",amount:5e4,currency:"COP",status:"Activo",dueDate:{seconds:Date.now()/1e3+30*24*60*60},billingCycle:"Monthly",clientNotes:"Servicio de hosting bsico"},{id:"demo2",serviceNumber:"SRV-241017-789012",serviceType:"Dominio",description:"midominio.com",amount:15e4,currency:"COP",status:"Activo",dueDate:{seconds:Date.now()/1e3+10*24*60*60},billingCycle:"Annually",clientNotes:"Renovacin de dominio"}]),l({renewalSettings:{enabled:!0,maxRenewalYears:3,autoRenewal:!0,gracePeriodDays:7,reminderDays:3},discounts:{monthly:{enabled:!1,discount:0,description:"Descuento por pago mensual"},quarterly:{enabled:!0,discount:5,description:"Descuento por pago trimestral"},semiAnnual:{enabled:!0,discount:10,description:"Descuento por pago semestral"},annual:{enabled:!0,discount:15,description:"Descuento por pago anual"},biennial:{enabled:!0,discount:25,description:"Descuento por pago bienal (2 aos)"},triennial:{enabled:!0,discount:35,description:"Descuento por pago trienal (3 aos)"}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"},pricingSettings:{roundToNearest:100,minimumAmount:1e3,maximumAmount:1e7}}),u(!1);return}if(!(t!=null&&t.uid)){u(!1);return}const M=lr(zt(Ue,"artifacts",Me,"public","data","services"),ni("assignedUserId","==",t.uid)),U=Zt(M,Q=>{const w=Q.docs.map(F=>({id:F.id,...F.data()}));s(w)},Q=>{console.error("Error loading services:",Q),r("Error al cargar los servicios","error")}),ee=ct(Ue,"artifacts",Me,"public","data","settings","renewalConfig"),fe=Zt(ee,Q=>{Q.exists()&&l(Q.data()),u(!1)});return()=>{U(),fe()}},[t==null?void 0:t.uid,e,r]);const O=(M,U)=>{var F,D;if(!((D=(F=o==null?void 0:o.discounts)==null?void 0:F[U])!=null&&D.enabled))return M;const ee=o.discounts[U],fe=M*ee.discount/100,Q=M-fe,w=Math.round(Q/o.pricingSettings.roundToNearest)*o.pricingSettings.roundToNearest;return Math.max(w,o.pricingSettings.minimumAmount)},V=M=>{var U;if(!((U=o==null?void 0:o.taxSettings)!=null&&U.ivaEnabled)||o.taxSettings.ivaIncluded)return M;{const ee=M*o.taxSettings.ivaPercentage/100;return M+ee}},ne=M=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(M),le=M=>{const U=I(M);if(!U)return 0;const ee=new Date,fe=U.getTime()-ee.getTime();return Math.ceil(fe/(1e3*60*60*24))},z=M=>{switch(M){case"Activo":return"bg-green-100 text-green-800";case"Periodo de Gracia Vencido":return"bg-yellow-100 text-yellow-800";case"Pendiente Pago":return"bg-orange-100 text-orange-800";case"Pago":return"bg-blue-100 text-blue-800";case"Cancelado":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},T=M=>{switch(M){case"Monthly":return 1;case"Quarterly":return 3;case"Semi-Annual":return 6;case"Annually":return 12;case"Biennial":return 24;case"Triennial":return 36;case"One-Time":return 0;default:return 1}},k=(M,U)=>{var Q;const ee=T(M.billingCycle),fe=((Q=C.find(w=>w.key===U))==null?void 0:Q.months)||0;return ee===0?!1:fe>=ee},N=(M,U)=>{var F;const ee=I(M);if(!ee)return{startDate:null,endDate:null};const fe=((F=C.find(D=>D.key===U))==null?void 0:F.months)||0,Q=new Date(ee),w=new Date(Q);return w.setMonth(w.getMonth()+fe),{startDate:Q,endDate:w}},S=(M,U)=>{var Q;const ee=T(M.billingCycle);return ee===0?"Volver a Comprar":(((Q=C.find(w=>w.key===U))==null?void 0:Q.months)||0)<ee?"Perodo Insuficiente":"Renovar"},P=()=>{window.location.href="#payments"},R=M=>{if(!M)return null;if(M.gateways)return M.gateways;const{bold:U,paypal:ee,payu:fe,bankTransfer:Q}=M,w={};return U&&(w.bold={name:"Bold",...U}),ee&&(w.paypal={name:"PayPal",...ee}),fe&&(w.payu={name:"PayU",...fe}),Q&&(w.bankTransfer={name:"Transferencia Bancaria",...Q}),w},[$,H]=ue.useState(null);ue.useEffect(()=>{if(e){H({gateways:{bankTransfer:{enabled:!0,name:"Transferencia Bancaria"}}});return}const M=ct(Ue,"artifacts",Me,"public","data","settings","paymentConfig"),U=Zt(M,ee=>{ee.exists()&&H(ee.data())});return()=>U()},[e]);const Y=async(M,U)=>{var ee,fe,Q,w,F;if(e){const D=S(M,U);r(`${D} ${(ee=C.find(K=>K.key===U))==null?void 0:ee.label} iniciada (modo demo)`,"success");return}if(v.has(M.id)){r("Ya tienes una solicitud de renovacin pendiente para este servicio","warning");return}if(E){r("Ya se est procesando una solicitud de renovacin","warning");return}A(!0);try{const{startDate:D,endDate:K}=N(M,U),te=M.amount,oe=O(te,U),he=V(oe);let pe=$&&R($);const ve=pe?Object.values(pe).filter(He=>He.enabled):[];let Ee="Pendiente de Seleccin",Ve="Renovacin";ve.length===1&&(Ee=ve[0].name,Ve=ve[0].name);const ze=M.currency||"USD",Ne={userId:t.uid,serviceId:M.id,serviceName:M.serviceType,serviceType:M.serviceType,serviceDescription:M.description,serviceNumber:M.serviceNumber,amount:he,originalAmount:te,discount:te-oe,currency:ze,status:"Pendiente",paymentMethod:Ve,paymentType:"Renovacin",gateway:Ee,transactionId:null,dueDate:dt.fromDate(new Date(D)),renewalPeriod:((fe=C.find(He=>He.key===U))==null?void 0:fe.label)||U,renewalMonths:((Q=C.find(He=>He.key===U))==null?void 0:Q.months)||0,startDate:dt.fromDate(new Date(D)),endDate:dt.fromDate(new Date(K)),createdAt:dt.now(),updatedAt:dt.now(),notes:`Renovacin de ${(w=C.find(He=>He.key===U))==null?void 0:w.label} para el servicio ${M.serviceType}`,isRenewal:!0},ae=zt(Ue,`artifacts/${Me}/public/data/payments`);await xa(ae,Ne);const ht={service:M,period:U,startDate:D,endDate:K,originalPrice:te,discountedPrice:oe,finalPrice:he};localStorage.setItem("renewalData",JSON.stringify(ht));const et=S(M,U);r(`${et} ${(F=C.find(He=>He.key===U))==null?void 0:F.label} - Redirigiendo a pagos`,"success"),m(He=>new Set([...He,M.id])),setTimeout(()=>{window.location.href="#payments"},1500)}catch(D){console.error("Error creating renewal payment:",D),r("Error al crear la solicitud de renovacin. Intenta nuevamente.","error")}finally{A(!1)}};return c?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("main",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(ll,{}),"Renovaciones de Servicios"]})}),i.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(ll,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes servicios para renovar"}),a.jsx("p",{className:"text-gray-500",children:"Contacta al administrador para que te asigne servicios."})]}):a.jsx("div",{className:"space-y-6",children:i.map(M=>{const U=le(M),ee=U<=30&&U>0,fe=U<=0,Q=f&&f.id===M.id;return a.jsxs("div",{id:`service-${M.id}`,className:`bg-white rounded-xl shadow-lg p-6 ${Q?"ring-2 ring-blue-500 border-blue-200":""}`,children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:M.serviceType}),Q&&a.jsx("span",{className:"px-2 py-1 text-xs font-semibold text-blue-700 bg-blue-100 rounded-full",children:"Seleccionado"})]}),a.jsx("p",{className:"text-sm text-gray-500 font-mono",children:M.serviceNumber}),a.jsx("p",{className:"text-sm text-gray-600",children:M.description})]}),a.jsx("div",{className:"mt-2 md:mt-0",children:a.jsx("span",{className:`px-3 py-1 text-sm font-semibold rounded-full ${z(M.status)}`,children:M.status})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Precio Actual:"}),a.jsx("div",{className:"font-semibold text-lg text-gray-900",children:ne(M.amount)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:M.billingCycle==="One-Time"?"Fecha de Inicio:":"Fecha de Vencimiento:"}),a.jsx("div",{className:`font-semibold ${fe?"text-red-600":ee?"text-orange-600":"text-gray-900"}`,children:(()=>{const w=I(M);return w?w.toLocaleDateString():"N/A"})()}),a.jsx("div",{className:"text-xs text-gray-500",children:fe?"Vencido":ee?`${U} das restantes`:`${U} das restantes`})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Ciclo Actual:"}),a.jsx("div",{className:"font-semibold text-gray-900",children:M.billingCycle})]})]}),a.jsxs("div",{className:"border-t pt-6",children:[a.jsxs("h4",{className:"text-md font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(aS,{}),T(M.billingCycle)===0?"Opciones de Compra":"Opciones de Renovacin"]}),T(M.billingCycle)===0?a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.725-1.36 3.49 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Servicio de Pago nico"}),a.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:a.jsx("p",{children:'Este servicio es de pago nico. Para volver a adquirirlo, contacta al administrador o selecciona "Volver a Comprar" si est disponible.'})})]})]})}):a.jsxs("div",{className:"space-y-4",children:[(()=>{var F,D;const w=C.find(K=>T(M.billingCycle)===K.months);if(w){const K=M.amount,te=O(K,w.key),oe=V(te),he=(F=o==null?void 0:o.discounts)==null?void 0:F[w.key],pe=K-te,{startDate:ve,endDate:Ee}=N(M,w.key);return a.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h5",{className:"font-semibold text-blue-900 flex items-center gap-2",children:[a.jsx(ll,{className:"h-4 w-4"}),"Renovacin de Perodo Actual"]}),a.jsx("span",{className:"px-3 py-1 bg-blue-200 text-blue-800 text-sm font-semibold rounded-full",children:w.label})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[a.jsxs("div",{children:["Precio base: ",ne(K)]}),(he==null?void 0:he.enabled)&&pe>0&&a.jsxs("div",{className:"text-green-600",children:["Ahorras: ",ne(pe)]})]}),a.jsx("div",{className:"font-bold text-xl text-blue-600",children:ne(oe)}),((D=o==null?void 0:o.taxSettings)==null?void 0:D.ivaEnabled)&&a.jsx("div",{className:"text-xs text-gray-500",children:o.taxSettings.ivaIncluded?"IVA incluido":`+ ${o.taxSettings.taxName} ${o.taxSettings.ivaPercentage}%`})]}),a.jsx("div",{children:ve&&Ee&&a.jsxs("div",{className:"p-3 bg-white border border-blue-200 rounded-lg",children:[a.jsx("div",{className:"text-xs font-medium text-blue-800 mb-2",children:"Fechas de Renovacin:"}),a.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[a.jsxs("div",{children:["Fecha de Vencimiento: ",ve.toLocaleDateString()]}),a.jsxs("div",{children:["Fecha Nueva Renovacin: ",Ee.toLocaleDateString()]})]})]})})]}),v.has(M.id)?a.jsx("button",{onClick:P,className:"w-full mt-4 px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-colors",children:"Ver Solicitud Pendiente"}):a.jsx("button",{onClick:()=>Y(M,w.key),disabled:E,className:`w-full mt-4 px-6 py-3 font-semibold rounded-lg transition-colors ${E?"bg-gray-400 text-white cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:E?"Creando...":`Renovar ${w.label}`})]})}return null})(),a.jsxs("div",{children:[a.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-3",children:"Otras Opciones de Renovacin:"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:C.map(w=>{var ze,Ne,ae;const F=M.amount,D=O(F,w.key),K=V(D),te=(ze=o==null?void 0:o.discounts)==null?void 0:ze[w.key],oe=F-D,he=k(M,w),pe=S(M,w),ve=T(M.billingCycle)===w.months,Ee=!((Ne=o==null?void 0:o.discounts)!=null&&Ne[w.key])||o.discounts[w.key].enabled,Ve=he&&!ve&&Ee;return Ve?a.jsxs("div",{className:"border rounded-lg p-4 transition-shadow border-gray-200 hover:shadow-md",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h5",{className:"font-medium text-gray-800",children:w.label}),(te==null?void 0:te.enabled)&&Ve&&a.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-semibold rounded-full",children:["-",te.discount,"%"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsxs("div",{children:["Precio base: ",ne(F)]}),(te==null?void 0:te.enabled)&&oe>0&&a.jsxs("div",{className:"text-green-600",children:["Ahorras: ",ne(oe)]})]}),a.jsx("div",{className:"font-semibold text-lg text-blue-600",children:ne(K)}),((ae=o==null?void 0:o.taxSettings)==null?void 0:ae.ivaEnabled)&&a.jsx("div",{className:"text-xs text-gray-500",children:o.taxSettings.ivaIncluded?"IVA incluido":`+ ${o.taxSettings.taxName} ${o.taxSettings.ivaPercentage}%`}),(()=>{const{startDate:ht,endDate:et}=N(M,w);return ht&&et?a.jsxs("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx("div",{className:"text-xs font-medium text-blue-800 mb-2",children:"Fechas de Renovacin:"}),a.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[a.jsxs("div",{children:["Fecha de Vencimiento: ",ht.toLocaleDateString()]}),a.jsxs("div",{children:["Fecha Nueva Renovacin: ",et.toLocaleDateString()]})]})]}):null})(),v.has(M.id)?a.jsx("button",{onClick:P,className:"w-full px-4 py-2 rounded-md text-sm font-medium bg-green-600 text-white hover:bg-green-700",children:"Ver Solicitud"}):a.jsx("button",{onClick:()=>Y(M,w.key),disabled:E,className:`w-full px-4 py-2 rounded-md text-sm font-medium ${E?"bg-gray-400 text-white cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:E?"Creando...":`${pe} ${w.label}`})]})]},w.key):null})})]})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h5",{className:"font-medium text-gray-800 mb-2",children:"Informacin Importante"}),a.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[a.jsxs("li",{children:[" ",a.jsx("strong",{children:'La "Renovacin de Perodo Actual" siempre est disponible y destacada'})]}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"Fecha de Vencimiento"}),": Fecha actual de vencimiento del servicio"]}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"Fecha Nueva Renovacin"}),": Fecha calculada despus de sumar el perodo"]}),a.jsx("li",{children:" Los descuentos se aplican automticamente segn el perodo seleccionado (si estn configurados)"}),a.jsx("li",{children:" Los precios se redondean para evitar decimales"}),a.jsx("li",{children:" El IVA se calcula segn la configuracin actual"}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"La renovacin extiende el servicio desde la fecha de vencimiento actual"})]}),a.jsx("li",{children:" El perodo de renovacin no puede ser inferior al ciclo actual del servicio"}),a.jsx("li",{children:' Los servicios de pago nico requieren "Volver a Comprar" en lugar de renovar'}),a.jsx("li",{children:" Al seleccionar una renovacin, sers redirigido a la seccin de pagos para proceder"})]})]})]},M.id)})})]})}function gM({user:t,isDemo:e,userProfile:n}){const{addNotification:r}=xn(),[i,s]=ue.useState([]),[o,l]=ue.useState(!0),[c,u]=ue.useState(!1),[f,g]=ue.useState(null),[v,m]=ue.useState(!1),[E,A]=ue.useState({subject:"",department:"Soporte Tcnico",priority:"Media",description:""}),C=["Soporte Tcnico","Facturacin","Ventas","General"],b=["Baja","Media","Alta","Crtica"];ue.useEffect(()=>{if(e){s([{id:"ticket1",ticketNumber:"TKT-2024-001",subject:"Problema con el acceso al panel de cliente",description:"No puedo acceder a mi panel de cliente desde ayer. Me aparece un error 500.",status:"Abierto",priority:"Alta",department:"Soporte Tcnico",clientId:(t==null?void 0:t.uid)||"demo",clientName:(n==null?void 0:n.fullName)||"Usuario Demo",clientEmail:(t==null?void 0:t.email)||"demo@ejemplo.com",assignedTo:null,assignedToName:null,createdAt:{seconds:Date.now()/1e3-3600},updatedAt:{seconds:Date.now()/1e3-3600},lastReplyAt:{seconds:Date.now()/1e3-3600},lastReplyBy:"Cliente",replyCount:0,attachments:[]},{id:"ticket2",ticketNumber:"TKT-2024-002",subject:"Consulta sobre facturacin",description:"Necesito una copia de mi factura del mes pasado para contabilidad.",status:"Respondido",priority:"Media",department:"Facturacin",clientId:(t==null?void 0:t.uid)||"demo",clientName:(n==null?void 0:n.fullName)||"Usuario Demo",clientEmail:(t==null?void 0:t.email)||"demo@ejemplo.com",assignedTo:"admin1",assignedToName:"Admin Principal",createdAt:{seconds:Date.now()/1e3-7200},updatedAt:{seconds:Date.now()/1e3-1800},lastReplyAt:{seconds:Date.now()/1e3-1800},lastReplyBy:"Admin Principal",replyCount:2,attachments:["factura_enero.pdf"]}]),l(!1);return}if(!(t!=null&&t.uid)){l(!1);return}const N=lr(zt(Ue,"artifacts",Me,"public","data","tickets"),ni("clientId","==",t.uid)),S=Zt(N,P=>{const R=P.docs.map($=>({id:$.id,...$.data()}));R.sort(($,H)=>{var U,ee;const Y=((U=$.createdAt)==null?void 0:U.seconds)||0;return(((ee=H.createdAt)==null?void 0:ee.seconds)||0)-Y}),s(R),l(!1)},P=>{console.error("Error loading tickets:",P),r("Error al cargar los tickets","error"),l(!1)});return()=>S()},[t==null?void 0:t.uid,e,r,n]);const I=async N=>{if(N.preventDefault(),console.log(" handleCreateTicket llamado - Iniciando creacin de ticket"),e){console.log(" Modo demo activado - saltando envo de emails"),r("Ticket creado (modo demo)","success"),u(!1),A({subject:"",department:"Soporte Tcnico",priority:"Media",description:""});return}try{console.log(" Creando ticket en Firestore...");const S={...E,ticketNumber:`TKT-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,status:"Abierto",clientId:t.uid,clientName:(n==null?void 0:n.fullName)||t.email,clientEmail:t.email,assignedTo:null,assignedToName:null,createdAt:dt.now(),updatedAt:dt.now(),lastReplyAt:dt.now(),lastReplyBy:"Cliente",replyCount:0,attachments:[]},R=(await xa(zt(Ue,"artifacts",Me,"public","data","tickets"),S)).id;try{console.log(" Iniciando envo de notificaciones por email para ticket:",R),await mc(),console.log(" Configuracin de email cargada");const $=(n==null?void 0:n.fullName)||t.email,H=S.ticketNumber,Y=S.subject,M=S.description,U=S.department,ee=S.priority,fe=`
          <h2>Ticket Creado Exitosamente</h2>
          <p>Estimado/a <strong>${$}</strong>,</p>
          <p>Hemos recibido tu ticket de soporte. Nuestro equipo lo revisar y te responder pronto.</p>
          <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
            <p><strong>Nmero de Ticket:</strong> ${H}</p>
            <p><strong>Asunto:</strong> ${Y}</p>
            <p><strong>Departamento:</strong> ${U}</p>
            <p><strong>Prioridad:</strong> ${ee}</p>
            <p><strong>Descripcin:</strong></p>
            <p style="white-space: pre-wrap;">${M}</p>
          </div>
          <p>Puedes hacer seguimiento a tu ticket desde tu panel de cliente.</p>
          <p>Saludos cordiales,<br>Equipo de Soporte</p>
        `;console.log(" Enviando email al cliente:",t.email);const Q=await gl({to:t.email,toName:$,subject:`Ticket Creado - ${H}`,html:fe,text:`Ticket Creado Exitosamente

Estimado/a ${$},

Hemos recibido tu ticket de soporte. Nuestro equipo lo revisar y te responder pronto.

Nmero de Ticket: ${H}
Asunto: ${Y}
Departamento: ${U}
Prioridad: ${ee}

Descripcin:
${M}

Puedes hacer seguimiento a tu ticket desde tu panel de cliente.

Saludos cordiales,
Equipo de Soporte`,type:"Notificacin",recipientType:"Cliente",module:"tickets",event:"ticketReply",metadata:{ticketId:R,ticketNumber:H}});console.log(" Resultado email cliente:",Q);const w=`
          <h2>Nuevo Ticket Creado</h2>
          <p>Se ha creado un nuevo ticket de soporte que requiere atencin.</p>
          <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
            <p><strong>Nmero de Ticket:</strong> ${H}</p>
            <p><strong>Cliente:</strong> ${$} (${t.email})</p>
            <p><strong>Asunto:</strong> ${Y}</p>
            <p><strong>Departamento:</strong> ${U}</p>
            <p><strong>Prioridad:</strong> ${ee}</p>
            <p><strong>Descripcin:</strong></p>
            <p style="white-space: pre-wrap;">${M}</p>
          </div>
          <p>Por favor, revisa y asigna el ticket desde el panel de administracin.</p>
        `,F=await mc(),D=(F==null?void 0:F.fromEmail)||t.email;console.log(" Enviando email al administrador:",D);const K=await gl({to:D,toName:(F==null?void 0:F.fromName)||"Administrador",subject:`Nuevo Ticket - ${H} - ${Y}`,html:w,text:`Nuevo Ticket Creado

Se ha creado un nuevo ticket de soporte que requiere atencin.

Nmero de Ticket: ${H}
Cliente: ${$} (${t.email})
Asunto: ${Y}
Departamento: ${U}
Prioridad: ${ee}

Descripcin:
${M}

Por favor, revisa y asigna el ticket desde el panel de administracin.`,type:"Notificacin",recipientType:"Administrador",module:"tickets",event:"newTicket",metadata:{ticketId:R,ticketNumber:H,clientEmail:t.email,clientName:$}});console.log(" Resultado email administrador:",K),console.log(" Notificaciones por email completadas")}catch($){console.error(" Error sending ticket notification emails:",$),console.error(" Detalles del error:",$.message,$.stack)}r("Ticket creado exitosamente","success"),u(!1),A({subject:"",department:"Soporte Tcnico",priority:"Media",description:""})}catch(S){console.error("Error creating ticket:",S),r("Error al crear el ticket","error")}},O=N=>{g(N),m(!0)},V=async N=>{if(e){s(S=>S.map(P=>P.id===N?{...P,status:"Cerrado",updatedAt:{seconds:Date.now()/1e3}}:P)),r("Ticket cerrado (modo demo)","success");return}try{const S=ct(Ue,"artifacts",Me,"public","data","tickets",N);await fr(S,{status:"Cerrado",updatedAt:dt.now()}),r("Ticket cerrado exitosamente","success")}catch(S){console.error("Error closing ticket:",S),r("Error al cerrar el ticket","error")}},ne=N=>({Abierto:"bg-red-100 text-red-800","En Progreso":"bg-yellow-100 text-yellow-800",Respondido:"bg-blue-100 text-blue-800",Cerrado:"bg-gray-100 text-gray-800","Esperando Cliente":"bg-orange-100 text-orange-800"})[N]||"bg-gray-100 text-gray-800",le=N=>({Baja:"bg-green-100 text-green-800",Media:"bg-yellow-100 text-yellow-800",Alta:"bg-orange-100 text-orange-800",Crtica:"bg-red-100 text-red-800"})[N]||"bg-gray-100 text-gray-800",z=N=>({"Soporte Tcnico":"bg-blue-100 text-blue-800",Facturacin:"bg-green-100 text-green-800",Ventas:"bg-purple-100 text-purple-800",General:"bg-gray-100 text-gray-800"})[N]||"bg-gray-100 text-gray-800",T=N=>N?new Date(N.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",k=N=>{if(!N)return"--";const S=new Date,P=new Date(N.seconds*1e3),R=S.getTime()-P.getTime(),$=Math.floor(R/(1e3*60*60*24)),H=Math.floor(R/(1e3*60*60)),Y=Math.floor(R/(1e3*60));return $>0?`hace ${$} da${$>1?"s":""}`:H>0?`hace ${H} hora${H>1?"s":""}`:Y>0?`hace ${Y} minuto${Y>1?"s":""}`:"hace unos segundos"};return o?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("main",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(tc,{}),"Mis Tickets de Soporte"]}),a.jsxs("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[a.jsx(Vh,{}),"Nuevo Ticket"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:a.jsx(ds,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Abiertos"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:i.filter(N=>N.status==="Abierto").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(gh,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Respondidos"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:i.filter(N=>N.status==="Respondido").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:a.jsx(ds,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"En Progreso"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:i.filter(N=>N.status==="En Progreso").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:a.jsx(tc,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Cerrados"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:i.filter(N=>N.status==="Cerrado").length})]})]})})]}),i.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(tc,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes tickets"}),a.jsx("p",{className:"text-gray-500 mb-4",children:"Crea tu primer ticket para obtener soporte."}),a.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Crear Primer Ticket"})]}):a.jsx("div",{className:"space-y-4",children:i.map(N=>a.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("span",{className:"font-mono text-sm font-medium text-blue-600",children:N.ticketNumber}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ne(N.status)}`,children:N.status}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${le(N.priority)}`,children:N.priority}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${z(N.department)}`,children:N.department})]}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:N.subject}),a.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:N.description}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ds,{}),a.jsxs("span",{children:["Creado ",k(N.createdAt)]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ap,{}),a.jsxs("span",{children:[N.replyCount," respuesta",N.replyCount!==1?"s":""]})]}),N.assignedToName&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(gh,{}),a.jsxs("span",{children:["Asignado a ",N.assignedToName]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>O(N),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md",title:"Ver ticket completo",children:a.jsx(pl,{})}),N.status!=="Cerrado"&&a.jsx("button",{onClick:()=>V(N.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-md",title:"Cerrar ticket",children:a.jsx(sp,{})})]})]})},N.id))}),c&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Crear Nuevo Ticket"}),a.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("form",{onSubmit:I,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto *"}),a.jsx("input",{type:"text",value:E.subject,onChange:N=>A(S=>({...S,subject:N.target.value})),className:"w-full p-2 border rounded-md",placeholder:"Describe brevemente tu problema o consulta",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento *"}),a.jsx("select",{value:E.department,onChange:N=>A(S=>({...S,department:N.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:C.map(N=>a.jsx("option",{value:N,children:N},N))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridad *"}),a.jsx("select",{value:E.priority,onChange:N=>A(S=>({...S,priority:N.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:b.map(N=>a.jsx("option",{value:N,children:N},N))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin *"}),a.jsx("textarea",{value:E.description,onChange:N=>A(S=>({...S,description:N.target.value})),className:"w-full p-2 border rounded-md",rows:6,placeholder:"Describe tu problema o consulta en detalle. Incluye cualquier informacin relevante que pueda ayudar a resolver tu ticket ms rpidamente.",required:!0})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>u(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Crear Ticket"})]})]})]})}),v&&f&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:["Ticket ",f.ticketNumber]}),a.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ne(f.status)}`,children:f.status})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prioridad"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${le(f.priority)}`,children:f.priority})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Departamento"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${z(f.department)}`,children:f.department})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Asignado a"}),a.jsx("div",{className:"text-sm text-gray-900",children:f.assignedToName||"Sin asignar"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Creado"}),a.jsx("div",{className:"text-sm text-gray-900",children:T(f.createdAt)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"ltima actividad"}),a.jsx("div",{className:"text-sm text-gray-900",children:k(f.lastReplyAt)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto"}),a.jsx("div",{className:"text-sm text-gray-900 p-3 bg-gray-50 rounded-md",children:f.subject})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin"}),a.jsx("div",{className:"text-sm text-gray-900 p-4 bg-gray-50 rounded-md whitespace-pre-wrap",children:f.description})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Historial de Mensajes"}),a.jsx("div",{className:"border border-gray-200 rounded-md p-4",children:a.jsx(ZS,{ticketId:f.id,isDemo:e,userRole:"client",currentUser:t})})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cerrar"}),f.status!=="Cerrado"&&a.jsx("button",{onClick:()=>{V(f.id),m(!1)},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Cerrar Ticket"}),a.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Responder"})]})]})]})})]})}function vM({user:t,isDemo:e,userProfile:n}){const[r,i]=ue.useState("services");ue.useEffect(()=>{const o=()=>{const l=(window.location.hash||"").replace("#","");(l==="services"||l==="payments"||l==="renewals"||l==="tickets")&&i(l)};return o(),window.addEventListener("hashchange",o),()=>window.removeEventListener("hashchange",o)},[]);const s=()=>{switch(r){case"tickets":return a.jsx(gM,{user:t,isDemo:e,userProfile:n});case"payments":return a.jsx(mM,{user:t,isDemo:e,userProfile:n});case"renewals":return a.jsx(pM,{user:t,isDemo:e,userProfile:n});case"services":default:return a.jsx(hM,{user:t,isDemo:e,userProfile:n})}};return a.jsxs("main",{className:"container mx-auto",children:[a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-8 px-4 sm:px-6 lg:px-8","aria-label":"Tabs",children:[a.jsxs("button",{onClick:()=>i("services"),className:`${r==="services"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(ip,{})," Mis Servicios"]}),a.jsxs("button",{onClick:()=>i("payments"),className:`${r==="payments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(Xi,{})," Mis Pagos"]}),a.jsxs("button",{onClick:()=>i("renewals"),className:`${r==="renewals"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(ll,{})," Renovaciones"]}),a.jsxs("button",{onClick:()=>i("tickets"),className:`${r==="tickets"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(tc,{})," Tickets de Soporte"]})]})}),s()]})}function yM({companySettings:t}){const{addNotification:e}=xn(),[n,r]=ue.useState(!0),[i,s]=ue.useState(""),[o,l]=ue.useState(""),c=async u=>{u.preventDefault();try{if(n){const f=await qm(xr,i,o),g=await ya(lr(zt(Ue,"artifacts",Me,"public","data","users"),ni("__name__","==",f.user.uid)));if(g.docs.length===0)throw new Error("No se encontr el perfil de usuario.");const v=g.docs[0].data();if(v.status==="pending"||v.status==="disabled")throw await Ql(xr),new Error("Tu cuenta est pendiente de activacin o ha sido deshabilitada.")}else{const f=await Cp(xr,i,o);await x4(f.user);const g=zt(Ue,"artifacts",Me,"public","data","users");let m=(await ya(g)).empty?"superadmin":"client";const E=m==="superadmin"?"active":"pending",A=m!=="superadmin";await ki(ct(Ue,"artifacts",Me,"public","data","users",f.user.uid),{email:i,role:m,status:E,isProfileComplete:!1,createdAt:dt.now(),fullName:"",identification:"",requiresPasswordChange:A}),m==="superadmin"?e("Registro exitoso! Eres el primer usuario y tienes permisos de superadministrador.","success"):(e("Registro exitoso! Revisa tu correo para verificar la cuenta. Un administrador debe activar tu usuario.","success"),await Ql(xr))}}catch(f){e(f.message,"error")}};return a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-sm w-full",children:[a.jsx("div",{className:"flex justify-center mb-6",children:t.logoUrl?a.jsx("img",{src:t.logoUrl,alt:"Logo de la Empresa",className:"max-h-16"}):a.jsx("h1",{className:"text-3xl font-bold",children:t.companyName||"Gestor de Pagos"})}),a.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:n?"Iniciar Sesin":"Crear Cuenta"}),a.jsxs("form",{onSubmit:c,children:[a.jsx("input",{type:"email",value:i,onChange:u=>s(u.target.value),placeholder:"Email",className:"w-full p-2 mb-4 border rounded",required:!0}),a.jsx("input",{type:"password",value:o,onChange:u=>l(u.target.value),placeholder:"Contrasea",className:"w-full p-2 mb-4 border rounded",required:!0}),a.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700",children:n?"Entrar":"Registrarse"})]}),a.jsx("button",{onClick:()=>r(!n),className:"w-full mt-4 text-sm text-blue-600 hover:underline",children:n?"No tienes cuenta? Regstrate":"Ya tienes cuenta? Inicia sesin"})]})})}function xM({companySettings:t,onLogin:e}){const{addNotification:n}=xn(),[r,i]=ue.useState(!1),s=async()=>{i(!0);try{const u=await qm(xr,"admin@test.com","admin123");e(u.user,"superadmin")}catch{n("Error al iniciar sesin como administrador. Verifica las credenciales.","error")}finally{i(!1)}},o=async()=>{i(!0);try{const u=await qm(xr,"cliente@test.com","cliente123");e(u.user,"client")}catch{n("Error al iniciar sesin como cliente. Verifica las credenciales.","error")}finally{i(!1)}};return a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-md w-full",children:[a.jsx("div",{className:"flex justify-center mb-6",children:t.logoUrl?a.jsx("img",{src:t.logoUrl,alt:"Logo de la Empresa",className:"max-h-16"}):a.jsx("h1",{className:"text-3xl font-bold",children:t.companyName||"Gestor de Cobros"})}),a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Modo de Prueba"}),a.jsx("p",{className:"text-gray-600",children:"Selecciona el tipo de usuario para probar el sistema"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("button",{onClick:s,disabled:r,className:"w-full bg-blue-600 text-white p-4 rounded-lg hover:bg-blue-700 font-semibold text-lg disabled:opacity-50 flex items-center justify-center gap-2",children:r?a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Entrar como Administrador"})]})}),a.jsx("button",{onClick:o,disabled:r,className:"w-full bg-green-600 text-white p-4 rounded-lg hover:bg-green-700 font-semibold text-lg disabled:opacity-50 flex items-center justify-center gap-2",children:r?a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Entrar como Cliente"})]})})]}),a.jsx("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:a.jsxs("p",{className:"text-sm text-yellow-800 text-center",children:[a.jsx("strong",{children:"Credenciales de Prueba:"}),a.jsx("br",{}),"Admin: admin@test.com / admin123",a.jsx("br",{}),"Cliente: cliente@test.com / cliente123"]})})]})})}function bM({isOpen:t,onSave:e}){const{addNotification:n}=xn(),[r,i]=ue.useState(""),[s,o]=ue.useState(""),[l,c]=ue.useState(""),u=async f=>{if(f.preventDefault(),r.length<6){c("La contrasea debe tener al menos 6 caracteres.");return}if(r!==s){c("Las contraseas no coinciden.");return}c("");try{await e(r),n("Contrasea cambiada exitosamente.","success")}catch{n("Error al cambiar la contrasea.","error")}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-md w-full",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Cambio de Contrasea Requerido"}),a.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Por seguridad, debes establecer una nueva contrasea para continuar."}),a.jsxs("form",{onSubmit:u,className:"space-y-4",children:[a.jsx("input",{type:"password",value:r,onChange:f=>i(f.target.value),placeholder:"Nueva Contrasea",className:"w-full p-2 border rounded-md",required:!0}),a.jsx("input",{type:"password",value:s,onChange:f=>o(f.target.value),placeholder:"Confirmar Nueva Contrasea",className:"w-full p-2 border rounded-md",required:!0}),l&&a.jsx("p",{className:"text-red-500 text-sm",children:l}),a.jsx("button",{type:"submit",className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md",children:"Guardar Contrasea"})]})]})}):null}function wM({isOpen:t,onComplete:e,user:n,userProfile:r}){const{addNotification:i}=xn(),[s,o]=ue.useState({fullName:(r==null?void 0:r.fullName)||"",identification:(r==null?void 0:r.identification)||"",phone:(r==null?void 0:r.phone)||"",address:(r==null?void 0:r.address)||""}),[l,c]=ue.useState(!1);ue.useEffect(()=>{const g=new URLSearchParams(window.location.search),v=g.get("uid");g.get("email");const m=g.get("name"),E=g.get("id");v&&v===(n==null?void 0:n.uid)&&(m||E)&&o(A=>({...A,fullName:m?decodeURIComponent(m):A.fullName,identification:E?decodeURIComponent(E):A.identification}))},[n==null?void 0:n.uid]);const u=g=>{const{name:v,value:m}=g.target;o(E=>({...E,[v]:m}))},f=async g=>{if(g.preventDefault(),!s.fullName.trim()){i("El nombre completo es obligatorio","error");return}c(!0);try{const v=ct(Ue,"artifacts",Me,"public","data","users",n.uid);await fr(v,{fullName:s.fullName.trim(),identification:s.identification.trim(),phone:s.phone.trim(),address:s.address.trim(),isProfileComplete:!0,profileCompletedAt:new Date}),i("Perfil completado exitosamente","success"),e()}catch(v){console.error("Error completing profile:",v),i("Error al completar el perfil","error")}finally{c(!1)}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Completar Perfil"}),a.jsxs("p",{className:"text-gray-600 mt-2",children:["Bienvenido ",n.email,"! Confirma o actualiza tu informacin para continuar."]})]}),a.jsxs("form",{onSubmit:f,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Completo *"}),a.jsx("input",{name:"fullName",value:s.fullName,onChange:u,placeholder:"Tu nombre completo",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Identificacin"}),a.jsx("input",{name:"identification",value:s.identification,onChange:u,placeholder:"Cdula, DNI, etc.",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telfono"}),a.jsx("input",{name:"phone",value:s.phone,onChange:u,placeholder:"+57 300 123 4567",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Direccin"}),a.jsx("input",{name:"address",value:s.address,onChange:u,placeholder:"Tu direccin",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]})]}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Informacin Importante"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[a.jsx("li",{children:" Los datos mostrados fueron configurados por el administrador"}),a.jsx("li",{children:" Puedes confirmar o modificar la informacin"}),a.jsx("li",{children:" Esta informacin se usar para la facturacin"}),a.jsx("li",{children:" Puedes actualizar estos datos ms tarde"})]})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx("button",{type:"submit",disabled:l,className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold disabled:opacity-50 flex items-center gap-2",children:l?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Completando..."]}):"Completar Perfil"})})]})]})}):null}function _M({onComplete:t}){const{addNotification:e}=xn(),[n,r]=ue.useState(1),[i,s]=ue.useState({companyName:"",identification:"",address:"",phone:"",email:"",website:""}),[o,l]=ue.useState({email:"",password:"",confirmPassword:"",fullName:"",identification:""}),[c,u]=ue.useState(!1),f=E=>{const{name:A,value:C}=E.target;s(b=>({...b,[A]:C}))},g=E=>{const{name:A,value:C}=E.target;l(b=>({...b,[A]:C}))},v=E=>{if(E.preventDefault(),!i.companyName){e("El nombre de la empresa es obligatorio","error");return}r(2)},m=async E=>{if(E.preventDefault(),o.password!==o.confirmPassword){e("Las contraseas no coinciden","error");return}if(o.password.length<6){e("La contrasea debe tener al menos 6 caracteres","error");return}u(!0);try{const A=await Cp(xr,o.email,o.password);await ki(ct(Ue,"artifacts",Me,"public","data","users",A.user.uid),{email:o.email,fullName:o.fullName,identification:o.identification,role:"superadmin",status:"active",isProfileComplete:!0,createdAt:dt.now(),requiresPasswordChange:!1}),await ki(ct(Ue,"artifacts",Me,"public","data","settings","company_info"),{...i,isDemoMode:!1,createdAt:dt.now()}),e("Configuracin inicial completada exitosamente!","success"),r(3),setTimeout(()=>{t()},2e3)}catch(A){console.error("Error en configuracin inicial:",A),e(`Error: ${A.message}`,"error")}finally{u(!1)}};return n===1?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Configuracin Inicial"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Paso 1 de 2: Informacin de la Empresa"})]}),a.jsxs("form",{onSubmit:v,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"companyName",value:i.companyName,onChange:f,placeholder:"Nombre de la Empresa *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),a.jsx("input",{name:"identification",value:i.identification,onChange:f,placeholder:"NIT / Identificacin Fiscal",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"address",value:i.address,onChange:f,placeholder:"Direccin",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"}),a.jsx("input",{name:"phone",value:i.phone,onChange:f,placeholder:"Telfono",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"email",type:"email",value:i.email,onChange:f,placeholder:"Email de Contacto",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"}),a.jsx("input",{name:"website",value:i.website,onChange:f,placeholder:"Sitio Web",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold",children:"Continuar"})})]})]})}):n===2?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Crear Superadministrador"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Paso 2 de 2: Cuenta de Administrador Principal"})]}),a.jsxs("form",{onSubmit:m,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"fullName",value:o.fullName,onChange:g,placeholder:"Nombre Completo *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),a.jsx("input",{name:"identification",value:o.identification,onChange:g,placeholder:"Identificacin",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),a.jsx("input",{name:"email",type:"email",value:o.email,onChange:g,placeholder:"Email del Administrador *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"password",type:"password",value:o.password,onChange:g,placeholder:"Contrasea *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),a.jsx("input",{name:"confirmPassword",type:"password",value:o.confirmPassword,onChange:g,placeholder:"Confirmar Contrasea *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{className:"flex justify-between pt-4",children:[a.jsx("button",{type:"button",onClick:()=>r(1),className:"px-6 py-3 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 font-semibold",children:"Atrs"}),a.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold disabled:opacity-50",children:c?"Creando...":"Completar Configuracin"})]})]})]})}):n===3?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-md w-full text-center",children:[a.jsx("div",{className:"text-green-500 text-6xl mb-4",children:""}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Configuracin Completada!"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"El sistema est listo para usar. Sers redirigido al dashboard en unos segundos..."}),a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"})]})}):null}const NM=async()=>{console.log(" Iniciando diagnstico de Firebase...");try{console.log(" Configuracin de Firebase:"),console.log("- App ID:",Me),console.log("- Auth:",xr?" Configurado":" No configurado"),console.log("- Firestore:",Ue?" Configurado":" No configurado"),console.log(`
 Verificando usuarios existentes...`);const t=zt(Ue,"artifacts",Me,"public","data","users"),e=await ya(t);if(e.empty)return console.log(" No hay usuarios en la base de datos"),{success:!1,message:"No hay usuarios registrados"};const n=e.docs.map(s=>({id:s.id,...s.data()}));console.log(" Usuarios encontrados:",n.length),n.forEach(s=>{console.log(`- ${s.email} (${s.role}) - Estado: ${s.status}`)}),console.log(`
 Verificando configuracin de empresa...`);const r=ct(Ue,"artifacts",Me,"public","data","settings","company_info"),i=await Ja(r);return i.exists()?(console.log(" Configuracin de empresa encontrada"),console.log("- Nombre:",i.data().companyName)):console.log(" No hay configuracin de empresa"),{success:!0,users:n,settings:i.exists()?i.data():null}}catch(t){return console.error(" Error en diagnstico:",t),{success:!1,error:t.message}}},eE=async(t,e,n="client")=>{try{console.log(` Creando usuario de prueba: ${t}`);const r=await Cp(xr,t,e);return await ki(ct(Ue,"artifacts",Me,"public","data","users",r.user.uid),{email:t,fullName:`Usuario ${n}`,identification:"12345678",role:n,status:"active",isProfileComplete:!0,createdAt:dt.now(),requiresPasswordChange:!1}),console.log(" Usuario creado exitosamente"),{success:!0,user:r.user}}catch(r){return console.error(" Error creando usuario:",r),{success:!1,error:r.message}}},SM=async(t,e)=>{try{console.log(` Probando login: ${t}`);const n=await qm(xr,t,e);return console.log(" Login exitoso"),await Ql(xr),console.log(" Sesin cerrada"),{success:!0,user:n.user}}catch(n){return console.error(" Error en login:",n),{success:!1,error:n.message}}},EM=async()=>{const t=[{email:"admin@test.com",password:"admin123",role:"superadmin"},{email:"cliente@test.com",password:"cliente123",role:"client"}];console.log(" Creando usuarios de prueba por defecto...");for(const e of t){const n=await eE(e.email,e.password,e.role);n.success?console.log(` ${e.email} creado`):console.log(` Error creando ${e.email}:`,n.error)}},AM=async()=>{try{console.log(" Verificando configuracin bsica...");const t=ct(Ue,"artifacts",Me,"public","data","settings","company_info");(await Ja(t)).exists()||(console.log(" Creando configuracin bsica de empresa..."),await ki(t,{companyName:"Gestor de Cobros",identification:"123.456.789-0",address:"Direccin de Prueba",phone:"+57 300 123 4567",email:"contacto@gestor-cobros.com",website:"www.gestor-cobros.com",isDemoMode:!1,createdAt:dt.now()}),console.log(" Configuracin de empresa creada"));const n=zt(Ue,"artifacts",Me,"public","data","users");return(await ya(n)).empty&&(console.log(" Creando superadmin inicial..."),await eE("admin@gestor-cobros.com","admin123","superadmin")),console.log(" Configuracin bsica completada"),{success:!0}}catch(t){return console.error(" Error en configuracin bsica:",t),{success:!1,error:t.message}}};function jM(){const[t,e]=ue.useState([]),[n,r]=ue.useState(!1),i=(v,m="info")=>{e(E=>[...E,{message:v,type:m,timestamp:new Date().toLocaleTimeString()}])},s=()=>e([]),o=async()=>{r(!0),s(),i(" Iniciando diagnstico de Firebase...","info");try{const v=await NM();v.success?(i(" Diagnstico completado exitosamente","success"),i(` Usuarios encontrados: ${v.users.length}`,"info"),v.users.forEach(m=>{i(`- ${m.email} (${m.role}) - Estado: ${m.status}`,"info")})):i(` Error en diagnstico: ${v.message}`,"error")}catch(v){i(` Error: ${v.message}`,"error")}finally{r(!1)}},l=async()=>{r(!0),s(),i(" Creando usuarios de prueba...","info");try{await EM(),i(" Usuarios de prueba creados","success")}catch(v){i(` Error: ${v.message}`,"error")}finally{r(!1)}},c=async()=>{r(!0),s(),i(" Configurando sistema bsico...","info");try{const v=await AM();v.success?i(" Configuracin bsica completada","success"):i(` Error: ${v.error}`,"error")}catch(v){i(` Error: ${v.message}`,"error")}finally{r(!1)}},u=async()=>{r(!0),s(),i(" Probando login con usuario de prueba...","info");try{const v=await SM("admin@test.com","admin123");v.success?i(" Login de prueba exitoso","success"):i(` Error en login: ${v.error}`,"error")}catch(v){i(` Error: ${v.message}`,"error")}finally{r(!1)}},f=async()=>{r(!0),s(),i(" Ejecutando diagnstico avanzado...","info");try{const v=await tS();if(v.hasUsers){i(` Usuarios encontrados: ${v.users.length}`,"success"),v.users.forEach((E,A)=>{i(` ${A+1}. ${E.email} (${E.role}) - ${E.status}`,"info")}),v.hasSettings?i(" Configuracin de empresa encontrada","success"):i(" No hay configuracin de empresa","warning");const m=await qL();m&&i(` Usuario ms antiguo: ${m.data.email} (${m.data.role})`,"info")}else i(" No hay usuarios en la base de datos","error"),v.error&&i(`Error: ${v.error}`,"error")}catch(v){i(` Error en diagnstico: ${v.message}`,"error")}finally{r(!1)}},g=v=>{switch(v){case"success":return"text-green-600";case"error":return"text-red-600";case"warning":return"text-yellow-600";default:return"text-blue-600"}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:" Diagnstico de Firebase"}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[a.jsx("button",{onClick:o,disabled:n,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:" Diagnstico"}),a.jsx("button",{onClick:f,disabled:n,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50",children:" Avanzado"}),a.jsx("button",{onClick:l,disabled:n,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50",children:" Crear Usuarios"}),a.jsx("button",{onClick:c,disabled:n,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50",children:" Configurar"}),a.jsx("button",{onClick:u,disabled:n,className:"px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 disabled:opacity-50",children:" Probar Login"})]}),a.jsx("div",{className:"mb-4",children:a.jsx("button",{onClick:s,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:" Limpiar"})}),a.jsxs("div",{className:"bg-gray-100 rounded-lg p-4 max-h-96 overflow-y-auto",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Resultados:"}),t.length===0?a.jsx("p",{className:"text-gray-500",children:"No hay resultados an. Ejecuta un diagnstico."}):a.jsx("div",{className:"space-y-1",children:t.map((v,m)=>a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-xs text-gray-400",children:v.timestamp}),a.jsx("span",{className:`text-sm ${g(v.type)}`,children:v.message})]},m))})]}),a.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Credenciales de Prueba:"}),a.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Admin:"})," admin@test.com / admin123"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Cliente:"})," cliente@test.com / cliente123"]})]})]}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:" Recargar Pgina"})})]})})}function TM(){const{addNotification:t}=xn(),[e,n]=ue.useState(null),[r,i]=ue.useState(null),[s,o]=ue.useState(!0),[l,c]=ue.useState(()=>localStorage.getItem("isDemoMode")==="true"),[u,f]=ue.useState({companyName:"Gestor de Cobros"}),[g,v]=ue.useState(!1),[m,E]=ue.useState(!1),[A,C]=ue.useState(!1);ue.useEffect(()=>{localStorage.setItem("isDemoMode",l.toString())},[l]);const b=async()=>{try{console.log(" Verificando si el sistema est configurado...");try{if((await tS()).hasUsers)return console.log(" Usuarios encontrados en Firestore"),!0}catch($){console.warn(" Error accediendo a Firestore:",$.message)}return await $L()?(console.log(" Usuarios encontrados en Authentication"),!0):(console.log(" Asumiendo que el sistema est configurado (hay errores de permisos)"),!0)}catch(R){return console.error(" Error verificando configuracin:",R),!0}};ue.useEffect(()=>{(async()=>{try{console.log(" Iniciando verificacin de configuracin..."),console.log(" Verificando configuracin de empresa...");const $=ct(Ue,"artifacts",Me,"public","data","settings","company_info"),H=await Ja($);if(H.exists()){console.log(" Configuracin de empresa encontrada");const M=H.data();console.log(" Configuracin:",M),f(M),c(M.isDemoMode||!1),E(!0),v(!1),console.log(" Sistema configurado con configuracin existente");return}console.log(" No hay configuracin, verificando si hay usuarios..."),await b()?(console.log(" Sistema ya configurado, saltando setup inicial"),f({companyName:"Gestor de Cobros",isDemoMode:!1}),E(!0),v(!1)):(console.log(" Sistema no configurado, mostrando setup inicial"),v(!0))}catch($){console.error(" Error checking configuration:",$),$.code==="permission-denied"&&(console.error(" Error de permisos de Firestore. Verifica que las reglas estn configuradas correctamente."),console.error(" Consulta firebase-rules.txt para las reglas necesarias.")),console.log(" Error en verificacin, asumiendo que el sistema est configurado"),f({companyName:"Gestor de Cobros",isDemoMode:!1}),E(!0),v(!1)}})()},[]),ue.useEffect(()=>{if(!m)return;if(l){n({email:"superadmin@demo.com",uid:"demouser"}),i({role:"superadmin"}),o(!1);return}const R=GC(xr,$=>{if($){const H=ct(Ue,"artifacts",Me,"public","data","users",$.uid),Y=Zt(H,async M=>{if(M.exists()){const U=M.data();U.status==="active"||U.role==="superadmin"?(i(U),n($)):(console.warn("Usuario inactivo o sin permisos:",U),t("Tu cuenta no est activa. Contacta al administrador.","error"),Ql(xr))}else console.warn("No se encontr el perfil de usuario en la base de datos"),console.log("Usuario no tiene perfil en Firestore, cerrando sesin..."),t("Usuario no encontrado en el sistema. Contacta al administrador.","error"),Ql(xr);o(!1)},M=>{console.error("Error fetching user data:",M),M.code==="permission-denied"&&(console.error(" Error de permisos de Firestore al obtener datos del usuario."),console.error(" Verifica que las reglas de Firestore permitan lectura/escritura para usuarios autenticados."),t("Error de permisos al acceder a datos del usuario. Verifica las reglas de Firestore.","error")),$&&t("Error al cargar el perfil de usuario. Intenta nuevamente.","error"),o(!1)});return()=>Y()}else n(null),i(null),o(!1)});return()=>{R()}},[m,l]);const I=async R=>{const $=xr.currentUser;if($)try{await qC($,R);const H=ct(Ue,"artifacts",Me,"public","data","users",$.uid);await fr(H,{requiresPasswordChange:!1})}catch(H){console.error("Error updating password:",H),t("Hubo un error al cambiar la contrasea.","error"),Ql(xr)}},O=()=>{l?(n(null),i(null)):Ql(xr)},V=(u==null?void 0:u.inactivityTimeoutMinutes)||10;GL(()=>{t(`Sesin cerrada por inactividad (${V} minutos sin actividad)`,"warning"),setTimeout(()=>{O()},1e3)},V,!!(e&&!l));const le=(R,$)=>{n(R),i({role:$,status:"active"})},z=()=>{v(!1),E(!0),window.location.reload()};if(g)return a.jsx(_M,{onComplete:z});if(A)return a.jsx(jM,{onClose:()=>C(!1)});if(s)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"Cargando..."});const T=l?{email:"superadmin@demo.com",uid:"demouser"}:e,k=l?"superadmin":r==null?void 0:r.role;if(r!=null&&r.requiresPasswordChange&&!l)return a.jsx(bM,{isOpen:!0,onSave:I});const S=new URLSearchParams(window.location.search).get("uid"),P=S&&S===(e==null?void 0:e.uid);return(r==null?void 0:r.role)==="client"&&!l&&(!(r!=null&&r.isProfileComplete)&&(r==null?void 0:r.requiresPasswordChange)===!1||P)?a.jsx(wM,{isOpen:!0,onComplete:()=>{i(R=>({...R,isProfileComplete:!0})),P&&window.history.replaceState({},document.title,window.location.pathname)},user:e,userProfile:r}):a.jsx("div",{className:"bg-gray-50 min-h-screen font-sans text-gray-800",children:T?a.jsxs(a.Fragment,{children:[a.jsx("header",{className:"bg-white shadow-md",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center",children:[u.logoUrl?a.jsx("img",{src:u.logoUrl,alt:u.companyName,className:"max-h-10"}):a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:u.companyName}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("span",{className:"text-sm text-gray-600 hidden sm:block",children:T.email}),a.jsx("button",{onClick:O,className:"text-gray-500 hover:text-red-600",children:a.jsx(KL,{})})]})]})}),l&&a.jsx("div",{className:"bg-yellow-400 text-center p-2 text-sm font-semibold",children:"MODO DE PRUEBA ACTIVO"}),k==="superadmin"||k==="admin"?a.jsx(uM,{user:T,isDemo:l,setIsDemoMode:c,userRole:k,companySettings:u,onLogout:O}):a.jsx(vM,{user:T,isDemo:l,userProfile:r})]}):a.jsxs("div",{className:"flex flex-col min-h-screen",children:[l&&a.jsx("div",{className:"bg-yellow-400 text-center p-3 text-sm font-semibold",children:" MODO DEMO ACTIVO - Usa los botones de prueba para acceder"}),a.jsx("div",{className:"flex-grow",children:l?a.jsx(xM,{companySettings:u,onLogin:le}):a.jsx(yM,{companySettings:u})}),(u.isDemoMode||u.allowDemoMode)&&a.jsxs("div",{className:"fixed bottom-4 right-4 flex flex-col gap-2",children:[a.jsx("button",{onClick:()=>c(!l),className:`px-4 py-2 rounded-lg shadow-lg text-sm font-medium transition-colors ${l?"bg-green-600 text-white hover:bg-green-700":"bg-yellow-600 text-white hover:bg-yellow-700"}`,title:l?"Cambiar a modo Live":"Cambiar a modo Demo",children:l?" Live":" Demo"}),a.jsx("button",{onClick:()=>C(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg shadow-lg hover:bg-red-700 text-sm",title:"Diagnstico de Firebase",children:" Debug"})]})]})})}function kM(){return a.jsx(WL,{children:a.jsx(TM,{})})}S0.createRoot(document.getElementById("root")).render(a.jsx(nA.StrictMode,{children:a.jsx(kM,{})}));export{hn as _,IM as c,UE as g};
