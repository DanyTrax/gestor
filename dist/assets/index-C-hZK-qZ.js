var $S=Object.defineProperty;var zS=(t,e,n)=>e in t?$S(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var dn=(t,e,n)=>zS(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var qO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var P5={exports:{}},hp={},R5={exports:{}},Vt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wh=Symbol.for("react.element"),HS=Symbol.for("react.portal"),WS=Symbol.for("react.fragment"),GS=Symbol.for("react.strict_mode"),KS=Symbol.for("react.profiler"),YS=Symbol.for("react.provider"),QS=Symbol.for("react.context"),XS=Symbol.for("react.forward_ref"),JS=Symbol.for("react.suspense"),ZS=Symbol.for("react.memo"),e3=Symbol.for("react.lazy"),U2=Symbol.iterator;function t3(t){return t===null||typeof t!="object"?null:(t=U2&&t[U2]||t["@@iterator"],typeof t=="function"?t:null)}var L5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D5=Object.assign,O5={};function Iu(t,e,n){this.props=t,this.context=e,this.refs=O5,this.updater=n||L5}Iu.prototype.isReactComponent={};Iu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Iu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function M5(){}M5.prototype=Iu.prototype;function t1(t,e,n){this.props=t,this.context=e,this.refs=O5,this.updater=n||L5}var n1=t1.prototype=new M5;n1.constructor=t1;D5(n1,Iu.prototype);n1.isPureReactComponent=!0;var V2=Array.isArray,F5=Object.prototype.hasOwnProperty,r1={current:null},U5={key:!0,ref:!0,__self:!0,__source:!0};function V5(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)F5.call(e,r)&&!U5.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:wh,type:t,key:s,ref:o,props:i,_owner:r1.current}}function n3(t,e){return{$$typeof:wh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function i1(t){return typeof t=="object"&&t!==null&&t.$$typeof===wh}function r3(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var B2=/\/+/g;function yg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?r3(""+t.key):e.toString(36)}function Vf(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case wh:case HS:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+yg(o,0):r,V2(i)?(n="",t!=null&&(n=t.replace(B2,"$&/")+"/"),Vf(i,e,n,"",function(u){return u})):i!=null&&(i1(i)&&(i=n3(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(B2,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",V2(t))for(var l=0;l<t.length;l++){s=t[l];var c=r+yg(s,l);o+=Vf(s,e,n,c,i)}else if(c=t3(t),typeof c=="function")for(t=c.call(t),l=0;!(s=t.next()).done;)s=s.value,c=r+yg(s,l++),o+=Vf(s,e,n,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function lf(t,e,n){if(t==null)return t;var r=[],i=0;return Vf(t,r,"","",function(s){return e.call(n,s,i++)}),r}function i3(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var gi={current:null},Bf={transition:null},s3={ReactCurrentDispatcher:gi,ReactCurrentBatchConfig:Bf,ReactCurrentOwner:r1};function B5(){throw Error("act(...) is not supported in production builds of React.")}Vt.Children={map:lf,forEach:function(t,e,n){lf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return lf(t,function(){e++}),e},toArray:function(t){return lf(t,function(e){return e})||[]},only:function(t){if(!i1(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Vt.Component=Iu;Vt.Fragment=WS;Vt.Profiler=KS;Vt.PureComponent=t1;Vt.StrictMode=GS;Vt.Suspense=JS;Vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=s3;Vt.act=B5;Vt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=D5({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=r1.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)F5.call(e,c)&&!U5.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:wh,type:t.type,key:i,ref:s,props:r,_owner:o}};Vt.createContext=function(t){return t={$$typeof:QS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:YS,_context:t},t.Consumer=t};Vt.createElement=V5;Vt.createFactory=function(t){var e=V5.bind(null,t);return e.type=t,e};Vt.createRef=function(){return{current:null}};Vt.forwardRef=function(t){return{$$typeof:XS,render:t}};Vt.isValidElement=i1;Vt.lazy=function(t){return{$$typeof:e3,_payload:{_status:-1,_result:t},_init:i3}};Vt.memo=function(t,e){return{$$typeof:ZS,type:t,compare:e===void 0?null:e}};Vt.startTransition=function(t){var e=Bf.transition;Bf.transition={};try{t()}finally{Bf.transition=e}};Vt.unstable_act=B5;Vt.useCallback=function(t,e){return gi.current.useCallback(t,e)};Vt.useContext=function(t){return gi.current.useContext(t)};Vt.useDebugValue=function(){};Vt.useDeferredValue=function(t){return gi.current.useDeferredValue(t)};Vt.useEffect=function(t,e){return gi.current.useEffect(t,e)};Vt.useId=function(){return gi.current.useId()};Vt.useImperativeHandle=function(t,e,n){return gi.current.useImperativeHandle(t,e,n)};Vt.useInsertionEffect=function(t,e){return gi.current.useInsertionEffect(t,e)};Vt.useLayoutEffect=function(t,e){return gi.current.useLayoutEffect(t,e)};Vt.useMemo=function(t,e){return gi.current.useMemo(t,e)};Vt.useReducer=function(t,e,n){return gi.current.useReducer(t,e,n)};Vt.useRef=function(t){return gi.current.useRef(t)};Vt.useState=function(t){return gi.current.useState(t)};Vt.useSyncExternalStore=function(t,e,n){return gi.current.useSyncExternalStore(t,e,n)};Vt.useTransition=function(){return gi.current.useTransition()};Vt.version="18.3.1";R5.exports=Vt;var ue=R5.exports;const a3=qS(ue);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o3=ue,l3=Symbol.for("react.element"),c3=Symbol.for("react.fragment"),u3=Object.prototype.hasOwnProperty,d3=o3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h3={key:!0,ref:!0,__self:!0,__source:!0};function $5(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)u3.call(e,r)&&!h3.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:l3,type:t,key:s,ref:o,props:i,_owner:d3.current}}hp.Fragment=c3;hp.jsx=$5;hp.jsxs=$5;P5.exports=hp;var a=P5.exports,S0={},z5={exports:{}},es={},q5={exports:{}},H5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(q,H){var X=q.length;q.push(H);e:for(;0<X;){var ne=X-1>>>1,w=q[ne];if(0<i(w,H))q[ne]=H,q[X]=w,X=ne;else break e}}function n(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var H=q[0],X=q.pop();if(X!==H){q[0]=X;e:for(var ne=0,w=q.length,S=w>>>1;ne<S;){var V=2*(ne+1)-1,ee=q[V],re=V+1,ce=q[re];if(0>i(ee,X))re<w&&0>i(ce,ee)?(q[ne]=ce,q[re]=X,ne=re):(q[ne]=ee,q[V]=X,ne=V);else if(re<w&&0>i(ce,X))q[ne]=ce,q[re]=X,ne=re;else break e}}return H}function i(q,H){var X=q.sortIndex-H.sortIndex;return X!==0?X:q.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],f=1,v=null,g=3,p=!1,T=!1,k=!1,C=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(q){for(var H=n(u);H!==null;){if(H.callback===null)r(u);else if(H.startTime<=q)r(u),H.sortIndex=H.expirationTime,e(c,H);else break;H=n(u)}}function D(q){if(k=!1,R(q),!T)if(n(c)!==null)T=!0,K(Z);else{var H=n(u);H!==null&&z(D,H.startTime-q)}}function Z(q,H){T=!1,k&&(k=!1,b(j),j=-1),p=!0;var X=g;try{for(R(H),v=n(c);v!==null&&(!(v.expirationTime>H)||q&&!A());){var ne=v.callback;if(typeof ne=="function"){v.callback=null,g=v.priorityLevel;var w=ne(v.expirationTime<=H);H=t.unstable_now(),typeof w=="function"?v.callback=w:v===n(c)&&r(c),R(H)}else r(c);v=n(c)}if(v!==null)var S=!0;else{var V=n(u);V!==null&&z(D,V.startTime-H),S=!1}return S}finally{v=null,g=X,p=!1}}var le=!1,U=null,j=-1,_=5,F=-1;function A(){return!(t.unstable_now()-F<_)}function L(){if(U!==null){var q=t.unstable_now();F=q;var H=!0;try{H=U(!0,q)}finally{H?E():(le=!1,U=null)}}else le=!1}var E;if(typeof P=="function")E=function(){P(L)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,G=M.port2;M.port1.onmessage=L,E=function(){G.postMessage(null)}}else E=function(){C(L,0)};function K(q){U=q,le||(le=!0,E())}function z(q,H){j=C(function(){q(t.unstable_now())},H)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_continueExecution=function(){T||p||(T=!0,K(Z))},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(q){switch(g){case 1:case 2:case 3:var H=3;break;default:H=g}var X=g;g=H;try{return q()}finally{g=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(q,H){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var X=g;g=q;try{return H()}finally{g=X}},t.unstable_scheduleCallback=function(q,H,X){var ne=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?ne+X:ne):X=ne,q){case 1:var w=-1;break;case 2:w=250;break;case 5:w=1073741823;break;case 4:w=1e4;break;default:w=5e3}return w=X+w,q={id:f++,callback:H,priorityLevel:q,startTime:X,expirationTime:w,sortIndex:-1},X>ne?(q.sortIndex=X,e(u,q),n(c)===null&&q===n(u)&&(k?(b(j),j=-1):k=!0,z(D,X-ne))):(q.sortIndex=w,e(c,q),T||p||(T=!0,K(Z))),q},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(q){var H=g;return function(){var X=g;g=H;try{return q.apply(this,arguments)}finally{g=X}}}})(H5);q5.exports=H5;var f3=q5.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m3=ue,Zi=f3;function Ve(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var W5=new Set,Wd={};function yc(t,e){pu(t,e),pu(t+"Capture",e)}function pu(t,e){for(Wd[t]=e,t=0;t<e.length;t++)W5.add(e[t])}var no=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),k0=Object.prototype.hasOwnProperty,p3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$2={},z2={};function g3(t){return k0.call(z2,t)?!0:k0.call($2,t)?!1:p3.test(t)?z2[t]=!0:($2[t]=!0,!1)}function v3(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function y3(t,e,n,r){if(e===null||typeof e>"u"||v3(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function vi(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var $r={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){$r[t]=new vi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];$r[e]=new vi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){$r[t]=new vi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){$r[t]=new vi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){$r[t]=new vi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){$r[t]=new vi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){$r[t]=new vi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){$r[t]=new vi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){$r[t]=new vi(t,5,!1,t.toLowerCase(),null,!1,!1)});var s1=/[\-:]([a-z])/g;function a1(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(s1,a1);$r[e]=new vi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(s1,a1);$r[e]=new vi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(s1,a1);$r[e]=new vi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){$r[t]=new vi(t,1,!1,t.toLowerCase(),null,!1,!1)});$r.xlinkHref=new vi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){$r[t]=new vi(t,1,!1,t.toLowerCase(),null,!0,!0)});function o1(t,e,n,r){var i=$r.hasOwnProperty(e)?$r[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(y3(e,n,i,r)&&(n=null),r||i===null?g3(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var fo=m3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cf=Symbol.for("react.element"),Vc=Symbol.for("react.portal"),Bc=Symbol.for("react.fragment"),l1=Symbol.for("react.strict_mode"),T0=Symbol.for("react.profiler"),G5=Symbol.for("react.provider"),K5=Symbol.for("react.context"),c1=Symbol.for("react.forward_ref"),j0=Symbol.for("react.suspense"),C0=Symbol.for("react.suspense_list"),u1=Symbol.for("react.memo"),Bo=Symbol.for("react.lazy"),Y5=Symbol.for("react.offscreen"),q2=Symbol.iterator;function cd(t){return t===null||typeof t!="object"?null:(t=q2&&t[q2]||t["@@iterator"],typeof t=="function"?t:null)}var qn=Object.assign,xg;function bd(t){if(xg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);xg=e&&e[1]||""}return`
`+xg+t}var bg=!1;function wg(t,e){if(!t||bg)return"";bg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{bg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?bd(t):""}function x3(t){switch(t.tag){case 5:return bd(t.type);case 16:return bd("Lazy");case 13:return bd("Suspense");case 19:return bd("SuspenseList");case 0:case 2:case 15:return t=wg(t.type,!1),t;case 11:return t=wg(t.type.render,!1),t;case 1:return t=wg(t.type,!0),t;default:return""}}function I0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Bc:return"Fragment";case Vc:return"Portal";case T0:return"Profiler";case l1:return"StrictMode";case j0:return"Suspense";case C0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case K5:return(t.displayName||"Context")+".Consumer";case G5:return(t._context.displayName||"Context")+".Provider";case c1:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case u1:return e=t.displayName||null,e!==null?e:I0(t.type)||"Memo";case Bo:e=t._payload,t=t._init;try{return I0(t(e))}catch{}}return null}function b3(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return I0(e);case 8:return e===l1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function dl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Q5(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function w3(t){var e=Q5(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function uf(t){t._valueTracker||(t._valueTracker=w3(t))}function X5(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Q5(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function mm(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function P0(t,e){var n=e.checked;return qn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function H2(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=dl(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function J5(t,e){e=e.checked,e!=null&&o1(t,"checked",e,!1)}function R0(t,e){J5(t,e);var n=dl(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?L0(t,e.type,n):e.hasOwnProperty("defaultValue")&&L0(t,e.type,dl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function W2(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function L0(t,e,n){(e!=="number"||mm(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var wd=Array.isArray;function eu(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+dl(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function D0(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ve(91));return qn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function G2(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Ve(92));if(wd(n)){if(1<n.length)throw Error(Ve(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:dl(n)}}function Z5(t,e){var n=dl(e.value),r=dl(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function K2(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function eN(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function O0(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?eN(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var df,tN=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(df=df||document.createElement("div"),df.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=df.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Gd(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Cd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},N3=["Webkit","ms","Moz","O"];Object.keys(Cd).forEach(function(t){N3.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Cd[e]=Cd[t]})});function nN(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Cd.hasOwnProperty(t)&&Cd[t]?(""+e).trim():e+"px"}function rN(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=nN(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var _3=qn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function M0(t,e){if(e){if(_3[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ve(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ve(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ve(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ve(62))}}function F0(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var U0=null;function d1(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var V0=null,tu=null,nu=null;function Y2(t){if(t=Eh(t)){if(typeof V0!="function")throw Error(Ve(280));var e=t.stateNode;e&&(e=vp(e),V0(t.stateNode,t.type,e))}}function iN(t){tu?nu?nu.push(t):nu=[t]:tu=t}function sN(){if(tu){var t=tu,e=nu;if(nu=tu=null,Y2(t),e)for(t=0;t<e.length;t++)Y2(e[t])}}function aN(t,e){return t(e)}function oN(){}var Ng=!1;function lN(t,e,n){if(Ng)return t(e,n);Ng=!0;try{return aN(t,e,n)}finally{Ng=!1,(tu!==null||nu!==null)&&(oN(),sN())}}function Kd(t,e){var n=t.stateNode;if(n===null)return null;var r=vp(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Ve(231,e,typeof n));return n}var B0=!1;if(no)try{var ud={};Object.defineProperty(ud,"passive",{get:function(){B0=!0}}),window.addEventListener("test",ud,ud),window.removeEventListener("test",ud,ud)}catch{B0=!1}function E3(t,e,n,r,i,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var Id=!1,pm=null,gm=!1,$0=null,A3={onError:function(t){Id=!0,pm=t}};function S3(t,e,n,r,i,s,o,l,c){Id=!1,pm=null,E3.apply(A3,arguments)}function k3(t,e,n,r,i,s,o,l,c){if(S3.apply(this,arguments),Id){if(Id){var u=pm;Id=!1,pm=null}else throw Error(Ve(198));gm||(gm=!0,$0=u)}}function xc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function cN(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Q2(t){if(xc(t)!==t)throw Error(Ve(188))}function T3(t){var e=t.alternate;if(!e){if(e=xc(t),e===null)throw Error(Ve(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Q2(i),t;if(s===r)return Q2(i),e;s=s.sibling}throw Error(Ve(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(Ve(189))}}if(n.alternate!==r)throw Error(Ve(190))}if(n.tag!==3)throw Error(Ve(188));return n.stateNode.current===n?t:e}function uN(t){return t=T3(t),t!==null?dN(t):null}function dN(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=dN(t);if(e!==null)return e;t=t.sibling}return null}var hN=Zi.unstable_scheduleCallback,X2=Zi.unstable_cancelCallback,j3=Zi.unstable_shouldYield,C3=Zi.unstable_requestPaint,sr=Zi.unstable_now,I3=Zi.unstable_getCurrentPriorityLevel,h1=Zi.unstable_ImmediatePriority,fN=Zi.unstable_UserBlockingPriority,vm=Zi.unstable_NormalPriority,P3=Zi.unstable_LowPriority,mN=Zi.unstable_IdlePriority,fp=null,pa=null;function R3(t){if(pa&&typeof pa.onCommitFiberRoot=="function")try{pa.onCommitFiberRoot(fp,t,void 0,(t.current.flags&128)===128)}catch{}}var Fs=Math.clz32?Math.clz32:O3,L3=Math.log,D3=Math.LN2;function O3(t){return t>>>=0,t===0?32:31-(L3(t)/D3|0)|0}var hf=64,ff=4194304;function Nd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ym(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=Nd(l):(s&=o,s!==0&&(r=Nd(s)))}else o=n&~i,o!==0?r=Nd(o):s!==0&&(r=Nd(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Fs(e),i=1<<n,r|=t[n],e&=~i;return r}function M3(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function F3(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Fs(s),l=1<<o,c=i[o];c===-1?(!(l&n)||l&r)&&(i[o]=M3(l,e)):c<=e&&(t.expiredLanes|=l),s&=~l}}function z0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function pN(){var t=hf;return hf<<=1,!(hf&4194240)&&(hf=64),t}function _g(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Nh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Fs(e),t[e]=n}function U3(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Fs(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function f1(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Fs(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var fn=0;function gN(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var vN,m1,yN,xN,bN,q0=!1,mf=[],Zo=null,el=null,tl=null,Yd=new Map,Qd=new Map,zo=[],V3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function J2(t,e){switch(t){case"focusin":case"focusout":Zo=null;break;case"dragenter":case"dragleave":el=null;break;case"mouseover":case"mouseout":tl=null;break;case"pointerover":case"pointerout":Yd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qd.delete(e.pointerId)}}function dd(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Eh(e),e!==null&&m1(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function B3(t,e,n,r,i){switch(e){case"focusin":return Zo=dd(Zo,t,e,n,r,i),!0;case"dragenter":return el=dd(el,t,e,n,r,i),!0;case"mouseover":return tl=dd(tl,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Yd.set(s,dd(Yd.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Qd.set(s,dd(Qd.get(s)||null,t,e,n,r,i)),!0}return!1}function wN(t){var e=Xl(t.target);if(e!==null){var n=xc(e);if(n!==null){if(e=n.tag,e===13){if(e=cN(n),e!==null){t.blockedOn=e,bN(t.priority,function(){yN(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function $f(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=H0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);U0=r,n.target.dispatchEvent(r),U0=null}else return e=Eh(n),e!==null&&m1(e),t.blockedOn=n,!1;e.shift()}return!0}function Z2(t,e,n){$f(t)&&n.delete(e)}function $3(){q0=!1,Zo!==null&&$f(Zo)&&(Zo=null),el!==null&&$f(el)&&(el=null),tl!==null&&$f(tl)&&(tl=null),Yd.forEach(Z2),Qd.forEach(Z2)}function hd(t,e){t.blockedOn===e&&(t.blockedOn=null,q0||(q0=!0,Zi.unstable_scheduleCallback(Zi.unstable_NormalPriority,$3)))}function Xd(t){function e(i){return hd(i,t)}if(0<mf.length){hd(mf[0],t);for(var n=1;n<mf.length;n++){var r=mf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Zo!==null&&hd(Zo,t),el!==null&&hd(el,t),tl!==null&&hd(tl,t),Yd.forEach(e),Qd.forEach(e),n=0;n<zo.length;n++)r=zo[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<zo.length&&(n=zo[0],n.blockedOn===null);)wN(n),n.blockedOn===null&&zo.shift()}var ru=fo.ReactCurrentBatchConfig,xm=!0;function z3(t,e,n,r){var i=fn,s=ru.transition;ru.transition=null;try{fn=1,p1(t,e,n,r)}finally{fn=i,ru.transition=s}}function q3(t,e,n,r){var i=fn,s=ru.transition;ru.transition=null;try{fn=4,p1(t,e,n,r)}finally{fn=i,ru.transition=s}}function p1(t,e,n,r){if(xm){var i=H0(t,e,n,r);if(i===null)Rg(t,e,r,bm,n),J2(t,r);else if(B3(i,t,e,n,r))r.stopPropagation();else if(J2(t,r),e&4&&-1<V3.indexOf(t)){for(;i!==null;){var s=Eh(i);if(s!==null&&vN(s),s=H0(t,e,n,r),s===null&&Rg(t,e,r,bm,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Rg(t,e,r,null,n)}}var bm=null;function H0(t,e,n,r){if(bm=null,t=d1(r),t=Xl(t),t!==null)if(e=xc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=cN(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return bm=t,null}function NN(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(I3()){case h1:return 1;case fN:return 4;case vm:case P3:return 16;case mN:return 536870912;default:return 16}default:return 16}}var Yo=null,g1=null,zf=null;function _N(){if(zf)return zf;var t,e=g1,n=e.length,r,i="value"in Yo?Yo.value:Yo.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return zf=i.slice(t,1<r?1-r:void 0)}function qf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function pf(){return!0}function ex(){return!1}function ts(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?pf:ex,this.isPropagationStopped=ex,this}return qn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=pf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=pf)},persist:function(){},isPersistent:pf}),e}var Pu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},v1=ts(Pu),_h=qn({},Pu,{view:0,detail:0}),H3=ts(_h),Eg,Ag,fd,mp=qn({},_h,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:y1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==fd&&(fd&&t.type==="mousemove"?(Eg=t.screenX-fd.screenX,Ag=t.screenY-fd.screenY):Ag=Eg=0,fd=t),Eg)},movementY:function(t){return"movementY"in t?t.movementY:Ag}}),tx=ts(mp),W3=qn({},mp,{dataTransfer:0}),G3=ts(W3),K3=qn({},_h,{relatedTarget:0}),Sg=ts(K3),Y3=qn({},Pu,{animationName:0,elapsedTime:0,pseudoElement:0}),Q3=ts(Y3),X3=qn({},Pu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),J3=ts(X3),Z3=qn({},Pu,{data:0}),nx=ts(Z3),ek={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rk(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=nk[t])?!!e[t]:!1}function y1(){return rk}var ik=qn({},_h,{key:function(t){if(t.key){var e=ek[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=qf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?tk[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:y1,charCode:function(t){return t.type==="keypress"?qf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?qf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),sk=ts(ik),ak=qn({},mp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rx=ts(ak),ok=qn({},_h,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:y1}),lk=ts(ok),ck=qn({},Pu,{propertyName:0,elapsedTime:0,pseudoElement:0}),uk=ts(ck),dk=qn({},mp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),hk=ts(dk),fk=[9,13,27,32],x1=no&&"CompositionEvent"in window,Pd=null;no&&"documentMode"in document&&(Pd=document.documentMode);var mk=no&&"TextEvent"in window&&!Pd,EN=no&&(!x1||Pd&&8<Pd&&11>=Pd),ix=" ",sx=!1;function AN(t,e){switch(t){case"keyup":return fk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function SN(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var $c=!1;function pk(t,e){switch(t){case"compositionend":return SN(e);case"keypress":return e.which!==32?null:(sx=!0,ix);case"textInput":return t=e.data,t===ix&&sx?null:t;default:return null}}function gk(t,e){if($c)return t==="compositionend"||!x1&&AN(t,e)?(t=_N(),zf=g1=Yo=null,$c=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return EN&&e.locale!=="ko"?null:e.data;default:return null}}var vk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ax(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!vk[t.type]:e==="textarea"}function kN(t,e,n,r){iN(r),e=wm(e,"onChange"),0<e.length&&(n=new v1("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Rd=null,Jd=null;function yk(t){FN(t,0)}function pp(t){var e=Hc(t);if(X5(e))return t}function xk(t,e){if(t==="change")return e}var TN=!1;if(no){var kg;if(no){var Tg="oninput"in document;if(!Tg){var ox=document.createElement("div");ox.setAttribute("oninput","return;"),Tg=typeof ox.oninput=="function"}kg=Tg}else kg=!1;TN=kg&&(!document.documentMode||9<document.documentMode)}function lx(){Rd&&(Rd.detachEvent("onpropertychange",jN),Jd=Rd=null)}function jN(t){if(t.propertyName==="value"&&pp(Jd)){var e=[];kN(e,Jd,t,d1(t)),lN(yk,e)}}function bk(t,e,n){t==="focusin"?(lx(),Rd=e,Jd=n,Rd.attachEvent("onpropertychange",jN)):t==="focusout"&&lx()}function wk(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return pp(Jd)}function Nk(t,e){if(t==="click")return pp(e)}function _k(t,e){if(t==="input"||t==="change")return pp(e)}function Ek(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Vs=typeof Object.is=="function"?Object.is:Ek;function Zd(t,e){if(Vs(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!k0.call(e,i)||!Vs(t[i],e[i]))return!1}return!0}function cx(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ux(t,e){var n=cx(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cx(n)}}function CN(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?CN(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function IN(){for(var t=window,e=mm();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=mm(t.document)}return e}function b1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Ak(t){var e=IN(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&CN(n.ownerDocument.documentElement,n)){if(r!==null&&b1(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=ux(n,s);var o=ux(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Sk=no&&"documentMode"in document&&11>=document.documentMode,zc=null,W0=null,Ld=null,G0=!1;function dx(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;G0||zc==null||zc!==mm(r)||(r=zc,"selectionStart"in r&&b1(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ld&&Zd(Ld,r)||(Ld=r,r=wm(W0,"onSelect"),0<r.length&&(e=new v1("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=zc)))}function gf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var qc={animationend:gf("Animation","AnimationEnd"),animationiteration:gf("Animation","AnimationIteration"),animationstart:gf("Animation","AnimationStart"),transitionend:gf("Transition","TransitionEnd")},jg={},PN={};no&&(PN=document.createElement("div").style,"AnimationEvent"in window||(delete qc.animationend.animation,delete qc.animationiteration.animation,delete qc.animationstart.animation),"TransitionEvent"in window||delete qc.transitionend.transition);function gp(t){if(jg[t])return jg[t];if(!qc[t])return t;var e=qc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in PN)return jg[t]=e[n];return t}var RN=gp("animationend"),LN=gp("animationiteration"),DN=gp("animationstart"),ON=gp("transitionend"),MN=new Map,hx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bl(t,e){MN.set(t,e),yc(e,[t])}for(var Cg=0;Cg<hx.length;Cg++){var Ig=hx[Cg],kk=Ig.toLowerCase(),Tk=Ig[0].toUpperCase()+Ig.slice(1);bl(kk,"on"+Tk)}bl(RN,"onAnimationEnd");bl(LN,"onAnimationIteration");bl(DN,"onAnimationStart");bl("dblclick","onDoubleClick");bl("focusin","onFocus");bl("focusout","onBlur");bl(ON,"onTransitionEnd");pu("onMouseEnter",["mouseout","mouseover"]);pu("onMouseLeave",["mouseout","mouseover"]);pu("onPointerEnter",["pointerout","pointerover"]);pu("onPointerLeave",["pointerout","pointerover"]);yc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yc("onBeforeInput",["compositionend","keypress","textInput","paste"]);yc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _d="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jk=new Set("cancel close invalid load scroll toggle".split(" ").concat(_d));function fx(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,k3(r,e,void 0,t),t.currentTarget=null}function FN(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;fx(i,l,u),s=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;fx(i,l,u),s=c}}}if(gm)throw t=$0,gm=!1,$0=null,t}function jn(t,e){var n=e[J0];n===void 0&&(n=e[J0]=new Set);var r=t+"__bubble";n.has(r)||(UN(e,t,2,!1),n.add(r))}function Pg(t,e,n){var r=0;e&&(r|=4),UN(n,t,r,e)}var vf="_reactListening"+Math.random().toString(36).slice(2);function eh(t){if(!t[vf]){t[vf]=!0,W5.forEach(function(n){n!=="selectionchange"&&(jk.has(n)||Pg(n,!1,t),Pg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[vf]||(e[vf]=!0,Pg("selectionchange",!1,e))}}function UN(t,e,n,r){switch(NN(e)){case 1:var i=z3;break;case 4:i=q3;break;default:i=p1}n=i.bind(null,e,n,t),i=void 0,!B0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Rg(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Xl(l),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}l=l.parentNode}}r=r.return}lN(function(){var u=s,f=d1(n),v=[];e:{var g=MN.get(t);if(g!==void 0){var p=v1,T=t;switch(t){case"keypress":if(qf(n)===0)break e;case"keydown":case"keyup":p=sk;break;case"focusin":T="focus",p=Sg;break;case"focusout":T="blur",p=Sg;break;case"beforeblur":case"afterblur":p=Sg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=tx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=G3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=lk;break;case RN:case LN:case DN:p=Q3;break;case ON:p=uk;break;case"scroll":p=H3;break;case"wheel":p=hk;break;case"copy":case"cut":case"paste":p=J3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=rx}var k=(e&4)!==0,C=!k&&t==="scroll",b=k?g!==null?g+"Capture":null:g;k=[];for(var P=u,R;P!==null;){R=P;var D=R.stateNode;if(R.tag===5&&D!==null&&(R=D,b!==null&&(D=Kd(P,b),D!=null&&k.push(th(P,D,R)))),C)break;P=P.return}0<k.length&&(g=new p(g,T,null,n,f),v.push({event:g,listeners:k}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",g&&n!==U0&&(T=n.relatedTarget||n.fromElement)&&(Xl(T)||T[ro]))break e;if((p||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,p?(T=n.relatedTarget||n.toElement,p=u,T=T?Xl(T):null,T!==null&&(C=xc(T),T!==C||T.tag!==5&&T.tag!==6)&&(T=null)):(p=null,T=u),p!==T)){if(k=tx,D="onMouseLeave",b="onMouseEnter",P="mouse",(t==="pointerout"||t==="pointerover")&&(k=rx,D="onPointerLeave",b="onPointerEnter",P="pointer"),C=p==null?g:Hc(p),R=T==null?g:Hc(T),g=new k(D,P+"leave",p,n,f),g.target=C,g.relatedTarget=R,D=null,Xl(f)===u&&(k=new k(b,P+"enter",T,n,f),k.target=R,k.relatedTarget=C,D=k),C=D,p&&T)t:{for(k=p,b=T,P=0,R=k;R;R=Ic(R))P++;for(R=0,D=b;D;D=Ic(D))R++;for(;0<P-R;)k=Ic(k),P--;for(;0<R-P;)b=Ic(b),R--;for(;P--;){if(k===b||b!==null&&k===b.alternate)break t;k=Ic(k),b=Ic(b)}k=null}else k=null;p!==null&&mx(v,g,p,k,!1),T!==null&&C!==null&&mx(v,C,T,k,!0)}}e:{if(g=u?Hc(u):window,p=g.nodeName&&g.nodeName.toLowerCase(),p==="select"||p==="input"&&g.type==="file")var Z=xk;else if(ax(g))if(TN)Z=_k;else{Z=wk;var le=bk}else(p=g.nodeName)&&p.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(Z=Nk);if(Z&&(Z=Z(t,u))){kN(v,Z,n,f);break e}le&&le(t,g,u),t==="focusout"&&(le=g._wrapperState)&&le.controlled&&g.type==="number"&&L0(g,"number",g.value)}switch(le=u?Hc(u):window,t){case"focusin":(ax(le)||le.contentEditable==="true")&&(zc=le,W0=u,Ld=null);break;case"focusout":Ld=W0=zc=null;break;case"mousedown":G0=!0;break;case"contextmenu":case"mouseup":case"dragend":G0=!1,dx(v,n,f);break;case"selectionchange":if(Sk)break;case"keydown":case"keyup":dx(v,n,f)}var U;if(x1)e:{switch(t){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else $c?AN(t,n)&&(j="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(j="onCompositionStart");j&&(EN&&n.locale!=="ko"&&($c||j!=="onCompositionStart"?j==="onCompositionEnd"&&$c&&(U=_N()):(Yo=f,g1="value"in Yo?Yo.value:Yo.textContent,$c=!0)),le=wm(u,j),0<le.length&&(j=new nx(j,t,null,n,f),v.push({event:j,listeners:le}),U?j.data=U:(U=SN(n),U!==null&&(j.data=U)))),(U=mk?pk(t,n):gk(t,n))&&(u=wm(u,"onBeforeInput"),0<u.length&&(f=new nx("onBeforeInput","beforeinput",null,n,f),v.push({event:f,listeners:u}),f.data=U))}FN(v,e)})}function th(t,e,n){return{instance:t,listener:e,currentTarget:n}}function wm(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Kd(t,n),s!=null&&r.unshift(th(t,s,i)),s=Kd(t,e),s!=null&&r.push(th(t,s,i))),t=t.return}return r}function Ic(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function mx(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,i?(c=Kd(n,s),c!=null&&o.unshift(th(n,c,l))):i||(c=Kd(n,s),c!=null&&o.push(th(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Ck=/\r\n?/g,Ik=/\u0000|\uFFFD/g;function px(t){return(typeof t=="string"?t:""+t).replace(Ck,`
`).replace(Ik,"")}function yf(t,e,n){if(e=px(e),px(t)!==e&&n)throw Error(Ve(425))}function Nm(){}var K0=null,Y0=null;function Q0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var X0=typeof setTimeout=="function"?setTimeout:void 0,Pk=typeof clearTimeout=="function"?clearTimeout:void 0,gx=typeof Promise=="function"?Promise:void 0,Rk=typeof queueMicrotask=="function"?queueMicrotask:typeof gx<"u"?function(t){return gx.resolve(null).then(t).catch(Lk)}:X0;function Lk(t){setTimeout(function(){throw t})}function Lg(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Xd(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Xd(e)}function nl(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function vx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ru=Math.random().toString(36).slice(2),ha="__reactFiber$"+Ru,nh="__reactProps$"+Ru,ro="__reactContainer$"+Ru,J0="__reactEvents$"+Ru,Dk="__reactListeners$"+Ru,Ok="__reactHandles$"+Ru;function Xl(t){var e=t[ha];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ro]||n[ha]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=vx(t);t!==null;){if(n=t[ha])return n;t=vx(t)}return e}t=n,n=t.parentNode}return null}function Eh(t){return t=t[ha]||t[ro],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Hc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Ve(33))}function vp(t){return t[nh]||null}var Z0=[],Wc=-1;function wl(t){return{current:t}}function Pn(t){0>Wc||(t.current=Z0[Wc],Z0[Wc]=null,Wc--)}function En(t,e){Wc++,Z0[Wc]=t.current,t.current=e}var hl={},ai=wl(hl),ki=wl(!1),ac=hl;function gu(t,e){var n=t.type.contextTypes;if(!n)return hl;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Ti(t){return t=t.childContextTypes,t!=null}function _m(){Pn(ki),Pn(ai)}function yx(t,e,n){if(ai.current!==hl)throw Error(Ve(168));En(ai,e),En(ki,n)}function VN(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Ve(108,b3(t)||"Unknown",i));return qn({},n,r)}function Em(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||hl,ac=ai.current,En(ai,t),En(ki,ki.current),!0}function xx(t,e,n){var r=t.stateNode;if(!r)throw Error(Ve(169));n?(t=VN(t,e,ac),r.__reactInternalMemoizedMergedChildContext=t,Pn(ki),Pn(ai),En(ai,t)):Pn(ki),En(ki,n)}var Wa=null,yp=!1,Dg=!1;function BN(t){Wa===null?Wa=[t]:Wa.push(t)}function Mk(t){yp=!0,BN(t)}function Nl(){if(!Dg&&Wa!==null){Dg=!0;var t=0,e=fn;try{var n=Wa;for(fn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Wa=null,yp=!1}catch(i){throw Wa!==null&&(Wa=Wa.slice(t+1)),hN(h1,Nl),i}finally{fn=e,Dg=!1}}return null}var Gc=[],Kc=0,Am=null,Sm=0,us=[],ds=0,oc=null,Ka=1,Ya="";function Hl(t,e){Gc[Kc++]=Sm,Gc[Kc++]=Am,Am=t,Sm=e}function $N(t,e,n){us[ds++]=Ka,us[ds++]=Ya,us[ds++]=oc,oc=t;var r=Ka;t=Ya;var i=32-Fs(r)-1;r&=~(1<<i),n+=1;var s=32-Fs(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ka=1<<32-Fs(e)+i|n<<i|r,Ya=s+t}else Ka=1<<s|n<<i|r,Ya=t}function w1(t){t.return!==null&&(Hl(t,1),$N(t,1,0))}function N1(t){for(;t===Am;)Am=Gc[--Kc],Gc[Kc]=null,Sm=Gc[--Kc],Gc[Kc]=null;for(;t===oc;)oc=us[--ds],us[ds]=null,Ya=us[--ds],us[ds]=null,Ka=us[--ds],us[ds]=null}var Xi=null,Ki=null,Mn=!1,Os=null;function zN(t,e){var n=fs(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function bx(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Xi=t,Ki=nl(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Xi=t,Ki=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=oc!==null?{id:Ka,overflow:Ya}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=fs(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Xi=t,Ki=null,!0):!1;default:return!1}}function ev(t){return(t.mode&1)!==0&&(t.flags&128)===0}function tv(t){if(Mn){var e=Ki;if(e){var n=e;if(!bx(t,e)){if(ev(t))throw Error(Ve(418));e=nl(n.nextSibling);var r=Xi;e&&bx(t,e)?zN(r,n):(t.flags=t.flags&-4097|2,Mn=!1,Xi=t)}}else{if(ev(t))throw Error(Ve(418));t.flags=t.flags&-4097|2,Mn=!1,Xi=t}}}function wx(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Xi=t}function xf(t){if(t!==Xi)return!1;if(!Mn)return wx(t),Mn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Q0(t.type,t.memoizedProps)),e&&(e=Ki)){if(ev(t))throw qN(),Error(Ve(418));for(;e;)zN(t,e),e=nl(e.nextSibling)}if(wx(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ve(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ki=nl(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ki=null}}else Ki=Xi?nl(t.stateNode.nextSibling):null;return!0}function qN(){for(var t=Ki;t;)t=nl(t.nextSibling)}function vu(){Ki=Xi=null,Mn=!1}function _1(t){Os===null?Os=[t]:Os.push(t)}var Fk=fo.ReactCurrentBatchConfig;function md(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Ve(309));var r=n.stateNode}if(!r)throw Error(Ve(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Ve(284));if(!n._owner)throw Error(Ve(290,t))}return t}function bf(t,e){throw t=Object.prototype.toString.call(e),Error(Ve(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Nx(t){var e=t._init;return e(t._payload)}function HN(t){function e(b,P){if(t){var R=b.deletions;R===null?(b.deletions=[P],b.flags|=16):R.push(P)}}function n(b,P){if(!t)return null;for(;P!==null;)e(b,P),P=P.sibling;return null}function r(b,P){for(b=new Map;P!==null;)P.key!==null?b.set(P.key,P):b.set(P.index,P),P=P.sibling;return b}function i(b,P){return b=al(b,P),b.index=0,b.sibling=null,b}function s(b,P,R){return b.index=R,t?(R=b.alternate,R!==null?(R=R.index,R<P?(b.flags|=2,P):R):(b.flags|=2,P)):(b.flags|=1048576,P)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function l(b,P,R,D){return P===null||P.tag!==6?(P=$g(R,b.mode,D),P.return=b,P):(P=i(P,R),P.return=b,P)}function c(b,P,R,D){var Z=R.type;return Z===Bc?f(b,P,R.props.children,D,R.key):P!==null&&(P.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===Bo&&Nx(Z)===P.type)?(D=i(P,R.props),D.ref=md(b,P,R),D.return=b,D):(D=Xf(R.type,R.key,R.props,null,b.mode,D),D.ref=md(b,P,R),D.return=b,D)}function u(b,P,R,D){return P===null||P.tag!==4||P.stateNode.containerInfo!==R.containerInfo||P.stateNode.implementation!==R.implementation?(P=zg(R,b.mode,D),P.return=b,P):(P=i(P,R.children||[]),P.return=b,P)}function f(b,P,R,D,Z){return P===null||P.tag!==7?(P=nc(R,b.mode,D,Z),P.return=b,P):(P=i(P,R),P.return=b,P)}function v(b,P,R){if(typeof P=="string"&&P!==""||typeof P=="number")return P=$g(""+P,b.mode,R),P.return=b,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case cf:return R=Xf(P.type,P.key,P.props,null,b.mode,R),R.ref=md(b,null,P),R.return=b,R;case Vc:return P=zg(P,b.mode,R),P.return=b,P;case Bo:var D=P._init;return v(b,D(P._payload),R)}if(wd(P)||cd(P))return P=nc(P,b.mode,R,null),P.return=b,P;bf(b,P)}return null}function g(b,P,R,D){var Z=P!==null?P.key:null;if(typeof R=="string"&&R!==""||typeof R=="number")return Z!==null?null:l(b,P,""+R,D);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case cf:return R.key===Z?c(b,P,R,D):null;case Vc:return R.key===Z?u(b,P,R,D):null;case Bo:return Z=R._init,g(b,P,Z(R._payload),D)}if(wd(R)||cd(R))return Z!==null?null:f(b,P,R,D,null);bf(b,R)}return null}function p(b,P,R,D,Z){if(typeof D=="string"&&D!==""||typeof D=="number")return b=b.get(R)||null,l(P,b,""+D,Z);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case cf:return b=b.get(D.key===null?R:D.key)||null,c(P,b,D,Z);case Vc:return b=b.get(D.key===null?R:D.key)||null,u(P,b,D,Z);case Bo:var le=D._init;return p(b,P,R,le(D._payload),Z)}if(wd(D)||cd(D))return b=b.get(R)||null,f(P,b,D,Z,null);bf(P,D)}return null}function T(b,P,R,D){for(var Z=null,le=null,U=P,j=P=0,_=null;U!==null&&j<R.length;j++){U.index>j?(_=U,U=null):_=U.sibling;var F=g(b,U,R[j],D);if(F===null){U===null&&(U=_);break}t&&U&&F.alternate===null&&e(b,U),P=s(F,P,j),le===null?Z=F:le.sibling=F,le=F,U=_}if(j===R.length)return n(b,U),Mn&&Hl(b,j),Z;if(U===null){for(;j<R.length;j++)U=v(b,R[j],D),U!==null&&(P=s(U,P,j),le===null?Z=U:le.sibling=U,le=U);return Mn&&Hl(b,j),Z}for(U=r(b,U);j<R.length;j++)_=p(U,b,j,R[j],D),_!==null&&(t&&_.alternate!==null&&U.delete(_.key===null?j:_.key),P=s(_,P,j),le===null?Z=_:le.sibling=_,le=_);return t&&U.forEach(function(A){return e(b,A)}),Mn&&Hl(b,j),Z}function k(b,P,R,D){var Z=cd(R);if(typeof Z!="function")throw Error(Ve(150));if(R=Z.call(R),R==null)throw Error(Ve(151));for(var le=Z=null,U=P,j=P=0,_=null,F=R.next();U!==null&&!F.done;j++,F=R.next()){U.index>j?(_=U,U=null):_=U.sibling;var A=g(b,U,F.value,D);if(A===null){U===null&&(U=_);break}t&&U&&A.alternate===null&&e(b,U),P=s(A,P,j),le===null?Z=A:le.sibling=A,le=A,U=_}if(F.done)return n(b,U),Mn&&Hl(b,j),Z;if(U===null){for(;!F.done;j++,F=R.next())F=v(b,F.value,D),F!==null&&(P=s(F,P,j),le===null?Z=F:le.sibling=F,le=F);return Mn&&Hl(b,j),Z}for(U=r(b,U);!F.done;j++,F=R.next())F=p(U,b,j,F.value,D),F!==null&&(t&&F.alternate!==null&&U.delete(F.key===null?j:F.key),P=s(F,P,j),le===null?Z=F:le.sibling=F,le=F);return t&&U.forEach(function(L){return e(b,L)}),Mn&&Hl(b,j),Z}function C(b,P,R,D){if(typeof R=="object"&&R!==null&&R.type===Bc&&R.key===null&&(R=R.props.children),typeof R=="object"&&R!==null){switch(R.$$typeof){case cf:e:{for(var Z=R.key,le=P;le!==null;){if(le.key===Z){if(Z=R.type,Z===Bc){if(le.tag===7){n(b,le.sibling),P=i(le,R.props.children),P.return=b,b=P;break e}}else if(le.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===Bo&&Nx(Z)===le.type){n(b,le.sibling),P=i(le,R.props),P.ref=md(b,le,R),P.return=b,b=P;break e}n(b,le);break}else e(b,le);le=le.sibling}R.type===Bc?(P=nc(R.props.children,b.mode,D,R.key),P.return=b,b=P):(D=Xf(R.type,R.key,R.props,null,b.mode,D),D.ref=md(b,P,R),D.return=b,b=D)}return o(b);case Vc:e:{for(le=R.key;P!==null;){if(P.key===le)if(P.tag===4&&P.stateNode.containerInfo===R.containerInfo&&P.stateNode.implementation===R.implementation){n(b,P.sibling),P=i(P,R.children||[]),P.return=b,b=P;break e}else{n(b,P);break}else e(b,P);P=P.sibling}P=zg(R,b.mode,D),P.return=b,b=P}return o(b);case Bo:return le=R._init,C(b,P,le(R._payload),D)}if(wd(R))return T(b,P,R,D);if(cd(R))return k(b,P,R,D);bf(b,R)}return typeof R=="string"&&R!==""||typeof R=="number"?(R=""+R,P!==null&&P.tag===6?(n(b,P.sibling),P=i(P,R),P.return=b,b=P):(n(b,P),P=$g(R,b.mode,D),P.return=b,b=P),o(b)):n(b,P)}return C}var yu=HN(!0),WN=HN(!1),km=wl(null),Tm=null,Yc=null,E1=null;function A1(){E1=Yc=Tm=null}function S1(t){var e=km.current;Pn(km),t._currentValue=e}function nv(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function iu(t,e){Tm=t,E1=Yc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Si=!0),t.firstContext=null)}function ys(t){var e=t._currentValue;if(E1!==t)if(t={context:t,memoizedValue:e,next:null},Yc===null){if(Tm===null)throw Error(Ve(308));Yc=t,Tm.dependencies={lanes:0,firstContext:t}}else Yc=Yc.next=t;return e}var Jl=null;function k1(t){Jl===null?Jl=[t]:Jl.push(t)}function GN(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,k1(e)):(n.next=i.next,i.next=n),e.interleaved=n,io(t,r)}function io(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var $o=!1;function T1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function KN(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Za(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function rl(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Zt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,io(t,n)}return i=r.interleaved,i===null?(e.next=e,k1(r)):(e.next=i.next,i.next=e),r.interleaved=e,io(t,n)}function Hf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,f1(t,n)}}function _x(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function jm(t,e,n,r){var i=t.updateQueue;$o=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=c))}if(s!==null){var v=i.baseState;o=0,f=u=c=null,l=s;do{var g=l.lane,p=l.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var T=t,k=l;switch(g=e,p=n,k.tag){case 1:if(T=k.payload,typeof T=="function"){v=T.call(p,v,g);break e}v=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=k.payload,g=typeof T=="function"?T.call(p,v,g):T,g==null)break e;v=qn({},v,g);break e;case 2:$o=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[l]:g.push(l))}else p={eventTime:p,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(u=f=p,c=v):f=f.next=p,o|=g;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;g=l,l=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(c=v),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);cc|=o,t.lanes=o,t.memoizedState=v}}function Ex(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Ve(191,i));i.call(r)}}}var Ah={},ga=wl(Ah),rh=wl(Ah),ih=wl(Ah);function Zl(t){if(t===Ah)throw Error(Ve(174));return t}function j1(t,e){switch(En(ih,e),En(rh,t),En(ga,Ah),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:O0(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=O0(e,t)}Pn(ga),En(ga,e)}function xu(){Pn(ga),Pn(rh),Pn(ih)}function YN(t){Zl(ih.current);var e=Zl(ga.current),n=O0(e,t.type);e!==n&&(En(rh,t),En(ga,n))}function C1(t){rh.current===t&&(Pn(ga),Pn(rh))}var $n=wl(0);function Cm(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Og=[];function I1(){for(var t=0;t<Og.length;t++)Og[t]._workInProgressVersionPrimary=null;Og.length=0}var Wf=fo.ReactCurrentDispatcher,Mg=fo.ReactCurrentBatchConfig,lc=0,zn=null,wr=null,jr=null,Im=!1,Dd=!1,sh=0,Uk=0;function Yr(){throw Error(Ve(321))}function P1(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Vs(t[n],e[n]))return!1;return!0}function R1(t,e,n,r,i,s){if(lc=s,zn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Wf.current=t===null||t.memoizedState===null?zk:qk,t=n(r,i),Dd){s=0;do{if(Dd=!1,sh=0,25<=s)throw Error(Ve(301));s+=1,jr=wr=null,e.updateQueue=null,Wf.current=Hk,t=n(r,i)}while(Dd)}if(Wf.current=Pm,e=wr!==null&&wr.next!==null,lc=0,jr=wr=zn=null,Im=!1,e)throw Error(Ve(300));return t}function L1(){var t=sh!==0;return sh=0,t}function da(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jr===null?zn.memoizedState=jr=t:jr=jr.next=t,jr}function xs(){if(wr===null){var t=zn.alternate;t=t!==null?t.memoizedState:null}else t=wr.next;var e=jr===null?zn.memoizedState:jr.next;if(e!==null)jr=e,wr=t;else{if(t===null)throw Error(Ve(310));wr=t,t={memoizedState:wr.memoizedState,baseState:wr.baseState,baseQueue:wr.baseQueue,queue:wr.queue,next:null},jr===null?zn.memoizedState=jr=t:jr=jr.next=t}return jr}function ah(t,e){return typeof e=="function"?e(t):e}function Fg(t){var e=xs(),n=e.queue;if(n===null)throw Error(Ve(311));n.lastRenderedReducer=t;var r=wr,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,c=null,u=s;do{var f=u.lane;if((lc&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var v={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=v,o=r):c=c.next=v,zn.lanes|=f,cc|=f}u=u.next}while(u!==null&&u!==s);c===null?o=r:c.next=l,Vs(r,e.memoizedState)||(Si=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,zn.lanes|=s,cc|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ug(t){var e=xs(),n=e.queue;if(n===null)throw Error(Ve(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Vs(s,e.memoizedState)||(Si=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function QN(){}function XN(t,e){var n=zn,r=xs(),i=e(),s=!Vs(r.memoizedState,i);if(s&&(r.memoizedState=i,Si=!0),r=r.queue,D1(e_.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||jr!==null&&jr.memoizedState.tag&1){if(n.flags|=2048,oh(9,ZN.bind(null,n,r,i,e),void 0,null),Ir===null)throw Error(Ve(349));lc&30||JN(n,e,i)}return i}function JN(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=zn.updateQueue,e===null?(e={lastEffect:null,stores:null},zn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function ZN(t,e,n,r){e.value=n,e.getSnapshot=r,t_(e)&&n_(t)}function e_(t,e,n){return n(function(){t_(e)&&n_(t)})}function t_(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Vs(t,n)}catch{return!0}}function n_(t){var e=io(t,1);e!==null&&Us(e,t,1,-1)}function Ax(t){var e=da();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ah,lastRenderedState:t},e.queue=t,t=t.dispatch=$k.bind(null,zn,t),[e.memoizedState,t]}function oh(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=zn.updateQueue,e===null?(e={lastEffect:null,stores:null},zn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function r_(){return xs().memoizedState}function Gf(t,e,n,r){var i=da();zn.flags|=t,i.memoizedState=oh(1|e,n,void 0,r===void 0?null:r)}function xp(t,e,n,r){var i=xs();r=r===void 0?null:r;var s=void 0;if(wr!==null){var o=wr.memoizedState;if(s=o.destroy,r!==null&&P1(r,o.deps)){i.memoizedState=oh(e,n,s,r);return}}zn.flags|=t,i.memoizedState=oh(1|e,n,s,r)}function Sx(t,e){return Gf(8390656,8,t,e)}function D1(t,e){return xp(2048,8,t,e)}function i_(t,e){return xp(4,2,t,e)}function s_(t,e){return xp(4,4,t,e)}function a_(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function o_(t,e,n){return n=n!=null?n.concat([t]):null,xp(4,4,a_.bind(null,e,t),n)}function O1(){}function l_(t,e){var n=xs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&P1(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function c_(t,e){var n=xs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&P1(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function u_(t,e,n){return lc&21?(Vs(n,e)||(n=pN(),zn.lanes|=n,cc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Si=!0),t.memoizedState=n)}function Vk(t,e){var n=fn;fn=n!==0&&4>n?n:4,t(!0);var r=Mg.transition;Mg.transition={};try{t(!1),e()}finally{fn=n,Mg.transition=r}}function d_(){return xs().memoizedState}function Bk(t,e,n){var r=sl(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},h_(t))f_(e,n);else if(n=GN(t,e,n,r),n!==null){var i=pi();Us(n,t,r,i),m_(n,e,r)}}function $k(t,e,n){var r=sl(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(h_(t))f_(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,n);if(i.hasEagerState=!0,i.eagerState=l,Vs(l,o)){var c=e.interleaved;c===null?(i.next=i,k1(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=GN(t,e,i,r),n!==null&&(i=pi(),Us(n,t,r,i),m_(n,e,r))}}function h_(t){var e=t.alternate;return t===zn||e!==null&&e===zn}function f_(t,e){Dd=Im=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function m_(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,f1(t,n)}}var Pm={readContext:ys,useCallback:Yr,useContext:Yr,useEffect:Yr,useImperativeHandle:Yr,useInsertionEffect:Yr,useLayoutEffect:Yr,useMemo:Yr,useReducer:Yr,useRef:Yr,useState:Yr,useDebugValue:Yr,useDeferredValue:Yr,useTransition:Yr,useMutableSource:Yr,useSyncExternalStore:Yr,useId:Yr,unstable_isNewReconciler:!1},zk={readContext:ys,useCallback:function(t,e){return da().memoizedState=[t,e===void 0?null:e],t},useContext:ys,useEffect:Sx,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Gf(4194308,4,a_.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Gf(4194308,4,t,e)},useInsertionEffect:function(t,e){return Gf(4,2,t,e)},useMemo:function(t,e){var n=da();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=da();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Bk.bind(null,zn,t),[r.memoizedState,t]},useRef:function(t){var e=da();return t={current:t},e.memoizedState=t},useState:Ax,useDebugValue:O1,useDeferredValue:function(t){return da().memoizedState=t},useTransition:function(){var t=Ax(!1),e=t[0];return t=Vk.bind(null,t[1]),da().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=zn,i=da();if(Mn){if(n===void 0)throw Error(Ve(407));n=n()}else{if(n=e(),Ir===null)throw Error(Ve(349));lc&30||JN(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Sx(e_.bind(null,r,s,t),[t]),r.flags|=2048,oh(9,ZN.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=da(),e=Ir.identifierPrefix;if(Mn){var n=Ya,r=Ka;n=(r&~(1<<32-Fs(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=sh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Uk++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},qk={readContext:ys,useCallback:l_,useContext:ys,useEffect:D1,useImperativeHandle:o_,useInsertionEffect:i_,useLayoutEffect:s_,useMemo:c_,useReducer:Fg,useRef:r_,useState:function(){return Fg(ah)},useDebugValue:O1,useDeferredValue:function(t){var e=xs();return u_(e,wr.memoizedState,t)},useTransition:function(){var t=Fg(ah)[0],e=xs().memoizedState;return[t,e]},useMutableSource:QN,useSyncExternalStore:XN,useId:d_,unstable_isNewReconciler:!1},Hk={readContext:ys,useCallback:l_,useContext:ys,useEffect:D1,useImperativeHandle:o_,useInsertionEffect:i_,useLayoutEffect:s_,useMemo:c_,useReducer:Ug,useRef:r_,useState:function(){return Ug(ah)},useDebugValue:O1,useDeferredValue:function(t){var e=xs();return wr===null?e.memoizedState=t:u_(e,wr.memoizedState,t)},useTransition:function(){var t=Ug(ah)[0],e=xs().memoizedState;return[t,e]},useMutableSource:QN,useSyncExternalStore:XN,useId:d_,unstable_isNewReconciler:!1};function Ls(t,e){if(t&&t.defaultProps){e=qn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function rv(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:qn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var bp={isMounted:function(t){return(t=t._reactInternals)?xc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=pi(),i=sl(t),s=Za(r,i);s.payload=e,n!=null&&(s.callback=n),e=rl(t,s,i),e!==null&&(Us(e,t,i,r),Hf(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=pi(),i=sl(t),s=Za(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=rl(t,s,i),e!==null&&(Us(e,t,i,r),Hf(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=pi(),r=sl(t),i=Za(n,r);i.tag=2,e!=null&&(i.callback=e),e=rl(t,i,r),e!==null&&(Us(e,t,r,n),Hf(e,t,r))}};function kx(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Zd(n,r)||!Zd(i,s):!0}function p_(t,e,n){var r=!1,i=hl,s=e.contextType;return typeof s=="object"&&s!==null?s=ys(s):(i=Ti(e)?ac:ai.current,r=e.contextTypes,s=(r=r!=null)?gu(t,i):hl),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=bp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Tx(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&bp.enqueueReplaceState(e,e.state,null)}function iv(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},T1(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=ys(s):(s=Ti(e)?ac:ai.current,i.context=gu(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(rv(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&bp.enqueueReplaceState(i,i.state,null),jm(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function bu(t,e){try{var n="",r=e;do n+=x3(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Vg(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function sv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Wk=typeof WeakMap=="function"?WeakMap:Map;function g_(t,e,n){n=Za(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Lm||(Lm=!0,pv=r),sv(t,e)},n}function v_(t,e,n){n=Za(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){sv(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){sv(t,e),typeof r!="function"&&(il===null?il=new Set([this]):il.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function jx(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Wk;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=aT.bind(null,t,e,n),e.then(t,t))}function Cx(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Ix(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Za(-1,1),e.tag=2,rl(n,e,1))),n.lanes|=1),t)}var Gk=fo.ReactCurrentOwner,Si=!1;function mi(t,e,n,r){e.child=t===null?WN(e,null,n,r):yu(e,t.child,n,r)}function Px(t,e,n,r,i){n=n.render;var s=e.ref;return iu(e,i),r=R1(t,e,n,r,s,i),n=L1(),t!==null&&!Si?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,so(t,e,i)):(Mn&&n&&w1(e),e.flags|=1,mi(t,e,r,i),e.child)}function Rx(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!q1(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,y_(t,e,s,r,i)):(t=Xf(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Zd,n(o,r)&&t.ref===e.ref)return so(t,e,i)}return e.flags|=1,t=al(s,r),t.ref=e.ref,t.return=e,e.child=t}function y_(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Zd(s,r)&&t.ref===e.ref)if(Si=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Si=!0);else return e.lanes=t.lanes,so(t,e,i)}return av(t,e,n,r,i)}function x_(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},En(Xc,Gi),Gi|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,En(Xc,Gi),Gi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,En(Xc,Gi),Gi|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,En(Xc,Gi),Gi|=r;return mi(t,e,i,n),e.child}function b_(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function av(t,e,n,r,i){var s=Ti(n)?ac:ai.current;return s=gu(e,s),iu(e,i),n=R1(t,e,n,r,s,i),r=L1(),t!==null&&!Si?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,so(t,e,i)):(Mn&&r&&w1(e),e.flags|=1,mi(t,e,n,i),e.child)}function Lx(t,e,n,r,i){if(Ti(n)){var s=!0;Em(e)}else s=!1;if(iu(e,i),e.stateNode===null)Kf(t,e),p_(e,n,r),iv(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=ys(u):(u=Ti(n)?ac:ai.current,u=gu(e,u));var f=n.getDerivedStateFromProps,v=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";v||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&Tx(e,o,r,u),$o=!1;var g=e.memoizedState;o.state=g,jm(e,r,o,i),c=e.memoizedState,l!==r||g!==c||ki.current||$o?(typeof f=="function"&&(rv(e,n,f,r),c=e.memoizedState),(l=$o||kx(e,n,l,r,g,c,u))?(v||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,KN(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Ls(e.type,l),o.props=u,v=e.pendingProps,g=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=ys(c):(c=Ti(n)?ac:ai.current,c=gu(e,c));var p=n.getDerivedStateFromProps;(f=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==v||g!==c)&&Tx(e,o,r,c),$o=!1,g=e.memoizedState,o.state=g,jm(e,r,o,i);var T=e.memoizedState;l!==v||g!==T||ki.current||$o?(typeof p=="function"&&(rv(e,n,p,r),T=e.memoizedState),(u=$o||kx(e,n,u,r,g,T,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,T,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,T,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=T),o.props=r,o.state=T,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return ov(t,e,n,r,s,i)}function ov(t,e,n,r,i,s){b_(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&xx(e,n,!1),so(t,e,s);r=e.stateNode,Gk.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=yu(e,t.child,null,s),e.child=yu(e,null,l,s)):mi(t,e,l,s),e.memoizedState=r.state,i&&xx(e,n,!0),e.child}function w_(t){var e=t.stateNode;e.pendingContext?yx(t,e.pendingContext,e.pendingContext!==e.context):e.context&&yx(t,e.context,!1),j1(t,e.containerInfo)}function Dx(t,e,n,r,i){return vu(),_1(i),e.flags|=256,mi(t,e,n,r),e.child}var lv={dehydrated:null,treeContext:null,retryLane:0};function cv(t){return{baseLanes:t,cachePool:null,transitions:null}}function N_(t,e,n){var r=e.pendingProps,i=$n.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),En($n,i&1),t===null)return tv(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=_p(o,r,0,null),t=nc(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=cv(n),e.memoizedState=lv,t):M1(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return Kk(t,e,o,r,l,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=al(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=al(l,s):(s=nc(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?cv(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=lv,r}return s=t.child,t=s.sibling,r=al(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function M1(t,e){return e=_p({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function wf(t,e,n,r){return r!==null&&_1(r),yu(e,t.child,null,n),t=M1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Kk(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Vg(Error(Ve(422))),wf(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=_p({mode:"visible",children:r.children},i,0,null),s=nc(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&yu(e,t.child,null,o),e.child.memoizedState=cv(o),e.memoizedState=lv,s);if(!(e.mode&1))return wf(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(Ve(419)),r=Vg(s,r,void 0),wf(t,e,o,r)}if(l=(o&t.childLanes)!==0,Si||l){if(r=Ir,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,io(t,i),Us(r,t,i,-1))}return z1(),r=Vg(Error(Ve(421))),wf(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=oT.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Ki=nl(i.nextSibling),Xi=e,Mn=!0,Os=null,t!==null&&(us[ds++]=Ka,us[ds++]=Ya,us[ds++]=oc,Ka=t.id,Ya=t.overflow,oc=e),e=M1(e,r.children),e.flags|=4096,e)}function Ox(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),nv(t.return,e,n)}function Bg(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function __(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(mi(t,e,r.children,n),r=$n.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ox(t,n,e);else if(t.tag===19)Ox(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(En($n,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Cm(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Bg(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Cm(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Bg(e,!0,n,null,s);break;case"together":Bg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Kf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function so(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),cc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Ve(153));if(e.child!==null){for(t=e.child,n=al(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=al(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Yk(t,e,n){switch(e.tag){case 3:w_(e),vu();break;case 5:YN(e);break;case 1:Ti(e.type)&&Em(e);break;case 4:j1(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;En(km,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(En($n,$n.current&1),e.flags|=128,null):n&e.child.childLanes?N_(t,e,n):(En($n,$n.current&1),t=so(t,e,n),t!==null?t.sibling:null);En($n,$n.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return __(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),En($n,$n.current),r)break;return null;case 22:case 23:return e.lanes=0,x_(t,e,n)}return so(t,e,n)}var E_,uv,A_,S_;E_=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};uv=function(){};A_=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Zl(ga.current);var s=null;switch(n){case"input":i=P0(t,i),r=P0(t,r),s=[];break;case"select":i=qn({},i,{value:void 0}),r=qn({},r,{value:void 0}),s=[];break;case"textarea":i=D0(t,i),r=D0(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Nm)}M0(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Wd.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Wd.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&jn("scroll",t),s||l===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};S_=function(t,e,n,r){n!==r&&(e.flags|=4)};function pd(t,e){if(!Mn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Qr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Qk(t,e,n){var r=e.pendingProps;switch(N1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qr(e),null;case 1:return Ti(e.type)&&_m(),Qr(e),null;case 3:return r=e.stateNode,xu(),Pn(ki),Pn(ai),I1(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(xf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Os!==null&&(yv(Os),Os=null))),uv(t,e),Qr(e),null;case 5:C1(e);var i=Zl(ih.current);if(n=e.type,t!==null&&e.stateNode!=null)A_(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Ve(166));return Qr(e),null}if(t=Zl(ga.current),xf(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[ha]=e,r[nh]=s,t=(e.mode&1)!==0,n){case"dialog":jn("cancel",r),jn("close",r);break;case"iframe":case"object":case"embed":jn("load",r);break;case"video":case"audio":for(i=0;i<_d.length;i++)jn(_d[i],r);break;case"source":jn("error",r);break;case"img":case"image":case"link":jn("error",r),jn("load",r);break;case"details":jn("toggle",r);break;case"input":H2(r,s),jn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},jn("invalid",r);break;case"textarea":G2(r,s),jn("invalid",r)}M0(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&yf(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&yf(r.textContent,l,t),i=["children",""+l]):Wd.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&jn("scroll",r)}switch(n){case"input":uf(r),W2(r,s,!0);break;case"textarea":uf(r),K2(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Nm)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=eN(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[ha]=e,t[nh]=r,E_(t,e,!1,!1),e.stateNode=t;e:{switch(o=F0(n,r),n){case"dialog":jn("cancel",t),jn("close",t),i=r;break;case"iframe":case"object":case"embed":jn("load",t),i=r;break;case"video":case"audio":for(i=0;i<_d.length;i++)jn(_d[i],t);i=r;break;case"source":jn("error",t),i=r;break;case"img":case"image":case"link":jn("error",t),jn("load",t),i=r;break;case"details":jn("toggle",t),i=r;break;case"input":H2(t,r),i=P0(t,r),jn("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=qn({},r,{value:void 0}),jn("invalid",t);break;case"textarea":G2(t,r),i=D0(t,r),jn("invalid",t);break;default:i=r}M0(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?rN(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&tN(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Gd(t,c):typeof c=="number"&&Gd(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Wd.hasOwnProperty(s)?c!=null&&s==="onScroll"&&jn("scroll",t):c!=null&&o1(t,s,c,o))}switch(n){case"input":uf(t),W2(t,r,!1);break;case"textarea":uf(t),K2(t);break;case"option":r.value!=null&&t.setAttribute("value",""+dl(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?eu(t,!!r.multiple,s,!1):r.defaultValue!=null&&eu(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Nm)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Qr(e),null;case 6:if(t&&e.stateNode!=null)S_(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Ve(166));if(n=Zl(ih.current),Zl(ga.current),xf(e)){if(r=e.stateNode,n=e.memoizedProps,r[ha]=e,(s=r.nodeValue!==n)&&(t=Xi,t!==null))switch(t.tag){case 3:yf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&yf(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ha]=e,e.stateNode=r}return Qr(e),null;case 13:if(Pn($n),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Mn&&Ki!==null&&e.mode&1&&!(e.flags&128))qN(),vu(),e.flags|=98560,s=!1;else if(s=xf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Ve(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ve(317));s[ha]=e}else vu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Qr(e),s=!1}else Os!==null&&(yv(Os),Os=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||$n.current&1?_r===0&&(_r=3):z1())),e.updateQueue!==null&&(e.flags|=4),Qr(e),null);case 4:return xu(),uv(t,e),t===null&&eh(e.stateNode.containerInfo),Qr(e),null;case 10:return S1(e.type._context),Qr(e),null;case 17:return Ti(e.type)&&_m(),Qr(e),null;case 19:if(Pn($n),s=e.memoizedState,s===null)return Qr(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)pd(s,!1);else{if(_r!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Cm(t),o!==null){for(e.flags|=128,pd(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return En($n,$n.current&1|2),e.child}t=t.sibling}s.tail!==null&&sr()>wu&&(e.flags|=128,r=!0,pd(s,!1),e.lanes=4194304)}else{if(!r)if(t=Cm(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),pd(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Mn)return Qr(e),null}else 2*sr()-s.renderingStartTime>wu&&n!==1073741824&&(e.flags|=128,r=!0,pd(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=sr(),e.sibling=null,n=$n.current,En($n,r?n&1|2:n&1),e):(Qr(e),null);case 22:case 23:return $1(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Gi&1073741824&&(Qr(e),e.subtreeFlags&6&&(e.flags|=8192)):Qr(e),null;case 24:return null;case 25:return null}throw Error(Ve(156,e.tag))}function Xk(t,e){switch(N1(e),e.tag){case 1:return Ti(e.type)&&_m(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return xu(),Pn(ki),Pn(ai),I1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return C1(e),null;case 13:if(Pn($n),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Ve(340));vu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Pn($n),null;case 4:return xu(),null;case 10:return S1(e.type._context),null;case 22:case 23:return $1(),null;case 24:return null;default:return null}}var Nf=!1,ri=!1,Jk=typeof WeakSet=="function"?WeakSet:Set,Ye=null;function Qc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Xn(t,e,r)}else n.current=null}function dv(t,e,n){try{n()}catch(r){Xn(t,e,r)}}var Mx=!1;function Zk(t,e){if(K0=xm,t=IN(),b1(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,f=0,v=t,g=null;t:for(;;){for(var p;v!==n||i!==0&&v.nodeType!==3||(l=o+i),v!==s||r!==0&&v.nodeType!==3||(c=o+r),v.nodeType===3&&(o+=v.nodeValue.length),(p=v.firstChild)!==null;)g=v,v=p;for(;;){if(v===t)break t;if(g===n&&++u===i&&(l=o),g===s&&++f===r&&(c=o),(p=v.nextSibling)!==null)break;v=g,g=v.parentNode}v=p}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Y0={focusedElem:t,selectionRange:n},xm=!1,Ye=e;Ye!==null;)if(e=Ye,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ye=t;else for(;Ye!==null;){e=Ye;try{var T=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var k=T.memoizedProps,C=T.memoizedState,b=e.stateNode,P=b.getSnapshotBeforeUpdate(e.elementType===e.type?k:Ls(e.type,k),C);b.__reactInternalSnapshotBeforeUpdate=P}break;case 3:var R=e.stateNode.containerInfo;R.nodeType===1?R.textContent="":R.nodeType===9&&R.documentElement&&R.removeChild(R.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ve(163))}}catch(D){Xn(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,Ye=t;break}Ye=e.return}return T=Mx,Mx=!1,T}function Od(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&dv(e,n,s)}i=i.next}while(i!==r)}}function wp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function hv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function k_(t){var e=t.alternate;e!==null&&(t.alternate=null,k_(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ha],delete e[nh],delete e[J0],delete e[Dk],delete e[Ok])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function T_(t){return t.tag===5||t.tag===3||t.tag===4}function Fx(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||T_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function fv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Nm));else if(r!==4&&(t=t.child,t!==null))for(fv(t,e,n),t=t.sibling;t!==null;)fv(t,e,n),t=t.sibling}function mv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(mv(t,e,n),t=t.sibling;t!==null;)mv(t,e,n),t=t.sibling}var Mr=null,Ds=!1;function Mo(t,e,n){for(n=n.child;n!==null;)j_(t,e,n),n=n.sibling}function j_(t,e,n){if(pa&&typeof pa.onCommitFiberUnmount=="function")try{pa.onCommitFiberUnmount(fp,n)}catch{}switch(n.tag){case 5:ri||Qc(n,e);case 6:var r=Mr,i=Ds;Mr=null,Mo(t,e,n),Mr=r,Ds=i,Mr!==null&&(Ds?(t=Mr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Mr.removeChild(n.stateNode));break;case 18:Mr!==null&&(Ds?(t=Mr,n=n.stateNode,t.nodeType===8?Lg(t.parentNode,n):t.nodeType===1&&Lg(t,n),Xd(t)):Lg(Mr,n.stateNode));break;case 4:r=Mr,i=Ds,Mr=n.stateNode.containerInfo,Ds=!0,Mo(t,e,n),Mr=r,Ds=i;break;case 0:case 11:case 14:case 15:if(!ri&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&dv(n,e,o),i=i.next}while(i!==r)}Mo(t,e,n);break;case 1:if(!ri&&(Qc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Xn(n,e,l)}Mo(t,e,n);break;case 21:Mo(t,e,n);break;case 22:n.mode&1?(ri=(r=ri)||n.memoizedState!==null,Mo(t,e,n),ri=r):Mo(t,e,n);break;default:Mo(t,e,n)}}function Ux(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Jk),e.forEach(function(r){var i=lT.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Ps(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Mr=l.stateNode,Ds=!1;break e;case 3:Mr=l.stateNode.containerInfo,Ds=!0;break e;case 4:Mr=l.stateNode.containerInfo,Ds=!0;break e}l=l.return}if(Mr===null)throw Error(Ve(160));j_(s,o,i),Mr=null,Ds=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){Xn(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)C_(e,t),e=e.sibling}function C_(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ps(e,t),la(t),r&4){try{Od(3,t,t.return),wp(3,t)}catch(k){Xn(t,t.return,k)}try{Od(5,t,t.return)}catch(k){Xn(t,t.return,k)}}break;case 1:Ps(e,t),la(t),r&512&&n!==null&&Qc(n,n.return);break;case 5:if(Ps(e,t),la(t),r&512&&n!==null&&Qc(n,n.return),t.flags&32){var i=t.stateNode;try{Gd(i,"")}catch(k){Xn(t,t.return,k)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&J5(i,s),F0(l,o);var u=F0(l,s);for(o=0;o<c.length;o+=2){var f=c[o],v=c[o+1];f==="style"?rN(i,v):f==="dangerouslySetInnerHTML"?tN(i,v):f==="children"?Gd(i,v):o1(i,f,v,u)}switch(l){case"input":R0(i,s);break;case"textarea":Z5(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?eu(i,!!s.multiple,p,!1):g!==!!s.multiple&&(s.defaultValue!=null?eu(i,!!s.multiple,s.defaultValue,!0):eu(i,!!s.multiple,s.multiple?[]:"",!1))}i[nh]=s}catch(k){Xn(t,t.return,k)}}break;case 6:if(Ps(e,t),la(t),r&4){if(t.stateNode===null)throw Error(Ve(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(k){Xn(t,t.return,k)}}break;case 3:if(Ps(e,t),la(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Xd(e.containerInfo)}catch(k){Xn(t,t.return,k)}break;case 4:Ps(e,t),la(t);break;case 13:Ps(e,t),la(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(V1=sr())),r&4&&Ux(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(ri=(u=ri)||f,Ps(e,t),ri=u):Ps(e,t),la(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(Ye=t,f=t.child;f!==null;){for(v=Ye=f;Ye!==null;){switch(g=Ye,p=g.child,g.tag){case 0:case 11:case 14:case 15:Od(4,g,g.return);break;case 1:Qc(g,g.return);var T=g.stateNode;if(typeof T.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,T.props=e.memoizedProps,T.state=e.memoizedState,T.componentWillUnmount()}catch(k){Xn(r,n,k)}}break;case 5:Qc(g,g.return);break;case 22:if(g.memoizedState!==null){Bx(v);continue}}p!==null?(p.return=g,Ye=p):Bx(v)}f=f.sibling}e:for(f=null,v=t;;){if(v.tag===5){if(f===null){f=v;try{i=v.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=v.stateNode,c=v.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=nN("display",o))}catch(k){Xn(t,t.return,k)}}}else if(v.tag===6){if(f===null)try{v.stateNode.nodeValue=u?"":v.memoizedProps}catch(k){Xn(t,t.return,k)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===t)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;f===v&&(f=null),v=v.return}f===v&&(f=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:Ps(e,t),la(t),r&4&&Ux(t);break;case 21:break;default:Ps(e,t),la(t)}}function la(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(T_(n)){var r=n;break e}n=n.return}throw Error(Ve(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Gd(i,""),r.flags&=-33);var s=Fx(t);mv(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Fx(t);fv(t,l,o);break;default:throw Error(Ve(161))}}catch(c){Xn(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function eT(t,e,n){Ye=t,I_(t)}function I_(t,e,n){for(var r=(t.mode&1)!==0;Ye!==null;){var i=Ye,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Nf;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||ri;l=Nf;var u=ri;if(Nf=o,(ri=c)&&!u)for(Ye=i;Ye!==null;)o=Ye,c=o.child,o.tag===22&&o.memoizedState!==null?$x(i):c!==null?(c.return=o,Ye=c):$x(i);for(;s!==null;)Ye=s,I_(s),s=s.sibling;Ye=i,Nf=l,ri=u}Vx(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Ye=s):Vx(t)}}function Vx(t){for(;Ye!==null;){var e=Ye;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ri||wp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ri)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Ls(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Ex(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Ex(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var v=f.dehydrated;v!==null&&Xd(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ve(163))}ri||e.flags&512&&hv(e)}catch(g){Xn(e,e.return,g)}}if(e===t){Ye=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ye=n;break}Ye=e.return}}function Bx(t){for(;Ye!==null;){var e=Ye;if(e===t){Ye=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ye=n;break}Ye=e.return}}function $x(t){for(;Ye!==null;){var e=Ye;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{wp(4,e)}catch(c){Xn(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Xn(e,i,c)}}var s=e.return;try{hv(e)}catch(c){Xn(e,s,c)}break;case 5:var o=e.return;try{hv(e)}catch(c){Xn(e,o,c)}}}catch(c){Xn(e,e.return,c)}if(e===t){Ye=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Ye=l;break}Ye=e.return}}var tT=Math.ceil,Rm=fo.ReactCurrentDispatcher,F1=fo.ReactCurrentOwner,ms=fo.ReactCurrentBatchConfig,Zt=0,Ir=null,mr=null,Vr=0,Gi=0,Xc=wl(0),_r=0,lh=null,cc=0,Np=0,U1=0,Md=null,Ei=null,V1=0,wu=1/0,Ha=null,Lm=!1,pv=null,il=null,_f=!1,Qo=null,Dm=0,Fd=0,gv=null,Yf=-1,Qf=0;function pi(){return Zt&6?sr():Yf!==-1?Yf:Yf=sr()}function sl(t){return t.mode&1?Zt&2&&Vr!==0?Vr&-Vr:Fk.transition!==null?(Qf===0&&(Qf=pN()),Qf):(t=fn,t!==0||(t=window.event,t=t===void 0?16:NN(t.type)),t):1}function Us(t,e,n,r){if(50<Fd)throw Fd=0,gv=null,Error(Ve(185));Nh(t,n,r),(!(Zt&2)||t!==Ir)&&(t===Ir&&(!(Zt&2)&&(Np|=n),_r===4&&qo(t,Vr)),ji(t,r),n===1&&Zt===0&&!(e.mode&1)&&(wu=sr()+500,yp&&Nl()))}function ji(t,e){var n=t.callbackNode;F3(t,e);var r=ym(t,t===Ir?Vr:0);if(r===0)n!==null&&X2(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&X2(n),e===1)t.tag===0?Mk(zx.bind(null,t)):BN(zx.bind(null,t)),Rk(function(){!(Zt&6)&&Nl()}),n=null;else{switch(gN(r)){case 1:n=h1;break;case 4:n=fN;break;case 16:n=vm;break;case 536870912:n=mN;break;default:n=vm}n=U_(n,P_.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function P_(t,e){if(Yf=-1,Qf=0,Zt&6)throw Error(Ve(327));var n=t.callbackNode;if(su()&&t.callbackNode!==n)return null;var r=ym(t,t===Ir?Vr:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Om(t,r);else{e=r;var i=Zt;Zt|=2;var s=L_();(Ir!==t||Vr!==e)&&(Ha=null,wu=sr()+500,tc(t,e));do try{iT();break}catch(l){R_(t,l)}while(!0);A1(),Rm.current=s,Zt=i,mr!==null?e=0:(Ir=null,Vr=0,e=_r)}if(e!==0){if(e===2&&(i=z0(t),i!==0&&(r=i,e=vv(t,i))),e===1)throw n=lh,tc(t,0),qo(t,r),ji(t,sr()),n;if(e===6)qo(t,r);else{if(i=t.current.alternate,!(r&30)&&!nT(i)&&(e=Om(t,r),e===2&&(s=z0(t),s!==0&&(r=s,e=vv(t,s))),e===1))throw n=lh,tc(t,0),qo(t,r),ji(t,sr()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Ve(345));case 2:Wl(t,Ei,Ha);break;case 3:if(qo(t,r),(r&130023424)===r&&(e=V1+500-sr(),10<e)){if(ym(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){pi(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=X0(Wl.bind(null,t,Ei,Ha),e);break}Wl(t,Ei,Ha);break;case 4:if(qo(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Fs(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=sr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*tT(r/1960))-r,10<r){t.timeoutHandle=X0(Wl.bind(null,t,Ei,Ha),r);break}Wl(t,Ei,Ha);break;case 5:Wl(t,Ei,Ha);break;default:throw Error(Ve(329))}}}return ji(t,sr()),t.callbackNode===n?P_.bind(null,t):null}function vv(t,e){var n=Md;return t.current.memoizedState.isDehydrated&&(tc(t,e).flags|=256),t=Om(t,e),t!==2&&(e=Ei,Ei=n,e!==null&&yv(e)),t}function yv(t){Ei===null?Ei=t:Ei.push.apply(Ei,t)}function nT(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Vs(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function qo(t,e){for(e&=~U1,e&=~Np,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Fs(e),r=1<<n;t[n]=-1,e&=~r}}function zx(t){if(Zt&6)throw Error(Ve(327));su();var e=ym(t,0);if(!(e&1))return ji(t,sr()),null;var n=Om(t,e);if(t.tag!==0&&n===2){var r=z0(t);r!==0&&(e=r,n=vv(t,r))}if(n===1)throw n=lh,tc(t,0),qo(t,e),ji(t,sr()),n;if(n===6)throw Error(Ve(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Wl(t,Ei,Ha),ji(t,sr()),null}function B1(t,e){var n=Zt;Zt|=1;try{return t(e)}finally{Zt=n,Zt===0&&(wu=sr()+500,yp&&Nl())}}function uc(t){Qo!==null&&Qo.tag===0&&!(Zt&6)&&su();var e=Zt;Zt|=1;var n=ms.transition,r=fn;try{if(ms.transition=null,fn=1,t)return t()}finally{fn=r,ms.transition=n,Zt=e,!(Zt&6)&&Nl()}}function $1(){Gi=Xc.current,Pn(Xc)}function tc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Pk(n)),mr!==null)for(n=mr.return;n!==null;){var r=n;switch(N1(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&_m();break;case 3:xu(),Pn(ki),Pn(ai),I1();break;case 5:C1(r);break;case 4:xu();break;case 13:Pn($n);break;case 19:Pn($n);break;case 10:S1(r.type._context);break;case 22:case 23:$1()}n=n.return}if(Ir=t,mr=t=al(t.current,null),Vr=Gi=e,_r=0,lh=null,U1=Np=cc=0,Ei=Md=null,Jl!==null){for(e=0;e<Jl.length;e++)if(n=Jl[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Jl=null}return t}function R_(t,e){do{var n=mr;try{if(A1(),Wf.current=Pm,Im){for(var r=zn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Im=!1}if(lc=0,jr=wr=zn=null,Dd=!1,sh=0,F1.current=null,n===null||n.return===null){_r=1,lh=e,mr=null;break}e:{var s=t,o=n.return,l=n,c=e;if(e=Vr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=l,v=f.tag;if(!(f.mode&1)&&(v===0||v===11||v===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=Cx(o);if(p!==null){p.flags&=-257,Ix(p,o,l,s,e),p.mode&1&&jx(s,u,e),e=p,c=u;var T=e.updateQueue;if(T===null){var k=new Set;k.add(c),e.updateQueue=k}else T.add(c);break e}else{if(!(e&1)){jx(s,u,e),z1();break e}c=Error(Ve(426))}}else if(Mn&&l.mode&1){var C=Cx(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),Ix(C,o,l,s,e),_1(bu(c,l));break e}}s=c=bu(c,l),_r!==4&&(_r=2),Md===null?Md=[s]:Md.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var b=g_(s,c,e);_x(s,b);break e;case 1:l=c;var P=s.type,R=s.stateNode;if(!(s.flags&128)&&(typeof P.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(il===null||!il.has(R)))){s.flags|=65536,e&=-e,s.lanes|=e;var D=v_(s,l,e);_x(s,D);break e}}s=s.return}while(s!==null)}O_(n)}catch(Z){e=Z,mr===n&&n!==null&&(mr=n=n.return);continue}break}while(!0)}function L_(){var t=Rm.current;return Rm.current=Pm,t===null?Pm:t}function z1(){(_r===0||_r===3||_r===2)&&(_r=4),Ir===null||!(cc&268435455)&&!(Np&268435455)||qo(Ir,Vr)}function Om(t,e){var n=Zt;Zt|=2;var r=L_();(Ir!==t||Vr!==e)&&(Ha=null,tc(t,e));do try{rT();break}catch(i){R_(t,i)}while(!0);if(A1(),Zt=n,Rm.current=r,mr!==null)throw Error(Ve(261));return Ir=null,Vr=0,_r}function rT(){for(;mr!==null;)D_(mr)}function iT(){for(;mr!==null&&!j3();)D_(mr)}function D_(t){var e=F_(t.alternate,t,Gi);t.memoizedProps=t.pendingProps,e===null?O_(t):mr=e,F1.current=null}function O_(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Xk(n,e),n!==null){n.flags&=32767,mr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{_r=6,mr=null;return}}else if(n=Qk(n,e,Gi),n!==null){mr=n;return}if(e=e.sibling,e!==null){mr=e;return}mr=e=t}while(e!==null);_r===0&&(_r=5)}function Wl(t,e,n){var r=fn,i=ms.transition;try{ms.transition=null,fn=1,sT(t,e,n,r)}finally{ms.transition=i,fn=r}return null}function sT(t,e,n,r){do su();while(Qo!==null);if(Zt&6)throw Error(Ve(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Ve(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(U3(t,s),t===Ir&&(mr=Ir=null,Vr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||_f||(_f=!0,U_(vm,function(){return su(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=ms.transition,ms.transition=null;var o=fn;fn=1;var l=Zt;Zt|=4,F1.current=null,Zk(t,n),C_(n,t),Ak(Y0),xm=!!K0,Y0=K0=null,t.current=n,eT(n),C3(),Zt=l,fn=o,ms.transition=s}else t.current=n;if(_f&&(_f=!1,Qo=t,Dm=i),s=t.pendingLanes,s===0&&(il=null),R3(n.stateNode),ji(t,sr()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Lm)throw Lm=!1,t=pv,pv=null,t;return Dm&1&&t.tag!==0&&su(),s=t.pendingLanes,s&1?t===gv?Fd++:(Fd=0,gv=t):Fd=0,Nl(),null}function su(){if(Qo!==null){var t=gN(Dm),e=ms.transition,n=fn;try{if(ms.transition=null,fn=16>t?16:t,Qo===null)var r=!1;else{if(t=Qo,Qo=null,Dm=0,Zt&6)throw Error(Ve(331));var i=Zt;for(Zt|=4,Ye=t.current;Ye!==null;){var s=Ye,o=s.child;if(Ye.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Ye=u;Ye!==null;){var f=Ye;switch(f.tag){case 0:case 11:case 15:Od(8,f,s)}var v=f.child;if(v!==null)v.return=f,Ye=v;else for(;Ye!==null;){f=Ye;var g=f.sibling,p=f.return;if(k_(f),f===u){Ye=null;break}if(g!==null){g.return=p,Ye=g;break}Ye=p}}}var T=s.alternate;if(T!==null){var k=T.child;if(k!==null){T.child=null;do{var C=k.sibling;k.sibling=null,k=C}while(k!==null)}}Ye=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Ye=o;else e:for(;Ye!==null;){if(s=Ye,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Od(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,Ye=b;break e}Ye=s.return}}var P=t.current;for(Ye=P;Ye!==null;){o=Ye;var R=o.child;if(o.subtreeFlags&2064&&R!==null)R.return=o,Ye=R;else e:for(o=P;Ye!==null;){if(l=Ye,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:wp(9,l)}}catch(Z){Xn(l,l.return,Z)}if(l===o){Ye=null;break e}var D=l.sibling;if(D!==null){D.return=l.return,Ye=D;break e}Ye=l.return}}if(Zt=i,Nl(),pa&&typeof pa.onPostCommitFiberRoot=="function")try{pa.onPostCommitFiberRoot(fp,t)}catch{}r=!0}return r}finally{fn=n,ms.transition=e}}return!1}function qx(t,e,n){e=bu(n,e),e=g_(t,e,1),t=rl(t,e,1),e=pi(),t!==null&&(Nh(t,1,e),ji(t,e))}function Xn(t,e,n){if(t.tag===3)qx(t,t,n);else for(;e!==null;){if(e.tag===3){qx(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(il===null||!il.has(r))){t=bu(n,t),t=v_(e,t,1),e=rl(e,t,1),t=pi(),e!==null&&(Nh(e,1,t),ji(e,t));break}}e=e.return}}function aT(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=pi(),t.pingedLanes|=t.suspendedLanes&n,Ir===t&&(Vr&n)===n&&(_r===4||_r===3&&(Vr&130023424)===Vr&&500>sr()-V1?tc(t,0):U1|=n),ji(t,e)}function M_(t,e){e===0&&(t.mode&1?(e=ff,ff<<=1,!(ff&130023424)&&(ff=4194304)):e=1);var n=pi();t=io(t,e),t!==null&&(Nh(t,e,n),ji(t,n))}function oT(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),M_(t,n)}function lT(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Ve(314))}r!==null&&r.delete(e),M_(t,n)}var F_;F_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ki.current)Si=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Si=!1,Yk(t,e,n);Si=!!(t.flags&131072)}else Si=!1,Mn&&e.flags&1048576&&$N(e,Sm,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Kf(t,e),t=e.pendingProps;var i=gu(e,ai.current);iu(e,n),i=R1(null,e,r,t,i,n);var s=L1();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ti(r)?(s=!0,Em(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,T1(e),i.updater=bp,e.stateNode=i,i._reactInternals=e,iv(e,r,t,n),e=ov(null,e,r,!0,s,n)):(e.tag=0,Mn&&s&&w1(e),mi(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Kf(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=uT(r),t=Ls(r,t),i){case 0:e=av(null,e,r,t,n);break e;case 1:e=Lx(null,e,r,t,n);break e;case 11:e=Px(null,e,r,t,n);break e;case 14:e=Rx(null,e,r,Ls(r.type,t),n);break e}throw Error(Ve(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ls(r,i),av(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ls(r,i),Lx(t,e,r,i,n);case 3:e:{if(w_(e),t===null)throw Error(Ve(387));r=e.pendingProps,s=e.memoizedState,i=s.element,KN(t,e),jm(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=bu(Error(Ve(423)),e),e=Dx(t,e,r,n,i);break e}else if(r!==i){i=bu(Error(Ve(424)),e),e=Dx(t,e,r,n,i);break e}else for(Ki=nl(e.stateNode.containerInfo.firstChild),Xi=e,Mn=!0,Os=null,n=WN(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(vu(),r===i){e=so(t,e,n);break e}mi(t,e,r,n)}e=e.child}return e;case 5:return YN(e),t===null&&tv(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Q0(r,i)?o=null:s!==null&&Q0(r,s)&&(e.flags|=32),b_(t,e),mi(t,e,o,n),e.child;case 6:return t===null&&tv(e),null;case 13:return N_(t,e,n);case 4:return j1(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=yu(e,null,r,n):mi(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ls(r,i),Px(t,e,r,i,n);case 7:return mi(t,e,e.pendingProps,n),e.child;case 8:return mi(t,e,e.pendingProps.children,n),e.child;case 12:return mi(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,En(km,r._currentValue),r._currentValue=o,s!==null)if(Vs(s.value,o)){if(s.children===i.children&&!ki.current){e=so(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Za(-1,n&-n),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),nv(s.return,n,e),l.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Ve(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),nv(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}mi(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,iu(e,n),i=ys(i),r=r(i),e.flags|=1,mi(t,e,r,n),e.child;case 14:return r=e.type,i=Ls(r,e.pendingProps),i=Ls(r.type,i),Rx(t,e,r,i,n);case 15:return y_(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ls(r,i),Kf(t,e),e.tag=1,Ti(r)?(t=!0,Em(e)):t=!1,iu(e,n),p_(e,r,i),iv(e,r,i,n),ov(null,e,r,!0,t,n);case 19:return __(t,e,n);case 22:return x_(t,e,n)}throw Error(Ve(156,e.tag))};function U_(t,e){return hN(t,e)}function cT(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fs(t,e,n,r){return new cT(t,e,n,r)}function q1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function uT(t){if(typeof t=="function")return q1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===c1)return 11;if(t===u1)return 14}return 2}function al(t,e){var n=t.alternate;return n===null?(n=fs(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Xf(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")q1(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Bc:return nc(n.children,i,s,e);case l1:o=8,i|=8;break;case T0:return t=fs(12,n,e,i|2),t.elementType=T0,t.lanes=s,t;case j0:return t=fs(13,n,e,i),t.elementType=j0,t.lanes=s,t;case C0:return t=fs(19,n,e,i),t.elementType=C0,t.lanes=s,t;case Y5:return _p(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case G5:o=10;break e;case K5:o=9;break e;case c1:o=11;break e;case u1:o=14;break e;case Bo:o=16,r=null;break e}throw Error(Ve(130,t==null?t:typeof t,""))}return e=fs(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function nc(t,e,n,r){return t=fs(7,t,r,e),t.lanes=n,t}function _p(t,e,n,r){return t=fs(22,t,r,e),t.elementType=Y5,t.lanes=n,t.stateNode={isHidden:!1},t}function $g(t,e,n){return t=fs(6,t,null,e),t.lanes=n,t}function zg(t,e,n){return e=fs(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function dT(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_g(0),this.expirationTimes=_g(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_g(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function H1(t,e,n,r,i,s,o,l,c){return t=new dT(t,e,n,l,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=fs(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},T1(s),t}function hT(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function V_(t){if(!t)return hl;t=t._reactInternals;e:{if(xc(t)!==t||t.tag!==1)throw Error(Ve(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ti(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ve(171))}if(t.tag===1){var n=t.type;if(Ti(n))return VN(t,n,e)}return e}function B_(t,e,n,r,i,s,o,l,c){return t=H1(n,r,!0,t,i,s,o,l,c),t.context=V_(null),n=t.current,r=pi(),i=sl(n),s=Za(r,i),s.callback=e??null,rl(n,s,i),t.current.lanes=i,Nh(t,i,r),ji(t,r),t}function Ep(t,e,n,r){var i=e.current,s=pi(),o=sl(i);return n=V_(n),e.context===null?e.context=n:e.pendingContext=n,e=Za(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=rl(i,e,o),t!==null&&(Us(t,i,o,s),Hf(t,i,o)),o}function Mm(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Hx(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function W1(t,e){Hx(t,e),(t=t.alternate)&&Hx(t,e)}function fT(){return null}var $_=typeof reportError=="function"?reportError:function(t){console.error(t)};function G1(t){this._internalRoot=t}Ap.prototype.render=G1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Ve(409));Ep(t,e,null,null)};Ap.prototype.unmount=G1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;uc(function(){Ep(null,t,null,null)}),e[ro]=null}};function Ap(t){this._internalRoot=t}Ap.prototype.unstable_scheduleHydration=function(t){if(t){var e=xN();t={blockedOn:null,target:t,priority:e};for(var n=0;n<zo.length&&e!==0&&e<zo[n].priority;n++);zo.splice(n,0,t),n===0&&wN(t)}};function K1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Sp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Wx(){}function mT(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Mm(o);s.call(u)}}var o=B_(e,r,t,0,null,!1,!1,"",Wx);return t._reactRootContainer=o,t[ro]=o.current,eh(t.nodeType===8?t.parentNode:t),uc(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=Mm(c);l.call(u)}}var c=H1(t,0,!1,null,null,!1,!1,"",Wx);return t._reactRootContainer=c,t[ro]=c.current,eh(t.nodeType===8?t.parentNode:t),uc(function(){Ep(e,c,n,r)}),c}function kp(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=Mm(o);l.call(c)}}Ep(e,o,t,i)}else o=mT(n,e,t,i,r);return Mm(o)}vN=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Nd(e.pendingLanes);n!==0&&(f1(e,n|1),ji(e,sr()),!(Zt&6)&&(wu=sr()+500,Nl()))}break;case 13:uc(function(){var r=io(t,1);if(r!==null){var i=pi();Us(r,t,1,i)}}),W1(t,1)}};m1=function(t){if(t.tag===13){var e=io(t,134217728);if(e!==null){var n=pi();Us(e,t,134217728,n)}W1(t,134217728)}};yN=function(t){if(t.tag===13){var e=sl(t),n=io(t,e);if(n!==null){var r=pi();Us(n,t,e,r)}W1(t,e)}};xN=function(){return fn};bN=function(t,e){var n=fn;try{return fn=t,e()}finally{fn=n}};V0=function(t,e,n){switch(e){case"input":if(R0(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=vp(r);if(!i)throw Error(Ve(90));X5(r),R0(r,i)}}}break;case"textarea":Z5(t,n);break;case"select":e=n.value,e!=null&&eu(t,!!n.multiple,e,!1)}};aN=B1;oN=uc;var pT={usingClientEntryPoint:!1,Events:[Eh,Hc,vp,iN,sN,B1]},gd={findFiberByHostInstance:Xl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},gT={bundleType:gd.bundleType,version:gd.version,rendererPackageName:gd.rendererPackageName,rendererConfig:gd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=uN(t),t===null?null:t.stateNode},findFiberByHostInstance:gd.findFiberByHostInstance||fT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ef=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ef.isDisabled&&Ef.supportsFiber)try{fp=Ef.inject(gT),pa=Ef}catch{}}es.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pT;es.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!K1(e))throw Error(Ve(200));return hT(t,e,null,n)};es.createRoot=function(t,e){if(!K1(t))throw Error(Ve(299));var n=!1,r="",i=$_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=H1(t,1,!1,null,null,n,!1,r,i),t[ro]=e.current,eh(t.nodeType===8?t.parentNode:t),new G1(e)};es.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Ve(188)):(t=Object.keys(t).join(","),Error(Ve(268,t)));return t=uN(e),t=t===null?null:t.stateNode,t};es.flushSync=function(t){return uc(t)};es.hydrate=function(t,e,n){if(!Sp(e))throw Error(Ve(200));return kp(null,t,e,!0,n)};es.hydrateRoot=function(t,e,n){if(!K1(t))throw Error(Ve(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=$_;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=B_(e,null,t,1,n??null,i,!1,s,o),t[ro]=e.current,eh(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Ap(e)};es.render=function(t,e,n){if(!Sp(e))throw Error(Ve(200));return kp(null,t,e,!1,n)};es.unmountComponentAtNode=function(t){if(!Sp(t))throw Error(Ve(40));return t._reactRootContainer?(uc(function(){kp(null,null,t,!1,function(){t._reactRootContainer=null,t[ro]=null})}),!0):!1};es.unstable_batchedUpdates=B1;es.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Sp(n))throw Error(Ve(200));if(t==null||t._reactInternals===void 0)throw Error(Ve(38));return kp(t,e,n,!1,r)};es.version="18.3.1-next-f1338f8080-20240426";function z_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(z_)}catch(t){console.error(t)}}z_(),z5.exports=es;var vT=z5.exports,Gx=vT;S0.createRoot=Gx.createRoot,S0.hydrateRoot=Gx.hydrateRoot;var Kx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},yT=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],l=t[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},H_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,l=o?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,f=s>>2,v=(s&3)<<4|l>>4;let g=(l&15)<<2|u>>6,p=u&63;c||(p=64,o||(g=64)),r.push(n[f],n[v],n[g],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(q_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):yT(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const v=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||l==null||u==null||v==null)throw new xT;const g=s<<2|l>>4;if(r.push(g),u!==64){const p=l<<4&240|u>>2;if(r.push(p),v!==64){const T=u<<6&192|v;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class xT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const bT=function(t){const e=q_(t);return H_.encodeByteArray(e,!0)},Fm=function(t){return bT(t).replace(/\./g,"")},W_=function(t){try{return H_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT=()=>wT().__FIREBASE_DEFAULTS__,_T=()=>{if(typeof process>"u"||typeof Kx>"u")return;const t=Kx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},ET=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&W_(t[1]);return e&&JSON.parse(e)},Tp=()=>{try{return NT()||_T()||ET()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},G_=t=>{var e,n;return(n=(e=Tp())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Y1=t=>{const e=G_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},K_=()=>{var t;return(t=Tp())===null||t===void 0?void 0:t.config},Y_=t=>{var e;return(e=Tp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q_(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Fm(JSON.stringify(n)),Fm(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ST(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(oi())}function kT(){var t;const e=(t=Tp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function TT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function jT(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function CT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function IT(){const t=oi();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function PT(){return!kT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function RT(){try{return typeof indexedDB=="object"}catch{return!1}}function LT(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DT="FirebaseError";class Ea extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=DT,Object.setPrototypeOf(this,Ea.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Sh.prototype.create)}}class Sh{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?OT(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Ea(i,l,r)}}function OT(t,e){return t.replace(MT,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const MT=/\{\$([^}]+)}/g;function FT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Um(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(Yx(s)&&Yx(o)){if(!Um(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Yx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kh(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ed(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Ad(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function UT(t,e){const n=new VT(t,e);return n.subscribe.bind(n)}class VT{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");BT(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=qg),i.error===void 0&&(i.error=qg),i.complete===void 0&&(i.complete=qg);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function BT(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function qg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bn(t){return t&&t._delegate?t._delegate:t}class ao{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new AT;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(qT(e))try{this.getOrInitializeService({instanceIdentifier:Gl})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Gl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Gl){return this.instances.has(e)}getOptions(e=Gl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:zT(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Gl){return this.component?this.component.multipleInstances?e:Gl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function zT(t){return t===Gl?void 0:t}function qT(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new $T(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Wt||(Wt={}));const WT={debug:Wt.DEBUG,verbose:Wt.VERBOSE,info:Wt.INFO,warn:Wt.WARN,error:Wt.ERROR,silent:Wt.SILENT},GT=Wt.INFO,KT={[Wt.DEBUG]:"log",[Wt.VERBOSE]:"log",[Wt.INFO]:"info",[Wt.WARN]:"warn",[Wt.ERROR]:"error"},YT=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=KT[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Q1{constructor(e){this.name=e,this._logLevel=GT,this._logHandler=YT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Wt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?WT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Wt.DEBUG,...e),this._logHandler(this,Wt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Wt.VERBOSE,...e),this._logHandler(this,Wt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Wt.INFO,...e),this._logHandler(this,Wt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Wt.WARN,...e),this._logHandler(this,Wt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Wt.ERROR,...e),this._logHandler(this,Wt.ERROR,...e)}}const QT=(t,e)=>e.some(n=>t instanceof n);let Qx,Xx;function XT(){return Qx||(Qx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function JT(){return Xx||(Xx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const X_=new WeakMap,xv=new WeakMap,J_=new WeakMap,Hg=new WeakMap,X1=new WeakMap;function ZT(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(ol(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&X_.set(n,t)}).catch(()=>{}),X1.set(e,t),e}function ej(t){if(xv.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});xv.set(t,e)}let bv={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return xv.get(t);if(e==="objectStoreNames")return t.objectStoreNames||J_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ol(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function tj(t){bv=t(bv)}function nj(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Wg(this),e,...n);return J_.set(r,e.sort?e.sort():[e]),ol(r)}:JT().includes(t)?function(...e){return t.apply(Wg(this),e),ol(X_.get(this))}:function(...e){return ol(t.apply(Wg(this),e))}}function rj(t){return typeof t=="function"?nj(t):(t instanceof IDBTransaction&&ej(t),QT(t,XT())?new Proxy(t,bv):t)}function ol(t){if(t instanceof IDBRequest)return ZT(t);if(Hg.has(t))return Hg.get(t);const e=rj(t);return e!==t&&(Hg.set(t,e),X1.set(e,t)),e}const Wg=t=>X1.get(t);function ij(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),l=ol(o);return r&&o.addEventListener("upgradeneeded",c=>{r(ol(o.result),c.oldVersion,c.newVersion,ol(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const sj=["get","getKey","getAll","getAllKeys","count"],aj=["put","add","delete","clear"],Gg=new Map;function Jx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Gg.get(e))return Gg.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=aj.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||sj.includes(n)))return;const s=async function(o,...l){const c=this.transaction(o,i?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),i&&c.done]))[0]};return Gg.set(e,s),s}tj(t=>({...t,get:(e,n,r)=>Jx(e,n)||t.get(e,n,r),has:(e,n)=>!!Jx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oj{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(lj(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function lj(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const wv="@firebase/app",Zx="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oo=new Q1("@firebase/app"),cj="@firebase/app-compat",uj="@firebase/analytics-compat",dj="@firebase/analytics",hj="@firebase/app-check-compat",fj="@firebase/app-check",mj="@firebase/auth",pj="@firebase/auth-compat",gj="@firebase/database",vj="@firebase/data-connect",yj="@firebase/database-compat",xj="@firebase/functions",bj="@firebase/functions-compat",wj="@firebase/installations",Nj="@firebase/installations-compat",_j="@firebase/messaging",Ej="@firebase/messaging-compat",Aj="@firebase/performance",Sj="@firebase/performance-compat",kj="@firebase/remote-config",Tj="@firebase/remote-config-compat",jj="@firebase/storage",Cj="@firebase/storage-compat",Ij="@firebase/firestore",Pj="@firebase/vertexai-preview",Rj="@firebase/firestore-compat",Lj="firebase",Dj="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nv="[DEFAULT]",Oj={[wv]:"fire-core",[cj]:"fire-core-compat",[dj]:"fire-analytics",[uj]:"fire-analytics-compat",[fj]:"fire-app-check",[hj]:"fire-app-check-compat",[mj]:"fire-auth",[pj]:"fire-auth-compat",[gj]:"fire-rtdb",[vj]:"fire-data-connect",[yj]:"fire-rtdb-compat",[xj]:"fire-fn",[bj]:"fire-fn-compat",[wj]:"fire-iid",[Nj]:"fire-iid-compat",[_j]:"fire-fcm",[Ej]:"fire-fcm-compat",[Aj]:"fire-perf",[Sj]:"fire-perf-compat",[kj]:"fire-rc",[Tj]:"fire-rc-compat",[jj]:"fire-gcs",[Cj]:"fire-gcs-compat",[Ij]:"fire-fst",[Rj]:"fire-fst-compat",[Pj]:"fire-vertex","fire-js":"fire-js",[Lj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm=new Map,Mj=new Map,_v=new Map;function eb(t,e){try{t.container.addComponent(e)}catch(n){oo.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function fl(t){const e=t.name;if(_v.has(e))return oo.debug(`There were multiple attempts to register component ${e}.`),!1;_v.set(e,t);for(const n of Vm.values())eb(n,t);for(const n of Mj.values())eb(n,t);return!0}function Th(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function fa(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ll=new Sh("app","Firebase",Fj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uj{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ao("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ll.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bc=Dj;function Z_(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Nv,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw ll.create("bad-app-name",{appName:String(i)});if(n||(n=K_()),!n)throw ll.create("no-options");const s=Vm.get(i);if(s){if(Um(n,s.options)&&Um(r,s.config))return s;throw ll.create("duplicate-app",{appName:i})}const o=new HT(i);for(const c of _v.values())o.addComponent(c);const l=new Uj(n,r,o);return Vm.set(i,l),l}function jp(t=Nv){const e=Vm.get(t);if(!e&&t===Nv&&K_())return Z_();if(!e)throw ll.create("no-app",{appName:t});return e}function ps(t,e,n){var r;let i=(r=Oj[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),oo.warn(l.join(" "));return}fl(new ao(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vj="firebase-heartbeat-database",Bj=1,ch="firebase-heartbeat-store";let Kg=null;function e4(){return Kg||(Kg=ij(Vj,Bj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ch)}catch(n){console.warn(n)}}}}).catch(t=>{throw ll.create("idb-open",{originalErrorMessage:t.message})})),Kg}async function $j(t){try{const n=(await e4()).transaction(ch),r=await n.objectStore(ch).get(t4(t));return await n.done,r}catch(e){if(e instanceof Ea)oo.warn(e.message);else{const n=ll.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});oo.warn(n.message)}}}async function tb(t,e){try{const r=(await e4()).transaction(ch,"readwrite");await r.objectStore(ch).put(e,t4(t)),await r.done}catch(n){if(n instanceof Ea)oo.warn(n.message);else{const r=ll.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});oo.warn(r.message)}}}function t4(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj=1024,qj=30*24*60*60*1e3;class Hj{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Gj(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=nb();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=qj}),this._storage.overwrite(this._heartbeatsCache))}catch(r){oo.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=nb(),{heartbeatsToSend:r,unsentEntries:i}=Wj(this._heartbeatsCache.heartbeats),s=Fm(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return oo.warn(n),""}}}function nb(){return new Date().toISOString().substring(0,10)}function Wj(t,e=zj){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),rb(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),rb(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Gj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return RT()?LT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await $j(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return tb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return tb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function rb(t){return Fm(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kj(t){fl(new ao("platform-logger",e=>new oj(e),"PRIVATE")),fl(new ao("heartbeat",e=>new Hj(e),"PRIVATE")),ps(wv,Zx,t),ps(wv,Zx,"esm2017"),ps("fire-js","")}Kj("");function J1(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function n4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Yj=n4,r4=new Sh("auth","Firebase",n4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bm=new Q1("@firebase/auth");function Qj(t,...e){Bm.logLevel<=Wt.WARN&&Bm.warn(`Auth (${bc}): ${t}`,...e)}function Jf(t,...e){Bm.logLevel<=Wt.ERROR&&Bm.error(`Auth (${bc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bs(t,...e){throw Z1(t,...e)}function va(t,...e){return Z1(t,...e)}function i4(t,e,n){const r=Object.assign(Object.assign({},Yj()),{[e]:n});return new Sh("auth","Firebase",r).create(e,{appName:t.name})}function eo(t){return i4(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Z1(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return r4.create(t,...e)}function gt(t,e,...n){if(!t)throw Z1(e,...n)}function Qa(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Jf(e),new Error(e)}function lo(t,e){t||Qa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ev(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Xj(){return ib()==="http:"||ib()==="https:"}function ib(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Xj()||jT()||"connection"in navigator)?navigator.onLine:!0}function Zj(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{constructor(e,n){this.shortDelay=e,this.longDelay=n,lo(n>e,"Short delay should be less than long delay!"),this.isMobile=ST()||CT()}get(){return Jj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ey(t,e){lo(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s4{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Qa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Qa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Qa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC=new jh(3e4,6e4);function Aa(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function zs(t,e,n,r,i={}){return a4(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const l=kh(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},s);return TT()||(u.referrerPolicy="no-referrer"),s4.fetch()(o4(t,t.config.apiHost,n,l),u)})}async function a4(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},eC),e);try{const i=new rC(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Af(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Af(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Af(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Af(t,"user-disabled",o);const f=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw i4(t,f,u);bs(t,f)}}catch(i){if(i instanceof Ea)throw i;bs(t,"network-request-failed",{message:String(i)})}}async function Ch(t,e,n,r,i={}){const s=await zs(t,e,n,r,i);return"mfaPendingCredential"in s&&bs(t,"multi-factor-auth-required",{_serverResponse:s}),s}function o4(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?ey(t.config,i):`${t.config.apiScheme}://${i}`}function nC(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class rC{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(va(this.auth,"network-request-failed")),tC.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Af(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=va(t,e,r);return i.customData._tokenResponse=n,i}function sb(t){return t!==void 0&&t.enterprise!==void 0}class iC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return nC(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function sC(t,e){return zs(t,"GET","/v2/recaptchaConfig",Aa(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aC(t,e){return zs(t,"POST","/v1/accounts:delete",e)}async function l4(t,e){return zs(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ud(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function oC(t,e=!1){const n=bn(t),r=await n.getIdToken(e),i=ty(r);gt(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Ud(Yg(i.auth_time)),issuedAtTime:Ud(Yg(i.iat)),expirationTime:Ud(Yg(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Yg(t){return Number(t)*1e3}function ty(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Jf("JWT malformed, contained fewer than 3 sections"),null;try{const i=W_(n);return i?JSON.parse(i):(Jf("Failed to decode base64 JWT payload"),null)}catch(i){return Jf("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function ab(t){const e=ty(t);return gt(e,"internal-error"),gt(typeof e.exp<"u","internal-error"),gt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ea&&lC(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function lC({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ud(this.lastLoginAt),this.creationTime=Ud(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $m(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Nu(t,l4(n,{idToken:r}));gt(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?c4(s.providerUserInfo):[],l=dC(t.providerData,o),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),f=c?u:!1,v={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new Av(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,v)}async function uC(t){const e=bn(t);await $m(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function dC(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function c4(t){return t.map(e=>{var{providerId:n}=e,r=J1(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hC(t,e){const n=await a4(t,{},async()=>{const r=kh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=o4(t,i,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",s4.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function fC(t,e){return zs(t,"POST","/v2/accounts:revokeToken",Aa(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){gt(e.idToken,"internal-error"),gt(typeof e.idToken<"u","internal-error"),gt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ab(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){gt(e.length!==0,"internal-error");const n=ab(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(gt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await hC(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new au;return r&&(gt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(gt(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(gt(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new au,this.toJSON())}_performRefresh(){return Qa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fo(t,e){gt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Xa{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=J1(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new cC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Av(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Nu(this,this.stsTokenManager.getToken(this.auth,e));return gt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return oC(this,e)}reload(){return uC(this)}_assign(e){this!==e&&(gt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Xa(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){gt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await $m(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(fa(this.auth.app))return Promise.reject(eo(this.auth));const e=await this.getIdToken();return await Nu(this,aC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,l,c,u,f;const v=(r=n.displayName)!==null&&r!==void 0?r:void 0,g=(i=n.email)!==null&&i!==void 0?i:void 0,p=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,T=(o=n.photoURL)!==null&&o!==void 0?o:void 0,k=(l=n.tenantId)!==null&&l!==void 0?l:void 0,C=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,b=(u=n.createdAt)!==null&&u!==void 0?u:void 0,P=(f=n.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:R,emailVerified:D,isAnonymous:Z,providerData:le,stsTokenManager:U}=n;gt(R&&U,e,"internal-error");const j=au.fromJSON(this.name,U);gt(typeof R=="string",e,"internal-error"),Fo(v,e.name),Fo(g,e.name),gt(typeof D=="boolean",e,"internal-error"),gt(typeof Z=="boolean",e,"internal-error"),Fo(p,e.name),Fo(T,e.name),Fo(k,e.name),Fo(C,e.name),Fo(b,e.name),Fo(P,e.name);const _=new Xa({uid:R,auth:e,email:g,emailVerified:D,displayName:v,isAnonymous:Z,photoURL:T,phoneNumber:p,tenantId:k,stsTokenManager:j,createdAt:b,lastLoginAt:P});return le&&Array.isArray(le)&&(_.providerData=le.map(F=>Object.assign({},F))),C&&(_._redirectEventId=C),_}static async _fromIdTokenResponse(e,n,r=!1){const i=new au;i.updateFromServerResponse(n);const s=new Xa({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await $m(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];gt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?c4(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new au;l.updateFromIdToken(r);const c=new Xa({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Av(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ob=new Map;function Ja(t){lo(t instanceof Function,"Expected a class definition");let e=ob.get(t);return e?(lo(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,ob.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}u4.type="NONE";const lb=u4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zf(t,e,n){return`firebase:${t}:${e}:${n}`}class ou{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Zf(this.userKey,i.apiKey,s),this.fullPersistenceKey=Zf("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Xa._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ou(Ja(lb),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Ja(lb);const o=Zf(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const f=await u._get(o);if(f){const v=Xa._fromJSON(e,f);u!==s&&(l=v),s=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new ou(s,e,r):(s=c[0],l&&await s._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new ou(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cb(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(m4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(d4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(g4(e))return"Blackberry";if(v4(e))return"Webos";if(h4(e))return"Safari";if((e.includes("chrome/")||f4(e))&&!e.includes("edge/"))return"Chrome";if(p4(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function d4(t=oi()){return/firefox\//i.test(t)}function h4(t=oi()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function f4(t=oi()){return/crios\//i.test(t)}function m4(t=oi()){return/iemobile/i.test(t)}function p4(t=oi()){return/android/i.test(t)}function g4(t=oi()){return/blackberry/i.test(t)}function v4(t=oi()){return/webos/i.test(t)}function ny(t=oi()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function mC(t=oi()){var e;return ny(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function pC(){return IT()&&document.documentMode===10}function y4(t=oi()){return ny(t)||p4(t)||v4(t)||g4(t)||/windows phone/i.test(t)||m4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x4(t,e=[]){let n;switch(t){case"Browser":n=cb(oi());break;case"Worker":n=`${cb(oi())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${bc}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,l)=>{try{const c=e(s);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vC(t,e={}){return zs(t,"GET","/v2/passwordPolicy",Aa(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC=6;class xC{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:yC,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ub(this),this.idTokenSubscription=new ub(this),this.beforeStateQueue=new gC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=r4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ja(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await ou.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await l4(this,{idToken:e}),r=await Xa._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(fa(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return gt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await $m(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Zj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(fa(this.app))return Promise.reject(eo(this));const n=e?bn(e):null;return n&&gt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&gt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return fa(this.app)?Promise.reject(eo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return fa(this.app)?Promise.reject(eo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ja(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await vC(this),n=new xC(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Sh("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await fC(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ja(e)||this._popupRedirectResolver;gt(n,this,"argument-error"),this.redirectPersistenceManager=await ou.create(this,[Ja(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(gt(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,i);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return gt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=x4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&Qj(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function _l(t){return bn(t)}class ub{constructor(e){this.auth=e,this.observer=null,this.addObserver=UT(n=>this.observer=n)}get next(){return gt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function wC(t){Cp=t}function b4(t){return Cp.loadJS(t)}function NC(){return Cp.recaptchaEnterpriseScript}function _C(){return Cp.gapiScript}function EC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const AC="recaptcha-enterprise",SC="NO_RECAPTCHA";class kC{constructor(e){this.type=AC,this.auth=_l(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{sC(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new iC(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function i(s,o,l){const c=window.grecaptcha;sb(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(SC)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(l=>{if(!n&&sb(window.grecaptcha))i(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=NC();c.length!==0&&(c+=l),b4(c).then(()=>{i(l,s,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function db(t,e,n,r=!1){const i=new kC(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Sv(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await db(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await db(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TC(t,e){const n=Th(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Um(s,e??{}))return i;bs(i,"already-initialized")}return n.initialize({options:e})}function jC(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ja);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function CC(t,e,n){const r=_l(t);gt(r._canInitEmulator,r,"emulator-config-failed"),gt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=w4(e),{host:o,port:l}=IC(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),PC()}function w4(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function IC(t){const e=w4(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:hb(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:hb(o)}}}function hb(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function PC(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Qa("not implemented")}_getIdTokenResponse(e){return Qa("not implemented")}_linkToIdToken(e,n){return Qa("not implemented")}_getReauthenticationResolver(e){return Qa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N4(t,e){return zs(t,"POST","/v1/accounts:resetPassword",Aa(t,e))}async function RC(t,e){return zs(t,"POST","/v1/accounts:update",e)}async function LC(t,e){return zs(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DC(t,e){return Ch(t,"POST","/v1/accounts:signInWithPassword",Aa(t,e))}async function OC(t,e){return zs(t,"POST","/v1/accounts:sendOobCode",Aa(t,e))}async function MC(t,e){return OC(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FC(t,e){return Ch(t,"POST","/v1/accounts:signInWithEmailLink",Aa(t,e))}async function UC(t,e){return Ch(t,"POST","/v1/accounts:signInWithEmailLink",Aa(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uh extends ry{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new uh(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new uh(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Sv(e,n,"signInWithPassword",DC);case"emailLink":return FC(e,{email:this._email,oobCode:this._password});default:bs(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Sv(e,r,"signUpPassword",LC);case"emailLink":return UC(e,{idToken:n,email:this._email,oobCode:this._password});default:bs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lu(t,e){return Ch(t,"POST","/v1/accounts:signInWithIdp",Aa(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VC="http://localhost";class dc extends ry{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new dc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):bs("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=J1(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new dc(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return lu(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,lu(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,lu(e,n)}buildRequest(){const e={requestUri:VC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=kh(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BC(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function $C(t){const e=Ed(Ad(t)).link,n=e?Ed(Ad(e)).deep_link_id:null,r=Ed(Ad(t)).deep_link_id;return(r?Ed(Ad(r)).link:null)||r||n||e||t}class iy{constructor(e){var n,r,i,s,o,l;const c=Ed(Ad(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,f=(r=c.oobCode)!==null&&r!==void 0?r:null,v=BC((i=c.mode)!==null&&i!==void 0?i:null);gt(u&&f&&v,"argument-error"),this.apiKey=u,this.operation=v,this.code=f,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=$C(e);try{return new iy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(){this.providerId=Lu.PROVIDER_ID}static credential(e,n){return uh._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=iy.parseLink(n);return gt(r,"argument-error"),uh._fromEmailAndCode(e,r.code,r.tenantId)}}Lu.PROVIDER_ID="password";Lu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Lu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih extends _4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho extends Ih{constructor(){super("facebook.com")}static credential(e){return dc._fromParams({providerId:Ho.PROVIDER_ID,signInMethod:Ho.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ho.credentialFromTaggedObject(e)}static credentialFromError(e){return Ho.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ho.credential(e.oauthAccessToken)}catch{return null}}}Ho.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ho.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo extends Ih{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return dc._fromParams({providerId:Wo.PROVIDER_ID,signInMethod:Wo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Wo.credentialFromTaggedObject(e)}static credentialFromError(e){return Wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Wo.credential(n,r)}catch{return null}}}Wo.GOOGLE_SIGN_IN_METHOD="google.com";Wo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go extends Ih{constructor(){super("github.com")}static credential(e){return dc._fromParams({providerId:Go.PROVIDER_ID,signInMethod:Go.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Go.credentialFromTaggedObject(e)}static credentialFromError(e){return Go.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Go.credential(e.oauthAccessToken)}catch{return null}}}Go.GITHUB_SIGN_IN_METHOD="github.com";Go.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko extends Ih{constructor(){super("twitter.com")}static credential(e,n){return dc._fromParams({providerId:Ko.PROVIDER_ID,signInMethod:Ko.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ko.credentialFromTaggedObject(e)}static credentialFromError(e){return Ko.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ko.credential(n,r)}catch{return null}}}Ko.TWITTER_SIGN_IN_METHOD="twitter.com";Ko.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zC(t,e){return Ch(t,"POST","/v1/accounts:signUp",Aa(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Xa._fromIdTokenResponse(e,r,i),o=fb(r);return new hc({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=fb(r);return new hc({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function fb(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm extends Ea{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,zm.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new zm(e,n,r,i)}}function E4(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?zm._fromErrorAndOperation(t,s,e,r):s})}async function qC(t,e,n=!1){const r=await Nu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return hc._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HC(t,e,n=!1){const{auth:r}=t;if(fa(r.app))return Promise.reject(eo(r));const i="reauthenticate";try{const s=await Nu(t,E4(r,i,e,t),n);gt(s.idToken,r,"internal-error");const o=ty(s.idToken);gt(o,r,"internal-error");const{sub:l}=o;return gt(t.uid===l,r,"user-mismatch"),hc._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&bs(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A4(t,e,n=!1){if(fa(t.app))return Promise.reject(eo(t));const r="signIn",i=await E4(t,r,e),s=await hc._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function WC(t,e){return A4(_l(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?ay._fromServerResponse(e,n):"totpInfo"in n?oy._fromServerResponse(e,n):bs(e,"internal-error")}}class ay extends sy{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new ay(n)}}class oy extends sy{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new oy(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ly(t){const e=_l(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function GC(t,e,n){await N4(bn(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&ly(t),r})}async function KC(t,e){const n=bn(t),r=await N4(n,{oobCode:e}),i=r.requestType;switch(gt(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":gt(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":gt(r.mfaInfo,n,"internal-error");default:gt(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=sy._fromServerResponse(_l(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function YC(t,e){const{data:n}=await KC(bn(t),e);return n.email}async function qm(t,e,n){if(fa(t.app))return Promise.reject(eo(t));const r=_l(t),o=await Sv(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",zC).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&ly(t),c}),l=await hc._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function QC(t,e,n){return fa(t.app)?Promise.reject(eo(t)):WC(bn(t),Lu.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&ly(t),r})}async function XC(t,e){const n=bn(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:s}=await MC(n.auth,i);s!==t.email&&await t.reload()}function JC(t,e){return ZC(bn(t),null,e)}async function ZC(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(s.password=n);const o=await Nu(t,RC(r,s));await t._updateTokensIfNecessary(o,!0)}function eI(t,e,n,r){return bn(t).onIdTokenChanged(e,n,r)}function tI(t,e,n){return bn(t).beforeAuthStateChanged(e,n)}function nI(t,e,n,r){return bn(t).onAuthStateChanged(e,n,r)}function Yl(t){return bn(t).signOut()}const Hm="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Hm,"1"),this.storage.removeItem(Hm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI=1e3,iI=10;class k4 extends S4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=y4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);pC()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,iI):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},rI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}k4.type="LOCAL";const sI=k4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4 extends S4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}T4.type="SESSION";const j4=T4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aI(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Ip(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(o).map(async u=>u(n.origin,s)),c=await aI(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ip.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((l,c)=>{const u=cy("",20);i.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(v){const g=v;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(g.data.response);break;default:clearTimeout(f),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ya(){return window}function lI(t){ya().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C4(){return typeof ya().WorkerGlobalScope<"u"&&typeof ya().importScripts=="function"}async function cI(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function uI(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function dI(){return C4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4="firebaseLocalStorageDb",hI=1,Wm="firebaseLocalStorage",P4="fbase_key";class Ph{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Pp(t,e){return t.transaction([Wm],e?"readwrite":"readonly").objectStore(Wm)}function fI(){const t=indexedDB.deleteDatabase(I4);return new Ph(t).toPromise()}function kv(){const t=indexedDB.open(I4,hI);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Wm,{keyPath:P4})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Wm)?e(r):(r.close(),await fI(),e(await kv()))})})}async function mb(t,e,n){const r=Pp(t,!0).put({[P4]:e,value:n});return new Ph(r).toPromise()}async function mI(t,e){const n=Pp(t,!1).get(e),r=await new Ph(n).toPromise();return r===void 0?null:r.value}function pb(t,e){const n=Pp(t,!0).delete(e);return new Ph(n).toPromise()}const pI=800,gI=3;class R4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await kv(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>gI)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return C4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ip._getInstance(dI()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await cI(),!this.activeServiceWorker)return;this.sender=new oI(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||uI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await kv();return await mb(e,Hm,"1"),await pb(e,Hm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>mb(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>mI(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>pb(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Pp(i,!1).getAll();return new Ph(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),pI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}R4.type="LOCAL";const vI=R4;new jh(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yI(t,e){return e?Ja(e):(gt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy extends ry{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return lu(e,this._buildIdpRequest())}_linkToIdToken(e,n){return lu(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return lu(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function xI(t){return A4(t.auth,new uy(t),t.bypassAuthState)}function bI(t){const{auth:e,user:n}=t;return gt(n,e,"internal-error"),HC(n,new uy(t),t.bypassAuthState)}async function wI(t){const{auth:e,user:n}=t;return gt(n,e,"internal-error"),qC(n,new uy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return xI;case"linkViaPopup":case"linkViaRedirect":return wI;case"reauthViaPopup":case"reauthViaRedirect":return bI;default:bs(this.auth,"internal-error")}}resolve(e){lo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){lo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI=new jh(2e3,1e4);class Jc extends L4{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Jc.currentPopupAction&&Jc.currentPopupAction.cancel(),Jc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return gt(e,this.auth,"internal-error"),e}async onExecution(){lo(this.filter.length===1,"Popup operations only handle one event");const e=cy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(va(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(va(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Jc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(va(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,NI.get())};e()}}Jc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I="pendingRedirect",em=new Map;class EI extends L4{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=em.get(this.auth._key());if(!e){try{const r=await AI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}em.set(this.auth._key(),e)}return this.bypassAuthState||em.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function AI(t,e){const n=TI(e),r=kI(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function SI(t,e){em.set(t._key(),e)}function kI(t){return Ja(t._redirectPersistence)}function TI(t){return Zf(_I,t.config.apiKey,t.name)}async function jI(t,e,n=!1){if(fa(t.app))return Promise.reject(eo(t));const r=_l(t),i=yI(r,e),o=await new EI(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI=10*60*1e3;class II{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!PI(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!D4(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(va(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=CI&&this.cachedEventUids.clear(),this.cachedEventUids.has(gb(e))}saveEventToCache(e){this.cachedEventUids.add(gb(e)),this.lastProcessedEventTime=Date.now()}}function gb(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function D4({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function PI(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return D4(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RI(t,e={}){return zs(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,DI=/^https?/;async function OI(t){if(t.config.emulator)return;const{authorizedDomains:e}=await RI(t);for(const n of e)try{if(MI(n))return}catch{}bs(t,"unauthorized-domain")}function MI(t){const e=Ev(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!DI.test(n))return!1;if(LI.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI=new jh(3e4,6e4);function vb(){const t=ya().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function UI(t){return new Promise((e,n)=>{var r,i,s;function o(){vb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{vb(),n(va(t,"network-request-failed"))},timeout:FI.get()})}if(!((i=(r=ya().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ya().gapi)===null||s===void 0)&&s.load)o();else{const l=EC("iframefcb");return ya()[l]=()=>{gapi.load?o():n(va(t,"network-request-failed"))},b4(`${_C()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw tm=null,e})}let tm=null;function VI(t){return tm=tm||UI(t),tm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI=new jh(5e3,15e3),$I="__/auth/iframe",zI="emulator/auth/iframe",qI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},HI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function WI(t){const e=t.config;gt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ey(e,zI):`https://${t.config.authDomain}/${$I}`,r={apiKey:e.apiKey,appName:t.name,v:bc},i=HI.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${kh(r).slice(1)}`}async function GI(t){const e=await VI(t),n=ya().gapi;return gt(n,t,"internal-error"),e.open({where:document.body,url:WI(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:qI,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=va(t,"network-request-failed"),l=ya().setTimeout(()=>{s(o)},BI.get());function c(){ya().clearTimeout(l),i(r)}r.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},YI=500,QI=600,XI="_blank",JI="http://localhost";class yb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ZI(t,e,n,r=YI,i=QI){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},KI),{width:r.toString(),height:i.toString(),top:s,left:o}),u=oi().toLowerCase();n&&(l=f4(u)?XI:n),d4(u)&&(e=e||JI,c.scrollbars="yes");const f=Object.entries(c).reduce((g,[p,T])=>`${g}${p}=${T},`,"");if(mC(u)&&l!=="_self")return e6(e||"",l),new yb(null);const v=window.open(e||"",l,f);gt(v,t,"popup-blocked");try{v.focus()}catch{}return new yb(v)}function e6(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t6="__/auth/handler",n6="emulator/auth/handler",r6=encodeURIComponent("fac");async function xb(t,e,n,r,i,s){gt(t.config.authDomain,t,"auth-domain-config-required"),gt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:bc,eventId:i};if(e instanceof _4){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",FT(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,v]of Object.entries({}))o[f]=v}if(e instanceof Ih){const f=e.getScopes().filter(v=>v!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const c=await t._getAppCheckToken(),u=c?`#${r6}=${encodeURIComponent(c)}`:"";return`${i6(t)}?${kh(l).slice(1)}${u}`}function i6({config:t}){return t.emulator?ey(t,n6):`https://${t.authDomain}/${t6}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qg="webStorageSupport";class s6{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=j4,this._completeRedirectFn=jI,this._overrideRedirectResult=SI}async _openPopup(e,n,r,i){var s;lo((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await xb(e,n,r,Ev(),i);return ZI(e,o,cy())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await xb(e,n,r,Ev(),i);return lI(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(lo(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await GI(e),r=new II(e);return n.register("authEvent",i=>(gt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Qg,{type:Qg},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Qg];o!==void 0&&n(!!o),bs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=OI(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return y4()||h4()||ny()}}const a6=s6;var bb="@firebase/auth",wb="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){gt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l6(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function c6(t){fl(new ao("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;gt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:x4(t)},u=new bC(r,i,s,c);return jC(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),fl(new ao("auth-internal",e=>{const n=_l(e.getProvider("auth").getImmediate());return(r=>new o6(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ps(bb,wb,l6(t)),ps(bb,wb,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u6=5*60,d6=Y_("authIdTokenMaxAge")||u6;let Nb=null;const h6=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>d6)return;const i=n==null?void 0:n.token;Nb!==i&&(Nb=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function f6(t=jp()){const e=Th(t,"auth");if(e.isInitialized())return e.getImmediate();const n=TC(t,{popupRedirectResolver:a6,persistence:[vI,sI,j4]}),r=Y_("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=h6(s.toString());tI(n,o,()=>o(n.currentUser)),eI(n,l=>o(l))}}const i=G_("auth");return i&&CC(n,`http://${i}`),n}function m6(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}wC({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=va("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",m6().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});c6("Browser");var _b=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var rc,O4;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(U,j){function _(){}_.prototype=j.prototype,U.D=j.prototype,U.prototype=new _,U.prototype.constructor=U,U.C=function(F,A,L){for(var E=Array(arguments.length-2),M=2;M<arguments.length;M++)E[M-2]=arguments[M];return j.prototype[A].apply(F,E)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(U,j,_){_||(_=0);var F=Array(16);if(typeof j=="string")for(var A=0;16>A;++A)F[A]=j.charCodeAt(_++)|j.charCodeAt(_++)<<8|j.charCodeAt(_++)<<16|j.charCodeAt(_++)<<24;else for(A=0;16>A;++A)F[A]=j[_++]|j[_++]<<8|j[_++]<<16|j[_++]<<24;j=U.g[0],_=U.g[1],A=U.g[2];var L=U.g[3],E=j+(L^_&(A^L))+F[0]+3614090360&4294967295;j=_+(E<<7&4294967295|E>>>25),E=L+(A^j&(_^A))+F[1]+3905402710&4294967295,L=j+(E<<12&4294967295|E>>>20),E=A+(_^L&(j^_))+F[2]+606105819&4294967295,A=L+(E<<17&4294967295|E>>>15),E=_+(j^A&(L^j))+F[3]+3250441966&4294967295,_=A+(E<<22&4294967295|E>>>10),E=j+(L^_&(A^L))+F[4]+4118548399&4294967295,j=_+(E<<7&4294967295|E>>>25),E=L+(A^j&(_^A))+F[5]+1200080426&4294967295,L=j+(E<<12&4294967295|E>>>20),E=A+(_^L&(j^_))+F[6]+2821735955&4294967295,A=L+(E<<17&4294967295|E>>>15),E=_+(j^A&(L^j))+F[7]+4249261313&4294967295,_=A+(E<<22&4294967295|E>>>10),E=j+(L^_&(A^L))+F[8]+1770035416&4294967295,j=_+(E<<7&4294967295|E>>>25),E=L+(A^j&(_^A))+F[9]+2336552879&4294967295,L=j+(E<<12&4294967295|E>>>20),E=A+(_^L&(j^_))+F[10]+4294925233&4294967295,A=L+(E<<17&4294967295|E>>>15),E=_+(j^A&(L^j))+F[11]+2304563134&4294967295,_=A+(E<<22&4294967295|E>>>10),E=j+(L^_&(A^L))+F[12]+1804603682&4294967295,j=_+(E<<7&4294967295|E>>>25),E=L+(A^j&(_^A))+F[13]+4254626195&4294967295,L=j+(E<<12&4294967295|E>>>20),E=A+(_^L&(j^_))+F[14]+2792965006&4294967295,A=L+(E<<17&4294967295|E>>>15),E=_+(j^A&(L^j))+F[15]+1236535329&4294967295,_=A+(E<<22&4294967295|E>>>10),E=j+(A^L&(_^A))+F[1]+4129170786&4294967295,j=_+(E<<5&4294967295|E>>>27),E=L+(_^A&(j^_))+F[6]+3225465664&4294967295,L=j+(E<<9&4294967295|E>>>23),E=A+(j^_&(L^j))+F[11]+643717713&4294967295,A=L+(E<<14&4294967295|E>>>18),E=_+(L^j&(A^L))+F[0]+3921069994&4294967295,_=A+(E<<20&4294967295|E>>>12),E=j+(A^L&(_^A))+F[5]+3593408605&4294967295,j=_+(E<<5&4294967295|E>>>27),E=L+(_^A&(j^_))+F[10]+38016083&4294967295,L=j+(E<<9&4294967295|E>>>23),E=A+(j^_&(L^j))+F[15]+3634488961&4294967295,A=L+(E<<14&4294967295|E>>>18),E=_+(L^j&(A^L))+F[4]+3889429448&4294967295,_=A+(E<<20&4294967295|E>>>12),E=j+(A^L&(_^A))+F[9]+568446438&4294967295,j=_+(E<<5&4294967295|E>>>27),E=L+(_^A&(j^_))+F[14]+3275163606&4294967295,L=j+(E<<9&4294967295|E>>>23),E=A+(j^_&(L^j))+F[3]+4107603335&4294967295,A=L+(E<<14&4294967295|E>>>18),E=_+(L^j&(A^L))+F[8]+1163531501&4294967295,_=A+(E<<20&4294967295|E>>>12),E=j+(A^L&(_^A))+F[13]+2850285829&4294967295,j=_+(E<<5&4294967295|E>>>27),E=L+(_^A&(j^_))+F[2]+4243563512&4294967295,L=j+(E<<9&4294967295|E>>>23),E=A+(j^_&(L^j))+F[7]+1735328473&4294967295,A=L+(E<<14&4294967295|E>>>18),E=_+(L^j&(A^L))+F[12]+2368359562&4294967295,_=A+(E<<20&4294967295|E>>>12),E=j+(_^A^L)+F[5]+4294588738&4294967295,j=_+(E<<4&4294967295|E>>>28),E=L+(j^_^A)+F[8]+2272392833&4294967295,L=j+(E<<11&4294967295|E>>>21),E=A+(L^j^_)+F[11]+1839030562&4294967295,A=L+(E<<16&4294967295|E>>>16),E=_+(A^L^j)+F[14]+4259657740&4294967295,_=A+(E<<23&4294967295|E>>>9),E=j+(_^A^L)+F[1]+2763975236&4294967295,j=_+(E<<4&4294967295|E>>>28),E=L+(j^_^A)+F[4]+1272893353&4294967295,L=j+(E<<11&4294967295|E>>>21),E=A+(L^j^_)+F[7]+4139469664&4294967295,A=L+(E<<16&4294967295|E>>>16),E=_+(A^L^j)+F[10]+3200236656&4294967295,_=A+(E<<23&4294967295|E>>>9),E=j+(_^A^L)+F[13]+681279174&4294967295,j=_+(E<<4&4294967295|E>>>28),E=L+(j^_^A)+F[0]+3936430074&4294967295,L=j+(E<<11&4294967295|E>>>21),E=A+(L^j^_)+F[3]+3572445317&4294967295,A=L+(E<<16&4294967295|E>>>16),E=_+(A^L^j)+F[6]+76029189&4294967295,_=A+(E<<23&4294967295|E>>>9),E=j+(_^A^L)+F[9]+3654602809&4294967295,j=_+(E<<4&4294967295|E>>>28),E=L+(j^_^A)+F[12]+3873151461&4294967295,L=j+(E<<11&4294967295|E>>>21),E=A+(L^j^_)+F[15]+530742520&4294967295,A=L+(E<<16&4294967295|E>>>16),E=_+(A^L^j)+F[2]+3299628645&4294967295,_=A+(E<<23&4294967295|E>>>9),E=j+(A^(_|~L))+F[0]+4096336452&4294967295,j=_+(E<<6&4294967295|E>>>26),E=L+(_^(j|~A))+F[7]+1126891415&4294967295,L=j+(E<<10&4294967295|E>>>22),E=A+(j^(L|~_))+F[14]+2878612391&4294967295,A=L+(E<<15&4294967295|E>>>17),E=_+(L^(A|~j))+F[5]+4237533241&4294967295,_=A+(E<<21&4294967295|E>>>11),E=j+(A^(_|~L))+F[12]+1700485571&4294967295,j=_+(E<<6&4294967295|E>>>26),E=L+(_^(j|~A))+F[3]+2399980690&4294967295,L=j+(E<<10&4294967295|E>>>22),E=A+(j^(L|~_))+F[10]+4293915773&4294967295,A=L+(E<<15&4294967295|E>>>17),E=_+(L^(A|~j))+F[1]+2240044497&4294967295,_=A+(E<<21&4294967295|E>>>11),E=j+(A^(_|~L))+F[8]+1873313359&4294967295,j=_+(E<<6&4294967295|E>>>26),E=L+(_^(j|~A))+F[15]+4264355552&4294967295,L=j+(E<<10&4294967295|E>>>22),E=A+(j^(L|~_))+F[6]+2734768916&4294967295,A=L+(E<<15&4294967295|E>>>17),E=_+(L^(A|~j))+F[13]+1309151649&4294967295,_=A+(E<<21&4294967295|E>>>11),E=j+(A^(_|~L))+F[4]+4149444226&4294967295,j=_+(E<<6&4294967295|E>>>26),E=L+(_^(j|~A))+F[11]+3174756917&4294967295,L=j+(E<<10&4294967295|E>>>22),E=A+(j^(L|~_))+F[2]+718787259&4294967295,A=L+(E<<15&4294967295|E>>>17),E=_+(L^(A|~j))+F[9]+3951481745&4294967295,U.g[0]=U.g[0]+j&4294967295,U.g[1]=U.g[1]+(A+(E<<21&4294967295|E>>>11))&4294967295,U.g[2]=U.g[2]+A&4294967295,U.g[3]=U.g[3]+L&4294967295}r.prototype.u=function(U,j){j===void 0&&(j=U.length);for(var _=j-this.blockSize,F=this.B,A=this.h,L=0;L<j;){if(A==0)for(;L<=_;)i(this,U,L),L+=this.blockSize;if(typeof U=="string"){for(;L<j;)if(F[A++]=U.charCodeAt(L++),A==this.blockSize){i(this,F),A=0;break}}else for(;L<j;)if(F[A++]=U[L++],A==this.blockSize){i(this,F),A=0;break}}this.h=A,this.o+=j},r.prototype.v=function(){var U=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);U[0]=128;for(var j=1;j<U.length-8;++j)U[j]=0;var _=8*this.o;for(j=U.length-8;j<U.length;++j)U[j]=_&255,_/=256;for(this.u(U),U=Array(16),j=_=0;4>j;++j)for(var F=0;32>F;F+=8)U[_++]=this.g[j]>>>F&255;return U};function s(U,j){var _=l;return Object.prototype.hasOwnProperty.call(_,U)?_[U]:_[U]=j(U)}function o(U,j){this.h=j;for(var _=[],F=!0,A=U.length-1;0<=A;A--){var L=U[A]|0;F&&L==j||(_[A]=L,F=!1)}this.g=_}var l={};function c(U){return-128<=U&&128>U?s(U,function(j){return new o([j|0],0>j?-1:0)}):new o([U|0],0>U?-1:0)}function u(U){if(isNaN(U)||!isFinite(U))return v;if(0>U)return C(u(-U));for(var j=[],_=1,F=0;U>=_;F++)j[F]=U/_|0,_*=4294967296;return new o(j,0)}function f(U,j){if(U.length==0)throw Error("number format error: empty string");if(j=j||10,2>j||36<j)throw Error("radix out of range: "+j);if(U.charAt(0)=="-")return C(f(U.substring(1),j));if(0<=U.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=u(Math.pow(j,8)),F=v,A=0;A<U.length;A+=8){var L=Math.min(8,U.length-A),E=parseInt(U.substring(A,A+L),j);8>L?(L=u(Math.pow(j,L)),F=F.j(L).add(u(E))):(F=F.j(_),F=F.add(u(E)))}return F}var v=c(0),g=c(1),p=c(16777216);t=o.prototype,t.m=function(){if(k(this))return-C(this).m();for(var U=0,j=1,_=0;_<this.g.length;_++){var F=this.i(_);U+=(0<=F?F:4294967296+F)*j,j*=4294967296}return U},t.toString=function(U){if(U=U||10,2>U||36<U)throw Error("radix out of range: "+U);if(T(this))return"0";if(k(this))return"-"+C(this).toString(U);for(var j=u(Math.pow(U,6)),_=this,F="";;){var A=D(_,j).g;_=b(_,A.j(j));var L=((0<_.g.length?_.g[0]:_.h)>>>0).toString(U);if(_=A,T(_))return L+F;for(;6>L.length;)L="0"+L;F=L+F}},t.i=function(U){return 0>U?0:U<this.g.length?this.g[U]:this.h};function T(U){if(U.h!=0)return!1;for(var j=0;j<U.g.length;j++)if(U.g[j]!=0)return!1;return!0}function k(U){return U.h==-1}t.l=function(U){return U=b(this,U),k(U)?-1:T(U)?0:1};function C(U){for(var j=U.g.length,_=[],F=0;F<j;F++)_[F]=~U.g[F];return new o(_,~U.h).add(g)}t.abs=function(){return k(this)?C(this):this},t.add=function(U){for(var j=Math.max(this.g.length,U.g.length),_=[],F=0,A=0;A<=j;A++){var L=F+(this.i(A)&65535)+(U.i(A)&65535),E=(L>>>16)+(this.i(A)>>>16)+(U.i(A)>>>16);F=E>>>16,L&=65535,E&=65535,_[A]=E<<16|L}return new o(_,_[_.length-1]&-2147483648?-1:0)};function b(U,j){return U.add(C(j))}t.j=function(U){if(T(this)||T(U))return v;if(k(this))return k(U)?C(this).j(C(U)):C(C(this).j(U));if(k(U))return C(this.j(C(U)));if(0>this.l(p)&&0>U.l(p))return u(this.m()*U.m());for(var j=this.g.length+U.g.length,_=[],F=0;F<2*j;F++)_[F]=0;for(F=0;F<this.g.length;F++)for(var A=0;A<U.g.length;A++){var L=this.i(F)>>>16,E=this.i(F)&65535,M=U.i(A)>>>16,G=U.i(A)&65535;_[2*F+2*A]+=E*G,P(_,2*F+2*A),_[2*F+2*A+1]+=L*G,P(_,2*F+2*A+1),_[2*F+2*A+1]+=E*M,P(_,2*F+2*A+1),_[2*F+2*A+2]+=L*M,P(_,2*F+2*A+2)}for(F=0;F<j;F++)_[F]=_[2*F+1]<<16|_[2*F];for(F=j;F<2*j;F++)_[F]=0;return new o(_,0)};function P(U,j){for(;(U[j]&65535)!=U[j];)U[j+1]+=U[j]>>>16,U[j]&=65535,j++}function R(U,j){this.g=U,this.h=j}function D(U,j){if(T(j))throw Error("division by zero");if(T(U))return new R(v,v);if(k(U))return j=D(C(U),j),new R(C(j.g),C(j.h));if(k(j))return j=D(U,C(j)),new R(C(j.g),j.h);if(30<U.g.length){if(k(U)||k(j))throw Error("slowDivide_ only works with positive integers.");for(var _=g,F=j;0>=F.l(U);)_=Z(_),F=Z(F);var A=le(_,1),L=le(F,1);for(F=le(F,2),_=le(_,2);!T(F);){var E=L.add(F);0>=E.l(U)&&(A=A.add(_),L=E),F=le(F,1),_=le(_,1)}return j=b(U,A.j(j)),new R(A,j)}for(A=v;0<=U.l(j);){for(_=Math.max(1,Math.floor(U.m()/j.m())),F=Math.ceil(Math.log(_)/Math.LN2),F=48>=F?1:Math.pow(2,F-48),L=u(_),E=L.j(j);k(E)||0<E.l(U);)_-=F,L=u(_),E=L.j(j);T(L)&&(L=g),A=A.add(L),U=b(U,E)}return new R(A,U)}t.A=function(U){return D(this,U).h},t.and=function(U){for(var j=Math.max(this.g.length,U.g.length),_=[],F=0;F<j;F++)_[F]=this.i(F)&U.i(F);return new o(_,this.h&U.h)},t.or=function(U){for(var j=Math.max(this.g.length,U.g.length),_=[],F=0;F<j;F++)_[F]=this.i(F)|U.i(F);return new o(_,this.h|U.h)},t.xor=function(U){for(var j=Math.max(this.g.length,U.g.length),_=[],F=0;F<j;F++)_[F]=this.i(F)^U.i(F);return new o(_,this.h^U.h)};function Z(U){for(var j=U.g.length+1,_=[],F=0;F<j;F++)_[F]=U.i(F)<<1|U.i(F-1)>>>31;return new o(_,U.h)}function le(U,j){var _=j>>5;j%=32;for(var F=U.g.length-_,A=[],L=0;L<F;L++)A[L]=0<j?U.i(L+_)>>>j|U.i(L+_+1)<<32-j:U.i(L+_);return new o(A,U.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,O4=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,rc=o}).apply(typeof _b<"u"?_b:typeof self<"u"?self:typeof window<"u"?window:{});var Sf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var M4,Sd,F4,nm,Tv,U4,V4,B4;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,N,O){return h==Array.prototype||h==Object.prototype||(h[N]=O.value),h};function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Sf=="object"&&Sf];for(var N=0;N<h.length;++N){var O=h[N];if(O&&O.Math==Math)return O}throw Error("Cannot find global object")}var r=n(this);function i(h,N){if(N)e:{var O=r;h=h.split(".");for(var J=0;J<h.length-1;J++){var ve=h[J];if(!(ve in O))break e;O=O[ve]}h=h[h.length-1],J=O[h],N=N(J),N!=J&&N!=null&&e(O,h,{configurable:!0,writable:!0,value:N})}}function s(h,N){h instanceof String&&(h+="");var O=0,J=!1,ve={next:function(){if(!J&&O<h.length){var _e=O++;return{value:N(_e,h[_e]),done:!1}}return J=!0,{done:!0,value:void 0}}};return ve[Symbol.iterator]=function(){return ve},ve}i("Array.prototype.values",function(h){return h||function(){return s(this,function(N,O){return O})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(h){var N=typeof h;return N=N!="object"?N:h?Array.isArray(h)?"array":N:"null",N=="array"||N=="object"&&typeof h.length=="number"}function u(h){var N=typeof h;return N=="object"&&h!=null||N=="function"}function f(h,N,O){return h.call.apply(h.bind,arguments)}function v(h,N,O){if(!h)throw Error();if(2<arguments.length){var J=Array.prototype.slice.call(arguments,2);return function(){var ve=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ve,J),h.apply(N,ve)}}return function(){return h.apply(N,arguments)}}function g(h,N,O){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:v,g.apply(null,arguments)}function p(h,N){var O=Array.prototype.slice.call(arguments,1);return function(){var J=O.slice();return J.push.apply(J,arguments),h.apply(this,J)}}function T(h,N){function O(){}O.prototype=N.prototype,h.aa=N.prototype,h.prototype=new O,h.prototype.constructor=h,h.Qb=function(J,ve,_e){for(var $e=Array(arguments.length-2),qt=2;qt<arguments.length;qt++)$e[qt-2]=arguments[qt];return N.prototype[ve].apply(J,$e)}}function k(h){const N=h.length;if(0<N){const O=Array(N);for(let J=0;J<N;J++)O[J]=h[J];return O}return[]}function C(h,N){for(let O=1;O<arguments.length;O++){const J=arguments[O];if(c(J)){const ve=h.length||0,_e=J.length||0;h.length=ve+_e;for(let $e=0;$e<_e;$e++)h[ve+$e]=J[$e]}else h.push(J)}}class b{constructor(N,O){this.i=N,this.j=O,this.h=0,this.g=null}get(){let N;return 0<this.h?(this.h--,N=this.g,this.g=N.next,N.next=null):N=this.i(),N}}function P(h){return/^[\s\xa0]*$/.test(h)}function R(){var h=l.navigator;return h&&(h=h.userAgent)?h:""}function D(h){return D[" "](h),h}D[" "]=function(){};var Z=R().indexOf("Gecko")!=-1&&!(R().toLowerCase().indexOf("webkit")!=-1&&R().indexOf("Edge")==-1)&&!(R().indexOf("Trident")!=-1||R().indexOf("MSIE")!=-1)&&R().indexOf("Edge")==-1;function le(h,N,O){for(const J in h)N.call(O,h[J],J,h)}function U(h,N){for(const O in h)N.call(void 0,h[O],O,h)}function j(h){const N={};for(const O in h)N[O]=h[O];return N}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function F(h,N){let O,J;for(let ve=1;ve<arguments.length;ve++){J=arguments[ve];for(O in J)h[O]=J[O];for(let _e=0;_e<_.length;_e++)O=_[_e],Object.prototype.hasOwnProperty.call(J,O)&&(h[O]=J[O])}}function A(h){var N=1;h=h.split(":");const O=[];for(;0<N&&h.length;)O.push(h.shift()),N--;return h.length&&O.push(h.join(":")),O}function L(h){l.setTimeout(()=>{throw h},0)}function E(){var h=H;let N=null;return h.g&&(N=h.g,h.g=h.g.next,h.g||(h.h=null),N.next=null),N}class M{constructor(){this.h=this.g=null}add(N,O){const J=G.get();J.set(N,O),this.h?this.h.next=J:this.g=J,this.h=J}}var G=new b(()=>new K,h=>h.reset());class K{constructor(){this.next=this.g=this.h=null}set(N,O){this.h=N,this.g=O,this.next=null}reset(){this.next=this.g=this.h=null}}let z,q=!1,H=new M,X=()=>{const h=l.Promise.resolve(void 0);z=()=>{h.then(ne)}};var ne=()=>{for(var h;h=E();){try{h.h.call(h.g)}catch(O){L(O)}var N=G;N.j(h),100>N.h&&(N.h++,h.next=N.g,N.g=h)}q=!1};function w(){this.s=this.s,this.C=this.C}w.prototype.s=!1,w.prototype.ma=function(){this.s||(this.s=!0,this.N())},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function S(h,N){this.type=h,this.g=this.target=N,this.defaultPrevented=!1}S.prototype.h=function(){this.defaultPrevented=!0};var V=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var h=!1,N=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const O=()=>{};l.addEventListener("test",O,N),l.removeEventListener("test",O,N)}catch{}return h}();function ee(h,N){if(S.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var O=this.type=h.type,J=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=N,N=h.relatedTarget){if(Z){e:{try{D(N.nodeName);var ve=!0;break e}catch{}ve=!1}ve||(N=null)}}else O=="mouseover"?N=h.fromElement:O=="mouseout"&&(N=h.toElement);this.relatedTarget=N,J?(this.clientX=J.clientX!==void 0?J.clientX:J.pageX,this.clientY=J.clientY!==void 0?J.clientY:J.pageY,this.screenX=J.screenX||0,this.screenY=J.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:re[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&ee.aa.h.call(this)}}T(ee,S);var re={2:"touch",3:"pen",4:"mouse"};ee.prototype.h=function(){ee.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var ce="closure_listenable_"+(1e6*Math.random()|0),he=0;function me(h,N,O,J,ve){this.listener=h,this.proxy=null,this.src=N,this.type=O,this.capture=!!J,this.ha=ve,this.key=++he,this.da=this.fa=!1}function ye(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ee(h){this.src=h,this.g={},this.h=0}Ee.prototype.add=function(h,N,O,J,ve){var _e=h.toString();h=this.g[_e],h||(h=this.g[_e]=[],this.h++);var $e=Re(h,N,J,ve);return-1<$e?(N=h[$e],O||(N.fa=!1)):(N=new me(N,this.src,_e,!!J,ve),N.fa=O,h.push(N)),N};function Pe(h,N){var O=N.type;if(O in h.g){var J=h.g[O],ve=Array.prototype.indexOf.call(J,N,void 0),_e;(_e=0<=ve)&&Array.prototype.splice.call(J,ve,1),_e&&(ye(N),h.g[O].length==0&&(delete h.g[O],h.h--))}}function Re(h,N,O,J){for(var ve=0;ve<h.length;++ve){var _e=h[ve];if(!_e.da&&_e.listener==N&&_e.capture==!!O&&_e.ha==J)return ve}return-1}var be="closure_lm_"+(1e6*Math.random()|0),ie={};function Ge(h,N,O,J,ve){if(Array.isArray(N)){for(var _e=0;_e<N.length;_e++)Ge(h,N[_e],O,J,ve);return null}return O=At(O),h&&h[ce]?h.K(N,O,u(J)?!!J.capture:!1,ve):it(h,N,O,!1,J,ve)}function it(h,N,O,J,ve,_e){if(!N)throw Error("Invalid event type");var $e=u(ve)?!!ve.capture:!!ve,qt=Le(h);if(qt||(h[be]=qt=new Ee(h)),O=qt.add(N,O,J,$e,_e),O.proxy)return O;if(J=at(),O.proxy=J,J.src=h,J.listener=O,h.addEventListener)V||(ve=$e),ve===void 0&&(ve=!1),h.addEventListener(N.toString(),J,ve);else if(h.attachEvent)h.attachEvent(qe(N.toString()),J);else if(h.addListener&&h.removeListener)h.addListener(J);else throw Error("addEventListener and attachEvent are unavailable.");return O}function at(){function h(O){return N.call(h.src,h.listener,O)}const N=Ue;return h}function De(h,N,O,J,ve){if(Array.isArray(N))for(var _e=0;_e<N.length;_e++)De(h,N[_e],O,J,ve);else J=u(J)?!!J.capture:!!J,O=At(O),h&&h[ce]?(h=h.i,N=String(N).toString(),N in h.g&&(_e=h.g[N],O=Re(_e,O,J,ve),-1<O&&(ye(_e[O]),Array.prototype.splice.call(_e,O,1),_e.length==0&&(delete h.g[N],h.h--)))):h&&(h=Le(h))&&(N=h.g[N.toString()],h=-1,N&&(h=Re(N,O,J,ve)),(O=-1<h?N[h]:null)&&Je(O))}function Je(h){if(typeof h!="number"&&h&&!h.da){var N=h.src;if(N&&N[ce])Pe(N.i,h);else{var O=h.type,J=h.proxy;N.removeEventListener?N.removeEventListener(O,J,h.capture):N.detachEvent?N.detachEvent(qe(O),J):N.addListener&&N.removeListener&&N.removeListener(J),(O=Le(N))?(Pe(O,h),O.h==0&&(O.src=null,N[be]=null)):ye(h)}}}function qe(h){return h in ie?ie[h]:ie[h]="on"+h}function Ue(h,N){if(h.da)h=!0;else{N=new ee(N,this);var O=h.listener,J=h.ha||h.src;h.fa&&Je(h),h=O.call(J,N)}return h}function Le(h){return h=h[be],h instanceof Ee?h:null}var zt="__closure_events_fn_"+(1e9*Math.random()>>>0);function At(h){return typeof h=="function"?h:(h[zt]||(h[zt]=function(N){return h.handleEvent(N)}),h[zt])}function st(){w.call(this),this.i=new Ee(this),this.M=this,this.F=null}T(st,w),st.prototype[ce]=!0,st.prototype.removeEventListener=function(h,N,O,J){De(this,h,N,O,J)};function Tt(h,N){var O,J=h.F;if(J)for(O=[];J;J=J.F)O.push(J);if(h=h.M,J=N.type||N,typeof N=="string")N=new S(N,h);else if(N instanceof S)N.target=N.target||h;else{var ve=N;N=new S(J,h),F(N,ve)}if(ve=!0,O)for(var _e=O.length-1;0<=_e;_e--){var $e=N.g=O[_e];ve=wt($e,J,!0,N)&&ve}if($e=N.g=h,ve=wt($e,J,!0,N)&&ve,ve=wt($e,J,!1,N)&&ve,O)for(_e=0;_e<O.length;_e++)$e=N.g=O[_e],ve=wt($e,J,!1,N)&&ve}st.prototype.N=function(){if(st.aa.N.call(this),this.i){var h=this.i,N;for(N in h.g){for(var O=h.g[N],J=0;J<O.length;J++)ye(O[J]);delete h.g[N],h.h--}}this.F=null},st.prototype.K=function(h,N,O,J){return this.i.add(String(h),N,!1,O,J)},st.prototype.L=function(h,N,O,J){return this.i.add(String(h),N,!0,O,J)};function wt(h,N,O,J){if(N=h.i.g[String(N)],!N)return!0;N=N.concat();for(var ve=!0,_e=0;_e<N.length;++_e){var $e=N[_e];if($e&&!$e.da&&$e.capture==O){var qt=$e.listener,Bn=$e.ha||$e.src;$e.fa&&Pe(h.i,$e),ve=qt.call(Bn,J)!==!1&&ve}}return ve&&!J.defaultPrevented}function ot(h,N,O){if(typeof h=="function")O&&(h=g(h,O));else if(h&&typeof h.handleEvent=="function")h=g(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(N)?-1:l.setTimeout(h,N||0)}function yt(h){h.g=ot(()=>{h.g=null,h.i&&(h.i=!1,yt(h))},h.l);const N=h.h;h.h=null,h.m.apply(null,N)}class ut extends w{constructor(N,O){super(),this.m=N,this.l=O,this.h=null,this.i=!1,this.g=null}j(N){this.h=arguments,this.g?this.i=!0:yt(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function en(h){w.call(this),this.h=h,this.g={}}T(en,w);var Kt=[];function tt(h){le(h.g,function(N,O){this.g.hasOwnProperty(O)&&Je(N)},h),h.g={}}en.prototype.N=function(){en.aa.N.call(this),tt(this)},en.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Nt=l.JSON.stringify,an=l.JSON.parse,pt=class{stringify(h){return l.JSON.stringify(h,void 0)}parse(h){return l.JSON.parse(h,void 0)}};function Dt(){}Dt.prototype.h=null;function St(h){return h.h||(h.h=h.i())}function Rn(){}var Sn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function nn(){S.call(this,"d")}T(nn,S);function xt(){S.call(this,"c")}T(xt,S);var Mt={},Ws=null;function Jn(){return Ws=Ws||new st}Mt.La="serverreachability";function ns(h){S.call(this,Mt.La,h)}T(ns,S);function qr(h){const N=Jn();Tt(N,new ns(N))}Mt.STAT_EVENT="statevent";function mt(h,N){S.call(this,Mt.STAT_EVENT,h),this.stat=N}T(mt,S);function kn(h){const N=Jn();Tt(N,new mt(N,h))}Mt.Ma="timingevent";function rs(h,N){S.call(this,Mt.Ma,h),this.size=N}T(rs,S);function Er(h,N){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){h()},N)}function Ar(){this.g=!0}Ar.prototype.xa=function(){this.g=!1};function Ln(h,N,O,J,ve,_e){h.info(function(){if(h.g)if(_e)for(var $e="",qt=_e.split("&"),Bn=0;Bn<qt.length;Bn++){var Ft=qt[Bn].split("=");if(1<Ft.length){var Ot=Ft[0];Ft=Ft[1];var Nn=Ot.split("_");$e=2<=Nn.length&&Nn[1]=="type"?$e+(Ot+"="+Ft+"&"):$e+(Ot+"=redacted&")}}else $e=null;else $e=_e;return"XMLHTTP REQ ("+J+") [attempt "+ve+"]: "+N+`
`+O+`
`+$e})}function dr(h,N,O,J,ve,_e,$e){h.info(function(){return"XMLHTTP RESP ("+J+") [ attempt "+ve+"]: "+N+`
`+O+`
`+_e+" "+$e})}function Dn(h,N,O,J){h.info(function(){return"XMLHTTP TEXT ("+N+"): "+Gs(h,O)+(J?" "+J:"")})}function ja(h,N){h.info(function(){return"TIMEOUT: "+N})}Ar.prototype.info=function(){};function Gs(h,N){if(!h.g)return N;if(!N)return null;try{var O=JSON.parse(N);if(O){for(h=0;h<O.length;h++)if(Array.isArray(O[h])){var J=O[h];if(!(2>J.length)){var ve=J[1];if(Array.isArray(ve)&&!(1>ve.length)){var _e=ve[0];if(_e!="noop"&&_e!="stop"&&_e!="close")for(var $e=1;$e<ve.length;$e++)ve[$e]=""}}}}return Nt(O)}catch{return N}}var Hr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Pi={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},li;function Wr(){}T(Wr,Dt),Wr.prototype.g=function(){return new XMLHttpRequest},Wr.prototype.i=function(){return{}},li=new Wr;function Zn(h,N,O,J){this.j=h,this.i=N,this.l=O,this.R=J||1,this.U=new en(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ks}function Ks(){this.i=null,this.g="",this.h=!1}var Ri={},_s={};function Ys(h,N,O){h.L=1,h.v=Ra(ci(N)),h.m=O,h.P=!0,Ca(h,null)}function Ca(h,N){h.F=Date.now(),Qs(h),h.A=ci(h.v);var O=h.A,J=h.R;Array.isArray(J)||(J=[String(J)]),bt(O.i,"t",J),h.C=0,O=h.j.J,h.h=new Ks,h.g=Wn(h.j,O?N:null,!h.m),0<h.O&&(h.M=new ut(g(h.Y,h,h.g),h.O)),N=h.U,O=h.g,J=h.ca;var ve="readystatechange";Array.isArray(ve)||(ve&&(Kt[0]=ve.toString()),ve=Kt);for(var _e=0;_e<ve.length;_e++){var $e=Ge(O,ve[_e],J||N.handleEvent,!1,N.h||N);if(!$e)break;N.g[$e.key]=$e}N=h.H?j(h.H):{},h.m?(h.u||(h.u="POST"),N["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,N)):(h.u="GET",h.g.ea(h.A,h.u,null,N)),qr(),Ln(h.i,h.u,h.A,h.l,h.R,h.m)}Zn.prototype.ca=function(h){h=h.target;const N=this.M;N&&wi(h)==3?N.j():this.Y(h)},Zn.prototype.Y=function(h){try{if(h==this.g)e:{const Nn=wi(this.g);var N=this.g.Ba();const Mi=this.g.Z();if(!(3>Nn)&&(Nn!=3||this.g&&(this.h.h||this.g.oa()||Ol(this.g)))){this.J||Nn!=4||N==7||(N==8||0>=Mi?qr(3):qr(2)),po(this);var O=this.g.Z();this.X=O;t:if(Ia(this)){var J=Ol(this.g);h="";var ve=J.length,_e=wi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Li(this),Sr(this);var $e="";break t}this.h.i=new l.TextDecoder}for(N=0;N<ve;N++)this.h.h=!0,h+=this.h.i.decode(J[N],{stream:!(_e&&N==ve-1)});J.length=0,this.h.g+=h,this.C=0,$e=this.h.g}else $e=this.g.oa();if(this.o=O==200,dr(this.i,this.u,this.A,this.l,this.R,Nn,O),this.o){if(this.T&&!this.K){t:{if(this.g){var qt,Bn=this.g;if((qt=Bn.g?Bn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(qt)){var Ft=qt;break t}}Ft=null}if(O=Ft)Dn(this.i,this.l,O,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,go(this,O);else{this.o=!1,this.s=3,kn(12),Li(this),Sr(this);break e}}if(this.P){O=!0;let Gr;for(;!this.J&&this.C<$e.length;)if(Gr=$u(this,$e),Gr==_s){Nn==4&&(this.s=4,kn(14),O=!1),Dn(this.i,this.l,null,"[Incomplete Response]");break}else if(Gr==Ri){this.s=4,kn(15),Dn(this.i,this.l,$e,"[Invalid Chunk]"),O=!1;break}else Dn(this.i,this.l,Gr,null),go(this,Gr);if(Ia(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Nn!=4||$e.length!=0||this.h.h||(this.s=1,kn(16),O=!1),this.o=this.o&&O,!O)Dn(this.i,this.l,$e,"[Invalid Chunked Response]"),Li(this),Sr(this);else if(0<$e.length&&!this.W){this.W=!0;var Ot=this.j;Ot.g==this&&Ot.ba&&!Ot.M&&(Ot.j.info("Great, no buffering proxy detected. Bytes received: "+$e.length),Ke(Ot),Ot.M=!0,kn(11))}}else Dn(this.i,this.l,$e,null),go(this,$e);Nn==4&&Li(this),this.o&&!this.J&&(Nn==4?_t(this.j,this):(this.o=!1,Qs(this)))}else ks(this.g),O==400&&0<$e.indexOf("Unknown SID")?(this.s=3,kn(12)):(this.s=0,kn(13)),Li(this),Sr(this)}}}catch{}finally{}};function Ia(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function $u(h,N){var O=h.C,J=N.indexOf(`
`,O);return J==-1?_s:(O=Number(N.substring(O,J)),isNaN(O)?Ri:(J+=1,J+O>N.length?_s:(N=N.slice(J,J+O),h.C=J+O,N)))}Zn.prototype.cancel=function(){this.J=!0,Li(this)};function Qs(h){h.S=Date.now()+h.I,Al(h,h.I)}function Al(h,N){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Er(g(h.ba,h),N)}function po(h){h.B&&(l.clearTimeout(h.B),h.B=null)}Zn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(ja(this.i,this.A),this.L!=2&&(qr(),kn(17)),Li(this),this.s=2,Sr(this)):Al(this,this.S-h)};function Sr(h){h.j.G==0||h.J||_t(h.j,h)}function Li(h){po(h);var N=h.M;N&&typeof N.ma=="function"&&N.ma(),h.M=null,tt(h.U),h.g&&(N=h.g,h.g=null,N.abort(),N.ma())}function go(h,N){try{var O=h.j;if(O.G!=0&&(O.g==h||Xs(O.h,h))){if(!h.K&&Xs(O.h,h)&&O.G==3){try{var J=O.Da.g.parse(N)}catch{J=null}if(Array.isArray(J)&&J.length==3){var ve=J;if(ve[0]==0){e:if(!O.u){if(O.g)if(O.g.F+3e3<h.F)vt(O),as(O);else break e;Ce(O),kn(18)}}else O.za=ve[1],0<O.za-O.T&&37500>ve[2]&&O.F&&O.v==0&&!O.C&&(O.C=Er(g(O.Za,O),6e3));if(1>=jl(O.h)&&O.ca){try{O.ca()}catch{}O.ca=void 0}}else rn(O,11)}else if((h.K||O.g==h)&&vt(O),!P(N))for(ve=O.Da.g.parse(N),N=0;N<ve.length;N++){let Ft=ve[N];if(O.T=Ft[0],Ft=Ft[1],O.G==2)if(Ft[0]=="c"){O.K=Ft[1],O.ia=Ft[2];const Ot=Ft[3];Ot!=null&&(O.la=Ot,O.j.info("VER="+O.la));const Nn=Ft[4];Nn!=null&&(O.Aa=Nn,O.j.info("SVER="+O.Aa));const Mi=Ft[5];Mi!=null&&typeof Mi=="number"&&0<Mi&&(J=1.5*Mi,O.L=J,O.j.info("backChannelRequestTimeoutMs_="+J)),J=O;const Gr=h.g;if(Gr){const Rr=Gr.g?Gr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Rr){var _e=J.h;_e.g||Rr.indexOf("spdy")==-1&&Rr.indexOf("quic")==-1&&Rr.indexOf("h2")==-1||(_e.j=_e.l,_e.g=new Set,_e.h&&(Cl(_e,_e.h),_e.h=null))}if(J.D){const Ts=Gr.g?Gr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ts&&(J.ya=Ts,Bt(J.I,J.D,Ts))}}O.G=3,O.l&&O.l.ua(),O.ba&&(O.R=Date.now()-h.F,O.j.info("Handshake RTT: "+O.R+"ms")),J=O;var $e=h;if(J.qa=ln(J,J.J?J.ia:null,J.W),$e.K){Fn(J.h,$e);var qt=$e,Bn=J.L;Bn&&(qt.I=Bn),qt.B&&(po(qt),Qs(qt)),J.g=$e}else Se(J);0<O.i.length&&y(O)}else Ft[0]!="stop"&&Ft[0]!="close"||rn(O,7);else O.G==3&&(Ft[0]=="stop"||Ft[0]=="close"?Ft[0]=="stop"?rn(O,7):_o(O):Ft[0]!="noop"&&O.l&&O.l.ta(Ft),O.v=0)}}qr(4)}catch{}}var Sl=class{constructor(h,N){this.g=h,this.map=N}};function kl(h){this.l=h||10,l.PerformanceNavigationTiming?(h=l.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Tl(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function jl(h){return h.h?1:h.g?h.g.size:0}function Xs(h,N){return h.h?h.h==N:h.g?h.g.has(N):!1}function Cl(h,N){h.g?h.g.add(N):h.h=N}function Fn(h,N){h.h&&h.h==N?h.h=null:h.g&&h.g.has(N)&&h.g.delete(N)}kl.prototype.cancel=function(){if(this.i=Il(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Il(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let N=h.i;for(const O of h.g.values())N=N.concat(O.D);return N}return k(h.i)}function Ac(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(c(h)){for(var N=[],O=h.length,J=0;J<O;J++)N.push(h[J]);return N}N=[],O=0;for(J in h)N[O++]=h[J];return N}function Es(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(c(h)||typeof h=="string"){var N=[];h=h.length;for(var O=0;O<h;O++)N.push(O);return N}N=[],O=0;for(const J in h)N[O++]=J;return N}}}function Js(h,N){if(h.forEach&&typeof h.forEach=="function")h.forEach(N,void 0);else if(c(h)||typeof h=="string")Array.prototype.forEach.call(h,N,void 0);else for(var O=Es(h),J=Ac(h),ve=J.length,_e=0;_e<ve;_e++)N.call(void 0,J[_e],O&&O[_e],h)}var yi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pa(h,N){if(h){h=h.split("&");for(var O=0;O<h.length;O++){var J=h[O].indexOf("="),ve=null;if(0<=J){var _e=h[O].substring(0,J);ve=h[O].substring(J+1)}else _e=h[O];N(_e,ve?decodeURIComponent(ve.replace(/\+/g," ")):"")}}}function on(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof on){this.h=h.h,vo(this,h.j),this.o=h.o,this.g=h.g,yo(this,h.s),this.l=h.l;var N=h.i,O=new bi;O.i=N.i,N.g&&(O.g=new Map(N.g),O.h=N.h),Sc(this,O),this.m=h.m}else h&&(N=String(h).match(yi))?(this.h=!1,vo(this,N[1]||"",!0),this.o=Zs(N[2]||""),this.g=Zs(N[3]||"",!0),yo(this,N[4]),this.l=Zs(N[5]||"",!0),Sc(this,N[6]||"",!0),this.m=Zs(N[7]||"")):(this.h=!1,this.i=new bi(null,this.h))}on.prototype.toString=function(){var h=[],N=this.j;N&&h.push(xi(N,kc,!0),":");var O=this.g;return(O||N=="file")&&(h.push("//"),(N=this.o)&&h.push(xi(N,kc,!0),"@"),h.push(encodeURIComponent(String(O)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),O=this.s,O!=null&&h.push(":",String(O))),(O=this.l)&&(this.g&&O.charAt(0)!="/"&&h.push("/"),h.push(xi(O,O.charAt(0)=="/"?qu:zu,!0))),(O=this.i.toString())&&h.push("?",O),(O=this.m)&&h.push("#",xi(O,La)),h.join("")};function ci(h){return new on(h)}function vo(h,N,O){h.j=O?Zs(N,!0):N,h.j&&(h.j=h.j.replace(/:$/,""))}function yo(h,N){if(N){if(N=Number(N),isNaN(N)||0>N)throw Error("Bad port number "+N);h.s=N}else h.s=null}function Sc(h,N,O){N instanceof bi?(h.i=N,Hu(h.i,h.h)):(O||(N=xi(N,Rl)),h.i=new bi(N,h.h))}function Bt(h,N,O){h.i.set(N,O)}function Ra(h){return Bt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Zs(h,N){return h?N?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function xi(h,N,O){return typeof h=="string"?(h=encodeURI(h).replace(N,Pl),O&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Pl(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var kc=/[#\/\?@]/g,zu=/[#\?:]/g,qu=/[#\?]/g,Rl=/[#\?@]/g,La=/#/g;function bi(h,N){this.h=this.g=null,this.i=h||null,this.j=!!N}function is(h){h.g||(h.g=new Map,h.h=0,h.i&&Pa(h.i,function(N,O){h.add(decodeURIComponent(N.replace(/\+/g," ")),O)}))}t=bi.prototype,t.add=function(h,N){is(this),this.i=null,h=ta(this,h);var O=this.g.get(h);return O||this.g.set(h,O=[]),O.push(N),this.h+=1,this};function ea(h,N){is(h),N=ta(h,N),h.g.has(N)&&(h.i=null,h.h-=h.g.get(N).length,h.g.delete(N))}function xo(h,N){return is(h),N=ta(h,N),h.g.has(N)}t.forEach=function(h,N){is(this),this.g.forEach(function(O,J){O.forEach(function(ve){h.call(N,ve,J,this)},this)},this)},t.na=function(){is(this);const h=Array.from(this.g.values()),N=Array.from(this.g.keys()),O=[];for(let J=0;J<N.length;J++){const ve=h[J];for(let _e=0;_e<ve.length;_e++)O.push(N[J])}return O},t.V=function(h){is(this);let N=[];if(typeof h=="string")xo(this,h)&&(N=N.concat(this.g.get(ta(this,h))));else{h=Array.from(this.g.values());for(let O=0;O<h.length;O++)N=N.concat(h[O])}return N},t.set=function(h,N){return is(this),this.i=null,h=ta(this,h),xo(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[N]),this.h+=1,this},t.get=function(h,N){return h?(h=this.V(h),0<h.length?String(h[0]):N):N};function bt(h,N,O){ea(h,N),0<O.length&&(h.i=null,h.g.set(ta(h,N),k(O)),h.h+=O.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],N=Array.from(this.g.keys());for(var O=0;O<N.length;O++){var J=N[O];const _e=encodeURIComponent(String(J)),$e=this.V(J);for(J=0;J<$e.length;J++){var ve=_e;$e[J]!==""&&(ve+="="+encodeURIComponent(String($e[J]))),h.push(ve)}}return this.i=h.join("&")};function ta(h,N){return N=String(N),h.j&&(N=N.toLowerCase()),N}function Hu(h,N){N&&!h.j&&(is(h),h.i=null,h.g.forEach(function(O,J){var ve=J.toLowerCase();J!=ve&&(ea(this,J),bt(this,ve,O))},h)),h.j=N}function Wu(h,N){const O=new Ar;if(l.Image){const J=new Image;J.onload=p(kr,O,"TestLoadImage: loaded",!0,N,J),J.onerror=p(kr,O,"TestLoadImage: error",!1,N,J),J.onabort=p(kr,O,"TestLoadImage: abort",!1,N,J),J.ontimeout=p(kr,O,"TestLoadImage: timeout",!1,N,J),l.setTimeout(function(){J.ontimeout&&J.ontimeout()},1e4),J.src=h}else N(!1)}function Gu(h,N){const O=new Ar,J=new AbortController,ve=setTimeout(()=>{J.abort(),kr(O,"TestPingServer: timeout",!1,N)},1e4);fetch(h,{signal:J.signal}).then(_e=>{clearTimeout(ve),_e.ok?kr(O,"TestPingServer: ok",!0,N):kr(O,"TestPingServer: server error",!1,N)}).catch(()=>{clearTimeout(ve),kr(O,"TestPingServer: error",!1,N)})}function kr(h,N,O,J,ve){try{ve&&(ve.onload=null,ve.onerror=null,ve.onabort=null,ve.ontimeout=null),J(O)}catch{}}function As(){this.g=new pt}function Ku(h,N,O){const J=O||"";try{Js(h,function(ve,_e){let $e=ve;u(ve)&&($e=Nt(ve)),N.push(J+_e+"="+encodeURIComponent($e))})}catch(ve){throw N.push(J+"type="+encodeURIComponent("_badmap")),ve}}function bo(h){this.l=h.Ub||null,this.j=h.eb||!1}T(bo,Dt),bo.prototype.g=function(){return new Ss(this.l,this.j)},bo.prototype.i=function(h){return function(){return h}}({});function Ss(h,N){st.call(this),this.D=h,this.o=N,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(Ss,st),t=Ss.prototype,t.open=function(h,N){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=N,this.readyState=1,ss(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const N={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(N.body=h),(this.D||l).fetch(new Request(this.A,N)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Di(this)),this.readyState=0},t.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,ss(this)),this.g&&(this.readyState=3,ss(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;wo(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function wo(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}t.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var N=h.value?h.value:new Uint8Array(0);(N=this.v.decode(N,{stream:!h.done}))&&(this.response=this.responseText+=N)}h.done?Di(this):ss(this),this.readyState==3&&wo(this)}},t.Ra=function(h){this.g&&(this.response=this.responseText=h,Di(this))},t.Qa=function(h){this.g&&(this.response=h,Di(this))},t.ga=function(){this.g&&Di(this)};function Di(h){h.readyState=4,h.l=null,h.j=null,h.v=null,ss(h)}t.setRequestHeader=function(h,N){this.u.append(h,N)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],N=this.h.entries();for(var O=N.next();!O.done;)O=O.value,h.push(O[0]+": "+O[1]),O=N.next();return h.join(`\r
`)};function ss(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Ss.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Da(h){let N="";return le(h,function(O,J){N+=J,N+=":",N+=O,N+=`\r
`}),N}function Ll(h,N,O){e:{for(J in O){var J=!1;break e}J=!0}J||(O=Da(O),typeof h=="string"?O!=null&&encodeURIComponent(String(O)):Bt(h,N,O))}function gn(h){st.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(gn,st);var Dl=/^https?$/i,Oa=["POST","PUT"];t=gn.prototype,t.Ha=function(h){this.J=h},t.ea=function(h,N,O,J){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);N=N?N.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():li.g(),this.v=this.o?St(this.o):St(li),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(N,String(h),!0),this.B=!1}catch(_e){na(this,_e);return}if(h=O||"",O=new Map(this.headers),J)if(Object.getPrototypeOf(J)===Object.prototype)for(var ve in J)O.set(ve,J[ve]);else if(typeof J.keys=="function"&&typeof J.get=="function")for(const _e of J.keys())O.set(_e,J.get(_e));else throw Error("Unknown input type for opt_headers: "+String(J));J=Array.from(O.keys()).find(_e=>_e.toLowerCase()=="content-type"),ve=l.FormData&&h instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Oa,N,void 0))||J||ve||O.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[_e,$e]of O)this.g.setRequestHeader(_e,$e);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ia(this),this.u=!0,this.g.send(h),this.u=!1}catch(_e){na(this,_e)}};function na(h,N){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=N,h.m=5,No(h),ra(h)}function No(h){h.A||(h.A=!0,Tt(h,"complete"),Tt(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Tt(this,"complete"),Tt(this,"abort"),ra(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ra(this,!0)),gn.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ma(this):this.bb())},t.bb=function(){Ma(this)};function Ma(h){if(h.h&&typeof o<"u"&&(!h.v[1]||wi(h)!=4||h.Z()!=2)){if(h.u&&wi(h)==4)ot(h.Ea,0,h);else if(Tt(h,"readystatechange"),wi(h)==4){h.h=!1;try{const $e=h.Z();e:switch($e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var N=!0;break e;default:N=!1}var O;if(!(O=N)){var J;if(J=$e===0){var ve=String(h.D).match(yi)[1]||null;!ve&&l.self&&l.self.location&&(ve=l.self.location.protocol.slice(0,-1)),J=!Dl.test(ve?ve.toLowerCase():"")}O=J}if(O)Tt(h,"complete"),Tt(h,"success");else{h.m=6;try{var _e=2<wi(h)?h.g.statusText:""}catch{_e=""}h.l=_e+" ["+h.Z()+"]",No(h)}}finally{ra(h)}}}}function ra(h,N){if(h.g){ia(h);const O=h.g,J=h.v[0]?()=>{}:null;h.g=null,h.v=null,N||Tt(h,"ready");try{O.onreadystatechange=J}catch{}}}function ia(h){h.I&&(l.clearTimeout(h.I),h.I=null)}t.isActive=function(){return!!this.g};function wi(h){return h.g?h.g.readyState:0}t.Z=function(){try{return 2<wi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(h){if(this.g){var N=this.g.responseText;return h&&N.indexOf(h)==0&&(N=N.substring(h.length)),an(N)}};function Ol(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function ks(h){const N={};h=(h.g&&2<=wi(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let J=0;J<h.length;J++){if(P(h[J]))continue;var O=A(h[J]);const ve=O[0];if(O=O[1],typeof O!="string")continue;O=O.trim();const _e=N[ve]||[];N[ve]=_e,_e.push(O)}U(N,function(J){return J.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ui(h,N,O){return O&&O.internalChannelParams&&O.internalChannelParams[h]||N}function Ml(h){this.Aa=0,this.i=[],this.j=new Ar,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ui("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ui("baseRetryDelayMs",5e3,h),this.cb=ui("retryDelaySeedMs",1e4,h),this.Wa=ui("forwardChannelMaxRetries",2,h),this.wa=ui("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new kl(h&&h.concurrentRequestLimit),this.Da=new As,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Ml.prototype,t.la=8,t.G=1,t.connect=function(h,N,O,J){kn(0),this.W=h,this.H=N||{},O&&J!==void 0&&(this.H.OSID=O,this.H.OAID=J),this.F=this.X,this.I=ln(this,null,this.W),y(this)};function _o(h){if(Fl(h),h.G==3){var N=h.U++,O=ci(h.I);if(Bt(O,"SID",h.K),Bt(O,"RID",N),Bt(O,"TYPE","terminate"),de(h,O),N=new Zn(h,h.j,N),N.L=2,N.v=Ra(ci(O)),O=!1,l.navigator&&l.navigator.sendBeacon)try{O=l.navigator.sendBeacon(N.v.toString(),"")}catch{}!O&&l.Image&&(new Image().src=N.v,O=!0),O||(N.g=Wn(N.j,null),N.g.ea(N.v)),N.F=Date.now(),Qs(N)}Un(h)}function as(h){h.g&&(Ke(h),h.g.cancel(),h.g=null)}function Fl(h){as(h),h.u&&(l.clearTimeout(h.u),h.u=null),vt(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&l.clearTimeout(h.s),h.s=null)}function y(h){if(!Tl(h.h)&&!h.s){h.s=!0;var N=h.Ga;z||X(),q||(z(),q=!0),H.add(N,h),h.B=0}}function B(h,N){return jl(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=N.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Er(g(h.Ga,h,N),Yt(h,h.B)),h.B++,!0)}t.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const ve=new Zn(this,this.j,h);let _e=this.o;if(this.S&&(_e?(_e=j(_e),F(_e,this.S)):_e=this.S),this.m!==null||this.O||(ve.H=_e,_e=null),this.P)e:{for(var N=0,O=0;O<this.i.length;O++){t:{var J=this.i[O];if("__data__"in J.map&&(J=J.map.__data__,typeof J=="string")){J=J.length;break t}J=void 0}if(J===void 0)break;if(N+=J,4096<N){N=O;break e}if(N===4096||O===this.i.length-1){N=O+1;break e}}N=1e3}else N=1e3;N=ge(this,ve,N),O=ci(this.I),Bt(O,"RID",h),Bt(O,"CVER",22),this.D&&Bt(O,"X-HTTP-Session-Id",this.D),de(this,O),_e&&(this.O?N="headers="+encodeURIComponent(String(Da(_e)))+"&"+N:this.m&&Ll(O,this.m,_e)),Cl(this.h,ve),this.Ua&&Bt(O,"TYPE","init"),this.P?(Bt(O,"$req",N),Bt(O,"SID","null"),ve.T=!0,Ys(ve,O,null)):Ys(ve,O,N),this.G=2}}else this.G==3&&(h?se(this,h):this.i.length==0||Tl(this.h)||se(this))};function se(h,N){var O;N?O=N.l:O=h.U++;const J=ci(h.I);Bt(J,"SID",h.K),Bt(J,"RID",O),Bt(J,"AID",h.T),de(h,J),h.m&&h.o&&Ll(J,h.m,h.o),O=new Zn(h,h.j,O,h.B+1),h.m===null&&(O.H=h.o),N&&(h.i=N.D.concat(h.i)),N=ge(h,O,1e3),O.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Cl(h.h,O),Ys(O,J,N)}function de(h,N){h.H&&le(h.H,function(O,J){Bt(N,J,O)}),h.l&&Js({},function(O,J){Bt(N,J,O)})}function ge(h,N,O){O=Math.min(h.i.length,O);var J=h.l?g(h.l.Na,h.l,h):null;e:{var ve=h.i;let _e=-1;for(;;){const $e=["count="+O];_e==-1?0<O?(_e=ve[0].g,$e.push("ofs="+_e)):_e=0:$e.push("ofs="+_e);let qt=!0;for(let Bn=0;Bn<O;Bn++){let Ft=ve[Bn].g;const Ot=ve[Bn].map;if(Ft-=_e,0>Ft)_e=Math.max(0,ve[Bn].g-100),qt=!1;else try{Ku(Ot,$e,"req"+Ft+"_")}catch{J&&J(Ot)}}if(qt){J=$e.join("&");break e}}}return h=h.i.splice(0,O),N.D=h,J}function Se(h){if(!h.g&&!h.u){h.Y=1;var N=h.Fa;z||X(),q||(z(),q=!0),H.add(N,h),h.v=0}}function Ce(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Er(g(h.Fa,h),Yt(h,h.v)),h.v++,!0)}t.Fa=function(){if(this.u=null,Ze(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Er(g(this.ab,this),h)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,kn(10),as(this),Ze(this))};function Ke(h){h.A!=null&&(l.clearTimeout(h.A),h.A=null)}function Ze(h){h.g=new Zn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var N=ci(h.qa);Bt(N,"RID","rpc"),Bt(N,"SID",h.K),Bt(N,"AID",h.T),Bt(N,"CI",h.F?"0":"1"),!h.F&&h.ja&&Bt(N,"TO",h.ja),Bt(N,"TYPE","xmlhttp"),de(h,N),h.m&&h.o&&Ll(N,h.m,h.o),h.L&&(h.g.I=h.L);var O=h.g;h=h.ia,O.L=1,O.v=Ra(ci(N)),O.m=null,O.P=!0,Ca(O,h)}t.Za=function(){this.C!=null&&(this.C=null,as(this),Ce(this),kn(19))};function vt(h){h.C!=null&&(l.clearTimeout(h.C),h.C=null)}function _t(h,N){var O=null;if(h.g==N){vt(h),Ke(h),h.g=null;var J=2}else if(Xs(h.h,N))O=N.D,Fn(h.h,N),J=1;else return;if(h.G!=0){if(N.o)if(J==1){O=N.m?N.m.length:0,N=Date.now()-N.F;var ve=h.B;J=Jn(),Tt(J,new rs(J,O)),y(h)}else Se(h);else if(ve=N.s,ve==3||ve==0&&0<N.X||!(J==1&&B(h,N)||J==2&&Ce(h)))switch(O&&0<O.length&&(N=h.h,N.i=N.i.concat(O)),ve){case 1:rn(h,5);break;case 4:rn(h,10);break;case 3:rn(h,6);break;default:rn(h,2)}}}function Yt(h,N){let O=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(O*=2),O*N}function rn(h,N){if(h.j.info("Error code "+N),N==2){var O=g(h.fb,h),J=h.Xa;const ve=!J;J=new on(J||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||vo(J,"https"),Ra(J),ve?Wu(J.toString(),O):Gu(J.toString(),O)}else kn(2);h.G=0,h.l&&h.l.sa(N),Un(h),Fl(h)}t.fb=function(h){h?(this.j.info("Successfully pinged google.com"),kn(2)):(this.j.info("Failed to ping google.com"),kn(1))};function Un(h){if(h.G=0,h.ka=[],h.l){const N=Il(h.h);(N.length!=0||h.i.length!=0)&&(C(h.ka,N),C(h.ka,h.i),h.h.i.length=0,k(h.i),h.i.length=0),h.l.ra()}}function ln(h,N,O){var J=O instanceof on?ci(O):new on(O);if(J.g!="")N&&(J.g=N+"."+J.g),yo(J,J.s);else{var ve=l.location;J=ve.protocol,N=N?N+"."+ve.hostname:ve.hostname,ve=+ve.port;var _e=new on(null);J&&vo(_e,J),N&&(_e.g=N),ve&&yo(_e,ve),O&&(_e.l=O),J=_e}return O=h.D,N=h.ya,O&&N&&Bt(J,O,N),Bt(J,"VER",h.la),de(h,J),J}function Wn(h,N,O){if(N&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return N=h.Ca&&!h.pa?new gn(new bo({eb:O})):new gn(h.pa),N.Ha(h.J),N}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Vn(){}t=Vn.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Gn(){}Gn.prototype.g=function(h,N){return new wn(h,N)};function wn(h,N){st.call(this),this.g=new Ml(N),this.l=h,this.h=N&&N.messageUrlParams||null,h=N&&N.messageHeaders||null,N&&N.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=N&&N.initMessageHeaders||null,N&&N.messageContentType&&(h?h["X-WebChannel-Content-Type"]=N.messageContentType:h={"X-WebChannel-Content-Type":N.messageContentType}),N&&N.va&&(h?h["X-WebChannel-Client-Profile"]=N.va:h={"X-WebChannel-Client-Profile":N.va}),this.g.S=h,(h=N&&N.Sb)&&!P(h)&&(this.g.m=h),this.v=N&&N.supportsCrossDomainXhr||!1,this.u=N&&N.sendRawJson||!1,(N=N&&N.httpSessionIdParam)&&!P(N)&&(this.g.D=N,h=this.h,h!==null&&N in h&&(h=this.h,N in h&&delete h[N])),this.j=new Oi(this)}T(wn,st),wn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},wn.prototype.close=function(){_o(this.g)},wn.prototype.o=function(h){var N=this.g;if(typeof h=="string"){var O={};O.__data__=h,h=O}else this.u&&(O={},O.__data__=Nt(h),h=O);N.i.push(new Sl(N.Ya++,h)),N.G==3&&y(N)},wn.prototype.N=function(){this.g.l=null,delete this.j,_o(this.g),delete this.g,wn.aa.N.call(this)};function Pr(h){nn.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var N=h.__sm__;if(N){e:{for(const O in N){h=O;break e}h=void 0}(this.i=h)&&(h=this.i,N=N!==null&&h in N?N[h]:void 0),this.data=N}else this.data=h}T(Pr,nn);function Ul(){xt.call(this),this.status=1}T(Ul,xt);function Oi(h){this.g=h}T(Oi,Vn),Oi.prototype.ua=function(){Tt(this.g,"a")},Oi.prototype.ta=function(h){Tt(this.g,new Pr(h))},Oi.prototype.sa=function(h){Tt(this.g,new Ul)},Oi.prototype.ra=function(){Tt(this.g,"b")},Gn.prototype.createWebChannel=Gn.prototype.g,wn.prototype.send=wn.prototype.o,wn.prototype.open=wn.prototype.m,wn.prototype.close=wn.prototype.close,B4=function(){return new Gn},V4=function(){return Jn()},U4=Mt,Tv={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Hr.NO_ERROR=0,Hr.TIMEOUT=8,Hr.HTTP_ERROR=6,nm=Hr,Pi.COMPLETE="complete",F4=Pi,Rn.EventType=Sn,Sn.OPEN="a",Sn.CLOSE="b",Sn.ERROR="c",Sn.MESSAGE="d",st.prototype.listen=st.prototype.K,Sd=Rn,gn.prototype.listenOnce=gn.prototype.L,gn.prototype.getLastError=gn.prototype.Ka,gn.prototype.getLastErrorCode=gn.prototype.Ba,gn.prototype.getStatus=gn.prototype.Z,gn.prototype.getResponseJson=gn.prototype.Oa,gn.prototype.getResponseText=gn.prototype.oa,gn.prototype.send=gn.prototype.ea,gn.prototype.setWithCredentials=gn.prototype.Ha,M4=gn}).apply(typeof Sf<"u"?Sf:typeof self<"u"?self:typeof window<"u"?window:{});const Eb="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ni.UNAUTHENTICATED=new ni(null),ni.GOOGLE_CREDENTIALS=new ni("google-credentials-uid"),ni.FIRST_PARTY=new ni("first-party-uid"),ni.MOCK_USER=new ni("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Du="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fc=new Q1("@firebase/firestore");function vd(){return fc.logLevel}function et(t,...e){if(fc.logLevel<=Wt.DEBUG){const n=e.map(dy);fc.debug(`Firestore (${Du}): ${t}`,...n)}}function co(t,...e){if(fc.logLevel<=Wt.ERROR){const n=e.map(dy);fc.error(`Firestore (${Du}): ${t}`,...n)}}function _u(t,...e){if(fc.logLevel<=Wt.WARN){const n=e.map(dy);fc.warn(`Firestore (${Du}): ${t}`,...n)}}function dy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kt(t="Unexpected state"){const e=`FIRESTORE (${Du}) INTERNAL ASSERTION FAILED: `+t;throw co(e),new Error(e)}function mn(t,e){t||kt()}function It(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const je={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class We extends Ea{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class p6{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ni.UNAUTHENTICATED))}shutdown(){}}class g6{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class v6{constructor(e){this.t=e,this.currentUser=ni.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){mn(this.o===void 0);let r=this.i;const i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let s=new to;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new to,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},l=c=>{et("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(et("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new to)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(et("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(mn(typeof r.accessToken=="string"),new $4(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return mn(e===null||typeof e=="string"),new ni(e)}}class y6{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=ni.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class x6{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new y6(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(ni.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class b6{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class w6{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){mn(this.o===void 0);const r=s=>{s.error!=null&&et("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,et("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{et("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):et("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(mn(typeof n.token=="string"),this.R=n.token,new b6(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N6(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=N6(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function tn(t,e){return t<e?-1:t>e?1:0}function Eu(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new We(je.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new We(je.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new We(je.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new We(je.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ht.fromMillis(Date.now())}static fromDate(e){return ht.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new ht(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?tn(this.nanoseconds,e.nanoseconds):tn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ct(e)}static min(){return new Ct(new ht(0,0))}static max(){return new Ct(new ht(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh{constructor(e,n,r){n===void 0?n=0:n>e.length&&kt(),r===void 0?r=e.length-n:r>e.length-n&&kt(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return dh.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof dh?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Cn extends dh{construct(e,n,r){return new Cn(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new We(je.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Cn(n)}static emptyPath(){return new Cn([])}}const _6=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ur extends dh{construct(e,n,r){return new Ur(e,n,r)}static isValidIdentifier(e){return _6.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ur.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ur(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new We(je.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new We(je.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new We(je.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new We(je.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ur(n)}static emptyPath(){return new Ur([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.path=e}static fromPath(e){return new ft(Cn.fromString(e))}static fromName(e){return new ft(Cn.fromString(e).popFirst(5))}static empty(){return new ft(Cn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Cn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Cn.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ft(new Cn(e.slice()))}}function E6(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ct.fromTimestamp(r===1e9?new ht(n+1,0):new ht(n,r));return new ml(i,ft.empty(),e)}function A6(t){return new ml(t.readTime,t.key,-1)}class ml{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new ml(Ct.min(),ft.empty(),-1)}static max(){return new ml(Ct.max(),ft.empty(),-1)}}function S6(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ft.comparator(t.documentKey,e.documentKey),n!==0?n:tn(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class T6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rh(t){if(t.code!==je.FAILED_PRECONDITION||t.message!==k6)throw t;et("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&kt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Oe((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Oe?n:Oe.resolve(n)}catch(n){return Oe.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Oe.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Oe.reject(n)}static resolve(e){return new Oe((n,r)=>{n(e)})}static reject(e){return new Oe((n,r)=>{r(e)})}static waitFor(e){return new Oe((n,r)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=Oe.resolve(!1);for(const r of e)n=n.next(i=>i?Oe.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new Oe((r,i)=>{const s=e.length,o=new Array(s);let l=0;for(let c=0;c<s;c++){const u=c;n(e[u]).next(f=>{o[u]=f,++l,l===s&&r(o)},f=>i(f))}})}static doWhile(e,n){return new Oe((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function j6(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Lh(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}hy.oe=-1;function Rp(t){return t==null}function Gm(t){return t===0&&1/t==-1/0}function C6(t){return typeof t=="number"&&Number.isInteger(t)&&!Gm(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ab(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function wc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function q4(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e,n){this.comparator=e,this.root=n||Fr.EMPTY}insert(e,n){return new Hn(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Fr.BLACK,null,null))}remove(e){return new Hn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new kf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new kf(this.root,e,this.comparator,!1)}getReverseIterator(){return new kf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new kf(this.root,e,this.comparator,!0)}}class kf{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Fr{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Fr.RED,this.left=i??Fr.EMPTY,this.right=s??Fr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Fr(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Fr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Fr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Fr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Fr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw kt();const e=this.left.check();if(e!==this.right.check())throw kt();return e+(this.isRed()?0:1)}}Fr.EMPTY=null,Fr.RED=!0,Fr.BLACK=!1;Fr.EMPTY=new class{constructor(){this.size=0}get key(){throw kt()}get value(){throw kt()}get color(){throw kt()}get left(){throw kt()}get right(){throw kt()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Fr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(e){this.comparator=e,this.data=new Hn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Sb(this.data.getIterator())}getIteratorFrom(e){return new Sb(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Br)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Br(this.comparator);return n.data=e,n}}class Sb{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e){this.fields=e,e.sort(Ur.comparator)}static empty(){return new Yi([])}unionWith(e){let n=new Br(Ur.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Yi(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Eu(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new H4("Invalid base64 string: "+s):s}}(e);return new zr(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new zr(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}zr.EMPTY_BYTE_STRING=new zr("");const I6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pl(t){if(mn(!!t),typeof t=="string"){let e=0;const n=I6.exec(t);if(mn(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ir(t.seconds),nanos:ir(t.nanos)}}function ir(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function mc(t){return typeof t=="string"?zr.fromBase64String(t):zr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fy(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function my(t){const e=t.mapValue.fields.__previous_value__;return fy(e)?my(e):e}function hh(t){const e=pl(t.mapValue.fields.__local_write_time__.timestampValue);return new ht(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P6{constructor(e,n,r,i,s,o,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class fh{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new fh("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof fh&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tf={mapValue:{}};function pc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fy(t)?4:L6(t)?9007199254740991:R6(t)?10:11:kt()}function wa(t,e){if(t===e)return!0;const n=pc(t);if(n!==pc(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return hh(t).isEqual(hh(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=pl(i.timestampValue),l=pl(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return mc(i.bytesValue).isEqual(mc(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return ir(i.geoPointValue.latitude)===ir(s.geoPointValue.latitude)&&ir(i.geoPointValue.longitude)===ir(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ir(i.integerValue)===ir(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=ir(i.doubleValue),l=ir(s.doubleValue);return o===l?Gm(o)===Gm(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Eu(t.arrayValue.values||[],e.arrayValue.values||[],wa);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(Ab(o)!==Ab(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!wa(o[c],l[c])))return!1;return!0}(t,e);default:return kt()}}function mh(t,e){return(t.values||[]).find(n=>wa(n,e))!==void 0}function Au(t,e){if(t===e)return 0;const n=pc(t),r=pc(e);if(n!==r)return tn(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return tn(t.booleanValue,e.booleanValue);case 2:return function(s,o){const l=ir(s.integerValue||s.doubleValue),c=ir(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return kb(t.timestampValue,e.timestampValue);case 4:return kb(hh(t),hh(e));case 5:return tn(t.stringValue,e.stringValue);case 6:return function(s,o){const l=mc(s),c=mc(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const f=tn(l[u],c[u]);if(f!==0)return f}return tn(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const l=tn(ir(s.latitude),ir(o.latitude));return l!==0?l:tn(ir(s.longitude),ir(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Tb(t.arrayValue,e.arrayValue);case 10:return function(s,o){var l,c,u,f;const v=s.fields||{},g=o.fields||{},p=(l=v.value)===null||l===void 0?void 0:l.arrayValue,T=(c=g.value)===null||c===void 0?void 0:c.arrayValue,k=tn(((u=p==null?void 0:p.values)===null||u===void 0?void 0:u.length)||0,((f=T==null?void 0:T.values)===null||f===void 0?void 0:f.length)||0);return k!==0?k:Tb(p,T)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Tf.mapValue&&o===Tf.mapValue)return 0;if(s===Tf.mapValue)return 1;if(o===Tf.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),u=o.fields||{},f=Object.keys(u);c.sort(),f.sort();for(let v=0;v<c.length&&v<f.length;++v){const g=tn(c[v],f[v]);if(g!==0)return g;const p=Au(l[c[v]],u[f[v]]);if(p!==0)return p}return tn(c.length,f.length)}(t.mapValue,e.mapValue);default:throw kt()}}function kb(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return tn(t,e);const n=pl(t),r=pl(e),i=tn(n.seconds,r.seconds);return i!==0?i:tn(n.nanos,r.nanos)}function Tb(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Au(n[i],r[i]);if(s)return s}return tn(n.length,r.length)}function Su(t){return jv(t)}function jv(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=pl(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return mc(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ft.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=jv(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${jv(n.fields[o])}`;return i+"}"}(t.mapValue):kt()}function jb(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Cv(t){return!!t&&"integerValue"in t}function py(t){return!!t&&"arrayValue"in t}function Cb(t){return!!t&&"nullValue"in t}function Ib(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function rm(t){return!!t&&"mapValue"in t}function R6(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Vd(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return wc(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Vd(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Vd(t.arrayValue.values[n]);return e}return Object.assign({},t)}function L6(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e){this.value=e}static empty(){return new Ai({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!rm(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vd(n)}setAll(e){let n=Ur.emptyPath(),r={},i=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=l.popLast()}o?r[l.lastSegment()]=Vd(o):i.push(l.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());rm(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return wa(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];rm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){wc(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Ai(Vd(this.value))}}function W4(t){const e=[];return wc(t.fields,(n,r)=>{const i=new Ur([n]);if(rm(r)){const s=W4(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Yi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e,n,r,i,s,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new ii(e,0,Ct.min(),Ct.min(),Ct.min(),Ai.empty(),0)}static newFoundDocument(e,n,r,i){return new ii(e,1,n,Ct.min(),r,i,0)}static newNoDocument(e,n){return new ii(e,2,n,Ct.min(),Ct.min(),Ai.empty(),0)}static newUnknownDocument(e,n){return new ii(e,3,n,Ct.min(),Ct.min(),Ai.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ct.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ai.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ai.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ct.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ii&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ii(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(e,n){this.position=e,this.inclusive=n}}function Pb(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=ft.comparator(ft.fromName(o.referenceValue),n.key):r=Au(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Rb(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!wa(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(e,n="asc"){this.field=e,this.dir=n}}function D6(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{}class pr extends G4{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new M6(e,n,r):n==="array-contains"?new V6(e,r):n==="in"?new B6(e,r):n==="not-in"?new $6(e,r):n==="array-contains-any"?new z6(e,r):new pr(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new F6(e,r):new U6(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Au(n,this.value)):n!==null&&pc(this.value)===pc(n)&&this.matchesComparison(Au(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return kt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Bs extends G4{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Bs(e,n)}matches(e){return K4(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function K4(t){return t.op==="and"}function Y4(t){return O6(t)&&K4(t)}function O6(t){for(const e of t.filters)if(e instanceof Bs)return!1;return!0}function Iv(t){if(t instanceof pr)return t.field.canonicalString()+t.op.toString()+Su(t.value);if(Y4(t))return t.filters.map(e=>Iv(e)).join(",");{const e=t.filters.map(n=>Iv(n)).join(",");return`${t.op}(${e})`}}function Q4(t,e){return t instanceof pr?function(r,i){return i instanceof pr&&r.op===i.op&&r.field.isEqual(i.field)&&wa(r.value,i.value)}(t,e):t instanceof Bs?function(r,i){return i instanceof Bs&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,l)=>s&&Q4(o,i.filters[l]),!0):!1}(t,e):void kt()}function X4(t){return t instanceof pr?function(n){return`${n.field.canonicalString()} ${n.op} ${Su(n.value)}`}(t):t instanceof Bs?function(n){return n.op.toString()+" {"+n.getFilters().map(X4).join(" ,")+"}"}(t):"Filter"}class M6 extends pr{constructor(e,n,r){super(e,n,r),this.key=ft.fromName(r.referenceValue)}matches(e){const n=ft.comparator(e.key,this.key);return this.matchesComparison(n)}}class F6 extends pr{constructor(e,n){super(e,"in",n),this.keys=J4("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class U6 extends pr{constructor(e,n){super(e,"not-in",n),this.keys=J4("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function J4(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ft.fromName(r.referenceValue))}class V6 extends pr{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return py(n)&&mh(n.arrayValue,this.value)}}class B6 extends pr{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&mh(this.value.arrayValue,n)}}class $6 extends pr{constructor(e,n){super(e,"not-in",n)}matches(e){if(mh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!mh(this.value.arrayValue,n)}}class z6 extends pr{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!py(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>mh(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q6{constructor(e,n=null,r=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function Lb(t,e=null,n=[],r=[],i=null,s=null,o=null){return new q6(t,e,n,r,i,s,o)}function gy(t){const e=It(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Iv(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Rp(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Su(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Su(r)).join(",")),e.ue=n}return e.ue}function vy(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!D6(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Q4(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Rb(t.startAt,e.startAt)&&Rb(t.endAt,e.endAt)}function Pv(t){return ft.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e,n=null,r=[],i=[],s=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function H6(t,e,n,r,i,s,o,l){return new Ou(t,e,n,r,i,s,o,l)}function Lp(t){return new Ou(t)}function Db(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Z4(t){return t.collectionGroup!==null}function Bd(t){const e=It(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Br(Ur.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new ph(s,r))}),n.has(Ur.keyField().canonicalString())||e.ce.push(new ph(Ur.keyField(),r))}return e.ce}function xa(t){const e=It(t);return e.le||(e.le=W6(e,Bd(t))),e.le}function W6(t,e){if(t.limitType==="F")return Lb(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new ph(i.field,s)});const n=t.endAt?new Km(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Km(t.startAt.position,t.startAt.inclusive):null;return Lb(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Rv(t,e){const n=t.filters.concat([e]);return new Ou(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ym(t,e,n){return new Ou(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Dp(t,e){return vy(xa(t),xa(e))&&t.limitType===e.limitType}function eE(t){return`${gy(xa(t))}|lt:${t.limitType}`}function Dc(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>X4(i)).join(", ")}]`),Rp(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Su(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Su(i)).join(",")),`Target(${r})`}(xa(t))}; limitType=${t.limitType})`}function Op(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ft.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Bd(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,l,c){const u=Pb(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,Bd(r),i)||r.endAt&&!function(o,l,c){const u=Pb(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,Bd(r),i))}(t,e)}function G6(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function tE(t){return(e,n)=>{let r=!1;for(const i of Bd(t)){const s=K6(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function K6(t,e,n){const r=t.field.isKeyField()?ft.comparator(e.key,n.key):function(s,o,l){const c=o.data.field(s),u=l.data.field(s);return c!==null&&u!==null?Au(c,u):kt()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return kt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){wc(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return q4(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y6=new Hn(ft.comparator);function uo(){return Y6}const nE=new Hn(ft.comparator);function kd(...t){let e=nE;for(const n of t)e=e.insert(n.key,n);return e}function rE(t){let e=nE;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ec(){return $d()}function iE(){return $d()}function $d(){return new Mu(t=>t.toString(),(t,e)=>t.isEqual(e))}const Q6=new Hn(ft.comparator),X6=new Br(ft.comparator);function $t(...t){let e=X6;for(const n of t)e=e.add(n);return e}const J6=new Br(tn);function Z6(){return J6}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Gm(e)?"-0":e}}function sE(t){return{integerValue:""+t}}function eP(t,e){return C6(e)?sE(e):yy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(){this._=void 0}}function tP(t,e,n){return t instanceof Qm?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&fy(s)&&(s=my(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof gh?oE(t,e):t instanceof vh?lE(t,e):function(i,s){const o=aE(i,s),l=Ob(o)+Ob(i.Pe);return Cv(o)&&Cv(i.Pe)?sE(l):yy(i.serializer,l)}(t,e)}function nP(t,e,n){return t instanceof gh?oE(t,e):t instanceof vh?lE(t,e):n}function aE(t,e){return t instanceof Xm?function(r){return Cv(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Qm extends Mp{}class gh extends Mp{constructor(e){super(),this.elements=e}}function oE(t,e){const n=cE(e);for(const r of t.elements)n.some(i=>wa(i,r))||n.push(r);return{arrayValue:{values:n}}}class vh extends Mp{constructor(e){super(),this.elements=e}}function lE(t,e){let n=cE(e);for(const r of t.elements)n=n.filter(i=>!wa(i,r));return{arrayValue:{values:n}}}class Xm extends Mp{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Ob(t){return ir(t.integerValue||t.doubleValue)}function cE(t){return py(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function rP(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof gh&&i instanceof gh||r instanceof vh&&i instanceof vh?Eu(r.elements,i.elements,wa):r instanceof Xm&&i instanceof Xm?wa(r.Pe,i.Pe):r instanceof Qm&&i instanceof Qm}(t.transform,e.transform)}class iP{constructor(e,n){this.version=e,this.transformResults=n}}class gs{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new gs}static exists(e){return new gs(void 0,e)}static updateTime(e){return new gs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function im(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Fp{}function uE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new xy(t.key,gs.none()):new Dh(t.key,t.data,gs.none());{const n=t.data,r=Ai.empty();let i=new Br(Ur.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new El(t.key,r,new Yi(i.toArray()),gs.none())}}function sP(t,e,n){t instanceof Dh?function(i,s,o){const l=i.value.clone(),c=Fb(i.fieldTransforms,s,o.transformResults);l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof El?function(i,s,o){if(!im(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=Fb(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(dE(i)),c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function zd(t,e,n,r){return t instanceof Dh?function(s,o,l,c){if(!im(s.precondition,o))return l;const u=s.value.clone(),f=Ub(s.fieldTransforms,c,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof El?function(s,o,l,c){if(!im(s.precondition,o))return l;const u=Ub(s.fieldTransforms,c,o),f=o.data;return f.setAll(dE(s)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(v=>v.field))}(t,e,n,r):function(s,o,l){return im(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function aP(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=aE(r.transform,i||null);s!=null&&(n===null&&(n=Ai.empty()),n.set(r.field,s))}return n||null}function Mb(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Eu(r,i,(s,o)=>rP(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Dh extends Fp{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class El extends Fp{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function dE(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Fb(t,e,n){const r=new Map;mn(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,l=e.data.field(s.field);r.set(s.field,nP(o,l,n[i]))}return r}function Ub(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,tP(s,o,e))}return r}class xy extends Fp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class oP extends Fp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&sP(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=zd(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=zd(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=iE();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=n.has(i.key)?null:l;const c=uE(o,l);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Ct.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),$t())}isEqual(e){return this.batchId===e.batchId&&Eu(this.mutations,e.mutations,(n,r)=>Mb(n,r))&&Eu(this.baseMutations,e.baseMutations,(n,r)=>Mb(n,r))}}class by{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){mn(e.mutations.length===r.length);let i=function(){return Q6}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new by(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uP{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hr,Xt;function dP(t){switch(t){default:return kt();case je.CANCELLED:case je.UNKNOWN:case je.DEADLINE_EXCEEDED:case je.RESOURCE_EXHAUSTED:case je.INTERNAL:case je.UNAVAILABLE:case je.UNAUTHENTICATED:return!1;case je.INVALID_ARGUMENT:case je.NOT_FOUND:case je.ALREADY_EXISTS:case je.PERMISSION_DENIED:case je.FAILED_PRECONDITION:case je.ABORTED:case je.OUT_OF_RANGE:case je.UNIMPLEMENTED:case je.DATA_LOSS:return!0}}function hE(t){if(t===void 0)return co("GRPC error has no .code"),je.UNKNOWN;switch(t){case hr.OK:return je.OK;case hr.CANCELLED:return je.CANCELLED;case hr.UNKNOWN:return je.UNKNOWN;case hr.DEADLINE_EXCEEDED:return je.DEADLINE_EXCEEDED;case hr.RESOURCE_EXHAUSTED:return je.RESOURCE_EXHAUSTED;case hr.INTERNAL:return je.INTERNAL;case hr.UNAVAILABLE:return je.UNAVAILABLE;case hr.UNAUTHENTICATED:return je.UNAUTHENTICATED;case hr.INVALID_ARGUMENT:return je.INVALID_ARGUMENT;case hr.NOT_FOUND:return je.NOT_FOUND;case hr.ALREADY_EXISTS:return je.ALREADY_EXISTS;case hr.PERMISSION_DENIED:return je.PERMISSION_DENIED;case hr.FAILED_PRECONDITION:return je.FAILED_PRECONDITION;case hr.ABORTED:return je.ABORTED;case hr.OUT_OF_RANGE:return je.OUT_OF_RANGE;case hr.UNIMPLEMENTED:return je.UNIMPLEMENTED;case hr.DATA_LOSS:return je.DATA_LOSS;default:return kt()}}(Xt=hr||(hr={}))[Xt.OK=0]="OK",Xt[Xt.CANCELLED=1]="CANCELLED",Xt[Xt.UNKNOWN=2]="UNKNOWN",Xt[Xt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xt[Xt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xt[Xt.NOT_FOUND=5]="NOT_FOUND",Xt[Xt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xt[Xt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xt[Xt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xt[Xt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xt[Xt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xt[Xt.ABORTED=10]="ABORTED",Xt[Xt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xt[Xt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xt[Xt.INTERNAL=13]="INTERNAL",Xt[Xt.UNAVAILABLE=14]="UNAVAILABLE",Xt[Xt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fP=new rc([4294967295,4294967295],0);function Vb(t){const e=hP().encode(t),n=new O4;return n.update(e),new Uint8Array(n.digest())}function Bb(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new rc([n,r],0),new rc([i,s],0)]}class wy{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Td(`Invalid padding: ${n}`);if(r<0)throw new Td(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Td(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Td(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=rc.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(rc.fromNumber(r)));return i.compare(fP)===1&&(i=new rc([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Vb(e),[r,i]=Bb(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new wy(s,i,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=Vb(e),[r,i]=Bb(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Td extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Oh.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Up(Ct.min(),i,new Hn(tn),uo(),$t())}}class Oh{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Oh(r,n,$t(),$t(),$t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sm{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class fE{constructor(e,n){this.targetId=e,this.me=n}}class mE{constructor(e,n,r=zr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class $b{constructor(){this.fe=0,this.ge=qb(),this.pe=zr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=$t(),n=$t(),r=$t();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:kt()}}),new Oh(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=qb()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,mn(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class mP{constructor(e){this.Le=e,this.Be=new Map,this.ke=uo(),this.qe=zb(),this.Qe=new Hn(tn)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:kt()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(Pv(s))if(r===0){const o=new ft(s.path);this.Ue(n,o,ii.newNoDocument(o,Ct.min()))}else mn(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,l;try{o=mc(r).toUint8Array()}catch(c){if(c instanceof H4)return _u("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new wy(o,i,s)}catch(c){return _u(c instanceof Td?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&Pv(l.target)){const c=new ft(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,ii.newNoDocument(c,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=$t();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new Up(e,n,this.Qe,this.ke,r);return this.ke=uo(),this.qe=zb(),this.Qe=new Hn(tn),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new $b,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Br(tn),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||et("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new $b),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function zb(){return new Hn(ft.comparator)}function qb(){return new Hn(ft.comparator)}const pP={asc:"ASCENDING",desc:"DESCENDING"},gP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vP={and:"AND",or:"OR"};class yP{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Lv(t,e){return t.useProto3Json||Rp(e)?e:{value:e}}function Jm(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pE(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function xP(t,e){return Jm(t,e.toTimestamp())}function ba(t){return mn(!!t),Ct.fromTimestamp(function(n){const r=pl(n);return new ht(r.seconds,r.nanos)}(t))}function Ny(t,e){return Dv(t,e).canonicalString()}function Dv(t,e){const n=function(i){return new Cn(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function gE(t){const e=Cn.fromString(t);return mn(wE(e)),e}function Ov(t,e){return Ny(t.databaseId,e.path)}function Xg(t,e){const n=gE(e);if(n.get(1)!==t.databaseId.projectId)throw new We(je.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new We(je.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ft(yE(n))}function vE(t,e){return Ny(t.databaseId,e)}function bP(t){const e=gE(t);return e.length===4?Cn.emptyPath():yE(e)}function Mv(t){return new Cn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function yE(t){return mn(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Hb(t,e,n){return{name:Ov(t,e),fields:n.value.mapValue.fields}}function wP(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:kt()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(mn(f===void 0||typeof f=="string"),zr.fromBase64String(f||"")):(mn(f===void 0||f instanceof Buffer||f instanceof Uint8Array),zr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const f=u.code===void 0?je.UNKNOWN:hE(u.code);return new We(f,u.message||"")}(o);n=new mE(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Xg(t,r.document.name),s=ba(r.document.updateTime),o=r.document.createTime?ba(r.document.createTime):Ct.min(),l=new Ai({mapValue:{fields:r.document.fields}}),c=ii.newFoundDocument(i,s,o,l),u=r.targetIds||[],f=r.removedTargetIds||[];n=new sm(u,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Xg(t,r.document),s=r.readTime?ba(r.readTime):Ct.min(),o=ii.newNoDocument(i,s),l=r.removedTargetIds||[];n=new sm([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Xg(t,r.document),s=r.removedTargetIds||[];n=new sm([],s,i,null)}else{if(!("filter"in e))return kt();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new uP(i,s),l=r.targetId;n=new fE(l,o)}}return n}function NP(t,e){let n;if(e instanceof Dh)n={update:Hb(t,e.key,e.value)};else if(e instanceof xy)n={delete:Ov(t,e.key)};else if(e instanceof El)n={update:Hb(t,e.key,e.data),updateMask:IP(e.fieldMask)};else{if(!(e instanceof oP))return kt();n={verify:Ov(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const l=o.transform;if(l instanceof Qm)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof gh)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof vh)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Xm)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw kt()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:xP(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:kt()}(t,e.precondition)),n}function _P(t,e){return t&&t.length>0?(mn(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?ba(i.updateTime):ba(s);return o.isEqual(Ct.min())&&(o=ba(s)),new iP(o,i.transformResults||[])}(n,e))):[]}function EP(t,e){return{documents:[vE(t,e.path)]}}function AP(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=vE(t,i);const s=function(u){if(u.length!==0)return bE(Bs.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:Oc(g.field),direction:TP(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Lv(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:i}}function SP(t){let e=bP(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){mn(r===1);const f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(v){const g=xE(v);return g instanceof Bs&&Y4(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(v){return v.map(g=>function(T){return new ph(Mc(T.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(g))}(n.orderBy));let l=null;n.limit&&(l=function(v){let g;return g=typeof v=="object"?v.value:v,Rp(g)?null:g}(n.limit));let c=null;n.startAt&&(c=function(v){const g=!!v.before,p=v.values||[];return new Km(p,g)}(n.startAt));let u=null;return n.endAt&&(u=function(v){const g=!v.before,p=v.values||[];return new Km(p,g)}(n.endAt)),H6(e,i,o,s,l,"F",c,u)}function kP(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return kt()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function xE(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Mc(n.unaryFilter.field);return pr.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Mc(n.unaryFilter.field);return pr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Mc(n.unaryFilter.field);return pr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Mc(n.unaryFilter.field);return pr.create(o,"!=",{nullValue:"NULL_VALUE"});default:return kt()}}(t):t.fieldFilter!==void 0?function(n){return pr.create(Mc(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return kt()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Bs.create(n.compositeFilter.filters.map(r=>xE(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return kt()}}(n.compositeFilter.op))}(t):kt()}function TP(t){return pP[t]}function jP(t){return gP[t]}function CP(t){return vP[t]}function Oc(t){return{fieldPath:t.canonicalString()}}function Mc(t){return Ur.fromServerFormat(t.fieldPath)}function bE(t){return t instanceof pr?function(n){if(n.op==="=="){if(Ib(n.value))return{unaryFilter:{field:Oc(n.field),op:"IS_NAN"}};if(Cb(n.value))return{unaryFilter:{field:Oc(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Ib(n.value))return{unaryFilter:{field:Oc(n.field),op:"IS_NOT_NAN"}};if(Cb(n.value))return{unaryFilter:{field:Oc(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Oc(n.field),op:jP(n.op),value:n.value}}}(t):t instanceof Bs?function(n){const r=n.getFilters().map(i=>bE(i));return r.length===1?r[0]:{compositeFilter:{op:CP(n.op),filters:r}}}(t):kt()}function IP(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function wE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e,n,r,i,s=Ct.min(),o=Ct.min(),l=zr.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Xo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Xo(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Xo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Xo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(e){this.ct=e}}function RP(t){const e=SP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ym(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(){this.un=new DP}addToCollectionParentIndex(e,n){return this.un.add(n),Oe.resolve()}getCollectionParents(e,n){return Oe.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return Oe.resolve()}deleteFieldIndex(e,n){return Oe.resolve()}deleteAllFieldIndexes(e){return Oe.resolve()}createTargetIndexes(e,n){return Oe.resolve()}getDocumentsMatchingTarget(e,n){return Oe.resolve(null)}getIndexType(e,n){return Oe.resolve(0)}getFieldIndexes(e,n){return Oe.resolve([])}getNextCollectionGroupToUpdate(e){return Oe.resolve(null)}getMinOffset(e,n){return Oe.resolve(ml.min())}getMinOffsetFromCollectionGroup(e,n){return Oe.resolve(ml.min())}updateCollectionGroup(e,n,r){return Oe.resolve()}updateIndexEntries(e,n){return Oe.resolve()}}class DP{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Br(Cn.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Br(Cn.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ku(0)}static kn(){return new ku(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(){this.changes=new Mu(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ii.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?Oe.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&zd(r.mutation,i,Yi.empty(),ht.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,$t()).next(()=>r))}getLocalViewOfDocuments(e,n,r=$t()){const i=ec();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=kd();return s.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ec();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,$t()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,i){let s=uo();const o=$d(),l=function(){return $d()}();return n.forEach((c,u)=>{const f=r.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof El)?s=s.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),zd(f.mutation,u,f.mutation.getFieldMask(),ht.now())):o.set(u.key,Yi.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,f)=>o.set(u,f)),n.forEach((u,f)=>{var v;return l.set(u,new MP(f,(v=o.get(u))!==null&&v!==void 0?v:null))}),l))}recalculateAndSaveOverlays(e,n){const r=$d();let i=new Hn((o,l)=>o-l),s=$t();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let f=r.get(c)||Yi.empty();f=l.applyToLocalView(u,f),r.set(c,f);const v=(i.get(l.batchId)||$t()).add(c);i=i.insert(l.batchId,v)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,f=c.value,v=iE();f.forEach(g=>{if(!s.has(g)){const p=uE(n.get(g),r.get(g));p!==null&&v.set(g,p),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,v))}return Oe.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return ft.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Z4(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):Oe.resolve(ec());let l=-1,c=s;return o.next(u=>Oe.forEach(u,(f,v)=>(l<v.largestBatchId&&(l=v.largestBatchId),s.get(f)?Oe.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{c=c.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,$t())).next(f=>({batchId:l,changes:rE(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ft(n)).next(r=>{let i=kd();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=kd();return this.indexManager.getCollectionParents(e,s).next(l=>Oe.forEach(l,c=>{const u=function(v,g){return new Ou(g,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(f=>{f.forEach((v,g)=>{o=o.insert(v,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,u)=>{const f=u.getKey();o.get(f)===null&&(o=o.insert(f,ii.newInvalidDocument(f)))});let l=kd();return o.forEach((c,u)=>{const f=s.get(c);f!==void 0&&zd(f.mutation,u,Yi.empty(),ht.now()),Op(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return Oe.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:ba(i.createTime)}}(n)),Oe.resolve()}getNamedQuery(e,n){return Oe.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:RP(i.bundledQuery),readTime:ba(i.readTime)}}(n)),Oe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(){this.overlays=new Hn(ft.comparator),this.Ir=new Map}getOverlay(e,n){return Oe.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ec();return Oe.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),Oe.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),Oe.resolve()}getOverlaysForCollection(e,n,r){const i=ec(),s=n.length+1,o=new ft(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return Oe.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Hn((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let f=s.get(u.largestBatchId);f===null&&(f=ec(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const l=ec(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,f)=>l.set(u,f)),!(l.size()>=i)););return Oe.resolve(l)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new cP(n,r));let s=this.Ir.get(n);s===void 0&&(s=$t(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{constructor(){this.sessionToken=zr.EMPTY_BYTE_STRING}getSessionToken(e){return Oe.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Oe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(){this.Tr=new Br(Tr.Er),this.dr=new Br(Tr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Tr(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Tr(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ft(new Cn([])),r=new Tr(n,e),i=new Tr(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ft(new Cn([])),r=new Tr(n,e),i=new Tr(n,e+1);let s=$t();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Tr(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Tr{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ft.comparator(e.key,n.key)||tn(e.wr,n.wr)}static Ar(e,n){return tn(e.wr,n.wr)||ft.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Br(Tr.Er)}checkEmpty(e){return Oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new lP(s,n,r,i);this.mutationQueue.push(o);for(const l of i)this.br=this.br.add(new Tr(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Oe.resolve(o)}lookupMutationBatch(e,n){return Oe.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return Oe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Oe.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Tr(n,0),i=new Tr(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const l=this.Dr(o.wr);s.push(l)}),Oe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Br(tn);return n.forEach(i=>{const s=new Tr(i,0),o=new Tr(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{r=r.add(l.wr)})}),Oe.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ft.isDocumentKey(s)||(s=s.child(""));const o=new Tr(new ft(s),0);let l=new Br(tn);return this.br.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(l=l.add(c.wr)),!0)},o),Oe.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){mn(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return Oe.forEach(n.mutations,i=>{const s=new Tr(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Tr(n,0),i=this.br.firstAfterOrEqual(r);return Oe.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Oe.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(e){this.Mr=e,this.docs=function(){return new Hn(ft.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return Oe.resolve(r?r.document.mutableCopy():ii.newInvalidDocument(n))}getEntries(e,n){let r=uo();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ii.newInvalidDocument(i))}),Oe.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=uo();const o=n.path,l=new ft(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:f}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||S6(A6(f),r)<=0||(i.has(f.key)||Op(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Oe.resolve(s)}getAllFromCollectionGroup(e,n,r,i){kt()}Or(e,n){return Oe.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new qP(this)}getSize(e){return Oe.resolve(this.size)}}class qP extends OP{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),Oe.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e){this.persistence=e,this.Nr=new Mu(n=>gy(n),vy),this.lastRemoteSnapshotVersion=Ct.min(),this.highestTargetId=0,this.Lr=0,this.Br=new _y,this.targetCount=0,this.kr=ku.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),Oe.resolve()}getLastRemoteSnapshotVersion(e){return Oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Oe.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Oe.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),Oe.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ku(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,Oe.resolve()}updateTargetData(e,n){return this.Kn(n),Oe.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,Oe.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),Oe.waitFor(s).next(()=>i)}getTargetCount(e){return Oe.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return Oe.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),Oe.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),Oe.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),Oe.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return Oe.resolve(r)}containsKey(e,n){return Oe.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(e,n){this.qr={},this.overlays={},this.Qr=new hy(0),this.Kr=!1,this.Kr=!0,this.$r=new BP,this.referenceDelegate=e(this),this.Ur=new HP(this),this.indexManager=new LP,this.remoteDocumentCache=function(i){return new zP(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new PP(n),this.Gr=new UP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new VP,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new $P(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){et("MemoryPersistence","Starting transaction:",e);const i=new GP(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return Oe.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class GP extends T6{constructor(e){super(),this.currentSequenceNumber=e}}class Ey{constructor(e){this.persistence=e,this.Jr=new _y,this.Yr=null}static Zr(e){return new Ey(e)}get Xr(){if(this.Yr)return this.Yr;throw kt()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),Oe.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),Oe.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),Oe.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Oe.forEach(this.Xr,r=>{const i=ft.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,Ct.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return Oe.or([()=>Oe.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=$t(),i=$t();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Ay(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return PT()?8:j6(oi())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new KP;return this.Xi(e,n,o).next(l=>{if(s.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(vd()<=Wt.DEBUG&&et("QueryEngine","SDK will not create cache indexes for query:",Dc(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Oe.resolve()):(vd()<=Wt.DEBUG&&et("QueryEngine","Query:",Dc(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(vd()<=Wt.DEBUG&&et("QueryEngine","The SDK decides to create cache indexes for query:",Dc(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,xa(n))):Oe.resolve())}Yi(e,n){if(Db(n))return Oe.resolve(null);let r=xa(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Ym(n,null,"F"),r=xa(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=$t(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ts(n,l);return this.ns(n,u,o,c.readTime)?this.Yi(e,Ym(n,null,"F")):this.rs(e,u,n,c)}))})))}Zi(e,n,r,i){return Db(n)||i.isEqual(Ct.min())?Oe.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?Oe.resolve(null):(vd()<=Wt.DEBUG&&et("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Dc(n)),this.rs(e,o,n,E6(i,-1)).next(l=>l))})}ts(e,n){let r=new Br(tE(e));return n.forEach((i,s)=>{Op(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return vd()<=Wt.DEBUG&&et("QueryEngine","Using full collection scan to execute query:",Dc(n)),this.Ji.getDocumentsMatchingQuery(e,n,ml.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new Hn(tn),this._s=new Mu(s=>gy(s),vy),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new FP(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function XP(t,e,n,r){return new QP(t,e,n,r)}async function NE(t,e){const n=It(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],l=[];let c=$t();for(const u of i){o.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}for(const u of s){l.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}return n.localDocuments.getDocuments(r,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function JP(t,e){const n=It(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,f){const v=u.batch,g=v.keys();let p=Oe.resolve();return g.forEach(T=>{p=p.next(()=>f.getEntry(c,T)).next(k=>{const C=u.docVersions.get(T);mn(C!==null),k.version.compareTo(C)<0&&(v.applyToRemoteDocument(k,u),k.isValidDocument()&&(k.setReadTime(u.commitVersion),f.addEntry(k)))})}),p.next(()=>l.mutationQueue.removeMutationBatch(c,v))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=$t();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function _E(t){const e=It(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function ZP(t,e){const n=It(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const l=[];e.targetChanges.forEach((f,v)=>{const g=i.get(v);if(!g)return;l.push(n.Ur.removeMatchingKeys(s,f.removedDocuments,v).next(()=>n.Ur.addMatchingKeys(s,f.addedDocuments,v)));let p=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(v)!==null?p=p.withResumeToken(zr.EMPTY_BYTE_STRING,Ct.min()).withLastLimboFreeSnapshotVersion(Ct.min()):f.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(f.resumeToken,r)),i=i.insert(v,p),function(k,C,b){return k.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(g,p,f)&&l.push(n.Ur.updateTargetData(s,p))});let c=uo(),u=$t();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),l.push(eR(s,o,e.documentUpdates).next(f=>{c=f.Ps,u=f.Is})),!r.isEqual(Ct.min())){const f=n.Ur.getLastRemoteSnapshotVersion(s).next(v=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(f)}return Oe.waitFor(l).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(n.os=i,s))}function eR(t,e,n){let r=$t(),i=$t();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=uo();return n.forEach((l,c)=>{const u=s.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(Ct.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):et("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function tR(t,e){const n=It(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function nR(t,e){const n=It(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,Oe.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new Xo(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Fv(t,e,n){const r=It(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Lh(o))throw o;et("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function Wb(t,e,n){const r=It(t);let i=Ct.min(),s=$t();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,f){const v=It(c),g=v._s.get(f);return g!==void 0?Oe.resolve(v.os.get(g)):v.Ur.getTargetData(u,f)}(r,o,xa(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:Ct.min(),n?s:$t())).next(l=>(rR(r,G6(e),l),{documents:l,Ts:s})))}function rR(t,e,n){let r=t.us.get(e)||Ct.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}class Gb{constructor(){this.activeTargetIds=Z6()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class iR{constructor(){this.so=new Gb,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Gb,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){et("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){et("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jf=null;function Jg(){return jf===null?jf=function(){return 268435456+Math.round(2147483648*Math.random())}():jf++,"0x"+jf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr="WebChannelConnection";class lR extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const l=Jg(),c=this.xo(n,r.toUriEncodedString());et("RestConnection",`Sending RPC '${n}' ${l}:`,c,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(n,c,u,i).then(f=>(et("RestConnection",`Received RPC '${n}' ${l}: `,f),f),f=>{throw _u("RestConnection",`RPC '${n}' ${l} failed with error: `,f,"url: ",c,"request:",i),f})}Lo(n,r,i,s,o,l){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Du}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=aR[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=Jg();return new Promise((o,l)=>{const c=new M4;c.setWithCredentials(!0),c.listenOnce(F4.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case nm.NO_ERROR:const f=c.getResponseJson();et(Xr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case nm.TIMEOUT:et(Xr,`RPC '${e}' ${s} timed out`),l(new We(je.DEADLINE_EXCEEDED,"Request time out"));break;case nm.HTTP_ERROR:const v=c.getStatus();if(et(Xr,`RPC '${e}' ${s} failed with status:`,v,"response text:",c.getResponseText()),v>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);const p=g==null?void 0:g.error;if(p&&p.status&&p.message){const T=function(C){const b=C.toLowerCase().replace(/_/g,"-");return Object.values(je).indexOf(b)>=0?b:je.UNKNOWN}(p.status);l(new We(T,p.message))}else l(new We(je.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new We(je.UNAVAILABLE,"Connection failed."));break;default:kt()}}finally{et(Xr,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);et(Xr,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",u,r,15)})}Bo(e,n,r){const i=Jg(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=B4(),l=V4(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const f=s.join("");et(Xr,`Creating RPC '${e}' stream ${i}: ${f}`,c);const v=o.createWebChannel(f,c);let g=!1,p=!1;const T=new oR({Io:C=>{p?et(Xr,`Not sending because RPC '${e}' stream ${i} is closed:`,C):(g||(et(Xr,`Opening RPC '${e}' stream ${i} transport.`),v.open(),g=!0),et(Xr,`RPC '${e}' stream ${i} sending:`,C),v.send(C))},To:()=>v.close()}),k=(C,b,P)=>{C.listen(b,R=>{try{P(R)}catch(D){setTimeout(()=>{throw D},0)}})};return k(v,Sd.EventType.OPEN,()=>{p||(et(Xr,`RPC '${e}' stream ${i} transport opened.`),T.yo())}),k(v,Sd.EventType.CLOSE,()=>{p||(p=!0,et(Xr,`RPC '${e}' stream ${i} transport closed`),T.So())}),k(v,Sd.EventType.ERROR,C=>{p||(p=!0,_u(Xr,`RPC '${e}' stream ${i} transport errored:`,C),T.So(new We(je.UNAVAILABLE,"The operation could not be completed")))}),k(v,Sd.EventType.MESSAGE,C=>{var b;if(!p){const P=C.data[0];mn(!!P);const R=P,D=R.error||((b=R[0])===null||b===void 0?void 0:b.error);if(D){et(Xr,`RPC '${e}' stream ${i} received error:`,D);const Z=D.status;let le=function(_){const F=hr[_];if(F!==void 0)return hE(F)}(Z),U=D.message;le===void 0&&(le=je.INTERNAL,U="Unknown error status: "+Z+" with message "+D.message),p=!0,T.So(new We(le,U)),v.close()}else et(Xr,`RPC '${e}' stream ${i} received:`,P),T.bo(P)}}),k(l,U4.STAT_EVENT,C=>{C.stat===Tv.PROXY?et(Xr,`RPC '${e}' stream ${i} detected buffering proxy`):C.stat===Tv.NOPROXY&&et(Xr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{T.wo()},0),T}}function Zg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vp(t){return new yP(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&et("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(e,n,r,i,s,o,l,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new EE(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===je.RESOURCE_EXHAUSTED?(co(n.toString()),co("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===je.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new We(je.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return et("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(et("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class cR extends AE{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=wP(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ct.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ct.min():o.readTime?ba(o.readTime):Ct.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Mv(this.serializer),n.addTarget=function(s,o){let l;const c=o.target;if(l=Pv(c)?{documents:EP(s,c)}:{query:AP(s,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=pE(s,o.resumeToken);const u=Lv(s,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(Ct.min())>0){l.readTime=Jm(s,o.snapshotVersion.toTimestamp());const u=Lv(s,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=kP(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Mv(this.serializer),n.removeTarget=e,this.a_(n)}}class uR extends AE{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return mn(!!e.streamToken),this.lastStreamToken=e.streamToken,mn(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){mn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=_P(e.writeResults,e.commitTime),r=ba(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Mv(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>NP(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dR extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new We(je.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,Dv(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===je.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new We(je.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,Dv(n,r),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===je.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new We(je.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class hR{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(co(n),this.D_=!1):et("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fR{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{Nc(this)&&(et("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=It(c);u.L_.add(4),await Mh(u),u.q_.set("Unknown"),u.L_.delete(4),await Bp(u)}(this))})}),this.q_=new hR(r,i)}}async function Bp(t){if(Nc(t))for(const e of t.B_)await e(!0)}async function Mh(t){for(const e of t.B_)await e(!1)}function SE(t,e){const n=It(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),jy(n)?Ty(n):Fu(n).r_()&&ky(n,e))}function Sy(t,e){const n=It(t),r=Fu(n);n.N_.delete(e),r.r_()&&kE(n,e),n.N_.size===0&&(r.r_()?r.o_():Nc(n)&&n.q_.set("Unknown"))}function ky(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ct.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Fu(t).A_(e)}function kE(t,e){t.Q_.xe(e),Fu(t).R_(e)}function Ty(t){t.Q_=new mP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Fu(t).start(),t.q_.v_()}function jy(t){return Nc(t)&&!Fu(t).n_()&&t.N_.size>0}function Nc(t){return It(t).L_.size===0}function TE(t){t.Q_=void 0}async function mR(t){t.q_.set("Online")}async function pR(t){t.N_.forEach((e,n)=>{ky(t,e)})}async function gR(t,e){TE(t),jy(t)?(t.q_.M_(e),Ty(t)):t.q_.set("Unknown")}async function vR(t,e,n){if(t.q_.set("Online"),e instanceof mE&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.N_.delete(l),i.Q_.removeTarget(l))}(t,e)}catch(r){et("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Zm(t,r)}else if(e instanceof sm?t.Q_.Ke(e):e instanceof fE?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Ct.min()))try{const r=await _E(t.localStore);n.compareTo(r)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const f=s.N_.get(u);f&&s.N_.set(u,f.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const f=s.N_.get(c);if(!f)return;s.N_.set(c,f.withResumeToken(zr.EMPTY_BYTE_STRING,f.snapshotVersion)),kE(s,c);const v=new Xo(f.target,c,u,f.sequenceNumber);ky(s,v)}),s.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){et("RemoteStore","Failed to raise snapshot:",r),await Zm(t,r)}}async function Zm(t,e,n){if(!Lh(e))throw e;t.L_.add(1),await Mh(t),t.q_.set("Offline"),n||(n=()=>_E(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{et("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Bp(t)})}function jE(t,e){return e().catch(n=>Zm(t,n,e))}async function $p(t){const e=It(t),n=gl(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;yR(e);)try{const i=await tR(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,xR(e,i)}catch(i){await Zm(e,i)}CE(e)&&IE(e)}function yR(t){return Nc(t)&&t.O_.length<10}function xR(t,e){t.O_.push(e);const n=gl(t);n.r_()&&n.V_&&n.m_(e.mutations)}function CE(t){return Nc(t)&&!gl(t).n_()&&t.O_.length>0}function IE(t){gl(t).start()}async function bR(t){gl(t).p_()}async function wR(t){const e=gl(t);for(const n of t.O_)e.m_(n.mutations)}async function NR(t,e,n){const r=t.O_.shift(),i=by.from(r,e,n);await jE(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await $p(t)}async function _R(t,e){e&&gl(t).V_&&await async function(r,i){if(function(o){return dP(o)&&o!==je.ABORTED}(i.code)){const s=r.O_.shift();gl(r).s_(),await jE(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await $p(r)}}(t,e),CE(t)&&IE(t)}async function Yb(t,e){const n=It(t);n.asyncQueue.verifyOperationInProgress(),et("RemoteStore","RemoteStore received new credentials");const r=Nc(n);n.L_.add(3),await Mh(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Bp(n)}async function ER(t,e){const n=It(t);e?(n.L_.delete(2),await Bp(n)):e||(n.L_.add(2),await Mh(n),n.q_.set("Unknown"))}function Fu(t){return t.K_||(t.K_=function(n,r,i){const s=It(n);return s.w_(),new cR(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:mR.bind(null,t),Ro:pR.bind(null,t),mo:gR.bind(null,t),d_:vR.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),jy(t)?Ty(t):t.q_.set("Unknown")):(await t.K_.stop(),TE(t))})),t.K_}function gl(t){return t.U_||(t.U_=function(n,r,i){const s=It(n);return s.w_(),new uR(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:bR.bind(null,t),mo:_R.bind(null,t),f_:wR.bind(null,t),g_:NR.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await $p(t)):(await t.U_.stop(),t.O_.length>0&&(et("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new to,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,l=new Cy(e,n,o,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new We(je.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Iy(t,e){if(co("AsyncQueue",`${e}: ${t}`),Lh(t))return new We(je.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ft.comparator(n.key,r.key):(n,r)=>ft.comparator(n.key,r.key),this.keyedMap=kd(),this.sortedSet=new Hn(this.comparator)}static emptySet(e){return new cu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof cu)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new cu;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(){this.W_=new Hn(ft.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):kt():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Tu{constructor(e,n,r,i,s,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Tu(e,n,cu.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Dp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class SR{constructor(){this.queries=Xb(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=It(n),s=i.queries;i.queries=Xb(),s.forEach((o,l)=>{for(const c of l.j_)c.onError(r)})})(this,new We(je.ABORTED,"Firestore shutting down"))}}function Xb(){return new Mu(t=>eE(t),Dp)}async function Py(t,e){const n=It(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new AR,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const l=Iy(o,`Initialization of query '${Dc(e.query)}' failed`);return void e.onError(l)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&Ly(n)}async function Ry(t,e){const n=It(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function kR(t,e){const n=It(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const l of o.j_)l.X_(i)&&(r=!0);o.z_=i}}r&&Ly(n)}function TR(t,e,n){const r=It(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function Ly(t){t.Y_.forEach(e=>{e.next()})}var Uv,Jb;(Jb=Uv||(Uv={})).ea="default",Jb.Cache="cache";class Dy{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Tu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Tu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Uv.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e){this.key=e}}class RE{constructor(e){this.key=e}}class jR{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=$t(),this.mutatedKeys=$t(),this.Aa=tE(e),this.Ra=new cu(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Qb,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,v)=>{const g=i.get(f),p=Op(this.query,v)?v:null,T=!!g&&this.mutatedKeys.has(g.key),k=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let C=!1;g&&p?g.data.isEqual(p.data)?T!==k&&(r.track({type:3,doc:p}),C=!0):this.ga(g,p)||(r.track({type:2,doc:p}),C=!0,(c&&this.Aa(p,c)>0||u&&this.Aa(p,u)<0)&&(l=!0)):!g&&p?(r.track({type:0,doc:p}),C=!0):g&&!p&&(r.track({type:1,doc:g}),C=!0,(c||u)&&(l=!0)),C&&(p?(o=o.add(p),s=k?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{Ra:o,fa:r,ns:l,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((f,v)=>function(p,T){const k=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kt()}};return k(p)-k(T)}(f.type,v.type)||this.Aa(f.doc,v.doc)),this.pa(r),i=i!=null&&i;const l=n&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new Tu(this.query,e.Ra,s,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Qb,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=$t(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new RE(r))}),this.da.forEach(r=>{e.has(r)||n.push(new PE(r))}),n}ba(e){this.Ta=e.Ts,this.da=$t();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Tu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class CR{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class IR{constructor(e){this.key=e,this.va=!1}}class PR{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Mu(l=>eE(l),Dp),this.Ma=new Map,this.xa=new Set,this.Oa=new Hn(ft.comparator),this.Na=new Map,this.La=new _y,this.Ba={},this.ka=new Map,this.qa=ku.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function RR(t,e,n=!0){const r=UE(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await LE(r,e,n,!0),i}async function LR(t,e){const n=UE(t);await LE(n,e,!0,!1)}async function LE(t,e,n,r){const i=await nR(t.localStore,xa(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let l;return r&&(l=await DR(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&SE(t.remoteStore,i),l}async function DR(t,e,n,r,i){t.Ka=(v,g,p)=>async function(k,C,b,P){let R=C.view.ma(b);R.ns&&(R=await Wb(k.localStore,C.query,!1).then(({documents:U})=>C.view.ma(U,R)));const D=P&&P.targetChanges.get(C.targetId),Z=P&&P.targetMismatches.get(C.targetId)!=null,le=C.view.applyChanges(R,k.isPrimaryClient,D,Z);return ew(k,C.targetId,le.wa),le.snapshot}(t,v,g,p);const s=await Wb(t.localStore,e,!0),o=new jR(e,s.Ts),l=o.ma(s.documents),c=Oh.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(l,t.isPrimaryClient,c);ew(t,n,u.wa);const f=new CR(e,n,o);return t.Fa.set(e,f),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),u.snapshot}async function OR(t,e,n){const r=It(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Dp(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Fv(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Sy(r.remoteStore,i.targetId),Vv(r,i.targetId)}).catch(Rh)):(Vv(r,i.targetId),await Fv(r.localStore,i.targetId,!0))}async function MR(t,e){const n=It(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Sy(n.remoteStore,r.targetId))}async function FR(t,e,n){const r=HR(t);try{const i=await function(o,l){const c=It(o),u=ht.now(),f=l.reduce((p,T)=>p.add(T.key),$t());let v,g;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let T=uo(),k=$t();return c.cs.getEntries(p,f).next(C=>{T=C,T.forEach((b,P)=>{P.isValidDocument()||(k=k.add(b))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,T)).next(C=>{v=C;const b=[];for(const P of l){const R=aP(P,v.get(P.key).overlayedDocument);R!=null&&b.push(new El(P.key,R,W4(R.value.mapValue),gs.exists(!0)))}return c.mutationQueue.addMutationBatch(p,u,b,l)}).next(C=>{g=C;const b=C.applyToLocalDocumentSet(v,k);return c.documentOverlayCache.saveOverlays(p,C.batchId,b)})}).then(()=>({batchId:g.batchId,changes:rE(v)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new Hn(tn)),u=u.insert(l,c),o.Ba[o.currentUser.toKey()]=u}(r,i.batchId,n),await Fh(r,i.changes),await $p(r.remoteStore)}catch(i){const s=Iy(i,"Failed to persist write");n.reject(s)}}async function DE(t,e){const n=It(t);try{const r=await ZP(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&(mn(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?mn(o.va):i.removedDocuments.size>0&&(mn(o.va),o.va=!1))}),await Fh(n,r,e)}catch(r){await Rh(r)}}function Zb(t,e,n){const r=It(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const c=It(o);c.onlineState=l;let u=!1;c.queries.forEach((f,v)=>{for(const g of v.j_)g.Z_(l)&&(u=!0)}),u&&Ly(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function UR(t,e,n){const r=It(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new Hn(ft.comparator);o=o.insert(s,ii.newNoDocument(s,Ct.min()));const l=$t().add(s),c=new Up(Ct.min(),new Map,new Hn(tn),o,l);await DE(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),Oy(r)}else await Fv(r.localStore,e,!1).then(()=>Vv(r,e,n)).catch(Rh)}async function VR(t,e){const n=It(t),r=e.batch.batchId;try{const i=await JP(n.localStore,e);ME(n,r,null),OE(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Fh(n,i)}catch(i){await Rh(i)}}async function BR(t,e,n){const r=It(t);try{const i=await function(o,l){const c=It(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return c.mutationQueue.lookupMutationBatch(u,l).next(v=>(mn(v!==null),f=v.keys(),c.mutationQueue.removeMutationBatch(u,v))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,f,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>c.localDocuments.getDocuments(u,f))})}(r.localStore,e);ME(r,e,n),OE(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Fh(r,i)}catch(i){await Rh(i)}}function OE(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function ME(t,e,n){const r=It(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Vv(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||FE(t,r)})}function FE(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Sy(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Oy(t))}function ew(t,e,n){for(const r of n)r instanceof PE?(t.La.addReference(r.key,e),$R(t,r)):r instanceof RE?(et("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||FE(t,r.key)):kt()}function $R(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(et("SyncEngine","New document in limbo: "+n),t.xa.add(r),Oy(t))}function Oy(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ft(Cn.fromString(e)),r=t.qa.next();t.Na.set(r,new IR(n)),t.Oa=t.Oa.insert(n,r),SE(t.remoteStore,new Xo(xa(Lp(n.path)),r,"TargetPurposeLimboResolution",hy.oe))}}async function Fh(t,e,n){const r=It(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{o.push(r.Ka(c,e,n).then(u=>{var f;if((u||n)&&r.isPrimaryClient){const v=u?!u.fromCache:(f=n==null?void 0:n.targetChanges.get(c.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(c.targetId,v?"current":"not-current")}if(u){i.push(u);const v=Ay.Wi(c.targetId,u);s.push(v)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(c,u){const f=It(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>Oe.forEach(u,g=>Oe.forEach(g.$i,p=>f.persistence.referenceDelegate.addReference(v,g.targetId,p)).next(()=>Oe.forEach(g.Ui,p=>f.persistence.referenceDelegate.removeReference(v,g.targetId,p)))))}catch(v){if(!Lh(v))throw v;et("LocalStore","Failed to update sequence numbers: "+v)}for(const v of u){const g=v.targetId;if(!v.fromCache){const p=f.os.get(g),T=p.snapshotVersion,k=p.withLastLimboFreeSnapshotVersion(T);f.os=f.os.insert(g,k)}}}(r.localStore,s))}async function zR(t,e){const n=It(t);if(!n.currentUser.isEqual(e)){et("SyncEngine","User change. New user:",e.toKey());const r=await NE(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(c=>{c.reject(new We(je.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Fh(n,r.hs)}}function qR(t,e){const n=It(t),r=n.Na.get(e);if(r&&r.va)return $t().add(r.key);{let i=$t();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const l=n.Fa.get(o);i=i.unionWith(l.view.Va)}return i}}function UE(t){const e=It(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=DE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=UR.bind(null,e),e.Ca.d_=kR.bind(null,e.eventManager),e.Ca.$a=TR.bind(null,e.eventManager),e}function HR(t){const e=It(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=VR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=BR.bind(null,e),e}class ep{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Vp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return XP(this.persistence,new YP,e.initialUser,this.serializer)}Ga(e){return new WP(Ey.Zr,this.serializer)}Wa(e){return new iR}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ep.provider={build:()=>new ep};class Bv{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Zb(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=zR.bind(null,this.syncEngine),await ER(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new SR}()}createDatastore(e){const n=Vp(e.databaseInfo.databaseId),r=function(s){return new lR(s)}(e.databaseInfo);return function(s,o,l,c){return new dR(s,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,l){return new fR(r,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Zb(this.syncEngine,n,0),function(){return Kb.D()?new Kb:new sR}())}createSyncEngine(e,n){return function(i,s,o,l,c,u,f){const v=new PR(i,s,o,l,c,u);return f&&(v.Qa=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=It(i);et("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Mh(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Bv.provider={build:()=>new Bv};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class My{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):co("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=ni.UNAUTHENTICATED,this.clientId=z4.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{et("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(et("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new to;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Iy(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function e0(t,e){t.asyncQueue.verifyOperationInProgress(),et("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await NE(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function tw(t,e){t.asyncQueue.verifyOperationInProgress();const n=await GR(t);et("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Yb(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Yb(e.remoteStore,i)),t._onlineComponents=e}async function GR(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){et("FirestoreClient","Using user provided OfflineComponentProvider");try{await e0(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===je.FAILED_PRECONDITION||i.code===je.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;_u("Error using user provided cache. Falling back to memory cache: "+n),await e0(t,new ep)}}else et("FirestoreClient","Using default OfflineComponentProvider"),await e0(t,new ep);return t._offlineComponents}async function VE(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(et("FirestoreClient","Using user provided OnlineComponentProvider"),await tw(t,t._uninitializedComponentsProvider._online)):(et("FirestoreClient","Using default OnlineComponentProvider"),await tw(t,new Bv))),t._onlineComponents}function KR(t){return VE(t).then(e=>e.syncEngine)}async function tp(t){const e=await VE(t),n=e.eventManager;return n.onListen=RR.bind(null,e.syncEngine),n.onUnlisten=OR.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=LR.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=MR.bind(null,e.syncEngine),n}function YR(t,e,n={}){const r=new to;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,u){const f=new My({next:g=>{f.Za(),o.enqueueAndForget(()=>Ry(s,v));const p=g.docs.has(l);!p&&g.fromCache?u.reject(new We(je.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&g.fromCache&&c&&c.source==="server"?u.reject(new We(je.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),v=new Dy(Lp(l.path),f,{includeMetadataChanges:!0,_a:!0});return Py(s,v)}(await tp(t),t.asyncQueue,e,n,r)),r.promise}function QR(t,e,n={}){const r=new to;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,u){const f=new My({next:g=>{f.Za(),o.enqueueAndForget(()=>Ry(s,v)),g.fromCache&&c.source==="server"?u.reject(new We(je.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),v=new Dy(l,f,{includeMetadataChanges:!0,_a:!0});return Py(s,v)}(await tp(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BE(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nw=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $E(t,e,n){if(!n)throw new We(je.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function XR(t,e,n,r){if(e===!0&&r===!0)throw new We(je.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function rw(t){if(!ft.isDocumentKey(t))throw new We(je.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function iw(t){if(ft.isDocumentKey(t))throw new We(je.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function zp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":kt()}function Ci(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new We(je.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=zp(t);throw new We(je.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new We(je.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new We(je.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}XR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=BE((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new We(je.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new We(je.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new We(je.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class qp{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sw({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new We(je.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new We(je.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sw(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new p6;switch(r.type){case"firstParty":return new x6(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new We(je.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=nw.get(n);r&&(et("ComponentProvider","Removing Datastore"),nw.delete(n),r.terminate())}(this),Promise.resolve()}}function JR(t,e,n,r={}){var i;const s=(t=Ci(t,qp))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&_u("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=ni.MOCK_USER;else{l=Q_(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new We(je.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new ni(u)}t._authCredentials=new g6(new $4(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new mo(this.firestore,e,this._query)}}class si{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new cl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new si(this.firestore,e,this._key)}}class cl extends mo{constructor(e,n,r){super(e,n,Lp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new si(this.firestore,null,new ft(e))}withConverter(e){return new cl(this.firestore,e,this._path)}}function Ut(t,e,...n){if(t=bn(t),$E("collection","path",e),t instanceof qp){const r=Cn.fromString(e,...n);return iw(r),new cl(t,null,r)}{if(!(t instanceof si||t instanceof cl))throw new We(je.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Cn.fromString(e,...n));return iw(r),new cl(t.firestore,null,r)}}function dt(t,e,...n){if(t=bn(t),arguments.length===1&&(e=z4.newId()),$E("doc","path",e),t instanceof qp){const r=Cn.fromString(e,...n);return rw(r),new si(t,null,new ft(r))}{if(!(t instanceof si||t instanceof cl))throw new We(je.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Cn.fromString(e,...n));return rw(r),new si(t.firestore,t instanceof cl?t.converter:null,new ft(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new EE(this,"async_queue_retry"),this.Vu=()=>{const r=Zg();r&&et("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Zg();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Zg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new to;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Lh(e))throw e;et("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw co("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=Cy.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&kt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function ow(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class ho extends qp{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new aw,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new aw(e),this._firestoreClient=void 0,await e}}}function ZR(t,e){const n=typeof t=="object"?t:jp(),r=typeof t=="string"?t:"(default)",i=Th(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=Y1("firestore");s&&JR(i,...s)}return i}function Hp(t){if(t._terminated)throw new We(je.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||eL(t),t._firestoreClient}function eL(t){var e,n,r;const i=t._freezeSettings(),s=function(l,c,u,f){return new P6(l,c,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,BE(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new WR(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ju(zr.fromBase64String(e))}catch(n){throw new We(je.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ju(zr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new We(je.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ur(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new We(je.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new We(je.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return tn(this._lat,e._lat)||tn(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tL=/^__.*__$/;class nL{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new El(e,this.data,this.fieldMask,n,this.fieldTransforms):new Dh(e,this.data,n,this.fieldTransforms)}}class zE{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new El(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function qE(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw kt()}}class By{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new By(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return np(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(qE(this.Cu)&&tL.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class rL{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Vp(e)}Qu(e,n,r,i=!1){return new By({Cu:e,methodName:n,qu:r,path:Ur.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Gp(t){const e=t._freezeSettings(),n=Vp(t._databaseId);return new rL(t._databaseId,!!e.ignoreUndefinedProperties,n)}function HE(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);$y("Data must be an object, but it was:",o,r);const l=WE(r,o);let c,u;if(s.merge)c=new Yi(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const v of s.mergeFields){const g=$v(e,v,n);if(!o.contains(g))throw new We(je.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);KE(f,g)||f.push(g)}c=new Yi(f),u=o.fieldTransforms.filter(v=>c.covers(v.field))}else c=null,u=o.fieldTransforms;return new nL(new Ai(l),c,u)}class Kp extends Fy{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Kp}}function iL(t,e,n,r){const i=t.Qu(1,e,n);$y("Data must be an object, but it was:",i,r);const s=[],o=Ai.empty();wc(r,(c,u)=>{const f=zy(e,c,n);u=bn(u);const v=i.Nu(f);if(u instanceof Kp)s.push(f);else{const g=Uh(u,v);g!=null&&(s.push(f),o.set(f,g))}});const l=new Yi(s);return new zE(o,l,i.fieldTransforms)}function sL(t,e,n,r,i,s){const o=t.Qu(1,e,n),l=[$v(e,r,n)],c=[i];if(s.length%2!=0)throw new We(je.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)l.push($v(e,s[g])),c.push(s[g+1]);const u=[],f=Ai.empty();for(let g=l.length-1;g>=0;--g)if(!KE(u,l[g])){const p=l[g];let T=c[g];T=bn(T);const k=o.Nu(p);if(T instanceof Kp)u.push(p);else{const C=Uh(T,k);C!=null&&(u.push(p),f.set(p,C))}}const v=new Yi(u);return new zE(f,v,o.fieldTransforms)}function aL(t,e,n,r=!1){return Uh(n,t.Qu(r?4:3,e))}function Uh(t,e){if(GE(t=bn(t)))return $y("Unsupported field value:",e,t),WE(t,e);if(t instanceof Fy)return function(r,i){if(!qE(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const l of r){let c=Uh(l,i.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=bn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return eP(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=ht.fromDate(r);return{timestampValue:Jm(i.serializer,s)}}if(r instanceof ht){const s=new ht(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Jm(i.serializer,s)}}if(r instanceof Uy)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ju)return{bytesValue:pE(i.serializer,r._byteString)};if(r instanceof si){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ny(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Vy)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return yy(l.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${zp(r)}`)}(t,e)}function WE(t,e){const n={};return q4(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wc(t,(r,i)=>{const s=Uh(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function GE(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ht||t instanceof Uy||t instanceof ju||t instanceof si||t instanceof Fy||t instanceof Vy)}function $y(t,e,n){if(!GE(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=zp(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function $v(t,e,n){if((e=bn(e))instanceof Wp)return e._internalPath;if(typeof e=="string")return zy(t,e);throw np("Field path arguments must be of type string or ",t,!1,void 0,n)}const oL=new RegExp("[~\\*/\\[\\]]");function zy(t,e,n){if(e.search(oL)>=0)throw np(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Wp(...e.split("."))._internalPath}catch{throw np(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function np(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new We(je.INVALID_ARGUMENT,l+t+c)}function KE(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new si(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new lL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Yp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class lL extends YE{data(){return super.data()}}function Yp(t,e){return typeof e=="string"?zy(t,e):e instanceof Wp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QE(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new We(je.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class qy{}class Hy extends qy{}function An(t,e,...n){let r=[];e instanceof qy&&r.push(e),r=r.concat(n),function(s){const o=s.filter(c=>c instanceof Wy).length,l=s.filter(c=>c instanceof Qp).length;if(o>1||o>0&&l>0)throw new We(je.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Qp extends Hy{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Qp(e,n,r)}_apply(e){const n=this._parse(e);return XE(e._query,n),new mo(e.firestore,e.converter,Rv(e._query,n))}_parse(e){const n=Gp(e.firestore);return function(s,o,l,c,u,f,v){let g;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new We(je.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){cw(v,f);const p=[];for(const T of v)p.push(lw(c,s,T));g={arrayValue:{values:p}}}else g=lw(c,s,v)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||cw(v,f),g=aL(l,o,v,f==="in"||f==="not-in");return pr.create(u,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function ur(t,e,n){const r=e,i=Yp("where",t);return Qp._create(i,r,n)}class Wy extends qy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Wy(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Bs.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const l=s.getFlattenedFilters();for(const c of l)XE(o,c),o=Rv(o,c)}(e._query,n),new mo(e.firestore,e.converter,Rv(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Gy extends Hy{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Gy(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new We(je.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new We(je.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ph(s,o)}(e._query,this._field,this._direction);return new mo(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Ou(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function Uu(t,e="asc"){const n=e,r=Yp("orderBy",t);return Gy._create(r,n)}class Ky extends Hy{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Ky(e,n,r)}_apply(e){return new mo(e.firestore,e.converter,Ym(e._query,this._limit,this._limitType))}}function cL(t){return Ky._create("limit",t,"F")}function lw(t,e,n){if(typeof(n=bn(n))=="string"){if(n==="")throw new We(je.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Z4(e)&&n.indexOf("/")!==-1)throw new We(je.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Cn.fromString(n));if(!ft.isDocumentKey(r))throw new We(je.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return jb(t,new ft(r))}if(n instanceof si)return jb(t,n._key);throw new We(je.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zp(n)}.`)}function cw(t,e){if(!Array.isArray(t)||t.length===0)throw new We(je.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function XE(t,e){const n=function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new We(je.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new We(je.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class uL{convertValue(e,n="none"){switch(pc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ir(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(mc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw kt()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return wc(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>ir(o.doubleValue));return new Vy(s)}convertGeoPoint(e){return new Uy(ir(e.latitude),ir(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=my(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(hh(e));default:return null}}convertTimestamp(e){const n=pl(e);return new ht(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Cn.fromString(e);mn(wE(r));const i=new fh(r.get(1),r.get(3)),s=new ft(r.popFirst(5));return i.isEqual(n)||co(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JE(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ZE extends YE{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new am(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Yp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class am extends ZE{data(e={}){return super.data(e)}}class eA{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new jd(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new am(this._firestore,this._userDataWriter,r.key,r,new jd(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new We(je.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const c=new am(i._firestore,i._userDataWriter,l.doc.key,l.doc,new jd(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const c=new am(i._firestore,i._userDataWriter,l.doc.key,l.doc,new jd(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:dL(l.type),doc:c,oldIndex:u,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function dL(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vs(t){t=Ci(t,si);const e=Ci(t.firestore,ho);return YR(Hp(e),t._key).then(n=>tA(e,t,n))}class Yy extends uL{constructor(e){super(),this.firestore=e}convertBytes(e){return new ju(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new si(this.firestore,null,n)}}function Na(t){t=Ci(t,mo);const e=Ci(t.firestore,ho),n=Hp(e),r=new Yy(e);return QE(t._query),QR(n,t._query).then(i=>new eA(e,r,t,i))}function ws(t,e,n){t=Ci(t,si);const r=Ci(t.firestore,ho),i=JE(t.converter,e,n);return Xp(r,[HE(Gp(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,gs.none())])}function gr(t,e,n,...r){t=Ci(t,si);const i=Ci(t.firestore,ho),s=Gp(i);let o;return o=typeof(e=bn(e))=="string"||e instanceof Wp?sL(s,"updateDoc",t._key,e,n,r):iL(s,"updateDoc",t._key,e),Xp(i,[o.toMutation(t._key,gs.exists(!0))])}function vl(t){return Xp(Ci(t.firestore,ho),[new xy(t._key,gs.none())])}function Sa(t,e){const n=Ci(t.firestore,ho),r=dt(t),i=JE(t.converter,e);return Xp(n,[HE(Gp(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,gs.exists(!1))]).then(()=>r)}function Gt(t,...e){var n,r,i;t=bn(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||ow(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(ow(e[o])){const v=e[o];e[o]=(n=v.next)===null||n===void 0?void 0:n.bind(v),e[o+1]=(r=v.error)===null||r===void 0?void 0:r.bind(v),e[o+2]=(i=v.complete)===null||i===void 0?void 0:i.bind(v)}let c,u,f;if(t instanceof si)u=Ci(t.firestore,ho),f=Lp(t._key.path),c={next:v=>{e[o]&&e[o](tA(u,t,v))},error:e[o+1],complete:e[o+2]};else{const v=Ci(t,mo);u=Ci(v.firestore,ho),f=v._query;const g=new Yy(u);c={next:p=>{e[o]&&e[o](new eA(u,g,v,p))},error:e[o+1],complete:e[o+2]},QE(t._query)}return function(g,p,T,k){const C=new My(k),b=new Dy(p,C,T);return g.asyncQueue.enqueueAndForget(async()=>Py(await tp(g),b)),()=>{C.Za(),g.asyncQueue.enqueueAndForget(async()=>Ry(await tp(g),b))}}(Hp(u),f,l,c)}function Xp(t,e){return function(r,i){const s=new to;return r.asyncQueue.enqueueAndForget(async()=>FR(await KR(r),i,s)),s.promise}(Hp(t),e)}function tA(t,e,n){const r=n.docs.get(e._key),i=new Yy(t);return new ZE(t,i,e._key,r,new jd(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(i){Du=i})(bc),fl(new ao("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new ho(new v6(r.getProvider("auth-internal")),new w6(r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new We(je.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new fh(u.options.projectId,f)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),ps(Eb,"4.7.3",e),ps(Eb,"4.7.3","esm2017")})();var hL="firebase",fL="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ps(hL,fL,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nA="firebasestorage.googleapis.com",mL="storageBucket",pL=2*60*1e3,gL=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka extends Ea{constructor(e,n,r=0){super(t0(e),`Firebase Storage: ${n} (${t0(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ka.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return t0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var _a;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(_a||(_a={}));function t0(t){return"storage/"+t}function vL(){const t="An unknown error occurred, please check the error payload for server response.";return new ka(_a.UNKNOWN,t)}function yL(){return new ka(_a.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function xL(){return new ka(_a.CANCELED,"User canceled the upload/download.")}function bL(t){return new ka(_a.INVALID_URL,"Invalid URL '"+t+"'.")}function wL(t){return new ka(_a.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function uw(t){return new ka(_a.INVALID_ARGUMENT,t)}function rA(){return new ka(_a.APP_DELETED,"The Firebase app was deleted.")}function NL(t){return new ka(_a.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Ms.makeFromUrl(e,n)}catch{return new Ms(e,"")}if(r.path==="")return r;throw wL(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function u(D){D.path_=decodeURIComponent(D.path)}const f="v[A-Za-z0-9_]+",v=n.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",p=new RegExp(`^https?://${v}/${f}/b/${i}/o${g}`,"i"),T={bucket:1,path:3},k=n===nA?"(?:storage.googleapis.com|storage.cloud.google.com)":n,C="([^?#]*)",b=new RegExp(`^https?://${k}/${i}/${C}`,"i"),R=[{regex:l,indices:c,postModify:s},{regex:p,indices:T,postModify:u},{regex:b,indices:{bucket:1,path:2},postModify:u}];for(let D=0;D<R.length;D++){const Z=R[D],le=Z.regex.exec(e);if(le){const U=le[Z.indices.bucket];let j=le[Z.indices.path];j||(j=""),r=new Ms(U,j),Z.postModify(r);break}}if(r==null)throw bL(e);return r}}class _L{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EL(t,e,n){let r=1,i=null,s=null,o=!1,l=0;function c(){return l===2}let u=!1;function f(...C){u||(u=!0,e.apply(null,C))}function v(C){i=setTimeout(()=>{i=null,t(p,c())},C)}function g(){s&&clearTimeout(s)}function p(C,...b){if(u){g();return}if(C){g(),f.call(null,C,...b);return}if(c()||o){g(),f.call(null,C,...b);return}r<64&&(r*=2);let R;l===1?(l=2,R=0):R=(r+Math.random())*1e3,v(R)}let T=!1;function k(C){T||(T=!0,g(),!u&&(i!==null?(C||(l=2),clearTimeout(i),v(0)):C||(l=1)))}return v(0),s=setTimeout(()=>{o=!0,k(!0)},n),k}function AL(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SL(t){return t!==void 0}function dw(t,e,n,r){if(r<e)throw uw(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw uw(`Invalid value for '${t}'. Expected ${n} or less.`)}function kL(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var rp;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(rp||(rp={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TL(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jL{constructor(e,n,r,i,s,o,l,c,u,f,v,g=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=f,this.connectionFactory_=v,this.retry=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,T)=>{this.resolve_=p,this.reject_=T,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Cf(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===rp.NO_ERROR,c=s.getStatus();if(!l||TL(c,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===rp.ABORT;r(!1,new Cf(!1,null,f));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new Cf(u,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,l=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());SL(c)?s(c):s()}catch(c){o(c)}else if(l!==null){const c=vL();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(i.canceled){const c=this.appDelete_?rA():xL();o(c)}else{const c=yL();o(c)}};this.canceled_?n(!1,new Cf(!1,null,!0)):this.backoffId_=EL(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&AL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Cf{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function CL(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function IL(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function PL(t,e){e&&(t["X-Firebase-GMPID"]=e)}function RL(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function LL(t,e,n,r,i,s,o=!0){const l=kL(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return PL(u,e),CL(u,n),IL(u,s),RL(u,r),new jL(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DL(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function OL(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(e,n){this._service=e,n instanceof Ms?this._location=n:this._location=Ms.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ip(e,n)}get root(){const e=new Ms(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return OL(this._location.path)}get storage(){return this._service}get parent(){const e=DL(this._location.path);if(e===null)return null;const n=new Ms(this._location.bucket,e);return new ip(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw NL(e)}}function hw(t,e){const n=e==null?void 0:e[mL];return n==null?null:Ms.makeFromBucketSpec(n,t)}function ML(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:Q_(i,t.app.options.projectId))}class FL{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=nA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=pL,this._maxUploadRetryTime=gL,this._requests=new Set,i!=null?this._bucket=Ms.makeFromBucketSpec(i,this._host):this._bucket=hw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ms.makeFromBucketSpec(this._url,e):this._bucket=hw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){dw("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){dw("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ip(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new _L(rA());{const o=LL(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const fw="@firebase/storage",mw="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA="storage";function UL(t=jp(),e){t=bn(t);const r=Th(t,iA).getImmediate({identifier:e}),i=Y1("storage");return i&&VL(r,...i),r}function VL(t,e,n,r={}){ML(t,e,n,r)}function BL(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new FL(n,r,i,e,bc)}function $L(){fl(new ao(iA,BL,"PUBLIC").setMultipleInstances(!0)),ps(fw,mw,""),ps(fw,mw,"esm2017")}$L();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sA="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zL{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||n.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zv="us-central1";class qL{constructor(e,n,r,i,s=zv,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new zL(n,r,i),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(s);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=zv}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function HL(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const pw="@firebase/functions",gw="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WL="auth-internal",GL="app-check-internal",KL="messaging-internal";function YL(t,e){const n=(r,{instanceIdentifier:i})=>{const s=r.getProvider("app").getImmediate(),o=r.getProvider(WL),l=r.getProvider(KL),c=r.getProvider(GL);return new qL(s,o,l,c,i,t)};fl(new ao(sA,n,"PUBLIC").setMultipleInstances(!0)),ps(pw,gw,e),ps(pw,gw,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QL(t=jp(),e=zv){const r=Th(bn(t),sA).getImmediate({identifier:e}),i=Y1("functions");return i&&XL(r,...i),r}function XL(t,e,n){HL(bn(t),e,n)}YL(fetch.bind(self));const JL={apiKey:"AIzaSyB1ddVOczgt5n2NkoIq3H_5x_eB0Aqw2HI",authDomain:"alojamientos-3c46b.firebaseapp.com",projectId:"alojamientos-3c46b",storageBucket:"alojamientos-3c46b.appspot.com",messagingSenderId:"858434059981",appId:"1:858434059981:web:f235cea133b874f985b384"},Fe="alojamientos-3c46b",Jp=Z_(JL),Nr=f6(Jp),Be=ZR(Jp);UL(Jp);QL(Jp);const ZL=async()=>{console.log(" DIAGNSTICO COMPLETO DE FIREBASE"),console.log("=====================================");try{console.log(" App ID:",Fe),console.log(`
 Verificando estructura de base de datos...`);const t=Ut(Be,"artifacts",Fe,"public","data","users");console.log(" Ruta de usuarios:",`artifacts/${Fe}/public/data/users`);try{const e=await Na(t);if(console.log(" Total de usuarios encontrados:",e.size),e.empty)return console.log(" No hay usuarios en la coleccin"),{hasUsers:!1,users:[]};const n=[];e.docs.forEach((s,o)=>{const l=s.data(),c={id:s.id,email:l.email||"Sin email",role:l.role||"Sin rol",status:l.status||"Sin estado",createdAt:l.createdAt||"Sin fecha",fullName:l.fullName||"Sin nombre"};n.push(c),console.log(` Usuario ${o+1}:`,c)}),console.log(`
 Verificando configuracin de empresa...`);const r=dt(Be,"artifacts",Fe,"public","data","settings","company_info"),i=await vs(r);i.exists()?(console.log(" Configuracin de empresa encontrada"),console.log(" Configuracin:",i.data())):console.log(" No hay configuracin de empresa"),console.log(`
 Verificando permisos...`);try{const s=An(t,cL(1));await Na(s),console.log(" Permisos de lectura OK")}catch(s){console.error(" Error de permisos:",s)}return{hasUsers:!0,users:n,hasSettings:i.exists(),settings:i.exists()?i.data():null}}catch(e){return console.error(" Error accediendo a usuarios:",e),{hasUsers:!1,error:e.message}}}catch(t){return console.error(" Error en diagnstico:",t),{hasUsers:!1,error:t.message}}},e8=async()=>{try{console.log(" Verificando usuarios en Authentication...");const t=Nr.currentUser;return t?(console.log(" Usuario autenticado encontrado:",t.email),!0):(console.log(" No hay usuario autenticado, pero asumiendo que hay usuarios en el sistema"),!0)}catch(t){return console.error(" Error verificando Authentication:",t),!1}},aA=ue.createContext();function t8({message:t,type:e,onClose:n}){const r=e==="success"?"bg-green-500":"bg-red-500";return ue.useEffect(()=>{const i=setTimeout(n,4e3);return()=>clearTimeout(i)},[n]),a.jsx("div",{className:`fixed top-5 right-5 ${r} text-white py-2 px-4 rounded-lg shadow-lg animate-fade-in-down`,children:t})}function n8({children:t}){const[e,n]=ue.useState([]),r=(s,o="success")=>{const l=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;n(c=>[...c,{id:l,message:s,type:o}])},i=s=>{n(o=>o.filter(l=>l.id!==s))};return a.jsxs(aA.Provider,{value:{addNotification:r},children:[t,a.jsx("div",{className:"fixed top-5 right-5 z-50 space-y-2",children:e.map(s=>a.jsx(t8,{message:s.message,type:s.type,onClose:()=>i(s.id)},s.id))})]})}const pn=()=>ue.useContext(aA);function r8(t,e=10,n=!0){const r=ue.useRef(null),i=ue.useRef(Date.now()),s=ue.useCallback(()=>{if(!n||!t)return;r.current&&clearTimeout(r.current);const o=e*60*1e3;i.current=Date.now(),r.current=setTimeout(()=>{console.log(` Sesin cerrada por inactividad (${e} minutos)`),t&&t()},o)},[t,e,n]);ue.useEffect(()=>{if(!n||!t)return;const o=["mousedown","mousemove","keypress","scroll","touchstart","click","keydown"],l=()=>{Date.now()-i.current>1e3&&s()};return o.forEach(c=>{window.addEventListener(c,l,{passive:!0})}),s(),()=>{o.forEach(c=>{window.removeEventListener(c,l)}),r.current&&clearTimeout(r.current)}},[s,n,t]),ue.useEffect(()=>{n&&t&&s()},[e,n,s,t])}function i8(){if(typeof window>"u")return;const t=console.error,e=console.warn,n=["Could not establish connection","Receiving end does not exist","Promised response from onMessage listener went out of scope","Extension context invalidated","message handler closed","chrome-extension://","moz-extension://","edge-extension://"];return console.error=function(...r){let i="";try{i=r.map(o=>{if(typeof o=="string")return o;if(o instanceof Error)return o.message+" "+o.stack;try{return JSON.stringify(o)}catch{return String(o)}}).join(" ")}catch{i=String(r)}n.some(o=>i.includes(o))||t.apply(console,r)},console.warn=function(...r){let i="";try{i=r.map(o=>{if(typeof o=="string")return o;if(o instanceof Error)return o.message+" "+o.stack;try{return JSON.stringify(o)}catch{return String(o)}}).join(" ")}catch{i=String(r)}n.some(o=>i.includes(o))||e.apply(console,r)},()=>{console.error=t,console.warn=e}}const n0={nuevoUsuario:{name:"Bienvenida - Nuevo Usuario - Crear Contrasea",subject:"Bienvenido a {companyName} - Crea tu contrasea",body:`Hola {clientName},

Bienvenido a {companyName}!

Tu cuenta ha sido creada exitosamente en {companyName}.

 Tu email de acceso: {clientEmail}

 CREAR TU CONTRASEA - ACCESO AL SISTEMA:

Para completar tu registro y acceder al sistema, necesitas crear tu contrasea personal.

 INSTRUCCIONES PASO A PASO:

1. Haz clic en el siguiente enlace para crear tu contrasea (este enlace es nico y seguro):
   {resetPasswordUrl}

2. En la pgina de restablecimiento, ingresa una contrasea segura (mnimo 6 caracteres)

3. Confirma tu contrasea ingresndola nuevamente

4. Haz clic en "Restablecer Contrasea"

5. Una vez creada tu contrasea, sers redirigido automticamente al inicio de sesin

6. Inicia sesin con:
   - Email: {clientEmail}
   - Contrasea: La que acabas de crear

 IMPORTANTE:
- El enlace para crear tu contrasea expirar en 24 horas
- Si el enlace expira, puedes solicitar uno nuevo desde la pgina de inicio de sesin haciendo clic en "Olvidaste tu contrasea?"
- Tu cuenta est activa y lista para usar una vez que crees tu contrasea

 ENLACE DIRECTO AL SISTEMA:
{loginUrl}

Una vez que inicies sesin, podrs:
 Ver tus servicios contratados
 Crear tickets de soporte
 Gestionar tu perfil y pagos
 Acceder a todas las funcionalidades del sistema

Si tienes alguna pregunta o necesitas ayuda, no dudes en contactarnos.

Bienvenido!

Equipo de Soporte
{companyName}`,category:"client"},notificarActivacion:{name:"Notificacin de Activacin - Crear Contrasea",subject:"Cuenta Activada - {companyName} - Crea tu contrasea",body:`Hola {clientName},

Tu cuenta ha sido activada exitosamente en {companyName}.

 Tu email de acceso: {clientEmail}

 CREAR O CAMBIAR TU CONTRASEA:

Para acceder al sistema, necesitas crear o cambiar tu contrasea.

 INSTRUCCIONES PASO A PASO:

1. Haz clic en el siguiente enlace para crear/cambiar tu contrasea (este enlace es nico y seguro):
   {resetPasswordUrl}

2. En la pgina de restablecimiento, ingresa una contrasea segura (mnimo 6 caracteres)

3. Confirma tu contrasea ingresndola nuevamente

4. Haz clic en "Restablecer Contrasea"

5. Una vez creada tu contrasea, sers redirigido automticamente al inicio de sesin

6. Inicia sesin con:
   - Email: {clientEmail}
   - Contrasea: La que acabas de crear

 IMPORTANTE:
- El enlace para crear/cambiar tu contrasea expirar en 24 horas
- Si el enlace expira, puedes solicitar uno nuevo desde la pgina de inicio de sesin haciendo clic en "Olvidaste tu contrasea?"
- Tu cuenta est activa y lista para usar una vez que crees tu contrasea

 ENLACE DIRECTO AL SISTEMA:
{loginUrl}

Una vez que inicies sesin, podrs:
 Ver tus servicios contratados
 Crear tickets de soporte
 Gestionar tu perfil y pagos
 Acceder a todas las funcionalidades del sistema

Si tienes alguna pregunta o necesitas ayuda, no dudes en contactarnos.

Bienvenido!

Equipo de Soporte
{companyName}`,category:"client"},restablecerContrasena:{name:"Restablecer Contrasea",subject:"Restablecer tu contrasea - {companyName}",body:`Hola,

Has solicitado restablecer tu contrasea en {companyName}.

 INSTRUCCIONES:

1. Haz clic en el siguiente enlace para restablecer tu contrasea (este enlace es nico y seguro):
   {resetPasswordUrl}

2. En la pgina de restablecimiento, ingresa una contrasea segura (mnimo 6 caracteres)

3. Confirma tu contrasea ingresndola nuevamente

4. Haz clic en "Restablecer Contrasea"

5. Una vez restablecida tu contrasea, sers redirigido automticamente al inicio de sesin

 IMPORTANTE:
- El enlace expirar en 24 horas
- Si no solicitaste este restablecimiento, ignora este email
- Si tienes problemas, contacta con soporte

 ENLACE DIRECTO AL SISTEMA:
{loginUrl}

Si tienes alguna pregunta o necesitas ayuda, no dudes en contactarnos.

Equipo de Soporte
{companyName}`,category:"client"}},s8=async t=>{try{const e=Ut(Be,"artifacts",Fe,"public","data","messageTemplates"),n=An(e,ur("name","==",t));return!(await Na(n)).empty}catch(e){return console.error("Error verificando plantilla:",e),!1}},r0=async(t,e)=>{try{if(await s8(e.name))return console.log(` Plantilla "${e.name}" ya existe`),!1;const r=Ut(Be,"artifacts",Fe,"public","data","messageTemplates");return await Sa(r,{...e,createdAt:new Date,updatedAt:new Date}),console.log(` Plantilla "${e.name}" creada exitosamente`),!0}catch(n){return console.error(` Error creando plantilla "${e.name}":`,n),!1}},a8=async()=>{try{console.log(" Inicializando plantillas de restablecimiento de contrasea...");const e=(await Promise.all([r0("nuevoUsuario",n0.nuevoUsuario),r0("notificarActivacion",n0.notificarActivacion),r0("restablecerContrasena",n0.restablecerContrasena)])).filter(n=>n).length;return e>0?console.log(` ${e} plantilla(s) de contrasea creada(s)`):console.log(" Todas las plantillas de contrasea ya existen"),!0}catch(t){return console.error(" Error inicializando plantillas de contrasea:",t),!1}},Qy=async t=>{try{const e=Ut(Be,"artifacts",Fe,"public","data","messageTemplates"),n=An(e,ur("name","==",t)),r=await Na(n);if(!r.empty){const i=r.docs[0];return{id:i.id,...i.data()}}return null}catch(e){return console.error("Error obteniendo plantilla:",e),null}},Vh=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),oA=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),o8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),l8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M15 21a6 6 0 00-9-5.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-3-5.197m0 0A4 4 0 0112 4.354a4 4 0 013 3.249m-3 7.586a4 4 0 01-3-3.25"})}),sp=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),om=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),lA=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h7"})}),Zp=()=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),ic=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),c8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),u8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})}),Vu=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})}),d8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),h8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-5 5v-5zM4.828 7l2.586 2.586a2 2 0 002.828 0L12 7H4.828zM4.828 17h5l-5-5v5zM12 7l2.586 2.586a2 2 0 002.828 0L20 7h-8z"})}),Ji=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),uu=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"})}),cA=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),ap=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),ul=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),uA=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),hs=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),yl=()=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),yh=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),op=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),f8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),m8=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})});function Bh({children:t}){const[e,n]=ue.useState(!1),[r,i]=ue.useState({top:0,left:0,position:"bottom-right"}),s=ue.useRef(null),o=ue.useRef(null);ue.useEffect(()=>{const c=u=>{s.current&&!s.current.contains(u.target)&&n(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[s]),ue.useEffect(()=>{if(e&&o.current){const c=o.current.getBoundingClientRect(),u=window.innerHeight,f=window.innerWidth,v=u-c.bottom,g=c.top,p=f-c.right,T=c.left;let k=c.bottom+8,C=c.right-224,b="bottom-right";v<200&&g>v&&(k=c.top-8,b=p>224?"top-right":"top-left"),p<224&&T>224&&(C=c.left-224,b=v>200?"bottom-left":"top-left"),C<8&&(C=8),C+224>f-8&&(C=f-232),k<8&&(k=8),k+200>u-8&&(k=u-208),i({top:k,left:C,position:b})}},[e]);const l=()=>"fixed w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50";return a.jsxs("div",{className:"relative inline-block text-left",ref:s,children:[a.jsxs("button",{ref:o,onClick:()=>n(!e),className:"inline-flex justify-center w-full rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:["Acciones ",a.jsx(u8,{className:"-mr-1 ml-2 h-5 w-5"})]}),e&&a.jsx("div",{className:l(),style:{top:`${r.top}px`,left:`${r.left}px`},children:a.jsx("div",{className:"py-1",role:"menu","aria-orientation":"vertical",onClick:()=>n(!1),children:t})})]})}function p8({isOpen:t,onClose:e,onSave:n,service:r,clients:i}){var E;const{addNotification:s}=pn(),[o,l]=ue.useState({}),[c,u]=ue.useState(""),[f,v]=ue.useState(""),[g,p]=ue.useState(""),[T,k]=ue.useState(!1),[C,b]=ue.useState(""),[P,R]=ue.useState(!1),D=["Activo","Periodo de Gracia Vencido","Pendiente Pago","Pago","Cancelado"],Z=()=>{const M=new Date,G=M.getFullYear().toString().slice(-2),K=(M.getMonth()+1).toString().padStart(2,"0"),z=M.getDate().toString().padStart(2,"0"),q=M.getTime().toString().slice(-6);return`SRV-${G}${K}${z}-${q}`},le=(M,G)=>{if(!M||M==="One-Time"||!G)return{startDate:"",endDate:""};const K=new Date(G);let z=new Date(K);switch(M){case"Monthly":z.setMonth(z.getMonth()+1);break;case"Semiannually":z.setMonth(z.getMonth()+6);break;case"Annually":z.setFullYear(z.getFullYear()+1);break;case"Biennially":z.setFullYear(z.getFullYear()+2);break;case"Triennially":z.setFullYear(z.getFullYear()+3);break;case"Custom":return{startDate:K.toISOString().split("T")[0],endDate:""};default:if(M&&M!=="Custom"&&M!=="One-Time"){const q=M.match(/(\d+)\s*mes/i),H=M.match(/(\d+)\s*ao/i);if(q){const X=parseInt(q[1]);z.setMonth(z.getMonth()+X)}else if(H){const X=parseInt(H[1]);z.setFullYear(z.getFullYear()+X)}else return{startDate:K.toISOString().split("T")[0],endDate:""}}else return{startDate:"",endDate:""};break}return{startDate:K.toISOString().split("T")[0],endDate:z.toISOString().split("T")[0]}},U=()=>[{value:"One-Time",label:"Pago nico"},{value:"Monthly",label:"Mensual"},{value:"Semiannually",label:"Semestral"},{value:"Annually",label:"Anual"},{value:"Biennially",label:"Bianual (2 aos)"},{value:"Triennially",label:"Trienal (3 aos)"},{value:"Custom",label:"Otros"}];ue.useEffect(()=>{const M={clientName:"",clientEmail:"",serviceType:"Hosting",description:"",amount:"",currency:"USD",dueDate:"",billingCycle:"One-Time",status:"Activo",clientNotes:"",adminNotes:"",assignedUserId:""};if(r){l({...r,dueDate:r.dueDate?new Date(r.dueDate.seconds*1e3).toISOString().split("T")[0]:"",assignedUserId:r.assignedUserId||""}),v(r.serviceNumber||"");const G=["Hosting","Dominio","Dominio + Hosting"];r.serviceType&&!G.includes(r.serviceType)?(b(r.serviceType),R(!0)):(b(""),R(!1));const K=["One-Time","Monthly","Semiannually","Annually","Biennially","Triennially"];if(r.billingCycle&&!K.includes(r.billingCycle)?(p(r.billingCycle),k(!0)):(p(""),k(!1)),r.assignedUserId){const z=i.find(q=>q.id===r.assignedUserId);z&&u(z.email)}}else{const G=Z();l(M),u(""),v(G),b(""),R(!1),p(""),k(!1)}},[r,i]);const j=M=>{const{name:G,value:K}=M.target;l(z=>({...z,[G]:K})),G==="billingCycle"&&(K==="Custom"?k(!0):(k(!1),p(""))),G==="serviceType"&&(K==="Otro"?R(!0):(R(!1),b("")))},_=M=>{const G=M.target.value;p(G),l(K=>({...K,billingCycle:G||"Custom"}))},F=M=>{const G=M.target.value;b(G),l(K=>({...K,serviceType:G||"Otro"}))},A=M=>{u(M);const G=i.find(K=>K.email===M);l(G?K=>({...K,clientEmail:G.email,clientName:G.fullName||G.email.split("@")[0],assignedUserId:G.id}):K=>({...K,assignedUserId:""}))},L=async M=>{M.preventDefault();try{const G={...o,amount:parseFloat(o.amount),dueDate:ht.fromDate(new Date(o.dueDate)),serviceNumber:f};await n(G),s(`Servicio ${r?"actualizado":"creado"} exitosamente.`,"success"),e()}catch(G){s("Error al guardar el servicio.","error"),console.error(G)}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:r?"Editar Servicio":"Aadir Nuevo Servicio"}),a.jsxs("form",{onSubmit:L,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nmero de Servicio"}),a.jsx("input",{type:"text",value:f,onChange:M=>v(M.target.value),className:"w-full p-2 border rounded-md bg-gray-50 font-mono",placeholder:"SRV-YYMMDD-XXXXXX",required:!0}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Identificador nico del servicio"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asignar a Cliente Existente"}),a.jsxs("select",{value:c,onChange:M=>A(M.target.value),className:"w-full p-2 border rounded-md bg-gray-50",children:[a.jsx("option",{value:"",children:"-- Opcional --"}),i.map(M=>a.jsx("option",{value:M.email,children:M.fullName||M.email},M.id))]}),c&&a.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[" Servicio asignado a: ",((E=i.find(M=>M.email===c))==null?void 0:E.fullName)||c]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"clientName",value:o.clientName||"",onChange:j,placeholder:"Nombre del Cliente",className:"w-full p-2 border rounded-md",required:!0}),a.jsx("input",{name:"clientEmail",type:"email",value:o.clientEmail||"",onChange:j,placeholder:"Email del Cliente",className:"w-full p-2 border rounded-md",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Servicio"}),a.jsxs("select",{name:"serviceType",value:o.serviceType||"Hosting",onChange:j,className:"w-full p-2 border rounded-md",children:[a.jsx("option",{children:"Hosting"}),a.jsx("option",{children:"Dominio"}),a.jsx("option",{children:"Dominio + Hosting"}),a.jsx("option",{children:"Otro"})]}),P&&a.jsxs("div",{className:"mt-2",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Especificar tipo de servicio personalizado"}),a.jsx("input",{type:"text",value:C,onChange:F,placeholder:"Ej: VPS, Cloud Storage, SSL, etc.",className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Escribe el tipo de servicio especfico que ofreces"})]})]}),a.jsx("input",{name:"description",value:o.description||"",onChange:j,placeholder:"Descripcin (ej: plan, dominio.com)",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx("input",{name:"amount",type:"number",step:"0.01",value:o.amount||"",onChange:j,placeholder:"Monto",className:"w-full p-2 border rounded-md",required:!0}),a.jsxs("select",{name:"currency",value:o.currency||"USD",onChange:j,className:"w-full p-2 border rounded-md",children:[a.jsx("option",{children:"USD"}),a.jsx("option",{children:"COP"})]}),a.jsx("input",{name:"dueDate",type:"date",value:o.dueDate||"",onChange:j,className:"w-full p-2 border rounded-md",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ciclo de Facturacin"}),a.jsx("select",{name:"billingCycle",value:o.billingCycle||"One-Time",onChange:j,className:"w-full p-2 border rounded-md",children:U().map(M=>a.jsx("option",{value:M.value,children:M.label},M.value))}),T&&a.jsxs("div",{className:"mt-2",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Especificar ciclo personalizado"}),a.jsx("input",{type:"text",value:g,onChange:_,placeholder:"Ej: 6 meses, 18 meses, 2 aos, etc.",className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Puedes escribir el perodo en meses o aos (ej: "6 meses", "2 aos")'})]})]}),a.jsx("select",{name:"status",value:o.status||"Activo",onChange:j,className:"w-full p-2 border rounded-md",children:D.map(M=>a.jsx("option",{value:M,children:M},M))})]}),o.billingCycle&&o.billingCycle!=="One-Time"&&o.dueDate&&a.jsxs("div",{className:"bg-blue-50 p-4 rounded-md",children:[a.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Perodo del Servicio"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-blue-700 mb-1",children:"Fecha de Inicio"}),a.jsx("input",{type:"date",value:le(o.billingCycle,o.dueDate).startDate,readOnly:!0,className:"w-full p-2 border border-blue-200 rounded-md bg-blue-50 text-blue-800"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-blue-700 mb-1",children:"Fecha de Vencimiento"}),a.jsx("input",{type:"date",value:le(o.billingCycle,o.dueDate).endDate,readOnly:!0,className:"w-full p-2 border border-blue-200 rounded-md bg-blue-50 text-blue-800"})]})]})]}),o.billingCycle==="One-Time"&&a.jsxs("div",{className:"bg-yellow-50 p-4 rounded-md",children:[a.jsx("h4",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Pago nico"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"radio",id:"activation-only",name:"oneTimeType",value:"activation-only",className:"text-yellow-600"}),a.jsx("label",{htmlFor:"activation-only",className:"text-sm text-yellow-700",children:"Solo fecha de activacin (sin expiracin)"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"radio",id:"with-expiration",name:"oneTimeType",value:"with-expiration",className:"text-yellow-600"}),a.jsx("label",{htmlFor:"with-expiration",className:"text-sm text-yellow-700",children:"Con fecha de expiracin"})]}),a.jsxs("div",{className:"ml-6",children:[a.jsx("label",{className:"block text-xs font-medium text-yellow-700 mb-1",children:"Hasta qu fecha expira"}),a.jsx("input",{type:"date",name:"expirationDate",value:o.expirationDate||"",onChange:j,className:"w-full p-2 border border-yellow-200 rounded-md"})]})]})]}),a.jsx("textarea",{name:"clientNotes",value:o.clientNotes||"",onChange:j,placeholder:"Notas para el cliente (visible en su portal)",rows:"3",className:"w-full p-2 border rounded-md"}),a.jsx("textarea",{name:"adminNotes",value:o.adminNotes||"",onChange:j,placeholder:"Notas internas (solo para administrador)",rows:"3",className:"w-full p-2 border rounded-md"}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Guardar Servicio"})]})]})]})}):null}function g8({isOpen:t,onClose:e,onSend:n,service:r,templates:i,companySettings:s}){const{addNotification:o}=pn(),[l,c]=ue.useState(""),[u,f]=ue.useState(""),[v,g]=ue.useState("");if(ue.useEffect(()=>{var T;i.length>0&&t&&c(((T=i[0])==null?void 0:T.id)||"")},[i,t]),ue.useEffect(()=>{var T;if(l&&r){const k=i.find(C=>C.id===l);if(k){const C=r.dueDate?new Date(r.dueDate.seconds*1e3).toLocaleDateString():"N/A",b={"{clientName}":r.clientName||"","{serviceType}":r.serviceType||"","{description}":r.description||"","{amount}":`$${(T=r.amount)==null?void 0:T.toFixed(2)} ${r.currency}`||"","{dueDate}":C,"{companyName}":s.companyName||"Tu Empresa"};let P=k.subject,R=k.body;for(const D in b){const Z=new RegExp(D.replace(/[-\\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g");P=P.replace(Z,b[D]),R=R.replace(Z,b[D])}f(P),g(R)}}},[l,r,i,s]),!t)return null;const p=()=>{var T;n({to:r.clientEmail,subject:u,body:v,reason:`Notificacin Manual: ${((T=i.find(k=>k.id===l))==null?void 0:T.name)||"Mensaje Personalizado"}`}),e()};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full",children:[a.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Enviar Notificacin a ",r.clientName]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Seleccionar Plantilla"}),a.jsx("select",{value:l,onChange:T=>c(T.target.value),className:"mt-1 w-full p-2 border rounded-md",children:i.map(T=>a.jsx("option",{value:T.id,children:T.name},T.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Asunto"}),a.jsx("input",{type:"text",value:u,onChange:T=>f(T.target.value),className:"mt-1 w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cuerpo del Mensaje (Editable)"}),a.jsx("textarea",{value:v,onChange:T=>g(T.target.value),rows:"10",className:"mt-1 w-full p-2 border rounded-md font-mono text-sm"})]})]}),a.jsxs("div",{className:"flex justify-end gap-4 mt-8",children:[a.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),a.jsx("button",{onClick:p,className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Enviar"})]})]})})}let He=null;const fr=async()=>{try{const t=dt(Be,"artifacts",Fe,"public","data","settings","email_config"),e=await vs(t);return e.exists()?(He=e.data(),He):(He={provider:"smtp",smtpHost:"",smtpPort:587,smtpSecure:!1,smtpUser:"",smtpPassword:"",zohoClientId:"",zohoClientSecret:"",zohoRefreshToken:"",zohoAccessToken:"",zohoAccessTokenExpiry:null,fromEmail:"",fromName:"",enabled:!1},He)}catch(t){return console.error("Error loading email config:",t),null}},v8=async()=>{try{const t=dt(Be,"artifacts",Fe,"public","data","settings","notification_settings"),e=await vs(t);return e.exists()?e.data():{admin:{payments:{approval:!0,rejection:!0,newPayment:!0},services:{expirationReminder:!0,newService:!0},users:{newUser:!0,userActivation:!0},tickets:{newTicket:!0,ticketUpdate:!0},renewals:{renewalRequest:!0}},client:{payments:{approval:!0,rejection:!0,pendingPayment:!0},services:{expirationReminder:!0,serviceActivated:!0,serviceExpired:!0},tickets:{ticketReply:!0,ticketResolved:!0},renewals:{renewalReminder:!0,renewalConfirmed:!0}}}}catch(t){return console.error("Error loading notification settings:",t),null}},y8=async(t,e,n)=>{var i,s;const r=await v8();return r?((s=(i=r[t])==null?void 0:i[e])==null?void 0:s[n])??!0:!0},ar=async({to:t,toName:e,subject:n,html:r,text:i,type:s="Notificacin",recipientType:o="Cliente",module:l="system",event:c="notification",metadata:u={}})=>{try{if(!He||!He.enabled){console.warn(" Email service not configured or disabled"),console.log(" Registrando mensaje como fallido en historial");const v=await ql({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Fallido",errorMessage:"Servicio de email no configurado",module:l,event:c,metadata:u});return console.log(" Mensaje registrado con ID:",v),{success:!1,error:"Email service not configured",messageId:v}}if(!await y8(o==="Cliente"?"client":"admin",l,c))return console.log(`Notification disabled: ${o}/${l}/${c}`),await ql({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Cancelado",errorMessage:"Notificacin deshabilitada por configuracin",module:l,event:c,metadata:u}),{success:!1,error:"Notification disabled"};try{if(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")return console.warn(" Modo desarrollo: El endpoint PHP no est disponible localmente. El email se registrar como simulado."),{success:!0,messageId:await ql({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Simulado",simulated:!0,errorMessage:" Email no enviado. En desarrollo local, el servidor PHP no est disponible. Despliega en produccin para envo real.",module:l,event:c,metadata:u}),simulated:!0,warning:"En desarrollo local, el email no se enva realmente. Despliega en produccin para envo real."};const g=He.provider||"smtp";let p="/send-email.php",T={};if(g==="zoho"){if(p="/send-zoho.php",!He.zohoClientId||!He.zohoClientSecret||!He.zohoRefreshToken||!He.fromEmail)throw new Error("Configuracin de Zoho Mail incompleta. Verifica Client ID, Client Secret, Refresh Token y From Email.");T={to:t,toName:e,subject:n,html:r,text:i,zohoConfig:{clientId:He.zohoClientId,clientSecret:He.zohoClientSecret,refreshToken:He.zohoRefreshToken,fromEmail:He.fromEmail,fromName:He.fromName}}}else T={to:t,toName:e,subject:n,html:r,text:i,smtpConfig:{smtpHost:He.smtpHost,smtpPort:He.smtpPort,smtpSecure:He.smtpSecure,smtpUser:He.smtpUser,smtpPassword:He.smtpPassword,fromEmail:He.fromEmail,fromName:He.fromName}};const k=await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)}).catch(P=>{throw console.error("Error de red al llamar send-email.php:",P),new Error(`No se pudo conectar con el servidor PHP. Verifica que send-email.php est en el servidor. Error: ${P.message}`)});if(!k.ok){const P=await k.text().catch(()=>"No se pudo leer la respuesta del servidor");throw console.error("Error HTTP:",k.status,P),k.status===404?new Error("El archivo send-email.php no se encontr en el servidor (404). Verifica que est en el directorio raz."):new Error(`Error del servidor (${k.status}): ${P.substring(0,200)}`)}const C=k.headers.get("content-type");if(!C||!C.includes("application/json")){const P=await k.text().catch(()=>"No se pudo leer la respuesta");throw console.error("Respuesta no es JSON:",P.substring(0,200)),P.includes("<html")||P.includes("<!DOCTYPE")?new Error("El servidor devolvi HTML en lugar de JSON. Posiblemente PHP no est configurado o hay un error en send-email.php."):new Error(`El servidor no devolvi JSON. Respuesta: ${P.substring(0,200)}`)}let b;try{b=await k.json()}catch(P){const R=await k.text().catch(()=>"No se pudo leer la respuesta");throw console.error("Error al parsear JSON:",P,"Respuesta:",R.substring(0,200)),new Error(`Respuesta invlida del servidor (no es JSON vlido): ${R.substring(0,200)}`)}if(b.success){if(g==="zoho"&&b.accessToken&&b.expiresAt)try{const R=dt(Be,"artifacts",Fe,"public","data","settings","email_config");await ws(R,{zohoAccessToken:b.accessToken,zohoAccessTokenExpiry:b.expiresAt},{merge:!0}),He.zohoAccessToken=b.accessToken,He.zohoAccessTokenExpiry=b.expiresAt}catch(R){console.warn("No se pudo actualizar el access token en Firestore:",R)}return{success:!0,messageId:await ql({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Enviado",module:l,event:c,metadata:u,provider:g,externalId:b.zohoMessageId||null}),sent:!0,provider:g}}else{const P=b.error||"Error desconocido al enviar email",R=b.details||"",D=R?`${P}

${R}`:P,Z=await ql({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Fallido",errorMessage:D,module:l,event:c,metadata:u});return{success:!1,error:P,details:R,smtpInfo:b.smtp_host?{host:b.smtp_host,port:b.smtp_port,user:b.smtp_user}:null,messageId:Z}}}catch(v){console.error("Error al llamar a send-email.php:",v);const g=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",p=g?` Servidor PHP no disponible en desarrollo local: ${v.message}`:` Error al enviar email: ${v.message}`,T=await ql({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:g?"Simulado":"Fallido",simulated:g,errorMessage:p,module:l,event:c,metadata:u});return{success:!1,error:p,messageId:T,simulated:g}}}catch(f){return console.error("Error sending email:",f),await ql({to:t,toName:e,subject:n,body:i||r,type:s,recipientType:o,status:"Fallido",errorMessage:f.message,module:l,event:c,metadata:u}),{success:!1,error:f.message}}},ql=async t=>{try{console.log(" Registrando mensaje en Firestore:",{to:t.to,subject:t.subject,type:t.type,recipientType:t.recipientType,module:t.module,event:t.event});const e=Ut(Be,"artifacts",Fe,"public","data","messages"),n=(He==null?void 0:He.provider)||"smtp",r={...t,channel:"email",provider:n,sentAt:ht.now(),createdAt:ht.now(),updatedAt:ht.now()};console.log(" Datos del mensaje a guardar:",r);const i=await Sa(e,r);return console.log(" Mensaje registrado exitosamente con ID:",i.id),i.id}catch(e){return console.error(" Error registering message:",e),console.error(" Detalles del error:",e.message,e.code,e.stack),null}},x8=async t=>{try{if(await fr(),!He||!He.enabled)return{success:!1,error:"Email service not configured or disabled"};const e=He.provider||"smtp";if(e==="zoho"){if(!He.zohoClientId||!He.zohoClientSecret||!He.zohoRefreshToken||!He.fromEmail)return{success:!1,error:"Configuracin de Zoho Mail incompleta. Verifica Client ID, Client Secret, Refresh Token y From Email."}}else if(!He.smtpHost||!He.smtpUser||!He.fromEmail)return{success:!1,error:"Configuracin SMTP incompleta. Verifica todos los campos."};const n=` Prueba de Configuracin${He.fromName?` - ${He.fromName}`:""}`,r=new Date().toLocaleString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"}),i=`
      <!DOCTYPE html>
      <html lang="es">
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
          body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
          .container { max-width: 600px; margin: 0 auto; padding: 20px; background-color: #f9fafb; }
          .header { background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; }
          .content { background: white; padding: 30px; border-radius: 0 0 10px 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
          .success-badge { display: inline-block; background-color: #10b981; color: white; padding: 8px 16px; border-radius: 20px; font-size: 14px; font-weight: bold; margin-bottom: 20px; }
          .info-box { background-color: #eff6ff; border-left: 4px solid #2563eb; padding: 15px; margin: 20px 0; border-radius: 4px; }
          .config-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
          .config-table td { padding: 10px; border-bottom: 1px solid #e5e7eb; }
          .config-table td:first-child { font-weight: bold; color: #374151; width: 40%; }
          .config-table td:last-child { color: #6b7280; font-family: monospace; }
          .footer { text-align: center; color: #6b7280; font-size: 12px; margin-top: 30px; padding-top: 20px; border-top: 1px solid #e5e7eb; }
          .highlight { background-color: #fef3c7; padding: 2px 6px; border-radius: 3px; }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="header">
            <h1 style="margin: 0; font-size: 28px;"> Prueba de Configuracin</h1>
            <p style="margin: 10px 0 0 0; opacity: 0.9;">${He.fromName||"Sistema"} - Sistema de Email</p>
          </div>
          
          <div class="content">
            <div class="success-badge"> Configuracin Exitosa</div>
            
            <h2 style="color: #1f2937; margin-top: 0;">Email de Prueba Enviado Correctamente!</h2>
            
            <p>Este es un email de prueba para verificar que tu configuracin SMTP est funcionando correctamente.</p>
            
            <div class="info-box">
              <strong> Informacin Importante:</strong><br>
              Si recibiste este email, significa que tu servidor SMTP est configurado y funcionando perfectamente.
              Los emails del sistema ahora se enviarn realmente a tus clientes y administradores.
            </div>
            
            <h3 style="color: #374151; margin-top: 30px;"> Detalles de Configuracin ${e==="zoho"?"Zoho Mail API":"SMTP"}</h3>
            
            <table class="config-table">
              ${e==="zoho"?`
              <tr>
                <td>Proveedor:</td>
                <td><span class="highlight">Zoho Mail API</span></td>
              </tr>
              <tr>
                <td>Client ID:</td>
                <td><span class="highlight">${He.zohoClientId?He.zohoClientId.substring(0,20)+"...":"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Email Remitente:</td>
                <td><span class="highlight">${He.fromEmail||"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Nombre Remitente:</td>
                <td><span class="highlight">${He.fromName||"No configurado"}</span></td>
              </tr>
              `:`
              <tr>
                <td>Proveedor:</td>
                <td><span class="highlight">SMTP</span></td>
              </tr>
              <tr>
                <td>Servidor SMTP:</td>
                <td><span class="highlight">${He.smtpHost||"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Puerto:</td>
                <td><span class="highlight">${He.smtpPort||"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Seguridad:</td>
                <td><span class="highlight">${He.smtpSecure?"SSL/TLS ":"No seguro"}</span></td>
              </tr>
              <tr>
                <td>Usuario SMTP:</td>
                <td><span class="highlight">${He.smtpUser||"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Email Remitente:</td>
                <td><span class="highlight">${He.fromEmail||"No configurado"}</span></td>
              </tr>
              <tr>
                <td>Nombre Remitente:</td>
                <td><span class="highlight">${He.fromName||"No configurado"}</span></td>
              </tr>
              `}
            </table>
            
            <h3 style="color: #374151; margin-top: 30px;"> Informacin del Envo</h3>
            
            <table class="config-table">
              <tr>
                <td>Destinatario:</td>
                <td><span class="highlight">${t}</span></td>
              </tr>
              <tr>
                <td>Fecha y Hora:</td>
                <td>${r}</td>
              </tr>
              <tr>
                <td>Estado:</td>
                <td><strong style="color: #10b981;"> Enviado Exitosamente</strong></td>
              </tr>
            </table>
            
            <div class="info-box" style="background-color: #f0fdf4; border-left-color: #10b981; margin-top: 30px;">
              <strong> Prximos Pasos:</strong><br>
              <ul style="margin: 10px 0 0 20px; padding-left: 0;">
                <li>Verifica que este email lleg correctamente (revisa tambin spam)</li>
                <li>Los emails del sistema ahora se enviarn automticamente</li>
                <li>Puedes verificar el historial de mensajes en el panel de administracin</li>
                <li>Si necesitas cambiar la configuracin, ve a <strong>Mensajes  Configuracin de Email</strong></li>
              </ul>
            </div>
            
            <div class="footer">
              <p style="margin: 0;">
                <strong>${He.fromName||"Sistema"}</strong><br>
                ${He.fromName||"Sistema"}<br>
                ${new Date().getFullYear()}  Todos los derechos reservados
              </p>
              <p style="margin: 10px 0 0 0; font-size: 11px; color: #9ca3af;">
                Este es un email automtico del sistema. Por favor, no respondas a este mensaje.
              </p>
            </div>
          </div>
        </div>
      </body>
      </html>
    `,s=`

  PRUEBA DE CONFIGURACIN${He.fromName?` - ${He.fromName.toUpperCase()}`:""}


Email de Prueba Enviado Correctamente!

Este es un email de prueba para verificar que tu configuracin SMTP est funcionando correctamente.

 INFORMACIN IMPORTANTE:

Si recibiste este email, significa que tu servidor SMTP est configurado y funcionando perfectamente. Los emails del sistema ahora se enviarn realmente a tus clientes y administradores.

 DETALLES DE CONFIGURACIN ${e==="zoho"?"ZOHO MAIL API":"SMTP"}:

${e==="zoho"?`
Proveedor: Zoho Mail API
Client ID: ${He.zohoClientId?He.zohoClientId.substring(0,20)+"...":"No configurado"}
Email Remitente: ${He.fromEmail||"No configurado"}
Nombre Remitente: ${He.fromName||"No configurado"}
`:`
Proveedor: SMTP
Servidor SMTP: ${He.smtpHost||"No configurado"}
Puerto: ${He.smtpPort||"No configurado"}
Seguridad: ${He.smtpSecure?"SSL/TLS ":"No seguro"}
Usuario SMTP: ${He.smtpUser||"No configurado"}
Email Remitente: ${He.fromEmail||"No configurado"}
Nombre Remitente: ${He.fromName||"No configurado"}
`}

 INFORMACIN DEL ENVO:

Destinatario: ${t}
Fecha y Hora: ${r}
Estado:  Enviado Exitosamente

 PRXIMOS PASOS:

 Verifica que este email lleg correctamente (revisa tambin spam)
 Los emails del sistema ahora se enviarn automticamente
 Puedes verificar el historial de mensajes en el panel de administracin
 Si necesitas cambiar la configuracin, ve a Mensajes  Configuracin de Email


${He.fromName||"Sistema"}
${He.fromName||"Sistema"}
${new Date().getFullYear()}  Todos los derechos reservados

Este es un email automtico del sistema. Por favor, no respondas a este mensaje.

    `;return await ar({to:t,toName:"Usuario de Prueba",subject:n,html:i,text:s,type:"Sistema",recipientType:"Administrador",module:"system",event:"test",metadata:{isTest:!0}})}catch(e){return console.error("Error testing email:",e),{success:!1,error:e.message}}};fr().then(t=>{He=t});function b8({userRole:t}){const{addNotification:e}=pn(),[n,r]=ue.useState([]),[i,s]=ue.useState([]),[o,l]=ue.useState(!1),[c,u]=ue.useState(null),[f,v]=ue.useState("Todos"),[g,p]=ue.useState(""),[T,k]=ue.useState(!1),[C,b]=ue.useState([]),[P,R]=ue.useState({}),D=["Activo","Periodo de Gracia Vencido","Pendiente Pago","Pago","Cancelado"];ue.useEffect(()=>{const G=Ut(Be,"artifacts",Fe,"public","data","services"),K=An(G,Uu("dueDate","desc")),z=Gt(K,ee=>{r(ee.docs.map(re=>({id:re.id,...re.data()})))}),q=Ut(Be,"artifacts",Fe,"public","data","users"),H=An(q,ur("role","==","client")),X=Gt(H,ee=>{s(ee.docs.map(re=>({id:re.id,...re.data()})))}),ne=Ut(Be,"artifacts",Fe,"public","data","messageTemplates"),w=Gt(ne,ee=>{b(ee.docs.map(re=>({id:re.id,...re.data()})))}),S=dt(Be,"artifacts",Fe,"public","data","settings","company"),V=Gt(S,ee=>{ee.exists()&&R(ee.data())});return()=>{z(),X(),w(),V()}},[]);const Z=async G=>{const K=Ut(Be,"artifacts",Fe,"public","data","services");try{if(G.id){const{id:z,...q}=G;await gr(dt(K,z),q)}else await Sa(K,{...G,createdAt:ht.now()})}catch(z){throw z}},le=async G=>{if(window.confirm("Seguro que quieres eliminar este servicio?"))try{await vl(dt(Be,"artifacts",Fe,"public","data","services",G)),e("Servicio eliminado.","success")}catch{e("Error al eliminar el servicio.","error")}},U=async G=>{try{console.log(" [SERVICES] Iniciando envo de notificacin manual"),await fr();const K=(c==null?void 0:c.clientName)||"Cliente",z=G.to,q=G.subject,H=G.body,X=G.reason||"Notificacin Manual",ne=H.replace(/\n/g,"<br>");console.log(" [SERVICES] Enviando email al cliente:",z);const w=await ar({to:z,toName:K,subject:q,html:`
          <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
            <h2 style="color: #333;">${q}</h2>
            <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
              ${ne}
            </div>
            <p style="color: #666; font-size: 12px; margin-top: 20px;">
              Este es un mensaje automtico de {companyName}.
            </p>
          </div>
        `,text:H,type:"Notificacin",recipientType:"Cliente",module:"services",event:"expirationReminder",metadata:{serviceId:c==null?void 0:c.id,serviceType:c==null?void 0:c.serviceType,reason:X,manualNotification:!0}});w.success?(console.log(" [SERVICES] Notificacin enviada exitosamente"),e("Notificacin enviada exitosamente","success")):(console.error(" [SERVICES] Error al enviar notificacin:",w.error),e(`Notificacin registrada pero no enviada: ${w.error}`,"warning"))}catch(K){console.error(" [SERVICES] Error sending notification:",K),e(`Error al enviar la notificacin: ${K.message}`,"error")}},j=async(G,K)=>{try{await gr(dt(Be,"artifacts",Fe,"public","data","services",G),{status:K}),e("Estado actualizado.","success")}catch{e("Error al actualizar estado.","error")}},_=G=>G.status==="Pendiente Pago"&&G.dueDate&&G.dueDate.toDate()<new Date?"Periodo de Gracia Vencido":G.status,F=(G,K)=>{if(!K)return"text-gray-500";const z=new Date,H=(K.toDate()-z)/(1e3*60*60*24);return G==="Pago"?"text-green-600":G==="Cancelado"?"text-gray-500":G==="Periodo de Gracia Vencido"||H<0?"text-red-600 font-bold":G==="Pendiente Pago"&&H<7?"text-yellow-600 font-semibold":G==="Activo"?"text-blue-600":"text-gray-700"},A=G=>{if(!G.dueDate||!G.billingCycle||G.billingCycle==="One-Time")return G.expirationDate?G.expirationDate.toDate().toLocaleDateString():"N/A";const K=G.dueDate.toDate();let z=new Date(K);switch(G.billingCycle){case"Monthly":z.setMonth(z.getMonth()+1);break;case"Semiannually":z.setMonth(z.getMonth()+6);break;case"Annually":z.setFullYear(z.getFullYear()+1);break;case"Biennially":z.setFullYear(z.getFullYear()+2);break;case"Triennially":z.setFullYear(z.getFullYear()+3);break;default:return"N/A"}return z.toLocaleDateString()},L=G=>({"One-Time":"Pago nico",Monthly:"Mensual",Semiannually:"Semestral",Annually:"Anual",Biennially:"Bianual",Triennially:"Trienal",Custom:"Personalizado"})[G]||G,E=G=>{u(G),k(!0)},M=n.filter(G=>f==="Todos"||_(G)===f).filter(G=>{var q,H,X,ne,w,S,V,ee,re,ce;if(!g)return!0;const K=g.toLowerCase(),z=_(G);return((q=G.clientName)==null?void 0:q.toLowerCase().includes(K))||((H=G.clientEmail)==null?void 0:H.toLowerCase().includes(K))||((X=G.serviceType)==null?void 0:X.toLowerCase().includes(K))||((ne=G.description)==null?void 0:ne.toLowerCase().includes(K))||((w=G.amount)==null?void 0:w.toString().includes(K))||((S=G.currency)==null?void 0:S.toLowerCase().includes(K))||((V=G.billingCycle)==null?void 0:V.toLowerCase().includes(K))||(z==null?void 0:z.toLowerCase().includes(K))||((ee=G.clientNotes)==null?void 0:ee.toLowerCase().includes(K))||((re=G.adminNotes)==null?void 0:re.toLowerCase().includes(K))||G.dueDate&&new Date(G.dueDate.seconds*1e3).toLocaleDateString().includes(K)||G.dueDate&&((ce=G.dueDate.seconds)==null?void 0:ce.toString().includes(K))});return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[["Todos",...D].map(G=>a.jsx("button",{onClick:()=>v(G),className:`px-4 py-2 rounded-full text-sm font-semibold transition-colors ${f===G?"bg-blue-600 text-white shadow-lg":"bg-white hover:bg-gray-100"}`,children:G},G)),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar en toda la tabla...",value:g,onChange:G=>p(G.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full sm:w-64"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Vu,{})})]})]}),a.jsxs("button",{onClick:()=>{u(null),l(!0)},className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700",children:[a.jsx(Vh,{})," ",a.jsx("span",{className:"hidden sm:inline",children:"Nuevo Servicio"})]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Nmero","Cliente","Servicio","Monto","Ciclo","Fecha de Inicio","Fecha de Vencimiento","Notas","Estado","Acciones"].map(G=>a.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:G},G))})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:M.map(G=>{var z;const K=_(G);return a.jsxs("tr",{children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:G.serviceNumber||"N/A"})}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-medium",children:G.clientName}),a.jsx("div",{className:"text-sm text-gray-500",children:G.clientEmail})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-semibold",children:G.serviceType}),a.jsx("div",{className:"text-sm text-gray-600",children:G.description})]}),a.jsxs("td",{className:"px-6 py-4 font-semibold",children:[(z=G.amount)==null?void 0:z.toFixed(2)," ",G.currency]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:L(G.billingCycle)}),G.billingCycle==="Custom"&&G.customBillingCycle&&a.jsxs("div",{className:"text-xs text-gray-500",children:["(",G.customBillingCycle,")"]})]}),a.jsxs("td",{className:`px-6 py-4 ${F(K,G.dueDate)}`,children:[a.jsx("div",{className:"text-sm",children:G.dueDate?G.dueDate.toDate().toLocaleDateString():"N/A"}),a.jsx("div",{className:"text-xs text-gray-500",children:"Inicio"})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:A(G)}),a.jsx("div",{className:"text-xs text-gray-500",children:"Vencimiento"})]}),a.jsxs("td",{className:"px-6 py-4 text-xs max-w-xs",children:[G.clientNotes&&a.jsxs("div",{className:"truncate",title:G.clientNotes,children:[a.jsx("strong",{children:"Cliente:"})," ",G.clientNotes]}),G.adminNotes&&a.jsxs("div",{className:"truncate text-purple-600 mt-1",title:G.adminNotes,children:[a.jsx("strong",{children:"Admin:"})," ",G.adminNotes]})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("select",{value:G.status,onChange:q=>j(G.id,q.target.value),className:"p-1 text-xs rounded-md border-gray-300 bg-white shadow-sm w-full",children:D.map(q=>a.jsx("option",{value:q,children:q},q))})}),a.jsx("td",{className:"px-6 py-4 text-center",children:a.jsxs(Bh,{children:[a.jsx("button",{onClick:()=>{u(G),l(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Editar"}),a.jsx("button",{onClick:()=>E(G),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Enviar Notificacin"}),a.jsx("button",{onClick:()=>le(G.id),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"Eliminar"})]})})]},G.id)})})]})}),a.jsx(p8,{isOpen:o,onClose:()=>l(!1),onSave:Z,service:c,clients:i}),a.jsx(g8,{isOpen:T,onClose:()=>k(!1),onSend:U,service:c,templates:C,companySettings:P})]})}const Cu=(t,e={},n={})=>{var u;if(!t||typeof t!="string")return t;const r=typeof window<"u"?window.location.origin:"",i=typeof window<"u"?window.location.origin:"",s=((u=n.companySettings)==null?void 0:u.companyName)||"",l={...{"{loginUrl}":r,"{clientPortalUrl}":i,"{clientLoginUrl}":r,"{resetPasswordUrl}":e.resetPasswordUrl||r+" (El enlace se generar automticamente)","{companyName}":s,"{clientName}":e.clientName||e.fullName||"Cliente","{clientEmail}":e.clientEmail||e.email||"","{clientPhone}":e.clientPhone||e.phone||"","{clientId}":e.clientId||e.userId||"","{serviceType}":e.serviceType||"","{description}":e.description||"","{serviceNumber}":e.serviceNumber||"","{amount}":e.amount||"0","{currency}":e.currency||"USD","{dueDate}":e.dueDate||"","{billingCycle}":e.billingCycle||"","{daysRemaining}":e.daysRemaining||e.daysUntilDue||"0","{daysOverdue}":e.daysOverdue||"0","{graceDays}":e.graceDays||"0","{remainingGraceDays}":e.remainingGraceDays||"0","{totalPending}":e.totalPending||"0","{potentialRevenue}":e.potentialRevenue||"0","{paymentHistory}":e.paymentHistory||"N/A","{clientSince}":e.clientSince||"","{previousPayments}":e.previousPayments||"0","{paymentPattern}":e.paymentPattern||"N/A","{riskLevel}":e.riskLevel||"N/A","{lastContact}":e.lastContact||"N/A","{suspensionDate}":e.suspensionDate||"","{reactivationCost}":e.reactivationCost||"0","{clientValue}":e.clientValue||"0","{recoveryProbability}":e.recoveryProbability||"0","{paymentDate}":e.paymentDate||new Date().toLocaleDateString("es-ES"),"{paymentMethod}":e.paymentMethod||"","{paymentReference}":e.paymentReference||"","{nextDueDate}":e.nextDueDate||"","{paymentTime}":e.paymentTime||"0","{collectionEfficiency}":e.collectionEfficiency||"0","{clientSatisfaction}":e.clientSatisfaction||"N/A","{monthlyRevenue}":e.monthlyRevenue||"0","{registrationDate}":e.registrationDate||"","{growthPotential}":e.growthPotential||"N/A","{clientSegment}":e.clientSegment||"N/A","{acquisitionSource}":e.acquisitionSource||"N/A","{gracePeriod}":e.gracePeriod||"0","{communicationHistory}":e.communicationHistory||"N/A","{serviceTerms}":e.serviceTerms||"N/A","{suspensionPolicy}":e.suspensionPolicy||"N/A"},...e.replacements};let c=t;return Object.entries(l).forEach(([f,v])=>{const g=new RegExp(f.replace(/[-\\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g");c=c.replace(g,String(v))}),c},w8=()=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(let n=0;n<48;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},dA=async(t,e,n=24)=>{try{const r=Ut(Be,"artifacts",Fe,"public","data","passwordResetTokens"),i=An(r,ur("userId","==",t),ur("used","==",!1));(await Na(i)).forEach(async c=>{await vl(dt(r,c.id))});const o=w8(),l=new Date;return l.setHours(l.getHours()+n),await Sa(r,{userId:t,email:e,token:o,expiresAt:ht.fromDate(l),createdAt:ht.now(),used:!1}),o}catch(r){throw console.error("Error creating password reset token:",r),r}},N8=async t=>{try{const e=Ut(Be,"artifacts",Fe,"public","data","passwordResetTokens"),n=An(e,ur("token","==",t)),r=await Na(n);if(r.empty)return{valid:!1,userId:null,email:null,error:"Token no encontrado"};const i=r.docs[0],s=i.data();if(s.used)return{valid:!1,userId:null,email:null,error:"Este token ya fue utilizado"};const o=s.expiresAt.toDate();return new Date>o?{valid:!1,userId:null,email:null,error:"Este token ha expirado"}:{valid:!0,userId:s.userId,email:s.email,error:null,tokenDocId:i.id}}catch(e){return console.error("Error validating password reset token:",e),{valid:!1,userId:null,email:null,error:"Error al validar el token"}}};function _8({isOpen:t,onClose:e,onSave:n,user:r}){const{addNotification:i}=pn(),[s,o]=ue.useState({});ue.useEffect(()=>{r&&o(r)},[r]);const l=u=>{const{name:f,value:v}=u.target;o(g=>({...g,[f]:v}))},c=async u=>{u.preventDefault();try{await n(s),i("Usuario actualizado.","success"),e()}catch{i("Error al actualizar usuario.","error")}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-lg w-full",children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Editar Usuario"}),a.jsxs("form",{onSubmit:c,className:"space-y-4",children:[a.jsx("input",{name:"fullName",value:s.fullName||"",onChange:l,placeholder:"Nombre Completo",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"identification",value:s.identification||"",onChange:l,placeholder:"Identificacin",className:"w-full p-2 border rounded-md"}),a.jsx("input",{type:"email",value:s.email||"",readOnly:!0,disabled:!0,className:"w-full p-2 border rounded-md bg-gray-100"}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Guardar Cambios"})]})]})]})}):null}function E8({isOpen:t,onClose:e,onSave:n}){const{addNotification:r}=pn(),[i,s]=ue.useState(""),[o,l]=ue.useState(""),[c,u]=ue.useState(""),[f,v]=ue.useState(""),[g,p]=ue.useState("client"),[T,k]=ue.useState("active"),[C,b]=ue.useState(!1),[P,R]=ue.useState(""),D=[{value:"client",label:"Cliente"},{value:"admin",label:"Administrador"},{value:"superadmin",label:"Super Administrador"}],Z=[{value:"active",label:"Activo"},{value:"inactive",label:"Inactivo"},{value:"pending",label:"Pendiente"}],le=()=>{s(""),l(""),u(""),v(""),p("client"),k("active"),b(!1),R("")},U=()=>{le(),e()},j=async _=>{if(_.preventDefault(),!C&&o.length<6){R("La contrasea debe tener al menos 6 caracteres.");return}if(!C&&!o){R("Debes asignar una contrasea temporal cuando no se notifica por correo.");return}R("");try{await n({email:i,password:C?null:o,notify:C,fullName:c,identification:f,role:g,status:T}),e()}catch{r("Error al crear usuario.","error")}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-md w-full",children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Crear Nuevo Usuario"}),a.jsxs("form",{onSubmit:j,className:"space-y-4",children:[a.jsx("input",{type:"email",value:i,onChange:_=>s(_.target.value),placeholder:"Email del nuevo usuario",className:"w-full p-2 border rounded-md",required:!0}),!C&&a.jsx("input",{type:"password",value:o,onChange:_=>l(_.target.value),placeholder:"Contrasea temporal",className:"w-full p-2 border rounded-md",required:!0}),C&&a.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md",children:a.jsxs("p",{className:"text-sm text-blue-800",children:[a.jsx("strong",{children:"Nota:"}),' Al marcar "Notificar al usuario por correo", el usuario recibir un enlace para crear su propia contrasea de forma segura. No es necesario asignar una contrasea temporal.']})}),a.jsx("input",{value:c,onChange:_=>u(_.target.value),placeholder:"Nombre Completo",className:"w-full p-2 border rounded-md"}),a.jsx("input",{value:f,onChange:_=>v(_.target.value),placeholder:"Identificacin",className:"w-full p-2 border rounded-md"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),a.jsx("select",{value:g,onChange:_=>p(_.target.value),className:"w-full p-2 border rounded-md",required:!0,children:D.map(_=>a.jsx("option",{value:_.value,children:_.label},_.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),a.jsx("select",{value:T,onChange:_=>k(_.target.value),className:"w-full p-2 border rounded-md",required:!0,children:Z.map(_=>a.jsx("option",{value:_.value,children:_.label},_.value))})]})]}),P&&a.jsx("p",{className:"text-red-500 text-sm",children:P}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{id:"notify",type:"checkbox",checked:C,onChange:_=>b(_.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),a.jsx("label",{htmlFor:"notify",className:"ml-2 block text-sm text-gray-900",children:"Notificar al usuario por correo"})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[a.jsx("button",{type:"button",onClick:U,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Crear Usuario"})]})]})]})}):null}function A8({isOpen:t,onClose:e,user:n,onActivate:r,companySettings:i}){var C;const{addNotification:s}=pn(),[o,l]=ue.useState(""),[c,u]=ue.useState(""),[f,v]=ue.useState([]),[g,p]=ue.useState(!1),T=`Hola ${(n==null?void 0:n.fullName)||(n==null?void 0:n.email)},

Tu cuenta ha sido activada exitosamente en {companyName}.

Ahora puedes:
 Ver tus servicios contratados
 Crear tickets de soporte
 Gestionar tu perfil

Para acceder, simplemente inicia sesin con tu email y contrasea.

Bienvenido!

Equipo de Soporte`;ue.useEffect(()=>{if(!t)return;const b=Ut(Be,"artifacts",Fe,"public","data","messageTemplates"),P=An(b,Uu("name")),R=Gt(P,D=>{const le=D.docs.map(U=>({id:U.id,...U.data()})).filter(U=>(U.category||"client")==="client");v(le)},D=>{console.error("Error loading templates:",D),v([])});return()=>R()},[t]),ue.useEffect(()=>{if(c){const b=f.find(P=>P.id===c);if(b){let P=b.body,R=b.subject;const D={"{clientName}":(n==null?void 0:n.fullName)||(n==null?void 0:n.email)||"","{clientEmail}":(n==null?void 0:n.email)||"","{companyName}":(i==null?void 0:i.companyName)||""};Object.entries(D).forEach(([Z,le])=>{P=P.replace(new RegExp(Z,"g"),le),R=R.replace(new RegExp(Z,"g"),le)}),l(P)}}},[c,f,n,i]);const k=async()=>{p(!0);try{console.log(" [USUARIOS] Activando usuario y enviando notificacin"),await r(),await fr();let b=o||T,P=`Cuenta Activada - ${(i==null?void 0:i.companyName)||"Sistema de Gestin de Cobros"}`;if(c){const R=f.find(D=>D.id===c);if(R){let D=R.subject;const Z={"{clientName}":(n==null?void 0:n.fullName)||(n==null?void 0:n.email)||"","{clientEmail}":(n==null?void 0:n.email)||"","{companyName}":(i==null?void 0:i.companyName)||""};Object.entries(Z).forEach(([le,U])=>{D=D.replace(new RegExp(le,"g"),U)}),P=D}}await ar({to:n.email,toName:n.fullName||n.email,subject:P,html:b.replace(/\n/g,"<br>"),text:b,type:"Activacin",recipientType:"Cliente",module:"users",event:"userActivation",metadata:{userId:n.id,userEmail:n.email,userRole:n.role}}),s(`Usuario ${n.email} activado y notificado exitosamente`,"success"),e()}catch(b){console.error("Error activating user:",b),s(`Error al activar usuario: ${b.message}`,"error")}finally{p(!1)}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Activar Usuario"}),a.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"Usuario a Activar:"}),a.jsxs("p",{className:"text-blue-700",children:[a.jsx("strong",{children:"Email:"})," ",n==null?void 0:n.email,a.jsx("br",{}),a.jsx("strong",{children:"Nombre:"})," ",(n==null?void 0:n.fullName)||"Sin especificar",a.jsx("br",{}),a.jsx("strong",{children:"Rol:"})," ",(n==null?void 0:n.role)||"Cliente"]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Seleccionar Plantilla (Opcional)"}),a.jsxs("select",{value:c,onChange:b=>{u(b.target.value),b.target.value||l("")},className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500 mb-3",children:[a.jsx("option",{value:"",children:"-- Sin plantilla (usar mensaje por defecto) --"}),f.map(b=>a.jsx("option",{value:b.id,children:b.name},b.id))]}),c&&a.jsx("div",{className:"mb-3 p-3 bg-blue-50 border border-blue-200 rounded-md",children:a.jsxs("p",{className:"text-sm text-blue-800",children:[a.jsx("strong",{children:"Plantilla seleccionada:"})," ",((C=f.find(b=>b.id===c))==null?void 0:C.name)||"N/A"]})}),a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje de Notificacin"}),a.jsx("textarea",{value:o||T,onChange:b=>l(b.target.value),rows:"8",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",placeholder:T}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:c?"Puedes editar el mensaje de la plantilla seleccionada o dejarlo como est.":"Si no seleccionas una plantilla, se enviar el mensaje por defecto. Puedes personalizarlo aqu."})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:[a.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"Qu suceder?"}),a.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[a.jsx("li",{children:" El usuario ser activado inmediatamente"}),a.jsx("li",{children:" Se enviar una notificacin por email"}),a.jsx("li",{children:" El usuario podr iniciar sesin"}),a.jsx("li",{children:" Si es cliente, deber completar su perfil"})]})]}),a.jsxs("div",{className:"flex justify-end space-x-4",children:[a.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),a.jsx("button",{onClick:k,disabled:g,className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 flex items-center gap-2",children:g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Activando..."]}):"Activar y Notificar"})]})]})}):null}function S8({isOpen:t,onClose:e,user:n,companySettings:r}){var R;const{addNotification:i}=pn(),[s,o]=ue.useState(""),[l,c]=ue.useState([]),[u,f]=ue.useState(""),[v,g]=ue.useState(""),[p,T]=ue.useState(!1),C=(()=>{const D=typeof window<"u"?`${window.location.origin}${window.location.pathname}`:"";return`Hola ${(n==null?void 0:n.fullName)||(n==null?void 0:n.email)},

Tu cuenta ha sido activada exitosamente en {companyName}.

 CREAR O CAMBIAR TU CONTRASEA:

Para acceder al sistema, necesitas crear o cambiar tu contrasea usando el enlace que recibirs por correo.

 INSTRUCCIONES PASO A PASO:

1. Revisa tu correo electrnico (incluyendo la carpeta de spam)
2. Busca un email de Firebase con el asunto "Restablece tu contrasea" o "Reset your password"
3. Haz clic en el botn o enlace "Restablecer contrasea" dentro de ese email
4. Sers redirigido a nuestro sistema en: ${D}
5. En la pgina de restablecimiento, ingresa una contrasea segura (mnimo 6 caracteres)
6. Confirma tu contrasea ingresndola nuevamente
7. Haz clic en "Restablecer Contrasea"
8. Una vez creada tu contrasea, sers redirigido automticamente al inicio de sesin
9. Inicia sesin con:
   - Email: ${n==null?void 0:n.email}
   - Contrasea: La que acabas de crear

 ENLACE DIRECTO AL SISTEMA:
${D}

 IMPORTANTE:
- El enlace para crear/cambiar tu contrasea expirar en 1 hora
- Si el enlace expira o no recibes el email, puedes solicitar uno nuevo desde la pgina de inicio de sesin haciendo clic en "Olvidaste tu contrasea?"
- Tu cuenta est activa y lista para usar una vez que crees tu contrasea

Una vez que inicies sesin, podrs:
 Ver tus servicios contratados
 Crear tickets de soporte
 Gestionar tu perfil y pagos
 Acceder a todas las funcionalidades del sistema

Si tienes alguna pregunta o necesitas ayuda, no dudes en contactarnos.

Bienvenido!

Equipo de Soporte
${(r==null?void 0:r.companyName)||""}`})(),b=`Cuenta Activada - ${(r==null?void 0:r.companyName)||""}`;if(ue.useEffect(()=>{if(!t)return;const D=Ut(Be,"artifacts",Fe,"public","data","messageTemplates"),Z=An(D,Uu("name")),le=Gt(Z,U=>{const _=U.docs.map(F=>({id:F.id,...F.data()})).filter(F=>(F.category||"client")==="client");if(c(_),_.length>0&&!s){const F=_.find(A=>A.name.includes("Notificacin de Activacin")||A.name.includes("Activacin - Crear"));F?o(F.id):Qy("Notificacin de Activacin - Crear Contrasea").then(A=>{A&&_.find(L=>L.id===A.id)?o(A.id):_.length>0&&o(_[0].id)})}},U=>{console.error("Error loading templates:",U),c([])});return()=>le()},[t]),ue.useEffect(()=>{if(s&&l.length>0){const D=l.find(Z=>Z.id===s);if(D){let Z=D.body,le=D.subject;const U=typeof window<"u"?`${window.location.origin}${window.location.pathname}`:"",j={clientName:(n==null?void 0:n.fullName)||(n==null?void 0:n.email)||"",clientEmail:(n==null?void 0:n.email)||"",resetPasswordUrl:U+" (El enlace se generar automticamente)",...n},_=Cu(le,j,{companySettings:r}),F=Cu(Z,j,{companySettings:r});g(F),f(_)}}else s||(g(C),f(b))},[s,l,n,r]),ue.useEffect(()=>{t&&l.length===0&&(g(C),f(b),o(""))},[t,n,l.length]),!t)return null;const P=async()=>{if(!u.trim()||!v.trim()){i("Por favor, complete el asunto y el mensaje","error");return}T(!0);try{console.log(" [USUARIOS] Enviando notificacin de activacin y reset de contrasea al usuario");let D=null;try{const j=dt(Be,"artifacts",Fe,"public","data","users",n.id);if((await vs(j)).exists()){const F=await dA(n.id,n.email,24);D=`${`${window.location.origin}${window.location.pathname}`}?token=${F}`,console.log(" Token de reset generado exitosamente")}else throw new Error("Usuario no encontrado en Firestore")}catch(j){console.error("Error generando token de reset:",j),i(" No se pudo generar el token de restablecimiento. El email de notificacin se enviar de todas formas.","warning")}await fr();const Z=`${window.location.origin}${window.location.pathname}`;let le=v,U=u;D?(le=le.replace(/\{resetPasswordUrl\}/g,D),U=U.replace(/\{resetPasswordUrl\}/g,D)):(le=le.replace(/\{resetPasswordUrl\}/g,Z+" (Revisa tu correo para el enlace completo)"),U=U.replace(/\{resetPasswordUrl\}/g,Z)),await ar({to:n.email,toName:n.fullName||n.email,subject:u.trim(),html:le.replace(/\n/g,"<br>"),text:le,type:"Activacin",recipientType:"Cliente",module:"users",event:"userActivation",metadata:{userId:n.id,userEmail:n.email,userRole:n.role,templateId:s||null}}),i(`Notificacin de activacin y creacin de contrasea enviadas a ${n.email}`,"success"),e()}catch(D){console.error("Error enviando notificacin de activacin:",D),i(`Error al enviar notificacin: ${D.message}`,"error")}finally{T(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Notificar Activacin a ",(n==null?void 0:n.fullName)||(n==null?void 0:n.email)]}),a.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"Usuario:"}),a.jsxs("p",{className:"text-blue-700",children:[a.jsx("strong",{children:"Email:"})," ",n==null?void 0:n.email,a.jsx("br",{}),a.jsx("strong",{children:"Nombre:"})," ",(n==null?void 0:n.fullName)||"Sin especificar",a.jsx("br",{}),a.jsx("strong",{children:"Rol:"})," ",(n==null?void 0:n.role)||"Cliente"]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Seleccionar Plantilla (Opcional)"}),a.jsxs("select",{value:s,onChange:D=>{o(D.target.value),D.target.value||(g(C),f(b))},className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"-- Sin plantilla (usar mensaje por defecto) --"}),l.map(D=>a.jsx("option",{value:D.id,children:D.name},D.id))]}),s&&a.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["Plantilla seleccionada: ",((R=l.find(D=>D.id===s))==null?void 0:R.name)||"N/A"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Asunto"}),a.jsx("input",{type:"text",value:u,onChange:D=>f(D.target.value),className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",placeholder:"Asunto del correo"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cuerpo del Mensaje (Editable)"}),a.jsx("textarea",{value:v,onChange:D=>g(D.target.value),rows:"12",className:"w-full p-3 border rounded-md font-mono text-sm focus:ring-2 focus:ring-blue-500",placeholder:C}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:s?"Puedes editar el mensaje de la plantilla seleccionada o dejarlo como est.":"Puedes personalizar el mensaje o usar el mensaje por defecto."})]})]}),a.jsxs("div",{className:"flex justify-end gap-4 mt-8",children:[a.jsx("button",{onClick:e,disabled:p,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 disabled:opacity-50",children:"Cancelar"}),a.jsx("button",{onClick:P,disabled:p||!u.trim()||!v.trim(),className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2",children:p?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Enviando..."]}):"Enviar Notificacin"})]})]})})}function k8({userRole:t,companySettings:e}){const{addNotification:n}=pn(),[r,i]=ue.useState([]),[s,o]=ue.useState(""),[l,c]=ue.useState(!1),[u,f]=ue.useState(!1),[v,g]=ue.useState(!1),[p,T]=ue.useState(!1),[k,C]=ue.useState(null),[b,P]=ue.useState(null),[R,D]=ue.useState(null);ue.useEffect(()=>{const M=Ut(Be,"artifacts",Fe,"public","data","users");return Gt(An(M,Uu("email")),K=>{i(K.docs.map(z=>({id:z.id,...z.data()})))})},[]);const Z=async M=>{const{id:G,...K}=M,z=dt(Be,"artifacts",Fe,"public","data","users",G);await gr(z,K)},le=async M=>{var K;const G=(K=Nr.currentUser)==null?void 0:K.uid;try{const z=An(Ut(Be,"artifacts",Fe,"public","data","users"),ur("email","==",M.email));if(!(await Na(z)).empty){n("El email ya est registrado en el sistema","error");return}let H;if(M.notify&&!M.password){const S=Math.random().toString(36).slice(-12)+Math.random().toString(36).slice(-12);H=(await qm(Nr,M.email,S)).user}else H=(await qm(Nr,M.email,M.password)).user;const X={email:M.email,fullName:M.fullName||"",identification:M.identification||"",role:M.role||"client",status:M.status||"active",isProfileComplete:!0,createdAt:ht.now(),requiresPasswordChange:!M.notify},ne=dt(Be,"artifacts",Fe,"public","data","users",H.uid);await ws(ne,X);const w=Nr.currentUser;if(w&&w.uid===H.uid&&G&&w.uid!==G&&console.log(" Usuario actual cambi al nuevo usuario. El admin puede continuar trabajando normalmente."),M.notify)try{console.log(" [USUARIOS] Enviando email de bienvenida y reset de contrasea al nuevo usuario");let S=null;try{const he=await dA(H.uid,M.email,24);S=`${`${window.location.origin}${window.location.pathname}`}?token=${he}`,console.log(" Token de reset generado exitosamente")}catch(he){console.error("Error generando token de reset:",he),n(" No se pudo generar el token de restablecimiento. El usuario fue creado.","warning")}await fr();const V=await Qy("Bienvenida - Nuevo Usuario - Crear Contrasea"),ee=`${window.location.origin}${window.location.pathname}`;let re,ce;if(V){const he={clientName:M.fullName||M.email||"Cliente",clientEmail:M.email||"",resetPasswordUrl:S||ee+" (El enlace se generar automticamente)",...M};re=Cu(V.subject,he,{companySettings:e}),ce=Cu(V.body,he,{companySettings:e})}else re=`Bienvenido a ${(e==null?void 0:e.companyName)||"nuestro sistema"}`,ce=`Hola ${M.fullName||M.email},

Bienvenido a ${(e==null?void 0:e.companyName)||"nuestro sistema"}!

Tu cuenta ha sido creada exitosamente.

 Tu email de acceso: ${M.email}

${S?` CREAR TU CONTRASEA:

Haz clic en el siguiente enlace para crear tu contrasea:
${S}`:"Revisa tu correo para recibir el enlace de creacin de contrasea."}

Equipo de Soporte
${(e==null?void 0:e.companyName)||""}`;await ar({to:M.email,toName:M.fullName||M.email,subject:re,html:ce.replace(/\n/g,"<br>"),text:ce,type:"Bienvenida",recipientType:"Cliente",module:"users",event:"newUser",metadata:{userId:H.uid,userEmail:M.email,userRole:M.role}}),n(`Usuario ${M.email} creado exitosamente. Emails de bienvenida y creacin de contrasea enviados.`,"success")}catch(S){console.error("Error enviando emails:",S),n(`Usuario ${M.email} creado exitosamente, pero no se pudieron enviar los emails: ${S.message}`,"warning")}else n(`Usuario ${M.email} creado exitosamente con contrasea temporal. Puedes notificar la activacin desde el men de acciones.`,"success")}catch(z){console.error("Error creating user:",z);let q="Error al crear usuario";throw z.code==="auth/email-already-in-use"?q="El email ya est registrado en el sistema":z.code==="auth/invalid-email"?q="El email no es vlido":z.code==="auth/weak-password"?q="La contrasea es muy dbil":q=`Error al crear usuario: ${z.message}`,n(q,"error"),z}},U=async()=>{if(b)try{const M=dt(Be,"artifacts",Fe,"public","data","users",b.id);await gr(M,{status:"active"}),n(`Usuario ${b.email} activado exitosamente.`,"success")}catch(M){n("Error al activar usuario","error"),console.error("Error activating user:",M)}},j=async(M,G)=>{if(t!=="superadmin"){n("Accin no permitida.","error");return}const K=dt(Be,"artifacts",Fe,"public","data","users",M.id);try{switch(G){case"activate":P(M),g(!0);break;case"notify":D(M),T(!0);break;case"disable":window.confirm(`Deshabilitar a ${M.email}?`)&&(await gr(K,{status:"disabled"}),n(`Usuario ${M.email} deshabilitado.`,"success"));break;case"makeAdmin":window.confirm(`Convertir a ${M.email} en administrador?`)&&(await gr(K,{role:"admin"}),n(`${M.email} ahora es administrador.`,"success"));break;case"makeClient":window.confirm(`Convertir a ${M.email} en cliente?`)&&(await gr(K,{role:"client"}),n(`${M.email} ahora es cliente.`,"success"));break;case"delete":if(window.confirm(`Eliminar permanentemente a ${M.email}? Esta accin no se puede deshacer.`))try{await vl(K),n(`Usuario ${M.email} eliminado de la base de datos.`,"success"),n("Nota: El usuario permanece en Authentication. Contacta al administrador para eliminacin completa.","info")}catch(z){console.error("Error deleting user:",z),n("Error al eliminar el usuario: "+z.message,"error")}break;default:n("Accin no reconocida.","error")}}catch(z){n("Ocurri un error al realizar la accin.","error"),console.error("Error in user action:",z)}},_=r.filter(M=>{const G=s.toLowerCase();return!G||M.email.toLowerCase().includes(G)||M.fullName&&M.fullName.toLowerCase().includes(G)||M.identification&&M.identification.includes(G)}),F=M=>({active:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",disabled:"bg-red-100 text-red-800"})[M]||"bg-gray-100 text-gray-800",A=M=>({superadmin:"bg-red-100 text-red-800 font-bold",admin:"bg-blue-100 text-blue-800 font-semibold",client:"bg-gray-100 text-gray-800"})[M]||"bg-gray-100 text-gray-800",L=M=>({active:"Activo",pending:"Pendiente",disabled:"Deshabilitado"})[M]||M,E=M=>({superadmin:"Super Admin",admin:"Administrador",client:"Cliente"})[M]||M;return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar por email, nombre, ID...",value:s,onChange:M=>o(M.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full sm:w-64"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Vu,{})})]}),t==="superadmin"&&a.jsxs("button",{onClick:()=>c(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700",children:[a.jsx(Vh,{})," ",a.jsx("span",{className:"hidden sm:inline",children:"Crear Usuario"})]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Nombre","Email","Identificacin","Rol","Estado","Fecha Creacin","Acciones"].map(M=>a.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:M},M))})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:_.map(M=>a.jsxs("tr",{children:[a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-medium text-gray-900",children:M.fullName||"Sin nombre"}),M.fullName&&a.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",M.id.slice(0,8),"..."]})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm text-gray-900",children:M.email}),M.requiresPasswordChange&&a.jsx("div",{className:"text-xs text-orange-600",children:"Requiere cambio de contrasea"})]}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:M.identification||"--"}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${A(M.role)}`,children:E(M.role)})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${F(M.status)}`,children:L(M.status)})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:M.createdAt?new Date(M.createdAt.seconds*1e3).toLocaleDateString():"--"}),a.jsx("td",{className:"px-6 py-4",children:t==="superadmin"&&M.role!=="superadmin"&&a.jsxs(Bh,{children:[a.jsx("button",{onClick:()=>{C(M),f(!0)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:" Editar Datos"}),a.jsx("button",{onClick:()=>j(M,"notify"),className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:" Notificar Activacin"}),M.status==="pending"&&a.jsx("button",{onClick:()=>j(M,"activate"),className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:" Activar Usuario"}),M.status==="active"&&a.jsx("button",{onClick:()=>j(M,"disable"),className:"block w-full text-left px-4 py-2 text-sm text-yellow-700 hover:bg-yellow-50",children:" Deshabilitar"}),M.status==="disabled"&&a.jsx("button",{onClick:()=>j(M,"activate"),className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:" Re-Activar"}),M.role==="client"?a.jsx("button",{onClick:()=>j(M,"makeAdmin"),className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:" Hacer Administrador"}):a.jsx("button",{onClick:()=>j(M,"makeClient"),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:" Hacer Cliente"}),a.jsx("button",{onClick:()=>j(M,"delete"),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:" Eliminar Permanentemente"})]})})]},M.id))})]})}),a.jsx(E8,{isOpen:l,onClose:()=>c(!1),onSave:le}),a.jsx(_8,{isOpen:u,onClose:()=>f(!1),onSave:Z,user:k}),a.jsx(A8,{isOpen:v,onClose:()=>{g(!1),P(null)},onActivate:U,user:b,companySettings:e}),a.jsx(S8,{isOpen:p,onClose:()=>{T(!1),D(null)},user:R,companySettings:e})]})}function T8(){const{addNotification:t}=pn(),[e,n]=ue.useState([]),[r,i]=ue.useState(null),[s,o]=ue.useState(""),[l,c]=ue.useState(""),[u,f]=ue.useState(""),[v,g]=ue.useState("client"),[p,T]=ue.useState(!1),[k,C]=ue.useState("all"),[b,P]=ue.useState([]),[R,D]=ue.useState({preVencimiento:{enabled:!1,days:7,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]},periodoGracia:{enabled:!1,days:3,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]},vencido:{enabled:!1,days:0,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]},suspendido:{enabled:!1,days:0,clientTemplate:"",adminTemplate:"",notifyAdmins:!1,selectedAdmins:[]}}),[Z,le]=ue.useState("templates"),U={preVencimiento:{name:"Aviso de Prximo Vencimiento",subject:"Recordatorio de Renovacin de Servicio: {description}",body:`Estimado/a {clientName},

Le escribimos para recordarle que su servicio '{description}' est programado para vencer el prximo {dueDate}.

El monto correspondiente a la renovacin es de {amount} {currency}.

Para garantizar la continuidad de su servicio, le recomendamos realizar el pago antes de la fecha de vencimiento. Puede gestionarlo a travs de nuestro portal de clientes.

Si tiene alguna consulta, no dude en contactarnos.

Atentamente,
{companyName}`},vencido:{name:"Notificacin de Servicio Vencido",subject:"Importante: Su servicio {description} ha vencido",body:`Estimado/a {clientName},

Le informamos que la factura correspondiente a su servicio '{description}', con fecha de vencimiento {dueDate}, se encuentra pendiente de pago.

Su servicio ha entrado en un perodo de gracia. Para evitar la suspensin del mismo, le solicitamos regularizar su situacin a la brevedad posible. El monto pendiente es de {amount} {currency}.

Si usted ya ha realizado el pago, por favor, omita esta notificacin.

Cordialmente,
{companyName}`},suspendido:{name:"Aviso de Suspensin de Servicio",subject:"Accin Requerida: Suspensin del servicio {description}",body:`Estimado/a {clientName},

Lamentamos informarle que, debido a la falta de pago, su servicio '{description}' ha sido suspendido.

Para proceder con la reactivacin y recuperar el acceso, es necesario saldar el monto pendiente de {amount} {currency}. Por favor, contctenos para coordinar el pago y la restauracin del servicio.

Quedamos a su disposicin.

Atentamente,
{companyName}`},pagoRecibido:{name:"Confirmacin de Pago Recibido",subject:"Confirmacin: Pago recibido para {description}",body:`Estimado/a {clientName},

Hemos recibido y procesado exitosamente su pago por {amount} {currency} correspondiente al servicio '{description}'.

Su servicio est activo y funcionando correctamente. La prxima fecha de vencimiento ser {dueDate}.

Gracias por su confianza y por mantener sus pagos al da.

Atentamente,
{companyName}`},bienvenida:{name:"Bienvenida a Nuevo Cliente",subject:"Bienvenido a {companyName} - Servicio {description}",body:`Estimado/a {clientName},

Bienvenido a {companyName}!

Nos complace confirmar que su servicio '{description}' ha sido activado exitosamente.

Detalles del servicio:
- Descripcin: {description}
- Monto: {amount} {currency}
- Prximo vencimiento: {dueDate}

Puede acceder a su portal de cliente en cualquier momento para gestionar su cuenta y realizar pagos.

Si tiene alguna pregunta, no dude en contactarnos.

Gracias por elegirnos!

Atentamente,
{companyName}`},nuevoUsuario:{name:"Bienvenida - Nuevo Usuario",subject:"Bienvenido a {companyName} - Crea tu contrasea",body:`Estimado/a {clientName},

Bienvenido a {companyName}!

Tu cuenta ha sido creada exitosamente en {companyName}.

 Tu email de acceso: {clientEmail}

 CREAR TU CONTRASEA:

Para completar tu registro y acceder al sistema, necesitas crear tu contrasea personal.

 PASOS PARA CREAR TU CONTRASEA:

1. Revisa tu correo electrnico, recibirs un email de Firebase con el asunto "Restablece tu contrasea"
2. Haz clic en el enlace "Restablecer contrasea" de ese email
3. Ingresa una contrasea segura (mnimo 6 caracteres)
4. Confirma tu contrasea
5. Una vez creada tu contrasea, sers redirigido al inicio de sesin
6. Inicia sesin con tu email ({clientEmail}) y la contrasea que acabas de crear

 IMPORTANTE:
- El enlace para crear tu contrasea expirar en 1 hora
- Si el enlace expira, contacta con soporte para generar uno nuevo
- Tu cuenta est activa y lista para usar una vez que crees tu contrasea

Una vez que inicies sesin, podrs:
 Ver tus servicios contratados
 Crear tickets de soporte
 Gestionar tu perfil y pagos

Si tienes alguna pregunta o necesitas ayuda, no dudes en contactarnos.

Bienvenido!

Equipo de Soporte
{companyName}`},adminPreVencimiento:{name:"Alerta Admin: Prximo Vencimiento",subject:"ALERTA: Servicio prximo a vencer - {clientName}",body:`Estimado/a Administrador,

Se ha generado una alerta automtica para el siguiente servicio:

 INFORMACIN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto: {amount} {currency}
- Fecha de vencimiento: {dueDate}
- Ciclo de facturacin: {billingCycle}
- Das restantes: {daysRemaining}

 ESTADO ACTUAL:
- Estado: Prximo a vencer
- Notificacin enviada al cliente: 
- Plantilla utilizada: Aviso de Prximo Vencimiento

 ACCIONES RECOMENDADAS:
1. Verificar que el cliente haya recibido la notificacin
2. Contactar al cliente si es necesario
3. Preparar seguimiento post-vencimiento

 ESTADSTICAS:
- Total de servicios prximos a vencer: {totalPending}
- Ingresos potenciales: {potentialRevenue}

Este es un mensaje automtico de {companyName}.

{companyName}`},adminPeriodoGracia:{name:"Alerta Admin: Perodo de Gracia",subject:"URGENTE: Servicio en perodo de gracia - {clientName}",body:`Estimado/a Administrador,

 ALERTA URGENTE - Servicio en perodo de gracia:

 INFORMACIN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto pendiente: {amount} {currency}
- Fecha de vencimiento original: {dueDate}
- Das en perodo de gracia: {graceDays}
- Das restantes de gracia: {remainingGraceDays}

 ESTADO ACTUAL:
- Estado: Perodo de Gracia Vencido
- Notificacin enviada al cliente: 
- Plantilla utilizada: Notificacin de Servicio Vencido
- Riesgo de suspensin: ALTO

 ACCIONES INMEDIATAS:
1. Contactar al cliente por telfono
2. Enviar recordatorio personalizado
3. Evaluar opciones de pago flexibles
4. Preparar suspensin si no hay respuesta

 IMPACTO:
- Ingresos en riesgo: {amount} {currency}
- Tiempo de mora: {daysOverdue} das
- Historial de pagos: {paymentHistory}

 PRXIMOS PASOS:
- Si no se paga en {remainingGraceDays} das: Suspender servicio
- Seguimiento diario hasta resolucin
- Documentar todas las comunicaciones

Este es un mensaje automtico de {companyName}.

{companyName}`},adminVencido:{name:"Alerta Admin: Servicio Vencido",subject:"INMEDIATO: Servicio vencido - {clientName}",body:`Estimado/a Administrador,

 ALERTA INMEDIATA - Servicio vencido:

 INFORMACIN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto vencido: {amount} {currency}
- Fecha de vencimiento: {dueDate}
- Das de atraso: {daysOverdue}
- Ciclo de facturacin: {billingCycle}

 ESTADO ACTUAL:
- Estado: Vencido
- Notificacin enviada al cliente: 
- Plantilla utilizada: Notificacin de Servicio Vencido
- Prximo paso: Perodo de gracia

 ACCIONES REQUERIDAS:
1. Verificar recepcin de notificacin por cliente
2. Iniciar perodo de gracia ({gracePeriod} das)
3. Contacto directo con el cliente
4. Evaluar historial de pagos del cliente
5. Preparar estrategia de cobro

 ANLISIS:
- Cliente desde: {clientSince}
- Pagos anteriores: {previousPayments}
- Patrn de pago: {paymentPattern}
- Riesgo de prdida: {riskLevel}

 CONTACTOS:
- Telfono: {clientPhone}
- Email: {clientEmail}
- ltima comunicacin: {lastContact}

Este es un mensaje automtico de {companyName}.

{companyName}`},adminSuspendido:{name:"Alerta Admin: Servicio Suspendido",subject:"SUSPENDIDO: Servicio cancelado por falta de pago - {clientName}",body:`Estimado/a Administrador,

 SERVICIO SUSPENDIDO - Accin requerida:

 INFORMACIN DEL SERVICIO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Tipo: {serviceType}
- Monto pendiente: {amount} {currency}
- Fecha de vencimiento: {dueDate}
- Das de atraso: {daysOverdue}
- Perodo de gracia agotado: {gracePeriod} das

 ESTADO ACTUAL:
- Estado: Cancelado
- Motivo: Falta de pago
- Notificacin enviada al cliente: 
- Plantilla utilizada: Aviso de Suspensin de Servicio
- Fecha de suspensin: {suspensionDate}

 ACCIONES INMEDIATAS:
1. Suspender acceso del cliente al servicio
2. Documentar suspensin en el sistema
3. Enviar notificacin de suspensin
4. Iniciar proceso de recuperacin de cobros
5. Evaluar reactivacin futura

 ANLISIS FINANCIERO:
- Prdida de ingresos: {amount} {currency}
- Costo de reactivacin: {reactivationCost}
- Valor del cliente: {clientValue}
- Probabilidad de recuperacin: {recoveryProbability}%

 SEGUIMIENTO:
- Contactar para negociacin de pago
- Ofrecer planes de pago flexibles
- Documentar todas las comunicaciones
- Evaluar cancelacin definitiva

 DOCUMENTACIN:
- Historial de pagos: {paymentHistory}
- Comunicaciones previas: {communicationHistory}
- Trminos del servicio: {serviceTerms}
- Poltica de suspensin: {suspensionPolicy}

Este es un mensaje automtico de {companyName}.

{companyName}`},adminPagoRecibido:{name:"Notificacin Admin: Pago Recibido",subject:"CONFIRMADO: Pago recibido - {clientName}",body:`Estimado/a Administrador,

 PAGO CONFIRMADO - Servicio reactivado:

 INFORMACIN DEL PAGO:
- Cliente: {clientName} ({clientEmail})
- Servicio: {description}
- Monto recibido: {amount} {currency}
- Fecha de pago: {paymentDate}
- Mtodo de pago: {paymentMethod}
- Referencia: {paymentReference}

 ESTADO ACTUAL:
- Estado: Activo
- Servicio reactivado: 
- Notificacin enviada al cliente: 
- Plantilla utilizada: Confirmacin de Pago Recibido
- Prximo vencimiento: {nextDueDate}

 ACCIONES COMPLETADAS:
1. Pago procesado y verificado
2. Servicio reactivado automticamente
3. Cliente notificado del pago
4. Prxima fecha de vencimiento actualizada
5. Historial de pagos actualizado

 IMPACTO POSITIVO:
- Ingresos recuperados: {amount} {currency}
- Cliente retenido: 
- Servicio activo: 
- Prximo ciclo iniciado

 ESTADSTICAS:
- Tiempo de pago: {paymentTime} das
- Eficiencia de cobro: {collectionEfficiency}%
- Satisfaccin del cliente: {clientSatisfaction}
- Ingresos mensuales: {monthlyRevenue}

 SEGUIMIENTO:
- Monitorear estabilidad del servicio
- Preparar prximo recordatorio
- Actualizar perfil del cliente
- Documentar xito de cobro

Este es un mensaje automtico de {companyName}.

{companyName}`},adminNuevoCliente:{name:"Notificacin Admin: Nuevo Cliente",subject:"NUEVO CLIENTE: {clientName} - Servicio {description}",body:`Estimado/a Administrador,

 NUEVO CLIENTE REGISTRADO:

 INFORMACIN DEL CLIENTE:
- Nombre: {clientName}
- Email: {clientEmail}
- Identificacin: {clientId}
- Telfono: {clientPhone}
- Fecha de registro: {registrationDate}

 INFORMACIN DEL SERVICIO:
- Descripcin: {description}
- Tipo: {serviceType}
- Monto: {amount} {currency}
- Ciclo de facturacin: {billingCycle}
- Fecha de vencimiento: {dueDate}
- Estado: Activo

 CONFIGURACIN:
- Servicio activado: 
- Notificacin de bienvenida enviada: 
- Plantilla utilizada: Bienvenida a Nuevo Cliente
- Portal de cliente habilitado: 
- Mtodo de pago configurado: {paymentMethod}

 ACCIONES INICIALES:
1. Verificar activacin del servicio
2. Confirmar recepcin de bienvenida
3. Programar seguimiento inicial
4. Configurar recordatorios automticos
5. Documentar preferencias del cliente

 ANLISIS:
- Valor del cliente: {clientValue}
- Potencial de crecimiento: {growthPotential}
- Segmento: {clientSegment}
- Fuente de adquisicin: {acquisitionSource}

 PRXIMOS PASOS:
- Seguimiento en 7 das
- Verificar satisfaccin inicial
- Preparar prximo recordatorio
- Monitorear uso del servicio

Este es un mensaje automtico de {companyName}.

{companyName}`}},j=H=>{i(null),T(!1),o(H.name),c(H.subject),f(H.body);const X=H.name.toLowerCase().includes("admin")||H.name.toLowerCase().includes("alerta");g(X?"admin":"client"),t("Sugerencia cargada en el editor.","success")},_=k==="all"?e:e.filter(H=>(H.category||"client")===k);ue.useEffect(()=>{const H=Ut(Be,"artifacts",Fe,"public","data","users");return Gt(An(H,ur("role","in",["admin","superadmin"])),ne=>{P(ne.docs.map(w=>({id:w.id,...w.data()})))})},[]),ue.useEffect(()=>{const H=dt(Be,"artifacts",Fe,"public","data","settings","alertSettings");return Gt(H,ne=>{ne.exists()&&D(ne.data())})},[]),ue.useEffect(()=>{const H=Ut(Be,"artifacts",Fe,"public","data","messageTemplates");return Gt(An(H,Uu("name")),ne=>{n(ne.docs.map(w=>({id:w.id,...w.data()})))})},[]),ue.useEffect(()=>{r?(o(r.name),c(r.subject),f(r.body),g(r.category||"client"),T(!0)):(o(""),c(""),f(""),g("client"),T(!1))},[r]);const F=async()=>{if(!s.trim()||!l.trim()||!u.trim()){t("Por favor, complete todos los campos de la plantilla.","error");return}const H={name:s.trim(),subject:l.trim(),body:u.trim(),category:v||"client",updatedAt:new Date},X=Ut(Be,"artifacts",Fe,"public","data","messageTemplates");try{r?(await gr(dt(X,r.id),H),t("Plantilla actualizada exitosamente.","success")):(await Sa(X,{...H,createdAt:new Date}),t("Plantilla creada exitosamente.","success")),i(null)}catch(ne){console.error("Error saving template:",ne),t("Error al guardar la plantilla.","error")}},A=async H=>{if(window.confirm("Seguro que quieres eliminar esta plantilla?"))try{await vl(dt(Be,"artifacts",Fe,"public","data","messageTemplates",H)),t("Plantilla eliminada.","success"),i(null)}catch(X){console.error("Error deleting template:",X),t("Error al eliminar la plantilla.","error")}},L=()=>{i(null),T(!1),o(""),c(""),f(""),g("client")},E=H=>{i(H),T(!0)},M=(H,X,ne)=>{D(w=>({...w,[H]:{...w[H],[X]:ne}}))},G=(H,X,ne)=>{D(w=>({...w,[H]:{...w[H],selectedAdmins:ne?[...w[H].selectedAdmins,X]:w[H].selectedAdmins.filter(S=>S!==X)}}))},K=async()=>{try{const H=dt(Be,"artifacts",Fe,"public","data","settings","alertSettings");await ws(H,R,{merge:!0}),t("Configuracin de alertas guardada exitosamente.","success")}catch(H){console.error("Error saving alert settings:",H),t("Error al guardar la configuracin de alertas.","error")}},z=["{clientName}","{serviceType}","{description}","{amount}","{currency}","{dueDate}","{companyName}","{billingCycle}","{clientEmail}"],q=["{clientName}","{clientEmail}","{clientPhone}","{clientId}","{serviceType}","{description}","{amount}","{currency}","{dueDate}","{billingCycle}","{companyName}","{daysRemaining}","{daysOverdue}","{graceDays}","{remainingGraceDays}","{totalPending}","{potentialRevenue}","{paymentHistory}","{clientSince}","{previousPayments}","{paymentPattern}","{riskLevel}","{lastContact}","{suspensionDate}","{reactivationCost}","{clientValue}","{recoveryProbability}","{paymentDate}","{paymentMethod}","{paymentReference}","{nextDueDate}","{paymentTime}","{collectionEfficiency}","{clientSatisfaction}","{monthlyRevenue}","{registrationDate}","{growthPotential}","{clientSegment}","{acquisitionSource}","{gracePeriod}","{communicationHistory}","{serviceTerms}","{suspensionPolicy}","{loginUrl}","{clientPortalUrl}"];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Plantillas y Alertas"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Gestiona las plantillas de correo y configura alertas automticas"})]}),a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-8",children:[a.jsxs("button",{onClick:()=>le("templates"),className:`py-2 px-1 border-b-2 font-medium text-sm ${Z==="templates"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(lA,{}),a.jsx("span",{className:"ml-2",children:"Plantillas"})]}),a.jsxs("button",{onClick:()=>le("alerts"),className:`py-2 px-1 border-b-2 font-medium text-sm ${Z==="alerts"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(h8,{}),a.jsx("span",{className:"ml-2",children:"Alertas Automticas"})]})]})})}),Z==="templates"&&a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Plantillas Guardadas"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Haz clic para editar una plantilla"}),a.jsx("div",{className:"mt-3",children:a.jsxs("select",{value:k,onChange:H=>C(H.target.value),className:"w-full p-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"all",children:"Todas las plantillas"}),a.jsx("option",{value:"client",children:"Plantillas para Clientes"}),a.jsx("option",{value:"admin",children:"Plantillas para Administradores"})]})})]}),a.jsx("div",{className:"max-h-80 overflow-y-auto",children:_.length===0?a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx("p",{children:"No hay plantillas guardadas"}),a.jsx("p",{className:"text-sm",children:"Crea tu primera plantilla"})]}):_.map(H=>a.jsx("div",{className:"p-4 border-b hover:bg-gray-50 transition-colors",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h4",{className:"font-medium text-gray-900 truncate",children:H.name}),a.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${(H.category||"client")==="client"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:(H.category||"client")==="client"?"Cliente":"Admin"})]}),a.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:H.subject}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:H.createdAt?new Date(H.createdAt.seconds*1e3).toLocaleDateString():"Sin fecha"})]}),a.jsxs("div",{className:"flex space-x-2 ml-2",children:[a.jsx("button",{onClick:()=>E(H),className:"text-blue-600 hover:text-blue-800 p-1",title:"Editar plantilla",children:a.jsx(d8,{})}),a.jsx("button",{onClick:()=>A(H.id),className:"text-red-600 hover:text-red-800 p-1",title:"Eliminar plantilla",children:a.jsx(oA,{})})]})]})},H.id))}),a.jsx("div",{className:"p-4",children:a.jsxs("button",{onClick:L,className:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(Vh,{}),a.jsx("span",{className:"ml-2",children:"Nueva Plantilla"})]})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Plantillas para Clientes"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Mensajes dirigidos a los clientes"})]}),a.jsxs("div",{className:"p-4 space-y-2",children:[a.jsxs("button",{onClick:()=>j(U.preVencimiento),className:"w-full text-left p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-blue-900",children:"Aviso de Prximo Vencimiento"}),a.jsx("div",{className:"text-sm text-blue-700",children:"Recordatorio antes del vencimiento"})]}),a.jsxs("button",{onClick:()=>j(U.vencido),className:"w-full text-left p-3 bg-yellow-50 hover:bg-yellow-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-yellow-900",children:"Servicio Vencido"}),a.jsx("div",{className:"text-sm text-yellow-700",children:"Notificacin de perodo de gracia"})]}),a.jsxs("button",{onClick:()=>j(U.suspendido),className:"w-full text-left p-3 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-red-900",children:"Aviso de Suspensin"}),a.jsx("div",{className:"text-sm text-red-700",children:"Servicio suspendido por falta de pago"})]}),a.jsxs("button",{onClick:()=>j(U.pagoRecibido),className:"w-full text-left p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-green-900",children:"Confirmacin de Pago"}),a.jsx("div",{className:"text-sm text-green-700",children:"Confirmacin de pago recibido"})]}),a.jsxs("button",{onClick:()=>j(U.bienvenida),className:"w-full text-left p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-purple-900",children:"Bienvenida"}),a.jsx("div",{className:"text-sm text-purple-700",children:"Mensaje de bienvenida a nuevos clientes"})]}),a.jsxs("button",{onClick:()=>j(U.nuevoUsuario),className:"w-full text-left p-3 bg-indigo-50 hover:bg-indigo-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-indigo-900",children:"Nuevo Usuario"}),a.jsx("div",{className:"text-sm text-indigo-700",children:"Bienvenida con instrucciones para crear contrasea"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-4 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Plantillas para Administradores"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Alertas y notificaciones internas"})]}),a.jsxs("div",{className:"p-4 space-y-2",children:[a.jsxs("button",{onClick:()=>j(U.adminPreVencimiento),className:"w-full text-left p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-blue-900",children:" Alerta: Prximo Vencimiento"}),a.jsx("div",{className:"text-sm text-blue-700",children:"Notificacin interna de servicios prximos a vencer"})]}),a.jsxs("button",{onClick:()=>j(U.adminPeriodoGracia),className:"w-full text-left p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-orange-900",children:" Alerta: Perodo de Gracia"}),a.jsx("div",{className:"text-sm text-orange-700",children:"Alerta urgente de servicios en perodo de gracia"})]}),a.jsxs("button",{onClick:()=>j(U.adminVencido),className:"w-full text-left p-3 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-red-900",children:" Alerta: Servicio Vencido"}),a.jsx("div",{className:"text-sm text-red-700",children:"Notificacin inmediata de servicios vencidos"})]}),a.jsxs("button",{onClick:()=>j(U.adminSuspendido),className:"w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-gray-900",children:" Alerta: Servicio Suspendido"}),a.jsx("div",{className:"text-sm text-gray-700",children:"Notificacin de servicios cancelados por falta de pago"})]}),a.jsxs("button",{onClick:()=>j(U.adminPagoRecibido),className:"w-full text-left p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-green-900",children:" Notificacin: Pago Recibido"}),a.jsx("div",{className:"text-sm text-green-700",children:"Confirmacin interna de pagos procesados"})]}),a.jsxs("button",{onClick:()=>j(U.adminNuevoCliente),className:"w-full text-left p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"font-medium text-purple-900",children:" Notificacin: Nuevo Cliente"}),a.jsx("div",{className:"text-sm text-purple-700",children:"Alerta de nuevos clientes registrados"})]})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Variables para Clientes"}),a.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[a.jsx("p",{className:"font-medium",children:"Informacin bsica:"}),a.jsx("p",{children:z.slice(0,3).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Informacin del servicio:"}),a.jsx("p",{children:z.slice(3,6).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Informacin adicional:"}),a.jsx("p",{children:z.slice(6).join(", ")})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Variables para Administradores"}),a.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[a.jsx("p",{className:"font-medium",children:"Informacin del cliente:"}),a.jsx("p",{children:q.slice(0,4).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Informacin del servicio:"}),a.jsx("p",{children:q.slice(4,11).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Fechas y tiempos:"}),a.jsx("p",{children:q.slice(11,15).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Estadsticas:"}),a.jsx("p",{children:q.slice(15,19).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Anlisis de riesgo:"}),a.jsx("p",{children:q.slice(19,23).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Informacin de pago:"}),a.jsx("p",{children:q.slice(23,27).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Mtricas de rendimiento:"}),a.jsx("p",{children:q.slice(27,31).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Informacin de registro:"}),a.jsx("p",{children:q.slice(31,35).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"Configuracin:"}),a.jsx("p",{children:q.slice(35,37).join(", ")}),a.jsx("p",{className:"font-medium mt-2",children:"URLs del sistema:"}),a.jsx("p",{children:q.slice(37).join(", ")})]})]})]}),a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-6 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:p?"Editando Plantilla":"Nueva Plantilla"}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:p?"Modifica los campos de la plantilla":"Completa los campos para crear una nueva plantilla"})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de la Plantilla"}),a.jsx("input",{type:"text",value:s,onChange:H=>o(H.target.value),placeholder:"Ej: Primer Recordatorio de Pago",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categora"}),a.jsxs("select",{value:v,onChange:H=>g(H.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"client",children:"Plantilla para Clientes"}),a.jsx("option",{value:"admin",children:"Plantilla para Administradores"})]}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Selecciona si esta plantilla es para enviar a clientes o a administradores"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Asunto del Correo"}),a.jsx("input",{type:"text",value:l,onChange:H=>c(H.target.value),placeholder:"Ej: Recordatorio de Renovacin: {description}",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cuerpo del Mensaje"}),a.jsx("textarea",{value:u,onChange:H=>f(H.target.value),placeholder:"Escribe el contenido del mensaje aqu...",rows:"12",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm"})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{onClick:L,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Limpiar"}),a.jsx("button",{onClick:F,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:p?"Guardar Cambios":"Crear Plantilla"})]})]})]})})]}),Z==="alerts"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-6 border-b",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-3"}),"Alerta de Prximo Vencimiento"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Notificaciones antes del vencimiento del servicio"})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Activar alerta"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Enviar notificaciones antes del vencimiento"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:R.preVencimiento.enabled,onChange:H=>M("preVencimiento","enabled",H.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),R.preVencimiento.enabled&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Das antes del vencimiento"}),a.jsx("input",{type:"number",min:"1",max:"30",value:R.preVencimiento.days,onChange:H=>M("preVencimiento","days",parseInt(H.target.value)),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para cliente"}),a.jsxs("select",{value:R.preVencimiento.clientTemplate,onChange:H=>M("preVencimiento","clientTemplate",H.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),e.map(H=>a.jsx("option",{value:H.id,children:H.name},H.id))]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notificar administradores"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Enviar copia a administradores seleccionados"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:R.preVencimiento.notifyAdmins,onChange:H=>M("preVencimiento","notifyAdmins",H.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),R.preVencimiento.notifyAdmins&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para administradores"}),a.jsxs("select",{value:R.preVencimiento.adminTemplate,onChange:H=>M("preVencimiento","adminTemplate",H.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),e.map(H=>a.jsx("option",{value:H.id,children:H.name},H.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Administradores a notificar"}),a.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-3",children:b.map(H=>a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:R.preVencimiento.selectedAdmins.includes(H.id),onChange:X=>G("preVencimiento",H.id,X.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("span",{className:"text-sm text-gray-700",children:[H.fullName," (",H.email,")"]})]},H.id))})]})]})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-6 border-b",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full mr-3"}),"Perodo de Gracia"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Notificaciones durante el perodo de gracia despus del vencimiento"})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Activar perodo de gracia"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Tiempo adicional para pagar antes de suspender"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:R.periodoGracia.enabled,onChange:H=>M("periodoGracia","enabled",H.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),R.periodoGracia.enabled&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Das de gracia"}),a.jsx("input",{type:"number",min:"1",max:"30",value:R.periodoGracia.days,onChange:H=>M("periodoGracia","days",parseInt(H.target.value)),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para cliente"}),a.jsxs("select",{value:R.periodoGracia.clientTemplate,onChange:H=>M("periodoGracia","clientTemplate",H.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),e.map(H=>a.jsx("option",{value:H.id,children:H.name},H.id))]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notificar administradores"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Enviar copia a administradores seleccionados"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:R.periodoGracia.notifyAdmins,onChange:H=>M("periodoGracia","notifyAdmins",H.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),R.periodoGracia.notifyAdmins&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para administradores"}),a.jsxs("select",{value:R.periodoGracia.adminTemplate,onChange:H=>M("periodoGracia","adminTemplate",H.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),e.map(H=>a.jsx("option",{value:H.id,children:H.name},H.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Administradores a notificar"}),a.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-3",children:b.map(H=>a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:R.periodoGracia.selectedAdmins.includes(H.id),onChange:X=>G("periodoGracia",H.id,X.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("span",{className:"text-sm text-gray-700",children:[H.fullName," (",H.email,")"]})]},H.id))})]})]})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsxs("div",{className:"p-6 border-b",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-3"}),"Servicio Vencido"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Notificaciones cuando el servicio ha vencido"})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Activar alerta"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Enviar notificaciones cuando el servicio vence"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:R.vencido.enabled,onChange:H=>M("vencido","enabled",H.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),R.vencido.enabled&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para cliente"}),a.jsxs("select",{value:R.vencido.clientTemplate,onChange:H=>M("vencido","clientTemplate",H.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),e.map(H=>a.jsx("option",{value:H.id,children:H.name},H.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plantilla para administradores"}),a.jsxs("select",{value:R.vencido.adminTemplate,onChange:H=>M("vencido","adminTemplate",H.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Seleccionar plantilla"}),e.map(H=>a.jsx("option",{value:H.id,children:H.name},H.id))]})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notificar administradores"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Enviar copia a administradores seleccionados"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:R.vencido.notifyAdmins,onChange:H=>M("vencido","notifyAdmins",H.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),R.vencido.notifyAdmins&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Administradores a notificar"}),a.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-3",children:b.map(H=>a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:R.vencido.selectedAdmins.includes(H.id),onChange:X=>G("vencido",H.id,X.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("span",{className:"text-sm text-gray-700",children:[H.fullName," (",H.email,")"]})]},H.id))})]})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{onClick:K,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center",children:[a.jsx(Zp,{}),a.jsx("span",{className:"ml-2",children:"Guardar Configuracin de Alertas"})]})})]})]})}function hA(){const{addNotification:t}=pn(),[e,n]=ue.useState({bold:{enabled:!1,apiKey:"",environment:"sandbox",webhookSecret:"",autoApprove:!1},paypal:{enabled:!1,clientId:"",clientSecret:"",environment:"sandbox",autoApprove:!1},payu:{enabled:!1,merchantId:"",apiKey:"",apiLogin:"",environment:"sandbox",autoApprove:!1},bankTransfer:{enabled:!1,accounts:[],autoApprove:!1,requireConfirmation:!0},general:{currency:"USD",defaultGateway:"bold"}}),[r,i]=ue.useState(!1);ue.useEffect(()=>{const g=dt(Be,"artifacts",Fe,"public","data","settings","paymentConfig"),p=Gt(g,T=>{T.exists()&&n(T.data())});return()=>p()},[]);const s=(g,p,T)=>{n(k=>({...k,[g]:{...k[g],[p]:T}}))},o=(g,p)=>{n(T=>({...T,general:{...T.general,[g]:p}}))},l=()=>{const g={id:Date.now().toString(),bankName:"",accountNumber:"",accountHolder:"",accountType:"Ahorros"};n(p=>({...p,bankTransfer:{...p.bankTransfer,accounts:[...p.bankTransfer.accounts,g]}}))},c=(g,p,T)=>{n(k=>({...k,bankTransfer:{...k.bankTransfer,accounts:k.bankTransfer.accounts.map(C=>C.id===g?{...C,[p]:T}:C)}}))},u=g=>{n(p=>({...p,bankTransfer:{...p.bankTransfer,accounts:p.bankTransfer.accounts.filter(T=>T.id!==g)}}))},f=async()=>{i(!0);try{const g=dt(Be,"artifacts",Fe,"public","data","settings","paymentConfig");await ws(g,e),t("Configuracin de pagos guardada exitosamente","success")}catch(g){console.error("Error saving payment config:",g),t("Error al guardar la configuracin","error")}i(!1)},v=(g,p,T)=>a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[a.jsx(Ji,{}),p]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:e[g].enabled,onChange:k=>s(g,"enabled",k.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Habilitado"})]})]}),e[g].enabled&&a.jsxs("div",{className:"space-y-4",children:[T.map(k=>a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:k.label}),k.type==="select"?a.jsx("select",{value:e[g][k.name],onChange:C=>s(g,k.name,C.target.value),className:"w-full p-2 border rounded-md",children:k.options.map(C=>a.jsx("option",{value:C.value,children:C.label},C.value))}):a.jsx("input",{type:k.type,value:e[g][k.name],onChange:C=>s(g,k.name,C.target.value),placeholder:k.placeholder,className:"w-full p-2 border rounded-md"}),k.help&&a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:k.help})]},k.name)),a.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-md",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:e[g].autoApprove,onChange:k=>s(g,"autoApprove",k.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Aprobar pagos automticamente"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Los pagos de esta pasarela se marcarn como "Completado" automticamente'})]})]})]});return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(Zp,{}),"Configuracin de Pagos"]}),a.jsx("button",{onClick:f,disabled:r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:r?"Guardando...":"Guardar Configuracin"})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuracin General"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Moneda por Defecto"}),a.jsxs("select",{value:e.general.currency,onChange:g=>o("currency",g.target.value),className:"w-full p-2 border rounded-md",children:[a.jsx("option",{value:"USD",children:"USD - Dlar Americano"}),a.jsx("option",{value:"COP",children:"COP - Peso Colombiano"}),a.jsx("option",{value:"EUR",children:"EUR - Euro"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pasarela por Defecto"}),a.jsxs("select",{value:e.general.defaultGateway,onChange:g=>o("defaultGateway",g.target.value),className:"w-full p-2 border rounded-md",children:[a.jsx("option",{value:"bold",children:"Bold"}),a.jsx("option",{value:"paypal",children:"PayPal"}),a.jsx("option",{value:"payu",children:"PayU"}),a.jsx("option",{value:"bankTransfer",children:"Transferencia Bancaria"})]})]})]}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Cada pasarela tiene su propia configuracin de auto-aprobacin independiente."})]}),v("bold","Bold",[{name:"apiKey",label:"API Key",type:"password",placeholder:"Ingresa tu API Key de Bold"},{name:"environment",label:"Ambiente",type:"select",options:[{value:"sandbox",label:"Sandbox (Pruebas)"},{value:"production",label:"Produccin"}]},{name:"webhookSecret",label:"Webhook Secret",type:"password",placeholder:"Secreto para webhooks"}]),v("paypal","PayPal",[{name:"clientId",label:"Client ID",type:"text",placeholder:"Ingresa tu Client ID de PayPal"},{name:"clientSecret",label:"Client Secret",type:"password",placeholder:"Ingresa tu Client Secret"},{name:"environment",label:"Ambiente",type:"select",options:[{value:"sandbox",label:"Sandbox (Pruebas)"},{value:"live",label:"Live (Produccin)"}]}]),v("payu","PayU",[{name:"merchantId",label:"Merchant ID",type:"text",placeholder:"ID del comerciante"},{name:"apiKey",label:"API Key",type:"password",placeholder:"API Key de PayU"},{name:"apiLogin",label:"API Login",type:"text",placeholder:"API Login de PayU"},{name:"environment",label:"Ambiente",type:"select",options:[{value:"sandbox",label:"Sandbox (Pruebas)"},{value:"production",label:"Produccin"}]}]),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[a.jsx(Ji,{}),"Transferencias Bancarias"]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:e.bankTransfer.enabled,onChange:g=>s("bankTransfer","enabled",g.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Habilitado"})]})]}),e.bankTransfer.enabled&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"p-3 bg-gray-50 rounded-md",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:e.bankTransfer.autoApprove,onChange:g=>s("bankTransfer","autoApprove",g.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Aprobar transferencias automticamente"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Las transferencias se marcarn como "Completado" automticamente'})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h4",{className:"text-md font-medium text-gray-800",children:"Cuentas Bancarias"}),a.jsx("button",{onClick:l,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700",children:"+ Agregar Cuenta"})]}),a.jsx("div",{className:"space-y-4",children:e.bankTransfer.accounts.map((g,p)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h5",{className:"font-medium text-gray-700",children:["Cuenta ",p+1]}),a.jsx("button",{onClick:()=>u(g.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Eliminar"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Banco"}),a.jsx("input",{type:"text",value:g.bankName,onChange:T=>c(g.id,"bankName",T.target.value),placeholder:"Ej: Banco Nacional",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nmero de Cuenta"}),a.jsx("input",{type:"text",value:g.accountNumber,onChange:T=>c(g.id,"accountNumber",T.target.value),placeholder:"1234567890",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titular de la Cuenta"}),a.jsx("input",{type:"text",value:g.accountHolder,onChange:T=>c(g.id,"accountHolder",T.target.value),placeholder:"Nombre del titular",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Cuenta"}),a.jsxs("select",{value:g.accountType,onChange:T=>c(g.id,"accountType",T.target.value),className:"w-full p-2 border rounded-md",children:[a.jsx("option",{value:"Ahorros",children:"Ahorros"}),a.jsx("option",{value:"Corriente",children:"Corriente"})]})]})]})]},g.id))}),e.bankTransfer.accounts.length===0&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("p",{children:"No hay cuentas bancarias configuradas"}),a.jsx("p",{className:"text-sm",children:'Haz clic en "Agregar Cuenta" para comenzar'})]})]})]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:" Informacin Importante"}),a.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[a.jsx("li",{children:" Las credenciales se almacenan de forma segura en Firestore"}),a.jsx("li",{children:" Siempre prueba en modo sandbox antes de usar en produccin"}),a.jsx("li",{children:" Mantn tus claves API seguras y no las compartas"}),a.jsx("li",{children:" Los webhooks deben configurarse en cada pasarela de pago"})]})]})]})}function j8(){const{addNotification:t}=pn(),[e,n]=ue.useState({renewalSettings:{enabled:!0,maxRenewalYears:3,autoRenewal:!0,gracePeriodDays:7,reminderDays:3},discounts:{monthly:{enabled:!1,discount:0,description:"Descuento por pago mensual"},quarterly:{enabled:!1,discount:5,description:"Descuento por pago trimestral"},semiAnnual:{enabled:!1,discount:10,description:"Descuento por pago semestral"},annual:{enabled:!1,discount:15,description:"Descuento por pago anual"},biennial:{enabled:!1,discount:25,description:"Descuento por pago bienal (2 aos)"},triennial:{enabled:!1,discount:35,description:"Descuento por pago trienal (3 aos)"}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"},documentSettings:{invoiceName:"Factura",receiptName:"Remisin",invoicePrefix:"FAC",receiptPrefix:"REM",invoiceNumberFormat:"FAC-{year}-{month}-{number}",receiptNumberFormat:"REM-{year}-{month}-{number}"},pricingSettings:{roundToNearest:100,minimumAmount:1e3,maximumAmount:1e7}}),[r,i]=ue.useState(!1);ue.useEffect(()=>{const g=dt(Be,"artifacts",Fe,"public","data","settings","renewalConfig"),p=Gt(g,T=>{T.exists()&&n(T.data())});return()=>p()},[]);const s=(g,p,T)=>{n(k=>({...k,[g]:{...k[g],[p]:T}}))},o=(g,p,T)=>{n(k=>({...k,discounts:{...k.discounts,[g]:{...k.discounts[g],[p]:T}}}))},l=async()=>{i(!0);try{const g=dt(Be,"artifacts",Fe,"public","data","settings","renewalConfig");await ws(g,e),t("Configuracin de renovaciones guardada exitosamente","success")}catch(g){console.error("Error saving renewal config:",g),t("Error al guardar la configuracin","error")}i(!1)},c=(g,p)=>{const T=e.discounts[p];if(!T.enabled)return g;const k=g*T.discount/100,C=g-k,b=Math.round(C/e.pricingSettings.roundToNearest)*e.pricingSettings.roundToNearest;return Math.max(b,e.pricingSettings.minimumAmount)},u=g=>{if(!e.taxSettings.ivaEnabled||e.taxSettings.ivaIncluded)return g;{const p=g*e.taxSettings.ivaPercentage/100;return g+p}},f=g=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(g),v=[{key:"monthly",label:"Mensual",months:1},{key:"quarterly",label:"Trimestral",months:3},{key:"semiAnnual",label:"Semestral",months:6},{key:"annual",label:"Anual",months:12},{key:"biennial",label:"Bienal (2 aos)",months:24},{key:"triennial",label:"Trienal (3 aos)",months:36}];return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(ul,{}),"Configuracin de Renovaciones"]}),a.jsx("button",{onClick:l,disabled:r,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:r?"Guardando...":"Guardar Configuracin"})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(Zp,{}),"Configuracin General"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx("div",{children:a.jsxs("label",{className:"flex items-center mb-2",children:[a.jsx("input",{type:"checkbox",checked:e.renewalSettings.enabled,onChange:g=>s("renewalSettings","enabled",g.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Habilitar renovaciones automticas"})]})}),a.jsx("div",{children:a.jsxs("label",{className:"flex items-center mb-2",children:[a.jsx("input",{type:"checkbox",checked:e.renewalSettings.autoRenewal,onChange:g=>s("renewalSettings","autoRenewal",g.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Renovacin automtica"})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mximo de aos para renovacin"}),a.jsxs("select",{value:e.renewalSettings.maxRenewalYears,onChange:g=>s("renewalSettings","maxRenewalYears",parseInt(g.target.value)),className:"w-full p-2 border rounded-md",children:[a.jsx("option",{value:1,children:"1 ao"}),a.jsx("option",{value:2,children:"2 aos"}),a.jsx("option",{value:3,children:"3 aos"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Das de gracia"}),a.jsx("input",{type:"number",value:e.renewalSettings.gracePeriodDays,onChange:g=>s("renewalSettings","gracePeriodDays",parseInt(g.target.value)),className:"w-full p-2 border rounded-md",min:"0",max:"30"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Das de recordatorio"}),a.jsx("input",{type:"number",value:e.renewalSettings.reminderDays,onChange:g=>s("renewalSettings","reminderDays",parseInt(g.target.value)),className:"w-full p-2 border rounded-md",min:"1",max:"30"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(uA,{}),"Descuentos por Perodo de Renovacin"]}),a.jsx("div",{className:"space-y-4",children:v.map(g=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h4",{className:"font-medium text-gray-800",children:g.label}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:e.discounts[g.key].enabled,onChange:p=>o(g.key,"enabled",p.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Habilitado"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descuento (%)"}),a.jsx("input",{type:"number",value:e.discounts[g.key].discount,onChange:p=>o(g.key,"discount",parseFloat(p.target.value)),className:"w-full p-2 border rounded-md",min:"0",max:"100",step:"0.1",disabled:!e.discounts[g.key].enabled})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin"}),a.jsx("input",{type:"text",value:e.discounts[g.key].description,onChange:p=>o(g.key,"description",p.target.value),className:"w-full p-2 border rounded-md",disabled:!e.discounts[g.key].enabled})]})]}),e.discounts[g.key].enabled&&a.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-md",children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Simulacin de Precio"}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsxs("div",{children:["Precio original: ",f(1e5)]}),a.jsxs("div",{children:["Descuento (",e.discounts[g.key].discount,"%): ",f(1e5-c(1e5,g.key))]}),a.jsxs("div",{className:"font-semibold text-green-600",children:["Precio final: ",f(c(1e5,g.key))]})]})]})]},g.key))})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(Ji,{}),"Configuracin de Impuestos"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx("div",{children:a.jsxs("label",{className:"flex items-center mb-2",children:[a.jsx("input",{type:"checkbox",checked:e.taxSettings.ivaEnabled,onChange:g=>s("taxSettings","ivaEnabled",g.target.checked),className:"mr-2"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Habilitar IVA"})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Porcentaje de IVA (%)"}),a.jsx("input",{type:"number",value:e.taxSettings.ivaPercentage,onChange:g=>s("taxSettings","ivaPercentage",parseFloat(g.target.value)),className:"w-full p-2 border rounded-md",min:"0",max:"100",step:"0.1",disabled:!e.taxSettings.ivaEnabled})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de IVA"}),a.jsxs("select",{value:e.taxSettings.ivaIncluded?"included":"excluded",onChange:g=>s("taxSettings","ivaIncluded",g.target.value==="included"),className:"w-full p-2 border rounded-md",disabled:!e.taxSettings.ivaEnabled,children:[a.jsx("option",{value:"excluded",children:"IVA se suma al precio"}),a.jsx("option",{value:"included",children:"IVA incluido en el precio"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del impuesto"}),a.jsx("input",{type:"text",value:e.taxSettings.taxName,onChange:g=>s("taxSettings","taxName",g.target.value),className:"w-full p-2 border rounded-md",disabled:!e.taxSettings.ivaEnabled})]})]}),e.taxSettings.ivaEnabled&&a.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Simulacin de Impuestos"}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsxs("div",{children:["Precio base: ",f(1e5)]}),!e.taxSettings.ivaIncluded&&a.jsxs("div",{children:["IVA (",e.taxSettings.ivaPercentage,"%): ",f(1e5*e.taxSettings.ivaPercentage/100)]}),a.jsxs("div",{className:"font-semibold text-blue-600",children:["Precio final: ",f(u(1e5))]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuracin de Documentos"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de Factura"}),a.jsx("input",{type:"text",value:e.documentSettings.invoiceName,onChange:g=>s("documentSettings","invoiceName",g.target.value),className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de Remisin"}),a.jsx("input",{type:"text",value:e.documentSettings.receiptName,onChange:g=>s("documentSettings","receiptName",g.target.value),className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prefijo de Factura"}),a.jsx("input",{type:"text",value:e.documentSettings.invoicePrefix,onChange:g=>s("documentSettings","invoicePrefix",g.target.value),className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prefijo de Remisin"}),a.jsx("input",{type:"text",value:e.documentSettings.receiptPrefix,onChange:g=>s("documentSettings","receiptPrefix",g.target.value),className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Formato de Nmero de Factura"}),a.jsx("input",{type:"text",value:e.documentSettings.invoiceNumberFormat,onChange:g=>s("documentSettings","invoiceNumberFormat",g.target.value),className:"w-full p-2 border rounded-md",placeholder:"FAC-{year}-{month}-{number}"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables disponibles: ","{year}",", ","{month}",", ","{number}"]})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Formato de Nmero de Remisin"}),a.jsx("input",{type:"text",value:e.documentSettings.receiptNumberFormat,onChange:g=>s("documentSettings","receiptNumberFormat",g.target.value),className:"w-full p-2 border rounded-md",placeholder:"REM-{year}-{month}-{number}"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables disponibles: ","{year}",", ","{month}",", ","{number}"]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Configuracin de Precios"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Redondear al mltiplo ms cercano"}),a.jsx("input",{type:"number",value:e.pricingSettings.roundToNearest,onChange:g=>s("pricingSettings","roundToNearest",parseInt(g.target.value)),className:"w-full p-2 border rounded-md",min:"1"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ej: 100 para redondear a centenas"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto mnimo"}),a.jsx("input",{type:"number",value:e.pricingSettings.minimumAmount,onChange:g=>s("pricingSettings","minimumAmount",parseInt(g.target.value)),className:"w-full p-2 border rounded-md",min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto mximo"}),a.jsx("input",{type:"number",value:e.pricingSettings.maximumAmount,onChange:g=>s("pricingSettings","maximumAmount",parseInt(g.target.value)),className:"w-full p-2 border rounded-md",min:"0"})]})]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:" Informacin Importante"}),a.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[a.jsx("li",{children:" Los descuentos se aplican automticamente segn el perodo de renovacin seleccionado"}),a.jsx("li",{children:" Los precios se redondean automticamente para evitar decimales"}),a.jsx("li",{children:" El IVA se calcula segn la configuracin establecida"}),a.jsx("li",{children:" Los nombres de documentos se pueden personalizar segn las necesidades"})]})]})]})}const C8="modulepreload",I8=function(t){return"/"+t},vw={},i0=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(c=>{if(c=I8(c),c in vw)return;vw[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const v=document.createElement("link");if(v.rel=u?"stylesheet":C8,u||(v.as="script"),v.crossOrigin="",v.href=c,l&&v.setAttribute("nonce",l),document.head.appendChild(v),u)return new Promise((g,p)=>{v.addEventListener("load",g),v.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};function hn(t){"@babel/helpers - typeof";return hn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hn(t)}var $s=Uint8Array,Qi=Uint16Array,Xy=Int32Array,Jy=new $s([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Zy=new $s([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),yw=new $s([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),fA=function(t,e){for(var n=new Qi(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var i=new Xy(n[30]),r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return{b:n,r:i}},mA=fA(Jy,2),P8=mA.b,qv=mA.r;P8[28]=258,qv[258]=28;var R8=fA(Zy,0),xw=R8.r,Hv=new Qi(32768);for(var In=0;In<32768;++In){var Uo=(In&43690)>>1|(In&21845)<<1;Uo=(Uo&52428)>>2|(Uo&13107)<<2,Uo=(Uo&61680)>>4|(Uo&3855)<<4,Hv[In]=((Uo&65280)>>8|(Uo&255)<<8)>>1}var qd=function(t,e,n){for(var r=t.length,i=0,s=new Qi(e);i<r;++i)t[i]&&++s[t[i]-1];var o=new Qi(e);for(i=1;i<e;++i)o[i]=o[i-1]+s[i-1]<<1;var l;if(n){l=new Qi(1<<e);var c=15-e;for(i=0;i<r;++i)if(t[i])for(var u=i<<4|t[i],f=e-t[i],v=o[t[i]-1]++<<f,g=v|(1<<f)-1;v<=g;++v)l[Hv[v]>>c]=u}else for(l=new Qi(r),i=0;i<r;++i)t[i]&&(l[i]=Hv[o[t[i]-1]++]>>15-t[i]);return l},gc=new $s(288);for(var In=0;In<144;++In)gc[In]=8;for(var In=144;In<256;++In)gc[In]=9;for(var In=256;In<280;++In)gc[In]=7;for(var In=280;In<288;++In)gc[In]=8;var lp=new $s(32);for(var In=0;In<32;++In)lp[In]=5;var L8=qd(gc,9,0),D8=qd(lp,5,0),pA=function(t){return(t+7)/8|0},O8=function(t,e,n){return(n==null||n>t.length)&&(n=t.length),new $s(t.subarray(e,n))},za=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8},yd=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8,t[r+2]|=n>>16},s0=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var i=n.length,s=n.slice();if(!i)return{t:vA,l:0};if(i==1){var o=new $s(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort(function(Z,le){return Z.f-le.f}),n.push({s:-1,f:25001});var l=n[0],c=n[1],u=0,f=1,v=2;for(n[0]={s:-1,f:l.f+c.f,l,r:c};f!=i-1;)l=n[n[u].f<n[v].f?u++:v++],c=n[u!=f&&n[u].f<n[v].f?u++:v++],n[f++]={s:-1,f:l.f+c.f,l,r:c};for(var g=s[0].s,r=1;r<i;++r)s[r].s>g&&(g=s[r].s);var p=new Qi(g+1),T=Wv(n[f-1],p,0);if(T>e){var r=0,k=0,C=T-e,b=1<<C;for(s.sort(function(le,U){return p[U.s]-p[le.s]||le.f-U.f});r<i;++r){var P=s[r].s;if(p[P]>e)k+=b-(1<<T-p[P]),p[P]=e;else break}for(k>>=C;k>0;){var R=s[r].s;p[R]<e?k-=1<<e-p[R]++-1:++r}for(;r>=0&&k;--r){var D=s[r].s;p[D]==e&&(--p[D],++k)}T=e}return{t:new $s(p),l:T}},Wv=function(t,e,n){return t.s==-1?Math.max(Wv(t.l,e,n+1),Wv(t.r,e,n+1)):e[t.s]=n},bw=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new Qi(++e),r=0,i=t[0],s=1,o=function(c){n[r++]=c},l=1;l<=e;++l)if(t[l]==i&&l!=e)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=t[l]}return{c:n.subarray(0,r),n:e}},xd=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},gA=function(t,e,n){var r=n.length,i=pA(e+2);t[i]=r&255,t[i+1]=r>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var s=0;s<r;++s)t[i+s+4]=n[s];return(i+4+r)*8},ww=function(t,e,n,r,i,s,o,l,c,u,f){za(e,f++,n),++i[256];for(var v=s0(i,15),g=v.t,p=v.l,T=s0(s,15),k=T.t,C=T.l,b=bw(g),P=b.c,R=b.n,D=bw(k),Z=D.c,le=D.n,U=new Qi(19),j=0;j<P.length;++j)++U[P[j]&31];for(var j=0;j<Z.length;++j)++U[Z[j]&31];for(var _=s0(U,7),F=_.t,A=_.l,L=19;L>4&&!F[yw[L-1]];--L);var E=u+5<<3,M=xd(i,gc)+xd(s,lp)+o,G=xd(i,g)+xd(s,k)+o+14+3*L+xd(U,F)+2*U[16]+3*U[17]+7*U[18];if(c>=0&&E<=M&&E<=G)return gA(e,f,t.subarray(c,c+u));var K,z,q,H;if(za(e,f,1+(G<M)),f+=2,G<M){K=qd(g,p,0),z=g,q=qd(k,C,0),H=k;var X=qd(F,A,0);za(e,f,R-257),za(e,f+5,le-1),za(e,f+10,L-4),f+=14;for(var j=0;j<L;++j)za(e,f+3*j,F[yw[j]]);f+=3*L;for(var ne=[P,Z],w=0;w<2;++w)for(var S=ne[w],j=0;j<S.length;++j){var V=S[j]&31;za(e,f,X[V]),f+=F[V],V>15&&(za(e,f,S[j]>>5&127),f+=S[j]>>12)}}else K=L8,z=gc,q=D8,H=lp;for(var j=0;j<l;++j){var ee=r[j];if(ee>255){var V=ee>>18&31;yd(e,f,K[V+257]),f+=z[V+257],V>7&&(za(e,f,ee>>23&31),f+=Jy[V]);var re=ee&31;yd(e,f,q[re]),f+=H[re],re>3&&(yd(e,f,ee>>5&8191),f+=Zy[re])}else yd(e,f,K[ee]),f+=z[ee]}return yd(e,f,K[256]),f+z[256]},M8=new Xy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),vA=new $s(0),F8=function(t,e,n,r,i,s){var o=s.z||t.length,l=new $s(r+o+5*(1+Math.ceil(o/7e3))+i),c=l.subarray(r,l.length-i),u=s.l,f=(s.r||0)&7;if(e){f&&(c[0]=s.r>>3);for(var v=M8[e-1],g=v>>13,p=v&8191,T=(1<<n)-1,k=s.p||new Qi(32768),C=s.h||new Qi(T+1),b=Math.ceil(n/3),P=2*b,R=function(be){return(t[be]^t[be+1]<<b^t[be+2]<<P)&T},D=new Xy(25e3),Z=new Qi(288),le=new Qi(32),U=0,j=0,_=s.i||0,F=0,A=s.w||0,L=0;_+2<o;++_){var E=R(_),M=_&32767,G=C[E];if(k[M]=G,C[E]=M,A<=_){var K=o-_;if((U>7e3||F>24576)&&(K>423||!u)){f=ww(t,c,0,D,Z,le,j,F,L,_-L,f),F=U=j=0,L=_;for(var z=0;z<286;++z)Z[z]=0;for(var z=0;z<30;++z)le[z]=0}var q=2,H=0,X=p,ne=M-G&32767;if(K>2&&E==R(_-ne))for(var w=Math.min(g,K)-1,S=Math.min(32767,_),V=Math.min(258,K);ne<=S&&--X&&M!=G;){if(t[_+q]==t[_+q-ne]){for(var ee=0;ee<V&&t[_+ee]==t[_+ee-ne];++ee);if(ee>q){if(q=ee,H=ne,ee>w)break;for(var re=Math.min(ne,ee-2),ce=0,z=0;z<re;++z){var he=_-ne+z&32767,me=k[he],ye=he-me&32767;ye>ce&&(ce=ye,G=he)}}}M=G,G=k[M],ne+=M-G&32767}if(H){D[F++]=268435456|qv[q]<<18|xw[H];var Ee=qv[q]&31,Pe=xw[H]&31;j+=Jy[Ee]+Zy[Pe],++Z[257+Ee],++le[Pe],A=_+q,++U}else D[F++]=t[_],++Z[t[_]]}}for(_=Math.max(_,A);_<o;++_)D[F++]=t[_],++Z[t[_]];f=ww(t,c,u,D,Z,le,j,F,L,_-L,f),u||(s.r=f&7|c[f/8|0]<<3,f-=7,s.h=C,s.p=k,s.i=_,s.w=A)}else{for(var _=s.w||0;_<o+u;_+=65535){var Re=_+65535;Re>=o&&(c[f/8|0]=u,Re=o),f=gA(c,f+1,t.subarray(_,Re))}s.i=o}return O8(l,0,r+pA(f)+i)},yA=function(){var t=1,e=0;return{p:function(n){for(var r=t,i=e,s=n.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)i+=r+=n[o];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}t=r,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},U8=function(t,e,n,r,i){if(!i&&(i={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),o=new $s(s.length+t.length);o.set(s),o.set(t,s.length),t=o,i.w=s.length}return F8(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,r,i)},xA=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},V8=function(t,e){var n=e.level,r=n==0?0:n<6?1:n==9?3:2;if(t[0]=120,t[1]=r<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=yA();i.p(e.dictionary),xA(t,2,i.d())}};function Gv(t,e){e||(e={});var n=yA();n.p(t);var r=U8(t,e,e.dictionary?6:2,4);return V8(r,e),xA(r,r.length-4,n.d()),r}var B8=typeof TextDecoder<"u"&&new TextDecoder,$8=0;try{B8.decode(vA,{stream:!0}),$8=1}catch{}function z8(t){if(Array.isArray(t))return t}function q8(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,o,l=[],c=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(c=(r=s.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(f){u=!0,i=f}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function Nw(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function H8(t,e){if(t){if(typeof t=="string")return Nw(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nw(t,e):void 0}}function W8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _w(t,e){return z8(t)||q8(t,e)||H8(t,e)||W8()}function Ew(t,e="utf8"){return new TextDecoder(e).decode(t)}const G8=new TextEncoder;function K8(t){return G8.encode(t)}const Y8=1024*8,Q8=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),a0={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class e2{constructor(e=Y8,n={}){dn(this,"buffer");dn(this,"byteLength");dn(this,"byteOffset");dn(this,"length");dn(this,"offset");dn(this,"lastWrittenByte");dn(this,"littleEndian");dn(this,"_data");dn(this,"_mark");dn(this,"_marks");let r=!1;typeof e=="number"?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);const i=n.offset?n.offset>>>0:0,s=e.byteLength-i;let o=i;(ArrayBuffer.isView(e)||e instanceof e2)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+i),e=e.buffer),r?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const r=(this.offset+e)*2,i=new Uint8Array(r);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,n){const r=a0[n].BYTES_PER_ELEMENT*e,i=this.byteOffset+this.offset,s=this.buffer.slice(i,i+r);if(this.littleEndian===Q8&&n!=="uint8"&&n!=="int8"){const l=new Uint8Array(this.buffer.slice(i,i+r));l.reverse();const c=new a0[n](l.buffer);return this.offset+=r,c.reverse(),c}const o=new a0[n](s);return this.offset+=r,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let n="";for(let r=0;r<e;r++)n+=this.readChar();return n}readUtf8(e=1){return Ew(this.readBytes(e))}decodeText(e=1,n="utf8"){return Ew(this.readBytes(e),n)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let n=0;n<e.length;n++)this._data.setUint8(this.offset++,e[n]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let n=0;n<e.length;n++)this.writeUint8(e.charCodeAt(n));return this}writeUtf8(e){return this.writeBytes(K8(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Bu(t){let e=t.length;for(;--e>=0;)t[e]=0}const X8=3,J8=258,bA=29,Z8=256,e7=Z8+1+bA,wA=30,t7=512,n7=new Array((e7+2)*2);Bu(n7);const r7=new Array(wA*2);Bu(r7);const i7=new Array(t7);Bu(i7);const s7=new Array(J8-X8+1);Bu(s7);const a7=new Array(bA);Bu(a7);const o7=new Array(wA);Bu(o7);const l7=(t,e,n,r)=>{let i=t&65535|0,s=t>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do i=i+e[r++]|0,s=s+i|0;while(--o);i%=65521,s%=65521}return i|s<<16|0};var Kv=l7;const c7=()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e},u7=new Uint32Array(c7()),d7=(t,e,n,r)=>{const i=u7,s=r+n;t^=-1;for(let o=r;o<s;o++)t=t>>>8^i[(t^e[o])&255];return t^-1};var ca=d7,Yv={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},NA={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const h7=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var f7=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)h7(n,r)&&(t[r]=n[r])}}return t},m7=t=>{let e=0;for(let r=0,i=t.length;r<i;r++)e+=t[r].length;const n=new Uint8Array(e);for(let r=0,i=0,s=t.length;r<s;r++){let o=t[r];n.set(o,i),i+=o.length}return n},_A={assign:f7,flattenChunks:m7};let EA=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{EA=!1}const xh=new Uint8Array(256);for(let t=0;t<256;t++)xh[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;xh[254]=xh[254]=1;var p7=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,n,r,i,s,o=t.length,l=0;for(i=0;i<o;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<o&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(l),s=0,i=0;s<l;i++)n=t.charCodeAt(i),(n&64512)===55296&&i+1<o&&(r=t.charCodeAt(i+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|n&63):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|n&63):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|n&63);return e};const g7=(t,e)=>{if(e<65534&&t.subarray&&EA)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n};var v7=(t,e)=>{const n=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let r,i;const s=new Array(n*2);for(i=0,r=0;r<n;){let o=t[r++];if(o<128){s[i++]=o;continue}let l=xh[o];if(l>4){s[i++]=65533,r+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&r<n;)o=o<<6|t[r++]&63,l--;if(l>1){s[i++]=65533;continue}o<65536?s[i++]=o:(o-=65536,s[i++]=55296|o>>10&1023,s[i++]=56320|o&1023)}return g7(s,i)},y7=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let n=e-1;for(;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?e:n+xh[t[n]]>e?n:e},Qv={string2buf:p7,buf2string:v7,utf8border:y7};function x7(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var b7=x7;const If=16209,w7=16191;var N7=function(e,n){let r,i,s,o,l,c,u,f,v,g,p,T,k,C,b,P,R,D,Z,le,U,j,_,F;const A=e.state;r=e.next_in,_=e.input,i=r+(e.avail_in-5),s=e.next_out,F=e.output,o=s-(n-e.avail_out),l=s+(e.avail_out-257),c=A.dmax,u=A.wsize,f=A.whave,v=A.wnext,g=A.window,p=A.hold,T=A.bits,k=A.lencode,C=A.distcode,b=(1<<A.lenbits)-1,P=(1<<A.distbits)-1;e:do{T<15&&(p+=_[r++]<<T,T+=8,p+=_[r++]<<T,T+=8),R=k[p&b];t:for(;;){if(D=R>>>24,p>>>=D,T-=D,D=R>>>16&255,D===0)F[s++]=R&65535;else if(D&16){Z=R&65535,D&=15,D&&(T<D&&(p+=_[r++]<<T,T+=8),Z+=p&(1<<D)-1,p>>>=D,T-=D),T<15&&(p+=_[r++]<<T,T+=8,p+=_[r++]<<T,T+=8),R=C[p&P];n:for(;;){if(D=R>>>24,p>>>=D,T-=D,D=R>>>16&255,D&16){if(le=R&65535,D&=15,T<D&&(p+=_[r++]<<T,T+=8,T<D&&(p+=_[r++]<<T,T+=8)),le+=p&(1<<D)-1,le>c){e.msg="invalid distance too far back",A.mode=If;break e}if(p>>>=D,T-=D,D=s-o,le>D){if(D=le-D,D>f&&A.sane){e.msg="invalid distance too far back",A.mode=If;break e}if(U=0,j=g,v===0){if(U+=u-D,D<Z){Z-=D;do F[s++]=g[U++];while(--D);U=s-le,j=F}}else if(v<D){if(U+=u+v-D,D-=v,D<Z){Z-=D;do F[s++]=g[U++];while(--D);if(U=0,v<Z){D=v,Z-=D;do F[s++]=g[U++];while(--D);U=s-le,j=F}}}else if(U+=v-D,D<Z){Z-=D;do F[s++]=g[U++];while(--D);U=s-le,j=F}for(;Z>2;)F[s++]=j[U++],F[s++]=j[U++],F[s++]=j[U++],Z-=3;Z&&(F[s++]=j[U++],Z>1&&(F[s++]=j[U++]))}else{U=s-le;do F[s++]=F[U++],F[s++]=F[U++],F[s++]=F[U++],Z-=3;while(Z>2);Z&&(F[s++]=F[U++],Z>1&&(F[s++]=F[U++]))}}else if(D&64){e.msg="invalid distance code",A.mode=If;break e}else{R=C[(R&65535)+(p&(1<<D)-1)];continue n}break}}else if(D&64)if(D&32){A.mode=w7;break e}else{e.msg="invalid literal/length code",A.mode=If;break e}else{R=k[(R&65535)+(p&(1<<D)-1)];continue t}break}}while(r<i&&s<l);Z=T>>3,r-=Z,T-=Z<<3,p&=(1<<T)-1,e.next_in=r,e.next_out=s,e.avail_in=r<i?5+(i-r):5-(r-i),e.avail_out=s<l?257+(l-s):257-(s-l),A.hold=p,A.bits=T};const Pc=15,Aw=852,Sw=592,kw=0,o0=1,Tw=2,_7=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),E7=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),A7=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),S7=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),k7=(t,e,n,r,i,s,o,l)=>{const c=l.bits;let u=0,f=0,v=0,g=0,p=0,T=0,k=0,C=0,b=0,P=0,R,D,Z,le,U,j=null,_;const F=new Uint16Array(Pc+1),A=new Uint16Array(Pc+1);let L=null,E,M,G;for(u=0;u<=Pc;u++)F[u]=0;for(f=0;f<r;f++)F[e[n+f]]++;for(p=c,g=Pc;g>=1&&F[g]===0;g--);if(p>g&&(p=g),g===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,l.bits=1,0;for(v=1;v<g&&F[v]===0;v++);for(p<v&&(p=v),C=1,u=1;u<=Pc;u++)if(C<<=1,C-=F[u],C<0)return-1;if(C>0&&(t===kw||g!==1))return-1;for(A[1]=0,u=1;u<Pc;u++)A[u+1]=A[u]+F[u];for(f=0;f<r;f++)e[n+f]!==0&&(o[A[e[n+f]]++]=f);if(t===kw?(j=L=o,_=20):t===o0?(j=_7,L=E7,_=257):(j=A7,L=S7,_=0),P=0,f=0,u=v,U=s,T=p,k=0,Z=-1,b=1<<p,le=b-1,t===o0&&b>Aw||t===Tw&&b>Sw)return 1;for(;;){E=u-k,o[f]+1<_?(M=0,G=o[f]):o[f]>=_?(M=L[o[f]-_],G=j[o[f]-_]):(M=96,G=0),R=1<<u-k,D=1<<T,v=D;do D-=R,i[U+(P>>k)+D]=E<<24|M<<16|G|0;while(D!==0);for(R=1<<u-1;P&R;)R>>=1;if(R!==0?(P&=R-1,P+=R):P=0,f++,--F[u]===0){if(u===g)break;u=e[n+o[f]]}if(u>p&&(P&le)!==Z){for(k===0&&(k=p),U+=v,T=u-k,C=1<<T;T+k<g&&(C-=F[T+k],!(C<=0));)T++,C<<=1;if(b+=1<<T,t===o0&&b>Aw||t===Tw&&b>Sw)return 1;Z=P&le,i[Z]=p<<24|T<<16|U-s|0}}return P!==0&&(i[U+P]=u-k<<24|64<<16|0),l.bits=p,0};var Hd=k7;const T7=0,AA=1,SA=2,{Z_FINISH:jw,Z_BLOCK:j7,Z_TREES:Pf,Z_OK:vc,Z_STREAM_END:C7,Z_NEED_DICT:I7,Z_STREAM_ERROR:Ns,Z_DATA_ERROR:kA,Z_MEM_ERROR:TA,Z_BUF_ERROR:P7,Z_DEFLATED:Cw}=NA,eg=16180,Iw=16181,Pw=16182,Rw=16183,Lw=16184,Dw=16185,Ow=16186,Mw=16187,Fw=16188,Uw=16189,cp=16190,qa=16191,l0=16192,Vw=16193,c0=16194,Bw=16195,$w=16196,zw=16197,qw=16198,Rf=16199,Lf=16200,Hw=16201,Ww=16202,Gw=16203,Kw=16204,Yw=16205,u0=16206,Qw=16207,Xw=16208,On=16209,jA=16210,CA=16211,R7=852,L7=592,D7=15,O7=D7,Jw=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function M7(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const _c=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<eg||e.mode>CA?1:0},IA=t=>{if(_c(t))return Ns;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=eg,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(R7),e.distcode=e.distdyn=new Int32Array(L7),e.sane=1,e.back=-1,vc},PA=t=>{if(_c(t))return Ns;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,IA(t)},RA=(t,e)=>{let n;if(_c(t))return Ns;const r=t.state;return e<0?(n=0,e=-e):(n=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Ns:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,PA(t))},LA=(t,e)=>{if(!t)return Ns;const n=new M7;t.state=n,n.strm=t,n.window=null,n.mode=eg;const r=RA(t,e);return r!==vc&&(t.state=null),r},F7=t=>LA(t,O7);let Zw=!0,d0,h0;const U7=t=>{if(Zw){d0=new Int32Array(512),h0=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Hd(AA,t.lens,0,288,d0,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Hd(SA,t.lens,0,32,h0,0,t.work,{bits:5}),Zw=!1}t.lencode=d0,t.lenbits=9,t.distcode=h0,t.distbits=5},DA=(t,e,n,r)=>{let i;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(e.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(e.subarray(n-r,n-r+i),s.wnext),r-=i,r?(s.window.set(e.subarray(n-r,n),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},V7=(t,e)=>{let n,r,i,s,o,l,c,u,f,v,g,p,T,k,C=0,b,P,R,D,Z,le,U,j;const _=new Uint8Array(4);let F,A;const L=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(_c(t)||!t.output||!t.input&&t.avail_in!==0)return Ns;n=t.state,n.mode===qa&&(n.mode=l0),o=t.next_out,i=t.output,c=t.avail_out,s=t.next_in,r=t.input,l=t.avail_in,u=n.hold,f=n.bits,v=l,g=c,j=vc;e:for(;;)switch(n.mode){case eg:if(n.wrap===0){n.mode=l0;break}for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.wrap&2&&u===35615){n.wbits===0&&(n.wbits=15),n.check=0,_[0]=u&255,_[1]=u>>>8&255,n.check=ca(n.check,_,2,0),u=0,f=0,n.mode=Iw;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",n.mode=On;break}if((u&15)!==Cw){t.msg="unknown compression method",n.mode=On;break}if(u>>>=4,f-=4,U=(u&15)+8,n.wbits===0&&(n.wbits=U),U>15||U>n.wbits){t.msg="invalid window size",n.mode=On;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=u&512?Uw:qa,u=0,f=0;break;case Iw:for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.flags=u,(n.flags&255)!==Cw){t.msg="unknown compression method",n.mode=On;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=On;break}n.head&&(n.head.text=u>>8&1),n.flags&512&&n.wrap&4&&(_[0]=u&255,_[1]=u>>>8&255,n.check=ca(n.check,_,2,0)),u=0,f=0,n.mode=Pw;case Pw:for(;f<32;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.head&&(n.head.time=u),n.flags&512&&n.wrap&4&&(_[0]=u&255,_[1]=u>>>8&255,_[2]=u>>>16&255,_[3]=u>>>24&255,n.check=ca(n.check,_,4,0)),u=0,f=0,n.mode=Rw;case Rw:for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.head&&(n.head.xflags=u&255,n.head.os=u>>8),n.flags&512&&n.wrap&4&&(_[0]=u&255,_[1]=u>>>8&255,n.check=ca(n.check,_,2,0)),u=0,f=0,n.mode=Lw;case Lw:if(n.flags&1024){for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.length=u,n.head&&(n.head.extra_len=u),n.flags&512&&n.wrap&4&&(_[0]=u&255,_[1]=u>>>8&255,n.check=ca(n.check,_,2,0)),u=0,f=0}else n.head&&(n.head.extra=null);n.mode=Dw;case Dw:if(n.flags&1024&&(p=n.length,p>l&&(p=l),p&&(n.head&&(U=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(s,s+p),U)),n.flags&512&&n.wrap&4&&(n.check=ca(n.check,r,p,s)),l-=p,s+=p,n.length-=p),n.length))break e;n.length=0,n.mode=Ow;case Ow:if(n.flags&2048){if(l===0)break e;p=0;do U=r[s+p++],n.head&&U&&n.length<65536&&(n.head.name+=String.fromCharCode(U));while(U&&p<l);if(n.flags&512&&n.wrap&4&&(n.check=ca(n.check,r,p,s)),l-=p,s+=p,U)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=Mw;case Mw:if(n.flags&4096){if(l===0)break e;p=0;do U=r[s+p++],n.head&&U&&n.length<65536&&(n.head.comment+=String.fromCharCode(U));while(U&&p<l);if(n.flags&512&&n.wrap&4&&(n.check=ca(n.check,r,p,s)),l-=p,s+=p,U)break e}else n.head&&(n.head.comment=null);n.mode=Fw;case Fw:if(n.flags&512){for(;f<16;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.wrap&4&&u!==(n.check&65535)){t.msg="header crc mismatch",n.mode=On;break}u=0,f=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=qa;break;case Uw:for(;f<32;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}t.adler=n.check=Jw(u),u=0,f=0,n.mode=cp;case cp:if(n.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,n.hold=u,n.bits=f,I7;t.adler=n.check=1,n.mode=qa;case qa:if(e===j7||e===Pf)break e;case l0:if(n.last){u>>>=f&7,f-=f&7,n.mode=u0;break}for(;f<3;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}switch(n.last=u&1,u>>>=1,f-=1,u&3){case 0:n.mode=Vw;break;case 1:if(U7(n),n.mode=Rf,e===Pf){u>>>=2,f-=2;break e}break;case 2:n.mode=$w;break;case 3:t.msg="invalid block type",n.mode=On}u>>>=2,f-=2;break;case Vw:for(u>>>=f&7,f-=f&7;f<32;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if((u&65535)!==(u>>>16^65535)){t.msg="invalid stored block lengths",n.mode=On;break}if(n.length=u&65535,u=0,f=0,n.mode=c0,e===Pf)break e;case c0:n.mode=Bw;case Bw:if(p=n.length,p){if(p>l&&(p=l),p>c&&(p=c),p===0)break e;i.set(r.subarray(s,s+p),o),l-=p,s+=p,c-=p,o+=p,n.length-=p;break}n.mode=qa;break;case $w:for(;f<14;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.nlen=(u&31)+257,u>>>=5,f-=5,n.ndist=(u&31)+1,u>>>=5,f-=5,n.ncode=(u&15)+4,u>>>=4,f-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=On;break}n.have=0,n.mode=zw;case zw:for(;n.have<n.ncode;){for(;f<3;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.lens[L[n.have++]]=u&7,u>>>=3,f-=3}for(;n.have<19;)n.lens[L[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,F={bits:n.lenbits},j=Hd(T7,n.lens,0,19,n.lencode,0,n.work,F),n.lenbits=F.bits,j){t.msg="invalid code lengths set",n.mode=On;break}n.have=0,n.mode=qw;case qw:for(;n.have<n.nlen+n.ndist;){for(;C=n.lencode[u&(1<<n.lenbits)-1],b=C>>>24,P=C>>>16&255,R=C&65535,!(b<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(R<16)u>>>=b,f-=b,n.lens[n.have++]=R;else{if(R===16){for(A=b+2;f<A;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(u>>>=b,f-=b,n.have===0){t.msg="invalid bit length repeat",n.mode=On;break}U=n.lens[n.have-1],p=3+(u&3),u>>>=2,f-=2}else if(R===17){for(A=b+3;f<A;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}u>>>=b,f-=b,U=0,p=3+(u&7),u>>>=3,f-=3}else{for(A=b+7;f<A;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}u>>>=b,f-=b,U=0,p=11+(u&127),u>>>=7,f-=7}if(n.have+p>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=On;break}for(;p--;)n.lens[n.have++]=U}}if(n.mode===On)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=On;break}if(n.lenbits=9,F={bits:n.lenbits},j=Hd(AA,n.lens,0,n.nlen,n.lencode,0,n.work,F),n.lenbits=F.bits,j){t.msg="invalid literal/lengths set",n.mode=On;break}if(n.distbits=6,n.distcode=n.distdyn,F={bits:n.distbits},j=Hd(SA,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,F),n.distbits=F.bits,j){t.msg="invalid distances set",n.mode=On;break}if(n.mode=Rf,e===Pf)break e;case Rf:n.mode=Lf;case Lf:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,n.hold=u,n.bits=f,N7(t,g),o=t.next_out,i=t.output,c=t.avail_out,s=t.next_in,r=t.input,l=t.avail_in,u=n.hold,f=n.bits,n.mode===qa&&(n.back=-1);break}for(n.back=0;C=n.lencode[u&(1<<n.lenbits)-1],b=C>>>24,P=C>>>16&255,R=C&65535,!(b<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(P&&!(P&240)){for(D=b,Z=P,le=R;C=n.lencode[le+((u&(1<<D+Z)-1)>>D)],b=C>>>24,P=C>>>16&255,R=C&65535,!(D+b<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}u>>>=D,f-=D,n.back+=D}if(u>>>=b,f-=b,n.back+=b,n.length=R,P===0){n.mode=Yw;break}if(P&32){n.back=-1,n.mode=qa;break}if(P&64){t.msg="invalid literal/length code",n.mode=On;break}n.extra=P&15,n.mode=Hw;case Hw:if(n.extra){for(A=n.extra;f<A;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,f-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=Ww;case Ww:for(;C=n.distcode[u&(1<<n.distbits)-1],b=C>>>24,P=C>>>16&255,R=C&65535,!(b<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(!(P&240)){for(D=b,Z=P,le=R;C=n.distcode[le+((u&(1<<D+Z)-1)>>D)],b=C>>>24,P=C>>>16&255,R=C&65535,!(D+b<=f);){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}u>>>=D,f-=D,n.back+=D}if(u>>>=b,f-=b,n.back+=b,P&64){t.msg="invalid distance code",n.mode=On;break}n.offset=R,n.extra=P&15,n.mode=Gw;case Gw:if(n.extra){for(A=n.extra;f<A;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,f-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=On;break}n.mode=Kw;case Kw:if(c===0)break e;if(p=g-c,n.offset>p){if(p=n.offset-p,p>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=On;break}p>n.wnext?(p-=n.wnext,T=n.wsize-p):T=n.wnext-p,p>n.length&&(p=n.length),k=n.window}else k=i,T=o-n.offset,p=n.length;p>c&&(p=c),c-=p,n.length-=p;do i[o++]=k[T++];while(--p);n.length===0&&(n.mode=Lf);break;case Yw:if(c===0)break e;i[o++]=n.length,c--,n.mode=Lf;break;case u0:if(n.wrap){for(;f<32;){if(l===0)break e;l--,u|=r[s++]<<f,f+=8}if(g-=c,t.total_out+=g,n.total+=g,n.wrap&4&&g&&(t.adler=n.check=n.flags?ca(n.check,i,g,o-g):Kv(n.check,i,g,o-g)),g=c,n.wrap&4&&(n.flags?u:Jw(u))!==n.check){t.msg="incorrect data check",n.mode=On;break}u=0,f=0}n.mode=Qw;case Qw:if(n.wrap&&n.flags){for(;f<32;){if(l===0)break e;l--,u+=r[s++]<<f,f+=8}if(n.wrap&4&&u!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=On;break}u=0,f=0}n.mode=Xw;case Xw:j=C7;break e;case On:j=kA;break e;case jA:return TA;case CA:default:return Ns}return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,n.hold=u,n.bits=f,(n.wsize||g!==t.avail_out&&n.mode<On&&(n.mode<u0||e!==jw))&&DA(t,t.output,t.next_out,g-t.avail_out),v-=t.avail_in,g-=t.avail_out,t.total_in+=v,t.total_out+=g,n.total+=g,n.wrap&4&&g&&(t.adler=n.check=n.flags?ca(n.check,i,g,t.next_out-g):Kv(n.check,i,g,t.next_out-g)),t.data_type=n.bits+(n.last?64:0)+(n.mode===qa?128:0)+(n.mode===Rf||n.mode===c0?256:0),(v===0&&g===0||e===jw)&&j===vc&&(j=P7),j},B7=t=>{if(_c(t))return Ns;let e=t.state;return e.window&&(e.window=null),t.state=null,vc},$7=(t,e)=>{if(_c(t))return Ns;const n=t.state;return n.wrap&2?(n.head=e,e.done=!1,vc):Ns},z7=(t,e)=>{const n=e.length;let r,i,s;return _c(t)||(r=t.state,r.wrap!==0&&r.mode!==cp)?Ns:r.mode===cp&&(i=1,i=Kv(i,e,n,0),i!==r.check)?kA:(s=DA(t,e,n,n),s?(r.mode=jA,TA):(r.havedict=1,vc))};var q7=PA,H7=RA,W7=IA,G7=F7,K7=LA,Y7=V7,Q7=B7,X7=$7,J7=z7,Z7="pako inflate (from Nodeca project)",Ga={inflateReset:q7,inflateReset2:H7,inflateResetKeep:W7,inflateInit:G7,inflateInit2:K7,inflate:Y7,inflateEnd:Q7,inflateGetHeader:X7,inflateSetDictionary:J7,inflateInfo:Z7};function eD(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var tD=eD;const OA=Object.prototype.toString,{Z_NO_FLUSH:nD,Z_FINISH:rD,Z_OK:bh,Z_STREAM_END:f0,Z_NEED_DICT:m0,Z_STREAM_ERROR:iD,Z_DATA_ERROR:e5,Z_MEM_ERROR:sD}=NA;function $h(t){this.options=_A.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b7,this.strm.avail_out=0;let n=Ga.inflateInit2(this.strm,e.windowBits);if(n!==bh)throw new Error(Yv[n]);if(this.header=new tD,Ga.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Qv.string2buf(e.dictionary):OA.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=Ga.inflateSetDictionary(this.strm,e.dictionary),n!==bh)))throw new Error(Yv[n])}$h.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?rD:nD,OA.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),s=Ga.inflate(n,o),s===m0&&i&&(s=Ga.inflateSetDictionary(n,i),s===bh?s=Ga.inflate(n,o):s===e5&&(s=m0));n.avail_in>0&&s===f0&&n.state.wrap>0&&t[n.next_in]!==0;)Ga.inflateReset(n),s=Ga.inflate(n,o);switch(s){case iD:case e5:case m0:case sD:return this.onEnd(s),this.ended=!0,!1}if(l=n.avail_out,n.next_out&&(n.avail_out===0||s===f0))if(this.options.to==="string"){let c=Qv.utf8border(n.output,n.next_out),u=n.next_out-c,f=Qv.buf2string(n.output,c);n.next_out=u,n.avail_out=r-u,u&&n.output.set(n.output.subarray(c,c+u),0),this.onData(f)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(s===bh&&l===0)){if(s===f0)return s=Ga.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};$h.prototype.onData=function(t){this.chunks.push(t)};$h.prototype.onEnd=function(t){t===bh&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=_A.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function aD(t,e){const n=new $h(e);if(n.push(t),n.err)throw n.msg||Yv[n.err];return n.result}var oD=$h,lD=aD,cD={Inflate:oD,inflate:lD};const{Inflate:uD,inflate:dD}=cD;var t5=uD,hD=dD;const MA=[];for(let t=0;t<256;t++){let e=t;for(let n=0;n<8;n++)e&1?e=3988292384^e>>>1:e=e>>>1;MA[t]=e}const n5=4294967295;function fD(t,e,n){let r=t;for(let i=0;i<n;i++)r=MA[(r^e[i])&255]^r>>>8;return r}function mD(t,e){return(fD(n5,t,e)^n5)>>>0}function r5(t,e,n){const r=t.readUint32(),i=mD(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(i!==r)throw new Error(`CRC mismatch for chunk ${n}. Expected ${r}, found ${i}`)}function FA(t,e,n){for(let r=0;r<n;r++)e[r]=t[r]}function UA(t,e,n,r){let i=0;for(;i<r;i++)e[i]=t[i];for(;i<n;i++)e[i]=t[i]+e[i-r]&255}function VA(t,e,n,r){let i=0;if(n.length===0)for(;i<r;i++)e[i]=t[i];else for(;i<r;i++)e[i]=t[i]+n[i]&255}function BA(t,e,n,r,i){let s=0;if(n.length===0){for(;s<i;s++)e[s]=t[s];for(;s<r;s++)e[s]=t[s]+(e[s-i]>>1)&255}else{for(;s<i;s++)e[s]=t[s]+(n[s]>>1)&255;for(;s<r;s++)e[s]=t[s]+(e[s-i]+n[s]>>1)&255}}function $A(t,e,n,r,i){let s=0;if(n.length===0){for(;s<i;s++)e[s]=t[s];for(;s<r;s++)e[s]=t[s]+e[s-i]&255}else{for(;s<i;s++)e[s]=t[s]+n[s]&255;for(;s<r;s++)e[s]=t[s]+pD(e[s-i],n[s],n[s-i])&255}}function pD(t,e,n){const r=t+e-n,i=Math.abs(r-t),s=Math.abs(r-e),o=Math.abs(r-n);return i<=s&&i<=o?t:s<=o?e:n}function gD(t,e,n,r,i,s){switch(t){case 0:FA(e,n,i);break;case 1:UA(e,n,i,s);break;case 2:VA(e,n,r,i);break;case 3:BA(e,n,r,i,s);break;case 4:$A(e,n,r,i,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const vD=new Uint16Array([255]),yD=new Uint8Array(vD.buffer),xD=yD[0]===255;function bD(t){const{data:e,width:n,height:r,channels:i,depth:s}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*i,c=new Uint8Array(r*n*l);let u=0;for(let f=0;f<7;f++){const v=o[f],g=Math.ceil((n-v.x)/v.xStep),p=Math.ceil((r-v.y)/v.yStep);if(g<=0||p<=0)continue;const T=g*l,k=new Uint8Array(T);for(let C=0;C<p;C++){const b=e[u++],P=e.subarray(u,u+T);u+=T;const R=new Uint8Array(T);gD(b,P,R,k,T,l),k.set(R);for(let D=0;D<g;D++){const Z=v.x+D*v.xStep,le=v.y+C*v.yStep;if(!(Z>=n||le>=r))for(let U=0;U<l;U++)c[(le*n+Z)*l+U]=R[D*l+U]}}}if(s===16){const f=new Uint16Array(c.buffer);if(xD)for(let v=0;v<f.length;v++)f[v]=wD(f[v]);return f}else return c}function wD(t){return(t&255)<<8|t>>8&255}const ND=new Uint16Array([255]),_D=new Uint8Array(ND.buffer),ED=_D[0]===255,AD=new Uint8Array(0);function i5(t){const{data:e,width:n,height:r,channels:i,depth:s}=t,o=Math.ceil(s/8)*i,l=Math.ceil(s/8*i*n),c=new Uint8Array(r*l);let u=AD,f=0,v,g;for(let p=0;p<r;p++){switch(v=e.subarray(f+1,f+1+l),g=c.subarray(p*l,(p+1)*l),e[f]){case 0:FA(v,g,l);break;case 1:UA(v,g,l,o);break;case 2:VA(v,g,u,l);break;case 3:BA(v,g,u,l,o);break;case 4:$A(v,g,u,l,o);break;default:throw new Error(`Unsupported filter: ${e[f]}`)}u=g,f+=l+1}if(s===16){const p=new Uint16Array(c.buffer);if(ED)for(let T=0;T<p.length;T++)p[T]=SD(p[T]);return p}else return c}function SD(t){return(t&255)<<8|t>>8&255}const lm=Uint8Array.of(137,80,78,71,13,10,26,10);function s5(t){if(!kD(t.readBytes(lm.length)))throw new Error("wrong PNG signature")}function kD(t){if(t.length<lm.length)return!1;for(let e=0;e<lm.length;e++)if(t[e]!==lm[e])return!1;return!0}const TD="tEXt",jD=0,zA=new TextDecoder("latin1");function CD(t){if(PD(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const ID=/^[\u0000-\u00FF]*$/;function PD(t){if(!ID.test(t))throw new Error("invalid latin1 text")}function RD(t,e,n){const r=qA(e);t[r]=LD(e,n-r.length-1)}function qA(t){for(t.mark();t.readByte()!==jD;);const e=t.offset;t.reset();const n=zA.decode(t.readBytes(e-t.offset-1));return t.skip(1),CD(n),n}function LD(t,e){return zA.decode(t.readBytes(e))}const Wi={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},p0={UNKNOWN:-1,DEFLATE:0},a5={UNKNOWN:-1,ADAPTIVE:0},g0={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Df={NONE:0,BACKGROUND:1,PREVIOUS:2},v0={SOURCE:0,OVER:1};class DD extends e2{constructor(n,r={}){super(n);dn(this,"_checkCrc");dn(this,"_inflator");dn(this,"_png");dn(this,"_apng");dn(this,"_end");dn(this,"_hasPalette");dn(this,"_palette");dn(this,"_hasTransparency");dn(this,"_transparency");dn(this,"_compressionMethod");dn(this,"_filterMethod");dn(this,"_interlaceMethod");dn(this,"_colorType");dn(this,"_isAnimated");dn(this,"_numberOfFrames");dn(this,"_numberOfPlays");dn(this,"_frames");dn(this,"_writingDataChunks");const{checkCrc:i=!1}=r;this._checkCrc=i,this._inflator=new t5,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=p0.UNKNOWN,this._filterMethod=a5.UNKNOWN,this._interlaceMethod=g0.UNKNOWN,this._colorType=Wi.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(s5(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeChunk(n,r)}return this.decodeImage(),this._png}decodeApng(){for(s5(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(n,r)}return this.decodeApngImage(),this._apng}decodeChunk(n,r){const i=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(n);break;case"IDAT":this.decodeIDAT(n);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(n);break;case"iCCP":this.decodeiCCP(n);break;case TD:RD(this._png.text,this,n);break;case"pHYs":this.decodepHYs();break;default:this.skip(n);break}if(this.offset-i!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?r5(this,n+4,r):this.skip(4)}decodeApngChunk(n,r){const i=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(n);break;default:this.decodeChunk(n,r),this.offset=i+n;break}if(this.offset-i!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?r5(this,n+4,r):this.skip(4)}decodeIHDR(){const n=this._png;n.width=this.readUint32(),n.height=this.readUint32(),n.depth=OD(this.readUint8());const r=this.readUint8();this._colorType=r;let i;switch(r){case Wi.GREYSCALE:i=1;break;case Wi.TRUECOLOUR:i=3;break;case Wi.INDEXED_COLOUR:i=1;break;case Wi.GREYSCALE_ALPHA:i=2;break;case Wi.TRUECOLOUR_ALPHA:i=4;break;case Wi.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==p0.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const n={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(n)}decodePLTE(n){if(n%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${n}`);const r=n/3;this._hasPalette=!0;const i=[];this._palette=i;for(let s=0;s<r;s++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(n){this._writingDataChunks=!0;const r=n,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodeFDAT(n){this._writingDataChunks=!0;let r=n,i=this.offset+this.byteOffset;if(i+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,i,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodetRNS(n){switch(this._colorType){case Wi.GREYSCALE:case Wi.TRUECOLOUR:{if(n%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${n}`);if(n/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${n/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(n/2);for(let r=0;r<n/2;r++)this._transparency[r]=this.readUint16();break}case Wi.INDEXED_COLOUR:{if(n>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${n} vs ${this._palette.length})`);let r=0;for(;r<n;r++){const i=this.readByte();this._palette[r].push(i)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case Wi.UNKNOWN:case Wi.GREYSCALE_ALPHA:case Wi.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(n){const r=qA(this),i=this.readUint8();if(i!==p0.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const s=this.readBytes(n-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:hD(s)}}decodepHYs(){const n=this.readUint32(),r=this.readUint32(),i=this.readByte();this._png.resolution={x:n,y:r,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let n=0;n<this._numberOfFrames;n++){const r={sequenceNumber:this._frames[n].sequenceNumber,delayNumber:this._frames[n].delayNumber,delayDenominator:this._frames[n].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(n);if(i){if(i.data=i5({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),n===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)r.data=i.data;else{const s=this._apng.frames.at(n-1);this.disposeFrame(i,s,r),this.addFrameDataToCanvas(r,i)}this._apng.frames.push(r)}}return this._apng}disposeFrame(n,r,i){switch(n.disposeOp){case Df.NONE:break;case Df.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*n.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)i.data[l+c]=0}break;case Df.PREVIOUS:i.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(n,r){const i=1<<this._png.depth,s=(o,l)=>{const c=((o+r.yOffset)*this._png.width+r.xOffset+l)*this._png.channels,u=(o*r.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(r.blendOp){case v0.SOURCE:for(let o=0;o<r.height;o++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let f=0;f<this._png.channels;f++)n.data[c+f]=r.data[u+f]}break;case v0.OVER:for(let o=0;o<r.height;o++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let f=0;f<this._png.channels;f++){const v=r.data[u+this._png.channels-1]/i,g=f%(this._png.channels-1)===0?1:r.data[u+f],p=Math.floor(v*g+(1-v)*n.data[c+f]);n.data[c+f]+=p}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var r;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const n=this._isAnimated?((r=this._frames)==null?void 0:r.at(0)).data:this._inflator.result;if(this._filterMethod!==a5.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===g0.NO_INTERLACE)this._png.data=i5({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===g0.ADAM7)this._png.data=bD({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const n=this._inflator.result,r=this._frames.at(-1);r?r.data=n:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Df.NONE,blendOp:v0.SOURCE,data:n}),this._inflator=new t5,this._writingDataChunks=!1}}function OD(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var o5;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(o5||(o5={}));function MD(t,e){return new DD(t,e).decode()}var Et=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function y0(){Et.console&&typeof Et.console.log=="function"&&Et.console.log.apply(Et.console,arguments)}var xn={log:y0,warn:function(t){Et.console&&(typeof Et.console.warn=="function"?Et.console.warn.apply(Et.console,arguments):y0.call(null,arguments))},error:function(t){Et.console&&(typeof Et.console.error=="function"?Et.console.error.apply(Et.console,arguments):y0(t))}};function x0(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){Kl(r.response,e,n)},r.onerror=function(){xn.error("could not download file")},r.send()}function l5(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Of(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Kl=Et.saveAs||((typeof window>"u"?"undefined":hn(window))!=="object"||window!==Et?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var r=Et.URL||Et.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?l5(i.href)?x0(t,e,n):Of(i,i.target="_blank"):Of(i)):(i.href=r.createObjectURL(t),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){Of(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t=="string")if(l5(t))x0(t,e,n);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout(function(){Of(r)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:hn(s)!=="object"&&(xn.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(t,n),e)}:function(t,e,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof t=="string")return x0(t,e,n);var i=t.type==="application/octet-stream",s=/constructor/i.test(Et.HTMLElement)||Et.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&s)&&(typeof FileReader>"u"?"undefined":hn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var f=l.result;f=o?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=f:location=f,r=null},l.readAsDataURL(t)}else{var c=Et.URL||Et.webkitURL,u=c.createObjectURL(t);r?r.location=u:location.href=u,r=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function HA(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],r=0;r<n.length;r++){var i=n[r].re,s=n[r].process,o=i.exec(t);o&&(e=s(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var cm=Et.atob.bind(Et),c5=Et.btoa.bind(Et);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function b0(t,e){var n=t[0],r=t[1],i=t[2],s=t[3];n=Jr(n,r,i,s,e[0],7,-680876936),s=Jr(s,n,r,i,e[1],12,-389564586),i=Jr(i,s,n,r,e[2],17,606105819),r=Jr(r,i,s,n,e[3],22,-1044525330),n=Jr(n,r,i,s,e[4],7,-176418897),s=Jr(s,n,r,i,e[5],12,1200080426),i=Jr(i,s,n,r,e[6],17,-1473231341),r=Jr(r,i,s,n,e[7],22,-45705983),n=Jr(n,r,i,s,e[8],7,1770035416),s=Jr(s,n,r,i,e[9],12,-1958414417),i=Jr(i,s,n,r,e[10],17,-42063),r=Jr(r,i,s,n,e[11],22,-1990404162),n=Jr(n,r,i,s,e[12],7,1804603682),s=Jr(s,n,r,i,e[13],12,-40341101),i=Jr(i,s,n,r,e[14],17,-1502002290),n=Zr(n,r=Jr(r,i,s,n,e[15],22,1236535329),i,s,e[1],5,-165796510),s=Zr(s,n,r,i,e[6],9,-1069501632),i=Zr(i,s,n,r,e[11],14,643717713),r=Zr(r,i,s,n,e[0],20,-373897302),n=Zr(n,r,i,s,e[5],5,-701558691),s=Zr(s,n,r,i,e[10],9,38016083),i=Zr(i,s,n,r,e[15],14,-660478335),r=Zr(r,i,s,n,e[4],20,-405537848),n=Zr(n,r,i,s,e[9],5,568446438),s=Zr(s,n,r,i,e[14],9,-1019803690),i=Zr(i,s,n,r,e[3],14,-187363961),r=Zr(r,i,s,n,e[8],20,1163531501),n=Zr(n,r,i,s,e[13],5,-1444681467),s=Zr(s,n,r,i,e[2],9,-51403784),i=Zr(i,s,n,r,e[7],14,1735328473),n=ei(n,r=Zr(r,i,s,n,e[12],20,-1926607734),i,s,e[5],4,-378558),s=ei(s,n,r,i,e[8],11,-2022574463),i=ei(i,s,n,r,e[11],16,1839030562),r=ei(r,i,s,n,e[14],23,-35309556),n=ei(n,r,i,s,e[1],4,-1530992060),s=ei(s,n,r,i,e[4],11,1272893353),i=ei(i,s,n,r,e[7],16,-155497632),r=ei(r,i,s,n,e[10],23,-1094730640),n=ei(n,r,i,s,e[13],4,681279174),s=ei(s,n,r,i,e[0],11,-358537222),i=ei(i,s,n,r,e[3],16,-722521979),r=ei(r,i,s,n,e[6],23,76029189),n=ei(n,r,i,s,e[9],4,-640364487),s=ei(s,n,r,i,e[12],11,-421815835),i=ei(i,s,n,r,e[15],16,530742520),n=ti(n,r=ei(r,i,s,n,e[2],23,-995338651),i,s,e[0],6,-198630844),s=ti(s,n,r,i,e[7],10,1126891415),i=ti(i,s,n,r,e[14],15,-1416354905),r=ti(r,i,s,n,e[5],21,-57434055),n=ti(n,r,i,s,e[12],6,1700485571),s=ti(s,n,r,i,e[3],10,-1894986606),i=ti(i,s,n,r,e[10],15,-1051523),r=ti(r,i,s,n,e[1],21,-2054922799),n=ti(n,r,i,s,e[8],6,1873313359),s=ti(s,n,r,i,e[15],10,-30611744),i=ti(i,s,n,r,e[6],15,-1560198380),r=ti(r,i,s,n,e[13],21,1309151649),n=ti(n,r,i,s,e[4],6,-145523070),s=ti(s,n,r,i,e[11],10,-1120210379),i=ti(i,s,n,r,e[2],15,718787259),r=ti(r,i,s,n,e[9],21,-343485551),t[0]=Jo(n,t[0]),t[1]=Jo(r,t[1]),t[2]=Jo(i,t[2]),t[3]=Jo(s,t[3])}function tg(t,e,n,r,i,s){return e=Jo(Jo(e,t),Jo(r,s)),Jo(e<<i|e>>>32-i,n)}function Jr(t,e,n,r,i,s,o){return tg(e&n|~e&r,t,e,i,s,o)}function Zr(t,e,n,r,i,s,o){return tg(e&r|n&~r,t,e,i,s,o)}function ei(t,e,n,r,i,s,o){return tg(e^n^r,t,e,i,s,o)}function ti(t,e,n,r,i,s,o){return tg(n^(e|~r),t,e,i,s,o)}function WA(t){var e,n=t.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)b0(r,FD(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(b0(r,i),e=0;e<16;e++)i[e]=0;return i[14]=8*n,b0(r,i),r}function FD(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}var u5="0123456789abcdef".split("");function UD(t){for(var e="",n=0;n<4;n++)e+=u5[t>>8*n+4&15]+u5[t>>8*n&15];return e}function VD(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Xv(t){return WA(t).map(VD).join("")}var BD=function(t){for(var e=0;e<t.length;e++)t[e]=UD(t[e]);return t.join("")}(WA("hello"))!="5d41402abc4b2a76b9719d911017c592";function Jo(t,e){if(BD){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Jv(t,e){var n,r,i,s;if(t!==n){for(var o=(i=t,s=1+(256/t.length|0),new Array(s+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var f=l[c];u=(u+f+o.charCodeAt(c))%256,l[c]=l[u],l[u]=f}n=t,r=l}else l=r;var v=e.length,g=0,p=0,T="";for(c=0;c<v;c++)p=(p+(f=l[g=(g+1)%256]))%256,l[g]=l[p],l[p]=f,o=l[(l[g]+l[p])%256],T+=String.fromCharCode(e.charCodeAt(c)^o);return T}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var d5={print:4,modify:8,copy:16,"annot-forms":32};function Fc(t,e,n,r){this.v=1,this.r=2;var i=192;t.forEach(function(l){if(d5.perm!==void 0)throw new Error("Invalid permission: "+l);i+=d5[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),o=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^i)),this.encryptionKey=Xv(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Jv(this.encryptionKey,this.padding)}function Uc(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,r=0;r<n;r++){var i=t.charCodeAt(r);e+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):t[r]}return e}function h5(t){if(hn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(n,r,i){if(i=i||!1,typeof n!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(n)||(e[n]={});var s=Math.random().toString(35);return e[n][s]=[r,!!i],s},this.unsubscribe=function(n){for(var r in e)if(e[r][n])return delete e[r][n],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var s in e[n]){var o=e[n][s];try{o[0].apply(t,r)}catch(l){Et.console&&xn.error("jsPDF PubSub Error",l.message,l)}o[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function up(t){if(!(this instanceof up))return new up(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function GA(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Ql(t,e,n,r,i){if(!(this instanceof Ql))return new Ql(t,e,n,r,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=n,GA.call(this,r,i)}function Zc(t,e,n,r,i){if(!(this instanceof Zc))return new Zc(t,e,n,r,i);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,GA.call(this,r,i)}function ct(t){var e,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],s=arguments[3],o=[],l=1,c=16,u="S",f=null;hn(t=t||{})==="object"&&(n=t.orientation,r=t.unit||r,i=t.format||i,s=t.compress||t.compressPdf||s,(f=t.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),o=t.filters||(s===!0?["FlateEncode"]:o),r=r||"mm",n=(""+(n||"P")).toLowerCase();var v=t.putOnlyUsedFonts||!1,g={},p={internal:{},__private__:{}};p.__private__.PubSub=h5;var T="1.3",k=p.__private__.getPdfVersion=function(){return T};p.__private__.setPdfVersion=function(y){T=y};var C={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return C};var b=p.__private__.getPageFormat=function(y){return C[y]};i=i||"a4";var P="compat",R="advanced",D=P;function Z(){this.saveGraphicsState(),ie(new mt(yt,0,0,-yt,0,as()*yt).toString()+" cm"),this.setFontSize(this.getFontSize()/yt),u="n",D=R}function le(){this.restoreGraphicsState(),u="S",D=P}var U=p.__private__.combineFontStyleAndFontWeight=function(y,B){if(y=="bold"&&B=="normal"||y=="bold"&&B==400||y=="normal"&&B=="italic"||y=="bold"&&B=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return B&&(y=B==400||B==="normal"?y==="italic"?"italic":"normal":B!=700&&B!=="bold"||y!=="normal"?(B==700?"bold":B)+""+y:"bold"),y};p.advancedAPI=function(y){var B=D===P;return B&&Z.call(this),typeof y!="function"||(y(this),B&&le.call(this)),this},p.compatAPI=function(y){var B=D===R;return B&&le.call(this),typeof y!="function"||(y(this),B&&Z.call(this)),this},p.isAdvancedAPI=function(){return D===R};var j,_=function(y){if(D!==R)throw new Error(y+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},F=p.roundToPrecision=p.__private__.roundToPrecision=function(y,B){var se=e||B;if(isNaN(y)||isNaN(se))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return y.toFixed(se).replace(/0+$/,"")};j=p.hpf=p.__private__.hpf=typeof c=="number"?function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return F(y,c)}:c==="smart"?function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return F(y,y>-1&&y<1?16:5)}:function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return F(y,16)};var A=p.f2=p.__private__.f2=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.f2");return F(y,2)},L=p.__private__.f3=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.f3");return F(y,3)},E=p.scale=p.__private__.scale=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.scale");return D===P?y*yt:D===R?y:void 0},M=function(y){return E(function(B){return D===P?as()-B:D===R?B:void 0}(y))};p.__private__.setPrecision=p.setPrecision=function(y){typeof parseInt(y,10)=="number"&&(e=parseInt(y,10))};var G,K="00000000000000000000000000000000",z=p.__private__.getFileId=function(){return K},q=p.__private__.setFileId=function(y){return K=y!==void 0&&/^[a-fA-F0-9]{32}$/.test(y)?y.toUpperCase():K.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(on=new Fc(f.userPermissions,f.userPassword,f.ownerPassword,K)),K};p.setFileId=function(y){return q(y),this},p.getFileId=function(){return z()};var H=p.__private__.convertDateToPDFDate=function(y){var B=y.getTimezoneOffset(),se=B<0?"+":"-",de=Math.floor(Math.abs(B/60)),ge=Math.abs(B%60),Se=[se,V(de),"'",V(ge),"'"].join("");return["D:",y.getFullYear(),V(y.getMonth()+1),V(y.getDate()),V(y.getHours()),V(y.getMinutes()),V(y.getSeconds()),Se].join("")},X=p.__private__.convertPDFDateToDate=function(y){var B=parseInt(y.substr(2,4),10),se=parseInt(y.substr(6,2),10)-1,de=parseInt(y.substr(8,2),10),ge=parseInt(y.substr(10,2),10),Se=parseInt(y.substr(12,2),10),Ce=parseInt(y.substr(14,2),10);return new Date(B,se,de,ge,Se,Ce,0)},ne=p.__private__.setCreationDate=function(y){var B;if(y===void 0&&(y=new Date),y instanceof Date)B=H(y);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(y))throw new Error("Invalid argument passed to jsPDF.setCreationDate");B=y}return G=B},w=p.__private__.getCreationDate=function(y){var B=G;return y==="jsDate"&&(B=X(G)),B};p.setCreationDate=function(y){return ne(y),this},p.getCreationDate=function(y){return w(y)};var S,V=p.__private__.padd2=function(y){return("0"+parseInt(y)).slice(-2)},ee=p.__private__.padd2Hex=function(y){return("00"+(y=y.toString())).substr(y.length)},re=0,ce=[],he=[],me=0,ye=[],Ee=[],Pe=!1,Re=he;p.__private__.setCustomOutputDestination=function(y){Pe=!0,Re=y};var be=function(y){Pe||(Re=y)};p.__private__.resetCustomOutputDestination=function(){Pe=!1,Re=he};var ie=p.__private__.out=function(y){return y=y.toString(),me+=y.length+1,Re.push(y),Re},Ge=p.__private__.write=function(y){return ie(arguments.length===1?y.toString():Array.prototype.join.call(arguments," "))},it=p.__private__.getArrayBuffer=function(y){for(var B=y.length,se=new ArrayBuffer(B),de=new Uint8Array(se);B--;)de[B]=y.charCodeAt(B);return se},at=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return at};var De=t.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(y){return De=D===R?y/yt:y,this};var Je,qe=p.__private__.getFontSize=p.getFontSize=function(){return D===P?De:De*yt},Ue=t.R2L||!1;p.__private__.setR2L=p.setR2L=function(y){return Ue=y,this},p.__private__.getR2L=p.getR2L=function(){return Ue};var Le,zt=p.__private__.setZoomMode=function(y){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(y))Je=y;else if(isNaN(y)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(y)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+y+'" is not recognized.');Je=y}else Je=parseInt(y,10)};p.__private__.getZoomMode=function(){return Je};var At,st=p.__private__.setPageMode=function(y){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(y)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+y+'" is not recognized.');Le=y};p.__private__.getPageMode=function(){return Le};var Tt=p.__private__.setLayoutMode=function(y){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(y)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+y+'" is not recognized.');At=y};p.__private__.getLayoutMode=function(){return At},p.__private__.setDisplayMode=p.setDisplayMode=function(y,B,se){return zt(y),Tt(B),st(se),this};var wt={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(y){if(Object.keys(wt).indexOf(y)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return wt[y]},p.__private__.getDocumentProperties=function(){return wt},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(y){for(var B in wt)wt.hasOwnProperty(B)&&y[B]&&(wt[B]=y[B]);return this},p.__private__.setDocumentProperty=function(y,B){if(Object.keys(wt).indexOf(y)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return wt[y]=B};var ot,yt,ut,en,Kt,tt={},Nt={},an=[],pt={},Dt={},St={},Rn={},Sn=null,nn=0,xt=[],Mt=new h5(p),Ws=t.hotfixes||[],Jn={},ns={},qr=[],mt=function y(B,se,de,ge,Se,Ce){if(!(this instanceof y))return new y(B,se,de,ge,Se,Ce);isNaN(B)&&(B=1),isNaN(se)&&(se=0),isNaN(de)&&(de=0),isNaN(ge)&&(ge=1),isNaN(Se)&&(Se=0),isNaN(Ce)&&(Ce=0),this._matrix=[B,se,de,ge,Se,Ce]};Object.defineProperty(mt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(y){this._matrix[0]=y}}),Object.defineProperty(mt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(y){this._matrix[1]=y}}),Object.defineProperty(mt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(y){this._matrix[2]=y}}),Object.defineProperty(mt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(y){this._matrix[3]=y}}),Object.defineProperty(mt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(y){this._matrix[4]=y}}),Object.defineProperty(mt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(y){this._matrix[5]=y}}),Object.defineProperty(mt.prototype,"a",{get:function(){return this._matrix[0]},set:function(y){this._matrix[0]=y}}),Object.defineProperty(mt.prototype,"b",{get:function(){return this._matrix[1]},set:function(y){this._matrix[1]=y}}),Object.defineProperty(mt.prototype,"c",{get:function(){return this._matrix[2]},set:function(y){this._matrix[2]=y}}),Object.defineProperty(mt.prototype,"d",{get:function(){return this._matrix[3]},set:function(y){this._matrix[3]=y}}),Object.defineProperty(mt.prototype,"e",{get:function(){return this._matrix[4]},set:function(y){this._matrix[4]=y}}),Object.defineProperty(mt.prototype,"f",{get:function(){return this._matrix[5]},set:function(y){this._matrix[5]=y}}),Object.defineProperty(mt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(mt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(mt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(mt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),mt.prototype.join=function(y){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(j).join(y)},mt.prototype.multiply=function(y){var B=y.sx*this.sx+y.shy*this.shx,se=y.sx*this.shy+y.shy*this.sy,de=y.shx*this.sx+y.sy*this.shx,ge=y.shx*this.shy+y.sy*this.sy,Se=y.tx*this.sx+y.ty*this.shx+this.tx,Ce=y.tx*this.shy+y.ty*this.sy+this.ty;return new mt(B,se,de,ge,Se,Ce)},mt.prototype.decompose=function(){var y=this.sx,B=this.shy,se=this.shx,de=this.sy,ge=this.tx,Se=this.ty,Ce=Math.sqrt(y*y+B*B),Ke=(y/=Ce)*se+(B/=Ce)*de;se-=y*Ke,de-=B*Ke;var Ze=Math.sqrt(se*se+de*de);return Ke/=Ze,y*(de/=Ze)<B*(se/=Ze)&&(y=-y,B=-B,Ke=-Ke,Ce=-Ce),{scale:new mt(Ce,0,0,Ze,0,0),translate:new mt(1,0,0,1,ge,Se),rotate:new mt(y,B,-B,y,0,0),skew:new mt(1,0,Ke,1,0,0)}},mt.prototype.toString=function(y){return this.join(" ")},mt.prototype.inversed=function(){var y=this.sx,B=this.shy,se=this.shx,de=this.sy,ge=this.tx,Se=this.ty,Ce=1/(y*de-B*se),Ke=de*Ce,Ze=-B*Ce,vt=-se*Ce,_t=y*Ce;return new mt(Ke,Ze,vt,_t,-Ke*ge-vt*Se,-Ze*ge-_t*Se)},mt.prototype.applyToPoint=function(y){var B=y.x*this.sx+y.y*this.shx+this.tx,se=y.x*this.shy+y.y*this.sy+this.ty;return new na(B,se)},mt.prototype.applyToRectangle=function(y){var B=this.applyToPoint(y),se=this.applyToPoint(new na(y.x+y.w,y.y+y.h));return new No(B.x,B.y,se.x-B.x,se.y-B.y)},mt.prototype.clone=function(){var y=this.sx,B=this.shy,se=this.shx,de=this.sy,ge=this.tx,Se=this.ty;return new mt(y,B,se,de,ge,Se)},p.Matrix=mt;var kn=p.matrixMult=function(y,B){return B.multiply(y)},rs=new mt(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=rs;var Er=function(y,B){if(!Dt[y]){var se=(B instanceof Ql?"Sh":"P")+(Object.keys(pt).length+1).toString(10);B.id=se,Dt[y]=se,pt[se]=B,Mt.publish("addPattern",B)}};p.ShadingPattern=Ql,p.TilingPattern=Zc,p.addShadingPattern=function(y,B){return _("addShadingPattern()"),Er(y,B),this},p.beginTilingPattern=function(y){_("beginTilingPattern()"),ra(y.boundingBox[0],y.boundingBox[1],y.boundingBox[2]-y.boundingBox[0],y.boundingBox[3]-y.boundingBox[1],y.matrix)},p.endTilingPattern=function(y,B){_("endTilingPattern()"),B.stream=Ee[S].join(`
`),Er(y,B),Mt.publish("endTilingPattern",B),qr.pop().restore()};var Ar,Ln=p.__private__.newObject=function(){var y=dr();return Dn(y,!0),y},dr=p.__private__.newObjectDeferred=function(){return re++,ce[re]=function(){return me},re},Dn=function(y,B){return B=typeof B=="boolean"&&B,ce[y]=me,B&&ie(y+" 0 obj"),y},ja=p.__private__.newAdditionalObject=function(){var y={objId:dr(),content:""};return ye.push(y),y},Gs=dr(),Hr=dr(),Pi=p.__private__.decodeColorString=function(y){var B=y.split(" ");if(B.length!==2||B[1]!=="g"&&B[1]!=="G")B.length!==5||B[4]!=="k"&&B[4]!=="K"||(B=[(1-B[0])*(1-B[3]),(1-B[1])*(1-B[3]),(1-B[2])*(1-B[3]),"r"]);else{var se=parseFloat(B[0]);B=[se,se,se,"r"]}for(var de="#",ge=0;ge<3;ge++)de+=("0"+Math.floor(255*parseFloat(B[ge])).toString(16)).slice(-2);return de},li=p.__private__.encodeColorString=function(y){var B;typeof y=="string"&&(y={ch1:y});var se=y.ch1,de=y.ch2,ge=y.ch3,Se=y.ch4,Ce=y.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof se=="string"&&se.charAt(0)!=="#"){var Ke=new HA(se);if(Ke.ok)se=Ke.toHex();else if(!/^\d*\.?\d*$/.test(se))throw new Error('Invalid color "'+se+'" passed to jsPDF.encodeColorString.')}if(typeof se=="string"&&/^#[0-9A-Fa-f]{3}$/.test(se)&&(se="#"+se[1]+se[1]+se[2]+se[2]+se[3]+se[3]),typeof se=="string"&&/^#[0-9A-Fa-f]{6}$/.test(se)){var Ze=parseInt(se.substr(1),16);se=Ze>>16&255,de=Ze>>8&255,ge=255&Ze}if(de===void 0||Se===void 0&&se===de&&de===ge)B=typeof se=="string"?se+" "+Ce[0]:y.precision===2?A(se/255)+" "+Ce[0]:L(se/255)+" "+Ce[0];else if(Se===void 0||hn(Se)==="object"){if(Se&&!isNaN(Se.a)&&Se.a===0)return["1.","1.","1.",Ce[1]].join(" ");B=typeof se=="string"?[se,de,ge,Ce[1]].join(" "):y.precision===2?[A(se/255),A(de/255),A(ge/255),Ce[1]].join(" "):[L(se/255),L(de/255),L(ge/255),Ce[1]].join(" ")}else B=typeof se=="string"?[se,de,ge,Se,Ce[2]].join(" "):y.precision===2?[A(se),A(de),A(ge),A(Se),Ce[2]].join(" "):[L(se),L(de),L(ge),L(Se),Ce[2]].join(" ");return B},Wr=p.__private__.getFilters=function(){return o},Zn=p.__private__.putStream=function(y){var B=(y=y||{}).data||"",se=y.filters||Wr(),de=y.alreadyAppliedFilters||[],ge=y.addLength1||!1,Se=B.length,Ce=y.objectId,Ke=function(Wn){return Wn};if(f!==null&&Ce===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(Ke=on.encryptor(Ce,0));var Ze={};se===!0&&(se=["FlateEncode"]);var vt=y.additionalKeyValues||[],_t=(Ze=ct.API.processDataByFilters!==void 0?ct.API.processDataByFilters(B,se):{data:B,reverseChain:[]}).reverseChain+(Array.isArray(de)?de.join(" "):de.toString());if(Ze.data.length!==0&&(vt.push({key:"Length",value:Ze.data.length}),ge===!0&&vt.push({key:"Length1",value:Se})),_t.length!=0)if(_t.split("/").length-1==1)vt.push({key:"Filter",value:_t});else{vt.push({key:"Filter",value:"["+_t+"]"});for(var Yt=0;Yt<vt.length;Yt+=1)if(vt[Yt].key==="DecodeParms"){for(var rn=[],Un=0;Un<Ze.reverseChain.split("/").length-1;Un+=1)rn.push("null");rn.push(vt[Yt].value),vt[Yt].value="["+rn.join(" ")+"]"}}ie("<<");for(var ln=0;ln<vt.length;ln++)ie("/"+vt[ln].key+" "+vt[ln].value);ie(">>"),Ze.data.length!==0&&(ie("stream"),ie(Ke(Ze.data)),ie("endstream"))},Ks=p.__private__.putPage=function(y){var B=y.number,se=y.data,de=y.objId,ge=y.contentsObjId;Dn(de,!0),ie("<</Type /Page"),ie("/Parent "+y.rootDictionaryObjId+" 0 R"),ie("/Resources "+y.resourceDictionaryObjId+" 0 R"),ie("/MediaBox ["+parseFloat(j(y.mediaBox.bottomLeftX))+" "+parseFloat(j(y.mediaBox.bottomLeftY))+" "+j(y.mediaBox.topRightX)+" "+j(y.mediaBox.topRightY)+"]"),y.cropBox!==null&&ie("/CropBox ["+j(y.cropBox.bottomLeftX)+" "+j(y.cropBox.bottomLeftY)+" "+j(y.cropBox.topRightX)+" "+j(y.cropBox.topRightY)+"]"),y.bleedBox!==null&&ie("/BleedBox ["+j(y.bleedBox.bottomLeftX)+" "+j(y.bleedBox.bottomLeftY)+" "+j(y.bleedBox.topRightX)+" "+j(y.bleedBox.topRightY)+"]"),y.trimBox!==null&&ie("/TrimBox ["+j(y.trimBox.bottomLeftX)+" "+j(y.trimBox.bottomLeftY)+" "+j(y.trimBox.topRightX)+" "+j(y.trimBox.topRightY)+"]"),y.artBox!==null&&ie("/ArtBox ["+j(y.artBox.bottomLeftX)+" "+j(y.artBox.bottomLeftY)+" "+j(y.artBox.topRightX)+" "+j(y.artBox.topRightY)+"]"),typeof y.userUnit=="number"&&y.userUnit!==1&&ie("/UserUnit "+y.userUnit),Mt.publish("putPage",{objId:de,pageContext:xt[B],pageNumber:B,page:se}),ie("/Contents "+ge+" 0 R"),ie(">>"),ie("endobj");var Se=se.join(`
`);return D===R&&(Se+=`
Q`),Dn(ge,!0),Zn({data:Se,filters:Wr(),objectId:ge}),ie("endobj"),de},Ri=p.__private__.putPages=function(){var y,B,se=[];for(y=1;y<=nn;y++)xt[y].objId=dr(),xt[y].contentsObjId=dr();for(y=1;y<=nn;y++)se.push(Ks({number:y,data:Ee[y],objId:xt[y].objId,contentsObjId:xt[y].contentsObjId,mediaBox:xt[y].mediaBox,cropBox:xt[y].cropBox,bleedBox:xt[y].bleedBox,trimBox:xt[y].trimBox,artBox:xt[y].artBox,userUnit:xt[y].userUnit,rootDictionaryObjId:Gs,resourceDictionaryObjId:Hr}));Dn(Gs,!0),ie("<</Type /Pages");var de="/Kids [";for(B=0;B<nn;B++)de+=se[B]+" 0 R ";ie(de+"]"),ie("/Count "+nn),ie(">>"),ie("endobj"),Mt.publish("postPutPages")},_s=function(y){Mt.publish("putFont",{font:y,out:ie,newObject:Ln,putStream:Zn}),y.isAlreadyPutted!==!0&&(y.objectNumber=Ln(),ie("<<"),ie("/Type /Font"),ie("/BaseFont /"+Uc(y.postScriptName)),ie("/Subtype /Type1"),typeof y.encoding=="string"&&ie("/Encoding /"+y.encoding),ie("/FirstChar 32"),ie("/LastChar 255"),ie(">>"),ie("endobj"))},Ys=function(y){y.objectNumber=Ln();var B=[];B.push({key:"Type",value:"/XObject"}),B.push({key:"Subtype",value:"/Form"}),B.push({key:"BBox",value:"["+[j(y.x),j(y.y),j(y.x+y.width),j(y.y+y.height)].join(" ")+"]"}),B.push({key:"Matrix",value:"["+y.matrix.toString()+"]"});var se=y.pages[1].join(`
`);Zn({data:se,additionalKeyValues:B,objectId:y.objectNumber}),ie("endobj")},Ca=function(y,B){B||(B=21);var se=Ln(),de=function(Ce,Ke){var Ze,vt=[],_t=1/(Ke-1);for(Ze=0;Ze<1;Ze+=_t)vt.push(Ze);if(vt.push(1),Ce[0].offset!=0){var Yt={offset:0,color:Ce[0].color};Ce.unshift(Yt)}if(Ce[Ce.length-1].offset!=1){var rn={offset:1,color:Ce[Ce.length-1].color};Ce.push(rn)}for(var Un="",ln=0,Wn=0;Wn<vt.length;Wn++){for(Ze=vt[Wn];Ze>Ce[ln+1].offset;)ln++;var Vn=Ce[ln].offset,Gn=(Ze-Vn)/(Ce[ln+1].offset-Vn),wn=Ce[ln].color,Pr=Ce[ln+1].color;Un+=ee(Math.round((1-Gn)*wn[0]+Gn*Pr[0]).toString(16))+ee(Math.round((1-Gn)*wn[1]+Gn*Pr[1]).toString(16))+ee(Math.round((1-Gn)*wn[2]+Gn*Pr[2]).toString(16))}return Un.trim()}(y.colors,B),ge=[];ge.push({key:"FunctionType",value:"0"}),ge.push({key:"Domain",value:"[0.0 1.0]"}),ge.push({key:"Size",value:"["+B+"]"}),ge.push({key:"BitsPerSample",value:"8"}),ge.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ge.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Zn({data:de,additionalKeyValues:ge,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:se}),ie("endobj"),y.objectNumber=Ln(),ie("<< /ShadingType "+y.type),ie("/ColorSpace /DeviceRGB");var Se="/Coords ["+j(parseFloat(y.coords[0]))+" "+j(parseFloat(y.coords[1]))+" ";y.type===2?Se+=j(parseFloat(y.coords[2]))+" "+j(parseFloat(y.coords[3])):Se+=j(parseFloat(y.coords[2]))+" "+j(parseFloat(y.coords[3]))+" "+j(parseFloat(y.coords[4]))+" "+j(parseFloat(y.coords[5])),ie(Se+="]"),y.matrix&&ie("/Matrix ["+y.matrix.toString()+"]"),ie("/Function "+se+" 0 R"),ie("/Extend [true true]"),ie(">>"),ie("endobj")},Ia=function(y,B){var se=dr(),de=Ln();B.push({resourcesOid:se,objectOid:de}),y.objectNumber=de;var ge=[];ge.push({key:"Type",value:"/Pattern"}),ge.push({key:"PatternType",value:"1"}),ge.push({key:"PaintType",value:"1"}),ge.push({key:"TilingType",value:"1"}),ge.push({key:"BBox",value:"["+y.boundingBox.map(j).join(" ")+"]"}),ge.push({key:"XStep",value:j(y.xStep)}),ge.push({key:"YStep",value:j(y.yStep)}),ge.push({key:"Resources",value:se+" 0 R"}),y.matrix&&ge.push({key:"Matrix",value:"["+y.matrix.toString()+"]"}),Zn({data:y.stream,additionalKeyValues:ge,objectId:y.objectNumber}),ie("endobj")},$u=function(y){for(var B in y.objectNumber=Ln(),ie("<<"),y)switch(B){case"opacity":ie("/ca "+A(y[B]));break;case"stroke-opacity":ie("/CA "+A(y[B]))}ie(">>"),ie("endobj")},Qs=function(y){Dn(y.resourcesOid,!0),ie("<<"),ie("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var B in ie("/Font <<"),tt)tt.hasOwnProperty(B)&&(v===!1||v===!0&&g.hasOwnProperty(B))&&ie("/"+B+" "+tt[B].objectNumber+" 0 R");ie(">>")}(),function(){if(Object.keys(pt).length>0){for(var B in ie("/Shading <<"),pt)pt.hasOwnProperty(B)&&pt[B]instanceof Ql&&pt[B].objectNumber>=0&&ie("/"+B+" "+pt[B].objectNumber+" 0 R");Mt.publish("putShadingPatternDict"),ie(">>")}}(),function(B){if(Object.keys(pt).length>0){for(var se in ie("/Pattern <<"),pt)pt.hasOwnProperty(se)&&pt[se]instanceof p.TilingPattern&&pt[se].objectNumber>=0&&pt[se].objectNumber<B&&ie("/"+se+" "+pt[se].objectNumber+" 0 R");Mt.publish("putTilingPatternDict"),ie(">>")}}(y.objectOid),function(){if(Object.keys(St).length>0){var B;for(B in ie("/ExtGState <<"),St)St.hasOwnProperty(B)&&St[B].objectNumber>=0&&ie("/"+B+" "+St[B].objectNumber+" 0 R");Mt.publish("putGStateDict"),ie(">>")}}(),function(){for(var B in ie("/XObject <<"),Jn)Jn.hasOwnProperty(B)&&Jn[B].objectNumber>=0&&ie("/"+B+" "+Jn[B].objectNumber+" 0 R");Mt.publish("putXobjectDict"),ie(">>")}(),ie(">>"),ie("endobj")},Al=function(y){Nt[y.fontName]=Nt[y.fontName]||{},Nt[y.fontName][y.fontStyle]=y.id},po=function(y,B,se,de,ge){var Se={id:"F"+(Object.keys(tt).length+1).toString(10),postScriptName:y,fontName:B,fontStyle:se,encoding:de,isStandardFont:ge||!1,metadata:{}};return Mt.publish("addFont",{font:Se,instance:this}),tt[Se.id]=Se,Al(Se),Se.id},Sr=p.__private__.pdfEscape=p.pdfEscape=function(y,B){return function(se,de){var ge,Se,Ce,Ke,Ze,vt,_t,Yt,rn;if(Ce=(de=de||{}).sourceEncoding||"Unicode",Ze=de.outputEncoding,(de.autoencode||Ze)&&tt[ot].metadata&&tt[ot].metadata[Ce]&&tt[ot].metadata[Ce].encoding&&(Ke=tt[ot].metadata[Ce].encoding,!Ze&&tt[ot].encoding&&(Ze=tt[ot].encoding),!Ze&&Ke.codePages&&(Ze=Ke.codePages[0]),typeof Ze=="string"&&(Ze=Ke[Ze]),Ze)){for(_t=!1,vt=[],ge=0,Se=se.length;ge<Se;ge++)(Yt=Ze[se.charCodeAt(ge)])?vt.push(String.fromCharCode(Yt)):vt.push(se[ge]),vt[ge].charCodeAt(0)>>8&&(_t=!0);se=vt.join("")}for(ge=se.length;_t===void 0&&ge!==0;)se.charCodeAt(ge-1)>>8&&(_t=!0),ge--;if(!_t)return se;for(vt=de.noBOM?[]:[254,255],ge=0,Se=se.length;ge<Se;ge++){if((rn=(Yt=se.charCodeAt(ge))>>8)>>8)throw new Error("Character at position "+ge+" of string '"+se+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");vt.push(rn),vt.push(Yt-(rn<<8))}return String.fromCharCode.apply(void 0,vt)}(y,B).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Li=p.__private__.beginPage=function(y){Ee[++nn]=[],xt[nn]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(y[0]),topRightY:Number(y[1])}},kl(nn),be(Ee[S])},go=function(y,B){var se,de,ge;switch(n=B||n,typeof y=="string"&&(se=b(y.toLowerCase()),Array.isArray(se)&&(de=se[0],ge=se[1])),Array.isArray(y)&&(de=y[0]*yt,ge=y[1]*yt),isNaN(de)&&(de=i[0],ge=i[1]),(de>14400||ge>14400)&&(xn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),de=Math.min(14400,de),ge=Math.min(14400,ge)),i=[de,ge],n.substr(0,1)){case"l":ge>de&&(i=[ge,de]);break;case"p":de>ge&&(i=[ge,de])}Li(i),ta(xo),ie(Ss),gn!==0&&ie(gn+" J"),Dl!==0&&ie(Dl+" j"),Mt.publish("addPage",{pageNumber:nn})},Sl=function(y){y>0&&y<=nn&&(Ee.splice(y,1),xt.splice(y,1),nn--,S>nn&&(S=nn),this.setPage(S))},kl=function(y){y>0&&y<=nn&&(S=y)},Tl=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return Ee.length-1},jl=function(y,B,se){var de,ge=void 0;return se=se||{},y=y!==void 0?y:tt[ot].fontName,B=B!==void 0?B:tt[ot].fontStyle,de=y.toLowerCase(),Nt[de]!==void 0&&Nt[de][B]!==void 0?ge=Nt[de][B]:Nt[y]!==void 0&&Nt[y][B]!==void 0?ge=Nt[y][B]:se.disableWarning===!1&&xn.warn("Unable to look up font label for font '"+y+"', '"+B+"'. Refer to getFontList() for available fonts."),ge||se.noFallback||(ge=Nt.times[B])==null&&(ge=Nt.times.normal),ge},Xs=p.__private__.putInfo=function(){var y=Ln(),B=function(de){return de};for(var se in f!==null&&(B=on.encryptor(y,0)),ie("<<"),ie("/Producer ("+Sr(B("jsPDF "+ct.version))+")"),wt)wt.hasOwnProperty(se)&&wt[se]&&ie("/"+se.substr(0,1).toUpperCase()+se.substr(1)+" ("+Sr(B(wt[se]))+")");ie("/CreationDate ("+Sr(B(G))+")"),ie(">>"),ie("endobj")},Cl=p.__private__.putCatalog=function(y){var B=(y=y||{}).rootDictionaryObjId||Gs;switch(Ln(),ie("<<"),ie("/Type /Catalog"),ie("/Pages "+B+" 0 R"),Je||(Je="fullwidth"),Je){case"fullwidth":ie("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ie("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ie("/OpenAction [3 0 R /Fit]");break;case"original":ie("/OpenAction [3 0 R /XYZ null null 1]");break;default:var se=""+Je;se.substr(se.length-1)==="%"&&(Je=parseInt(Je)/100),typeof Je=="number"&&ie("/OpenAction [3 0 R /XYZ null null "+A(Je)+"]")}switch(At||(At="continuous"),At){case"continuous":ie("/PageLayout /OneColumn");break;case"single":ie("/PageLayout /SinglePage");break;case"two":case"twoleft":ie("/PageLayout /TwoColumnLeft");break;case"tworight":ie("/PageLayout /TwoColumnRight")}Le&&ie("/PageMode /"+Le),Mt.publish("putCatalog"),ie(">>"),ie("endobj")},Fn=p.__private__.putTrailer=function(){ie("trailer"),ie("<<"),ie("/Size "+(re+1)),ie("/Root "+re+" 0 R"),ie("/Info "+(re-1)+" 0 R"),f!==null&&ie("/Encrypt "+on.oid+" 0 R"),ie("/ID [ <"+K+"> <"+K+"> ]"),ie(">>")},Il=p.__private__.putHeader=function(){ie("%PDF-"+T),ie("%")},Ac=p.__private__.putXRef=function(){var y="0000000000";ie("xref"),ie("0 "+(re+1)),ie("0000000000 65535 f ");for(var B=1;B<=re;B++)typeof ce[B]=="function"?ie((y+ce[B]()).slice(-10)+" 00000 n "):ce[B]!==void 0?ie((y+ce[B]).slice(-10)+" 00000 n "):ie("0000000000 00000 n ")},Es=p.__private__.buildDocument=function(){var y;re=0,me=0,he=[],ce=[],ye=[],Gs=dr(),Hr=dr(),be(he),Mt.publish("buildDocument"),Il(),Ri(),function(){Mt.publish("putAdditionalObjects");for(var se=0;se<ye.length;se++){var de=ye[se];Dn(de.objId,!0),ie(de.content),ie("endobj")}Mt.publish("postPutAdditionalObjects")}(),y=[],function(){for(var se in tt)tt.hasOwnProperty(se)&&(v===!1||v===!0&&g.hasOwnProperty(se))&&_s(tt[se])}(),function(){var se;for(se in St)St.hasOwnProperty(se)&&$u(St[se])}(),function(){for(var se in Jn)Jn.hasOwnProperty(se)&&Ys(Jn[se])}(),function(se){var de;for(de in pt)pt.hasOwnProperty(de)&&(pt[de]instanceof Ql?Ca(pt[de]):pt[de]instanceof Zc&&Ia(pt[de],se))}(y),Mt.publish("putResources"),y.forEach(Qs),Qs({resourcesOid:Hr,objectOid:Number.MAX_SAFE_INTEGER}),Mt.publish("postPutResources"),f!==null&&(on.oid=Ln(),ie("<<"),ie("/Filter /Standard"),ie("/V "+on.v),ie("/R "+on.r),ie("/U <"+on.toHexString(on.U)+">"),ie("/O <"+on.toHexString(on.O)+">"),ie("/P "+on.P),ie(">>"),ie("endobj")),Xs(),Cl();var B=me;return Ac(),Fn(),ie("startxref"),ie(""+B),ie("%%EOF"),be(Ee[S]),he.join(`
`)},Js=p.__private__.getBlob=function(y){return new Blob([it(y)],{type:"application/pdf"})},yi=p.output=p.__private__.output=(Ar=function(y,B){switch(typeof(B=B||{})=="string"?B={filename:B}:B.filename=B.filename||"generated.pdf",y){case void 0:return Es();case"save":p.save(B.filename);break;case"arraybuffer":return it(Es());case"blob":return Js(Es());case"bloburi":case"bloburl":if(Et.URL!==void 0&&typeof Et.URL.createObjectURL=="function")return Et.URL&&Et.URL.createObjectURL(Js(Es()))||void 0;xn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var se="",de=Es();try{se=c5(de)}catch{se=c5(unescape(encodeURIComponent(de)))}return"data:application/pdf;filename="+B.filename+";base64,"+se;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Et)==="[object Window]"){var ge="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Se=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';B.pdfObjectUrl&&(ge=B.pdfObjectUrl,Se="");var Ce='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ge+'"'+Se+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(B)+");<\/script></body></html>",Ke=Et.open();return Ke!==null&&Ke.document.write(Ce),Ke}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Et)==="[object Window]"){var Ze='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(B.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+B.filename+'" width="500px" height="400px" /></body></html>',vt=Et.open();if(vt!==null){vt.document.write(Ze);var _t=this;vt.document.documentElement.querySelector("#pdfViewer").onload=function(){vt.document.title=B.filename,vt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(_t.output("bloburl"))}}return vt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Et)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Yt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",B)+'"></iframe></body></html>',rn=Et.open();if(rn!==null&&(rn.document.write(Yt),rn.document.title=B.filename),rn||typeof safari>"u")return rn;break;case"datauri":case"dataurl":return Et.document.location.href=this.output("datauristring",B);default:return null}},Ar.foo=function(){try{return Ar.apply(this,arguments)}catch(se){var y=se.stack||"";~y.indexOf(" at ")&&(y=y.split(" at ")[1]);var B="Error in function "+y.split(`
`)[0].split("<")[0]+": "+se.message;if(!Et.console)throw new Error(B);Et.console.error(B,se),Et.alert&&alert(B)}},Ar.foo.bar=Ar,Ar.foo),Pa=function(y){return Array.isArray(Ws)===!0&&Ws.indexOf(y)>-1};switch(r){case"pt":yt=1;break;case"mm":yt=72/25.4;break;case"cm":yt=72/2.54;break;case"in":yt=72;break;case"px":yt=Pa("px_scaling")==1?.75:96/72;break;case"pc":case"em":yt=12;break;case"ex":yt=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);yt=r}var on=null;ne(),q();var ci=p.__private__.getPageInfo=p.getPageInfo=function(y){if(isNaN(y)||y%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:xt[y].objId,pageNumber:y,pageContext:xt[y]}},vo=p.__private__.getPageInfoByObjId=function(y){if(isNaN(y)||y%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var B in xt)if(xt[B].objId===y)break;return ci(B)},yo=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:xt[S].objId,pageNumber:S,pageContext:xt[S]}};p.addPage=function(){return go.apply(this,arguments),this},p.setPage=function(){return kl.apply(this,arguments),be.call(this,Ee[S]),this},p.insertPage=function(y){return this.addPage(),this.movePage(S,y),this},p.movePage=function(y,B){var se,de;if(y>B){se=Ee[y],de=xt[y];for(var ge=y;ge>B;ge--)Ee[ge]=Ee[ge-1],xt[ge]=xt[ge-1];Ee[B]=se,xt[B]=de,this.setPage(B)}else if(y<B){se=Ee[y],de=xt[y];for(var Se=y;Se<B;Se++)Ee[Se]=Ee[Se+1],xt[Se]=xt[Se+1];Ee[B]=se,xt[B]=de,this.setPage(B)}return this},p.deletePage=function(){return Sl.apply(this,arguments),this},p.__private__.text=p.text=function(y,B,se,de,ge){var Se,Ce,Ke,Ze,vt,_t,Yt,rn,Un,ln=(de=de||{}).scope||this;if(typeof y=="number"&&typeof B=="number"&&(typeof se=="string"||Array.isArray(se))){var Wn=se;se=B,B=y,y=Wn}if(arguments[3]instanceof mt==0?(Ke=arguments[4],Ze=arguments[5],hn(Yt=arguments[3])==="object"&&Yt!==null||(typeof Ke=="string"&&(Ze=Ke,Ke=null),typeof Yt=="string"&&(Ze=Yt,Yt=null),typeof Yt=="number"&&(Ke=Yt,Yt=null),de={flags:Yt,angle:Ke,align:Ze})):(_("The transform parameter of text() with a Matrix value"),Un=ge),isNaN(B)||isNaN(se)||y==null)throw new Error("Invalid arguments passed to jsPDF.text");if(y.length===0)return ln;var Vn,Gn="",wn=typeof de.lineHeightFactor=="number"?de.lineHeightFactor:ea,Pr=ln.internal.scaleFactor;function Ul(sn){return sn=sn.split("	").join(Array(de.TabLen||9).join(" ")),Sr(sn,Yt)}function Oi(sn){for(var vn,tr=sn.concat(),vr=[],Ua=tr.length;Ua--;)typeof(vn=tr.shift())=="string"?vr.push(vn):Array.isArray(sn)&&(vn.length===1||vn[1]===void 0&&vn[2]===void 0)?vr.push(vn[0]):vr.push([vn[0],vn[1],vn[2]]);return vr}function h(sn,vn){var tr;if(typeof sn=="string")tr=vn(sn)[0];else if(Array.isArray(sn)){for(var vr,Ua,nd=sn.concat(),jc=[],qh=nd.length;qh--;)typeof(vr=nd.shift())=="string"?jc.push(vn(vr)[0]):Array.isArray(vr)&&typeof vr[0]=="string"&&(Ua=vn(vr[0],vr[1],vr[2]),jc.push([Ua[0],Ua[1],Ua[2]]));tr=jc}return tr}var N=!1,O=!0;if(typeof y=="string")N=!0;else if(Array.isArray(y)){var J=y.concat();Ce=[];for(var ve,_e=J.length;_e--;)(typeof(ve=J.shift())!="string"||Array.isArray(ve)&&typeof ve[0]!="string")&&(O=!1);N=O}if(N===!1)throw new Error('Type of text must be string or Array. "'+y+'" is not recognized.');typeof y=="string"&&(y=y.match(/[\r?\n]/)?y.split(/\r\n|\r|\n/g):[y]);var $e=De/ln.internal.scaleFactor,qt=$e*(wn-1);switch(de.baseline){case"bottom":se-=qt;break;case"top":se+=$e-qt;break;case"hanging":se+=$e-2*qt;break;case"middle":se+=$e/2-qt}if((_t=de.maxWidth||0)>0&&(typeof y=="string"?y=ln.splitTextToSize(y,_t):Object.prototype.toString.call(y)==="[object Array]"&&(y=y.reduce(function(sn,vn){return sn.concat(ln.splitTextToSize(vn,_t))},[]))),Se={text:y,x:B,y:se,options:de,mutex:{pdfEscape:Sr,activeFontKey:ot,fonts:tt,activeFontSize:De}},Mt.publish("preProcessText",Se),y=Se.text,Ke=(de=Se.options).angle,Un instanceof mt==0&&Ke&&typeof Ke=="number"){Ke*=Math.PI/180,de.rotationDirection===0&&(Ke=-Ke),D===R&&(Ke=-Ke);var Bn=Math.cos(Ke),Ft=Math.sin(Ke);Un=new mt(Bn,Ft,-Ft,Bn,0,0)}else Ke&&Ke instanceof mt&&(Un=Ke);D!==R||Un||(Un=rs),(vt=de.charSpace||Da)!==void 0&&(Gn+=j(E(vt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(rn=de.horizontalScale)!==void 0&&(Gn+=j(100*rn)+` Tz
`),de.lang;var Ot=-1,Nn=de.renderingMode!==void 0?de.renderingMode:de.stroke,Mi=ln.internal.getCurrentPageInfo().pageContext;switch(Nn){case 0:case!1:case"fill":Ot=0;break;case 1:case!0:case"stroke":Ot=1;break;case 2:case"fillThenStroke":Ot=2;break;case 3:case"invisible":Ot=3;break;case 4:case"fillAndAddForClipping":Ot=4;break;case 5:case"strokeAndAddPathForClipping":Ot=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ot=6;break;case 7:case"addToPathForClipping":Ot=7}var Gr=Mi.usedRenderingMode!==void 0?Mi.usedRenderingMode:-1;Ot!==-1?Gn+=Ot+` Tr
`:Gr!==-1&&(Gn+=`0 Tr
`),Ot!==-1&&(Mi.usedRenderingMode=Ot),Ze=de.align||"left";var Rr,Ts=De*wn,Yu=ln.internal.pageSize.getWidth(),Qu=tt[ot];vt=de.charSpace||Da,_t=de.maxWidth||0,Yt=Object.assign({autoencode:!0,noBOM:!0},de.flags);var Eo=[],Vl=function(sn){return ln.getStringUnitWidth(sn,{font:Qu,charSpace:vt,fontSize:De,doKerning:!1})*De/Pr};if(Object.prototype.toString.call(y)==="[object Array]"){var Fi;Ce=Oi(y),Ze!=="left"&&(Rr=Ce.map(Vl));var Ui,Ao=0;if(Ze==="right"){B-=Rr[0],y=[],_e=Ce.length;for(var Fa=0;Fa<_e;Fa++)Fa===0?(Ui=kr(B),Fi=As(se)):(Ui=E(Ao-Rr[Fa]),Fi=-Ts),y.push([Ce[Fa],Ui,Fi]),Ao=Rr[Fa]}else if(Ze==="center"){B-=Rr[0]/2,y=[],_e=Ce.length;for(var So=0;So<_e;So++)So===0?(Ui=kr(B),Fi=As(se)):(Ui=E((Ao-Rr[So])/2),Fi=-Ts),y.push([Ce[So],Ui,Fi]),Ao=Rr[So]}else if(Ze==="left"){y=[],_e=Ce.length;for(var Xu=0;Xu<_e;Xu++)y.push(Ce[Xu])}else if(Ze==="justify"&&Qu.encoding==="Identity-H"){y=[],_e=Ce.length,_t=_t!==0?_t:Yu;for(var Tc=0,er=0;er<_e;er++)if(Fi=er===0?As(se):-Ts,Ui=er===0?kr(B):Tc,er<_e-1){var zh=E((_t-Rr[er])/(Ce[er].split(" ").length-1)),sa=Ce[er].split(" ");y.push([sa[0]+" ",Ui,Fi]),Tc=0;for(var aa=1;aa<sa.length;aa++){var Ju=(Vl(sa[aa-1]+" "+sa[aa])-Vl(sa[aa]))*Pr+zh;aa==sa.length-1?y.push([sa[aa],Ju,0]):y.push([sa[aa]+" ",Ju,0]),Tc-=Ju}}else y.push([Ce[er],Ui,Fi]);y.push(["",Tc,0])}else{if(Ze!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(y=[],_e=Ce.length,_t=_t!==0?_t:Yu,er=0;er<_e;er++){Fi=er===0?As(se):-Ts,Ui=er===0?kr(B):0;var Zu=Ce[er].split(" ").length-1,ed=Zu>0?(_t-Rr[er])/Zu:0;er<_e-1?Eo.push(j(E(ed))):Eo.push(0),y.push([Ce[er],Ui,Fi])}}}(typeof de.R2L=="boolean"?de.R2L:Ue)===!0&&(y=h(y,function(sn,vn,tr){return[sn.split("").reverse().join(""),vn,tr]})),Se={text:y,x:B,y:se,options:de,mutex:{pdfEscape:Sr,activeFontKey:ot,fonts:tt,activeFontSize:De}},Mt.publish("postProcessText",Se),y=Se.text,Vn=Se.mutex.isHex||!1;var td=tt[ot].encoding;td!=="WinAnsiEncoding"&&td!=="StandardEncoding"||(y=h(y,function(sn,vn,tr){return[Ul(sn),vn,tr]})),Ce=Oi(y),y=[];for(var ko,To,jo,Bl=Array.isArray(Ce[0])?1:0,Co="",$l=function(sn,vn,tr){var vr="";return tr instanceof mt?(tr=typeof de.angle=="number"?kn(tr,new mt(1,0,0,1,sn,vn)):kn(new mt(1,0,0,1,sn,vn),tr),D===R&&(tr=kn(new mt(1,0,0,-1,0,0),tr)),vr=tr.join(" ")+` Tm
`):vr=j(sn)+" "+j(vn)+` Td
`,vr},os=0;os<Ce.length;os++){switch(Co="",Bl){case 1:jo=(Vn?"<":"(")+Ce[os][0]+(Vn?">":")"),ko=parseFloat(Ce[os][1]),To=parseFloat(Ce[os][2]);break;case 0:jo=(Vn?"<":"(")+Ce[os]+(Vn?">":")"),ko=kr(B),To=As(se)}Eo!==void 0&&Eo[os]!==void 0&&(Co=Eo[os]+` Tw
`),os===0?y.push(Co+$l(ko,To,Un)+jo):Bl===0?y.push(Co+jo):Bl===1&&y.push(Co+$l(ko,To,Un)+jo)}y=Bl===0?y.join(` Tj
T* `):y.join(` Tj
`),y+=` Tj
`;var oa=`BT
/`;return oa+=ot+" "+De+` Tf
`,oa+=j(De*wn)+` TL
`,oa+=Di+`
`,oa+=Gn,oa+=y,ie(oa+="ET"),g[ot]=!0,ln};var Sc=p.__private__.clip=p.clip=function(y){return ie(y==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return Sc("evenodd")},p.__private__.discardPath=p.discardPath=function(){return ie("n"),this};var Bt=p.__private__.isValidStyle=function(y){var B=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(y)!==-1&&(B=!0),B};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(y){return Bt(y)&&(u=y),this};var Ra=p.__private__.getStyle=p.getStyle=function(y){var B=u;switch(y){case"D":case"S":B="S";break;case"F":B="f";break;case"FD":case"DF":B="B";break;case"f":case"f*":case"B":case"B*":B=y}return B},Zs=p.close=function(){return ie("h"),this};p.stroke=function(){return ie("S"),this},p.fill=function(y){return xi("f",y),this},p.fillEvenOdd=function(y){return xi("f*",y),this},p.fillStroke=function(y){return xi("B",y),this},p.fillStrokeEvenOdd=function(y){return xi("B*",y),this};var xi=function(y,B){hn(B)==="object"?zu(B,y):ie(y)},Pl=function(y){y===null||D===R&&y===void 0||(y=Ra(y),ie(y))};function kc(y,B,se,de,ge){var Se=new Zc(B||this.boundingBox,se||this.xStep,de||this.yStep,this.gState,ge||this.matrix);Se.stream=this.stream;var Ce=y+"$$"+this.cloneIndex+++"$$";return Er(Ce,Se),Se}var zu=function(y,B){var se=Dt[y.key],de=pt[se];if(de instanceof Ql)ie("q"),ie(qu(B)),de.gState&&p.setGState(de.gState),ie(y.matrix.toString()+" cm"),ie("/"+se+" sh"),ie("Q");else if(de instanceof Zc){var ge=new mt(1,0,0,-1,0,as());y.matrix&&(ge=ge.multiply(y.matrix||rs),se=kc.call(de,y.key,y.boundingBox,y.xStep,y.yStep,ge).id),ie("q"),ie("/Pattern cs"),ie("/"+se+" scn"),de.gState&&p.setGState(de.gState),ie(B),ie("Q")}},qu=function(y){switch(y){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Rl=p.moveTo=function(y,B){return ie(j(E(y))+" "+j(M(B))+" m"),this},La=p.lineTo=function(y,B){return ie(j(E(y))+" "+j(M(B))+" l"),this},bi=p.curveTo=function(y,B,se,de,ge,Se){return ie([j(E(y)),j(M(B)),j(E(se)),j(M(de)),j(E(ge)),j(M(Se)),"c"].join(" ")),this};p.__private__.line=p.line=function(y,B,se,de,ge){if(isNaN(y)||isNaN(B)||isNaN(se)||isNaN(de)||!Bt(ge))throw new Error("Invalid arguments passed to jsPDF.line");return D===P?this.lines([[se-y,de-B]],y,B,[1,1],ge||"S"):this.lines([[se-y,de-B]],y,B,[1,1]).stroke()},p.__private__.lines=p.lines=function(y,B,se,de,ge,Se){var Ce,Ke,Ze,vt,_t,Yt,rn,Un,ln,Wn,Vn,Gn;if(typeof y=="number"&&(Gn=se,se=B,B=y,y=Gn),de=de||[1,1],Se=Se||!1,isNaN(B)||isNaN(se)||!Array.isArray(y)||!Array.isArray(de)||!Bt(ge)||typeof Se!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Rl(B,se),Ce=de[0],Ke=de[1],vt=y.length,Wn=B,Vn=se,Ze=0;Ze<vt;Ze++)(_t=y[Ze]).length===2?(Wn=_t[0]*Ce+Wn,Vn=_t[1]*Ke+Vn,La(Wn,Vn)):(Yt=_t[0]*Ce+Wn,rn=_t[1]*Ke+Vn,Un=_t[2]*Ce+Wn,ln=_t[3]*Ke+Vn,Wn=_t[4]*Ce+Wn,Vn=_t[5]*Ke+Vn,bi(Yt,rn,Un,ln,Wn,Vn));return Se&&Zs(),Pl(ge),this},p.path=function(y){for(var B=0;B<y.length;B++){var se=y[B],de=se.c;switch(se.op){case"m":Rl(de[0],de[1]);break;case"l":La(de[0],de[1]);break;case"c":bi.apply(this,de);break;case"h":Zs()}}return this},p.__private__.rect=p.rect=function(y,B,se,de,ge){if(isNaN(y)||isNaN(B)||isNaN(se)||isNaN(de)||!Bt(ge))throw new Error("Invalid arguments passed to jsPDF.rect");return D===P&&(de=-de),ie([j(E(y)),j(M(B)),j(E(se)),j(E(de)),"re"].join(" ")),Pl(ge),this},p.__private__.triangle=p.triangle=function(y,B,se,de,ge,Se,Ce){if(isNaN(y)||isNaN(B)||isNaN(se)||isNaN(de)||isNaN(ge)||isNaN(Se)||!Bt(Ce))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[se-y,de-B],[ge-se,Se-de],[y-ge,B-Se]],y,B,[1,1],Ce,!0),this},p.__private__.roundedRect=p.roundedRect=function(y,B,se,de,ge,Se,Ce){if(isNaN(y)||isNaN(B)||isNaN(se)||isNaN(de)||isNaN(ge)||isNaN(Se)||!Bt(Ce))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ke=4/3*(Math.SQRT2-1);return ge=Math.min(ge,.5*se),Se=Math.min(Se,.5*de),this.lines([[se-2*ge,0],[ge*Ke,0,ge,Se-Se*Ke,ge,Se],[0,de-2*Se],[0,Se*Ke,-ge*Ke,Se,-ge,Se],[2*ge-se,0],[-ge*Ke,0,-ge,-Se*Ke,-ge,-Se],[0,2*Se-de],[0,-Se*Ke,ge*Ke,-Se,ge,-Se]],y+ge,B,[1,1],Ce,!0),this},p.__private__.ellipse=p.ellipse=function(y,B,se,de,ge){if(isNaN(y)||isNaN(B)||isNaN(se)||isNaN(de)||!Bt(ge))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Se=4/3*(Math.SQRT2-1)*se,Ce=4/3*(Math.SQRT2-1)*de;return Rl(y+se,B),bi(y+se,B-Ce,y+Se,B-de,y,B-de),bi(y-Se,B-de,y-se,B-Ce,y-se,B),bi(y-se,B+Ce,y-Se,B+de,y,B+de),bi(y+Se,B+de,y+se,B+Ce,y+se,B),Pl(ge),this},p.__private__.circle=p.circle=function(y,B,se,de){if(isNaN(y)||isNaN(B)||isNaN(se)||!Bt(de))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(y,B,se,se,de)},p.setFont=function(y,B,se){return se&&(B=U(B,se)),ot=jl(y,B,{disableWarning:!1}),this};var is=p.__private__.getFont=p.getFont=function(){return tt[jl.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var y,B,se={};for(y in Nt)if(Nt.hasOwnProperty(y))for(B in se[y]=[],Nt[y])Nt[y].hasOwnProperty(B)&&se[y].push(B);return se},p.addFont=function(y,B,se,de,ge){var Se=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Se.indexOf(arguments[3])!==-1?ge=arguments[3]:arguments[3]&&Se.indexOf(arguments[3])==-1&&(se=U(se,de)),po.call(this,y,B,se,ge=ge||"Identity-H")};var ea,xo=t.lineWidth||.200025,bt=p.__private__.getLineWidth=p.getLineWidth=function(){return xo},ta=p.__private__.setLineWidth=p.setLineWidth=function(y){return xo=y,ie(j(E(y))+" w"),this};p.__private__.setLineDash=ct.API.setLineDash=ct.API.setLineDashPattern=function(y,B){if(y=y||[],B=B||0,isNaN(B)||!Array.isArray(y))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return y=y.map(function(se){return j(E(se))}).join(" "),B=j(E(B)),ie("["+y+"] "+B+" d"),this};var Hu=p.__private__.getLineHeight=p.getLineHeight=function(){return De*ea};p.__private__.getLineHeight=p.getLineHeight=function(){return De*ea};var Wu=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(y){return typeof(y=y||1.15)=="number"&&(ea=y),this},Gu=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return ea};Wu(t.lineHeight);var kr=p.__private__.getHorizontalCoordinate=function(y){return E(y)},As=p.__private__.getVerticalCoordinate=function(y){return D===R?y:xt[S].mediaBox.topRightY-xt[S].mediaBox.bottomLeftY-E(y)},Ku=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(y){return j(kr(y))},bo=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(y){return j(As(y))},Ss=t.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return Pi(Ss)},p.__private__.setStrokeColor=p.setDrawColor=function(y,B,se,de){return Ss=li({ch1:y,ch2:B,ch3:se,ch4:de,pdfColorType:"draw",precision:2}),ie(Ss),this};var wo=t.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return Pi(wo)},p.__private__.setFillColor=p.setFillColor=function(y,B,se,de){return wo=li({ch1:y,ch2:B,ch3:se,ch4:de,pdfColorType:"fill",precision:2}),ie(wo),this};var Di=t.textColor||"0 g",ss=p.__private__.getTextColor=p.getTextColor=function(){return Pi(Di)};p.__private__.setTextColor=p.setTextColor=function(y,B,se,de){return Di=li({ch1:y,ch2:B,ch3:se,ch4:de,pdfColorType:"text",precision:3}),this};var Da=t.charSpace,Ll=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(Da||0)};p.__private__.setCharSpace=p.setCharSpace=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Da=y,this};var gn=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(y){var B=p.CapJoinStyles[y];if(B===void 0)throw new Error("Line cap style of '"+y+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return gn=B,ie(B+" J"),this};var Dl=0;p.__private__.setLineJoin=p.setLineJoin=function(y){var B=p.CapJoinStyles[y];if(B===void 0)throw new Error("Line join style of '"+y+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Dl=B,ie(B+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(y){if(y=y||0,isNaN(y))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ie(j(E(y))+" M"),this},p.GState=up,p.setGState=function(y){(y=typeof y=="string"?St[Rn[y]]:Oa(null,y)).equals(Sn)||(ie("/"+y.id+" gs"),Sn=y)};var Oa=function(y,B){if(!y||!Rn[y]){var se=!1;for(var de in St)if(St.hasOwnProperty(de)&&St[de].equals(B)){se=!0;break}if(se)B=St[de];else{var ge="GS"+(Object.keys(St).length+1).toString(10);St[ge]=B,B.id=ge}return y&&(Rn[y]=B.id),Mt.publish("addGState",B),B}};p.addGState=function(y,B){return Oa(y,B),this},p.saveGraphicsState=function(){return ie("q"),an.push({key:ot,size:De,color:Di}),this},p.restoreGraphicsState=function(){ie("Q");var y=an.pop();return ot=y.key,De=y.size,Di=y.color,Sn=null,this},p.setCurrentTransformationMatrix=function(y){return ie(y.toString()+" cm"),this},p.comment=function(y){return ie("#"+y),this};var na=function(y,B){var se=y||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return se},set:function(Se){isNaN(Se)||(se=parseFloat(Se))}});var de=B||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return de},set:function(Se){isNaN(Se)||(de=parseFloat(Se))}});var ge="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ge},set:function(Se){ge=Se.toString()}}),this},No=function(y,B,se,de){na.call(this,y,B),this.type="rect";var ge=se||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ge},set:function(Ce){isNaN(Ce)||(ge=parseFloat(Ce))}});var Se=de||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Se},set:function(Ce){isNaN(Ce)||(Se=parseFloat(Ce))}}),this},Ma=function(){this.page=nn,this.currentPage=S,this.pages=Ee.slice(0),this.pagesContext=xt.slice(0),this.x=ut,this.y=en,this.matrix=Kt,this.width=wi(S),this.height=ks(S),this.outputDestination=Re,this.id="",this.objectNumber=-1};Ma.prototype.restore=function(){nn=this.page,S=this.currentPage,xt=this.pagesContext,Ee=this.pages,ut=this.x,en=this.y,Kt=this.matrix,Ol(S,this.width),ui(S,this.height),Re=this.outputDestination};var ra=function(y,B,se,de,ge){qr.push(new Ma),nn=S=0,Ee=[],ut=y,en=B,Kt=ge,Li([se,de])};for(var ia in p.beginFormObject=function(y,B,se,de,ge){return ra(y,B,se,de,ge),this},p.endFormObject=function(y){return function(B){if(ns[B])qr.pop().restore();else{var se=new Ma,de="Xo"+(Object.keys(Jn).length+1).toString(10);se.id=de,ns[B]=de,Jn[de]=se,Mt.publish("addFormObject",se),qr.pop().restore()}}(y),this},p.doFormObject=function(y,B){var se=Jn[ns[y]];return ie("q"),ie(B.toString()+" cm"),ie("/"+se.id+" Do"),ie("Q"),this},p.getFormObject=function(y){var B=Jn[ns[y]];return{x:B.x,y:B.y,width:B.width,height:B.height,matrix:B.matrix}},p.save=function(y,B){return y=y||"generated.pdf",(B=B||{}).returnPromise=B.returnPromise||!1,B.returnPromise===!1?(Kl(Js(Es()),y),typeof Kl.unload=="function"&&Et.setTimeout&&setTimeout(Kl.unload,911),this):new Promise(function(se,de){try{var ge=Kl(Js(Es()),y);typeof Kl.unload=="function"&&Et.setTimeout&&setTimeout(Kl.unload,911),se(ge)}catch(Se){de(Se.message)}})},ct.API)ct.API.hasOwnProperty(ia)&&(ia==="events"&&ct.API.events.length?function(y,B){var se,de,ge;for(ge=B.length-1;ge!==-1;ge--)se=B[ge][0],de=B[ge][1],y.subscribe.apply(y,[se].concat(typeof de=="function"?[de]:de))}(Mt,ct.API.events):p[ia]=ct.API[ia]);function wi(y){return xt[y].mediaBox.topRightX-xt[y].mediaBox.bottomLeftX}function Ol(y,B){xt[y].mediaBox.topRightX=B+xt[y].mediaBox.bottomLeftX}function ks(y){return xt[y].mediaBox.topRightY-xt[y].mediaBox.bottomLeftY}function ui(y,B){xt[y].mediaBox.topRightY=B+xt[y].mediaBox.bottomLeftY}var Ml=p.getPageWidth=function(y){return wi(y=y||S)/yt},_o=p.setPageWidth=function(y,B){Ol(y,B*yt)},as=p.getPageHeight=function(y){return ks(y=y||S)/yt},Fl=p.setPageHeight=function(y,B){ui(y,B*yt)};return p.internal={pdfEscape:Sr,getStyle:Ra,getFont:is,getFontSize:qe,getCharSpace:Ll,getTextColor:ss,getLineHeight:Hu,getLineHeightFactor:Gu,getLineWidth:bt,write:Ge,getHorizontalCoordinate:kr,getVerticalCoordinate:As,getCoordinateString:Ku,getVerticalCoordinateString:bo,collections:{},newObject:Ln,newAdditionalObject:ja,newObjectDeferred:dr,newObjectDeferredBegin:Dn,getFilters:Wr,putStream:Zn,events:Mt,scaleFactor:yt,pageSize:{getWidth:function(){return Ml(S)},setWidth:function(y){_o(S,y)},getHeight:function(){return as(S)},setHeight:function(y){Fl(S,y)}},encryptionOptions:f,encryption:on,getEncryptor:function(y){return f!==null?on.encryptor(y,0):function(B){return B}},output:yi,getNumberOfPages:Tl,pages:Ee,out:ie,f2:A,f3:L,getPageInfo:ci,getPageInfoByObjId:vo,getCurrentPageInfo:yo,getPDFVersion:k,Point:na,Rectangle:No,Matrix:mt,hasHotfix:Pa},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return Ml(S)},set:function(y){_o(S,y)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return as(S)},set:function(y){Fl(S,y)},enumerable:!0,configurable:!0}),(function(y){for(var B=0,se=at.length;B<se;B++){var de=po.call(this,y[B][0],y[B][1],y[B][2],at[B][3],!0);v===!1&&(g[de]=!0);var ge=y[B][0].split("-");Al({id:de,fontName:ge[0],fontStyle:ge[1]||""})}Mt.publish("addFonts",{fonts:tt,dictionary:Nt})}).call(p,at),ot="F1",go(i,n),Mt.publish("initialized"),p}Fc.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Fc.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Fc.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},Fc.prototype.processOwnerPassword=function(t,e){return Jv(Xv(e).substr(0,5),t)},Fc.prototype.encryptor=function(t,e){var n=Xv(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return Jv(n,r)}},up.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||hn(t)!==hn(this))return!1;var r=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;r++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&r--;return r===0},ct.API={events:[]},ct.version="3.0.3";var Qn=ct.API,t2=1,Ec=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Rc=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},jt=function(t){return t.toFixed(2)},Vo=function(t){return t.toFixed(5)};Qn.__acroform__={};var Ii=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},f5=function(t){return t*t2},ua=function(t){var e=new YA,n=Xe.internal.getHeight(t)||0,r=Xe.internal.getWidth(t)||0;return e.BBox=[0,0,Number(jt(r)),Number(jt(n))],e},$D=Qn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},zD=Qn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},qD=Qn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},or=Qn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return qD(t,e-1)},lr=Qn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return $D(t,e-1)},cr=Qn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return zD(t,e-1)},HD=Qn.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,i=t[0],s=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=n(i)||0,c.lowerLeft_Y=r(s+l)||0,c.upperRight_X=n(i+o)||0,c.upperRight_Y=r(s)||0,[Number(jt(c.lowerLeft_X)),Number(jt(c.lowerLeft_Y)),Number(jt(c.upperRight_X)),Number(jt(c.upperRight_Y))]},WD=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,r=Zv(t,n),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+jt(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=ua(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},Zv=function(t,e){var n=t.fontSize===0?t.maxFontSize:t.fontSize,r={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(A){return A.split(`
`)}):i.map(function(A){return[A]});var s=n,o=Xe.internal.getHeight(t)||0;o=o<0?-o:o;var l=Xe.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(A,L,E){if(A+1<i.length){var M=L+" "+i[A+1][0];return Mf(M,t,E).width<=l-4}return!1};s++;e:for(;s>0;){e="",s--;var u,f,v=Mf("3",t,s).height,g=t.multiline?o-s:(o-v)/2,p=g+=2,T=0,k=0,C=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+Mf(e,t,s=12).width+", FieldWidth:"+l+`
`;break}for(var b="",P=0,R=0;R<i.length;R++)if(i.hasOwnProperty(R)){var D=!1;if(i[R].length!==1&&C!==i[R].length-1){if((v+2)*(P+2)+2>o)continue e;b+=i[R][C],D=!0,k=R,R--}else{b=(b+=i[R][C]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var Z=parseInt(R),le=c(Z,b,s),U=R>=i.length-1;if(le&&!U){b+=" ",C=0;continue}if(le||U){if(U)k=Z;else if(t.multiline&&(v+2)*(P+2)+2>o)continue e}else{if(!t.multiline||(v+2)*(P+2)+2>o)continue e;k=Z}}for(var j="",_=T;_<=k;_++){var F=i[_];if(t.multiline){if(_===k){j+=F[C]+" ",C=(C+1)%F.length;continue}if(_===T){j+=F[F.length-1]+" ";continue}}j+=F[0]+" "}switch(j=j.substr(j.length-1)==" "?j.substr(0,j.length-1):j,f=Mf(j,t,s).width,t.textAlign){case"right":u=l-f-2;break;case"center":u=(l-f)/2;break;default:u=2}e+=jt(u)+" "+jt(p)+` Td
`,e+="("+Ec(j)+`) Tj
`,e+=-jt(u)+` 0 Td
`,p=-(s+2),f=0,T=D?k:k+1,P++,b=""}break}return r.text=e,r.fontSize=s,r},Mf=function(t,e,n){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:i}},GD={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},KD=function(t,e){var n={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},YD=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(qs.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(GD)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");t2=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new QA,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var s=r[i];s.objId=void 0,s.hasAnnotation&&KD(s,n)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(n){(function(r,i){var s=!r;for(var o in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(o)){var l=r[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=HD(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Xe.createDefaultAppearanceStream(l),hn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var f=WD(l);c.push({key:"AP",value:"<</N "+f+">>"}),i.internal.acroformPlugin.xForms.push(f)}if(l.appearanceStreamContent){var v="";for(var g in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(g)){var p=l.appearanceStreamContent[g];if(v+="/"+g+" ",v+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var o in p)if(p.hasOwnProperty(o)){var T=p[o];typeof T=="function"&&(T=T.call(i,l)),v+="/"+o+" "+T+" ",i.internal.acroformPlugin.xForms.indexOf(T)>=0||i.internal.acroformPlugin.xForms.push(T)}}else typeof(T=p)=="function"&&(T=T.call(i,l)),v+="/"+o+" "+T,i.internal.acroformPlugin.xForms.indexOf(T)>=0||i.internal.acroformPlugin.xForms.push(T);v+=">>"}c.push({key:"AP",value:`<<
`+v+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}s&&function(k,C){for(var b in k)if(k.hasOwnProperty(b)){var P=b,R=k[b];C.internal.newObjectDeferredBegin(R.objId,!0),hn(R)==="object"&&typeof R.putStream=="function"&&R.putStream(),delete k[P]}}(i.internal.acroformPlugin.xForms,i)})(n,t)}),t.internal.acroformPlugin.isInitialized=!0}},KA=Qn.__acroform__.arrayToPdfArray=function(t,e,n){var r=function(o){return o};if(Array.isArray(t)){for(var i="[",s=0;s<t.length;s++)switch(s!==0&&(i+=" "),hn(t[s])){case"boolean":case"number":case"object":i+=t[s].toString();break;case"string":t[s].substr(0,1)!=="/"?(e!==void 0&&n&&(r=n.internal.getEncryptor(e)),i+="("+Ec(r(t[s].toString()))+")"):i+=t[s].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},w0=function(t,e,n){var r=function(i){return i};return e!==void 0&&n&&(r=n.internal.getEncryptor(e)),(t=t||"").toString(),"("+Ec(r(t))+")"},ma=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ma.prototype.toString=function(){return this.objId+" 0 R"},ma.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},ma.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var r=e[n],i=this[r];i&&(Array.isArray(i)?t.push({key:r,value:KA(i,this.objId,this.scope)}):i instanceof ma?(i.scope=this.scope,t.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:r,value:i}))}return t};var YA=function(){ma.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){t=n.trim()},get:function(){return t||null}})};Ii(YA,ma);var QA=function(){ma.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Ec(n(t))+")"}},set:function(n){t=n}})};Ii(QA,ma);var qs=function t(){ma.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');e=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!or(e,3)},set:function(b){b?this.F=lr(e,3):this.F=cr(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');n=b}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(b){r=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(b){r[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(b){r[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(b){r[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(b){r[3]=b}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof dp)return;s="FieldObject"+t.FieldNum++}var b=function(P){return P};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+Ec(b(s))+")"},set:function(b){s=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(b){s=b}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(b){o=b}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(b){l=b}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(b){c=b}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/t2:u},set:function(b){u=b}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(b){f=b}});var v="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!v||this instanceof dp||this instanceof sc))return w0(v,this.objId,this.scope)},set:function(b){b=b.toString(),v=b}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof Cr==0?w0(g,this.objId,this.scope):g},set:function(b){b=b.toString(),g=this instanceof Cr==0?b.substr(0,1)==="("?Rc(b.substr(1,b.length-2)):Rc(b):b}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Cr==1?Rc(g.substr(1,g.length-1)):g},set:function(b){b=b.toString(),g=this instanceof Cr==1?"/"+b:b}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Cr==0?w0(p,this.objId,this.scope):p},set:function(b){b=b.toString(),p=this instanceof Cr==0?b.substr(0,1)==="("?Rc(b.substr(1,b.length-2)):Rc(b):b}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Cr==1?Rc(p.substr(1,p.length-1)):p},set:function(b){b=b.toString(),p=this instanceof Cr==1?"/"+b:b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var T,k=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return k},set:function(b){b=!!b,k=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(T)return T},set:function(b){T=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,1)},set:function(b){b?this.Ff=lr(this.Ff,1):this.Ff=cr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,2)},set:function(b){b?this.Ff=lr(this.Ff,2):this.Ff=cr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,3)},set:function(b){b?this.Ff=lr(this.Ff,3):this.Ff=cr(this.Ff,3)}});var C=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(C!==null)return C},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');C=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(C){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:C=2;break;case"center":case 1:C=1;break;default:C=0}}})};Ii(qs,ma);var du=function(){qs.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){t=n}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return KA(e,this.objId,this.scope)},set:function(n){var r,i;i=[],typeof(r=n)=="string"&&(i=function(s,o,l){l||(l=1);for(var c,u=[];c=o.exec(s);)u.push(c[l]);return u}(r,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(n){e=n,this.sort&&e.sort()},this.addOption=function(n){n=(n=n||"").toString(),e.push(n),this.sort&&e.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();e.indexOf(n)!==-1&&(e.splice(e.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,18)},set:function(n){n?this.Ff=lr(this.Ff,18):this.Ff=cr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=lr(this.Ff,19):this.Ff=cr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,20)},set:function(n){n?(this.Ff=lr(this.Ff,20),e.sort()):this.Ff=cr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,22)},set:function(n){n?this.Ff=lr(this.Ff,22):this.Ff=cr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,23)},set:function(n){n?this.Ff=lr(this.Ff,23):this.Ff=cr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,27)},set:function(n){n?this.Ff=lr(this.Ff,27):this.Ff=cr(this.Ff,27)}}),this.hasAppearanceStream=!1};Ii(du,qs);var hu=function(){du.call(this),this.fontName="helvetica",this.combo=!1};Ii(hu,du);var fu=function(){hu.call(this),this.combo=!0};Ii(fu,hu);var um=function(){fu.call(this),this.edit=!0};Ii(um,fu);var Cr=function(){qs.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,15)},set:function(n){n?this.Ff=lr(this.Ff,15):this.Ff=cr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,16)},set:function(n){n?this.Ff=lr(this.Ff,16):this.Ff=cr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,17)},set:function(n){n?this.Ff=lr(this.Ff,17):this.Ff=cr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,26)},set:function(n){n?this.Ff=lr(this.Ff,26):this.Ff=cr(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(s){return s};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,i=[];for(r in i.push("<<"),e)i.push("/"+r+" ("+Ec(n(e[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(n){hn(n)==="object"&&(e=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(n){typeof n=="string"&&(e.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+n}})};Ii(Cr,qs);var dm=function(){Cr.call(this),this.pushButton=!0};Ii(dm,Cr);var mu=function(){Cr.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Ii(mu,Cr);var dp=function(){var t,e;qs.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),r)o.push("/"+s+" ("+Ec(i(r[s]))+")");return o.push(">>"),o.join(`
`)},set:function(i){hn(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(i){n=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(i){n="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Xe.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ii(dp,qs),mu.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},mu.prototype.createOption=function(t){var e=new dp;return e.Parent=this,e.optionName=t,this.Kids.push(e),QD.call(this.scope,e),e};var hm=function(){Cr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Xe.CheckBox.createAppearanceStream()};Ii(hm,Cr);var sc=function(){qs.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,13)},set:function(e){e?this.Ff=lr(this.Ff,13):this.Ff=cr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,21)},set:function(e){e?this.Ff=lr(this.Ff,21):this.Ff=cr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,23)},set:function(e){e?this.Ff=lr(this.Ff,23):this.Ff=cr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,24)},set:function(e){e?this.Ff=lr(this.Ff,24):this.Ff=cr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,25)},set:function(e){e?this.Ff=lr(this.Ff,25):this.Ff=cr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,26)},set:function(e){e?this.Ff=lr(this.Ff,26):this.Ff=cr(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ii(sc,qs);var fm=function(){sc.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!or(this.Ff,14)},set:function(t){t?this.Ff=lr(this.Ff,14):this.Ff=cr(this.Ff,14)}}),this.password=!0};Ii(fm,sc);var Xe={CheckBox:{createAppearanceStream:function(){return{N:{On:Xe.CheckBox.YesNormal},D:{On:Xe.CheckBox.YesPushDown,Off:Xe.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=ua(t);e.scope=t.scope;var n=[],r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),s=Zv(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+jt(Xe.internal.getWidth(t))+" "+jt(Xe.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+jt(s.fontSize)+" Tf "+i),n.push("BT"),n.push(s.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(t){var e=ua(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),i=[],s=Xe.internal.getHeight(t),o=Xe.internal.getWidth(t),l=Zv(t,t.caption);return i.push("1 g"),i.push("0 0 "+jt(o)+" "+jt(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+jt(o-1)+" "+jt(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+n+" "+jt(l.fontSize)+" Tf "+r),i.push(l.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=ua(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+jt(Xe.internal.getWidth(t))+" "+jt(Xe.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Xe.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Xe.RadioButton.Circle.YesNormal,e.D[t]=Xe.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=ua(t);e.scope=t.scope;var n=[],r=Xe.internal.getWidth(t)<=Xe.internal.getHeight(t)?Xe.internal.getWidth(t)/4:Xe.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Xe.internal.Bezier_C,s=Number((r*i).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Vo(Xe.internal.getWidth(t)/2)+" "+Vo(Xe.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),n.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),n.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),n.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=ua(t);e.scope=t.scope;var n=[],r=Xe.internal.getWidth(t)<=Xe.internal.getHeight(t)?Xe.internal.getWidth(t)/4:Xe.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Xe.internal.Bezier_C).toFixed(5)),o=Number((r*Xe.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Vo(Xe.internal.getWidth(t)/2)+" "+Vo(Xe.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Vo(Xe.internal.getWidth(t)/2)+" "+Vo(Xe.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),n.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),n.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),n.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=ua(t);e.scope=t.scope;var n=[],r=Xe.internal.getWidth(t)<=Xe.internal.getHeight(t)?Xe.internal.getWidth(t)/4:Xe.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Xe.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Vo(Xe.internal.getWidth(t)/2)+" "+Vo(Xe.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Xe.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Xe.RadioButton.Cross.YesNormal,e.D[t]=Xe.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=ua(t);e.scope=t.scope;var n=[],r=Xe.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+jt(Xe.internal.getWidth(t)-2)+" "+jt(Xe.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(jt(r.x1.x)+" "+jt(r.x1.y)+" m"),n.push(jt(r.x2.x)+" "+jt(r.x2.y)+" l"),n.push(jt(r.x4.x)+" "+jt(r.x4.y)+" m"),n.push(jt(r.x3.x)+" "+jt(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=ua(t);e.scope=t.scope;var n=Xe.internal.calculateCross(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+jt(Xe.internal.getWidth(t))+" "+jt(Xe.internal.getHeight(t))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+jt(Xe.internal.getWidth(t)-2)+" "+jt(Xe.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(jt(n.x1.x)+" "+jt(n.x1.y)+" m"),r.push(jt(n.x2.x)+" "+jt(n.x2.y)+" l"),r.push(jt(n.x4.x)+" "+jt(n.x4.y)+" m"),r.push(jt(n.x3.x)+" "+jt(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=ua(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+jt(Xe.internal.getWidth(t))+" "+jt(Xe.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};Xe.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Xe.internal.getWidth(t),n=Xe.internal.getHeight(t),r=Math.min(e,n);return{x1:{x:(e-r)/2,y:(n-r)/2+r},x2:{x:(e-r)/2+r,y:(n-r)/2},x3:{x:(e-r)/2,y:(n-r)/2},x4:{x:(e-r)/2+r,y:(n-r)/2+r}}}},Xe.internal.getWidth=function(t){var e=0;return hn(t)==="object"&&(e=f5(t.Rect[2])),e},Xe.internal.getHeight=function(t){var e=0;return hn(t)==="object"&&(e=f5(t.Rect[3])),e};var QD=Qn.addField=function(t){if(YD(this,t),!(t instanceof qs))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Qn.AcroFormChoiceField=du,Qn.AcroFormListBox=hu,Qn.AcroFormComboBox=fu,Qn.AcroFormEditBox=um,Qn.AcroFormButton=Cr,Qn.AcroFormPushButton=dm,Qn.AcroFormRadioButton=mu,Qn.AcroFormCheckBox=hm,Qn.AcroFormTextField=sc,Qn.AcroFormPasswordField=fm,Qn.AcroFormAppearance=Xe,Qn.AcroForm={ChoiceField:du,ListBox:hu,ComboBox:fu,EditBox:um,Button:Cr,PushButton:dm,RadioButton:mu,CheckBox:hm,TextField:sc,PasswordField:fm,Appearance:Xe},ct.AcroForm={ChoiceField:du,ListBox:hu,ComboBox:fu,EditBox:um,Button:Cr,PushButton:dm,RadioButton:mu,CheckBox:hm,TextField:sc,PasswordField:fm,Appearance:Xe};ct.AcroForm;function XA(t){return t.reduce(function(e,n,r){return e[n]=r,e},{})}(function(t){var e="addImage_";t.__addimage__={};var n="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=t.__addimage__.getImageFileTypeByImageData=function(A,L){var E,M,G,K,z,q=n;if((L=L||n)==="RGBA"||A.data!==void 0&&A.data instanceof Uint8ClampedArray&&"height"in A&&"width"in A)return"RGBA";if(le(A))for(z in r)for(G=r[z],E=0;E<G.length;E+=1){for(K=!0,M=0;M<G[E].length;M+=1)if(G[E][M]!==void 0&&G[E][M]!==A[M]){K=!1;break}if(K===!0){q=z;break}}else for(z in r)for(G=r[z],E=0;E<G.length;E+=1){for(K=!0,M=0;M<G[E].length;M+=1)if(G[E][M]!==void 0&&G[E][M]!==A.charCodeAt(M)){K=!1;break}if(K===!0){q=z;break}}return q===n&&L!==n&&(q=L),q},s=function A(L){for(var E=this.internal.write,M=this.internal.putStream,G=(0,this.internal.getFilters)();G.indexOf("FlateEncode")!==-1;)G.splice(G.indexOf("FlateEncode"),1);L.objectId=this.internal.newObject();var K=[];if(K.push({key:"Type",value:"/XObject"}),K.push({key:"Subtype",value:"/Image"}),K.push({key:"Width",value:L.width}),K.push({key:"Height",value:L.height}),L.colorSpace===b.INDEXED?K.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(L.palette.length/3-1)+" "+("sMask"in L&&L.sMask!==void 0?L.objectId+2:L.objectId+1)+" 0 R]"}):(K.push({key:"ColorSpace",value:"/"+L.colorSpace}),L.colorSpace===b.DEVICE_CMYK&&K.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),K.push({key:"BitsPerComponent",value:L.bitsPerComponent}),"decodeParameters"in L&&L.decodeParameters!==void 0&&K.push({key:"DecodeParms",value:"<<"+L.decodeParameters+">>"}),"transparency"in L&&Array.isArray(L.transparency)&&L.transparency.length>0){for(var z="",q=0,H=L.transparency.length;q<H;q++)z+=L.transparency[q]+" "+L.transparency[q]+" ";K.push({key:"Mask",value:"["+z+"]"})}L.sMask!==void 0&&K.push({key:"SMask",value:L.objectId+1+" 0 R"});var X=L.filter!==void 0?["/"+L.filter]:void 0;if(M({data:L.data,additionalKeyValues:K,alreadyAppliedFilters:X,objectId:L.objectId}),E("endobj"),"sMask"in L&&L.sMask!==void 0){var ne,w=(ne=L.sMaskBitsPerComponent)!==null&&ne!==void 0?ne:L.bitsPerComponent,S={width:L.width,height:L.height,colorSpace:"DeviceGray",bitsPerComponent:w,data:L.sMask};"filter"in L&&(S.decodeParameters="/Predictor ".concat(L.predictor," /Colors 1 /BitsPerComponent ").concat(w," /Columns ").concat(L.width),S.filter=L.filter),A.call(this,S)}if(L.colorSpace===b.INDEXED){var V=this.internal.newObject();M({data:j(new Uint8Array(L.palette)),objectId:V}),E("endobj")}},o=function(){var A=this.internal.collections[e+"images"];for(var L in A)s.call(this,A[L])},l=function(){var A,L=this.internal.collections[e+"images"],E=this.internal.write;for(var M in L)E("/I"+(A=L[M]).index,A.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var A=this.internal.collections[e+"images"];return c.call(this),A},f=function(){return Object.keys(this.internal.collections[e+"images"]).length},v=function(A){return typeof t["process"+A.toUpperCase()]=="function"},g=function(A){return hn(A)==="object"&&A.nodeType===1},p=function(A,L){if(A.nodeName==="IMG"&&A.hasAttribute("src")){var E=""+A.getAttribute("src");if(E.indexOf("data:image/")===0)return cm(unescape(E).split("base64,").pop());var M=t.loadFile(E,!0);if(M!==void 0)return M}if(A.nodeName==="CANVAS"){if(A.width===0||A.height===0)throw new Error("Given canvas must have data. Canvas width: "+A.width+", height: "+A.height);var G;switch(L){case"PNG":G="image/png";break;case"WEBP":G="image/webp";break;default:G="image/jpeg"}return cm(A.toDataURL(G,1).split("base64,").pop())}},T=function(A){var L=this.internal.collections[e+"images"];if(L){for(var E in L)if(A===L[E].alias)return L[E]}},k=function(A,L,E){return A||L||(A=-96,L=-96),A<0&&(A=-1*E.width*72/A/this.internal.scaleFactor),L<0&&(L=-1*E.height*72/L/this.internal.scaleFactor),A===0&&(A=L*E.width/E.height),L===0&&(L=A*E.height/E.width),[A,L]},C=function(A,L,E,M,G,K){var z=k.call(this,E,M,G),q=this.internal.getCoordinateString,H=this.internal.getVerticalCoordinateString,X=u.call(this);if(E=z[0],M=z[1],X[G.index]=G,K){K*=Math.PI/180;var ne=Math.cos(K),w=Math.sin(K),S=function(ee){return ee.toFixed(4)},V=[S(ne),S(w),S(-1*w),S(ne),0,0,"cm"]}this.internal.write("q"),K?(this.internal.write([1,"0","0",1,q(A),H(L+M),"cm"].join(" ")),this.internal.write(V.join(" ")),this.internal.write([q(E),"0","0",q(M),"0","0","cm"].join(" "))):this.internal.write([q(E),"0","0",q(M),q(A),H(L+M),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+G.index+" Do"),this.internal.write("Q")},b=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var P=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},R=t.__addimage__.sHashCode=function(A){var L,E,M=0;if(typeof A=="string")for(E=A.length,L=0;L<E;L++)M=(M<<5)-M+A.charCodeAt(L),M|=0;else if(le(A))for(E=A.byteLength/2,L=0;L<E;L++)M=(M<<5)-M+A[L],M|=0;return M},D=t.__addimage__.validateStringAsBase64=function(A){(A=A||"").toString().trim();var L=!0;return A.length===0&&(L=!1),A.length%4!=0&&(L=!1),/^[A-Za-z0-9+/]+$/.test(A.substr(0,A.length-2))===!1&&(L=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(A.substr(-2))===!1&&(L=!1),L},Z=t.__addimage__.extractImageFromDataUrl=function(A){if(A==null||!(A=A.trim()).startsWith("data:"))return null;var L=A.indexOf(",");return L<0?null:A.substring(0,L).trim().endsWith("base64")?A.substring(L+1):null};t.__addimage__.isArrayBuffer=function(A){return A instanceof ArrayBuffer};var le=t.__addimage__.isArrayBufferView=function(A){return A instanceof Int8Array||A instanceof Uint8Array||A instanceof Uint8ClampedArray||A instanceof Int16Array||A instanceof Uint16Array||A instanceof Int32Array||A instanceof Uint32Array||A instanceof Float32Array||A instanceof Float64Array},U=t.__addimage__.binaryStringToUint8Array=function(A){for(var L=A.length,E=new Uint8Array(L),M=0;M<L;M++)E[M]=A.charCodeAt(M);return E},j=t.__addimage__.arrayBufferToBinaryString=function(A){for(var L="",E=le(A)?A:new Uint8Array(A),M=0;M<E.length;M+=8192)L+=String.fromCharCode.apply(null,E.subarray(M,M+8192));return L};t.addImage=function(){var A,L,E,M,G,K,z,q,H;if(typeof arguments[1]=="number"?(L=n,E=arguments[1],M=arguments[2],G=arguments[3],K=arguments[4],z=arguments[5],q=arguments[6],H=arguments[7]):(L=arguments[1],E=arguments[2],M=arguments[3],G=arguments[4],K=arguments[5],z=arguments[6],q=arguments[7],H=arguments[8]),hn(A=arguments[0])==="object"&&!g(A)&&"imageData"in A){var X=A;A=X.imageData,L=X.format||L||n,E=X.x||E||0,M=X.y||M||0,G=X.w||X.width||G,K=X.h||X.height||K,z=X.alias||z,q=X.compression||q,H=X.rotation||X.angle||H}var ne=this.internal.getFilters();if(q===void 0&&ne.indexOf("FlateEncode")!==-1&&(q="SLOW"),isNaN(E)||isNaN(M))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var w=_.call(this,A,L,z,q);return C.call(this,E,M,G,K,w,H),this};var _=function(A,L,E,M){var G,K,z;if(typeof A=="string"&&i(A)===n){A=unescape(A);var q=F(A,!1);(q!==""||(q=t.loadFile(A,!0))!==void 0)&&(A=q)}if(g(A)&&(A=p(A,L)),L=i(A,L),!v(L))throw new Error("addImage does not support files of type '"+L+"', please ensure that a plugin for '"+L+"' support is added.");if(((z=E)==null||z.length===0)&&(E=function(H){return typeof H=="string"||le(H)?R(H):le(H.data)?R(H.data):null}(A)),(G=T.call(this,E))||(A instanceof Uint8Array||L==="RGBA"||(K=A,A=U(A)),G=this["process"+L.toUpperCase()](A,f.call(this),E,function(H){return H&&typeof H=="string"&&(H=H.toUpperCase()),H in t.image_compression?H:P.NONE}(M),K)),!G)throw new Error("An unknown error occurred whilst processing the image.");return G},F=t.__addimage__.convertBase64ToBinaryString=function(A,L){L=typeof L!="boolean"||L;var E,M="";if(typeof A=="string"){var G;E=(G=Z(A))!==null&&G!==void 0?G:A;try{M=cm(E)}catch(K){if(L)throw D(E)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+K.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return M};t.getImageProperties=function(A){var L,E,M="";if(g(A)&&(A=p(A)),typeof A=="string"&&i(A)===n&&((M=F(A,!1))===""&&(M=t.loadFile(A)||""),A=M),E=i(A),!v(E))throw new Error("addImage does not support files of type '"+E+"', please ensure that a plugin for '"+E+"' support is added.");if(A instanceof Uint8Array||(A=U(A)),!(L=this["process"+E.toUpperCase()](A)))throw new Error("An unknown error occurred whilst processing the image");return L.fileType=E,L}})(ct.API),function(t){var e=function(n){if(n!==void 0&&n!="")return!0};ct.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(n){for(var r,i,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(n.objId),u=n.pageContext.annotations,f=!1,v=0;v<u.length&&!f;v++)switch((r=u[v]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var g=0;g<u.length;g++){r=u[g];var p=this.internal.pdfEscape,T=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var k=this.internal.newAdditionalObject(),C=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(k.objId),P=r.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(r.bounds.x)+" "+l(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y)+"] ")+"/Contents ("+p(b(r.contents))+")",s+=" /Popup "+C.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+p(b(P))+") >>",k.content=s;var R=k.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(r.bounds.x+30)+" "+l(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w+30)+" "+l(r.bounds.y)+"] ")+" /Parent "+R,r.open&&(s+=" /Open true"),s+=" >>",C.content=s,this.internal.write(k.objId,"0 R",C.objId,"0 R");break;case"freetext":i="/Rect ["+o(r.bounds.x)+" "+l(r.bounds.y)+" "+o(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y+r.bounds.h)+"] ";var D=r.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+p(T(r.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+D+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(r.options.name){var Z=this.annotations._nameMap[r.options.name];r.options.pageNumber=Z.page,r.options.top=Z.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",s="",r.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+p(T(r.options.url))+") >>";else if(r.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,s+=" /FitV "+r.options.left+"]";break;default:var le=l(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),s+=" /XYZ "+r.options.left+" "+le+" "+r.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},t.link=function(n,r,i,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(n),y:u(r),w:c(n+i),h:u(r+s)},options:o,type:"link"})},t.textWithLink=function(n,r,i,s){var o,l,c=this.getTextWidth(n),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var f=this.splitTextToSize(n,l).length;o=Math.ceil(u*f)}else l=c,o=u;return this.text(n,r,i,s),i+=.2*u,s.align==="center"&&(r-=c/2),s.align==="right"&&(r-=c),this.link(r,i-u,l,o,s),c},t.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}}(ct.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(k){return e[k.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(k){return typeof k=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(k)},l=t.__arabicParser__.isArabicEndLetter=function(k){return o(k)&&s(k)&&e[k.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(k){return o(k)&&i.indexOf(k.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(k){return o(k)&&s(k)&&e[k.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(k){return o(k)&&s(k)&&e[k.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(k){return o(k)&&s(k)&&e[k.charCodeAt(0)].length>=3};var f=t.__arabicParser__.arabicLetterHasMedialForm=function(k){return o(k)&&s(k)&&e[k.charCodeAt(0)].length==4},v=t.__arabicParser__.resolveLigatures=function(k){var C=0,b=n,P="",R=0;for(C=0;C<k.length;C+=1)b[k.charCodeAt(C)]!==void 0?(R++,typeof(b=b[k.charCodeAt(C)])=="number"&&(P+=String.fromCharCode(b),b=n,R=0),C===k.length-1&&(b=n,P+=k.charAt(C-(R-1)),C-=R-1,R=0)):(b=n,P+=k.charAt(C-R),C-=R,R=0);return P};t.__arabicParser__.isArabicDiacritic=function(k){return k!==void 0&&r[k.charCodeAt(0)]!==void 0};var g=t.__arabicParser__.getCorrectForm=function(k,C,b){return o(k)?s(k)===!1?-1:!u(k)||!o(C)&&!o(b)||!o(b)&&l(C)||l(k)&&!o(C)||l(k)&&c(C)||l(k)&&l(C)?0:f(k)&&o(C)&&!l(C)&&o(b)&&u(b)?3:l(k)||!o(b)?1:2:-1},p=function(k){var C=0,b=0,P=0,R="",D="",Z="",le=(k=k||"").split("\\s+"),U=[];for(C=0;C<le.length;C+=1){for(U.push(""),b=0;b<le[C].length;b+=1)R=le[C][b],D=le[C][b-1],Z=le[C][b+1],o(R)?(P=g(R,D,Z),U[C]+=P!==-1?String.fromCharCode(e[R.charCodeAt(0)][P]):R):U[C]+=R;U[C]=v(U[C])}return U.join(" ")},T=t.__arabicParser__.processArabic=t.processArabic=function(){var k,C=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(C)){var P=0;for(b=[],P=0;P<C.length;P+=1)Array.isArray(C[P])?b.push([p(C[P][0]),C[P][1],C[P][2]]):b.push([p(C[P])]);k=b}else k=p(C);return typeof arguments[0]=="string"?k:(arguments[0].text=k,arguments[0])};t.events.push(["preProcessText",T])}(ct.API),ct.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(t){var e=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(l){n=l}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(l){r=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(n,r){var i;if((n=n||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(ct.API),function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(k){c=k}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(k){u=k}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(k){f=k}});var v=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return v},set:function(k){v=k}});var g=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return g},set:function(k){g=k}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(k){p=k}});var T=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return T},set:function(k){T=k}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return r.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){r.call(this);var f=(u=u||{}).fontSize||this.getFontSize(),v=u.font||this.getFont(),g=u.scaleFactor||this.internal.scaleFactor,p=0,T=0,k=0,C=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var b=u.maxWidth;b>0?typeof c=="string"?c=this.splitTextToSize(c,b):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(R,D){return R.concat(C.splitTextToSize(D,b))},[])):c=Array.isArray(c)?c:[c];for(var P=0;P<c.length;P++)p<(k=this.getStringUnitWidth(c[P],{font:v})*f)&&(p=k);return p!==0&&(T=c.length),{w:p/=g,h:Math.max((T*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/g,0)}},t.cellAddPage=function(){r.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var u=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,v=this.internal.__cell__.margins||e,g=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+v.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=v.top,p&&g&&(this.printHeaderRow(c.lineNumber,!0),c.y+=g[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,n===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-f,c.y+f,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+f,{align:"center",baseline:"top",maxWidth:c.width-f-f}):this.text(c.text,c.x+f,c.y+f,{align:"left",baseline:"top",maxWidth:c.width-f-f})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,f,v,g){if(r.call(this),!f)throw new Error("No data for PDF table.");var p,T,k,C,b=[],P=[],R=[],D={},Z={},le=[],U=[],j=(g=g||{}).autoSize||!1,_=g.printHeaders!==!1,F=g.css&&g.css["font-size"]!==void 0?16*g.css["font-size"]:g.fontSize||12,A=g.margins||Object.assign({width:this.getPageWidth()},e),L=typeof g.padding=="number"?g.padding:3,E=g.headerBackgroundColor||"#c8c8c8",M=g.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=_,this.internal.__cell__.margins=A,this.internal.__cell__.table_font_size=F,this.internal.__cell__.padding=L,this.internal.__cell__.headerBackgroundColor=E,this.internal.__cell__.headerTextColor=M,this.setFontSize(F),v==null)P=b=Object.keys(f[0]),R=b.map(function(){return"left"});else if(Array.isArray(v)&&hn(v[0])==="object")for(b=v.map(function(X){return X.name}),P=v.map(function(X){return X.prompt||X.name||""}),R=v.map(function(X){return X.align||"left"}),p=0;p<v.length;p+=1)Z[v[p].name]=.7499990551181103*v[p].width;else Array.isArray(v)&&typeof v[0]=="string"&&(P=b=v,R=b.map(function(){return"left"}));if(j||Array.isArray(v)&&typeof v[0]=="string")for(p=0;p<b.length;p+=1){for(D[C=b[p]]=f.map(function(X){return X[C]}),this.setFont(void 0,"bold"),le.push(this.getTextDimensions(P[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),T=D[C],this.setFont(void 0,"normal"),k=0;k<T.length;k+=1)le.push(this.getTextDimensions(T[k],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Z[C]=Math.max.apply(null,le)+L+L,le=[]}if(_){var G={};for(p=0;p<b.length;p+=1)G[b[p]]={},G[b[p]].text=P[p],G[b[p]].align=R[p];var K=l.call(this,G,Z);U=b.map(function(X){return new s(c,u,Z[X],K,G[X].text,void 0,G[X].align)}),this.setTableHeaderRow(U),this.printHeaderRow(1,!1)}var z=v.reduce(function(X,ne){return X[ne.name]=ne.align,X},{});for(p=0;p<f.length;p+=1){"rowStart"in g&&g.rowStart instanceof Function&&g.rowStart({row:p,data:f[p]},this);var q=l.call(this,f[p],Z);for(k=0;k<b.length;k+=1){var H=f[p][b[k]];"cellStart"in g&&g.cellStart instanceof Function&&g.cellStart({row:p,col:k,data:H},this),o.call(this,new s(c,u,Z[b[k]],q,H,p+2,z[b[k]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var f=this.internal.__cell__.padding,v=this.internal.__cell__.table_font_size,g=this.internal.scaleFactor;return Object.keys(c).map(function(p){var T=c[p];return this.splitTextToSize(T.hasOwnProperty("text")?T.text:T,u[p]-f-f)},this).map(function(p){return this.getLineHeightFactor()*p.length*v/g+f+f},this).reduce(function(p,T){return Math.max(p,T)},0)};t.setTableHeaderRow=function(c){r.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var v=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(v[0],v[1],v[2],v[3],void 0,-1)}this.setFont(void 0,"bold");for(var g=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){f=this.internal.__cell__.tableHeaderRow[p].clone(),u&&(f.y=this.internal.__cell__.margins.top||0,g.push(f)),f.lineNumber=c;var T=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,f),this.setTextColor(T)}g.length>0&&this.setTableHeaderRow(g),this.setFont(void 0,"normal"),n=!1}}(ct.API);var JA={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},ZA=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],e1=XA(ZA),eS=[100,200,300,400,500,600,700,800,900],XD=XA(eS);function N0(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=function(s){return JA[s=s||"normal"]?s:"normal"}(t.style),r=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(t.weight),i=function(s){return typeof e1[s=s||"normal"]=="number"?s:"normal"}(t.stretch);return{family:e,style:n,weight:r,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,n,r].join(" ")}}}function m5(t,e,n,r){var i;for(i=n;i>=0&&i<e.length;i+=r)if(t[e[i]])return t[e[i]];for(i=n;i>=0&&i<e.length;i-=r)if(t[e[i]])return t[e[i]]}var JD={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},p5={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function g5(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function v5(t){return t.trimLeft()}function ZD(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function eO(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Ff,y5,x5,Lc,Uf,b5,w5,N5,_0=["times"];function _5(t,e,n,r,i){var s=4,o=A5;switch(i){case ct.API.image_compression.FAST:s=1,o=E5;break;case ct.API.image_compression.MEDIUM:s=6,o=S5;break;case ct.API.image_compression.SLOW:s=9,o=k5}t=function(c,u,f,v){for(var g,p=c.length/u,T=new Uint8Array(c.length+p),k=[tO,E5,A5,S5,k5],C=0;C<p;C+=1){var b=C*u,P=c.subarray(b,b+u);if(v)T.set(v(P,f,g),b+C);else{for(var R=k.length,D=[],Z=0;Z<R;Z+=1)D[Z]=k[Z](P,f,g);var le=rO(D.concat());T.set(D[le],b+C)}g=P}return T}(t,e,Math.ceil(n*r/8),o);var l=Gv(t,{level:s});return ct.API.__addimage__.arrayBufferToBinaryString(l)}function tO(t){var e=Array.apply([],t);return e.unshift(0),e}function E5(t,e){var n=t.length,r=[];r[0]=1;for(var i=0;i<n;i+=1){var s=t[i-e]||0;r[i+1]=t[i]-s+256&255}return r}function A5(t,e,n){var r=t.length,i=[];i[0]=2;for(var s=0;s<r;s+=1){var o=n&&n[s]||0;i[s+1]=t[s]-o+256&255}return i}function S5(t,e,n){var r=t.length,i=[];i[0]=3;for(var s=0;s<r;s+=1){var o=t[s-e]||0,l=n&&n[s]||0;i[s+1]=t[s]+256-(o+l>>>1)&255}return i}function k5(t,e,n){var r=t.length,i=[];i[0]=4;for(var s=0;s<r;s+=1){var o=nO(t[s-e]||0,n&&n[s]||0,n&&n[s-e]||0);i[s+1]=t[s]-o+256&255}return i}function nO(t,e,n){if(t===e&&e===n)return t;var r=Math.abs(e-n),i=Math.abs(t-n),s=Math.abs(t+e-n-n);return r<=i&&r<=s?t:i<=s?e:n}function rO(t){var e=t.map(function(n){return n.reduce(function(r,i){return r+Math.abs(i)},0)});return e.indexOf(Math.min.apply(null,e))}function E0(t,e,n){var r=e*n,i=Math.floor(r/8),s=16-(r-8*i+n),o=(1<<n)-1;return tS(t,i)>>s&o}function T5(t,e,n,r){var i=n*r,s=Math.floor(i/8),o=16-(i-8*s+r),l=(1<<r)-1,c=(e&l)<<o;(function(u,f,v){if(f+1<u.byteLength)u.setUint16(f,v,!1);else{var g=v>>8&255;u.setUint8(f,g)}})(t,s,tS(t,s)&~(l<<o)&65535|c)}function tS(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function iO(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,r=t[e++]|t[e++]<<8,i=t[e++],s=i>>7,o=1<<1+(7&i);t[e++],t[e++];var l=null,c=null;s&&(l=e,c=o,e+=3*o);var u=!0,f=[],v=0,g=null,p=0,T=null;for(this.width=n,this.height=r;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,T=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((A=t[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var k=t[e++];v=t[e++]|t[e++]<<8,g=t[e++],1&k||(g=null),p=k>>2&7,e++;break;case 254:for(;;){if(!((A=t[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var C=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,P=t[e++]|t[e++]<<8,R=t[e++]|t[e++]<<8,D=t[e++],Z=D>>6&1,le=1<<1+(7&D),U=l,j=c,_=!1;D>>7&&(_=!0,U=e,j=le,e+=3*le);var F=e;for(e++;;){var A;if(!((A=t[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}f.push({x:C,y:b,width:P,height:R,has_local_palette:_,palette_offset:U,palette_size:j,data_offset:F,data_length:e-F,transparent_index:g,interlaced:!!Z,delay:v,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return T},this.frameInfo=function(L){if(L<0||L>=f.length)throw new Error("Frame index out of range.");return f[L]},this.decodeAndBlitFrameBGRA=function(L,E){var M=this.frameInfo(L),G=M.width*M.height,K=new Uint8Array(G);j5(t,M.data_offset,K,G);var z=M.palette_offset,q=M.transparent_index;q===null&&(q=256);var H=M.width,X=n-H,ne=H,w=4*(M.y*n+M.x),S=4*((M.y+M.height)*n+M.x),V=w,ee=4*X;M.interlaced===!0&&(ee+=4*n*7);for(var re=8,ce=0,he=K.length;ce<he;++ce){var me=K[ce];if(ne===0&&(ne=H,(V+=ee)>=S&&(ee=4*X+4*n*(re-1),V=w+(H+X)*(re<<1),re>>=1)),me===q)V+=4;else{var ye=t[z+3*me],Ee=t[z+3*me+1],Pe=t[z+3*me+2];E[V++]=Pe,E[V++]=Ee,E[V++]=ye,E[V++]=255}--ne}},this.decodeAndBlitFrameRGBA=function(L,E){var M=this.frameInfo(L),G=M.width*M.height,K=new Uint8Array(G);j5(t,M.data_offset,K,G);var z=M.palette_offset,q=M.transparent_index;q===null&&(q=256);var H=M.width,X=n-H,ne=H,w=4*(M.y*n+M.x),S=4*((M.y+M.height)*n+M.x),V=w,ee=4*X;M.interlaced===!0&&(ee+=4*n*7);for(var re=8,ce=0,he=K.length;ce<he;++ce){var me=K[ce];if(ne===0&&(ne=H,(V+=ee)>=S&&(ee=4*X+4*n*(re-1),V=w+(H+X)*(re<<1),re>>=1)),me===q)V+=4;else{var ye=t[z+3*me],Ee=t[z+3*me+1],Pe=t[z+3*me+2];E[V++]=ye,E[V++]=Ee,E[V++]=Pe,E[V++]=255}--ne}}}function j5(t,e,n,r){for(var i=t[e++],s=1<<i,o=s+1,l=o+1,c=i+1,u=(1<<c)-1,f=0,v=0,g=0,p=t[e++],T=new Int32Array(4096),k=null;;){for(;f<16&&p!==0;)v|=t[e++]<<f,f+=8,p===1?p=t[e++]:--p;if(f<c)break;var C=v&u;if(v>>=c,f-=c,C!==s){if(C===o)break;for(var b=C<l?C:k,P=0,R=b;R>s;)R=T[R]>>8,++P;var D=R;if(g+P+(b!==C?1:0)>r)return void xn.log("Warning, gif stream longer than expected.");n[g++]=D;var Z=g+=P;for(b!==C&&(n[g++]=D),R=b;P--;)R=T[R],n[--Z]=255&R,R>>=8;k!==null&&l<4096&&(T[l++]=k<<8|D,l>=u+1&&c<12&&(++c,u=u<<1|1)),k=C}else l=o+1,u=(1<<(c=i+1))-1,k=null}return g!==r&&xn.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function A0(t){var e,n,r,i,s,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),f=new Array(64),v=new Array(65535),g=new Array(65535),p=new Array(64),T=new Array(64),k=[],C=0,b=7,P=new Array(64),R=new Array(64),D=new Array(64),Z=new Array(256),le=new Array(2048),U=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],j=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],_=[0,1,2,3,4,5,6,7,8,9,10,11],F=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],A=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],L=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],G=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function K(w,S){for(var V=0,ee=0,re=new Array,ce=1;ce<=16;ce++){for(var he=1;he<=w[ce];he++)re[S[ee]]=[],re[S[ee]][0]=V,re[S[ee]][1]=ce,ee++,V++;V*=2}return re}function z(w){for(var S=w[0],V=w[1]-1;V>=0;)S&1<<V&&(C|=1<<b),V--,--b<0&&(C==255?(q(255),q(0)):q(C),b=7,C=0)}function q(w){k.push(w)}function H(w){q(w>>8&255),q(255&w)}function X(w,S,V,ee,re){for(var ce,he=re[0],me=re[240],ye=function(De,Je){var qe,Ue,Le,zt,At,st,Tt,wt,ot,yt,ut=0;for(ot=0;ot<8;++ot){qe=De[ut],Ue=De[ut+1],Le=De[ut+2],zt=De[ut+3],At=De[ut+4],st=De[ut+5],Tt=De[ut+6];var en=qe+(wt=De[ut+7]),Kt=qe-wt,tt=Ue+Tt,Nt=Ue-Tt,an=Le+st,pt=Le-st,Dt=zt+At,St=zt-At,Rn=en+Dt,Sn=en-Dt,nn=tt+an,xt=tt-an;De[ut]=Rn+nn,De[ut+4]=Rn-nn;var Mt=.707106781*(xt+Sn);De[ut+2]=Sn+Mt,De[ut+6]=Sn-Mt;var Ws=.382683433*((Rn=St+pt)-(xt=Nt+Kt)),Jn=.5411961*Rn+Ws,ns=1.306562965*xt+Ws,qr=.707106781*(nn=pt+Nt),mt=Kt+qr,kn=Kt-qr;De[ut+5]=kn+Jn,De[ut+3]=kn-Jn,De[ut+1]=mt+ns,De[ut+7]=mt-ns,ut+=8}for(ut=0,ot=0;ot<8;++ot){qe=De[ut],Ue=De[ut+8],Le=De[ut+16],zt=De[ut+24],At=De[ut+32],st=De[ut+40],Tt=De[ut+48];var rs=qe+(wt=De[ut+56]),Er=qe-wt,Ar=Ue+Tt,Ln=Ue-Tt,dr=Le+st,Dn=Le-st,ja=zt+At,Gs=zt-At,Hr=rs+ja,Pi=rs-ja,li=Ar+dr,Wr=Ar-dr;De[ut]=Hr+li,De[ut+32]=Hr-li;var Zn=.707106781*(Wr+Pi);De[ut+16]=Pi+Zn,De[ut+48]=Pi-Zn;var Ks=.382683433*((Hr=Gs+Dn)-(Wr=Ln+Er)),Ri=.5411961*Hr+Ks,_s=1.306562965*Wr+Ks,Ys=.707106781*(li=Dn+Ln),Ca=Er+Ys,Ia=Er-Ys;De[ut+40]=Ia+Ri,De[ut+24]=Ia-Ri,De[ut+8]=Ca+_s,De[ut+56]=Ca-_s,ut++}for(ot=0;ot<64;++ot)yt=De[ot]*Je[ot],p[ot]=yt>0?yt+.5|0:yt-.5|0;return p}(w,S),Ee=0;Ee<64;++Ee)T[U[Ee]]=ye[Ee];var Pe=T[0]-V;V=T[0],Pe==0?z(ee[0]):(z(ee[g[ce=32767+Pe]]),z(v[ce]));for(var Re=63;Re>0&&T[Re]==0;)Re--;if(Re==0)return z(he),V;for(var be,ie=1;ie<=Re;){for(var Ge=ie;T[ie]==0&&ie<=Re;)++ie;var it=ie-Ge;if(it>=16){be=it>>4;for(var at=1;at<=be;++at)z(me);it&=15}ce=32767+T[ie],z(re[(it<<4)+g[ce]]),z(v[ce]),ie++}return Re!=63&&z(he),V}function ne(w){w=Math.min(Math.max(w,1),100),s!=w&&(function(S){for(var V=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ee=0;ee<64;ee++){var re=o((V[ee]*S+50)/100);re=Math.min(Math.max(re,1),255),l[U[ee]]=re}for(var ce=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],he=0;he<64;he++){var me=o((ce[he]*S+50)/100);me=Math.min(Math.max(me,1),255),c[U[he]]=me}for(var ye=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ee=0,Pe=0;Pe<8;Pe++)for(var Re=0;Re<8;Re++)u[Ee]=1/(l[U[Ee]]*ye[Pe]*ye[Re]*8),f[Ee]=1/(c[U[Ee]]*ye[Pe]*ye[Re]*8),Ee++}(w<50?Math.floor(5e3/w):Math.floor(200-2*w)),s=w)}this.encode=function(w,S){S&&ne(S),k=new Array,C=0,b=7,H(65496),H(65504),H(16),q(74),q(70),q(73),q(70),q(0),q(1),q(1),q(0),H(1),H(1),q(0),q(0),function(){H(65499),H(132),q(0);for(var Ue=0;Ue<64;Ue++)q(l[Ue]);q(1);for(var Le=0;Le<64;Le++)q(c[Le])}(),function(Ue,Le){H(65472),H(17),q(8),H(Le),H(Ue),q(3),q(1),q(17),q(0),q(2),q(17),q(1),q(3),q(17),q(1)}(w.width,w.height),function(){H(65476),H(418),q(0);for(var Ue=0;Ue<16;Ue++)q(j[Ue+1]);for(var Le=0;Le<=11;Le++)q(_[Le]);q(16);for(var zt=0;zt<16;zt++)q(F[zt+1]);for(var At=0;At<=161;At++)q(A[At]);q(1);for(var st=0;st<16;st++)q(L[st+1]);for(var Tt=0;Tt<=11;Tt++)q(E[Tt]);q(17);for(var wt=0;wt<16;wt++)q(M[wt+1]);for(var ot=0;ot<=161;ot++)q(G[ot])}(),H(65498),H(12),q(3),q(1),q(0),q(2),q(17),q(3),q(17),q(0),q(63),q(0);var V=0,ee=0,re=0;C=0,b=7,this.encode.displayName="_encode_";for(var ce,he,me,ye,Ee,Pe,Re,be,ie,Ge=w.data,it=w.width,at=w.height,De=4*it,Je=0;Je<at;){for(ce=0;ce<De;){for(Ee=De*Je+ce,Re=-1,be=0,ie=0;ie<64;ie++)Pe=Ee+(be=ie>>3)*De+(Re=4*(7&ie)),Je+be>=at&&(Pe-=De*(Je+1+be-at)),ce+Re>=De&&(Pe-=ce+Re-De+4),he=Ge[Pe++],me=Ge[Pe++],ye=Ge[Pe++],P[ie]=(le[he]+le[me+256|0]+le[ye+512|0]>>16)-128,R[ie]=(le[he+768|0]+le[me+1024|0]+le[ye+1280|0]>>16)-128,D[ie]=(le[he+1280|0]+le[me+1536|0]+le[ye+1792|0]>>16)-128;V=X(P,u,V,e,r),ee=X(R,f,ee,n,i),re=X(D,f,re,n,i),ce+=32}Je+=8}if(b>=0){var qe=[];qe[1]=b+1,qe[0]=(1<<b+1)-1,z(qe)}return H(65497),new Uint8Array(k)},t=t||50,function(){for(var w=String.fromCharCode,S=0;S<256;S++)Z[S]=w(S)}(),e=K(j,_),n=K(L,E),r=K(F,A),i=K(M,G),function(){for(var w=1,S=2,V=1;V<=15;V++){for(var ee=w;ee<S;ee++)g[32767+ee]=V,v[32767+ee]=[],v[32767+ee][1]=V,v[32767+ee][0]=ee;for(var re=-(S-1);re<=-w;re++)g[32767+re]=V,v[32767+re]=[],v[32767+re][1]=V,v[32767+re][0]=S-1+re;w<<=1,S<<=1}}(),function(){for(var w=0;w<256;w++)le[w]=19595*w,le[w+256|0]=38470*w,le[w+512|0]=7471*w+32768,le[w+768|0]=-11059*w,le[w+1024|0]=-21709*w,le[w+1280|0]=32768*w+8421375,le[w+1536|0]=-27439*w,le[w+1792|0]=-5329*w}(),ne(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Rs(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function C5(t){function e(_){if(!_)throw Error("assert :P")}function n(_,F,A){for(var L=0;4>L;L++)if(_[F+L]!=A.charCodeAt(L))return!0;return!1}function r(_,F,A,L,E){for(var M=0;M<E;M++)_[F+M]=A[L+M]}function i(_,F,A,L){for(var E=0;E<L;E++)_[F+E]=A}function s(_){return new Int32Array(_)}function o(_,F){for(var A=[],L=0;L<_;L++)A.push(new F);return A}function l(_,F){var A=[];return function L(E,M,G){for(var K=G[M],z=0;z<K&&(E.push(G.length>M+1?[]:new F),!(G.length<M+1));z++)L(E[z],M+1,G)}(A,0,_),A}var c=function(){var _=this;function F(d,m){for(var x=1<<m-1>>>0;d&x;)x>>>=1;return x?(d&x-1)+x:d}function A(d,m,x,I,$){e(!(I%x));do d[m+(I-=x)]=$;while(0<I)}function L(d,m,x,I,$){if(e(2328>=$),512>=$)var W=s(512);else if((W=s($))==null)return 0;return function(Y,Q,te,ae,fe,Ne){var oe,pe,xe=Q,Ae=1<<te,we=s(16),ke=s(16);for(e(fe!=0),e(ae!=null),e(Y!=null),e(0<te),pe=0;pe<fe;++pe){if(15<ae[pe])return 0;++we[ae[pe]]}if(we[0]==fe)return 0;for(ke[1]=0,oe=1;15>oe;++oe){if(we[oe]>1<<oe)return 0;ke[oe+1]=ke[oe]+we[oe]}for(pe=0;pe<fe;++pe)oe=ae[pe],0<ae[pe]&&(Ne[ke[oe]++]=pe);if(ke[15]==1)return(ae=new E).g=0,ae.value=Ne[0],A(Y,xe,1,Ae,ae),Ae;var Te,Me=-1,Ie=Ae-1,lt=0,Qe=1,Rt=1,nt=1<<te;for(pe=0,oe=1,fe=2;oe<=te;++oe,fe<<=1){if(Qe+=Rt<<=1,0>(Rt-=we[oe]))return 0;for(;0<we[oe];--we[oe])(ae=new E).g=oe,ae.value=Ne[pe++],A(Y,xe+lt,fe,nt,ae),lt=F(lt,oe)}for(oe=te+1,fe=2;15>=oe;++oe,fe<<=1){if(Qe+=Rt<<=1,0>(Rt-=we[oe]))return 0;for(;0<we[oe];--we[oe]){if(ae=new E,(lt&Ie)!=Me){for(xe+=nt,Te=1<<(Me=oe)-te;15>Me&&!(0>=(Te-=we[Me]));)++Me,Te<<=1;Ae+=nt=1<<(Te=Me-te),Y[Q+(Me=lt&Ie)].g=Te+te,Y[Q+Me].value=xe-Q-Me}ae.g=oe-te,ae.value=Ne[pe++],A(Y,xe+(lt>>te),fe,nt,ae),lt=F(lt,oe)}}return Qe!=2*ke[15]-1?0:Ae}(d,m,x,I,$,W)}function E(){this.value=this.g=0}function M(){this.value=this.g=0}function G(){this.G=o(5,E),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Vl,M)}function K(d,m,x,I){e(d!=null),e(m!=null),e(2147483648>I),d.Ca=254,d.I=0,d.b=-8,d.Ka=0,d.oa=m,d.pa=x,d.Jd=m,d.Yc=x+I,d.Zc=4<=I?x+I-4+1:x,he(d)}function z(d,m){for(var x=0;0<m--;)x|=ye(d,128)<<m;return x}function q(d,m){var x=z(d,m);return me(d)?-x:x}function H(d,m,x,I){var $,W=0;for(e(d!=null),e(m!=null),e(4294967288>I),d.Sb=I,d.Ra=0,d.u=0,d.h=0,4<I&&(I=4),$=0;$<I;++$)W+=m[x+$]<<8*$;d.Ra=W,d.bb=I,d.oa=m,d.pa=x}function X(d){for(;8<=d.u&&d.bb<d.Sb;)d.Ra>>>=8,d.Ra+=d.oa[d.pa+d.bb]<<Ao-8>>>0,++d.bb,d.u-=8;ee(d)&&(d.h=1,d.u=0)}function ne(d,m){if(e(0<=m),!d.h&&m<=Ui){var x=V(d)&Fi[m];return d.u+=m,X(d),x}return d.h=1,d.u=0}function w(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function S(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function V(d){return d.Ra>>>(d.u&Ao-1)>>>0}function ee(d){return e(d.bb<=d.Sb),d.h||d.bb==d.Sb&&d.u>Ao}function re(d,m){d.u=m,d.h=ee(d)}function ce(d){d.u>=Fa&&(e(d.u>=Fa),X(d))}function he(d){e(d!=null&&d.oa!=null),d.pa<d.Zc?(d.I=(d.oa[d.pa++]|d.I<<8)>>>0,d.b+=8):(e(d!=null&&d.oa!=null),d.pa<d.Yc?(d.b+=8,d.I=d.oa[d.pa++]|d.I<<8):d.Ka?d.b=0:(d.I<<=8,d.b+=8,d.Ka=1))}function me(d){return z(d,1)}function ye(d,m){var x=d.Ca;0>d.b&&he(d);var I=d.b,$=x*m>>>8,W=(d.I>>>I>$)+0;for(W?(x-=$,d.I-=$+1<<I>>>0):x=$+1,I=x,$=0;256<=I;)$+=8,I>>=8;return I=7^$+So[I],d.b-=I,d.Ca=(x<<I)-1,W}function Ee(d,m,x){d[m+0]=x>>24&255,d[m+1]=x>>16&255,d[m+2]=x>>8&255,d[m+3]=255&x}function Pe(d,m){return d[m+0]|d[m+1]<<8}function Re(d,m){return Pe(d,m)|d[m+2]<<16}function be(d,m){return Pe(d,m)|Pe(d,m+2)<<16}function ie(d,m){var x=1<<m;return e(d!=null),e(0<m),d.X=s(x),d.X==null?0:(d.Mb=32-m,d.Xa=m,1)}function Ge(d,m){e(d!=null),e(m!=null),e(d.Xa==m.Xa),r(m.X,0,d.X,0,1<<m.Xa)}function it(){this.X=[],this.Xa=this.Mb=0}function at(d,m,x,I){e(x!=null),e(I!=null);var $=x[0],W=I[0];return $==0&&($=(d*W+m/2)/m),W==0&&(W=(m*$+d/2)/d),0>=$||0>=W?0:(x[0]=$,I[0]=W,1)}function De(d,m){return d+(1<<m)-1>>>m}function Je(d,m){return((4278255360&d)+(4278255360&m)>>>0&4278255360)+((16711935&d)+(16711935&m)>>>0&16711935)>>>0}function qe(d,m){_[m]=function(x,I,$,W,Y,Q,te){var ae;for(ae=0;ae<Y;++ae){var fe=_[d](Q[te+ae-1],$,W+ae);Q[te+ae]=Je(x[I+ae],fe)}}}function Ue(){this.ud=this.hd=this.jd=0}function Le(d,m){return((4278124286&(d^m))>>>1)+(d&m)>>>0}function zt(d){return 0<=d&&256>d?d:0>d?0:255<d?255:void 0}function At(d,m){return zt(d+(d-m+.5>>1))}function st(d,m,x){return Math.abs(m-x)-Math.abs(d-x)}function Tt(d,m,x,I,$,W,Y){for(I=W[Y-1],x=0;x<$;++x)W[Y+x]=I=Je(d[m+x],I)}function wt(d,m,x,I,$){var W;for(W=0;W<x;++W){var Y=d[m+W],Q=Y>>8&255,te=16711935&(te=(te=16711935&Y)+((Q<<16)+Q));I[$+W]=(4278255360&Y)+te>>>0}}function ot(d,m){m.jd=255&d,m.hd=d>>8&255,m.ud=d>>16&255}function yt(d,m,x,I,$,W){var Y;for(Y=0;Y<I;++Y){var Q=m[x+Y],te=Q>>>8,ae=Q,fe=255&(fe=(fe=Q>>>16)+((d.jd<<24>>24)*(te<<24>>24)>>>5));ae=255&(ae=(ae+=(d.hd<<24>>24)*(te<<24>>24)>>>5)+((d.ud<<24>>24)*(fe<<24>>24)>>>5)),$[W+Y]=(4278255360&Q)+(fe<<16)+ae}}function ut(d,m,x,I,$){_[m]=function(W,Y,Q,te,ae,fe,Ne,oe,pe){for(te=Ne;te<oe;++te)for(Ne=0;Ne<pe;++Ne)ae[fe++]=$(Q[I(W[Y++])])},_[d]=function(W,Y,Q,te,ae,fe,Ne){var oe=8>>W.b,pe=W.Ea,xe=W.K[0],Ae=W.w;if(8>oe)for(W=(1<<W.b)-1,Ae=(1<<oe)-1;Y<Q;++Y){var we,ke=0;for(we=0;we<pe;++we)we&W||(ke=I(te[ae++])),fe[Ne++]=$(xe[ke&Ae]),ke>>=oe}else _["VP8LMapColor"+x](te,ae,xe,Ae,fe,Ne,Y,Q,pe)}}function en(d,m,x,I,$){for(x=m+x;m<x;){var W=d[m++];I[$++]=W>>16&255,I[$++]=W>>8&255,I[$++]=255&W}}function Kt(d,m,x,I,$){for(x=m+x;m<x;){var W=d[m++];I[$++]=W>>16&255,I[$++]=W>>8&255,I[$++]=255&W,I[$++]=W>>24&255}}function tt(d,m,x,I,$){for(x=m+x;m<x;){var W=(Y=d[m++])>>16&240|Y>>12&15,Y=240&Y|Y>>28&15;I[$++]=W,I[$++]=Y}}function Nt(d,m,x,I,$){for(x=m+x;m<x;){var W=(Y=d[m++])>>16&248|Y>>13&7,Y=Y>>5&224|Y>>3&31;I[$++]=W,I[$++]=Y}}function an(d,m,x,I,$){for(x=m+x;m<x;){var W=d[m++];I[$++]=255&W,I[$++]=W>>8&255,I[$++]=W>>16&255}}function pt(d,m,x,I,$,W){if(W==0)for(x=m+x;m<x;)Ee(I,((W=d[m++])[0]>>24|W[1]>>8&65280|W[2]<<8&16711680|W[3]<<24)>>>0),$+=32;else r(I,$,d,m,x)}function Dt(d,m){_[m][0]=_[d+"0"],_[m][1]=_[d+"1"],_[m][2]=_[d+"2"],_[m][3]=_[d+"3"],_[m][4]=_[d+"4"],_[m][5]=_[d+"5"],_[m][6]=_[d+"6"],_[m][7]=_[d+"7"],_[m][8]=_[d+"8"],_[m][9]=_[d+"9"],_[m][10]=_[d+"10"],_[m][11]=_[d+"11"],_[m][12]=_[d+"12"],_[m][13]=_[d+"13"],_[m][14]=_[d+"0"],_[m][15]=_[d+"0"]}function St(d){return d==ig||d==sg||d==Qh||d==ag}function Rn(){this.eb=[],this.size=this.A=this.fb=0}function Sn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function nn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Rn,this.f.kb=new Sn,this.sd=null}function xt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Mt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ws(d){return alert("todo:WebPSamplerProcessPlane"),d.T}function Jn(d,m){var x=d.T,I=m.ba.f.RGBA,$=I.eb,W=I.fb+d.ka*I.A,Y=cs[m.ba.S],Q=d.y,te=d.O,ae=d.f,fe=d.N,Ne=d.ea,oe=d.W,pe=m.cc,xe=m.dc,Ae=m.Mc,we=m.Nc,ke=d.ka,Te=d.ka+d.T,Me=d.U,Ie=Me+1>>1;for(ke==0?Y(Q,te,null,null,ae,fe,Ne,oe,ae,fe,Ne,oe,$,W,null,null,Me):(Y(m.ec,m.fc,Q,te,pe,xe,Ae,we,ae,fe,Ne,oe,$,W-I.A,$,W,Me),++x);ke+2<Te;ke+=2)pe=ae,xe=fe,Ae=Ne,we=oe,fe+=d.Rc,oe+=d.Rc,W+=2*I.A,Y(Q,(te+=2*d.fa)-d.fa,Q,te,pe,xe,Ae,we,ae,fe,Ne,oe,$,W-I.A,$,W,Me);return te+=d.fa,d.j+Te<d.o?(r(m.ec,m.fc,Q,te,Me),r(m.cc,m.dc,ae,fe,Ie),r(m.Mc,m.Nc,Ne,oe,Ie),x--):1&Te||Y(Q,te,null,null,ae,fe,Ne,oe,ae,fe,Ne,oe,$,W+I.A,null,null,Me),x}function ns(d,m,x){var I=d.F,$=[d.J];if(I!=null){var W=d.U,Y=m.ba.S,Q=Y==Yh||Y==Qh;m=m.ba.f.RGBA;var te=[0],ae=d.ka;te[0]=d.T,d.Kb&&(ae==0?--te[0]:(--ae,$[0]-=d.width),d.j+d.ka+d.T==d.o&&(te[0]=d.o-d.j-ae));var fe=m.eb;ae=m.fb+ae*m.A,d=c2(I,$[0],d.width,W,te,fe,ae+(Q?0:3),m.A),e(x==te),d&&St(Y)&&rd(fe,ae,Q,W,te,m.A)}return 0}function qr(d){var m=d.ma,x=m.ba.S,I=11>x,$=x==Gh||x==Kh||x==Yh||x==rg||x==12||St(x);if(m.memory=null,m.Ib=null,m.Jb=null,m.Nd=null,!Yu(m.Oa,d,$?11:12))return 0;if($&&St(x)&&Ul(),d.da)alert("todo:use_scaling");else{if(I){if(m.Ib=Ws,d.Kb){if(x=d.U+1>>1,m.memory=s(d.U+2*x),m.memory==null)return 0;m.ec=m.memory,m.fc=0,m.cc=m.ec,m.dc=m.fc+d.U,m.Mc=m.cc,m.Nc=m.dc+x,m.Ib=Jn,Ul()}}else alert("todo:EmitYUV");$&&(m.Jb=ns,I&&wn())}if(I&&!A2){for(d=0;256>d;++d)_S[d]=89858*(d-128)+Jh>>Xh,SS[d]=-22014*(d-128)+Jh,AS[d]=-45773*(d-128),ES[d]=113618*(d-128)+Jh>>Xh;for(d=sd;d<cg;++d)m=76283*(d-16)+Jh>>Xh,kS[d-sd]=Ot(m,255),TS[d-sd]=Ot(m+8>>4,15);A2=1}return 1}function mt(d){var m=d.ma,x=d.U,I=d.T;return e(!(1&d.ka)),0>=x||0>=I?0:(x=m.Ib(d,m),m.Jb!=null&&m.Jb(d,m,x),m.Dc+=x,1)}function kn(d){d.ma.memory=null}function rs(d,m,x,I){return ne(d,8)!=47?0:(m[0]=ne(d,14)+1,x[0]=ne(d,14)+1,I[0]=ne(d,1),ne(d,3)!=0?0:!d.h)}function Er(d,m){if(4>d)return d+1;var x=d-2>>1;return(2+(1&d)<<x)+ne(m,x)+1}function Ar(d,m){return 120<m?m-120:1<=(x=((x=cS[m-1])>>4)*d+(8-(15&x)))?x:1;var x}function Ln(d,m,x){var I=V(x),$=d[m+=255&I].g-8;return 0<$&&(re(x,x.u+8),I=V(x),m+=d[m].value,m+=I&(1<<$)-1),re(x,x.u+d[m].g),d[m].value}function dr(d,m,x){return x.g+=d.g,x.value+=d.value<<m>>>0,e(8>=x.g),d.g}function Dn(d,m,x){var I=d.xc;return e((m=I==0?0:d.vc[d.md*(x>>I)+(m>>I)])<d.Wb),d.Ya[m]}function ja(d,m,x,I){var $=d.ab,W=d.c*m,Y=d.C;m=Y+m;var Q=x,te=I;for(I=d.Ta,x=d.Ua;0<$--;){var ae=d.gc[$],fe=Y,Ne=m,oe=Q,pe=te,xe=(te=I,Q=x,ae.Ea);switch(e(fe<Ne),e(Ne<=ae.nc),ae.hc){case 2:er(oe,pe,(Ne-fe)*xe,te,Q);break;case 0:var Ae=fe,we=Ne,ke=te,Te=Q,Me=(nt=ae).Ea;Ae==0&&(Xu(oe,pe,null,null,1,ke,Te),Tt(oe,pe+1,0,0,Me-1,ke,Te+1),pe+=Me,Te+=Me,++Ae);for(var Ie=1<<nt.b,lt=Ie-1,Qe=De(Me,nt.b),Rt=nt.K,nt=nt.w+(Ae>>nt.b)*Qe;Ae<we;){var Ht=Rt,yr=nt,Lt=1;for(Tc(oe,pe,ke,Te-Me,1,ke,Te);Lt<Me;){var rt=(Lt&~lt)+Ie;rt>Me&&(rt=Me),(0,Zu[Ht[yr++]>>8&15])(oe,pe+ +Lt,ke,Te+Lt-Me,rt-Lt,ke,Te+Lt),Lt=rt}pe+=Me,Te+=Me,++Ae&lt||(nt+=Qe)}Ne!=ae.nc&&r(te,Q-xe,te,Q+(Ne-fe-1)*xe,xe);break;case 1:for(xe=oe,we=pe,Me=(oe=ae.Ea)-(Te=oe&~(ke=(pe=1<<ae.b)-1)),Ae=De(oe,ae.b),Ie=ae.K,ae=ae.w+(fe>>ae.b)*Ae;fe<Ne;){for(lt=Ie,Qe=ae,Rt=new Ue,nt=we+Te,Ht=we+oe;we<nt;)ot(lt[Qe++],Rt),ed(Rt,xe,we,pe,te,Q),we+=pe,Q+=pe;we<Ht&&(ot(lt[Qe++],Rt),ed(Rt,xe,we,Me,te,Q),we+=Me,Q+=Me),++fe&ke||(ae+=Ae)}break;case 3:if(oe==te&&pe==Q&&0<ae.b){for(we=te,oe=xe=Q+(Ne-fe)*xe-(Te=(Ne-fe)*De(ae.Ea,ae.b)),pe=te,ke=Q,Ae=[],Te=(Me=Te)-1;0<=Te;--Te)Ae[Te]=pe[ke+Te];for(Te=Me-1;0<=Te;--Te)we[oe+Te]=Ae[Te];zh(ae,fe,Ne,te,xe,te,Q)}else zh(ae,fe,Ne,oe,pe,te,Q)}Q=I,te=x}te!=x&&r(I,x,Q,te,W)}function Gs(d,m){var x=d.V,I=d.Ba+d.c*d.C,$=m-d.C;if(e(m<=d.l.o),e(16>=$),0<$){var W=d.l,Y=d.Ta,Q=d.Ua,te=W.width;if(ja(d,$,x,I),$=Q=[Q],e((x=d.C)<(I=m)),e(W.v<W.va),I>W.o&&(I=W.o),x<W.j){var ae=W.j-x;x=W.j,$[0]+=ae*te}if(x>=I?x=0:($[0]+=4*W.v,W.ka=x-W.j,W.U=W.va-W.v,W.T=I-x,x=1),x){if(Q=Q[0],11>(x=d.ca).S){var fe=x.f.RGBA,Ne=(I=x.S,$=W.U,W=W.T,ae=fe.eb,fe.A),oe=W;for(fe=fe.fb+d.Ma*fe.A;0<oe--;){var pe=Y,xe=Q,Ae=$,we=ae,ke=fe;switch(I){case Wh:td(pe,xe,Ae,we,ke);break;case Gh:ko(pe,xe,Ae,we,ke);break;case ig:ko(pe,xe,Ae,we,ke),rd(we,ke,0,Ae,1,0);break;case g2:Bl(pe,xe,Ae,we,ke);break;case Kh:pt(pe,xe,Ae,we,ke,1);break;case sg:pt(pe,xe,Ae,we,ke,1),rd(we,ke,0,Ae,1,0);break;case Yh:pt(pe,xe,Ae,we,ke,0);break;case Qh:pt(pe,xe,Ae,we,ke,0),rd(we,ke,1,Ae,1,0);break;case rg:To(pe,xe,Ae,we,ke);break;case ag:To(pe,xe,Ae,we,ke),l2(we,ke,Ae,1,0);break;case v2:jo(pe,xe,Ae,we,ke);break;default:e(0)}Q+=te,fe+=Ne}d.Ma+=W}else alert("todo:EmitRescaledRowsYUVA");e(d.Ma<=x.height)}}d.C=m,e(d.C<=d.i)}function Hr(d){var m;if(0<d.ua)return 0;for(m=0;m<d.Wb;++m){var x=d.Ya[m].G,I=d.Ya[m].H;if(0<x[1][I[1]+0].g||0<x[2][I[2]+0].g||0<x[3][I[3]+0].g)return 0}return 1}function Pi(d,m,x,I,$,W){if(d.Z!=0){var Y=d.qd,Q=d.rd;for(e(Po[d.Z]!=null);m<x;++m)Po[d.Z](Y,Q,I,$,I,$,W),Y=I,Q=$,$+=W;d.qd=Y,d.rd=Q}}function li(d,m){var x=d.l.ma,I=x.Z==0||x.Z==1?d.l.j:d.C;if(I=d.C<I?I:d.C,e(m<=d.l.o),m>I){var $=d.l.width,W=x.ca,Y=x.tb+$*I,Q=d.V,te=d.Ba+d.c*I,ae=d.gc;e(d.ab==1),e(ae[0].hc==3),aa(ae[0],I,m,Q,te,W,Y),Pi(x,I,m,W,Y,$)}d.C=d.Ma=m}function Wr(d,m,x,I,$,W,Y){var Q=d.$/I,te=d.$%I,ae=d.m,fe=d.s,Ne=x+d.$,oe=Ne;$=x+I*$;var pe=x+I*W,xe=280+fe.ua,Ae=d.Pb?Q:16777216,we=0<fe.ua?fe.Wa:null,ke=fe.wc,Te=Ne<pe?Dn(fe,te,Q):null;e(d.C<W),e(pe<=$);var Me=!1;e:for(;;){for(;Me||Ne<pe;){var Ie=0;if(Q>=Ae){var lt=Ne-x;e((Ae=d).Pb),Ae.wd=Ae.m,Ae.xd=lt,0<Ae.s.ua&&Ge(Ae.s.Wa,Ae.s.vb),Ae=Q+dS}if(te&ke||(Te=Dn(fe,te,Q)),e(Te!=null),Te.Qb&&(m[Ne]=Te.qb,Me=!0),!Me)if(ce(ae),Te.jc){Ie=ae,lt=m;var Qe=Ne,Rt=Te.pd[V(Ie)&Vl-1];e(Te.jc),256>Rt.g?(re(Ie,Ie.u+Rt.g),lt[Qe]=Rt.value,Ie=0):(re(Ie,Ie.u+Rt.g-256),e(256<=Rt.value),Ie=Rt.value),Ie==0&&(Me=!0)}else Ie=Ln(Te.G[0],Te.H[0],ae);if(ae.h)break;if(Me||256>Ie){if(!Me)if(Te.nd)m[Ne]=(Te.qb|Ie<<8)>>>0;else{if(ce(ae),Me=Ln(Te.G[1],Te.H[1],ae),ce(ae),lt=Ln(Te.G[2],Te.H[2],ae),Qe=Ln(Te.G[3],Te.H[3],ae),ae.h)break;m[Ne]=(Qe<<24|Me<<16|Ie<<8|lt)>>>0}if(Me=!1,++Ne,++te>=I&&(te=0,++Q,Y!=null&&Q<=W&&!(Q%16)&&Y(d,Q),we!=null))for(;oe<Ne;)Ie=m[oe++],we.X[(506832829*Ie&4294967295)>>>we.Mb]=Ie}else if(280>Ie){if(Ie=Er(Ie-256,ae),lt=Ln(Te.G[4],Te.H[4],ae),ce(ae),lt=Ar(I,lt=Er(lt,ae)),ae.h)break;if(Ne-x<lt||$-Ne<Ie)break e;for(Qe=0;Qe<Ie;++Qe)m[Ne+Qe]=m[Ne+Qe-lt];for(Ne+=Ie,te+=Ie;te>=I;)te-=I,++Q,Y!=null&&Q<=W&&!(Q%16)&&Y(d,Q);if(e(Ne<=$),te&ke&&(Te=Dn(fe,te,Q)),we!=null)for(;oe<Ne;)Ie=m[oe++],we.X[(506832829*Ie&4294967295)>>>we.Mb]=Ie}else{if(!(Ie<xe))break e;for(Me=Ie-280,e(we!=null);oe<Ne;)Ie=m[oe++],we.X[(506832829*Ie&4294967295)>>>we.Mb]=Ie;Ie=Ne,e(!(Me>>>(lt=we).Xa)),m[Ie]=lt.X[Me],Me=!0}Me||e(ae.h==ee(ae))}if(d.Pb&&ae.h&&Ne<$)e(d.m.h),d.a=5,d.m=d.wd,d.$=d.xd,0<d.s.ua&&Ge(d.s.vb,d.s.Wa);else{if(ae.h)break e;Y!=null&&Y(d,Q>W?W:Q),d.a=0,d.$=Ne-x}return 1}return d.a=3,0}function Zn(d){e(d!=null),d.vc=null,d.yc=null,d.Ya=null;var m=d.Wa;m!=null&&(m.X=null),d.vb=null,e(d!=null)}function Ks(){var d=new Ze;return d==null?null:(d.a=0,d.xb=b2,Dt("Predictor","VP8LPredictors"),Dt("Predictor","VP8LPredictors_C"),Dt("PredictorAdd","VP8LPredictorsAdd"),Dt("PredictorAdd","VP8LPredictorsAdd_C"),er=wt,ed=yt,td=en,ko=Kt,To=tt,jo=Nt,Bl=an,_.VP8LMapColor32b=sa,_.VP8LMapColor8b=Ju,d)}function Ri(d,m,x,I,$){var W=1,Y=[d],Q=[m],te=I.m,ae=I.s,fe=null,Ne=0;e:for(;;){if(x)for(;W&&ne(te,1);){var oe=Y,pe=Q,xe=I,Ae=1,we=xe.m,ke=xe.gc[xe.ab],Te=ne(we,2);if(xe.Oc&1<<Te)W=0;else{switch(xe.Oc|=1<<Te,ke.hc=Te,ke.Ea=oe[0],ke.nc=pe[0],ke.K=[null],++xe.ab,e(4>=xe.ab),Te){case 0:case 1:ke.b=ne(we,3)+2,Ae=Ri(De(ke.Ea,ke.b),De(ke.nc,ke.b),0,xe,ke.K),ke.K=ke.K[0];break;case 3:var Me,Ie=ne(we,8)+1,lt=16<Ie?0:4<Ie?1:2<Ie?2:3;if(oe[0]=De(ke.Ea,lt),ke.b=lt,Me=Ae=Ri(Ie,1,0,xe,ke.K)){var Qe,Rt=Ie,nt=ke,Ht=1<<(8>>nt.b),yr=s(Ht);if(yr==null)Me=0;else{var Lt=nt.K[0],rt=nt.w;for(yr[0]=nt.K[0][0],Qe=1;Qe<1*Rt;++Qe)yr[Qe]=Je(Lt[rt+Qe],yr[Qe-1]);for(;Qe<4*Ht;++Qe)yr[Qe]=0;nt.K[0]=null,nt.K[0]=yr,Me=1}}Ae=Me;break;case 2:break;default:e(0)}W=Ae}}if(Y=Y[0],Q=Q[0],W&&ne(te,1)&&!(W=1<=(Ne=ne(te,4))&&11>=Ne)){I.a=3;break e}var ze;if(ze=W)t:{var nr,Pt,Qt,Tn=I,Lr=Y,di=Q,Kn=Ne,Kr=x,hi=Tn.m,xr=Tn.s,Jt=[null],cn=1,Yn=0,un=uS[Kn];n:for(;;){if(Kr&&ne(hi,1)){var Dr=ne(hi,3)+2,Cs=De(Lr,Dr),rr=De(di,Dr),Ni=Cs*rr;if(!Ri(Cs,rr,0,Tn,Jt))break n;for(Jt=Jt[0],xr.xc=Dr,nr=0;nr<Ni;++nr){var yn=Jt[nr]>>8&65535;Jt[nr]=yn,yn>=cn&&(cn=yn+1)}}if(hi.h)break n;for(Pt=0;5>Pt;++Pt){var br=y2[Pt];!Pt&&0<Kn&&(br+=1<<Kn),Yn<br&&(Yn=br)}var Bi=o(cn*un,E),fi=cn,$i=o(fi,G);if($i==null)var zi=null;else e(65536>=fi),zi=$i;var _i=s(Yn);if(zi==null||_i==null||Bi==null){Tn.a=1;break n}var qi=Bi;for(nr=Qt=0;nr<cn;++nr){var _n=zi[nr],Hi=_n.G,Is=_n.H,zl=0,Ba=1,Or=0;for(Pt=0;5>Pt;++Pt){br=y2[Pt],Hi[Pt]=qi,Is[Pt]=Qt,!Pt&&0<Kn&&(br+=1<<Kn);i:{var ef,ug=br,tf=Tn,ad=_i,IS=qi,PS=Qt,dg=0,Ro=tf.m,RS=ne(Ro,1);if(i(ad,0,0,ug),RS){var LS=ne(Ro,1)+1,DS=ne(Ro,1),T2=ne(Ro,DS==0?1:8);ad[T2]=1,LS==2&&(ad[T2=ne(Ro,8)]=1);var nf=1}else{var j2=s(19),C2=ne(Ro,4)+4;if(19<C2){tf.a=3;var rf=0;break i}for(ef=0;ef<C2;++ef)j2[lS[ef]]=ne(Ro,3);var hg=void 0,od=void 0,I2=tf,OS=j2,sf=ug,P2=ad,fg=0,Lo=I2.m,R2=8,L2=o(128,E);r:for(;L(L2,0,7,OS,19);){if(ne(Lo,1)){var MS=2+2*ne(Lo,3);if((hg=2+ne(Lo,MS))>sf)break r}else hg=sf;for(od=0;od<sf&&hg--;){ce(Lo);var D2=L2[0+(127&V(Lo))];re(Lo,Lo.u+D2.g);var Cc=D2.value;if(16>Cc)P2[od++]=Cc,Cc!=0&&(R2=Cc);else{var FS=Cc==16,O2=Cc-16,US=aS[O2],M2=ne(Lo,sS[O2])+US;if(od+M2>sf)break r;for(var VS=FS?R2:0;0<M2--;)P2[od++]=VS}}fg=1;break r}fg||(I2.a=3),nf=fg}(nf=nf&&!Ro.h)&&(dg=L(IS,PS,8,ad,ug)),nf&&dg!=0?rf=dg:(tf.a=3,rf=0)}if(rf==0)break n;if(Ba&&oS[Pt]==1&&(Ba=qi[Qt].g==0),zl+=qi[Qt].g,Qt+=rf,3>=Pt){var ld,mg=_i[0];for(ld=1;ld<br;++ld)_i[ld]>mg&&(mg=_i[ld]);Or+=mg}}if(_n.nd=Ba,_n.Qb=0,Ba&&(_n.qb=(Hi[3][Is[3]+0].value<<24|Hi[1][Is[1]+0].value<<16|Hi[2][Is[2]+0].value)>>>0,zl==0&&256>Hi[0][Is[0]+0].value&&(_n.Qb=1,_n.qb+=Hi[0][Is[0]+0].value<<8)),_n.jc=!_n.Qb&&6>Or,_n.jc){var af,$a=_n;for(af=0;af<Vl;++af){var Do=af,Oo=$a.pd[Do],of=$a.G[0][$a.H[0]+Do];256<=of.value?(Oo.g=of.g+256,Oo.value=of.value):(Oo.g=0,Oo.value=0,Do>>=dr(of,8,Oo),Do>>=dr($a.G[1][$a.H[1]+Do],16,Oo),Do>>=dr($a.G[2][$a.H[2]+Do],0,Oo),dr($a.G[3][$a.H[3]+Do],24,Oo))}}}xr.vc=Jt,xr.Wb=cn,xr.Ya=zi,xr.yc=Bi,ze=1;break t}ze=0}if(!(W=ze)){I.a=3;break e}if(0<Ne){if(ae.ua=1<<Ne,!ie(ae.Wa,Ne)){I.a=1,W=0;break e}}else ae.ua=0;var pg=I,F2=Y,BS=Q,gg=pg.s,vg=gg.xc;if(pg.c=F2,pg.i=BS,gg.md=De(F2,vg),gg.wc=vg==0?-1:(1<<vg)-1,x){I.xb=yS;break e}if((fe=s(Y*Q))==null){I.a=1,W=0;break e}W=(W=Wr(I,fe,0,Y,Q,Q,null))&&!te.h;break e}return W?($!=null?$[0]=fe:(e(fe==null),e(x)),I.$=0,x||Zn(ae)):Zn(ae),W}function _s(d,m){var x=d.c*d.i,I=x+m+16*m;return e(d.c<=m),d.V=s(I),d.V==null?(d.Ta=null,d.Ua=0,d.a=1,0):(d.Ta=d.V,d.Ua=d.Ba+x+m,1)}function Ys(d,m){var x=d.C,I=m-x,$=d.V,W=d.Ba+d.c*x;for(e(m<=d.l.o);0<I;){var Y=16<I?16:I,Q=d.l.ma,te=d.l.width,ae=te*Y,fe=Q.ca,Ne=Q.tb+te*x,oe=d.Ta,pe=d.Ua;ja(d,Y,$,W),u2(oe,pe,fe,Ne,ae),Pi(Q,x,x+Y,fe,Ne,te),I-=Y,$+=Y*d.c,x+=Y}e(x==m),d.C=d.Ma=m}function Ca(){this.ub=this.yd=this.td=this.Rb=0}function Ia(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function $u(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Qs(){this.Yb=function(){var d=[];return function m(x,I,$){for(var W=$[I],Y=0;Y<W&&(x.push($.length>I+1?[]:0),!($.length<I+1));Y++)m(x[Y],I+1,$)}(d,0,[3,11]),d}()}function Al(){this.jb=s(3),this.Wc=l([4,8],Qs),this.Xc=l([4,17],Qs)}function po(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Sr(){this.ld=this.La=this.dd=this.tc=0}function Li(){this.Na=this.la=0}function go(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Sl(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function kl(){this.uc=this.M=this.Nb=0,this.wa=Array(new Sr),this.Y=0,this.ya=Array(new Sl),this.aa=0,this.l=new Xs}function Tl(){this.y=s(16),this.f=s(8),this.ea=s(8)}function jl(){this.cb=this.a=0,this.sc="",this.m=new w,this.Od=new Ca,this.Kc=new Ia,this.ed=new po,this.Qa=new $u,this.Ic=this.$c=this.Aa=0,this.D=new kl,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,w),this.ia=0,this.pb=o(4,go),this.Pa=new Al,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Tl),this.Hd=0,this.rb=Array(new Li),this.sb=0,this.wa=Array(new Sr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Sl),this.L=this.aa=0,this.gd=l([4,2],Sr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Xs(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Cl(){var d=new jl;return d!=null&&(d.a=0,d.sc="OK",d.cb=0,d.Xb=0,id||(id=Es)),d}function Fn(d,m,x){return d.a==0&&(d.a=m,d.sc=x,d.cb=0),0}function Il(d,m,x){return 3<=x&&d[m+0]==157&&d[m+1]==1&&d[m+2]==42}function Ac(d,m){if(d==null)return 0;if(d.a=0,d.sc="OK",m==null)return Fn(d,2,"null VP8Io passed to VP8GetHeaders()");var x=m.data,I=m.w,$=m.ha;if(4>$)return Fn(d,7,"Truncated header.");var W=x[I+0]|x[I+1]<<8|x[I+2]<<16,Y=d.Od;if(Y.Rb=!(1&W),Y.td=W>>1&7,Y.yd=W>>4&1,Y.ub=W>>5,3<Y.td)return Fn(d,3,"Incorrect keyframe parameters.");if(!Y.yd)return Fn(d,4,"Frame not displayable.");I+=3,$-=3;var Q=d.Kc;if(Y.Rb){if(7>$)return Fn(d,7,"cannot parse picture header");if(!Il(x,I,$))return Fn(d,3,"Bad code word");Q.c=16383&(x[I+4]<<8|x[I+3]),Q.Td=x[I+4]>>6,Q.i=16383&(x[I+6]<<8|x[I+5]),Q.Ud=x[I+6]>>6,I+=7,$-=7,d.za=Q.c+15>>4,d.Ub=Q.i+15>>4,m.width=Q.c,m.height=Q.i,m.Da=0,m.j=0,m.v=0,m.va=m.width,m.o=m.height,m.da=0,m.ib=m.width,m.hb=m.height,m.U=m.width,m.T=m.height,i((W=d.Pa).jb,0,255,W.jb.length),e((W=d.Qa)!=null),W.Cb=0,W.Bb=0,W.Fb=1,i(W.Zb,0,0,W.Zb.length),i(W.Lb,0,0,W.Lb)}if(Y.ub>$)return Fn(d,7,"bad partition length");K(W=d.m,x,I,Y.ub),I+=Y.ub,$-=Y.ub,Y.Rb&&(Q.Ld=me(W),Q.Kd=me(W)),Q=d.Qa;var te,ae=d.Pa;if(e(W!=null),e(Q!=null),Q.Cb=me(W),Q.Cb){if(Q.Bb=me(W),me(W)){for(Q.Fb=me(W),te=0;4>te;++te)Q.Zb[te]=me(W)?q(W,7):0;for(te=0;4>te;++te)Q.Lb[te]=me(W)?q(W,6):0}if(Q.Bb)for(te=0;3>te;++te)ae.jb[te]=me(W)?z(W,8):255}else Q.Bb=0;if(W.Ka)return Fn(d,3,"cannot parse segment header");if((Q=d.ed).zd=me(W),Q.Tb=z(W,6),Q.wb=z(W,3),Q.Pc=me(W),Q.Pc&&me(W)){for(ae=0;4>ae;++ae)me(W)&&(Q.vd[ae]=q(W,6));for(ae=0;4>ae;++ae)me(W)&&(Q.od[ae]=q(W,6))}if(d.L=Q.Tb==0?0:Q.zd?1:2,W.Ka)return Fn(d,3,"cannot parse filter header");var fe=$;if($=te=I,I=te+fe,Q=fe,d.Xb=(1<<z(d.m,2))-1,fe<3*(ae=d.Xb))x=7;else{for(te+=3*ae,Q-=3*ae,fe=0;fe<ae;++fe){var Ne=x[$+0]|x[$+1]<<8|x[$+2]<<16;Ne>Q&&(Ne=Q),K(d.Jc[+fe],x,te,Ne),te+=Ne,Q-=Ne,$+=3}K(d.Jc[+ae],x,te,Q),x=te<I?0:5}if(x!=0)return Fn(d,x,"cannot parse partitions");for(x=z(te=d.m,7),$=me(te)?q(te,4):0,I=me(te)?q(te,4):0,Q=me(te)?q(te,4):0,ae=me(te)?q(te,4):0,te=me(te)?q(te,4):0,fe=d.Qa,Ne=0;4>Ne;++Ne){if(fe.Cb){var oe=fe.Zb[Ne];fe.Fb||(oe+=x)}else{if(0<Ne){d.pb[Ne]=d.pb[0];continue}oe=x}var pe=d.pb[Ne];pe.Sc[0]=og[Ot(oe+$,127)],pe.Sc[1]=lg[Ot(oe+0,127)],pe.Eb[0]=2*og[Ot(oe+I,127)],pe.Eb[1]=101581*lg[Ot(oe+Q,127)]>>16,8>pe.Eb[1]&&(pe.Eb[1]=8),pe.Qc[0]=og[Ot(oe+ae,117)],pe.Qc[1]=lg[Ot(oe+te,127)],pe.lc=oe+te}if(!Y.Rb)return Fn(d,4,"Not a key frame.");for(me(W),Y=d.Pa,x=0;4>x;++x){for($=0;8>$;++$)for(I=0;3>I;++I)for(Q=0;11>Q;++Q)ae=ye(W,gS[x][$][I][Q])?z(W,8):mS[x][$][I][Q],Y.Wc[x][$].Yb[I][Q]=ae;for($=0;17>$;++$)Y.Xc[x][$]=Y.Wc[x][vS[$]]}return d.kc=me(W),d.kc&&(d.Bd=z(W,8)),d.cb=1}function Es(d,m,x,I,$,W,Y){var Q=m[$].Yb[x];for(x=0;16>$;++$){if(!ye(d,Q[x+0]))return $;for(;!ye(d,Q[x+1]);)if(Q=m[++$].Yb[0],x=0,$==16)return 16;var te=m[$+1].Yb;if(ye(d,Q[x+2])){var ae=d,fe=0;if(ye(ae,(oe=Q)[(Ne=x)+3]))if(ye(ae,oe[Ne+6])){for(Q=0,Ne=2*(fe=ye(ae,oe[Ne+8]))+(oe=ye(ae,oe[Ne+9+fe])),fe=0,oe=hS[Ne];oe[Q];++Q)fe+=fe+ye(ae,oe[Q]);fe+=3+(8<<Ne)}else ye(ae,oe[Ne+7])?(fe=7+2*ye(ae,165),fe+=ye(ae,145)):fe=5+ye(ae,159);else fe=ye(ae,oe[Ne+4])?3+ye(ae,oe[Ne+5]):2;Q=te[2]}else fe=1,Q=te[1];te=Y+fS[$],0>(ae=d).b&&he(ae);var Ne,oe=ae.b,pe=(Ne=ae.Ca>>1)-(ae.I>>oe)>>31;--ae.b,ae.Ca+=pe,ae.Ca|=1,ae.I-=(Ne+1&pe)<<oe,W[te]=((fe^pe)-pe)*I[(0<$)+0]}return 16}function Js(d){var m=d.rb[d.sb-1];m.la=0,m.Na=0,i(d.zc,0,0,d.zc.length),d.ja=0}function yi(d,m,x,I,$){$=d[m+x+32*I]+($>>3),d[m+x+32*I]=-256&$?0>$?0:255:$}function Pa(d,m,x,I,$,W){yi(d,m,0,x,I+$),yi(d,m,1,x,I+W),yi(d,m,2,x,I-W),yi(d,m,3,x,I-$)}function on(d){return(20091*d>>16)+d}function ci(d,m,x,I){var $,W=0,Y=s(16);for($=0;4>$;++$){var Q=d[m+0]+d[m+8],te=d[m+0]-d[m+8],ae=(35468*d[m+4]>>16)-on(d[m+12]),fe=on(d[m+4])+(35468*d[m+12]>>16);Y[W+0]=Q+fe,Y[W+1]=te+ae,Y[W+2]=te-ae,Y[W+3]=Q-fe,W+=4,m++}for($=W=0;4>$;++$)Q=(d=Y[W+0]+4)+Y[W+8],te=d-Y[W+8],ae=(35468*Y[W+4]>>16)-on(Y[W+12]),yi(x,I,0,0,Q+(fe=on(Y[W+4])+(35468*Y[W+12]>>16))),yi(x,I,1,0,te+ae),yi(x,I,2,0,te-ae),yi(x,I,3,0,Q-fe),W++,I+=32}function vo(d,m,x,I){var $=d[m+0]+4,W=35468*d[m+4]>>16,Y=on(d[m+4]),Q=35468*d[m+1]>>16;Pa(x,I,0,$+Y,d=on(d[m+1]),Q),Pa(x,I,1,$+W,d,Q),Pa(x,I,2,$-W,d,Q),Pa(x,I,3,$-Y,d,Q)}function yo(d,m,x,I,$){ci(d,m,x,I),$&&ci(d,m+16,x,I+4)}function Sc(d,m,x,I){$l(d,m+0,x,I,1),$l(d,m+32,x,I+128,1)}function Bt(d,m,x,I){var $;for(d=d[m+0]+4,$=0;4>$;++$)for(m=0;4>m;++m)yi(x,I,m,$,d)}function Ra(d,m,x,I){d[m+0]&&sn(d,m+0,x,I),d[m+16]&&sn(d,m+16,x,I+4),d[m+32]&&sn(d,m+32,x,I+128),d[m+48]&&sn(d,m+48,x,I+128+4)}function Zs(d,m,x,I){var $,W=s(16);for($=0;4>$;++$){var Y=d[m+0+$]+d[m+12+$],Q=d[m+4+$]+d[m+8+$],te=d[m+4+$]-d[m+8+$],ae=d[m+0+$]-d[m+12+$];W[0+$]=Y+Q,W[8+$]=Y-Q,W[4+$]=ae+te,W[12+$]=ae-te}for($=0;4>$;++$)Y=(d=W[0+4*$]+3)+W[3+4*$],Q=W[1+4*$]+W[2+4*$],te=W[1+4*$]-W[2+4*$],ae=d-W[3+4*$],x[I+0]=Y+Q>>3,x[I+16]=ae+te>>3,x[I+32]=Y-Q>>3,x[I+48]=ae-te>>3,I+=64}function xi(d,m,x){var I,$=m-32,W=Vi,Y=255-d[$-1];for(I=0;I<x;++I){var Q,te=W,ae=Y+d[m-1];for(Q=0;Q<x;++Q)d[m+Q]=te[ae+d[$+Q]];m+=32}}function Pl(d,m){xi(d,m,4)}function kc(d,m){xi(d,m,8)}function zu(d,m){xi(d,m,16)}function qu(d,m){var x;for(x=0;16>x;++x)r(d,m+32*x,d,m-32,16)}function Rl(d,m){var x;for(x=16;0<x;--x)i(d,m,d[m-1],16),m+=32}function La(d,m,x){var I;for(I=0;16>I;++I)i(m,x+32*I,d,16)}function bi(d,m){var x,I=16;for(x=0;16>x;++x)I+=d[m-1+32*x]+d[m+x-32];La(I>>5,d,m)}function is(d,m){var x,I=8;for(x=0;16>x;++x)I+=d[m-1+32*x];La(I>>4,d,m)}function ea(d,m){var x,I=8;for(x=0;16>x;++x)I+=d[m+x-32];La(I>>4,d,m)}function xo(d,m){La(128,d,m)}function bt(d,m,x){return d+2*m+x+2>>2}function ta(d,m){var x,I=m-32;for(I=new Uint8Array([bt(d[I-1],d[I+0],d[I+1]),bt(d[I+0],d[I+1],d[I+2]),bt(d[I+1],d[I+2],d[I+3]),bt(d[I+2],d[I+3],d[I+4])]),x=0;4>x;++x)r(d,m+32*x,I,0,I.length)}function Hu(d,m){var x=d[m-1],I=d[m-1+32],$=d[m-1+64],W=d[m-1+96];Ee(d,m+0,16843009*bt(d[m-1-32],x,I)),Ee(d,m+32,16843009*bt(x,I,$)),Ee(d,m+64,16843009*bt(I,$,W)),Ee(d,m+96,16843009*bt($,W,W))}function Wu(d,m){var x,I=4;for(x=0;4>x;++x)I+=d[m+x-32]+d[m-1+32*x];for(I>>=3,x=0;4>x;++x)i(d,m+32*x,I,4)}function Gu(d,m){var x=d[m-1+0],I=d[m-1+32],$=d[m-1+64],W=d[m-1-32],Y=d[m+0-32],Q=d[m+1-32],te=d[m+2-32],ae=d[m+3-32];d[m+0+96]=bt(I,$,d[m-1+96]),d[m+1+96]=d[m+0+64]=bt(x,I,$),d[m+2+96]=d[m+1+64]=d[m+0+32]=bt(W,x,I),d[m+3+96]=d[m+2+64]=d[m+1+32]=d[m+0+0]=bt(Y,W,x),d[m+3+64]=d[m+2+32]=d[m+1+0]=bt(Q,Y,W),d[m+3+32]=d[m+2+0]=bt(te,Q,Y),d[m+3+0]=bt(ae,te,Q)}function kr(d,m){var x=d[m+1-32],I=d[m+2-32],$=d[m+3-32],W=d[m+4-32],Y=d[m+5-32],Q=d[m+6-32],te=d[m+7-32];d[m+0+0]=bt(d[m+0-32],x,I),d[m+1+0]=d[m+0+32]=bt(x,I,$),d[m+2+0]=d[m+1+32]=d[m+0+64]=bt(I,$,W),d[m+3+0]=d[m+2+32]=d[m+1+64]=d[m+0+96]=bt($,W,Y),d[m+3+32]=d[m+2+64]=d[m+1+96]=bt(W,Y,Q),d[m+3+64]=d[m+2+96]=bt(Y,Q,te),d[m+3+96]=bt(Q,te,te)}function As(d,m){var x=d[m-1+0],I=d[m-1+32],$=d[m-1+64],W=d[m-1-32],Y=d[m+0-32],Q=d[m+1-32],te=d[m+2-32],ae=d[m+3-32];d[m+0+0]=d[m+1+64]=W+Y+1>>1,d[m+1+0]=d[m+2+64]=Y+Q+1>>1,d[m+2+0]=d[m+3+64]=Q+te+1>>1,d[m+3+0]=te+ae+1>>1,d[m+0+96]=bt($,I,x),d[m+0+64]=bt(I,x,W),d[m+0+32]=d[m+1+96]=bt(x,W,Y),d[m+1+32]=d[m+2+96]=bt(W,Y,Q),d[m+2+32]=d[m+3+96]=bt(Y,Q,te),d[m+3+32]=bt(Q,te,ae)}function Ku(d,m){var x=d[m+0-32],I=d[m+1-32],$=d[m+2-32],W=d[m+3-32],Y=d[m+4-32],Q=d[m+5-32],te=d[m+6-32],ae=d[m+7-32];d[m+0+0]=x+I+1>>1,d[m+1+0]=d[m+0+64]=I+$+1>>1,d[m+2+0]=d[m+1+64]=$+W+1>>1,d[m+3+0]=d[m+2+64]=W+Y+1>>1,d[m+0+32]=bt(x,I,$),d[m+1+32]=d[m+0+96]=bt(I,$,W),d[m+2+32]=d[m+1+96]=bt($,W,Y),d[m+3+32]=d[m+2+96]=bt(W,Y,Q),d[m+3+64]=bt(Y,Q,te),d[m+3+96]=bt(Q,te,ae)}function bo(d,m){var x=d[m-1+0],I=d[m-1+32],$=d[m-1+64],W=d[m-1+96];d[m+0+0]=x+I+1>>1,d[m+2+0]=d[m+0+32]=I+$+1>>1,d[m+2+32]=d[m+0+64]=$+W+1>>1,d[m+1+0]=bt(x,I,$),d[m+3+0]=d[m+1+32]=bt(I,$,W),d[m+3+32]=d[m+1+64]=bt($,W,W),d[m+3+64]=d[m+2+64]=d[m+0+96]=d[m+1+96]=d[m+2+96]=d[m+3+96]=W}function Ss(d,m){var x=d[m-1+0],I=d[m-1+32],$=d[m-1+64],W=d[m-1+96],Y=d[m-1-32],Q=d[m+0-32],te=d[m+1-32],ae=d[m+2-32];d[m+0+0]=d[m+2+32]=x+Y+1>>1,d[m+0+32]=d[m+2+64]=I+x+1>>1,d[m+0+64]=d[m+2+96]=$+I+1>>1,d[m+0+96]=W+$+1>>1,d[m+3+0]=bt(Q,te,ae),d[m+2+0]=bt(Y,Q,te),d[m+1+0]=d[m+3+32]=bt(x,Y,Q),d[m+1+32]=d[m+3+64]=bt(I,x,Y),d[m+1+64]=d[m+3+96]=bt($,I,x),d[m+1+96]=bt(W,$,I)}function wo(d,m){var x;for(x=0;8>x;++x)r(d,m+32*x,d,m-32,8)}function Di(d,m){var x;for(x=0;8>x;++x)i(d,m,d[m-1],8),m+=32}function ss(d,m,x){var I;for(I=0;8>I;++I)i(m,x+32*I,d,8)}function Da(d,m){var x,I=8;for(x=0;8>x;++x)I+=d[m+x-32]+d[m-1+32*x];ss(I>>4,d,m)}function Ll(d,m){var x,I=4;for(x=0;8>x;++x)I+=d[m+x-32];ss(I>>3,d,m)}function gn(d,m){var x,I=4;for(x=0;8>x;++x)I+=d[m-1+32*x];ss(I>>3,d,m)}function Dl(d,m){ss(128,d,m)}function Oa(d,m,x){var I=d[m-x],$=d[m+0],W=3*($-I)+ng[1020+d[m-2*x]-d[m+x]],Y=Hh[112+(W+4>>3)];d[m-x]=Vi[255+I+Hh[112+(W+3>>3)]],d[m+0]=Vi[255+$-Y]}function na(d,m,x,I){var $=d[m+0],W=d[m+x];return ls[255+d[m-2*x]-d[m-x]]>I||ls[255+W-$]>I}function No(d,m,x,I){return 4*ls[255+d[m-x]-d[m+0]]+ls[255+d[m-2*x]-d[m+x]]<=I}function Ma(d,m,x,I,$){var W=d[m-3*x],Y=d[m-2*x],Q=d[m-x],te=d[m+0],ae=d[m+x],fe=d[m+2*x],Ne=d[m+3*x];return 4*ls[255+Q-te]+ls[255+Y-ae]>I?0:ls[255+d[m-4*x]-W]<=$&&ls[255+W-Y]<=$&&ls[255+Y-Q]<=$&&ls[255+Ne-fe]<=$&&ls[255+fe-ae]<=$&&ls[255+ae-te]<=$}function ra(d,m,x,I){var $=2*I+1;for(I=0;16>I;++I)No(d,m+I,x,$)&&Oa(d,m+I,x)}function ia(d,m,x,I){var $=2*I+1;for(I=0;16>I;++I)No(d,m+I*x,1,$)&&Oa(d,m+I*x,1)}function wi(d,m,x,I){var $;for($=3;0<$;--$)ra(d,m+=4*x,x,I)}function Ol(d,m,x,I){var $;for($=3;0<$;--$)ia(d,m+=4,x,I)}function ks(d,m,x,I,$,W,Y,Q){for(W=2*W+1;0<$--;){if(Ma(d,m,x,W,Y))if(na(d,m,x,Q))Oa(d,m,x);else{var te=d,ae=m,fe=x,Ne=te[ae-2*fe],oe=te[ae-fe],pe=te[ae+0],xe=te[ae+fe],Ae=te[ae+2*fe],we=27*(Te=ng[1020+3*(pe-oe)+ng[1020+Ne-xe]])+63>>7,ke=18*Te+63>>7,Te=9*Te+63>>7;te[ae-3*fe]=Vi[255+te[ae-3*fe]+Te],te[ae-2*fe]=Vi[255+Ne+ke],te[ae-fe]=Vi[255+oe+we],te[ae+0]=Vi[255+pe-we],te[ae+fe]=Vi[255+xe-ke],te[ae+2*fe]=Vi[255+Ae-Te]}m+=I}}function ui(d,m,x,I,$,W,Y,Q){for(W=2*W+1;0<$--;){if(Ma(d,m,x,W,Y))if(na(d,m,x,Q))Oa(d,m,x);else{var te=d,ae=m,fe=x,Ne=te[ae-fe],oe=te[ae+0],pe=te[ae+fe],xe=Hh[112+(4+(Ae=3*(oe-Ne))>>3)],Ae=Hh[112+(Ae+3>>3)],we=xe+1>>1;te[ae-2*fe]=Vi[255+te[ae-2*fe]+we],te[ae-fe]=Vi[255+Ne+Ae],te[ae+0]=Vi[255+oe-xe],te[ae+fe]=Vi[255+pe-we]}m+=I}}function Ml(d,m,x,I,$,W){ks(d,m,x,1,16,I,$,W)}function _o(d,m,x,I,$,W){ks(d,m,1,x,16,I,$,W)}function as(d,m,x,I,$,W){var Y;for(Y=3;0<Y;--Y)ui(d,m+=4*x,x,1,16,I,$,W)}function Fl(d,m,x,I,$,W){var Y;for(Y=3;0<Y;--Y)ui(d,m+=4,1,x,16,I,$,W)}function y(d,m,x,I,$,W,Y,Q){ks(d,m,$,1,8,W,Y,Q),ks(x,I,$,1,8,W,Y,Q)}function B(d,m,x,I,$,W,Y,Q){ks(d,m,1,$,8,W,Y,Q),ks(x,I,1,$,8,W,Y,Q)}function se(d,m,x,I,$,W,Y,Q){ui(d,m+4*$,$,1,8,W,Y,Q),ui(x,I+4*$,$,1,8,W,Y,Q)}function de(d,m,x,I,$,W,Y,Q){ui(d,m+4,1,$,8,W,Y,Q),ui(x,I+4,1,$,8,W,Y,Q)}function ge(){this.ba=new nn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Mt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Se(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ce(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ke(){this.ua=0,this.Wa=new it,this.vb=new it,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new G,this.yc=new E}function Ze(){this.xb=this.a=0,this.l=new Xs,this.ca=new nn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new S,this.Pb=0,this.wd=new S,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ke,this.ab=0,this.gc=o(4,Ce),this.Oc=0}function vt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Xs,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function _t(d,m,x,I,$,W,Y){for(d=d==null?0:d[m+0],m=0;m<Y;++m)$[W+m]=d+x[I+m]&255,d=$[W+m]}function Yt(d,m,x,I,$,W,Y){var Q;if(d==null)_t(null,null,x,I,$,W,Y);else for(Q=0;Q<Y;++Q)$[W+Q]=d[m+Q]+x[I+Q]&255}function rn(d,m,x,I,$,W,Y){if(d==null)_t(null,null,x,I,$,W,Y);else{var Q,te=d[m+0],ae=te,fe=te;for(Q=0;Q<Y;++Q)ae=fe+(te=d[m+Q])-ae,fe=x[I+Q]+(-256&ae?0>ae?0:255:ae)&255,ae=te,$[W+Q]=fe}}function Un(d,m,x,I){var $=m.width,W=m.o;if(e(d!=null&&m!=null),0>x||0>=I||x+I>W)return null;if(!d.Cc){if(d.ga==null){var Y;if(d.ga=new vt,(Y=d.ga==null)||(Y=m.width*m.o,e(d.Gb.length==0),d.Gb=s(Y),d.Uc=0,d.Gb==null?Y=0:(d.mb=d.Gb,d.nb=d.Uc,d.rc=null,Y=1),Y=!Y),!Y){Y=d.ga;var Q=d.Fa,te=d.P,ae=d.qc,fe=d.mb,Ne=d.nb,oe=te+1,pe=ae-1,xe=Y.l;if(e(Q!=null&&fe!=null&&m!=null),Po[0]=null,Po[1]=_t,Po[2]=Yt,Po[3]=rn,Y.ca=fe,Y.tb=Ne,Y.c=m.width,Y.i=m.height,e(0<Y.c&&0<Y.i),1>=ae)m=0;else if(Y.$a=3&Q[te+0],Y.Z=Q[te+0]>>2&3,Y.Lc=Q[te+0]>>4&3,te=Q[te+0]>>6&3,0>Y.$a||1<Y.$a||4<=Y.Z||1<Y.Lc||te)m=0;else if(xe.put=mt,xe.ac=qr,xe.bc=kn,xe.ma=Y,xe.width=m.width,xe.height=m.height,xe.Da=m.Da,xe.v=m.v,xe.va=m.va,xe.j=m.j,xe.o=m.o,Y.$a)e:{e(Y.$a==1),m=Ks();t:for(;;){if(m==null){m=0;break e}if(e(Y!=null),Y.mc=m,m.c=Y.c,m.i=Y.i,m.l=Y.l,m.l.ma=Y,m.l.width=Y.c,m.l.height=Y.i,m.a=0,H(m.m,Q,oe,pe),!Ri(Y.c,Y.i,1,m,null)||(m.ab==1&&m.gc[0].hc==3&&Hr(m.s)?(Y.ic=1,Q=m.c*m.i,m.Ta=null,m.Ua=0,m.V=s(Q),m.Ba=0,m.V==null?(m.a=1,m=0):m=1):(Y.ic=0,m=_s(m,Y.c)),!m))break t;m=1;break e}Y.mc=null,m=0}else m=pe>=Y.c*Y.i;Y=!m}if(Y)return null;d.ga.Lc!=1?d.Ga=0:I=W-x}e(d.ga!=null),e(x+I<=W);e:{if(m=(Q=d.ga).c,W=Q.l.o,Q.$a==0){if(oe=d.rc,pe=d.Vc,xe=d.Fa,te=d.P+1+x*m,ae=d.mb,fe=d.nb+x*m,e(te<=d.P+d.qc),Q.Z!=0)for(e(Po[Q.Z]!=null),Y=0;Y<I;++Y)Po[Q.Z](oe,pe,xe,te,ae,fe,m),oe=ae,pe=fe,fe+=m,te+=m;else for(Y=0;Y<I;++Y)r(ae,fe,xe,te,m),oe=ae,pe=fe,fe+=m,te+=m;d.rc=oe,d.Vc=pe}else{if(e(Q.mc!=null),m=x+I,e((Y=Q.mc)!=null),e(m<=Y.i),Y.C>=m)m=1;else if(Q.ic||wn(),Q.ic){Q=Y.V,oe=Y.Ba,pe=Y.c;var Ae=Y.i,we=(xe=1,te=Y.$/pe,ae=Y.$%pe,fe=Y.m,Ne=Y.s,Y.$),ke=pe*Ae,Te=pe*m,Me=Ne.wc,Ie=we<Te?Dn(Ne,ae,te):null;e(we<=ke),e(m<=Ae),e(Hr(Ne));t:for(;;){for(;!fe.h&&we<Te;){if(ae&Me||(Ie=Dn(Ne,ae,te)),e(Ie!=null),ce(fe),256>(Ae=Ln(Ie.G[0],Ie.H[0],fe)))Q[oe+we]=Ae,++we,++ae>=pe&&(ae=0,++te<=m&&!(te%16)&&li(Y,te));else{if(!(280>Ae)){xe=0;break t}Ae=Er(Ae-256,fe);var lt,Qe=Ln(Ie.G[4],Ie.H[4],fe);if(ce(fe),!(we>=(Qe=Ar(pe,Qe=Er(Qe,fe)))&&ke-we>=Ae)){xe=0;break t}for(lt=0;lt<Ae;++lt)Q[oe+we+lt]=Q[oe+we+lt-Qe];for(we+=Ae,ae+=Ae;ae>=pe;)ae-=pe,++te<=m&&!(te%16)&&li(Y,te);we<Te&&ae&Me&&(Ie=Dn(Ne,ae,te))}e(fe.h==ee(fe))}li(Y,te>m?m:te);break t}!xe||fe.h&&we<ke?(xe=0,Y.a=fe.h?5:3):Y.$=we,m=xe}else m=Wr(Y,Y.V,Y.Ba,Y.c,Y.i,m,Ys);if(!m){I=0;break e}}x+I>=W&&(d.Cc=1),I=1}if(!I)return null;if(d.Cc&&((I=d.ga)!=null&&(I.mc=null),d.ga=null,0<d.Ga))return alert("todo:WebPDequantizeLevels"),null}return d.nb+x*$}function ln(d,m,x,I,$,W){for(;0<$--;){var Y,Q=d,te=m+(x?1:0),ae=d,fe=m+(x?0:3);for(Y=0;Y<I;++Y){var Ne=ae[fe+4*Y];Ne!=255&&(Ne*=32897,Q[te+4*Y+0]=Q[te+4*Y+0]*Ne>>23,Q[te+4*Y+1]=Q[te+4*Y+1]*Ne>>23,Q[te+4*Y+2]=Q[te+4*Y+2]*Ne>>23)}m+=W}}function Wn(d,m,x,I,$){for(;0<I--;){var W;for(W=0;W<x;++W){var Y=d[m+2*W+0],Q=15&(ae=d[m+2*W+1]),te=4369*Q,ae=(240&ae|ae>>4)*te>>16;d[m+2*W+0]=(240&Y|Y>>4)*te>>16&240|(15&Y|Y<<4)*te>>16>>4&15,d[m+2*W+1]=240&ae|Q}m+=$}}function Vn(d,m,x,I,$,W,Y,Q){var te,ae,fe=255;for(ae=0;ae<$;++ae){for(te=0;te<I;++te){var Ne=d[m+te];W[Y+4*te]=Ne,fe&=Ne}m+=x,Y+=Q}return fe!=255}function Gn(d,m,x,I,$){var W;for(W=0;W<$;++W)x[I+W]=d[m+W]>>8}function wn(){rd=ln,l2=Wn,c2=Vn,u2=Gn}function Pr(d,m,x){_[d]=function(I,$,W,Y,Q,te,ae,fe,Ne,oe,pe,xe,Ae,we,ke,Te,Me){var Ie,lt=Me-1>>1,Qe=Q[te+0]|ae[fe+0]<<16,Rt=Ne[oe+0]|pe[xe+0]<<16;e(I!=null);var nt=3*Qe+Rt+131074>>2;for(m(I[$+0],255&nt,nt>>16,Ae,we),W!=null&&(nt=3*Rt+Qe+131074>>2,m(W[Y+0],255&nt,nt>>16,ke,Te)),Ie=1;Ie<=lt;++Ie){var Ht=Q[te+Ie]|ae[fe+Ie]<<16,yr=Ne[oe+Ie]|pe[xe+Ie]<<16,Lt=Qe+Ht+Rt+yr+524296,rt=Lt+2*(Ht+Rt)>>3;nt=rt+Qe>>1,Qe=(Lt=Lt+2*(Qe+yr)>>3)+Ht>>1,m(I[$+2*Ie-1],255&nt,nt>>16,Ae,we+(2*Ie-1)*x),m(I[$+2*Ie-0],255&Qe,Qe>>16,Ae,we+(2*Ie-0)*x),W!=null&&(nt=Lt+Rt>>1,Qe=rt+yr>>1,m(W[Y+2*Ie-1],255&nt,nt>>16,ke,Te+(2*Ie-1)*x),m(W[Y+2*Ie+0],255&Qe,Qe>>16,ke,Te+(2*Ie+0)*x)),Qe=Ht,Rt=yr}1&Me||(nt=3*Qe+Rt+131074>>2,m(I[$+Me-1],255&nt,nt>>16,Ae,we+(Me-1)*x),W!=null&&(nt=3*Rt+Qe+131074>>2,m(W[Y+Me-1],255&nt,nt>>16,ke,Te+(Me-1)*x)))}}function Ul(){cs[Wh]=xS,cs[Gh]=w2,cs[g2]=bS,cs[Kh]=N2,cs[Yh]=_2,cs[rg]=E2,cs[v2]=wS,cs[ig]=w2,cs[sg]=N2,cs[Qh]=_2,cs[ag]=E2}function Oi(d){return d&-16384?0>d?0:255:d>>NS}function h(d,m){return Oi((19077*d>>8)+(26149*m>>8)-14234)}function N(d,m,x){return Oi((19077*d>>8)-(6419*m>>8)-(13320*x>>8)+8708)}function O(d,m){return Oi((19077*d>>8)+(33050*m>>8)-17685)}function J(d,m,x,I,$){I[$+0]=h(d,x),I[$+1]=N(d,m,x),I[$+2]=O(d,m)}function ve(d,m,x,I,$){I[$+0]=O(d,m),I[$+1]=N(d,m,x),I[$+2]=h(d,x)}function _e(d,m,x,I,$){var W=N(d,m,x);m=W<<3&224|O(d,m)>>3,I[$+0]=248&h(d,x)|W>>5,I[$+1]=m}function $e(d,m,x,I,$){var W=240&O(d,m)|15;I[$+0]=240&h(d,x)|N(d,m,x)>>4,I[$+1]=W}function qt(d,m,x,I,$){I[$+0]=255,J(d,m,x,I,$+1)}function Bn(d,m,x,I,$){ve(d,m,x,I,$),I[$+3]=255}function Ft(d,m,x,I,$){J(d,m,x,I,$),I[$+3]=255}function Ot(d,m){return 0>d?0:d>m?m:d}function Nn(d,m,x){_[d]=function(I,$,W,Y,Q,te,ae,fe,Ne){for(var oe=fe+(-2&Ne)*x;fe!=oe;)m(I[$+0],W[Y+0],Q[te+0],ae,fe),m(I[$+1],W[Y+0],Q[te+0],ae,fe+x),$+=2,++Y,++te,fe+=2*x;1&Ne&&m(I[$+0],W[Y+0],Q[te+0],ae,fe)}}function Mi(d,m,x){return x==0?d==0?m==0?6:5:m==0?4:0:x}function Gr(d,m,x,I,$){switch(d>>>30){case 3:$l(m,x,I,$,0);break;case 2:os(m,x,I,$);break;case 1:sn(m,x,I,$)}}function Rr(d,m){var x,I,$=m.M,W=m.Nb,Y=d.oc,Q=d.pc+40,te=d.oc,ae=d.pc+584,fe=d.oc,Ne=d.pc+600;for(x=0;16>x;++x)Y[Q+32*x-1]=129;for(x=0;8>x;++x)te[ae+32*x-1]=129,fe[Ne+32*x-1]=129;for(0<$?Y[Q-1-32]=te[ae-1-32]=fe[Ne-1-32]=129:(i(Y,Q-32-1,127,21),i(te,ae-32-1,127,9),i(fe,Ne-32-1,127,9)),I=0;I<d.za;++I){var oe=m.ya[m.aa+I];if(0<I){for(x=-1;16>x;++x)r(Y,Q+32*x-4,Y,Q+32*x+12,4);for(x=-1;8>x;++x)r(te,ae+32*x-4,te,ae+32*x+4,4),r(fe,Ne+32*x-4,fe,Ne+32*x+4,4)}var pe=d.Gd,xe=d.Hd+I,Ae=oe.ad,we=oe.Hc;if(0<$&&(r(Y,Q-32,pe[xe].y,0,16),r(te,ae-32,pe[xe].f,0,8),r(fe,Ne-32,pe[xe].ea,0,8)),oe.Za){var ke=Y,Te=Q-32+16;for(0<$&&(I>=d.za-1?i(ke,Te,pe[xe].y[15],4):r(ke,Te,pe[xe+1].y,0,4)),x=0;4>x;x++)ke[Te+128+x]=ke[Te+256+x]=ke[Te+384+x]=ke[Te+0+x];for(x=0;16>x;++x,we<<=2)ke=Y,Te=Q+S2[x],js[oe.Ob[x]](ke,Te),Gr(we,Ae,16*+x,ke,Te)}else if(ke=Mi(I,$,oe.Ob[0]),Io[ke](Y,Q),we!=0)for(x=0;16>x;++x,we<<=2)Gr(we,Ae,16*+x,Y,Q+S2[x]);for(x=oe.Gc,ke=Mi(I,$,oe.Dd),Va[ke](te,ae),Va[ke](fe,Ne),we=Ae,ke=te,Te=ae,255&(oe=0|x)&&(170&oe?oa(we,256,ke,Te):vn(we,256,ke,Te)),oe=fe,we=Ne,255&(x>>=8)&&(170&x?oa(Ae,320,oe,we):vn(Ae,320,oe,we)),$<d.Ub-1&&(r(pe[xe].y,0,Y,Q+480,16),r(pe[xe].f,0,te,ae+224,8),r(pe[xe].ea,0,fe,Ne+224,8)),x=8*W*d.B,pe=d.sa,xe=d.ta+16*I+16*W*d.R,Ae=d.qa,oe=d.ra+8*I+x,we=d.Ha,ke=d.Ia+8*I+x,x=0;16>x;++x)r(pe,xe+x*d.R,Y,Q+32*x,16);for(x=0;8>x;++x)r(Ae,oe+x*d.B,te,ae+32*x,8),r(we,ke+x*d.B,fe,Ne+32*x,8)}}function Ts(d,m,x,I,$,W,Y,Q,te){var ae=[0],fe=[0],Ne=0,oe=te!=null?te.kd:0,pe=te??new Se;if(d==null||12>x)return 7;pe.data=d,pe.w=m,pe.ha=x,m=[m],x=[x],pe.gb=[pe.gb];e:{var xe=m,Ae=x,we=pe.gb;if(e(d!=null),e(Ae!=null),e(we!=null),we[0]=0,12<=Ae[0]&&!n(d,xe[0],"RIFF")){if(n(d,xe[0]+8,"WEBP")){we=3;break e}var ke=be(d,xe[0]+4);if(12>ke||4294967286<ke){we=3;break e}if(oe&&ke>Ae[0]-8){we=7;break e}we[0]=ke,xe[0]+=12,Ae[0]-=12}we=0}if(we!=0)return we;for(ke=0<pe.gb[0],x=x[0];;){e:{var Te=d;Ae=m,we=x;var Me=ae,Ie=fe,lt=xe=[0];if((nt=Ne=[Ne])[0]=0,8>we[0])we=7;else{if(!n(Te,Ae[0],"VP8X")){if(be(Te,Ae[0]+4)!=10){we=3;break e}if(18>we[0]){we=7;break e}var Qe=be(Te,Ae[0]+8),Rt=1+Re(Te,Ae[0]+12);if(2147483648<=Rt*(Te=1+Re(Te,Ae[0]+15))){we=3;break e}lt!=null&&(lt[0]=Qe),Me!=null&&(Me[0]=Rt),Ie!=null&&(Ie[0]=Te),Ae[0]+=18,we[0]-=18,nt[0]=1}we=0}}if(Ne=Ne[0],xe=xe[0],we!=0)return we;if(Ae=!!(2&xe),!ke&&Ne)return 3;if(W!=null&&(W[0]=!!(16&xe)),Y!=null&&(Y[0]=Ae),Q!=null&&(Q[0]=0),Y=ae[0],xe=fe[0],Ne&&Ae&&te==null){we=0;break}if(4>x){we=7;break}if(ke&&Ne||!ke&&!Ne&&!n(d,m[0],"ALPH")){x=[x],pe.na=[pe.na],pe.P=[pe.P],pe.Sa=[pe.Sa];e:{Qe=d,we=m,ke=x;var nt=pe.gb;Me=pe.na,Ie=pe.P,lt=pe.Sa,Rt=22,e(Qe!=null),e(ke!=null),Te=we[0];var Ht=ke[0];for(e(Me!=null),e(lt!=null),Me[0]=null,Ie[0]=null,lt[0]=0;;){if(we[0]=Te,ke[0]=Ht,8>Ht){we=7;break e}var yr=be(Qe,Te+4);if(4294967286<yr){we=3;break e}var Lt=8+yr+1&-2;if(Rt+=Lt,0<nt&&Rt>nt){we=3;break e}if(!n(Qe,Te,"VP8 ")||!n(Qe,Te,"VP8L")){we=0;break e}if(Ht[0]<Lt){we=7;break e}n(Qe,Te,"ALPH")||(Me[0]=Qe,Ie[0]=Te+8,lt[0]=yr),Te+=Lt,Ht-=Lt}}if(x=x[0],pe.na=pe.na[0],pe.P=pe.P[0],pe.Sa=pe.Sa[0],we!=0)break}x=[x],pe.Ja=[pe.Ja],pe.xa=[pe.xa];e:if(nt=d,we=m,ke=x,Me=pe.gb[0],Ie=pe.Ja,lt=pe.xa,Qe=we[0],Te=!n(nt,Qe,"VP8 "),Rt=!n(nt,Qe,"VP8L"),e(nt!=null),e(ke!=null),e(Ie!=null),e(lt!=null),8>ke[0])we=7;else{if(Te||Rt){if(nt=be(nt,Qe+4),12<=Me&&nt>Me-12){we=3;break e}if(oe&&nt>ke[0]-8){we=7;break e}Ie[0]=nt,we[0]+=8,ke[0]-=8,lt[0]=Rt}else lt[0]=5<=ke[0]&&nt[Qe+0]==47&&!(nt[Qe+4]>>5),Ie[0]=ke[0];we=0}if(x=x[0],pe.Ja=pe.Ja[0],pe.xa=pe.xa[0],m=m[0],we!=0)break;if(4294967286<pe.Ja)return 3;if(Q==null||Ae||(Q[0]=pe.xa?2:1),Y=[Y],xe=[xe],pe.xa){if(5>x){we=7;break}Q=Y,oe=xe,Ae=W,d==null||5>x?d=0:5<=x&&d[m+0]==47&&!(d[m+4]>>5)?(ke=[0],nt=[0],Me=[0],H(Ie=new S,d,m,x),rs(Ie,ke,nt,Me)?(Q!=null&&(Q[0]=ke[0]),oe!=null&&(oe[0]=nt[0]),Ae!=null&&(Ae[0]=Me[0]),d=1):d=0):d=0}else{if(10>x){we=7;break}Q=xe,d==null||10>x||!Il(d,m+3,x-3)?d=0:(oe=d[m+0]|d[m+1]<<8|d[m+2]<<16,Ae=16383&(d[m+7]<<8|d[m+6]),d=16383&(d[m+9]<<8|d[m+8]),1&oe||3<(oe>>1&7)||!(oe>>4&1)||oe>>5>=pe.Ja||!Ae||!d?d=0:(Y&&(Y[0]=Ae),Q&&(Q[0]=d),d=1))}if(!d||(Y=Y[0],xe=xe[0],Ne&&(ae[0]!=Y||fe[0]!=xe)))return 3;te!=null&&(te[0]=pe,te.offset=m-te.w,e(4294967286>m-te.w),e(te.offset==te.ha-x));break}return we==0||we==7&&Ne&&te==null?(W!=null&&(W[0]|=pe.na!=null&&0<pe.na.length),I!=null&&(I[0]=Y),$!=null&&($[0]=xe),0):we}function Yu(d,m,x){var I=m.width,$=m.height,W=0,Y=0,Q=I,te=$;if(m.Da=d!=null&&0<d.Da,m.Da&&(Q=d.cd,te=d.bd,W=d.v,Y=d.j,11>x||(W&=-2,Y&=-2),0>W||0>Y||0>=Q||0>=te||W+Q>I||Y+te>$))return 0;if(m.v=W,m.j=Y,m.va=W+Q,m.o=Y+te,m.U=Q,m.T=te,m.da=d!=null&&0<d.da,m.da){if(!at(Q,te,x=[d.ib],W=[d.hb]))return 0;m.ib=x[0],m.hb=W[0]}return m.ob=d!=null&&d.ob,m.Kb=d==null||!d.Sd,m.da&&(m.ob=m.ib<3*I/4&&m.hb<3*$/4,m.Kb=0),1}function Qu(d){if(d==null)return 2;if(11>d.S){var m=d.f.RGBA;m.fb+=(d.height-1)*m.A,m.A=-m.A}else m=d.f.kb,d=d.height,m.O+=(d-1)*m.fa,m.fa=-m.fa,m.N+=(d-1>>1)*m.Ab,m.Ab=-m.Ab,m.W+=(d-1>>1)*m.Db,m.Db=-m.Db,m.F!=null&&(m.J+=(d-1)*m.lb,m.lb=-m.lb);return 0}function Eo(d,m,x,I){if(I==null||0>=d||0>=m)return 2;if(x!=null){if(x.Da){var $=x.cd,W=x.bd,Y=-2&x.v,Q=-2&x.j;if(0>Y||0>Q||0>=$||0>=W||Y+$>d||Q+W>m)return 2;d=$,m=W}if(x.da){if(!at(d,m,$=[x.ib],W=[x.hb]))return 2;d=$[0],m=W[0]}}I.width=d,I.height=m;e:{var te=I.width,ae=I.height;if(d=I.S,0>=te||0>=ae||!(d>=Wh&&13>d))d=2;else{if(0>=I.Rd&&I.sd==null){Y=W=$=m=0;var fe=(Q=te*k2[d])*ae;if(11>d||(W=(ae+1)/2*(m=(te+1)/2),d==12&&(Y=($=te)*ae)),(ae=s(fe+2*W+Y))==null){d=1;break e}I.sd=ae,11>d?((te=I.f.RGBA).eb=ae,te.fb=0,te.A=Q,te.size=fe):((te=I.f.kb).y=ae,te.O=0,te.fa=Q,te.Fd=fe,te.f=ae,te.N=0+fe,te.Ab=m,te.Cd=W,te.ea=ae,te.W=0+fe+W,te.Db=m,te.Ed=W,d==12&&(te.F=ae,te.J=0+fe+2*W),te.Tc=Y,te.lb=$)}if(m=1,$=I.S,W=I.width,Y=I.height,$>=Wh&&13>$)if(11>$)d=I.f.RGBA,m&=(Q=Math.abs(d.A))*(Y-1)+W<=d.size,m&=Q>=W*k2[$],m&=d.eb!=null;else{d=I.f.kb,Q=(W+1)/2,fe=(Y+1)/2,te=Math.abs(d.fa),ae=Math.abs(d.Ab);var Ne=Math.abs(d.Db),oe=Math.abs(d.lb),pe=oe*(Y-1)+W;m&=te*(Y-1)+W<=d.Fd,m&=ae*(fe-1)+Q<=d.Cd,m=(m&=Ne*(fe-1)+Q<=d.Ed)&te>=W&ae>=Q&Ne>=Q,m&=d.y!=null,m&=d.f!=null,m&=d.ea!=null,$==12&&(m&=oe>=W,m&=pe<=d.Tc,m&=d.F!=null)}else m=0;d=m?0:2}}return d!=0||x!=null&&x.fd&&(d=Qu(I)),d}var Vl=64,Fi=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ui=24,Ao=32,Fa=8,So=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];qe("Predictor0","PredictorAdd0"),_.Predictor0=function(){return 4278190080},_.Predictor1=function(d){return d},_.Predictor2=function(d,m,x){return m[x+0]},_.Predictor3=function(d,m,x){return m[x+1]},_.Predictor4=function(d,m,x){return m[x-1]},_.Predictor5=function(d,m,x){return Le(Le(d,m[x+1]),m[x+0])},_.Predictor6=function(d,m,x){return Le(d,m[x-1])},_.Predictor7=function(d,m,x){return Le(d,m[x+0])},_.Predictor8=function(d,m,x){return Le(m[x-1],m[x+0])},_.Predictor9=function(d,m,x){return Le(m[x+0],m[x+1])},_.Predictor10=function(d,m,x){return Le(Le(d,m[x-1]),Le(m[x+0],m[x+1]))},_.Predictor11=function(d,m,x){var I=m[x+0];return 0>=st(I>>24&255,d>>24&255,(m=m[x-1])>>24&255)+st(I>>16&255,d>>16&255,m>>16&255)+st(I>>8&255,d>>8&255,m>>8&255)+st(255&I,255&d,255&m)?I:d},_.Predictor12=function(d,m,x){var I=m[x+0];return(zt((d>>24&255)+(I>>24&255)-((m=m[x-1])>>24&255))<<24|zt((d>>16&255)+(I>>16&255)-(m>>16&255))<<16|zt((d>>8&255)+(I>>8&255)-(m>>8&255))<<8|zt((255&d)+(255&I)-(255&m)))>>>0},_.Predictor13=function(d,m,x){var I=m[x-1];return(At((d=Le(d,m[x+0]))>>24&255,I>>24&255)<<24|At(d>>16&255,I>>16&255)<<16|At(d>>8&255,I>>8&255)<<8|At(255&d,255&I))>>>0};var Xu=_.PredictorAdd0;_.PredictorAdd1=Tt,qe("Predictor2","PredictorAdd2"),qe("Predictor3","PredictorAdd3"),qe("Predictor4","PredictorAdd4"),qe("Predictor5","PredictorAdd5"),qe("Predictor6","PredictorAdd6"),qe("Predictor7","PredictorAdd7"),qe("Predictor8","PredictorAdd8"),qe("Predictor9","PredictorAdd9"),qe("Predictor10","PredictorAdd10"),qe("Predictor11","PredictorAdd11"),qe("Predictor12","PredictorAdd12"),qe("Predictor13","PredictorAdd13");var Tc=_.PredictorAdd2;ut("ColorIndexInverseTransform","MapARGB","32b",function(d){return d>>8&255},function(d){return d}),ut("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(d){return d},function(d){return d>>8&255});var er,zh=_.ColorIndexInverseTransform,sa=_.MapARGB,aa=_.VP8LColorIndexInverseTransformAlpha,Ju=_.MapAlpha,Zu=_.VP8LPredictorsAdd=[];Zu.length=16,(_.VP8LPredictors=[]).length=16,(_.VP8LPredictorsAdd_C=[]).length=16,(_.VP8LPredictors_C=[]).length=16;var ed,td,ko,To,jo,Bl,Co,$l,os,oa,sn,vn,tr,vr,Ua,nd,jc,qh,n2,r2,i2,s2,a2,o2,rd,l2,c2,u2,d2=s(511),h2=s(2041),f2=s(225),m2=s(767),p2=0,ng=h2,Hh=f2,Vi=m2,ls=d2,Wh=0,Gh=1,g2=2,Kh=3,Yh=4,rg=5,v2=6,ig=7,sg=8,Qh=9,ag=10,sS=[2,3,7],aS=[3,3,11],y2=[280,256,256,256,40],oS=[0,1,1,1,0],lS=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],cS=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],uS=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],dS=8,og=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],lg=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],id=null,hS=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],fS=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],x2=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],mS=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],pS=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],gS=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],vS=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Io=[],js=[],Va=[],yS=1,b2=2,Po=[],cs=[];Pr("UpsampleRgbLinePair",J,3),Pr("UpsampleBgrLinePair",ve,3),Pr("UpsampleRgbaLinePair",Ft,4),Pr("UpsampleBgraLinePair",Bn,4),Pr("UpsampleArgbLinePair",qt,4),Pr("UpsampleRgba4444LinePair",$e,2),Pr("UpsampleRgb565LinePair",_e,2);var xS=_.UpsampleRgbLinePair,bS=_.UpsampleBgrLinePair,w2=_.UpsampleRgbaLinePair,N2=_.UpsampleBgraLinePair,_2=_.UpsampleArgbLinePair,E2=_.UpsampleRgba4444LinePair,wS=_.UpsampleRgb565LinePair,Xh=16,Jh=1<<Xh-1,sd=-227,cg=482,NS=6,A2=0,_S=s(256),ES=s(256),AS=s(256),SS=s(256),kS=s(cg-sd),TS=s(cg-sd);Nn("YuvToRgbRow",J,3),Nn("YuvToBgrRow",ve,3),Nn("YuvToRgbaRow",Ft,4),Nn("YuvToBgraRow",Bn,4),Nn("YuvToArgbRow",qt,4),Nn("YuvToRgba4444Row",$e,2),Nn("YuvToRgb565Row",_e,2);var S2=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Zh=[0,2,8],jS=[8,7,6,4,4,2,2,2,1,1,1,1],CS=1;this.WebPDecodeRGBA=function(d,m,x,I,$){var W=Gh,Y=new ge,Q=new nn;Y.ba=Q,Q.S=W,Q.width=[Q.width],Q.height=[Q.height];var te=Q.width,ae=Q.height,fe=new xt;if(fe==null||d==null)var Ne=2;else e(fe!=null),Ne=Ts(d,m,x,fe.width,fe.height,fe.Pd,fe.Qd,fe.format,null);if(Ne!=0?te=0:(te!=null&&(te[0]=fe.width[0]),ae!=null&&(ae[0]=fe.height[0]),te=1),te){Q.width=Q.width[0],Q.height=Q.height[0],I!=null&&(I[0]=Q.width),$!=null&&($[0]=Q.height);e:{if(I=new Xs,($=new Se).data=d,$.w=m,$.ha=x,$.kd=1,m=[0],e($!=null),((d=Ts($.data,$.w,$.ha,null,null,null,m,null,$))==0||d==7)&&m[0]&&(d=4),(m=d)==0){if(e(Y!=null),I.data=$.data,I.w=$.w+$.offset,I.ha=$.ha-$.offset,I.put=mt,I.ac=qr,I.bc=kn,I.ma=Y,$.xa){if((d=Ks())==null){Y=1;break e}if(function(oe,pe){var xe=[0],Ae=[0],we=[0];t:for(;;){if(oe==null)return 0;if(pe==null)return oe.a=2,0;if(oe.l=pe,oe.a=0,H(oe.m,pe.data,pe.w,pe.ha),!rs(oe.m,xe,Ae,we)){oe.a=3;break t}if(oe.xb=b2,pe.width=xe[0],pe.height=Ae[0],!Ri(xe[0],Ae[0],1,oe,null))break t;return 1}return e(oe.a!=0),0}(d,I)){if(I=(m=Eo(I.width,I.height,Y.Oa,Y.ba))==0){t:{I=d;n:for(;;){if(I==null){I=0;break t}if(e(I.s.yc!=null),e(I.s.Ya!=null),e(0<I.s.Wb),e((x=I.l)!=null),e(($=x.ma)!=null),I.xb!=0){if(I.ca=$.ba,I.tb=$.tb,e(I.ca!=null),!Yu($.Oa,x,Kh)){I.a=2;break n}if(!_s(I,x.width)||x.da)break n;if((x.da||St(I.ca.S))&&wn(),11>I.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),I.ca.f.kb.F!=null&&wn()),I.Pb&&0<I.s.ua&&I.s.vb.X==null&&!ie(I.s.vb,I.s.Wa.Xa)){I.a=1;break n}I.xb=0}if(!Wr(I,I.V,I.Ba,I.c,I.i,x.o,Gs))break n;$.Dc=I.Ma,I=1;break t}e(I.a!=0),I=0}I=!I}I&&(m=d.a)}else m=d.a}else{if((d=new Cl)==null){Y=1;break e}if(d.Fa=$.na,d.P=$.P,d.qc=$.Sa,Ac(d,I)){if((m=Eo(I.width,I.height,Y.Oa,Y.ba))==0){if(d.Aa=0,x=Y.Oa,e(($=d)!=null),x!=null){if(0<(te=0>(te=x.Md)?0:100<te?255:255*te/100)){for(ae=fe=0;4>ae;++ae)12>(Ne=$.pb[ae]).lc&&(Ne.ia=te*jS[0>Ne.lc?0:Ne.lc]>>3),fe|=Ne.ia;fe&&(alert("todo:VP8InitRandom"),$.ia=1)}$.Ga=x.Id,100<$.Ga?$.Ga=100:0>$.Ga&&($.Ga=0)}(function(oe,pe){if(oe==null)return 0;if(pe==null)return Fn(oe,2,"NULL VP8Io parameter in VP8Decode().");if(!oe.cb&&!Ac(oe,pe))return 0;if(e(oe.cb),pe.ac==null||pe.ac(pe)){pe.ob&&(oe.L=0);var xe=Zh[oe.L];if(oe.L==2?(oe.yb=0,oe.zb=0):(oe.yb=pe.v-xe>>4,oe.zb=pe.j-xe>>4,0>oe.yb&&(oe.yb=0),0>oe.zb&&(oe.zb=0)),oe.Va=pe.o+15+xe>>4,oe.Hb=pe.va+15+xe>>4,oe.Hb>oe.za&&(oe.Hb=oe.za),oe.Va>oe.Ub&&(oe.Va=oe.Ub),0<oe.L){var Ae=oe.ed;for(xe=0;4>xe;++xe){var we;if(oe.Qa.Cb){var ke=oe.Qa.Lb[xe];oe.Qa.Fb||(ke+=Ae.Tb)}else ke=Ae.Tb;for(we=0;1>=we;++we){var Te=oe.gd[xe][we],Me=ke;if(Ae.Pc&&(Me+=Ae.vd[0],we&&(Me+=Ae.od[0])),0<(Me=0>Me?0:63<Me?63:Me)){var Ie=Me;0<Ae.wb&&(Ie=4<Ae.wb?Ie>>2:Ie>>1)>9-Ae.wb&&(Ie=9-Ae.wb),1>Ie&&(Ie=1),Te.dd=Ie,Te.tc=2*Me+Ie,Te.ld=40<=Me?2:15<=Me?1:0}else Te.tc=0;Te.La=we}}}xe=0}else Fn(oe,6,"Frame setup failed"),xe=oe.a;if(xe=xe==0){if(xe){oe.$c=0,0<oe.Aa||(oe.Ic=CS);t:{xe=oe.Ic,Ae=4*(Ie=oe.za);var lt=32*Ie,Qe=Ie+1,Rt=0<oe.L?Ie*(0<oe.Aa?2:1):0,nt=(oe.Aa==2?2:1)*Ie;if((Te=Ae+832+(we=3*(16*xe+Zh[oe.L])/2*lt)+(ke=oe.Fa!=null&&0<oe.Fa.length?oe.Kc.c*oe.Kc.i:0))!=Te)xe=0;else{if(Te>oe.Vb){if(oe.Vb=0,oe.Ec=s(Te),oe.Fc=0,oe.Ec==null){xe=Fn(oe,1,"no memory during frame initialization.");break t}oe.Vb=Te}Te=oe.Ec,Me=oe.Fc,oe.Ac=Te,oe.Bc=Me,Me+=Ae,oe.Gd=o(lt,Tl),oe.Hd=0,oe.rb=o(Qe+1,Li),oe.sb=1,oe.wa=Rt?o(Rt,Sr):null,oe.Y=0,oe.D.Nb=0,oe.D.wa=oe.wa,oe.D.Y=oe.Y,0<oe.Aa&&(oe.D.Y+=Ie),e(!0),oe.oc=Te,oe.pc=Me,Me+=832,oe.ya=o(nt,Sl),oe.aa=0,oe.D.ya=oe.ya,oe.D.aa=oe.aa,oe.Aa==2&&(oe.D.aa+=Ie),oe.R=16*Ie,oe.B=8*Ie,Ie=(lt=Zh[oe.L])*oe.R,lt=lt/2*oe.B,oe.sa=Te,oe.ta=Me+Ie,oe.qa=oe.sa,oe.ra=oe.ta+16*xe*oe.R+lt,oe.Ha=oe.qa,oe.Ia=oe.ra+8*xe*oe.B+lt,oe.$c=0,Me+=we,oe.mb=ke?Te:null,oe.nb=ke?Me:null,e(Me+ke<=oe.Fc+oe.Vb),Js(oe),i(oe.Ac,oe.Bc,0,Ae),xe=1}}if(xe){if(pe.ka=0,pe.y=oe.sa,pe.O=oe.ta,pe.f=oe.qa,pe.N=oe.ra,pe.ea=oe.Ha,pe.Vd=oe.Ia,pe.fa=oe.R,pe.Rc=oe.B,pe.F=null,pe.J=0,!p2){for(xe=-255;255>=xe;++xe)d2[255+xe]=0>xe?-xe:xe;for(xe=-1020;1020>=xe;++xe)h2[1020+xe]=-128>xe?-128:127<xe?127:xe;for(xe=-112;112>=xe;++xe)f2[112+xe]=-16>xe?-16:15<xe?15:xe;for(xe=-255;510>=xe;++xe)m2[255+xe]=0>xe?0:255<xe?255:xe;p2=1}Co=Zs,$l=yo,oa=Sc,sn=Bt,vn=Ra,os=vo,tr=Ml,vr=_o,Ua=y,nd=B,jc=as,qh=Fl,n2=se,r2=de,i2=ra,s2=ia,a2=wi,o2=Ol,js[0]=Wu,js[1]=Pl,js[2]=ta,js[3]=Hu,js[4]=Gu,js[5]=As,js[6]=kr,js[7]=Ku,js[8]=Ss,js[9]=bo,Io[0]=bi,Io[1]=zu,Io[2]=qu,Io[3]=Rl,Io[4]=is,Io[5]=ea,Io[6]=xo,Va[0]=Da,Va[1]=kc,Va[2]=wo,Va[3]=Di,Va[4]=gn,Va[5]=Ll,Va[6]=Dl,xe=1}else xe=0}xe&&(xe=function(Ht,yr){for(Ht.M=0;Ht.M<Ht.Va;++Ht.M){var Lt,rt=Ht.Jc[Ht.M&Ht.Xb],ze=Ht.m,nr=Ht;for(Lt=0;Lt<nr.za;++Lt){var Pt=ze,Qt=nr,Tn=Qt.Ac,Lr=Qt.Bc+4*Lt,di=Qt.zc,Kn=Qt.ya[Qt.aa+Lt];if(Qt.Qa.Bb?Kn.$b=ye(Pt,Qt.Pa.jb[0])?2+ye(Pt,Qt.Pa.jb[2]):ye(Pt,Qt.Pa.jb[1]):Kn.$b=0,Qt.kc&&(Kn.Ad=ye(Pt,Qt.Bd)),Kn.Za=!ye(Pt,145)+0,Kn.Za){var Kr=Kn.Ob,hi=0;for(Qt=0;4>Qt;++Qt){var xr,Jt=di[0+Qt];for(xr=0;4>xr;++xr){Jt=pS[Tn[Lr+xr]][Jt];for(var cn=x2[ye(Pt,Jt[0])];0<cn;)cn=x2[2*cn+ye(Pt,Jt[cn])];Jt=-cn,Tn[Lr+xr]=Jt}r(Kr,hi,Tn,Lr,4),hi+=4,di[0+Qt]=Jt}}else Jt=ye(Pt,156)?ye(Pt,128)?1:3:ye(Pt,163)?2:0,Kn.Ob[0]=Jt,i(Tn,Lr,Jt,4),i(di,0,Jt,4);Kn.Dd=ye(Pt,142)?ye(Pt,114)?ye(Pt,183)?1:3:2:0}if(nr.m.Ka)return Fn(Ht,7,"Premature end-of-partition0 encountered.");for(;Ht.ja<Ht.za;++Ht.ja){if(nr=rt,Pt=(ze=Ht).rb[ze.sb-1],Tn=ze.rb[ze.sb+ze.ja],Lt=ze.ya[ze.aa+ze.ja],Lr=ze.kc?Lt.Ad:0)Pt.la=Tn.la=0,Lt.Za||(Pt.Na=Tn.Na=0),Lt.Hc=0,Lt.Gc=0,Lt.ia=0;else{var Yn,un;if(Pt=Tn,Tn=nr,Lr=ze.Pa.Xc,di=ze.ya[ze.aa+ze.ja],Kn=ze.pb[di.$b],Qt=di.ad,Kr=0,hi=ze.rb[ze.sb-1],Jt=xr=0,i(Qt,Kr,0,384),di.Za)var Dr=0,Cs=Lr[3];else{cn=s(16);var rr=Pt.Na+hi.Na;if(rr=id(Tn,Lr[1],rr,Kn.Eb,0,cn,0),Pt.Na=hi.Na=(0<rr)+0,1<rr)Co(cn,0,Qt,Kr);else{var Ni=cn[0]+3>>3;for(cn=0;256>cn;cn+=16)Qt[Kr+cn]=Ni}Dr=1,Cs=Lr[0]}var yn=15&Pt.la,br=15&hi.la;for(cn=0;4>cn;++cn){var Bi=1&br;for(Ni=un=0;4>Ni;++Ni)yn=yn>>1|(Bi=(rr=id(Tn,Cs,rr=Bi+(1&yn),Kn.Sc,Dr,Qt,Kr))>Dr)<<7,un=un<<2|(3<rr?3:1<rr?2:Qt[Kr+0]!=0),Kr+=16;yn>>=4,br=br>>1|Bi<<7,xr=(xr<<8|un)>>>0}for(Cs=yn,Dr=br>>4,Yn=0;4>Yn;Yn+=2){for(un=0,yn=Pt.la>>4+Yn,br=hi.la>>4+Yn,cn=0;2>cn;++cn){for(Bi=1&br,Ni=0;2>Ni;++Ni)rr=Bi+(1&yn),yn=yn>>1|(Bi=0<(rr=id(Tn,Lr[2],rr,Kn.Qc,0,Qt,Kr)))<<3,un=un<<2|(3<rr?3:1<rr?2:Qt[Kr+0]!=0),Kr+=16;yn>>=2,br=br>>1|Bi<<5}Jt|=un<<4*Yn,Cs|=yn<<4<<Yn,Dr|=(240&br)<<Yn}Pt.la=Cs,hi.la=Dr,di.Hc=xr,di.Gc=Jt,di.ia=43690&Jt?0:Kn.ia,Lr=!(xr|Jt)}if(0<ze.L&&(ze.wa[ze.Y+ze.ja]=ze.gd[Lt.$b][Lt.Za],ze.wa[ze.Y+ze.ja].La|=!Lr),nr.Ka)return Fn(Ht,7,"Premature end-of-file encountered.")}if(Js(Ht),ze=yr,nr=1,Lt=(rt=Ht).D,Pt=0<rt.L&&rt.M>=rt.zb&&rt.M<=rt.Va,rt.Aa==0)t:{if(Lt.M=rt.M,Lt.uc=Pt,Rr(rt,Lt),nr=1,Lt=(un=rt.D).Nb,Pt=(Jt=Zh[rt.L])*rt.R,Tn=Jt/2*rt.B,cn=16*Lt*rt.R,Ni=8*Lt*rt.B,Lr=rt.sa,di=rt.ta-Pt+cn,Kn=rt.qa,Qt=rt.ra-Tn+Ni,Kr=rt.Ha,hi=rt.Ia-Tn+Ni,br=(yn=un.M)==0,xr=yn>=rt.Va-1,rt.Aa==2&&Rr(rt,un),un.uc)for(Bi=(rr=rt).D.M,e(rr.D.uc),un=rr.yb;un<rr.Hb;++un){Dr=un,Cs=Bi;var fi=($i=(Or=rr).D).Nb;Yn=Or.R;var $i=$i.wa[$i.Y+Dr],zi=Or.sa,_i=Or.ta+16*fi*Yn+16*Dr,qi=$i.dd,_n=$i.tc;if(_n!=0)if(e(3<=_n),Or.L==1)0<Dr&&s2(zi,_i,Yn,_n+4),$i.La&&o2(zi,_i,Yn,_n),0<Cs&&i2(zi,_i,Yn,_n+4),$i.La&&a2(zi,_i,Yn,_n);else{var Hi=Or.B,Is=Or.qa,zl=Or.ra+8*fi*Hi+8*Dr,Ba=Or.Ha,Or=Or.Ia+8*fi*Hi+8*Dr;fi=$i.ld,0<Dr&&(vr(zi,_i,Yn,_n+4,qi,fi),nd(Is,zl,Ba,Or,Hi,_n+4,qi,fi)),$i.La&&(qh(zi,_i,Yn,_n,qi,fi),r2(Is,zl,Ba,Or,Hi,_n,qi,fi)),0<Cs&&(tr(zi,_i,Yn,_n+4,qi,fi),Ua(Is,zl,Ba,Or,Hi,_n+4,qi,fi)),$i.La&&(jc(zi,_i,Yn,_n,qi,fi),n2(Is,zl,Ba,Or,Hi,_n,qi,fi))}}if(rt.ia&&alert("todo:DitherRow"),ze.put!=null){if(un=16*yn,yn=16*(yn+1),br?(ze.y=rt.sa,ze.O=rt.ta+cn,ze.f=rt.qa,ze.N=rt.ra+Ni,ze.ea=rt.Ha,ze.W=rt.Ia+Ni):(un-=Jt,ze.y=Lr,ze.O=di,ze.f=Kn,ze.N=Qt,ze.ea=Kr,ze.W=hi),xr||(yn-=Jt),yn>ze.o&&(yn=ze.o),ze.F=null,ze.J=null,rt.Fa!=null&&0<rt.Fa.length&&un<yn&&(ze.J=Un(rt,ze,un,yn-un),ze.F=rt.mb,ze.F==null&&ze.F.length==0)){nr=Fn(rt,3,"Could not decode alpha data.");break t}un<ze.j&&(Jt=ze.j-un,un=ze.j,e(!(1&Jt)),ze.O+=rt.R*Jt,ze.N+=rt.B*(Jt>>1),ze.W+=rt.B*(Jt>>1),ze.F!=null&&(ze.J+=ze.width*Jt)),un<yn&&(ze.O+=ze.v,ze.N+=ze.v>>1,ze.W+=ze.v>>1,ze.F!=null&&(ze.J+=ze.v),ze.ka=un-ze.j,ze.U=ze.va-ze.v,ze.T=yn-un,nr=ze.put(ze))}Lt+1!=rt.Ic||xr||(r(rt.sa,rt.ta-Pt,Lr,di+16*rt.R,Pt),r(rt.qa,rt.ra-Tn,Kn,Qt+8*rt.B,Tn),r(rt.Ha,rt.Ia-Tn,Kr,hi+8*rt.B,Tn))}if(!nr)return Fn(Ht,6,"Output aborted.")}return 1}(oe,pe)),pe.bc!=null&&pe.bc(pe),xe&=1}return xe?(oe.cb=0,xe):0})(d,I)||(m=d.a)}}else m=d.a}m==0&&Y.Oa!=null&&Y.Oa.fd&&(m=Qu(Y.ba))}Y=m}W=Y!=0?null:11>W?Q.f.RGBA.eb:Q.f.kb.y}else W=null;return W};var k2=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(_,F){for(var A="",L=0;L<4;L++)A+=String.fromCharCode(_[F++]);return A}function f(_,F){return _[F+0]|_[F+1]<<8}function v(_,F){return(_[F+0]|_[F+1]<<8|_[F+2]<<16)>>>0}function g(_,F){return(_[F+0]|_[F+1]<<8|_[F+2]<<16|_[F+3]<<24)>>>0}new c;var p=[0],T=[0],k=[],C=new c,b=t,P=function(_,F){var A={},L=0,E=!1,M=0,G=0;if(A.frames=[],!function(w,S){for(var V=0;V<4;V++)if(w[S+V]!="RIFF".charCodeAt(V))return!0;return!1}(_,F)){for(g(_,F+=4),F+=8;F<_.length;){var K=u(_,F),z=g(_,F+=4);F+=4;var q=z+(1&z);switch(K){case"VP8 ":case"VP8L":A.frames[L]===void 0&&(A.frames[L]={}),(ne=A.frames[L]).src_off=E?G:F-8,ne.src_size=M+z+8,L++,E&&(E=!1,M=0,G=0);break;case"VP8X":(ne=A.header={}).feature_flags=_[F];var H=F+4;ne.canvas_width=1+v(_,H),H+=3,ne.canvas_height=1+v(_,H),H+=3;break;case"ALPH":E=!0,M=q+8,G=F-8;break;case"ANIM":(ne=A.header).bgcolor=g(_,F),H=F+4,ne.loop_count=f(_,H),H+=2;break;case"ANMF":var X,ne;(ne=A.frames[L]={}).offset_x=2*v(_,F),F+=3,ne.offset_y=2*v(_,F),F+=3,ne.width=1+v(_,F),F+=3,ne.height=1+v(_,F),F+=3,ne.duration=v(_,F),F+=3,X=_[F++],ne.dispose=1&X,ne.blend=X>>1&1}K!="ANMF"&&(F+=q)}return A}}(b,0);P.response=b,P.rgbaoutput=!0,P.dataurl=!1;var R=P.header?P.header:null,D=P.frames?P.frames:null;if(R){R.loop_counter=R.loop_count,p=[R.canvas_height],T=[R.canvas_width];for(var Z=0;Z<D.length&&D[Z].blend!=0;Z++);}var le=D[0],U=C.WebPDecodeRGBA(b,le.src_off,le.src_size,T,p);le.rgba=U,le.imgwidth=T[0],le.imgheight=p[0];for(var j=0;j<T[0]*p[0]*4;j++)k[j]=U[j];return this.width=T,this.height=p,this.data=k,this}(function(t){var e,n,r,i,s,o,l,c,u,f=function(w){return w=w||{},this.isStrokeTransparent=w.isStrokeTransparent||!1,this.strokeOpacity=w.strokeOpacity||1,this.strokeStyle=w.strokeStyle||"#000000",this.fillStyle=w.fillStyle||"#000000",this.isFillTransparent=w.isFillTransparent||!1,this.fillOpacity=w.fillOpacity||1,this.font=w.font||"10px sans-serif",this.textBaseline=w.textBaseline||"alphabetic",this.textAlign=w.textAlign||"left",this.lineWidth=w.lineWidth||1,this.lineJoin=w.lineJoin||"miter",this.lineCap=w.lineCap||"butt",this.path=w.path||[],this.transform=w.transform!==void 0?w.transform.clone():new c,this.globalCompositeOperation=w.globalCompositeOperation||"normal",this.globalAlpha=w.globalAlpha||1,this.clip_path=w.clip_path||[],this.currentPoint=w.currentPoint||new o,this.miterLimit=w.miterLimit||10,this.lastPoint=w.lastPoint||new o,this.lineDashOffset=w.lineDashOffset||0,this.lineDash=w.lineDash||[],this.margin=w.margin||[0,0,0,0],this.prevPageLastElemOffset=w.prevPageLastElemOffset||0,this.ignoreClearRect=typeof w.ignoreClearRect!="boolean"||w.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new v(this),e=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new f}]);var v=function(w){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var S=w;Object.defineProperty(this,"pdf",{get:function(){return S}});var V=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return V},set:function(be){V=!!be}});var ee=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ee},set:function(be){ee=!!be}});var re=0;Object.defineProperty(this,"posX",{get:function(){return re},set:function(be){isNaN(be)||(re=be)}});var ce=0;Object.defineProperty(this,"posY",{get:function(){return ce},set:function(be){isNaN(be)||(ce=be)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(be){var ie;typeof be=="number"?ie=[be,be,be,be]:((ie=new Array(4))[0]=be[0],ie[1]=be.length>=2?be[1]:ie[0],ie[2]=be.length>=3?be[2]:ie[0],ie[3]=be.length>=4?be[3]:ie[1]),u.margin=ie}});var he=!1;Object.defineProperty(this,"autoPaging",{get:function(){return he},set:function(be){he=be}});var me=0;Object.defineProperty(this,"lastBreak",{get:function(){return me},set:function(be){me=be}});var ye=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ye},set:function(be){ye=be}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(be){be instanceof f&&(u=be)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(be){u.path=be}});var Ee=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ee},set:function(be){Ee=be}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(be){var ie;ie=g(be),this.ctx.fillStyle=ie.style,this.ctx.isFillTransparent=ie.a===0,this.ctx.fillOpacity=ie.a,this.pdf.setFillColor(ie.r,ie.g,ie.b,{a:ie.a}),this.pdf.setTextColor(ie.r,ie.g,ie.b,{a:ie.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(be){var ie=g(be);this.ctx.strokeStyle=ie.style,this.ctx.isStrokeTransparent=ie.a===0,this.ctx.strokeOpacity=ie.a,ie.a===0?this.pdf.setDrawColor(255,255,255):(ie.a,this.pdf.setDrawColor(ie.r,ie.g,ie.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(be){["butt","round","square"].indexOf(be)!==-1&&(this.ctx.lineCap=be,this.pdf.setLineCap(be))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(be){isNaN(be)||(this.ctx.lineWidth=be,this.pdf.setLineWidth(be))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(be){["bevel","round","miter"].indexOf(be)!==-1&&(this.ctx.lineJoin=be,this.pdf.setLineJoin(be))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(be){isNaN(be)||(this.ctx.miterLimit=be,this.pdf.setMiterLimit(be))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(be){this.ctx.textBaseline=be}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(be){["right","end","center","left","start"].indexOf(be)!==-1&&(this.ctx.textAlign=be)}});var Pe=null,Re=null;Object.defineProperty(this,"fontFaces",{get:function(){return Re},set:function(be){Pe=null,Re=be}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(be){var ie;if(this.ctx.font=be,(ie=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(be))!==null){var Ge=ie[1];ie[2];var it=ie[3],at=ie[4];ie[5];var De=ie[6],Je=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(at)[2];at=Math.floor(Je==="px"?parseFloat(at)*this.pdf.internal.scaleFactor:Je==="em"?parseFloat(at)*this.pdf.getFontSize():parseFloat(at)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(at);var qe=function(yt){var ut,en,Kt=[],tt=yt.trim();if(tt==="")return _0;if(tt in p5)return[p5[tt]];for(;tt!=="";){switch(en=null,ut=(tt=v5(tt)).charAt(0)){case'"':case"'":en=ZD(tt.substring(1),ut);break;default:en=eO(tt)}if(en===null||(Kt.push(en[0]),(tt=v5(en[1]))!==""&&tt.charAt(0)!==","))return _0;tt=tt.replace(/^,/,"")}return Kt}(De);if(this.fontFaces){var Ue=function(yt,ut){if(Pe===null){var en=function(Kt){var tt=[];return Object.keys(Kt).forEach(function(Nt){Kt[Nt].forEach(function(an){var pt=null;switch(an){case"bold":pt={family:Nt,weight:"bold"};break;case"italic":pt={family:Nt,style:"italic"};break;case"bolditalic":pt={family:Nt,weight:"bold",style:"italic"};break;case"":case"normal":pt={family:Nt}}pt!==null&&(pt.ref={name:Nt,style:an},tt.push(pt))})}),tt}(yt.getFontList());Pe=function(Kt){for(var tt={},Nt=0;Nt<Kt.length;++Nt){var an=N0(Kt[Nt]),pt=an.family,Dt=an.stretch,St=an.style,Rn=an.weight;tt[pt]=tt[pt]||{},tt[pt][Dt]=tt[pt][Dt]||{},tt[pt][Dt][St]=tt[pt][Dt][St]||{},tt[pt][Dt][St][Rn]=an}return tt}(en.concat(ut))}return Pe}(this.pdf,this.fontFaces),Le=qe.map(function(yt){return{family:yt,stretch:"normal",weight:it,style:Ge}}),zt=function(yt,ut,en){for(var Kt=(en=en||{}).defaultFontFamily||"times",tt=Object.assign({},JD,en.genericFontFamilies||{}),Nt=null,an=null,pt=0;pt<ut.length;++pt)if(tt[(Nt=N0(ut[pt])).family]&&(Nt.family=tt[Nt.family]),yt.hasOwnProperty(Nt.family)){an=yt[Nt.family];break}if(!(an=an||yt[Kt]))throw new Error("Could not find a font-family for the rule '"+g5(Nt)+"' and default family '"+Kt+"'.");if(an=function(Dt,St){if(St[Dt])return St[Dt];var Rn=e1[Dt],Sn=Rn<=e1.normal?-1:1,nn=m5(St,ZA,Rn,Sn);if(!nn)throw new Error("Could not find a matching font-stretch value for "+Dt);return nn}(Nt.stretch,an),an=function(Dt,St){if(St[Dt])return St[Dt];for(var Rn=JA[Dt],Sn=0;Sn<Rn.length;++Sn)if(St[Rn[Sn]])return St[Rn[Sn]];throw new Error("Could not find a matching font-style for "+Dt)}(Nt.style,an),!(an=function(Dt,St){if(St[Dt])return St[Dt];if(Dt===400&&St[500])return St[500];if(Dt===500&&St[400])return St[400];var Rn=XD[Dt],Sn=m5(St,eS,Rn,Dt<400?-1:1);if(!Sn)throw new Error("Could not find a matching font-weight for value "+Dt);return Sn}(Nt.weight,an)))throw new Error("Failed to resolve a font for the rule '"+g5(Nt)+"'.");return an}(Ue,Le);this.pdf.setFont(zt.ref.name,zt.ref.style)}else{var At="";(it==="bold"||parseInt(it,10)>=700||Ge==="bold")&&(At="bold"),Ge==="italic"&&(At+="italic"),At.length===0&&(At="normal");for(var st="",Tt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},wt=0;wt<qe.length;wt++){if(this.pdf.internal.getFont(qe[wt],At,{noFallback:!0,disableWarning:!0})!==void 0){st=qe[wt];break}if(At==="bolditalic"&&this.pdf.internal.getFont(qe[wt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)st=qe[wt],At="bold";else if(this.pdf.internal.getFont(qe[wt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){st=qe[wt],At="normal";break}}if(st===""){for(var ot=0;ot<qe.length;ot++)if(Tt[qe[ot]]){st=Tt[qe[ot]];break}}st=st===""?"Times":st,this.pdf.setFont(st,At)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(be){this.ctx.globalCompositeOperation=be}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(be){this.ctx.globalAlpha=be}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(be){this.ctx.lineDashOffset=be,ne.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(be){this.ctx.lineDash=be,ne.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(be){this.ctx.ignoreClearRect=!!be}})};v.prototype.setLineDash=function(w){this.lineDash=w},v.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},v.prototype.fill=function(){D.call(this,"fill",!1)},v.prototype.stroke=function(){D.call(this,"stroke",!1)},v.prototype.beginPath=function(){this.path=[{type:"begin"}]},v.prototype.moveTo=function(w,S){if(isNaN(w)||isNaN(S))throw xn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var V=this.ctx.transform.applyToPoint(new o(w,S));this.path.push({type:"mt",x:V.x,y:V.y}),this.ctx.lastPoint=new o(w,S)},v.prototype.closePath=function(){var w=new o(0,0),S=0;for(S=this.path.length-1;S!==-1;S--)if(this.path[S].type==="begin"&&hn(this.path[S+1])==="object"&&typeof this.path[S+1].x=="number"){w=new o(this.path[S+1].x,this.path[S+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(w.x,w.y)},v.prototype.lineTo=function(w,S){if(isNaN(w)||isNaN(S))throw xn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var V=this.ctx.transform.applyToPoint(new o(w,S));this.path.push({type:"lt",x:V.x,y:V.y}),this.ctx.lastPoint=new o(V.x,V.y)},v.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),D.call(this,null,!0)},v.prototype.quadraticCurveTo=function(w,S,V,ee){if(isNaN(V)||isNaN(ee)||isNaN(w)||isNaN(S))throw xn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var re=this.ctx.transform.applyToPoint(new o(V,ee)),ce=this.ctx.transform.applyToPoint(new o(w,S));this.path.push({type:"qct",x1:ce.x,y1:ce.y,x:re.x,y:re.y}),this.ctx.lastPoint=new o(re.x,re.y)},v.prototype.bezierCurveTo=function(w,S,V,ee,re,ce){if(isNaN(re)||isNaN(ce)||isNaN(w)||isNaN(S)||isNaN(V)||isNaN(ee))throw xn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var he=this.ctx.transform.applyToPoint(new o(re,ce)),me=this.ctx.transform.applyToPoint(new o(w,S)),ye=this.ctx.transform.applyToPoint(new o(V,ee));this.path.push({type:"bct",x1:me.x,y1:me.y,x2:ye.x,y2:ye.y,x:he.x,y:he.y}),this.ctx.lastPoint=new o(he.x,he.y)},v.prototype.arc=function(w,S,V,ee,re,ce){if(isNaN(w)||isNaN(S)||isNaN(V)||isNaN(ee)||isNaN(re))throw xn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ce=!!ce,!this.ctx.transform.isIdentity){var he=this.ctx.transform.applyToPoint(new o(w,S));w=he.x,S=he.y;var me=this.ctx.transform.applyToPoint(new o(0,V)),ye=this.ctx.transform.applyToPoint(new o(0,0));V=Math.sqrt(Math.pow(me.x-ye.x,2)+Math.pow(me.y-ye.y,2))}Math.abs(re-ee)>=2*Math.PI&&(ee=0,re=2*Math.PI),this.path.push({type:"arc",x:w,y:S,radius:V,startAngle:ee,endAngle:re,counterclockwise:ce})},v.prototype.arcTo=function(w,S,V,ee,re){throw new Error("arcTo not implemented.")},v.prototype.rect=function(w,S,V,ee){if(isNaN(w)||isNaN(S)||isNaN(V)||isNaN(ee))throw xn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(w,S),this.lineTo(w+V,S),this.lineTo(w+V,S+ee),this.lineTo(w,S+ee),this.lineTo(w,S),this.lineTo(w+V,S),this.lineTo(w,S)},v.prototype.fillRect=function(w,S,V,ee){if(isNaN(w)||isNaN(S)||isNaN(V)||isNaN(ee))throw xn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var re={};this.lineCap!=="butt"&&(re.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(re.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(w,S,V,ee),this.fill(),re.hasOwnProperty("lineCap")&&(this.lineCap=re.lineCap),re.hasOwnProperty("lineJoin")&&(this.lineJoin=re.lineJoin)}},v.prototype.strokeRect=function(w,S,V,ee){if(isNaN(w)||isNaN(S)||isNaN(V)||isNaN(ee))throw xn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");T.call(this)||(this.beginPath(),this.rect(w,S,V,ee),this.stroke())},v.prototype.clearRect=function(w,S,V,ee){if(isNaN(w)||isNaN(S)||isNaN(V)||isNaN(ee))throw xn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(w,S,V,ee))},v.prototype.save=function(w){w=typeof w!="boolean"||w;for(var S=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("q");if(this.pdf.setPage(S),w){this.ctx.fontSize=this.pdf.internal.getFontSize();var ee=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ee}},v.prototype.restore=function(w){w=typeof w!="boolean"||w;for(var S=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("Q");this.pdf.setPage(S),w&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},v.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g=function(w){var S,V,ee,re;if(w.isCanvasGradient===!0&&(w=w.getColor()),!w)return{r:0,g:0,b:0,a:0,style:w};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(w))S=0,V=0,ee=0,re=0;else{var ce=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(w);if(ce!==null)S=parseInt(ce[1]),V=parseInt(ce[2]),ee=parseInt(ce[3]),re=1;else if((ce=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(w))!==null)S=parseInt(ce[1]),V=parseInt(ce[2]),ee=parseInt(ce[3]),re=parseFloat(ce[4]);else{if(re=1,typeof w=="string"&&w.charAt(0)!=="#"){var he=new HA(w);w=he.ok?he.toHex():"#000000"}w.length===4?(S=w.substring(1,2),S+=S,V=w.substring(2,3),V+=V,ee=w.substring(3,4),ee+=ee):(S=w.substring(1,3),V=w.substring(3,5),ee=w.substring(5,7)),S=parseInt(S,16),V=parseInt(V,16),ee=parseInt(ee,16)}}return{r:S,g:V,b:ee,a:re,style:w}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},T=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};v.prototype.fillText=function(w,S,V,ee){if(isNaN(S)||isNaN(V)||typeof w!="string")throw xn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ee=isNaN(ee)?void 0:ee,!p.call(this)){var re=q(this.ctx.transform.rotation),ce=this.ctx.transform.scaleX;L.call(this,{text:w,x:S,y:V,scale:ce,angle:re,align:this.textAlign,maxWidth:ee})}},v.prototype.strokeText=function(w,S,V,ee){if(isNaN(S)||isNaN(V)||typeof w!="string")throw xn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!T.call(this)){ee=isNaN(ee)?void 0:ee;var re=q(this.ctx.transform.rotation),ce=this.ctx.transform.scaleX;L.call(this,{text:w,x:S,y:V,scale:ce,renderingMode:"stroke",angle:re,align:this.textAlign,maxWidth:ee})}},v.prototype.measureText=function(w){if(typeof w!="string")throw xn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var S=this.pdf,V=this.pdf.internal.scaleFactor,ee=S.internal.getFontSize(),re=S.getStringUnitWidth(w)*ee/S.internal.scaleFactor;return new function(ce){var he=(ce=ce||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return he}}),this}({width:re*=Math.round(96*V/72*1e4)/1e4})},v.prototype.scale=function(w,S){if(isNaN(w)||isNaN(S))throw xn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var V=new c(w,0,0,S,0,0);this.ctx.transform=this.ctx.transform.multiply(V)},v.prototype.rotate=function(w){if(isNaN(w))throw xn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var S=new c(Math.cos(w),Math.sin(w),-Math.sin(w),Math.cos(w),0,0);this.ctx.transform=this.ctx.transform.multiply(S)},v.prototype.translate=function(w,S){if(isNaN(w)||isNaN(S))throw xn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var V=new c(1,0,0,1,w,S);this.ctx.transform=this.ctx.transform.multiply(V)},v.prototype.transform=function(w,S,V,ee,re,ce){if(isNaN(w)||isNaN(S)||isNaN(V)||isNaN(ee)||isNaN(re)||isNaN(ce))throw xn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var he=new c(w,S,V,ee,re,ce);this.ctx.transform=this.ctx.transform.multiply(he)},v.prototype.setTransform=function(w,S,V,ee,re,ce){w=isNaN(w)?1:w,S=isNaN(S)?0:S,V=isNaN(V)?0:V,ee=isNaN(ee)?1:ee,re=isNaN(re)?0:re,ce=isNaN(ce)?0:ce,this.ctx.transform=new c(w,S,V,ee,re,ce)};var k=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};v.prototype.drawImage=function(w,S,V,ee,re,ce,he,me,ye){var Ee=this.pdf.getImageProperties(w),Pe=1,Re=1,be=1,ie=1;ee!==void 0&&me!==void 0&&(be=me/ee,ie=ye/re,Pe=Ee.width/ee*me/ee,Re=Ee.height/re*ye/re),ce===void 0&&(ce=S,he=V,S=0,V=0),ee!==void 0&&me===void 0&&(me=ee,ye=re),ee===void 0&&me===void 0&&(me=Ee.width,ye=Ee.height);for(var Ge,it=this.ctx.transform.decompose(),at=q(it.rotate.shx),De=new c,Je=(De=(De=(De=De.multiply(it.translate)).multiply(it.skew)).multiply(it.scale)).applyToRectangle(new l(ce-S*be,he-V*ie,ee*Pe,re*Re)),qe=C.call(this,Je),Ue=[],Le=0;Le<qe.length;Le+=1)Ue.indexOf(qe[Le])===-1&&Ue.push(qe[Le]);if(R(Ue),this.autoPaging)for(var zt=Ue[0],At=Ue[Ue.length-1],st=zt;st<At+1;st++){this.pdf.setPage(st);var Tt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],wt=st===1?this.posY+this.margin[0]:this.margin[0],ot=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],yt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ut=st===1?0:ot+(st-2)*yt;if(this.ctx.clip_path.length!==0){var en=this.path;Ge=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=P(Ge,this.posX+this.margin[3],-ut+wt+this.ctx.prevPageLastElemOffset),Z.call(this,"fill",!0),this.path=en}var Kt=JSON.parse(JSON.stringify(Je));Kt=P([Kt],this.posX+this.margin[3],-ut+wt+this.ctx.prevPageLastElemOffset)[0];var tt=(st>zt||st<At)&&k.call(this);tt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Tt,yt,null).clip().discardPath()),this.pdf.addImage(w,"JPEG",Kt.x,Kt.y,Kt.w,Kt.h,null,null,at),tt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(w,"JPEG",Je.x,Je.y,Je.w,Je.h,null,null,at)};var C=function(w,S,V){var ee=[];S=S||this.pdf.internal.pageSize.width,V=V||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var re=this.posY+this.ctx.prevPageLastElemOffset;switch(w.type){default:case"mt":case"lt":ee.push(Math.floor((w.y+re)/V)+1);break;case"arc":ee.push(Math.floor((w.y+re-w.radius)/V)+1),ee.push(Math.floor((w.y+re+w.radius)/V)+1);break;case"qct":var ce=H(this.ctx.lastPoint.x,this.ctx.lastPoint.y,w.x1,w.y1,w.x,w.y);ee.push(Math.floor((ce.y+re)/V)+1),ee.push(Math.floor((ce.y+ce.h+re)/V)+1);break;case"bct":var he=X(this.ctx.lastPoint.x,this.ctx.lastPoint.y,w.x1,w.y1,w.x2,w.y2,w.x,w.y);ee.push(Math.floor((he.y+re)/V)+1),ee.push(Math.floor((he.y+he.h+re)/V)+1);break;case"rect":ee.push(Math.floor((w.y+re)/V)+1),ee.push(Math.floor((w.y+w.h+re)/V)+1)}for(var me=0;me<ee.length;me+=1)for(;this.pdf.internal.getNumberOfPages()<ee[me];)b.call(this);return ee},b=function(){var w=this.fillStyle,S=this.strokeStyle,V=this.font,ee=this.lineCap,re=this.lineWidth,ce=this.lineJoin;this.pdf.addPage(),this.fillStyle=w,this.strokeStyle=S,this.font=V,this.lineCap=ee,this.lineWidth=re,this.lineJoin=ce},P=function(w,S,V){for(var ee=0;ee<w.length;ee++)switch(w[ee].type){case"bct":w[ee].x2+=S,w[ee].y2+=V;case"qct":w[ee].x1+=S,w[ee].y1+=V;default:w[ee].x+=S,w[ee].y+=V}return w},R=function(w){return w.sort(function(S,V){return S-V})},D=function(w,S){for(var V,ee,re=this.fillStyle,ce=this.strokeStyle,he=this.lineCap,me=this.lineWidth,ye=Math.abs(me*this.ctx.transform.scaleX),Ee=this.lineJoin,Pe=JSON.parse(JSON.stringify(this.path)),Re=JSON.parse(JSON.stringify(this.path)),be=[],ie=0;ie<Re.length;ie++)if(Re[ie].x!==void 0)for(var Ge=C.call(this,Re[ie]),it=0;it<Ge.length;it+=1)be.indexOf(Ge[it])===-1&&be.push(Ge[it]);for(var at=0;at<be.length;at++)for(;this.pdf.internal.getNumberOfPages()<be[at];)b.call(this);if(R(be),this.autoPaging)for(var De=be[0],Je=be[be.length-1],qe=De;qe<Je+1;qe++){this.pdf.setPage(qe),this.fillStyle=re,this.strokeStyle=ce,this.lineCap=he,this.lineWidth=ye,this.lineJoin=Ee;var Ue=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Le=qe===1?this.posY+this.margin[0]:this.margin[0],zt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],At=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],st=qe===1?0:zt+(qe-2)*At;if(this.ctx.clip_path.length!==0){var Tt=this.path;V=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=P(V,this.posX+this.margin[3],-st+Le+this.ctx.prevPageLastElemOffset),Z.call(this,w,!0),this.path=Tt}if(ee=JSON.parse(JSON.stringify(Pe)),this.path=P(ee,this.posX+this.margin[3],-st+Le+this.ctx.prevPageLastElemOffset),S===!1||qe===0){var wt=(qe>De||qe<Je)&&k.call(this);wt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ue,At,null).clip().discardPath()),Z.call(this,w,S),wt&&this.pdf.restoreGraphicsState()}this.lineWidth=me}else this.lineWidth=ye,Z.call(this,w,S),this.lineWidth=me;this.path=Pe},Z=function(w,S){if((w!=="stroke"||S||!T.call(this))&&(w==="stroke"||S||!p.call(this))){for(var V,ee,re=[],ce=this.path,he=0;he<ce.length;he++){var me=ce[he];switch(me.type){case"begin":re.push({begin:!0});break;case"close":re.push({close:!0});break;case"mt":re.push({start:me,deltas:[],abs:[]});break;case"lt":var ye=re.length;if(ce[he-1]&&!isNaN(ce[he-1].x)&&(V=[me.x-ce[he-1].x,me.y-ce[he-1].y],ye>0)){for(;ye>=0;ye--)if(re[ye-1].close!==!0&&re[ye-1].begin!==!0){re[ye-1].deltas.push(V),re[ye-1].abs.push(me);break}}break;case"bct":V=[me.x1-ce[he-1].x,me.y1-ce[he-1].y,me.x2-ce[he-1].x,me.y2-ce[he-1].y,me.x-ce[he-1].x,me.y-ce[he-1].y],re[re.length-1].deltas.push(V);break;case"qct":var Ee=ce[he-1].x+2/3*(me.x1-ce[he-1].x),Pe=ce[he-1].y+2/3*(me.y1-ce[he-1].y),Re=me.x+2/3*(me.x1-me.x),be=me.y+2/3*(me.y1-me.y),ie=me.x,Ge=me.y;V=[Ee-ce[he-1].x,Pe-ce[he-1].y,Re-ce[he-1].x,be-ce[he-1].y,ie-ce[he-1].x,Ge-ce[he-1].y],re[re.length-1].deltas.push(V);break;case"arc":re.push({deltas:[],abs:[],arc:!0}),Array.isArray(re[re.length-1].abs)&&re[re.length-1].abs.push(me)}}ee=S?null:w==="stroke"?"stroke":"fill";for(var it=!1,at=0;at<re.length;at++)if(re[at].arc)for(var De=re[at].abs,Je=0;Je<De.length;Je++){var qe=De[Je];qe.type==="arc"?j.call(this,qe.x,qe.y,qe.radius,qe.startAngle,qe.endAngle,qe.counterclockwise,void 0,S,!it):E.call(this,qe.x,qe.y),it=!0}else if(re[at].close===!0)this.pdf.internal.out("h"),it=!1;else if(re[at].begin!==!0){var Ue=re[at].start.x,Le=re[at].start.y;M.call(this,re[at].deltas,Ue,Le),it=!0}ee&&_.call(this,ee),S&&F.call(this)}},le=function(w){var S=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,V=S*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return w-V;case"top":return w+S-V;case"hanging":return w+S-2*V;case"middle":return w+S/2-V;default:return w}},U=function(w){return w+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};v.prototype.createLinearGradient=function(){var w=function(){};return w.colorStops=[],w.addColorStop=function(S,V){this.colorStops.push([S,V])},w.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},w.isCanvasGradient=!0,w},v.prototype.createPattern=function(){return this.createLinearGradient()},v.prototype.createRadialGradient=function(){return this.createLinearGradient()};var j=function(w,S,V,ee,re,ce,he,me,ye){for(var Ee=K.call(this,V,ee,re,ce),Pe=0;Pe<Ee.length;Pe++){var Re=Ee[Pe];Pe===0&&(ye?A.call(this,Re.x1+w,Re.y1+S):E.call(this,Re.x1+w,Re.y1+S)),G.call(this,w,S,Re.x2,Re.y2,Re.x3,Re.y3,Re.x4,Re.y4)}me?F.call(this):_.call(this,he)},_=function(w){switch(w){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},F=function(){this.pdf.clip(),this.pdf.discardPath()},A=function(w,S){this.pdf.internal.out(n(w)+" "+r(S)+" m")},L=function(w){var S;switch(w.align){case"right":case"end":S="right";break;case"center":S="center";break;default:S="left"}var V=this.pdf.getTextDimensions(w.text),ee=le.call(this,w.y),re=U.call(this,ee)-V.h,ce=this.ctx.transform.applyToPoint(new o(w.x,ee)),he=this.ctx.transform.decompose(),me=new c;me=(me=(me=me.multiply(he.translate)).multiply(he.skew)).multiply(he.scale);for(var ye,Ee,Pe,Re=this.ctx.transform.applyToRectangle(new l(w.x,ee,V.w,V.h)),be=me.applyToRectangle(new l(w.x,re,V.w,V.h)),ie=C.call(this,be),Ge=[],it=0;it<ie.length;it+=1)Ge.indexOf(ie[it])===-1&&Ge.push(ie[it]);if(R(Ge),this.autoPaging)for(var at=Ge[0],De=Ge[Ge.length-1],Je=at;Je<De+1;Je++){this.pdf.setPage(Je);var qe=Je===1?this.posY+this.margin[0]:this.margin[0],Ue=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Le=this.pdf.internal.pageSize.height-this.margin[2],zt=Le-this.margin[0],At=this.pdf.internal.pageSize.width-this.margin[1],st=At-this.margin[3],Tt=Je===1?0:Ue+(Je-2)*zt;if(this.ctx.clip_path.length!==0){var wt=this.path;ye=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=P(ye,this.posX+this.margin[3],-1*Tt+qe),Z.call(this,"fill",!0),this.path=wt}var ot=P([JSON.parse(JSON.stringify(be))],this.posX+this.margin[3],-Tt+qe+this.ctx.prevPageLastElemOffset)[0];w.scale>=.01&&(Ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ee*w.scale),Pe=this.lineWidth,this.lineWidth=Pe*w.scale);var yt=this.autoPaging!=="text";if(yt||ot.y+ot.h<=Le){if(yt||ot.y>=qe&&ot.x<=At){var ut=yt?w.text:this.pdf.splitTextToSize(w.text,w.maxWidth||At-ot.x)[0],en=P([JSON.parse(JSON.stringify(Re))],this.posX+this.margin[3],-Tt+qe+this.ctx.prevPageLastElemOffset)[0],Kt=yt&&(Je>at||Je<De)&&k.call(this);Kt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],st,zt,null).clip().discardPath()),this.pdf.text(ut,en.x,en.y,{angle:w.angle,align:S,renderingMode:w.renderingMode}),Kt&&this.pdf.restoreGraphicsState()}}else ot.y<Le&&(this.ctx.prevPageLastElemOffset+=Le-ot.y);w.scale>=.01&&(this.pdf.setFontSize(Ee),this.lineWidth=Pe)}else w.scale>=.01&&(Ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ee*w.scale),Pe=this.lineWidth,this.lineWidth=Pe*w.scale),this.pdf.text(w.text,ce.x+this.posX,ce.y+this.posY,{angle:w.angle,align:S,renderingMode:w.renderingMode,maxWidth:w.maxWidth}),w.scale>=.01&&(this.pdf.setFontSize(Ee),this.lineWidth=Pe)},E=function(w,S,V,ee){V=V||0,ee=ee||0,this.pdf.internal.out(n(w+V)+" "+r(S+ee)+" l")},M=function(w,S,V){return this.pdf.lines(w,S,V,null,null)},G=function(w,S,V,ee,re,ce,he,me){this.pdf.internal.out([e(i(V+w)),e(s(ee+S)),e(i(re+w)),e(s(ce+S)),e(i(he+w)),e(s(me+S)),"c"].join(" "))},K=function(w,S,V,ee){for(var re=2*Math.PI,ce=Math.PI/2;S>V;)S-=re;var he=Math.abs(V-S);he<re&&ee&&(he=re-he);for(var me=[],ye=ee?-1:1,Ee=S;he>1e-5;){var Pe=Ee+ye*Math.min(he,ce);me.push(z.call(this,w,Ee,Pe)),he-=Math.abs(Pe-Ee),Ee=Pe}return me},z=function(w,S,V){var ee=(V-S)/2,re=w*Math.cos(ee),ce=w*Math.sin(ee),he=re,me=-ce,ye=he*he+me*me,Ee=ye+he*re+me*ce,Pe=4/3*(Math.sqrt(2*ye*Ee)-Ee)/(he*ce-me*re),Re=he-Pe*me,be=me+Pe*he,ie=Re,Ge=-be,it=ee+S,at=Math.cos(it),De=Math.sin(it);return{x1:w*Math.cos(S),y1:w*Math.sin(S),x2:Re*at-be*De,y2:Re*De+be*at,x3:ie*at-Ge*De,y3:ie*De+Ge*at,x4:w*Math.cos(V),y4:w*Math.sin(V)}},q=function(w){return 180*w/Math.PI},H=function(w,S,V,ee,re,ce){var he=w+.5*(V-w),me=S+.5*(ee-S),ye=re+.5*(V-re),Ee=ce+.5*(ee-ce),Pe=Math.min(w,re,he,ye),Re=Math.max(w,re,he,ye),be=Math.min(S,ce,me,Ee),ie=Math.max(S,ce,me,Ee);return new l(Pe,be,Re-Pe,ie-be)},X=function(w,S,V,ee,re,ce,he,me){var ye,Ee,Pe,Re,be,ie,Ge,it,at,De,Je,qe,Ue,Le,zt=V-w,At=ee-S,st=re-V,Tt=ce-ee,wt=he-re,ot=me-ce;for(Ee=0;Ee<41;Ee++)at=(Ge=(Pe=w+(ye=Ee/40)*zt)+ye*((be=V+ye*st)-Pe))+ye*(be+ye*(re+ye*wt-be)-Ge),De=(it=(Re=S+ye*At)+ye*((ie=ee+ye*Tt)-Re))+ye*(ie+ye*(ce+ye*ot-ie)-it),Ee==0?(Je=at,qe=De,Ue=at,Le=De):(Je=Math.min(Je,at),qe=Math.min(qe,De),Ue=Math.max(Ue,at),Le=Math.max(Le,De));return new l(Math.round(Je),Math.round(qe),Math.round(Ue-Je),Math.round(Le-qe))},ne=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var w,S,V=(w=this.ctx.lineDash,S=this.ctx.lineDashOffset,JSON.stringify({lineDash:w,lineDashOffset:S}));this.prevLineDash!==V&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=V)}}})(ct.API),function(t){var e=function(o){var l,c,u,f,v,g,p,T,k,C;for(c=[],u=0,f=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;f>u;u+=4)(v=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(g=(v=((v=((v=((v=(v-(C=v%85))/85)-(k=v%85))/85)-(T=v%85))/85)-(p=v%85))/85)%85,c.push(g+33,p+33,T+33,k+33,C+33)):c.push(122);return function(b,P){for(var R=P;R>0;R--)b.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},n=function(o){var l,c,u,f,v,g=String,p="length",T=255,k="charCodeAt",C="slice",b="replace";for(o[C](-2),o=o[C](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),u=[],f=0,v=(o+=l="uuuuu"[C](o[p]%5||5))[p];v>f;f+=5)c=52200625*(o[k](f)-33)+614125*(o[k](f+1)-33)+7225*(o[k](f+2)-33)+85*(o[k](f+3)-33)+(o[k](f+4)-33),u.push(T&c>>24,T&c>>16,T&c>>8,T&c);return function(P,R){for(var D=R;D>0;D--)P.pop()}(u,l[p]),g.fromCharCode.apply(g,u)},r=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=Gv(l)).reduce(function(u,f){return u+String.fromCharCode(f)},"")};t.processDataByFilters=function(o,l){var c=0,u=o||"",f=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=n(u),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=i(u),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=r(u),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:f.reverse().join(" ")}}}(ct.API),function(t){t.loadFile=function(e,n,r){return function(i,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,f){var v=new XMLHttpRequest,g=0,p=function(T){var k=T.length,C=[],b=String.fromCharCode;for(g=0;g<k;g+=1)C.push(b(255&T.charCodeAt(g)));return C.join("")};if(v.open("GET",c,!u),v.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(v.onload=function(){v.status===200?f(p(this.responseText)):f(void 0)}),v.send(null),u&&v.status===200)return p(v.responseText)}(i,s,o)}catch{}return l}(e,n,r)},t.loadImageFile=t.loadFile}(ct.API),function(t){function e(){return(Et.html2canvas?Promise.resolve(Et.html2canvas):i0(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function n(){return(Et.DOMPurify?Promise.resolve(Et.DOMPurify):i0(()=>import("./purify.es-B6FQ9oRL.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var r=function(l){var c=hn(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},i=function(l,c){var u=document.createElement(l);for(var f in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[f]=c.style[f];return u},s=function l(c,u){for(var f=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),v=c.firstChild;v;v=v.nextSibling)u!==!0&&v.nodeType===1&&v.nodeName==="SCRIPT"||f.appendChild(l(v,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(f.value=c.value),f.addEventListener("load",function(){f.scrollTop=c.scrollTop,f.scrollLeft=c.scrollLeft},!0)),f},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),f=l.convert(Promise.resolve(),u);return(f=f.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(r(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(n).then(function(u){return this.set({src:i("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=this.opt.jsPDF,f=this.opt.fontFaces,v=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,g=Object.assign({async:!0,allowTaint:!0,scale:v,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete g.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=f,f)for(var p=0;p<f.length;++p){var T=f[p],k=T.src.find(function(C){return C.format==="truetype"});k&&u.addFont(k.url,T.ref.name,T.ref.style)}return g.windowHeight=g.windowHeight||0,g.windowHeight=g.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):g.windowHeight,u.context2d.save(!0),c(this.prop.container,g)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(r(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(r(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,f){return Math.floor(u*f/72*96)}return this.then(function(){(l=l||ct.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,f){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,f){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,f?this.progress.stack.concat(f):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(f,v){return u.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(g){return u.updateProgress(null,f),g}).then(f,v).then(function(g){return u.updateProgress(1),g})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var f=this;l&&(l=l.bind(f)),c&&(c=c.bind(f));var v=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:o.convert(Object.assign({},f),Promise.prototype),g=u.call(v,l,c);return o.convert(g,f.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,ct.getPageSize=function(l,c,u){if(hn(l)==="object"){var f=l;l=f.orientation,c=f.unit||c,u=f.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var v,g=(""+u).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":v=1;break;case"mm":v=72/25.4;break;case"cm":v=72/2.54;break;case"in":v=72;break;case"px":v=.75;break;case"pc":case"em":v=12;break;case"ex":v=6;break;default:throw"Invalid unit: "+c}var T,k=0,C=0;if(p.hasOwnProperty(g))k=p[g][1]/v,C=p[g][0]/v;else try{k=u[1],C=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",C>k&&(T=C,C=k,k=T);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",k>C&&(T=C,C=k,k=T)}return{width:C,height:k,unit:c,k:v,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(N0):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(ct.API),ct.API.addJS=function(t){return x5=t,this.internal.events.subscribe("postPutResources",function(){Ff=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Ff+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),y5=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+x5+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Ff!==void 0&&y5!==void 0&&this.internal.out("/Names <</JavaScript "+Ff+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=n.outline.render().split(/\r\n/),s=0;s<i.length;s++){var o=i[s],l=r.exec(o);if(l!=null){var c=l[1];n.internal.newObjectDeferredBegin(c,!1)}n.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,f=[];for(s=0;s<u;s++){var v=n.internal.newObject();f.push(v);var g=n.internal.getPageInfo(s+1);n.internal.write("<< /D["+g.objId+" 0 R /XYZ null null null]>> endobj")}var p=n.internal.newObject();for(n.internal.write("<< /Names [ "),s=0;s<f.length;s++)n.internal.write("(page_"+(s+1)+")"+f[s]+" 0 R");n.internal.write(" ] >>","endobj"),e=n.internal.newObject(),n.internal.write("<< /Dests "+p+" 0 R"),n.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,i,s){var o={title:i,options:s,children:[]};return r==null&&(r=this.root),r.children.push(o),o},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<r.children.length;s++){var o=r.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(r)),s>0&&this.line("/Prev "+this.makeRef(r.children[s-1])),s<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=n.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<r.children.length;u++)this.renderItems(r.children[u])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,i){for(var s=0;s<i.children.length;s++)r.count++,this.count_r(r,i.children[s]);return r.count}}])}(ct.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(n,r,i,s,o,l){var c,u=this.decode.DCT_DECODE,f=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=o||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,c=function(v){for(var g,p=256*v.charCodeAt(4)+v.charCodeAt(5),T=v.length,k={width:0,height:0,numcomponents:1},C=4;C<T;C+=2){if(C+=p,e.indexOf(v.charCodeAt(C+1))!==-1){g=256*v.charCodeAt(C+5)+v.charCodeAt(C+6),k={width:256*v.charCodeAt(C+7)+v.charCodeAt(C+8),height:g,numcomponents:v.charCodeAt(C+9)};break}p=256*v.charCodeAt(C+2)+v.charCodeAt(C+3)}return k}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}f={data:n,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:r,alias:i}}return f}}(ct.API),ct.API.processPNG=function(t,e,n,r){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var i,s=MD(t,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,u=s.palette,f=s.depth;i=u&&c===1?function(j){for(var _=j.width,F=j.height,A=j.data,L=j.palette,E=j.depth,M=!1,G=[],K=[],z=void 0,q=!1,H=0,X=0;X<L.length;X++){var ne=_w(L[X],4),w=ne[0],S=ne[1],V=ne[2],ee=ne[3];G.push(w,S,V),ee!=null&&(ee===0?(H++,K.length<1&&K.push(X)):ee<255&&(q=!0))}if(q||H>1){M=!0,K=void 0;var re=_*F;z=new Uint8Array(re);for(var ce=new DataView(A.buffer),he=0;he<re;he++){var me=E0(ce,he,E),ye=_w(L[me],4)[3];z[he]=ye}}else H===0&&(K=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:M?8:void 0,colorBytes:A,alphaBytes:z,needSMask:M,palette:G,mask:K}}(s):c===2||c===4?function(j){for(var _=j.data,F=j.width,A=j.height,L=j.channels,E=j.depth,M=L===2?"DeviceGray":"DeviceRGB",G=L-1,K=F*A,z=G,q=K*z,H=1*K,X=Math.ceil(q*E/8),ne=Math.ceil(H*E/8),w=new Uint8Array(X),S=new Uint8Array(ne),V=new DataView(_.buffer),ee=new DataView(w.buffer),re=new DataView(S.buffer),ce=!1,he=0;he<K;he++){for(var me=he*L,ye=0;ye<z;ye++)T5(ee,E0(V,me+ye,E),he*z+ye,E);var Ee=E0(V,me+z,E);Ee<(1<<E)-1&&(ce=!0),T5(re,Ee,1*he,E)}return{colorSpace:M,colorsPerPixel:G,sMaskBitsPerComponent:ce?E:void 0,colorBytes:w,alphaBytes:S,needSMask:ce}}(s):function(j){var _=j.data,F=j.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:F,colorsPerPixel:F==="DeviceGray"?1:3,colorBytes:_ instanceof Uint16Array?function(A){for(var L=A.length,E=new Uint8Array(2*L),M=new DataView(E.buffer,E.byteOffset,E.byteLength),G=0;G<L;G++)M.setUint16(2*G,A[G],!1);return E}(_):_,needSMask:!1}}(s);var v,g,p,T=i,k=T.colorSpace,C=T.colorsPerPixel,b=T.sMaskBitsPerComponent,P=T.colorBytes,R=T.alphaBytes,D=T.needSMask,Z=T.palette,le=T.mask,U=null;return r!==ct.API.image_compression.NONE&&typeof Gv=="function"?(U=function(j){var _;switch(j){case ct.API.image_compression.FAST:_=11;break;case ct.API.image_compression.MEDIUM:_=13;break;case ct.API.image_compression.SLOW:_=14;break;default:_=12}return _}(r),v=this.decode.FLATE_DECODE,g="/Predictor ".concat(U," /Colors ").concat(C," /BitsPerComponent ").concat(f," /Columns ").concat(o),t=_5(P,Math.ceil(o*C*f/8),C,f,r),D&&(p=_5(R,Math.ceil(o*b/8),1,b,r))):(v=void 0,g=void 0,t=P,D&&(p=R)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(p&&this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),{alias:n,data:t,index:e,filter:v,decodeParameters:g,transparency:le,palette:Z,sMask:p,predictor:U,width:o,height:l,bitsPerComponent:f,sMaskBitsPerComponent:b,colorSpace:k}}},function(t){t.processGIF89A=function(e,n,r,i){var s=new iO(e),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},f=new A0(100).encode(u,100);return t.processJPEG.call(this,f,n,r,i)},t.processGIF87A=t.processGIF89A}(ct.API),Rs.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:r,blue:n,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Rs.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(n){xn.log("bit decode error:"+n)}},Rs.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}n!==0&&(this.pos+=4-n)}},Rs.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<t;i++){var s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+2*i*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*i+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Rs.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+4*r;if(i<this.palette.length){var o=this.palette[i];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},Rs.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,l=(s>>5&e)/e*255|0,c=(s>>10&e)/e*255|0,u=s>>15?255:0,f=r*this.width*4+4*i;this.data[f]=c,this.data[f+1]=l,this.data[f+2]=o,this.data[f+3]=u}this.pos+=t}},Rs.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&n)/n*255|0,u=(o>>11)/e*255|0,f=i*this.width*4+4*s;this.data[f]=u,this.data[f+1]=c,this.data[f+2]=l,this.data[f+3]=255}this.pos+=t}},Rs.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*n;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=r,this.data[o+3]=255}this.pos+=this.width%4}},Rs.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*n;this.data[l]=s,this.data[l+1]=i,this.data[l+2]=r,this.data[l+3]=o}},Rs.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,n,r,i){var s=new Rs(e,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new A0(100).encode(c,100);return t.processJPEG.call(this,u,n,r,i)}}(ct.API),C5.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,n,r,i){var s=new C5(e),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new A0(100).encode(c,100);return t.processJPEG.call(this,u,n,r,i)}}(ct.API),ct.API.processRGBA=function(t,e,n){for(var r=t.data,i=r.length,s=new Uint8Array(i/4*3),o=new Uint8Array(i/4),l=0,c=0,u=0;u<i;u+=4){var f=r[u],v=r[u+1],g=r[u+2],p=r[u+3];s[l++]=f,s[l++]=v,s[l++]=g,o[c++]=p}var T=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:T,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},ct.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Lc=ct.API,Uf=Lc.getCharWidthsArray=function(t,e){var n,r,i=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:i.metadata.Unicode.kerning,f=u.fof?u.fof:1,v=e.doKerning!==!1,g=0,p=t.length,T=0,k=l[0]||c,C=[];for(n=0;n<p;n++)r=t.charCodeAt(n),typeof i.metadata.widthOfString=="function"?C.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+o*(1e3/s)||0)/1e3):(g=v&&hn(u[r])==="object"&&!isNaN(parseInt(u[r][T],10))?u[r][T]/f:0,C.push((l[r]||k)/c+g)),T=r;return C},b5=Lc.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return Lc.processArabic&&(t=Lc.processArabic(t)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(t,n,i)/n:Uf.apply(this,arguments).reduce(function(s,o){return s+o},0)},w5=function(t,e,n,r){for(var i=[],s=0,o=t.length,l=0;s!==o&&l+e[s]<n;)l+=e[s],s++;i.push(t.slice(0,s));var c=s;for(l=0;s!==o;)l+e[s]>r&&(i.push(t.slice(c,s)),l=0,c=s),l+=e[s],s++;return c!==s&&i.push(t.slice(c,s)),i},N5=function(t,e,n){n||(n={});var r,i,s,o,l,c,u,f=[],v=[f],g=n.textIndent||0,p=0,T=0,k=t.split(" "),C=Uf.apply(this,[" ",n])[0];if(c=n.lineIndent===-1?k[0].length+2:n.lineIndent||0){var b=Array(c).join(" "),P=[];k.map(function(D){(D=D.split(/\s*\n/)).length>1?P=P.concat(D.map(function(Z,le){return(le&&Z.length?`
`:"")+Z})):P.push(D[0])}),k=P,c=b5.apply(this,[b,n])}for(s=0,o=k.length;s<o;s++){var R=0;if(r=k[s],c&&r[0]==`
`&&(r=r.substr(1),R=1),g+p+(T=(i=Uf.apply(this,[r,n])).reduce(function(D,Z){return D+Z},0))>e||R){if(T>e){for(l=w5.apply(this,[r,i,e-(g+p),e]),f.push(l.shift()),f=[l.pop()];l.length;)v.push([l.shift()]);T=i.slice(r.length-(f[0]?f[0].length:0)).reduce(function(D,Z){return D+Z},0)}else f=[r];v.push(f),g=T+c,p=C}else f.push(r),g+=p+T,p=C}return u=c?function(D,Z){return(Z?b:"")+D.join(" ")}:function(D){return D.join(" ")},v.map(u)},Lc.splitTextToSize=function(t,e,n){var r,i=(n=n||{}).fontSize||this.internal.getFontSize(),s=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var v=this.internal.getFont(f.fontName,f.fontStyle),g="Unicode";return v.metadata[g]?{widths:v.metadata[g].widths||{0:1},kerning:v.metadata[g].kerning||{}}:{font:v.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/i;s.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=n.lineIndent;var l,c,u=[];for(l=0,c=r.length;l<c;l++)u=u.concat(N5.apply(this,[r[l],o,s]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",n="klmnopqrstuvwxyz",r={},i={},s=0;s<16;s++)r[n[s]]=e[s],i[e[s]]=n[s];var o=function(g){return"0x"+parseInt(g,10).toString(16)},l=t.__fontmetrics__.compress=function(g){var p,T,k,C,b=["{"];for(var P in g){if(p=g[P],isNaN(parseInt(P,10))?T="'"+P+"'":(P=parseInt(P,10),T=(T=o(P).slice(2)).slice(0,-1)+i[T.slice(-1)]),typeof p=="number")p<0?(k=o(p).slice(3),C="-"):(k=o(p).slice(2),C=""),k=C+k.slice(0,-1)+i[k.slice(-1)];else{if(hn(p)!=="object")throw new Error("Don't know what to do with value type "+hn(p)+".");k=l(p)}b.push(T+k)}return b.push("}"),b.join("")},c=t.__fontmetrics__.uncompress=function(g){if(typeof g!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,T,k,C,b={},P=1,R=b,D=[],Z="",le="",U=g.length-1,j=1;j<U;j+=1)(C=g[j])=="'"?p?(k=p.join(""),p=void 0):p=[]:p?p.push(C):C=="{"?(D.push([R,k]),R={},k=void 0):C=="}"?((T=D.pop())[0][T[1]]=R,k=void 0,R=T[0]):C=="-"?P=-1:k===void 0?r.hasOwnProperty(C)?(Z+=r[C],k=parseInt(Z,16)*P,P=1,Z=""):Z+=C:r.hasOwnProperty(C)?(le+=r[C],R[k]=parseInt(le,16)*P,P=1,k=void 0,le=""):le+=C;return b},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},v={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(g){var p=g.font,T=v.Unicode[p.postScriptName];T&&(p.metadata.Unicode={},p.metadata.Unicode.widths=T.widths,p.metadata.Unicode.kerning=T.kerning);var k=f.Unicode[p.postScriptName];k&&(p.metadata.Unicode.encoding=k,p.encoding=k.codePages[0])}])}(ct.API),function(t){var e=function(n){for(var r=n.length,i=new Uint8Array(r),s=0;s<r;s++)i[s]=n.charCodeAt(s);return i};t.API.events.push(["addFont",function(n){var r=void 0,i=n.font,s=n.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(cm(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,r)}}])}(ct),ct.API.addSvgAsImage=function(t,e,n,r,i,s,o,l){if(isNaN(e)||isNaN(n))throw xn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(i))throw xn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=r,c.height=i;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},v=this;return(Et.canvg?Promise.resolve(Et.canvg):i0(()=>import("./index.es-CXWuepy3.js"),[])).catch(function(g){return Promise.reject(new Error("Could not load canvg: "+g))}).then(function(g){return g.default?g.default:g}).then(function(g){return g.fromString(u,t,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(f)}).then(function(){v.addImage(c.toDataURL("image/jpeg",1),e,n,r,i,o,l)})},ct.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(e,n);return this},ct.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var r,i,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,f=0,v=0;function g(T,k){var C,b=!1;for(C=0;C<T.length;C+=1)T[C]===k&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var p=l.length;for(v=0;v<p;v+=1)n[l[v]].value=n[l[v]].defaultValue,n[l[v]].explicitSet=!1}if(hn(t)==="object"){for(i in t)if(s=t[i],g(l,i)&&s!==void 0){if(n[i].type==="boolean"&&typeof s=="boolean")n[i].value=s;else if(n[i].type==="name"&&g(n[i].valueSet,s))n[i].value=s;else if(n[i].type==="integer"&&Number.isInteger(s))n[i].value=s;else if(n[i].type==="array"){for(u=0;u<s.length;u+=1)if(r=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(f=0;f<s[u].length;f+=1)typeof s[u][f]!="number"&&(r=!1);r===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}n[i].value="["+c.join(" ")+"]"}else n[i].value=n[i].defaultValue;n[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var T,k=[];for(T in n)n[T].explicitSet===!0&&(n[T].type==="name"?k.push("/"+T+" /"+n[T].value):k.push("/"+T+" "+n[T].value));k.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+k.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(t){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(r)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+o.length+l.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(i+s+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(r,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",e)),this}}(ct.API),function(t){var e=t.API,n=e.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],f=[""],v=0,g=s.length;v<g;++v){if(l=o.metadata.characterToGlyph(s.charCodeAt(v)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(v),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return f.join("");l=l.toString(16),f.push(u[4-l.length],l)}return f.join("")},r=function(s){var o,l,c,u,f,v,g;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],v=0,g=(l=Object.keys(s).sort(function(p,T){return p-T})).length;v<g;v++)o=l[v],c.length>=100&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,f=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var v=l.metadata.Unicode.widths,g=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),p="",T=0;T<g.length;T++)p+=String.fromCharCode(g[T]);var k=u();f({data:p,addLength1:!0,objectId:k}),c("endobj");var C=u();f({data:r(l.metadata.toUnicode),addLength1:!0,objectId:C}),c("endobj");var b=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Uc(l.fontName)),c("/FontFile2 "+k+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var P=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Uc(l.fontName)),c("/FontDescriptor "+b+" 0 R"),c("/W "+t.API.PDFObject.convert(v)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+C+" 0 R"),c("/BaseFont /"+Uc(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+P+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,f=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var v=l.metadata.rawData,g="",p=0;p<v.length;p++)g+=String.fromCharCode(v[p]);var T=u();f({data:g,addLength1:!0,objectId:T}),c("endobj");var k=u();f({data:r(l.metadata.toUnicode),addLength1:!0,objectId:k}),c("endobj");var C=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+T+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Uc(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var b=0;b<l.metadata.hmtx.widths.length;b++)l.metadata.hmtx.widths[b]=parseInt(l.metadata.hmtx.widths[b]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+k+" 0 R/BaseFont/"+Uc(l.fontName)+"/FontDescriptor "+C+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var i=function(s){var o,l=s.text||"",c=s.x,u=s.y,f=s.options||{},v=s.mutex||{},g=v.pdfEscape,p=v.activeFontKey,T=v.fonts,k=p,C="",b=0,P="",R=T[k].encoding;if(T[k].encoding!=="Identity-H")return{text:l,x:c,y:u,options:f,mutex:v};for(P=l,k=p,Array.isArray(l)&&(P=l[0]),b=0;b<P.length;b+=1)T[k].metadata.hasOwnProperty("cmap")&&(o=T[k].metadata.cmap.unicode.codeMap[P[b].charCodeAt(0)]),o||P[b].charCodeAt(0)<256&&T[k].metadata.hasOwnProperty("Unicode")?C+=P[b]:C+="";var D="";return parseInt(k.slice(1))<14||R==="WinAnsiEncoding"?D=g(C,k).split("").map(function(Z){return Z.charCodeAt(0).toString(16)}).join(""):R==="Identity-H"&&(D=n(C,T[k])),v.isHex=!0,{text:D,x:c,y:u,options:f,mutex:v}};e.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([i(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(i(Object.assign({},c,{text:o[u]})).text);s.text=l}else s.text=i(Object.assign({},c,{text:o})).text}])}(ct),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0},t.addFileToVFS=function(n,r){return e.call(this),this.internal.vFS[n]=r,this},t.getFileFromVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(ct.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(r){var i,s,o,l,c,u,f,v=e,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],T={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},k={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},C=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),P=!1,R=0;this.__bidiEngine__={};var D=function(A){var L=A.charCodeAt(),E=L>>8,M=k[E];return M!==void 0?v[256*M+(255&L)]:E===252||E===253?"AL":b.test(E)?"L":E===8?"R":"N"},Z=function(A){for(var L,E=0;E<A.length;E++){if((L=D(A.charAt(E)))==="L")return!1;if(L==="R")return!0}return!1},le=function(A,L,E,M){var G,K,z,q,H=L[M];switch(H){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":P=!1;break;case"N":case"AN":break;case"EN":P&&(H="AN");break;case"AL":P=!0,H="R";break;case"WS":case"BN":H="N";break;case"CS":M<1||M+1>=L.length||(G=E[M-1])!=="EN"&&G!=="AN"||(K=L[M+1])!=="EN"&&K!=="AN"?H="N":P&&(K="AN"),H=K===G?K:"N";break;case"ES":H=(G=M>0?E[M-1]:"B")==="EN"&&M+1<L.length&&L[M+1]==="EN"?"EN":"N";break;case"ET":if(M>0&&E[M-1]==="EN"){H="EN";break}if(P){H="N";break}for(z=M+1,q=L.length;z<q&&L[z]==="ET";)z++;H=z<q&&L[z]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(q=L.length,z=M+1;z<q&&L[z]==="NSM";)z++;if(z<q){var X=A[M],ne=X>=1425&&X<=2303||X===64286;if(G=L[z],ne&&(G==="R"||G==="AL")){H="R";break}}}H=M<1||(G=L[M-1])==="B"?"N":E[M-1];break;case"B":P=!1,i=!0,H=R;break;case"S":s=!0,H="N"}return H},U=function(A,L,E){var M=A.split("");return E&&j(M,E,{hiLevel:R}),M.reverse(),L&&L.reverse(),M.join("")},j=function(A,L,E){var M,G,K,z,q,H=-1,X=A.length,ne=0,w=[],S=R?p:g,V=[];for(P=!1,i=!1,s=!1,G=0;G<X;G++)V[G]=D(A[G]);for(K=0;K<X;K++){if(q=ne,w[K]=le(A,V,w,K),M=240&(ne=S[q][T[w[K]]]),ne&=15,L[K]=z=S[ne][5],M>0)if(M===16){for(G=H;G<K;G++)L[G]=1;H=-1}else H=-1;if(S[ne][6])H===-1&&(H=K);else if(H>-1){for(G=H;G<K;G++)L[G]=z;H=-1}V[K]==="B"&&(L[K]=0),E.hiLevel|=z}s&&function(ee,re,ce){for(var he=0;he<ce;he++)if(ee[he]==="S"){re[he]=R;for(var me=he-1;me>=0&&ee[me]==="WS";me--)re[me]=R}}(V,L,X)},_=function(A,L,E,M,G){if(!(G.hiLevel<A)){if(A===1&&R===1&&!i)return L.reverse(),void(E&&E.reverse());for(var K,z,q,H,X=L.length,ne=0;ne<X;){if(M[ne]>=A){for(q=ne+1;q<X&&M[q]>=A;)q++;for(H=ne,z=q-1;H<z;H++,z--)K=L[H],L[H]=L[z],L[z]=K,E&&(K=E[H],E[H]=E[z],E[z]=K);ne=q}ne++}}},F=function(A,L,E){var M=A.split(""),G={hiLevel:R};return E||(E=[]),j(M,E,G),function(K,z,q){if(q.hiLevel!==0&&f)for(var H,X=0;X<K.length;X++)z[X]===1&&(H=C.indexOf(K[X]))>=0&&(K[X]=C[H+1])}(M,E,G),_(2,M,L,E,G),_(1,M,L,E,G),M.join("")};return this.__bidiEngine__.doBidiReorder=function(A,L,E){if(function(G,K){if(K)for(var z=0;z<G.length;z++)K[z]=z;l===void 0&&(l=Z(G)),u===void 0&&(u=Z(G))}(A,L),o||!c||u)if(o&&c&&l^u)R=l?1:0,A=U(A,L,E);else if(!o&&c&&u)R=l?1:0,A=F(A,L,E),A=U(A,L);else if(!o||l||c||u){if(o&&!c&&l^u)A=U(A,L),l?(R=0,A=F(A,L,E)):(R=1,A=F(A,L,E),A=U(A,L));else if(o&&l&&!c&&u)R=1,A=F(A,L,E),A=U(A,L);else if(!o&&!c&&l^u){var M=f;l?(R=1,A=F(A,L,E),R=0,f=!1,A=F(A,L,E),f=M):(R=0,A=F(A,L,E),A=U(A,L),R=1,f=!1,A=F(A,L,E),f=M,A=U(A,L))}}else R=0,A=F(A,L,E);else R=l?1:0,A=F(A,L,E);return A},this.__bidiEngine__.setOptions=function(A){A&&(o=A.isInputVisual,c=A.isOutputVisual,l=A.isInputRtl,u=A.isOutputRtl,f=A.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(r){var i=r.text;r.x,r.y;var s=r.options||{};r.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,n.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(o=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?o.push([n.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):o.push([n.doBidiReorder(i[l])]);r.text=o}else r.text=n.doBidiReorder(i);n.setOptions({isInputVisual:!0})}])}(ct),ct.API.TTFFont=function(){function t(e){var n;if(this.rawData=e,n=this.contents=new xl(e),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new xO(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new sO(this.contents),this.head=new oO(this),this.name=new hO(this),this.cmap=new nS(this),this.toUnicode={},this.hhea=new lO(this),this.maxp=new fO(this),this.hmtx=new mO(this),this.post=new uO(this),this.os2=new cO(this),this.loca=new yO(this),this.glyf=new pO(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,n,r,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),32768&(n=i>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var n;return((n=this.cmap.unicode)!=null?n.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*n},t.prototype.widthOfString=function(e,n,r){var i,s,o,l;for(o=0,s=0,l=(e=""+e).length;0<=l?s<l:s>l;s=0<=l?++s:--s)i=e.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/n)||0;return o*(n/1e3)},t.prototype.lineHeight=function(e,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},t}();var Hs,xl=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var n,r;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},t.prototype.writeString=function(e){var n,r,i;for(i=[],n=0,r=e.length;0<=r?n<r:n>r;n=0<=r?++n:--n)i.push(this.writeByte(e.charCodeAt(n)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,n,r,i,s,o,l,c;return e=this.readByte(),n=this.readByte(),r=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*n+1099511627776*r+4294967296*i+16777216*s+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var n,r;return n=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var n,r;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n.push(this.readByte());return n},t.prototype.write=function(e){var n,r,i,s;for(s=[],r=0,i=e.length;r<i;r++)n=e[r],s.push(this.writeByte(n));return s},t}(),sO=function(){var t;function e(n){var r,i,s;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(n){var r,i,s,o,l,c,u,f,v,g,p,T,k;for(k in p=Object.keys(n).length,c=Math.log(2),v=16*Math.floor(Math.log(p)/c),o=Math.floor(v/c),f=16*p-v,(i=new xl).writeInt(this.scalarType),i.writeShort(p),i.writeShort(v),i.writeShort(o),i.writeShort(f),s=16*p,u=i.pos+s,l=null,T=[],n)for(g=n[k],i.writeString(k),i.writeInt(t(g)),i.writeInt(u),i.writeInt(g.length),T=T.concat(g),k==="head"&&(l=u),u+=g.length;u%4;)T.push(0),u++;return i.write(T),r=2981146554-t(i.data),i.pos=l+8,i.writeUInt32(r),i.data},t=function(n){var r,i,s,o;for(n=rS.call(n);n.length%4;)n.push(0);for(s=new xl(n),i=0,r=0,o=n.length;r<o;r=r+=4)i+=s.readUInt32();return 4294967295&i},e}(),aO={}.hasOwnProperty,Ta=function(t,e){for(var n in e)aO.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Hs=function(){function t(e){var n;this.file=e,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var oO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new xl).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t}(),I5=function(){function t(e,n){var r,i,s,o,l,c,u,f,v,g,p,T,k,C,b,P,R;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=n+e.readInt(),v=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(p=e.readUInt16(),g=p/2,e.pos+=6,s=function(){var D,Z;for(Z=[],c=D=0;0<=g?D<g:D>g;c=0<=g?++D:--D)Z.push(e.readUInt16());return Z}(),e.pos+=2,k=function(){var D,Z;for(Z=[],c=D=0;0<=g?D<g:D>g;c=0<=g?++D:--D)Z.push(e.readUInt16());return Z}(),u=function(){var D,Z;for(Z=[],c=D=0;0<=g?D<g:D>g;c=0<=g?++D:--D)Z.push(e.readUInt16());return Z}(),f=function(){var D,Z;for(Z=[],c=D=0;0<=g?D<g:D>g;c=0<=g?++D:--D)Z.push(e.readUInt16());return Z}(),i=(this.length-e.pos+this.offset)/2,l=function(){var D,Z;for(Z=[],c=D=0;0<=i?D<i:D>i;c=0<=i?++D:--D)Z.push(e.readUInt16());return Z}(),c=b=0,R=s.length;b<R;c=++b)for(C=s[c],r=P=T=k[c];T<=C?P<=C:P>=C;r=T<=C?++P:--P)f[c]===0?o=r+u[c]:(o=l[f[c]/2+(r-T)-(g-c)]||0)!==0&&(o+=u[c]),this.codeMap[r]=65535&o}e.pos=v}return t.encode=function(e,n){var r,i,s,o,l,c,u,f,v,g,p,T,k,C,b,P,R,D,Z,le,U,j,_,F,A,L,E,M,G,K,z,q,H,X,ne,w,S,V,ee,re,ce,he,me,ye,Ee,Pe;switch(M=new xl,o=Object.keys(e).sort(function(Re,be){return Re-be}),n){case"macroman":for(k=0,C=function(){var Re=[];for(T=0;T<256;++T)Re.push(0);return Re}(),P={0:0},s={},G=0,H=o.length;G<H;G++)P[me=e[i=o[G]]]==null&&(P[me]=++k),s[i]={old:e[i],new:P[e[i]]},C[i]=P[e[i]];return M.writeUInt16(1),M.writeUInt16(0),M.writeUInt32(12),M.writeUInt16(0),M.writeUInt16(262),M.writeUInt16(0),M.write(C),{charMap:s,subtable:M.data,maxGlyphID:k+1};case"unicode":for(L=[],v=[],R=0,P={},r={},b=u=null,K=0,X=o.length;K<X;K++)P[Z=e[i=o[K]]]==null&&(P[Z]=++R),r[i]={old:Z,new:P[Z]},l=P[Z]-i,b!=null&&l===u||(b&&v.push(b),L.push(i),u=l),b=i;for(b&&v.push(b),v.push(65535),L.push(65535),F=2*(_=L.length),j=2*Math.pow(Math.log(_)/Math.LN2,2),g=Math.log(j/2)/Math.LN2,U=2*_-j,c=[],le=[],p=[],T=z=0,ne=L.length;z<ne;T=++z){if(A=L[T],f=v[T],A===65535){c.push(0),le.push(0);break}if(A-(E=r[A].new)>=32768)for(c.push(0),le.push(2*(p.length+_-T)),i=q=A;A<=f?q<=f:q>=f;i=A<=f?++q:--q)p.push(r[i].new);else c.push(E-A),le.push(0)}for(M.writeUInt16(3),M.writeUInt16(1),M.writeUInt32(12),M.writeUInt16(4),M.writeUInt16(16+8*_+2*p.length),M.writeUInt16(0),M.writeUInt16(F),M.writeUInt16(j),M.writeUInt16(g),M.writeUInt16(U),ce=0,w=v.length;ce<w;ce++)i=v[ce],M.writeUInt16(i);for(M.writeUInt16(0),he=0,S=L.length;he<S;he++)i=L[he],M.writeUInt16(i);for(ye=0,V=c.length;ye<V;ye++)l=c[ye],M.writeUInt16(l);for(Ee=0,ee=le.length;Ee<ee;Ee++)D=le[Ee],M.writeUInt16(D);for(Pe=0,re=p.length;Pe<re;Pe++)k=p[Pe],M.writeUInt16(k);return{charMap:r,subtable:M.data,maxGlyphID:R+1}}},t}(),nS=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,r,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=i?r<i:r>i;r=0<=i?++r:--r)n=new I5(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var r,i;return n==null&&(n="macroman"),r=I5.encode(e,n),(i=new xl).writeUInt16(0),i.writeUInt16(1),r.table=i.data.concat(r.subtable),r},t}(),lO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),cO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var n,r;for(r=[],n=0;n<10;++n)r.push(e.readByte());return r}(),this.charRange=function(){var n,r;for(r=[],n=0;n<4;++n)r.push(e.readInt());return r}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var n,r;for(r=[],n=0;n<2;n=++n)r.push(e.readInt());return r}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),uO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="post",t.prototype.parse=function(e){var n,r,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(r=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)n=e.readByte(),i.push(this.names.push(e.readString(n)));return i;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t}(),dO=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},hO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="name",t.prototype.parse=function(e){var n,r,i,s,o,l,c,u,f,v,g;for(e.pos=this.offset,e.readShort(),n=e.readShort(),l=e.readShort(),r=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},s=f=0,v=r.length;f<v;s=++f)i=r[s],e.pos=i.offset,u=e.readString(i.length),o=new dO(u,i),c[g=i.nameID]==null&&(c[g]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),fO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),mO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,r,i,s,o,l,c;for(e.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,f;for(f=[],n=u=0;0<=i?u<i:u>i;n=0<=i?++u:--u)f.push(e.readInt16());return f}(),this.widths=(function(){var u,f,v,g;for(g=[],u=0,f=(v=this.metrics).length;u<f;u++)s=v[u],g.push(s.advance);return g}).call(this),r=this.widths[this.widths.length-1],c=[],n=o=0;0<=i?o<i:o>i;n=0<=i?++o:--o)c.push(this.widths.push(r));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),rS=[].slice,pO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,r,i,s,o,l,c,u,f,v;return e in this.cache?this.cache[e]:(s=this.file.loca,n=this.file.contents,r=s.indexOf(e),(i=s.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+r,o=(l=new xl(n.read(i))).readShort(),u=l.readShort(),v=l.readShort(),c=l.readShort(),f=l.readShort(),this.cache[e]=o===-1?new vO(l,u,v,c,f):new gO(l,o,u,v,c,f),this.cache[e]))},t.prototype.encode=function(e,n,r){var i,s,o,l,c;for(o=[],s=[],l=0,c=n.length;l<c;l++)i=e[n[l]],s.push(o.length),i&&(o=o.concat(i.encode(r)));return s.push(o.length),{table:o,offsets:s}},t}(),gO=function(){function t(e,n,r,i,s,o){this.raw=e,this.numberOfContours=n,this.xMin=r,this.yMin=i,this.xMax=s,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),vO=function(){function t(e,n,r,i,s){var o,l;for(this.raw=e,this.xMin=n,this.yMin=r,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,n,r;for(n=new xl(rS.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)n.pos=this.glyphOffsets[e];return n.data},t}(),yO=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ta(t,Hs),t.prototype.tag="loca",t.prototype.parse=function(e){var n,r;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,s;for(s=[],r=0,i=this.length;r<i;r+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],r=0,i=this.length;r<i;r+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var r=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<r.length;++o)if(r[o]=i,s<n.length&&n[s]==o){++s,r[o]=i;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(i+=c)}for(var u=new Array(4*r.length),f=0;f<r.length;++f)u[4*f+3]=255&r[f],u[4*f+2]=(65280&r[f])>>8,u[4*f+1]=(16711680&r[f])>>16,u[4*f]=(4278190080&r[f])>>24;return u},t}(),xO=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,n,r,i,s;for(n in i=this.font.cmap.tables[0].codeMap,e={},s=this.subset)r=s[n],e[n]=i[r];return e},t.prototype.glyphsFor=function(e){var n,r,i,s,o,l,c;for(i={},o=0,l=e.length;o<l;o++)i[s=e[o]]=this.font.glyf.glyphFor(s);for(s in n=[],i)(r=i[s])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(s in c=this.glyphsFor(n))r=c[s],i[s]=r;return i},t.prototype.encode=function(e,n){var r,i,s,o,l,c,u,f,v,g,p,T,k,C,b;for(i in r=nS.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),p={0:0},b=r.charMap)p[(c=b[i]).old]=c.new;for(T in g=r.maxGlyphID,o)T in p||(p[T]=g++);return f=function(P){var R,D;for(R in D={},P)D[P[R]]=R;return D}(p),v=Object.keys(f).sort(function(P,R){return P-R}),k=function(){var P,R,D;for(D=[],P=0,R=v.length;P<R;P++)l=v[P],D.push(f[l]);return D}(),s=this.font.glyf.encode(o,k,p),u=this.font.loca.encode(s.offsets,k),C={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(C["OS/2"]=this.font.os2.raw()),this.font.directory.encode(C)},t}();ct.API.PDFObject=function(){var t;function e(){}return t=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},e.convert=function(n){var r,i,s,o;if(Array.isArray(n))return"["+function(){var l,c,u;for(u=[],l=0,c=n.length;l<c;l++)r=n[l],u.push(e.convert(r));return u}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(i in s=["<<"],n)o=n[i],s.push("/"+i+" "+e.convert(o));return s.push(">>"),s.join(`
`)}return""+n},e}();function bO({userRole:t,companySettings:e}){const{addNotification:n}=pn(),[r,i]=ue.useState([]),[s,o]=ue.useState([]),[l,c]=ue.useState(""),[u,f]=ue.useState("Todos"),[v,g]=ue.useState("Todos"),[p,T]=ue.useState(!0),[k,C]=ue.useState("history"),[b,P]=ue.useState(null),[R,D]=ue.useState(!1),Z=["Todos","Pendiente","Procesando","Completado","Fallido","Cancelado","Reembolsado"],le=["Todos","Bold","PayPal","PayU","Transferencia Bancaria","Manual"];ue.useEffect(()=>{const z=Ut(Be,"artifacts",Fe,"public","data","payments"),q=Gt(z,ne=>{console.log("Admin payments snapshot:",ne.size,"documents");const w=ne.docs.map(S=>{const V=S.data();return console.log("Payment doc:",S.id,V),{id:S.id,...V}});w.sort((S,V)=>{var ce,he;const ee=((ce=S.createdAt)==null?void 0:ce.seconds)||0;return(((he=V.createdAt)==null?void 0:he.seconds)||0)-ee}),console.log("Admin payments loaded:",w.length,w),i(w),T(!1)},ne=>{console.error("Error loading payments:",ne),n("Error al cargar los pagos","error"),T(!1)}),H=An(Ut(Be,"artifacts",Fe,"public","data","users"),ur("role","==","client")),X=Gt(H,ne=>{const w=ne.docs.map(S=>({id:S.id,...S.data()}));o(w)});return()=>{q(),X()}},[n]);const U=r.filter(z=>{var ne,w,S,V;const q=((ne=z.serviceNumber)==null?void 0:ne.toLowerCase().includes(l.toLowerCase()))||((w=z.clientName)==null?void 0:w.toLowerCase().includes(l.toLowerCase()))||((S=z.clientEmail)==null?void 0:S.toLowerCase().includes(l.toLowerCase()))||((V=z.transactionId)==null?void 0:V.toLowerCase().includes(l.toLowerCase())),H=u==="Todos"||z.status===u,X=v==="Todos"||z.gateway===v;return q&&H&&X}),j=async(z,q=null)=>{try{if(q!=null&&q.exchangeRate)return Number(q.exchangeRate);const H=z instanceof Date?z:new Date(z),X=H.toISOString().split("T")[0];try{if(Math.floor((new Date-H)/(1e3*60*60*24))<=7){const S=await fetch("https://api.exchangerate.host/latest?base=USD&symbols=COP");if(S.ok){const V=await S.json();if(V.success&&V.rates&&V.rates.COP)return Number(V.rates.COP)}}else{const S=await fetch(`https://api.exchangerate.host/${X}?base=USD&symbols=COP`);if(S.ok){const V=await S.json();if(V.success&&V.rates&&V.rates.COP)return Number(V.rates.COP)}}}catch(ne){console.warn("Error obteniendo tasa de cambio de API:",ne)}return console.warn("Usando tasa de cambio predeterminada (4000 COP/USD). Para tasas histricas precisas, configure una API key."),4e3}catch(H){return console.error("Error en getExchangeRate:",H),4e3}},_=async z=>{var q;try{if(!z||!z.id){console.error("Payment invlido para generar invoice:",z);return}const X="INV-"+String(z.id||"").slice(-8).toUpperCase(),ne=(q=z.createdAt)!=null&&q.seconds?new Date(z.createdAt.seconds*1e3):new Date,w=ne.toLocaleDateString("es-ES"),S=z.dueDate?new Date(z.dueDate.seconds*1e3).toLocaleDateString("es-ES"):"N/A",V=String(z.clientName||"Cliente"),ee=String(z.clientEmail||"N/A"),re=String(z.serviceNumber||"N/A"),ce=String(z.serviceType||"Servicio"),he=String(z.description||"Descripcin del servicio"),me=Number(z.amount||0),ye=String(z.currency||"USD"),Ee=String(z.gateway||"N/A"),Pe=String(z.transactionId||"N/A"),Re=String(z.paymentMethod||"N/A");let be=me,ie=ye,Ge=null,it=null,at=null;ye&&ye.toUpperCase()==="USD"?(it=await j(ne,z),at=ne.toLocaleDateString("es-ES"),Ge=me,be=me*it,ie="COP"):(ye&&ye.toUpperCase()==="COP"||(console.warn("Pago sin moneda definida, asumiendo USD"),it=await j(ne,z),at=ne.toLocaleDateString("es-ES"),Ge=me,be=me*it),ie="COP");const De=be.toLocaleString("es-CO",{minimumFractionDigits:2,maximumFractionDigits:2}),Je=Ge?Ge.toFixed(2):null,qe=it?it.toLocaleString("es-CO",{minimumFractionDigits:2,maximumFractionDigits:2}):null,Ue=new ct;let Le=20;return Ue.setFontSize(24),Ue.setTextColor(37,99,235),Ue.text((e==null?void 0:e.companyName)||"App Gestor",105,Le,{align:"center"}),Le+=10,Ue.setFontSize(18),Ue.setTextColor(102,102,102),Ue.text("FACTURA",105,Le,{align:"center"}),Le+=20,Ue.setFontSize(12),Ue.setTextColor(0,0,0),Ue.setFont(void 0,"bold"),Ue.text("Cliente:",20,Le),Ue.setFont(void 0,"normal"),Ue.text(V,60,Le),Le+=7,Ue.text(ee,60,Le),Le+=15,Ue.setFont(void 0,"bold"),Ue.text("Detalles de la Factura:",20,Le),Le+=7,Ue.setFont(void 0,"normal"),Ue.text("Nmero: "+X,20,Le),Le+=7,Ue.text("Fecha: "+w,20,Le),Le+=7,Ue.text("Vencimiento: "+S,20,Le),Le+=7,Ue.text("Estado: Completado",20,Le),Le+=15,Ue.setFont(void 0,"bold"),Ue.text("Detalles del Servicio:",20,Le),Le+=10,Ue.setFillColor(248,249,250),Ue.rect(20,Le-5,170,8,"F"),Ue.setFont(void 0,"bold"),Ue.text("Servicio",25,Le),Ue.text("Descripcin",70,Le),Ue.text("Monto",165,Le,{align:"right"}),Le+=10,Ue.setFont(void 0,"normal"),Ue.text(ce,25,Le),Ue.text(he.substring(0,35),70,Le),Ue.text(ie+" "+De,165,Le,{align:"right"}),Le+=10,Ge&&it&&(Ue.setFontSize(8),Ue.setTextColor(102,102,102),Ue.text("Equivale a USD "+Je+" (Tasa: "+qe+" COP/USD del "+at+")",165,Le,{align:"right"}),Le+=10),Le+=5,Ue.setFontSize(16),Ue.setFont(void 0,"bold"),Ue.setTextColor(37,99,235),Ue.text("Total: "+ie+" "+De,165,Le,{align:"right"}),Le+=20,Ue.setFontSize(10),Ue.setTextColor(102,102,102),Ue.setFont(void 0,"normal"),Ue.text("Mtodo de Pago: "+Re,20,Le),Le+=6,Ue.text("Gateway: "+Ee,20,Le),Le+=6,Pe!=="N/A"&&(Ue.text("ID de Transaccin: "+Pe,20,Le),Le+=6),Ue.text("Gracias por su negocio",105,Le,{align:"center"}),Ue.save("invoice-"+X+".pdf"),Ue}catch(H){return console.error("Error generando PDF:",H),n("Error al generar el PDF del invoice","error"),null}},F=async(z,q)=>{try{const H=dt(Be,"artifacts",Fe,"public","data","payments",z),X=await vs(H);if(!X.exists()){n("No se encontr el pago","error");return}const ne={id:z,...X.data()};if(await gr(H,{status:q,updatedAt:ht.now(),...q==="Completado"?{completedAt:ht.now()}:{}}),q==="Completado"){const w=await vs(H),S={id:z,...w.data(),clientName:w.data().clientName||ne.clientName||"Cliente",clientEmail:w.data().clientEmail||ne.clientEmail||"N/A",serviceNumber:w.data().serviceNumber||ne.serviceNumber||"N/A",serviceType:w.data().serviceType||ne.serviceType||"Servicio",description:w.data().description||ne.description||"Descripcin del servicio",amount:w.data().amount||ne.amount||0,currency:w.data().currency||ne.currency||"USD",gateway:w.data().gateway||ne.gateway||"N/A",transactionId:w.data().transactionId||ne.transactionId||"N/A",paymentMethod:w.data().paymentMethod||ne.paymentMethod||"N/A",createdAt:w.data().createdAt||ne.createdAt,dueDate:w.data().dueDate||ne.dueDate};await _(S);try{const ee=S.clientEmail||S.userEmail,re=S.clientName||"Cliente";if(ee&&ee!=="N/A"){const ce="INV-"+z.slice(-8).toUpperCase(),he=S.currency==="COP"?new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(S.amount):new Intl.NumberFormat("es-ES",{style:"currency",currency:"USD"}).format(S.amount),me=`Pago Aprobado - ${S.serviceNumber||"N/A"}`,ye=`
              <div style="font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: 0 auto;">
                <h2 style="color: #059669;"> Pago Aprobado</h2>
                <p>Estimado/a <strong>${re}</strong>,</p>
                <p>Su pago por el servicio <strong>${S.serviceNumber||"N/A"}</strong> ha sido aprobado exitosamente.</p>
                <div style="background-color: #f3f4f6; padding: 15px; border-radius: 8px; margin: 20px 0;">
                  <h3 style="margin-top: 0;">Detalles del Pago:</h3>
                  <ul style="list-style: none; padding: 0;">
                    <li><strong>Servicio:</strong> ${S.serviceType||"N/A"}</li>
                    <li><strong>Monto:</strong> ${he}</li>
                    <li><strong>Mtodo:</strong> ${S.gateway||S.paymentMethod||"N/A"}</li>
                    <li><strong>Factura:</strong> ${ce}</li>
                    <li><strong>Fecha:</strong> ${new Date().toLocaleDateString("es-ES")}</li>
                  </ul>
                </div>
                <p>Su servicio est ahora activo. Puede descargar la factura desde su panel de pagos.</p>
                <p style="margin-top: 30px;">Gracias por su pago.</p>
                <p style="color: #6b7280; font-size: 12px; margin-top: 20px;">
                  Este es un email automtico, por favor no responda.
                </p>
              </div>
            `,Ee=`
Pago Aprobado

Estimado/a ${re},

Su pago por el servicio ${S.serviceNumber||"N/A"} ha sido aprobado exitosamente.

Detalles del Pago:
- Servicio: ${S.serviceType||"N/A"}
- Monto: ${he}
- Mtodo: ${S.gateway||S.paymentMethod||"N/A"}
- Factura: ${ce}
- Fecha: ${new Date().toLocaleDateString("es-ES")}

Su servicio est ahora activo. Puede descargar la factura desde su panel de pagos.

Gracias por su pago.
            `;await ar({to:ee,toName:re,subject:me,html:ye,text:Ee,type:"Aprobacin",recipientType:"Cliente",module:"payments",event:"approval",metadata:{paymentId:z,serviceId:S.serviceId,invoiceNumber:ce}})}}catch(ee){console.error("Error enviando email de aprobacin:",ee)}const V=S.serviceId;if(V)try{const ee=dt(Be,"artifacts",Fe,"public","data","services",V),re=await vs(ee);if(re.exists()){const ce=re.data(),he={updatedAt:ht.now()};S.isRenewal||S.paymentType==="Renovacin"?(S.startDate&&(he.dueDate=S.startDate),S.endDate&&(he.expirationDate=S.endDate),he.status="Activo"):(ce.billingCycle==="One-Time"||S.paymentType==="Pago nico")&&(he.paidDate=ht.now(),he.status="Completado"),Object.keys(he).length>1&&await gr(ee,he)}}catch(ee){console.error("Error actualizando servicio despus de completar pago:",ee)}n("Pago completado, servicio actualizado e invoice generado","success")}else if(q==="Fallido"||q==="Cancelado"){try{const w=ne.clientEmail||ne.userEmail,S=ne.clientName||"Cliente";if(w&&w!=="N/A"){const V=`Actualizacin de Pago - ${ne.serviceNumber||"N/A"}`,ee=`
              <div style="font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: 0 auto;">
                <h2 style="color: #dc2626;"> ${q==="Fallido"?"Pago Fallido":"Pago Cancelado"}</h2>
                <p>Estimado/a <strong>${S}</strong>,</p>
                <p>Lamentamos informarle que su pago por el servicio <strong>${ne.serviceNumber||"N/A"}</strong> ha sido ${q==="Fallido"?"rechazado":"cancelado"}.</p>
                <div style="background-color: #fef2f2; padding: 15px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #dc2626;">
                  <p style="margin: 0;"><strong>Por favor, verifique:</strong></p>
                  <ul style="list-style: none; padding: 0; margin: 10px 0 0 0;">
                    <li> Los datos de su mtodo de pago</li>
                    <li> Que tenga fondos suficientes</li>
                    <li> Que su mtodo de pago est activo</li>
                  </ul>
                </div>
                <p>Si necesita ayuda, por favor contacte a nuestro equipo de soporte.</p>
                <p style="margin-top: 30px;">Gracias por su comprensin.</p>
                <p style="color: #6b7280; font-size: 12px; margin-top: 20px;">
                  Este es un email automtico, por favor no responda.
                </p>
              </div>
            `,re=`
${q==="Fallido"?"Pago Fallido":"Pago Cancelado"}

Estimado/a ${S},

Lamentamos informarle que su pago por el servicio ${ne.serviceNumber||"N/A"} ha sido ${q==="Fallido"?"rechazado":"cancelado"}.

Por favor, verifique:
- Los datos de su mtodo de pago
- Que tenga fondos suficientes
- Que su mtodo de pago est activo

Si necesita ayuda, por favor contacte a nuestro equipo de soporte.

Gracias por su comprensin.
            `;await ar({to:w,toName:S,subject:V,html:ee,text:re,type:"Rechazo",recipientType:"Cliente",module:"payments",event:"rejection",metadata:{paymentId:z,serviceId:ne.serviceId,status:q}})}}catch(w){console.error("Error enviando email de rechazo:",w)}n(`Estado del pago actualizado a ${q}`,"success")}else n(`Estado del pago actualizado a ${q}`,"success")}catch(H){console.error("Error updating payment status:",H),n("Error al actualizar el estado del pago","error")}},A=async z=>{try{await _(z),n("Invoice PDF descargado exitosamente","success")}catch(q){console.error("Error descargando invoice:",q),n("Error al generar el invoice PDF","error")}},L=async z=>{if(window.confirm("Ests seguro de que quieres eliminar este pago? Esta accin no se puede deshacer."))try{await vl(dt(Be,"artifacts",Fe,"public","data","payments",z)),n("Pago eliminado exitosamente","success")}catch(q){console.error("Error deleting payment:",q),n("Error al eliminar el pago","error")}},E=z=>({Pendiente:"bg-yellow-100 text-yellow-800",Procesando:"bg-blue-100 text-blue-800",Completado:"bg-green-100 text-green-800",Fallido:"bg-red-100 text-red-800",Cancelado:"bg-gray-100 text-gray-800",Reembolsado:"bg-purple-100 text-purple-800"})[z]||"bg-gray-100 text-gray-800",M=z=>({Bold:"bg-blue-100 text-blue-800",PayPal:"bg-yellow-100 text-yellow-800",PayU:"bg-green-100 text-green-800","Transferencia Bancaria":"bg-purple-100 text-purple-800",Manual:"bg-gray-100 text-gray-800"})[z]||"bg-gray-100 text-gray-800",G=z=>z?new Date(z.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",K=(z,q)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:q||"USD"}).format(z);return p?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsx("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(Ji,{}),"Gestin de Pagos"]})}),a.jsx("div",{className:"border-b border-gray-200 mb-6",children:a.jsxs("nav",{className:"-mb-px flex space-x-8",children:[a.jsxs("button",{onClick:()=>C("history"),className:`${k==="history"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(Ji,{}),"Historial de Pagos"]}),a.jsxs("button",{onClick:()=>C("renewal"),className:`${k==="renewal"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(ul,{}),"Renovaciones"]}),t==="superadmin"&&a.jsxs("button",{onClick:()=>C("config"),className:`${k==="config"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(Zp,{}),"Configuracin"]})]})}),k==="renewal"?a.jsxs("div",{className:"p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Configuracin de Renovaciones"}),a.jsx(j8,{})]}):k==="config"?a.jsx(hA,{}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:a.jsxs("div",{className:"text-sm text-gray-500",children:[U.length," pago",U.length!==1?"s":""," encontrado",U.length!==1?"s":""]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar por servicio, cliente, email o transaccin...",value:l,onChange:z=>c(z.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Vu,{})})]}),a.jsx("select",{value:u,onChange:z=>f(z.target.value),className:"w-full p-2 border rounded-md",children:Z.map(z=>a.jsx("option",{value:z,children:z},z))}),a.jsx("select",{value:v,onChange:z=>g(z.target.value),className:"w-full p-2 border rounded-md",children:le.map(z=>a.jsx("option",{value:z,children:z},z))}),a.jsxs("button",{className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:[a.jsx(uu,{}),"Filtros"]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Servicio","Cliente","Monto","Estado","Pasarela","Transaccin","Fecha","Acciones"].map(z=>a.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:z},z))})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:U.map(z=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:z.serviceNumber||z.id}),a.jsx("div",{className:"text-sm text-gray-600",children:z.serviceName||z.serviceType||"N/A"}),z.serviceDescription&&a.jsx("div",{className:"text-xs text-gray-500 truncate max-w-xs",children:z.serviceDescription}),z.isRenewal&&a.jsxs("div",{className:"text-xs text-green-600 font-medium",children:["Renovacin: ",z.renewalPeriod||"N/A"]})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-medium text-gray-900",children:z.clientName}),a.jsx("div",{className:"text-sm text-gray-500",children:z.clientEmail})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"font-semibold text-gray-900",children:K(z.amount,z.currency)})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${E(z.status)}`,children:z.status})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${M(z.gateway)}`,children:z.gateway})}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-mono text-sm text-gray-600",children:z.transactionId||"N/A"}),z.proofUrl&&a.jsx("div",{className:"mt-2",children:a.jsx("button",{onClick:()=>{P(z),D(!0)},className:"px-2 py-1 text-xs bg-purple-100 text-purple-700 rounded hover:bg-purple-200",children:"Ver Comprobante"})})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsxs("div",{className:"text-sm text-gray-900 flex items-center gap-2",children:[G(z.createdAt),z.proofUrl&&a.jsx("span",{className:"ml-2 inline-flex px-2 py-0.5 text-xs rounded-full bg-purple-100 text-purple-700",title:"Comprobante adjunto",children:"Comprobante"})]}),z.completedAt&&a.jsxs("div",{className:"text-xs text-gray-500",children:["Completado: ",G(z.completedAt)]}),z.startDate&&z.endDate&&a.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[a.jsxs("div",{children:["Inicio: ",G(z.startDate)]}),a.jsxs("div",{children:["Fin: ",G(z.endDate)]})]})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[z.proofUrl&&a.jsx("button",{onClick:()=>{P(z),D(!0)},className:"p-2 text-purple-600 hover:bg-purple-50 rounded-md",title:"Ver comprobante de pago",children:a.jsx(yl,{})}),t==="superadmin"&&a.jsx(a.Fragment,{children:a.jsxs(Bh,{children:[a.jsx("select",{value:z.status,onChange:q=>F(z.id,q.target.value),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 border-none bg-transparent",children:Z.filter(q=>q!=="Todos").map(q=>a.jsx("option",{value:q,children:q},q))}),a.jsxs("button",{onClick:()=>A(z),className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50 flex items-center",children:[a.jsx(yl,{className:"h-4 w-4 mr-2"}),"Descargar Invoice"]}),a.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:"Ver Detalles"}),a.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-yellow-700 hover:bg-yellow-50",children:"Reembolsar"}),a.jsxs("button",{onClick:()=>L(z.id),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50 flex items-center",children:[a.jsx(oA,{className:"h-4 w-4 mr-2"}),"Eliminar Pago"]})]})})]})})]},z.id))})]})}),U.length===0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(Ji,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron pagos"}),a.jsx("p",{className:"text-gray-500",children:"No hay pagos que coincidan con los filtros seleccionados."})]})]}),R&&(b==null?void 0:b.proofUrl)&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-4 flex justify-between items-center border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Comprobante de Pago"}),a.jsx("button",{onClick:()=>{D(!1),P(null)},className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsx("div",{className:"p-4",children:a.jsx("img",{src:b.proofUrl,alt:"Comprobante",className:"max-w-full h-auto rounded"})})]})})]})}function wO(){const{addNotification:t}=pn(),[e,n]=ue.useState({provider:"smtp",smtpHost:"",smtpPort:587,smtpSecure:!1,smtpUser:"",smtpPassword:"",zohoClientId:"",zohoClientSecret:"",zohoRefreshToken:"",zohoAccessToken:"",zohoAccessTokenExpiry:null,fromEmail:"",fromName:"",enabled:!1}),[r,i]=ue.useState(!1),[s,o]=ue.useState("");ue.useEffect(()=>{const f=dt(Be,"artifacts",Fe,"public","data","settings","email_config"),v=Gt(f,g=>{if(g.exists()){const p=g.data();n({...p,smtpUser:p.smtpUser?p.smtpUser.trim():"",smtpHost:p.smtpHost?p.smtpHost.trim():"",fromEmail:p.fromEmail?p.fromEmail.trim():""})}},g=>{console.error("Error loading email config:",g),g.code==="permission-denied"&&t("Error de permisos al cargar configuracin de email. Verifica las reglas de Firestore.","error")});return()=>v()},[]);const l=f=>{const{name:v,value:g,type:p,checked:T}=f.target;let k=g;p==="text"&&(v==="smtpUser"||v==="smtpHost"||v==="fromEmail")&&(k=g.trim()),n(C=>({...C,[v]:p==="checkbox"?T:p==="number"?parseInt(g)||0:k}))},c=async()=>{try{const f=dt(Be,"artifacts",Fe,"public","data","settings","email_config");await ws(f,{...e,updatedAt:new Date},{merge:!0}),t("Configuracin de email guardada exitosamente","success")}catch(f){console.error("Error saving email config:",f),t("Error al guardar la configuracin","error")}},u=async()=>{if(!s||!s.includes("@")){t("Ingresa un email vlido para probar","error");return}i(!0);try{const f=dt(Be,"artifacts",Fe,"public","data","settings","email_config");await ws(f,e,{merge:!0}),await new Promise(g=>setTimeout(g,500));const v=await x8(s);if(v.success)if(v.sent)t(` Email de prueba enviado exitosamente a ${s}. Revisa tu bandeja de entrada (y spam).`,"success");else if(v.simulated){const g=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";t(g?" Modo desarrollo: El email se registr pero no se envi (servidor PHP no disponible localmente). Despliega en produccin para envo real.":" Email de prueba registrado en historial. Verifica la configuracin SMTP si no se envi.","warning")}else t(" Email de prueba procesado. Revisa el historial de mensajes para ver el estado.","info");else{const g=v.error||"Error desconocido",p=v.details||"";let T="";g.includes("send-email.php")||g.includes("404")||g.includes("no se encontr")?T=" Verifica que send-email.php est en el servidor y que PHPMailer est instalado. Consulta VERIFICAR-PHP.md":g.includes("PHPMailer")||g.includes("Class")?T=" PHPMailer no est instalado. Ejecuta: composer require phpmailer/phpmailer":g.includes("Could not authenticate")||g.includes("authentication")?T=p||" Verifica: 1) Usuario SMTP debe ser el email completo (ej: noreply@dominio.com), 2) Contrasea correcta, 3) Puerto y conexin segura (587 con TLS o 465 con SSL), 4) Servidor SMTP correcto":(g.includes("SMTP")||g.includes("connect"))&&(T=p||" Verifica la configuracin SMTP (servidor, puerto, usuario, contrasea)");const k=p?` Error al enviar email: ${g}

${p}`:` Error al enviar email: ${g}${T}`;t(k,"error")}}catch(f){console.error("Error testing email:",f),t("Error al enviar email de prueba: "+f.message,"error")}finally{i(!1)}};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Configuracin de Email"}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Proveedor de Email"}),a.jsxs("select",{name:"provider",value:e.provider||"smtp",onChange:l,className:"w-full p-2 border rounded-md",children:[a.jsx("option",{value:"smtp",children:"SMTP (Servidor de Correo)"}),a.jsx("option",{value:"zoho",children:"Zoho Mail API"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.provider==="zoho"?"Zoho Mail API: Envo directo va API REST, mejor deliverability, sin necesidad de servidor SMTP.":"SMTP: Mtodo tradicional, requiere servidor SMTP configurado (cPanel, Gmail, etc.)."})]}),e.provider==="zoho"?a.jsxs("div",{className:"space-y-4 border-t pt-4",children:[a.jsx("h4",{className:"font-semibold text-gray-800",children:"Configuracin Zoho Mail API"}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[a.jsx("p",{className:"text-sm font-medium text-blue-800 mb-2",children:" Pasos para Configurar Zoho Mail API:"}),a.jsxs("ol",{className:"text-sm text-blue-700 space-y-1 list-decimal list-inside",children:[a.jsxs("li",{children:["Registra tu aplicacin en ",a.jsx("a",{href:"https://api-console.zoho.com",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Zoho API Console"})]}),a.jsx("li",{children:"Obtn tu Client ID y Client Secret"}),a.jsx("li",{children:"Genera un Refresh Token (una vez, no expira)"}),a.jsx("li",{children:"Configura los permisos de Zoho Mail API"}),a.jsx("li",{children:"Ingresa las credenciales a continuacin"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client ID (Zoho)"}),a.jsx("input",{type:"text",name:"zohoClientId",value:e.zohoClientId,onChange:l,placeholder:"1000.XXXXXXXXXX",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Obtn esto desde Zoho API Console"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Secret (Zoho)"}),a.jsx("input",{type:"password",name:"zohoClientSecret",value:e.zohoClientSecret,onChange:l,placeholder:"",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Secreto de tu aplicacin Zoho"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Refresh Token (Zoho)"}),a.jsx("input",{type:"password",name:"zohoRefreshToken",value:e.zohoRefreshToken,onChange:l,placeholder:"1000.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Genera este token una vez desde Zoho API Console. No expira hasta que lo revoques."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Remitente (Zoho)"}),a.jsx("input",{type:"email",name:"fromEmail",value:e.fromEmail,onChange:l,placeholder:"noreply@tudominio.com",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Debe ser un email configurado en tu cuenta Zoho Mail"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Remitente"}),a.jsx("input",{type:"text",name:"fromName",value:e.fromName,onChange:l,placeholder:"Nombre de tu empresa",className:"w-full p-2 border rounded-md"})]})]})]}):a.jsxs("div",{className:"space-y-4 border-t pt-4",children:[a.jsx("h4",{className:"font-semibold text-gray-800",children:"Configuracin SMTP"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Servidor SMTP"}),a.jsx("input",{type:"text",name:"smtpHost",value:e.smtpHost,onChange:l,placeholder:"smtp.gmail.com",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ejemplo: smtp.gmail.com, smtp.outlook.com"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Puerto SMTP"}),a.jsx("input",{type:"number",name:"smtpPort",value:e.smtpPort,onChange:l,placeholder:"587",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Puerto comn: 587 (TLS) o 465 (SSL)"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Usuario SMTP"}),a.jsx("input",{type:"text",name:"smtpUser",value:e.smtpUser,onChange:l,placeholder:"tu-email@dominio.com",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrasea SMTP"}),a.jsx("input",{type:"password",name:"smtpPassword",value:e.smtpPassword,onChange:l,placeholder:"",className:"w-full p-2 border rounded-md"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Para Gmail: usa una "Contrasea de aplicacin"'})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Remitente"}),a.jsx("input",{type:"email",name:"fromEmail",value:e.fromEmail,onChange:l,placeholder:"noreply@tuempresa.com",className:"w-full p-2 border rounded-md"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Remitente"}),a.jsx("input",{type:"text",name:"fromName",value:e.fromName,onChange:l,placeholder:"App Gestor",className:"w-full p-2 border rounded-md"})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"smtpSecure",name:"smtpSecure",checked:e.smtpSecure,onChange:l,className:"w-4 h-4 text-blue-600 border-gray-300 rounded"}),a.jsx("label",{htmlFor:"smtpSecure",className:"text-sm font-medium text-gray-700",children:"Usar conexin segura (SSL/TLS)"})]}),a.jsxs("div",{className:"flex items-center space-x-2 pt-4 border-t",children:[a.jsx("input",{type:"checkbox",id:"enabled",name:"enabled",checked:e.enabled,onChange:l,className:"w-4 h-4 text-blue-600 border-gray-300 rounded"}),a.jsx("label",{htmlFor:"enabled",className:"text-sm font-medium text-gray-700",children:"Habilitar servicio de email"})]}),a.jsx("div",{className:"flex justify-end space-x-4 pt-4",children:a.jsx("button",{onClick:c,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Guardar Configuracin"})})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Probar Configuracin"}),window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:[a.jsx("p",{className:"text-sm font-medium text-yellow-800 mb-2",children:" Modo Desarrollo Local:"}),a.jsxs("p",{className:"text-sm text-yellow-700",children:["Ests en desarrollo local. El servidor PHP no est disponible, por lo que los emails se registrarn en el historial pero ",a.jsx("strong",{children:"NO se enviarn realmente"}),". Para probar el envo real, despliega la aplicacin en produccin (Dockge o cPanel)."]})]}):a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:[a.jsx("p",{className:"text-sm font-medium text-green-800 mb-2",children:" Emails Reales Activados:"}),a.jsx("p",{className:"text-sm text-green-700",children:"Los emails se estn enviando realmente usando el servidor SMTP configurado. El email de prueba se enviar a la direccin que especifiques."})]}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"El email de prueba se registrar en el historial (modo desarrollo). En produccin se enviar realmente.":"El email de prueba se enviar realmente usando tu configuracin SMTP. Verifica tu bandeja de entrada."}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("input",{type:"email",value:s,onChange:f=>o(f.target.value),placeholder:"email@ejemplo.com",className:"flex-1 p-2 border rounded-md"}),a.jsx("button",{onClick:u,disabled:r||!e.enabled,className:`px-6 py-2 rounded-md ${r||!e.enabled?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:r?"Enviando...":"Enviar Email de Prueba"})]}),!e.enabled&&a.jsx("p",{className:"text-sm text-yellow-600 mt-2",children:" Debes habilitar el servicio de email primero para poder enviar pruebas."})]})]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.provider==="zoho"?a.jsxs(a.Fragment,{children:[a.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Configuracin de Zoho Mail API"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:" Ventajas de Zoho Mail API"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc list-inside mb-2",children:[a.jsx("li",{children:"No requiere servidor SMTP configurado"}),a.jsx("li",{children:"Mejor deliverability (Zoho maneja la reputacin)"}),a.jsx("li",{children:"Tracking y analytics de emails"}),a.jsx("li",{children:"Sin lmites de conexiones SMTP"}),a.jsx("li",{children:"Respuestas de error ms detalladas"})]})]}),a.jsxs("div",{className:"border-t border-blue-300 pt-3 mt-3",children:[a.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:" Enlaces tiles:"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[a.jsxs("li",{children:[a.jsx("a",{href:"https://api-console.zoho.com",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Zoho API Console"})," - Registra tu aplicacin"]}),a.jsx("li",{children:a.jsx("a",{href:"https://www.zoho.com/mail/help/api/",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Documentacin Zoho Mail API"})}),a.jsx("li",{children:a.jsx("a",{href:"https://www.zoho.com/mail/help/dev-platform/connectors.html",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Gua de OAuth 2.0"})})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Configuracin de SMTP"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:" Usar cPanel (Recomendado si tienes hosting con cPanel)"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc list-inside mb-2",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Servidor SMTP:"})," ",a.jsx("code",{children:"mail.tu-dominio.com"})," o ",a.jsx("code",{children:"smtp.tu-dominio.com"})]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Puerto:"})," ",a.jsx("code",{children:"587"})," (TLS) o ",a.jsx("code",{children:"465"}),' (SSL) - Marca "Usar conexin segura"']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Usuario:"})," Email completo (ej: ",a.jsx("code",{children:"noreply@tu-dominio.com"}),")"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Contrasea:"})," La contrasea del email creado en cPanel"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Email Remitente:"})," El mismo email (ej: ",a.jsx("code",{children:"noreply@tu-dominio.com"}),")"]})]}),a.jsxs("p",{className:"text-xs text-blue-600 mt-2",children:[" ",a.jsx("strong",{children:"Ventaja:"})," No necesitas servicios externos, emails ilimitados desde tu propio dominio."]})]}),a.jsxs("div",{className:"border-t border-blue-300 pt-3 mt-3",children:[a.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:"Otros Servicios:"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc list-inside",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Gmail:"}),' smtp.gmail.com:587, usa "Contrasea de aplicacin"']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Outlook:"})," smtp-mail.outlook.com:587"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Yahoo:"})," smtp.mail.yahoo.com:587"]})]})]})]})})]})}function NO(){const{addNotification:t}=pn(),e={admin:{payments:{approval:!0,rejection:!0,newPayment:!0},services:{expirationReminder:!0,newService:!0},users:{newUser:!0,userActivation:!0},tickets:{newTicket:!0,ticketUpdate:!0},renewals:{renewalRequest:!0}},client:{payments:{approval:!0,rejection:!0,pendingPayment:!0},services:{expirationReminder:!0,serviceActivated:!0,serviceExpired:!0},tickets:{ticketReply:!0,ticketResolved:!0},renewals:{renewalReminder:!0,renewalConfirmed:!0}}},[n,r]=ue.useState(e),[i,s]=ue.useState(!0);ue.useEffect(()=>{const u=dt(Be,"artifacts",Fe,"public","data","settings","notification_settings"),f=Gt(u,v=>{if(v.exists()){const g=v.data();r({admin:{...e.admin,...g.admin},client:{...e.client,...g.client}})}s(!1)});return()=>f()},[]);const o=(u,f,v)=>{r(g=>{var p;return{...g,[u]:{...g[u],[f]:{...g[u][f],[v]:!((p=g[u][f])!=null&&p[v])}}}})},l=async()=>{try{const u=dt(Be,"artifacts",Fe,"public","data","settings","notification_settings");await ws(u,{...n,updatedAt:new Date},{merge:!0}),t("Configuracin de notificaciones guardada exitosamente","success")}catch(u){console.error("Error saving notification settings:",u),t("Error al guardar la configuracin","error")}},c={payments:{label:"Pagos",icon:"",admin:[{key:"approval",label:"Aprobacin de pago"},{key:"rejection",label:"Rechazo de pago"},{key:"newPayment",label:"Nuevo pago recibido"}],client:[{key:"approval",label:"Pago aprobado"},{key:"rejection",label:"Pago rechazado"},{key:"pendingPayment",label:"Recordatorio de pago pendiente"}]},services:{label:"Servicios",icon:"",admin:[{key:"expirationReminder",label:"Recordatorio de vencimiento"},{key:"newService",label:"Nuevo servicio creado"}],client:[{key:"expirationReminder",label:"Recordatorio de vencimiento"},{key:"serviceActivated",label:"Servicio activado"},{key:"serviceExpired",label:"Servicio vencido"}]},users:{label:"Usuarios",icon:"",admin:[{key:"newUser",label:"Nuevo usuario registrado"},{key:"userActivation",label:"Activacin de usuario"}],client:[]},tickets:{label:"Tickets",icon:"",admin:[{key:"newTicket",label:"Nuevo ticket creado"},{key:"ticketUpdate",label:"Actualizacin de ticket"}],client:[{key:"ticketReply",label:"Respuesta a ticket"},{key:"ticketResolved",label:"Ticket resuelto"}]},renewals:{label:"Renovaciones",icon:"",admin:[{key:"renewalRequest",label:"Solicitud de renovacin"}],client:[{key:"renewalReminder",label:"Recordatorio de renovacin"},{key:"renewalConfirmed",label:"Renovacin confirmada"}]}};return i?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Configuracin de Notificaciones"}),a.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Activa o desactiva las notificaciones por email segn el mdulo y el tipo de usuario."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold mb-4 bg-purple-100 text-purple-800 px-4 py-2 rounded-lg",children:" Notificaciones para Administradores"}),a.jsx("div",{className:"space-y-6",children:Object.entries(c).map(([u,f])=>!f.admin||f.admin.length===0?null:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[a.jsxs("h5",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx("span",{className:"text-2xl",children:f.icon}),f.label]}),a.jsx("div",{className:"space-y-3",children:f.admin.map(({key:v,label:g})=>{var p;return a.jsxs("div",{className:"flex items-center justify-between py-2 border-b",children:[a.jsx("span",{className:"text-sm text-gray-700",children:g}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:((p=n.admin[u])==null?void 0:p[v])??!1,onChange:()=>o("admin",u,v),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},v)})})]},u))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold mb-4 bg-blue-100 text-blue-800 px-4 py-2 rounded-lg",children:" Notificaciones para Clientes"}),a.jsx("div",{className:"space-y-6",children:Object.entries(c).map(([u,f])=>!f.client||f.client.length===0?null:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[a.jsxs("h5",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx("span",{className:"text-2xl",children:f.icon}),f.label]}),a.jsx("div",{className:"space-y-3",children:f.client.map(({key:v,label:g})=>{var p;return a.jsxs("div",{className:"flex items-center justify-between py-2 border-b",children:[a.jsx("span",{className:"text-sm text-gray-700",children:g}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:((p=n.client[u])==null?void 0:p[v])??!1,onChange:()=>o("client",u,v),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},v)})})]},u))})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx("button",{onClick:l,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium",children:"Guardar Configuracin"})})]})}function _O({userRole:t}){const[e,n]=ue.useState("history"),{addNotification:r}=pn(),[i,s]=ue.useState([]),[o,l]=ue.useState(""),[c,u]=ue.useState("Todos"),[f,v]=ue.useState("Todos"),[g,p]=ue.useState("Todos"),[T,k]=ue.useState(!0),[C,b]=ue.useState(null),[P,R]=ue.useState(!1),[D,Z]=ue.useState(null),le=["Todos","Enviado","Entregado","Simulado","Ledo","Fallido","Cancelado","Pendiente"],U=["Todos","Aprobacin","Rechazo","Recordatorio","Notificacin","Activacin","Sistema"],j=["Todos","Cliente","Administrador","Sistema"];ue.useEffect(()=>{const X=An(Ut(Be,"artifacts",Fe,"public","data","messages"),Uu("sentAt","desc")),ne=Gt(X,w=>{const S=w.docs.map(V=>({id:V.id,...V.data()}));s(S),k(!1)},w=>{console.error("Error loading messages:",w),r("Error al cargar los mensajes.","error"),k(!1)});return()=>ne()},[r]);const _=async(X,ne)=>{try{const w=dt(Be,"artifacts",Fe,"public","data","messages",X);await gr(w,{status:ne,updatedAt:new Date}),r(`Estado del mensaje actualizado a ${ne}`,"success")}catch(w){console.error("Error updating message status:",w),r("Error al actualizar el estado del mensaje","error")}},F=X=>{b(X),R(!0)},A=async(X,ne)=>{if(ne&&ne.stopPropagation(),D!==X.id){Z(X.id);try{await fr();const w=X.recipientEmail||X.to,S=X.recipientName||"",V=X.subject||"Sin asunto",ee=X.message||X.content||"",re=ee.includes("<")&&ee.includes(">"),ce=re?ee:ee.replace(/\n/g,"<br>"),he=re?ee.replace(/<[^>]*>/g,""):ee;await ar({to:w,toName:S,subject:`[Reenvo] ${V}`,html:ce,text:he,type:X.type||"Notificacin",recipientType:X.recipientType||"Cliente",module:X.module||"system",event:X.event||"resend",metadata:{originalMessageId:X.id,originalSentAt:X.sentAt,resendAt:new Date().toISOString()}}),r(`Mensaje reenviado exitosamente a ${w}`,"success"),P&&(C==null?void 0:C.id)===X.id&&R(!1)}catch(w){console.error("Error resending message:",w),r(`Error al reenviar mensaje: ${w.message}`,"error")}finally{Z(null)}}},L=async(X,ne)=>{ne&&ne.stopPropagation();const w=X.recipientEmail||X.to||"este mensaje",S=X.subject||"Sin asunto";if(window.confirm(`Eliminar permanentemente el mensaje "${S}" enviado a ${w}?

Esta accin no se puede deshacer.`))try{const V=dt(Be,"artifacts",Fe,"public","data","messages",X.id);await vl(V),r("Mensaje eliminado exitosamente","success"),P&&(C==null?void 0:C.id)===X.id&&(R(!1),b(null))}catch(V){console.error("Error deleting message:",V),r(`Error al eliminar mensaje: ${V.message}`,"error")}},E=X=>({Enviado:"bg-blue-100 text-blue-800",Entregado:"bg-green-100 text-green-800",Simulado:"bg-orange-100 text-orange-800",Ledo:"bg-purple-100 text-purple-800",Fallido:"bg-red-100 text-red-800",Cancelado:"bg-gray-100 text-gray-800",Pendiente:"bg-yellow-100 text-yellow-800"})[X]||"bg-gray-100 text-gray-800",M=X=>({Aprobacin:"bg-green-100 text-green-800",Rechazo:"bg-red-100 text-red-800",Recordatorio:"bg-yellow-100 text-yellow-800",Notificacin:"bg-blue-100 text-blue-800",Activacin:"bg-purple-100 text-purple-800",Sistema:"bg-gray-100 text-gray-800"})[X]||"bg-gray-100 text-gray-800",G=X=>({Cliente:"bg-blue-100 text-blue-800",Administrador:"bg-purple-100 text-purple-800",Sistema:"bg-gray-100 text-gray-800"})[X]||"bg-gray-100 text-gray-800",K=X=>X?new Date(X.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",z=X=>{switch(X){case"Enviado":return a.jsx(hs,{});case"Entregado":return a.jsx(cA,{});case"Simulado":return a.jsx("span",{title:" No enviado realmente",children:""});case"Ledo":return a.jsx(yl,{});case"Fallido":return a.jsx(ap,{});case"Pendiente":return a.jsx(hs,{});default:return a.jsx(hs,{})}},q=i.filter(X=>{const ne=o===""||X.recipientName.toLowerCase().includes(o.toLowerCase())||X.recipientEmail.toLowerCase().includes(o.toLowerCase())||X.subject.toLowerCase().includes(o.toLowerCase())||X.message.toLowerCase().includes(o.toLowerCase()),w=c==="Todos"||X.status===c,S=f==="Todos"||X.type===f,V=g==="Todos"||X.recipientType===g;return ne&&w&&S&&V});if(T)return a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const H=()=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Historial de Mensajes"}),a.jsxs("div",{className:"text-sm text-gray-500",children:[q.length," mensaje",q.length!==1?"s":""," encontrado",q.length!==1?"s":""]})]}),a.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6 rounded",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("span",{className:"text-blue-400 text-2xl",children:""})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Emails Reales Activados"}),a.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["Los emails se estn enviando realmente usando el servidor SMTP configurado. El historial muestra el estado de cada envo: ",a.jsx("span",{className:"font-semibold",children:'"Enviado"'}),", ",a.jsx("span",{className:"font-semibold",children:'"Fallido"'})," o ",a.jsx("span",{className:"font-semibold",children:'"Cancelado"'}),"."]})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar por destinatario, asunto o contenido...",value:o,onChange:X=>l(X.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Vu,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:c,onChange:X=>u(X.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:le.map(X=>a.jsx("option",{value:X,children:X},X))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(uu,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:f,onChange:X=>v(X.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:U.map(X=>a.jsx("option",{value:X,children:X},X))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(om,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:g,onChange:X=>p(X.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:j.map(X=>a.jsx("option",{value:X,children:X},X))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(uu,{})})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Tipo","Mdulo","Destinatario","Asunto","Estado","Enviado","Entregado","Ledo","Acciones"].map(X=>a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:X},X))})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:q.map(X=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${M(X.type)}`,children:X.type}),a.jsx("span",{className:`ml-2 px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${G(X.recipientType)}`,children:X.recipientType})]})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900 capitalize",children:X.module||"Sistema"}),X.event&&a.jsx("div",{className:"text-xs text-gray-500 capitalize",children:X.event.replace(/([A-Z])/g," $1").trim()}),X.provider&&a.jsx("div",{className:"text-xs text-blue-600 font-medium mt-1",children:X.provider==="zoho"?" Zoho Mail API":" SMTP"})]}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:X.recipientName||"N/A"}),a.jsx("div",{className:"text-sm text-gray-500",children:X.recipientEmail||X.to||"N/A"})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",title:X.subject,children:X.subject})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${E(X.status)}`,children:X.status}),a.jsx("div",{className:"ml-2 text-gray-400",children:z(X.status)}),X.status==="Simulado"&&a.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-orange-200 text-orange-800 rounded-full",title:"Email histrico - antes de implementar envo real",children:" Histrico"})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:K(X.sentAt)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:X.deliveredAt?K(X.deliveredAt):"--"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:X.readAt?K(X.readAt):"--"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("button",{onClick:()=>F(X),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md",title:"Ver mensaje completo",children:a.jsx(yl,{})}),t==="superadmin"&&a.jsxs(Bh,{children:[a.jsx("select",{value:X.status,onChange:ne=>_(X.id,ne.target.value),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 border-none bg-transparent",children:le.filter(ne=>ne!=="Todos").map(ne=>a.jsx("option",{value:ne,children:ne},ne))}),a.jsx("button",{onClick:ne=>A(X,ne),disabled:D===X.id,className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed",children:D===X.id?"Reenviando...":"Reenviar"}),a.jsx("button",{onClick:ne=>L(X,ne),className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"Eliminar"})]})]})})]},X.id))})]})}),q.length===0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(om,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron mensajes"}),a.jsx("p",{className:"text-gray-500",children:"No hay mensajes que coincidan con los filtros seleccionados."})]}),P&&C&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Detalles del Mensaje"}),a.jsx("button",{onClick:()=>R(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tipo"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${M(C.type)}`,children:C.type})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${E(C.status)}`,children:C.status})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Destinatario"}),a.jsx("div",{className:"text-sm text-gray-900",children:C.recipientName}),a.jsx("div",{className:"text-sm text-gray-500",children:C.recipientEmail})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Canal"}),a.jsx("div",{className:"text-sm text-gray-900",children:C.channel||"Email"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto"}),a.jsx("div",{className:"text-sm text-gray-900 p-3 bg-gray-50 rounded-md",children:C.subject})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contenido del Mensaje"}),a.jsx("div",{className:"text-sm text-gray-900 p-4 bg-gray-50 rounded-md whitespace-pre-wrap max-h-64 overflow-y-auto",children:C.html||C.text||C.body||C.message||"Sin contenido"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Enviado"}),a.jsx("div",{className:"text-gray-900",children:K(C.sentAt)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Entregado"}),a.jsx("div",{className:"text-gray-900",children:C.deliveredAt?K(C.deliveredAt):"No entregado"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ledo"}),a.jsx("div",{className:"text-gray-900",children:C.readAt?K(C.readAt):"No ledo"})]})]}),C.status==="Simulado"&&a.jsxs("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-md",children:[a.jsx("label",{className:"block text-sm font-medium text-orange-700 mb-1",children:" Email Simulado (Histrico)"}),a.jsx("div",{className:"text-sm text-orange-600",children:"Este email fue registrado antes de implementar el envo real. Los nuevos emails se envan realmente."})]}),C.status==="Enviado"&&a.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md",children:[a.jsx("label",{className:"block text-sm font-medium text-green-700 mb-1",children:" Email Enviado"}),a.jsx("div",{className:"text-sm text-green-600",children:"Este email fue enviado exitosamente usando el servidor SMTP configurado."})]}),C.errorMessage&&!C.simulated&&a.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:[a.jsx("label",{className:"block text-sm font-medium text-red-700 mb-1",children:"Error"}),a.jsx("div",{className:"text-sm text-red-600",children:C.errorMessage})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{onClick:()=>R(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cerrar"}),t==="superadmin"&&a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:X=>{X.stopPropagation(),A(C,X)},disabled:D===C.id,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:D===C.id?"Reenviando...":"Reenviar Mensaje"}),a.jsx("button",{onClick:X=>{X.stopPropagation(),L(C,X)},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Eliminar Mensaje"})]})]})]})]})})]});return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2 mb-4",children:[a.jsx(om,{}),"Mensajera y Notificaciones"]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"flex space-x-8",children:[a.jsx("button",{onClick:()=>n("history"),className:`py-4 px-1 border-b-2 font-medium text-sm ${e==="history"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:" Historial de Mensajes"}),a.jsx("button",{onClick:()=>n("email"),className:`py-4 px-1 border-b-2 font-medium text-sm ${e==="email"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:" Configuracin de Email"}),a.jsx("button",{onClick:()=>n("notifications"),className:`py-4 px-1 border-b-2 font-medium text-sm ${e==="notifications"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:" Notificaciones por Mdulo"})]})})]}),e==="history"&&a.jsx(H,{}),e==="email"&&a.jsx(wO,{}),e==="notifications"&&a.jsx(NO,{})]})}function iS({ticketId:t,userRole:e,currentUser:n}){const{addNotification:r}=pn(),[i,s]=ue.useState([]),[o,l]=ue.useState(""),[c,u]=ue.useState(!1),[f,v]=ue.useState(!0),[g,p]=ue.useState(!1);ue.useEffect(()=>{if(!t){v(!1);return}const C=An(Ut(Be,"artifacts",Fe,"public","data","ticketMessages"),ur("ticketId","==",t)),b=Gt(C,P=>{const R=P.docs.map(D=>({id:D.id,...D.data()}));R.sort((D,Z)=>{var j,_;const le=((j=D.createdAt)==null?void 0:j.seconds)||0,U=((_=Z.createdAt)==null?void 0:_.seconds)||0;return le-U}),s(R),v(!1)},P=>{console.error("Error loading messages:",P),r("Error al cargar los mensajes","error"),v(!1)});return()=>b()},[t,r]);const T=async C=>{if(C.preventDefault(),!!o.trim()){p(!0);try{const b={ticketId:t,content:o.trim(),senderId:n.uid,senderName:n.displayName||n.email,senderRole:e,senderEmail:n.email,isInternal:c&&(e==="admin"||e==="superadmin"),createdAt:ht.now(),attachments:[]};await Sa(Ut(Be,"artifacts",Fe,"public","data","ticketMessages"),b);const P=dt(Be,"artifacts",Fe,"public","data","tickets",t),R=await vs(P),D=R.exists()?{id:R.id,...R.data()}:null;if(await gr(P,{replyCount:i.length+1,lastReplyAt:ht.now(),lastReplyBy:n.displayName||n.email,updatedAt:ht.now(),...e==="admin"||e==="superadmin"?{status:"Respondido"}:{}}),D&&!b.isInternal)try{console.log(" [TICKET] Iniciando envo de notificaciones por respuesta"),await fr();const Z=D.ticketNumber,le=D.subject,U=o.trim(),j=n.displayName||n.email,_=n.email,F=await fr();if(e==="client"){const A=F==null?void 0:F.fromEmail;if(A){console.log(" [TICKET] Enviando email al administrador por respuesta del cliente:",A);const L=`
                <h2>Nueva Respuesta - Ticket ${Z}</h2>
                <p>El cliente ha respondido a su ticket de soporte.</p>
                <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
                  <p><strong>Nmero de Ticket:</strong> ${Z}</p>
                  <p><strong>Cliente:</strong> ${D.clientName||j}${D.clientEmail?` (${D.clientEmail})`:""}</p>
                  <p><strong>Asunto:</strong> ${le}</p>
                  <p><strong>Respuesta:</strong></p>
                  <p style="white-space: pre-wrap; background-color: #ffffff; padding: 10px; border-radius: 3px; margin-top: 10px;">${U}</p>
                </div>
                <p>Por favor, revisa y responde desde el panel de administracin.</p>
              `;await ar({to:A,toName:(F==null?void 0:F.fromName)||"Administrador",subject:`Nueva Respuesta - Ticket ${Z}`,html:L,text:`Nueva Respuesta - Ticket ${Z}

El cliente ha respondido a su ticket de soporte.

Nmero de Ticket: ${Z}
Cliente: ${D.clientName||j}${D.clientEmail?` (${D.clientEmail})`:""}
Asunto: ${le}

Respuesta:
${U}

Por favor, revisa y responde desde el panel de administracin.`,type:"Notificacin",recipientType:"Administrador",module:"tickets",event:"ticketReply",metadata:{ticketId:t,ticketNumber:Z,senderEmail:_,senderName:j}})}}else{const A=D.clientEmail;if(A){console.log(" [TICKET] Enviando email al cliente por respuesta del administrador:",A);const L=`
                <h2>Nueva Respuesta - Ticket ${Z}</h2>
                <p>Estimado/a <strong>${D.clientName||"Cliente"}</strong>,</p>
                <p>Hemos respondido a tu ticket de soporte.</p>
                <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
                  <p><strong>Nmero de Ticket:</strong> ${Z}</p>
                  <p><strong>Asunto:</strong> ${le}</p>
                  <p><strong>Respuesta:</strong></p>
                  <p style="white-space: pre-wrap; background-color: #ffffff; padding: 10px; border-radius: 3px; margin-top: 10px;">${U}</p>
                </div>
                <p>Puedes ver la respuesta completa y responder desde tu panel de cliente.</p>
                <p>Saludos cordiales,<br>Equipo de Soporte</p>
              `;await ar({to:A,toName:D.clientName||"Cliente",subject:`Respuesta a Ticket ${Z} - ${le}`,html:L,text:`Nueva Respuesta - Ticket ${Z}

Estimado/a ${D.clientName||"Cliente"},

Hemos respondido a tu ticket de soporte.

Nmero de Ticket: ${Z}
Asunto: ${le}

Respuesta:
${U}

Puedes ver la respuesta completa y responder desde tu panel de cliente.

Saludos cordiales,
Equipo de Soporte`,type:"Notificacin",recipientType:"Cliente",module:"tickets",event:"ticketReply",metadata:{ticketId:t,ticketNumber:Z,senderEmail:_,senderName:j}})}}console.log(" [TICKET] Notificaciones por respuesta completadas")}catch(Z){console.error(" [TICKET] Error sending reply notification emails:",Z)}l(""),u(!1),r(b.isInternal?"Nota interna agregada":"Mensaje enviado","success")}catch(b){console.error("Error sending message:",b),r("Error al enviar el mensaje","error")}finally{p(!1)}}},k=C=>{if(!C)return"--";const b=new Date,P=new Date(C.seconds*1e3),R=b.getTime()-P.getTime(),D=Math.floor(R/(1e3*60*60*24)),Z=Math.floor(R/(1e3*60*60)),le=Math.floor(R/(1e3*60));return D>0?`hace ${D} da${D>1?"s":""}`:Z>0?`hace ${Z} hora${Z>1?"s":""}`:le>0?`hace ${le} minuto${le>1?"s":""}`:"hace unos segundos"};return f?a.jsx("div",{className:"flex justify-center items-center h-32",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:i.length===0?a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(op,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),a.jsx("p",{children:"No hay mensajes en este ticket"})]}):i.map(C=>a.jsx("div",{className:`flex ${C.senderRole==="client"?"justify-start":"justify-end"}`,children:a.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${C.senderRole==="client"?"bg-gray-100 text-gray-900":C.isInternal?"bg-yellow-100 text-yellow-900 border border-yellow-300":"bg-blue-100 text-blue-900"}`,children:[C.isInternal&&a.jsx("div",{className:"text-xs font-semibold text-yellow-700 mb-1",children:"NOTA INTERNA"}),a.jsx("div",{className:"text-sm whitespace-pre-wrap",children:C.content}),a.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-gray-500",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(yh,{}),a.jsx("span",{children:C.senderName})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(hs,{}),a.jsx("span",{children:k(C.createdAt)})]})]}),C.attachments&&C.attachments.length>0&&a.jsx("div",{className:"mt-2 pt-2 border-t border-gray-300",children:a.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[a.jsx(f8,{}),a.jsxs("span",{children:[C.attachments.length," archivo",C.attachments.length!==1?"s":""]})]})})]})},C.id))}),a.jsx("div",{className:"border-t pt-4",children:a.jsxs("form",{onSubmit:T,className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e==="client"?"Responder al ticket":"Responder al cliente"}),a.jsx("textarea",{value:o,onChange:C=>l(C.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:e==="client"?"Escribe tu respuesta aqu...":"Escribe tu respuesta al cliente aqu...",required:!0})]}),e==="admin"||e==="superadmin"?a.jsx("div",{className:"flex items-center gap-4",children:a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:c,onChange:C=>u(C.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Nota interna (solo visible para administradores)"})]})}):null,a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{type:"submit",disabled:g||!o.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Enviando..."]}):a.jsxs(a.Fragment,{children:[a.jsx(op,{}),"Enviar Mensaje"]})})})]})})]})}function EO({userRole:t}){const{addNotification:e}=pn(),[n,r]=ue.useState([]),[i,s]=ue.useState([]),[o,l]=ue.useState(""),[c,u]=ue.useState("Todos"),[f,v]=ue.useState("Todos"),[g,p]=ue.useState("Todos"),[T,k]=ue.useState(!0),[C,b]=ue.useState(null),[P,R]=ue.useState(!1),[D,Z]=ue.useState(!1),[le,U]=ue.useState({subject:"",department:"Soporte Tcnico",priority:"Media",description:"",clientId:"",clientName:"",clientEmail:""}),j=["Todos","Abierto","En Progreso","Respondido","Cerrado","Esperando Cliente"],_=["Todos","Baja","Media","Alta","Crtica"],F=["Todos","Soporte Tcnico","Facturacin","Ventas","General"];ue.useEffect(()=>{const S=An(Ut(Be,"artifacts",Fe,"public","data","tickets")),V=Gt(S,ce=>{const he=ce.docs.map(me=>({id:me.id,...me.data()}));he.sort((me,ye)=>{var Re,be;const Ee=((Re=me.createdAt)==null?void 0:Re.seconds)||0;return(((be=ye.createdAt)==null?void 0:be.seconds)||0)-Ee}),r(he),k(!1)},ce=>{console.error("Error loading tickets:",ce),e("Error al cargar los tickets.","error"),k(!1)}),ee=An(Ut(Be,"artifacts",Fe,"public","data","users"),ur("role","==","client")),re=Gt(ee,ce=>{const he=ce.docs.map(me=>({id:me.id,...me.data()}));s(he)},ce=>{console.error("Error loading clients:",ce)});return()=>{V(),re()}},[e]);const A=async(S,V)=>{try{const ee=dt(Be,"artifacts",Fe,"public","data","tickets",S),re=await vs(ee);if(!re.exists()){e("Ticket no encontrado","error");return}const ce={id:re.id,...re.data()},he=ce.status;await gr(ee,{status:V,updatedAt:ht.now()});try{console.log(" [ADMIN] Iniciando envo de notificaciones por cambio de estado"),await fr();const me=ce.ticketNumber,ye=ce.subject,Ee=ce.clientName||"Cliente",Pe=ce.clientEmail,Re=await fr(),be=Re==null?void 0:Re.fromEmail;if(Pe&&he!==V){console.log(" [ADMIN] Enviando email al cliente por cambio de estado:",Pe);const ie=`
            <h2>Actualizacin de Ticket ${me}</h2>
            <p>Estimado/a <strong>${Ee}</strong>,</p>
            <p>El estado de tu ticket ha sido actualizado.</p>
            <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
              <p><strong>Nmero de Ticket:</strong> ${me}</p>
              <p><strong>Asunto:</strong> ${ye}</p>
              <p><strong>Estado Anterior:</strong> ${he}</p>
              <p><strong>Estado Nuevo:</strong> <strong style="color: #2563eb;">${V}</strong></p>
            </div>
            <p>Puedes revisar el estado actualizado de tu ticket desde tu panel de cliente.</p>
            <p>Saludos cordiales,<br>Equipo de Soporte</p>
          `;await ar({to:Pe,toName:Ee,subject:`Ticket ${me} - Estado Actualizado a ${V}`,html:ie,text:`Actualizacin de Ticket ${me}

Estimado/a ${Ee},

El estado de tu ticket ha sido actualizado.

Nmero de Ticket: ${me}
Asunto: ${ye}
Estado Anterior: ${he}
Estado Nuevo: ${V}

Puedes revisar el estado actualizado de tu ticket desde tu panel de cliente.

Saludos cordiales,
Equipo de Soporte`,type:"Notificacin",recipientType:"Cliente",module:"tickets",event:"ticketUpdate",metadata:{ticketId:S,ticketNumber:me,oldStatus:he,newStatus:V}})}if(be&&ce.priority==="Crtica"&&he!==V){console.log(" [ADMIN] Enviando email al administrador por cambio de estado crtico");const ie=`
            <h2>Cambio de Estado - Ticket ${me}</h2>
            <p>Se ha actualizado el estado de un ticket crtico.</p>
            <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
              <p><strong>Nmero de Ticket:</strong> ${me}</p>
              <p><strong>Cliente:</strong> ${Ee}${Pe?` (${Pe})`:""}</p>
              <p><strong>Asunto:</strong> ${ye}</p>
              <p><strong>Prioridad:</strong> ${ce.priority}</p>
              <p><strong>Estado Anterior:</strong> ${he}</p>
              <p><strong>Estado Nuevo:</strong> ${V}</p>
            </div>
          `;await ar({to:be,toName:(Re==null?void 0:Re.fromName)||"Administrador",subject:`Ticket ${me} - Estado Actualizado`,html:ie,text:`Cambio de Estado - Ticket ${me}

Se ha actualizado el estado de un ticket crtico.

Nmero de Ticket: ${me}
Cliente: ${Ee}${Pe?` (${Pe})`:""}
Asunto: ${ye}
Prioridad: ${ce.priority}
Estado Anterior: ${he}
Estado Nuevo: ${V}`,type:"Notificacin",recipientType:"Administrador",module:"tickets",event:"ticketUpdate",metadata:{ticketId:S,ticketNumber:me,oldStatus:he,newStatus:V,priority:ce.priority}})}console.log(" [ADMIN] Notificaciones por cambio de estado completadas")}catch(me){console.error(" [ADMIN] Error sending status change notification emails:",me)}e(`Estado del ticket actualizado a ${V}`,"success")}catch(ee){console.error("Error updating ticket status:",ee),e("Error al actualizar el estado del ticket","error")}},L=async(S,V)=>{try{const ee=dt(Be,"artifacts",Fe,"public","data","tickets",S),re=await vs(ee);if(!re.exists()){e("Ticket no encontrado","error");return}const ce={id:re.id,...re.data()},he=ce.assignedTo,me=ce.assignedToName,ye=V?"Admin Actual":null;await gr(ee,{assignedTo:V,assignedToName:ye,updatedAt:ht.now()});try{console.log(" [ADMIN] Iniciando envo de notificaciones por asignacin de ticket"),await fr();const Ee=ce.ticketNumber,Pe=ce.subject,Re=ce.clientName||"Cliente",be=ce.clientEmail,ie=await fr(),Ge=ie==null?void 0:ie.fromEmail;if(be&&V&&!he){console.log(" [ADMIN] Enviando email al cliente por asignacin:",be);const it=`
            <h2>Ticket ${Ee} Asignado</h2>
            <p>Estimado/a <strong>${Re}</strong>,</p>
            <p>Tu ticket ha sido asignado a un agente de soporte que se encargar de resolver tu consulta.</p>
            <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
              <p><strong>Nmero de Ticket:</strong> ${Ee}</p>
              <p><strong>Asunto:</strong> ${Pe}</p>
              <p><strong>Asignado a:</strong> ${ye||"Agente de Soporte"}</p>
            </div>
            <p>Recibirs una respuesta pronto. Puedes hacer seguimiento desde tu panel de cliente.</p>
            <p>Saludos cordiales,<br>Equipo de Soporte</p>
          `;await ar({to:be,toName:Re,subject:`Ticket ${Ee} - Asignado a Agente`,html:it,text:`Ticket ${Ee} Asignado

Estimado/a ${Re},

Tu ticket ha sido asignado a un agente de soporte que se encargar de resolver tu consulta.

Nmero de Ticket: ${Ee}
Asunto: ${Pe}
Asignado a: ${ye||"Agente de Soporte"}

Recibirs una respuesta pronto. Puedes hacer seguimiento desde tu panel de cliente.

Saludos cordiales,
Equipo de Soporte`,type:"Notificacin",recipientType:"Cliente",module:"tickets",event:"ticketUpdate",metadata:{ticketId:S,ticketNumber:Ee,action:"assigned",assignedTo:ye}})}if(Ge&&!V&&he){console.log(" [ADMIN] Enviando email al administrador por desasignacin");const it=`
            <h2>Ticket ${Ee} Desasignado</h2>
            <p>Se ha desasignado un ticket que requiere atencin.</p>
            <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
              <p><strong>Nmero de Ticket:</strong> ${Ee}</p>
              <p><strong>Cliente:</strong> ${Re}${be?` (${be})`:""}</p>
              <p><strong>Asunto:</strong> ${Pe}</p>
              <p><strong>Estado:</strong> ${ce.status}</p>
              <p><strong>Prioridad:</strong> ${ce.priority}</p>
            </div>
            <p>Por favor, asigna el ticket a un agente desde el panel de administracin.</p>
          `;await ar({to:Ge,toName:(ie==null?void 0:ie.fromName)||"Administrador",subject:`Ticket ${Ee} - Desasignado`,html:it,text:`Ticket ${Ee} Desasignado

Se ha desasignado un ticket que requiere atencin.

Nmero de Ticket: ${Ee}
Cliente: ${Re}${be?` (${be})`:""}
Asunto: ${Pe}
Estado: ${ce.status}
Prioridad: ${ce.priority}

Por favor, asigna el ticket a un agente desde el panel de administracin.`,type:"Notificacin",recipientType:"Administrador",module:"tickets",event:"ticketUpdate",metadata:{ticketId:S,ticketNumber:Ee,action:"unassigned"}})}console.log(" [ADMIN] Notificaciones por asignacin completadas")}catch(Ee){console.error(" [ADMIN] Error sending assignment notification emails:",Ee)}e(V?"Ticket asignado correctamente":"Ticket desasignado correctamente","success")}catch(ee){console.error("Error assigning ticket:",ee),e("Error al asignar el ticket","error")}},E=S=>{b(S),R(!0)},M=async S=>{try{await vl(dt(Be,"artifacts",Fe,"public","data","tickets",S));const V=An(Ut(Be,"artifacts",Fe,"public","data","ticketMessages"),ur("ticketId","==",S)),re=(await Na(V)).docs.map(ce=>vl(ce.ref));await Promise.all(re),e("Ticket eliminado exitosamente","success")}catch(V){console.error("Error deleting ticket:",V),e("Error al eliminar el ticket","error")}},G=async S=>{S.preventDefault(),console.log(" [ADMIN] handleCreateTicket llamado - Iniciando creacin de ticket");try{console.log(" [ADMIN] Creando ticket en Firestore...");const V={...le,ticketNumber:`TKT-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,status:"Abierto",assignedTo:null,assignedToName:null,createdAt:ht.now(),updatedAt:ht.now(),lastReplyAt:ht.now(),lastReplyBy:"Cliente",replyCount:0,attachments:[]},re=(await Sa(Ut(Be,"artifacts",Fe,"public","data","tickets"),V)).id;console.log(" [ADMIN] Ticket creado con ID:",re);try{console.log(" [ADMIN] Iniciando envo de notificaciones por email para ticket:",re),await fr(),console.log(" [ADMIN] Configuracin de email cargada");const ce=V.clientName||"Cliente",he=V.clientEmail,me=V.ticketNumber,ye=V.subject,Ee=V.description,Pe=V.department,Re=V.priority;if(he){console.log(" [ADMIN] Enviando email al cliente:",he);const Ge=`
            <h2>Ticket Creado Exitosamente</h2>
            <p>Estimado/a <strong>${ce}</strong>,</p>
            <p>Hemos recibido tu ticket de soporte. Nuestro equipo lo revisar y te responder pronto.</p>
            <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
              <p><strong>Nmero de Ticket:</strong> ${me}</p>
              <p><strong>Asunto:</strong> ${ye}</p>
              <p><strong>Departamento:</strong> ${Pe}</p>
              <p><strong>Prioridad:</strong> ${Re}</p>
              <p><strong>Descripcin:</strong></p>
              <p style="white-space: pre-wrap;">${Ee}</p>
            </div>
            <p>Puedes hacer seguimiento a tu ticket desde tu panel de cliente.</p>
            <p>Saludos cordiales,<br>Equipo de Soporte</p>
          `,it=await ar({to:he,toName:ce,subject:`Ticket Creado - ${me}`,html:Ge,text:`Ticket Creado Exitosamente

Estimado/a ${ce},

Hemos recibido tu ticket de soporte. Nuestro equipo lo revisar y te responder pronto.

Nmero de Ticket: ${me}
Asunto: ${ye}
Departamento: ${Pe}
Prioridad: ${Re}

Descripcin:
${Ee}

Puedes hacer seguimiento a tu ticket desde tu panel de cliente.

Saludos cordiales,
Equipo de Soporte`,type:"Notificacin",recipientType:"Cliente",module:"tickets",event:"ticketReply",metadata:{ticketId:re,ticketNumber:me}});console.log(" [ADMIN] Resultado email cliente:",it)}else console.log(" [ADMIN] No se envi email al cliente - no hay email configurado");const be=await fr(),ie=be==null?void 0:be.fromEmail;if(console.log(" [ADMIN] Email del administrador desde config:",ie),ie){console.log(" [ADMIN] Enviando email al administrador:",ie);const Ge=`
            <h2>Nuevo Ticket Creado</h2>
            <p>Se ha creado un nuevo ticket de soporte que requiere atencin.</p>
            <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
              <p><strong>Nmero de Ticket:</strong> ${me}</p>
              <p><strong>Cliente:</strong> ${ce}${he?` (${he})`:""}</p>
              <p><strong>Asunto:</strong> ${ye}</p>
              <p><strong>Departamento:</strong> ${Pe}</p>
              <p><strong>Prioridad:</strong> ${Re}</p>
              <p><strong>Descripcin:</strong></p>
              <p style="white-space: pre-wrap;">${Ee}</p>
            </div>
            <p>Por favor, revisa y asigna el ticket desde el panel de administracin.</p>
          `,it=await ar({to:ie,toName:(be==null?void 0:be.fromName)||"Administrador",subject:`Nuevo Ticket - ${me} - ${ye}`,html:Ge,text:`Nuevo Ticket Creado

Se ha creado un nuevo ticket de soporte que requiere atencin.

Nmero de Ticket: ${me}
Cliente: ${ce}${he?` (${he})`:""}
Asunto: ${ye}
Departamento: ${Pe}
Prioridad: ${Re}

Descripcin:
${Ee}

Por favor, revisa y asigna el ticket desde el panel de administracin.`,type:"Notificacin",recipientType:"Administrador",module:"tickets",event:"newTicket",metadata:{ticketId:re,ticketNumber:me,clientEmail:he,clientName:ce}});console.log(" [ADMIN] Resultado email administrador:",it),console.log(" [ADMIN] Notificaciones por email completadas")}else console.log(" [ADMIN] No se envi email al administrador - no hay email configurado en fromEmail")}catch(ce){console.error(" [ADMIN] Error sending ticket notification emails:",ce),console.error(" [ADMIN] Detalles del error:",ce.message,ce.stack)}e("Ticket creado exitosamente","success"),Z(!1),U({subject:"",department:"Soporte Tcnico",priority:"Media",description:"",clientId:"",clientName:"",clientEmail:""})}catch(V){console.error("Error creating ticket:",V),e("Error al crear el ticket","error")}},K=S=>({Abierto:"bg-red-100 text-red-800","En Progreso":"bg-yellow-100 text-yellow-800",Respondido:"bg-blue-100 text-blue-800",Cerrado:"bg-gray-100 text-gray-800","Esperando Cliente":"bg-orange-100 text-orange-800"})[S]||"bg-gray-100 text-gray-800",z=S=>({Baja:"bg-green-100 text-green-800",Media:"bg-yellow-100 text-yellow-800",Alta:"bg-orange-100 text-orange-800",Crtica:"bg-red-100 text-red-800"})[S]||"bg-gray-100 text-gray-800",q=S=>({"Soporte Tcnico":"bg-blue-100 text-blue-800",Facturacin:"bg-green-100 text-green-800",Ventas:"bg-purple-100 text-purple-800",General:"bg-gray-100 text-gray-800"})[S]||"bg-gray-100 text-gray-800",H=S=>S?new Date(S.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",X=S=>{switch(S){case"Abierto":return a.jsx(hs,{});case"En Progreso":return a.jsx(hs,{});case"Respondido":return a.jsx(cA,{});case"Cerrado":return a.jsx(ap,{});case"Esperando Cliente":return a.jsx(yh,{});default:return a.jsx(hs,{})}},ne=S=>{if(!S)return"--";const V=new Date,ee=new Date(S.seconds*1e3),re=V.getTime()-ee.getTime(),ce=Math.floor(re/(1e3*60*60*24)),he=Math.floor(re/(1e3*60*60)),me=Math.floor(re/(1e3*60));return ce>0?`hace ${ce} da${ce>1?"s":""}`:he>0?`hace ${he} hora${he>1?"s":""}`:me>0?`hace ${me} minuto${me>1?"s":""}`:"hace unos segundos"},w=n.filter(S=>{const V=o===""||S.ticketNumber.toLowerCase().includes(o.toLowerCase())||S.subject.toLowerCase().includes(o.toLowerCase())||S.clientName.toLowerCase().includes(o.toLowerCase())||S.clientEmail.toLowerCase().includes(o.toLowerCase())||S.description.toLowerCase().includes(o.toLowerCase()),ee=c==="Todos"||S.status===c,re=f==="Todos"||S.priority===f,ce=g==="Todos"||S.department===g;return V&&ee&&re&&ce});return T?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(ic,{}),"Sistema de Tickets"]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"text-sm text-gray-500",children:[w.length," ticket",w.length!==1?"s":""," encontrado",w.length!==1?"s":""]}),a.jsxs("button",{onClick:()=>Z(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[a.jsx(Vh,{}),"Nuevo Ticket"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:a.jsx(hs,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Abiertos"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.filter(S=>S.status==="Abierto").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:a.jsx(hs,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"En Progreso"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.filter(S=>S.status==="En Progreso").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:a.jsx(yh,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Esperando Cliente"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.filter(S=>S.status==="Esperando Cliente").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:a.jsx(ap,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Crticos"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.filter(S=>S.priority==="Crtica").length})]})]})})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar por nmero, asunto, cliente...",value:o,onChange:S=>l(S.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Vu,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:c,onChange:S=>u(S.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:j.map(S=>a.jsx("option",{value:S,children:S},S))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(uu,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:f,onChange:S=>v(S.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:_.map(S=>a.jsx("option",{value:S,children:S},S))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(uu,{})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:g,onChange:S=>p(S.target.value),className:"pl-10 pr-4 py-2 border rounded-full w-full appearance-none bg-white",children:F.map(S=>a.jsx("option",{value:S,children:S},S))}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(uu,{})})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Ticket","Cliente","Asunto","Estado","Prioridad","Departamento","Asignado","ltima Actividad","Respuestas","Acciones"].map(S=>a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:S},S))})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map(S=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:S.ticketNumber}),a.jsx("div",{className:"text-xs text-gray-500",children:H(S.createdAt)})]}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:S.clientName}),a.jsx("div",{className:"text-sm text-gray-500",children:S.clientEmail})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",title:S.subject,children:S.subject}),a.jsx("div",{className:"text-xs text-gray-500 max-w-xs truncate",title:S.description,children:S.description})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${K(S.status)}`,children:S.status}),a.jsx("div",{className:"ml-2 text-gray-400",children:X(S.status)})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${z(S.priority)}`,children:S.priority})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${q(S.department)}`,children:S.department})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:S.assignedToName||"Sin asignar"}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[a.jsx("div",{children:ne(S.lastReplyAt)}),a.jsxs("div",{className:"text-xs text-gray-400",children:["por ",S.lastReplyBy]})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(op,{}),a.jsx("span",{className:"ml-1",children:S.replyCount})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("button",{onClick:()=>E(S),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md",title:"Ver ticket completo",children:a.jsx(yl,{})}),t==="superadmin"&&a.jsxs(Bh,{children:[a.jsx("select",{value:S.status,onChange:V=>A(S.id,V.target.value),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 border-none bg-transparent",children:j.filter(V=>V!=="Todos").map(V=>a.jsx("option",{value:V,children:V},V))}),a.jsx("button",{onClick:()=>L(S.id,S.assignedTo?null:"admin"),className:"block w-full text-left px-4 py-2 text-sm text-blue-700 hover:bg-blue-50",children:S.assignedTo?"Desasignar":"Asignar"}),a.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50",children:"Responder"}),a.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-orange-700 hover:bg-orange-50",children:"Cerrar Ticket"}),a.jsx("button",{onClick:()=>{window.confirm("Ests seguro de que quieres eliminar este ticket? Esta accin no se puede deshacer.")&&M(S.id)},className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"Eliminar Ticket"})]})]})})]},S.id))})]})}),w.length===0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(ic,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron tickets"}),a.jsx("p",{className:"text-gray-500",children:"No hay tickets que coincidan con los filtros seleccionados."})]}),P&&C&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:["Ticket ",C.ticketNumber]}),a.jsx("button",{onClick:()=>R(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cliente"}),a.jsx("div",{className:"text-sm text-gray-900",children:C.clientName}),a.jsx("div",{className:"text-sm text-gray-500",children:C.clientEmail})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Asignado a"}),a.jsx("div",{className:"text-sm text-gray-900",children:C.assignedToName||"Sin asignar"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${K(C.status)}`,children:C.status})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prioridad"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${z(C.priority)}`,children:C.priority})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Departamento"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${q(C.department)}`,children:C.department})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Creado"}),a.jsx("div",{className:"text-sm text-gray-900",children:H(C.createdAt)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto"}),a.jsx("div",{className:"text-sm text-gray-900 p-3 bg-gray-50 rounded-md",children:C.subject})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin"}),a.jsx("div",{className:"text-sm text-gray-900 p-4 bg-gray-50 rounded-md whitespace-pre-wrap",children:C.description})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Historial de Mensajes"}),a.jsx("div",{className:"border border-gray-200 rounded-md p-4",children:a.jsx(iS,{ticketId:C.id,userRole:t,currentUser:{uid:"admin",displayName:"Admin",email:"admin@empresa.com"}})})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{onClick:()=>R(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cerrar"}),t==="superadmin"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Responder"}),a.jsx("button",{onClick:()=>{window.confirm("Ests seguro de que quieres eliminar este ticket? Esta accin no se puede deshacer.")&&(M(C.id),R(!1))},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Eliminar Ticket"})]})]})]})]})}),D&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Crear Nuevo Ticket"}),a.jsx("button",{onClick:()=>Z(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("form",{onSubmit:G,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cliente"}),a.jsxs("select",{value:le.clientId,onChange:S=>{const V=i.find(ee=>ee.id===S.target.value);U(ee=>({...ee,clientId:S.target.value,clientName:(V==null?void 0:V.fullName)||"",clientEmail:(V==null?void 0:V.email)||""}))},className:"w-full p-2 border rounded-md",required:!0,children:[a.jsx("option",{value:"",children:"Seleccionar cliente"}),i.map(S=>a.jsxs("option",{value:S.id,children:[S.fullName," (",S.email,")"]},S.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento"}),a.jsx("select",{value:le.department,onChange:S=>U(V=>({...V,department:S.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:F.filter(S=>S!=="Todos").map(S=>a.jsx("option",{value:S,children:S},S))})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridad"}),a.jsx("select",{value:le.priority,onChange:S=>U(V=>({...V,priority:S.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:_.filter(S=>S!=="Todos").map(S=>a.jsx("option",{value:S,children:S},S))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email del Cliente"}),a.jsx("input",{type:"email",value:le.clientEmail,onChange:S=>U(V=>({...V,clientEmail:S.target.value})),className:"w-full p-2 border rounded-md",placeholder:"email@ejemplo.com",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto *"}),a.jsx("input",{type:"text",value:le.subject,onChange:S=>U(V=>({...V,subject:S.target.value})),className:"w-full p-2 border rounded-md",placeholder:"Describe brevemente el problema o consulta",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin *"}),a.jsx("textarea",{value:le.description,onChange:S=>U(V=>({...V,description:S.target.value})),className:"w-full p-2 border rounded-md",rows:6,placeholder:"Describe el problema o consulta en detalle...",required:!0})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>Z(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Crear Ticket"})]})]})]})})]})}function AO({onLogout:t}){const{addNotification:e}=pn(),[n,r]=ue.useState({}),i="company_info";ue.useEffect(()=>{const l=dt(Be,"artifacts",Fe,"public","data","settings",i);return Gt(l,u=>{u.exists()&&r(u.data())})},[]);const s=l=>{const{name:c,value:u}=l.target;r(f=>({...f,[c]:u}))},o=async()=>{try{const l=dt(Be,"artifacts",Fe,"public","data","settings",i);await ws(l,n,{merge:!0}),e("Configuracin de la empresa guardada.","success")}catch{e("Error al guardar la configuracin.","error")}};return a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Configuracin"}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md max-w-4xl mx-auto space-y-8",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Informacin de Facturacin y Contacto"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx("input",{name:"companyName",value:n.companyName||"",onChange:s,placeholder:"Nombre de la Empresa",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"identification",value:n.identification||"",onChange:s,placeholder:"NIT / Identificacin Fiscal",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"address",value:n.address||"",onChange:s,placeholder:"Direccin",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"phone",value:n.phone||"",onChange:s,placeholder:"Telfono",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"email",type:"email",value:n.email||"",onChange:s,placeholder:"Email de Contacto",className:"w-full p-2 border rounded-md"}),a.jsx("input",{name:"website",value:n.website||"",onChange:s,placeholder:"Sitio Web",className:"w-full p-2 border rounded-md"})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mt-8 mb-4",children:"Seguridad"}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-[300px]",children:[a.jsx("p",{className:"font-medium text-gray-800 mb-2",children:"Tiempo de Inactividad (minutos)"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Tiempo mximo de inactividad antes de cerrar sesin automticamente. Mnimo: 1 minuto, Mximo: 120 minutos."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",name:"inactivityTimeoutMinutes",value:n.inactivityTimeoutMinutes||10,onChange:s,min:"1",max:"120",className:"w-24 p-2 border border-gray-300 rounded-md text-center focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"10"}),a.jsx("span",{className:"text-gray-600 font-medium",children:"min"})]})]}),a.jsxs("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded",children:[a.jsxs("p",{className:"text-sm text-blue-800 font-medium",children:[a.jsx("strong",{children:" Configuracin Actual:"})," ",n.inactivityTimeoutMinutes||10," minutos de inactividad"]}),a.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"La sesin se cerrar automticamente si no hay actividad del usuario (movimiento del mouse, teclado, clics, scroll)."})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mt-8 mb-4",children:"Branding"}),a.jsx("input",{name:"logoUrl",value:n.logoUrl||"",onChange:s,placeholder:"URL del Logo (enlace a la imagen)",className:"w-full p-2 border rounded-md"}),n.logoUrl&&a.jsx("img",{src:n.logoUrl,alt:"Vista previa del logo",className:"mt-4 max-h-20 bg-gray-100 p-2 rounded"})]}),a.jsx("button",{onClick:o,className:"mt-4 px-5 py-2 bg-blue-600 text-white font-semibold rounded-md shadow-sm hover:bg-blue-700",children:"Guardar Configuracin"})]})]})}function SO({user:t,userRole:e,companySettings:n,onLogout:r}){const[i,s]=ue.useState("services");ue.useEffect(()=>{const l=["services","users","templates","messages","payments","tickets","payment-config","settings"],c=()=>{const f=(window.location.hash||"").replace("#","");l.includes(f)&&s(f)},u=(window.location.hash||"").replace("#","");return l.includes(u)?s(u):(!window.location.hash||window.location.hash==="#")&&(window.history.replaceState(null,"","#services"),s("services")),window.addEventListener("hashchange",c),()=>window.removeEventListener("hashchange",c)},[]),ue.useEffect(()=>{const l=(window.location.hash||"").replace("#","");i&&l!==i&&window.history.pushState(null,"",`#${i}`)},[i]),ue.useEffect(()=>{const l=c=>{const u=(window.location.hash||"").replace("#","");["services","users","templates","messages","payments","tickets","payment-config","settings"].includes(u)?s(u):s("services")};return window.addEventListener("popstate",l),()=>window.removeEventListener("popstate",l)},[]);const o=()=>{switch(i){case"users":return a.jsx(k8,{userRole:e,companySettings:n});case"templates":return a.jsx(T8,{});case"messages":return a.jsx(_O,{userRole:e});case"tickets":return a.jsx(EO,{userRole:e});case"payments":return a.jsx(bO,{userRole:e,companySettings:n});case"payment-config":return a.jsx(hA,{});case"settings":return a.jsx(AO,{onLogout:r});case"services":default:return a.jsx(b8,{userRole:e})}};return a.jsxs("main",{className:"container mx-auto",children:[a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-8 px-4 sm:px-6 lg:px-8","aria-label":"Tabs",children:[a.jsxs("button",{onClick:()=>s("services"),className:`${i==="services"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(sp,{})," Servicios"]}),e==="superadmin"&&a.jsxs("button",{onClick:()=>s("users"),className:`${i==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(l8,{})," Usuarios"]}),a.jsxs("button",{onClick:()=>s("templates"),className:`${i==="templates"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(lA,{})," Plantillas"]}),a.jsxs("button",{onClick:()=>s("messages"),className:`${i==="messages"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(om,{})," Mensajes"]}),a.jsxs("button",{onClick:()=>s("payments"),className:`${i==="payments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(Ji,{})," Pagos"]}),a.jsxs("button",{onClick:()=>s("tickets"),className:`${i==="tickets"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(ic,{})," Tickets"]}),e==="superadmin"&&a.jsxs("button",{onClick:()=>s("settings"),className:`${i==="settings"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(c8,{})," Empresa"]})]})}),o()]})}function kO({isOpen:t,onClose:e,onConfirm:n,service:r,paymentType:i,warningMessage:s}){if(!t)return null;const o=()=>i==="One-Time"?a.jsx(Ji,{className:"h-8 w-8 text-blue-600"}):a.jsx(ul,{className:"h-8 w-8 text-green-600"}),l=()=>i==="One-Time"?"Solicitar Pago nico":"Solicitar Pago de Renovacin",c=()=>i==="One-Time"?"Esta es una solicitud de pago nico que no se renovar automticamente":"Esta solicitud renovar tu servicio por el perodo seleccionado",u=()=>i==="One-Time"?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"bg-green-600 hover:bg-green-700 focus:ring-green-500";return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 transform transition-all",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"flex-shrink-0",children:o()}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:l()}),a.jsx("p",{className:"text-sm text-gray-500",children:c()})]})]})}),a.jsxs("div",{className:"px-6 py-4",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:r.serviceType}),a.jsxs("span",{className:"text-sm font-semibold text-gray-600",children:[r.currency," ",r.amount.toFixed(2)]})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:r.description}),a.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[a.jsxs("span",{children:["Nmero: ",r.serviceNumber]}),i!=="One-Time"&&a.jsxs("span",{children:["Ciclo: ",r.billingCycle]})]})]}),a.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(m8,{className:"h-5 w-5 text-amber-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-medium text-amber-800 mb-1",children:"Informacin Importante"}),a.jsx("p",{className:"text-sm text-amber-700",children:s})]})]})}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Tipo de Pago:"}),a.jsx("span",{className:"font-medium text-gray-900",children:i==="One-Time"?"Pago nico":"Renovacin"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Monto:"}),a.jsxs("span",{className:"font-medium text-gray-900",children:[r.currency," ",r.amount.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Mtodo de Pago:"}),a.jsx("span",{className:"font-medium text-gray-900",children:"Transferencia Bancaria"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Estado Inicial:"}),a.jsx("span",{className:"font-medium text-amber-600",children:"Pendiente"})]})]})]}),a.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-2xl flex justify-end space-x-3",children:[a.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors",children:"Cancelar"}),a.jsx("button",{onClick:n,className:`px-6 py-2 text-sm font-medium text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors ${u()}`,children:i==="One-Time"?"Solicitar Pago nico":"Solicitar Renovacin"})]})]})})}function TO({user:t,userProfile:e}){const{addNotification:n}=pn(),[r,i]=ue.useState([]),[s,o]=ue.useState(!0),[l,c]=ue.useState(new Set),[u,f]=ue.useState(new Set),[v,g]=ue.useState({}),[p,T]=ue.useState(null),[k,C]=ue.useState({isOpen:!1,service:null}),[b,P]=ue.useState(null),R=E=>{if(!E.dueDate||!E.billingCycle||E.billingCycle==="One-Time")return E.expirationDate?new Date(E.expirationDate.seconds*1e3):null;const M=new Date(E.dueDate.seconds*1e3);let G=new Date(M);switch(E.billingCycle){case"Monthly":G.setMonth(G.getMonth()+1);break;case"Semiannually":G.setMonth(G.getMonth()+6);break;case"Annually":G.setFullYear(G.getFullYear()+1);break;case"Biennially":G.setFullYear(G.getFullYear()+2);break;case"Triennially":G.setFullYear(G.getFullYear()+3);break;default:return null}return G},D=E=>{const M=R(E);return M?M.toLocaleDateString():"N/A"},Z=E=>({"One-Time":"Pago nico",Monthly:"Mensual",Semiannually:"Semestral",Annually:"Anual",Biennially:"Bianual",Triennially:"Trienal",Custom:"Personalizado"})[E]||E,le=E=>{if(l.has(E.id)){n("Ya se est solicitando un pago para este servicio","warning");return}if(u.has(E.id)){n("Ya existe una solicitud de pago pendiente para este servicio","warning");return}C({isOpen:!0,service:E})},U=async E=>{c(M=>new Set(M).add(E.id));try{let M;if(E.billingCycle==="One-Time")M=E.dueDate?new Date(E.dueDate.seconds*1e3):new Date,M.setDate(M.getDate()+30);else{const ne=R(E);ne?M=ne:M=new Date(Date.now()+30*24*60*60*1e3)}let K=b?(ne=>{if(!ne)return null;if(ne.gateways)return ne.gateways;const{bold:w,paypal:S,payu:V,bankTransfer:ee}=ne,re={};return w&&(re.bold={name:"Bold",...w}),S&&(re.paypal={name:"PayPal",...S}),V&&(re.payu={name:"PayU",...V}),ee&&(re.bankTransfer={name:"Transferencia Bancaria",...ee}),re})(b):null;K||(K={bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}});const z=K?Object.values(K).filter(ne=>ne.enabled):[];let q="Transferencia Bancaria",H="Transferencia Bancaria";z.length===1?(q=z[0].name,H=z[0].name):z.length>1&&(q="Pendiente de Seleccin",H=E.billingCycle==="One-Time"?"Pago nico":"Renovacin");const X={serviceId:E.id,serviceNumber:E.serviceNumber,serviceType:E.serviceType,description:E.description,amount:E.amount,currency:E.currency,status:"Pendiente",gateway:q,userId:t.uid,clientName:(e==null?void 0:e.fullName)||"Cliente",clientEmail:t.email,dueDate:ht.fromDate(M),createdAt:ht.now(),paymentMethod:H,notes:`Solicitud de pago automtica para servicio ${E.serviceNumber} - Ciclo: ${Z(E.billingCycle)}`,billingCycle:E.billingCycle,isAutoGenerated:!0,originalServiceDueDate:E.dueDate?E.dueDate.toDate?E.dueDate:ht.fromDate(new Date(E.dueDate)):null,paymentType:E.billingCycle==="One-Time"?"Pago nico":"Renovacin"};await Sa(Ut(Be,"artifacts",Fe,"public","data","payments"),X),n("Solicitud de pago creada exitosamente. Revisa la seccin de pagos.","success"),C({isOpen:!1,service:null})}catch(M){console.error("Error generating payment:",M),n("Error al crear la solicitud de pago. Intenta nuevamente.","error")}finally{c(M=>{const G=new Set(M);return G.delete(E.id),G})}},j=E=>{localStorage.setItem("selectedServiceForRenewal",JSON.stringify({id:E.id,serviceNumber:E.serviceNumber,serviceType:E.serviceType,description:E.description,amount:E.amount,currency:E.currency,billingCycle:E.billingCycle,dueDate:E.dueDate})),window.location.hash==="#renewals"?(window.location.hash="",setTimeout(()=>{window.location.hash="renewals"},50)):window.location.hash="renewals",n("Redirigiendo a renovaciones para este servicio","success")};ue.useEffect(()=>{if(!(t!=null&&t.uid))return;const E=An(Ut(Be,"artifacts",Fe,"public","data","payments"),ur("userId","==",t.uid)),M=Gt(E,G=>{const K=new Set,z={},q=new Set(["Pendiente","Procesando"]);G.docs.forEach(H=>{const X=H.data();X.serviceId&&q.has(X.status)&&(K.add(X.serviceId),z[X.serviceId]={id:H.id,...X})}),f(K),g(z)});return()=>M()},[t==null?void 0:t.uid]),ue.useEffect(()=>{const E=dt(Be,"artifacts",Fe,"public","data","settings","paymentConfig"),M=Gt(E,G=>{G.exists()?P(G.data()):P({gateways:{bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}}})});return()=>M()},[]),ue.useEffect(()=>{const E=dt(Be,"artifacts",Fe,"public","data","settings","renewalConfig"),M=Gt(E,G=>{G.exists()&&T(G.data())});return()=>M()},[]);const _=E=>{if(!E||E.billingCycle==="One-Time")return null;const M=R(E);if(!M)return null;const G=new Date;return Math.ceil((M.getTime()-G.getTime())/(1e3*60*60*24))};ue.useEffect(()=>{if(!(p!=null&&p.renewalSettings)||!(t!=null&&t.uid))return;const E=Number(p.renewalSettings.reminderDays??0),M=Number(p.renewalSettings.gracePeriodDays??0);(async()=>{for(const K of r){if(!K||K.billingCycle==="One-Time")continue;const z=_(K);if(z!=null){if(z<=E&&z>=-M&&!u.has(K.id))try{await U(K)}catch(q){console.error("Auto-generate payment failed:",q)}if(z<-M){const q=v[K.id];if(q!=null&&q.id)try{await gr(dt(Be,"artifacts",Fe,"public","data","payments",q.id),{status:"Cancelado",updatedAt:new Date,cancelReason:"Periodo de gracia agotado"}),n(`Solicitud de pago cancelada por perodo de gracia (${K.serviceNumber})`,"warning")}catch(H){console.error("Auto-cancel payment failed:",H)}}}}})()},[r,p,u,v,t==null?void 0:t.uid]),ue.useEffect(()=>{if(!(t!=null&&t.uid)){o(!1);return}const E=An(Ut(Be,"artifacts",Fe,"public","data","services"),ur("assignedUserId","==",t.uid)),M=Gt(E,G=>{const K=G.docs.map(z=>({id:z.id,...z.data()}));K.sort((z,q)=>{var ne,w;const H=((ne=z.createdAt)==null?void 0:ne.seconds)||0;return(((w=q.createdAt)==null?void 0:w.seconds)||0)-H}),i(K),o(!1)},G=>{console.error("Error loading services:",G),n("Error al cargar los servicios","error"),o(!1)});return()=>M()},[t==null?void 0:t.uid,n]);const F=E=>({Activo:"bg-green-100 text-green-800","Periodo de Gracia Vencido":"bg-yellow-100 text-yellow-800","Pendiente Pago":"bg-red-100 text-red-800",Pago:"bg-blue-100 text-blue-800",Cancelado:"bg-gray-100 text-gray-800"})[E]||"bg-gray-100 text-gray-800",A=E=>E?new Date(E.seconds*1e3).toLocaleDateString("es-ES"):"--",L=(E,M)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:M||"USD"}).format(E);return s?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(sp,{}),"Mis Servicios Contratados"]}),a.jsxs("div",{className:"text-sm text-gray-500",children:[r.length," servicio",r.length!==1?"s":""," encontrado",r.length!==1?"s":""]})]}),r.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(sp,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes servicios asignados"}),a.jsx("p",{className:"text-gray-500",children:"Contacta al administrador para que te asigne servicios."})]}):a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:["Nmero","Servicio","Descripcin","Monto","Estado","Ciclo","Fecha de Inicio","Fecha de Vencimiento","Notas","Acciones"].map(E=>a.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:E},E))})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(E=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"font-mono text-sm font-medium text-blue-600",children:E.serviceNumber||"N/A"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"font-medium text-gray-900",children:E.serviceType})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"text-gray-900",children:E.description})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"font-medium text-gray-900",children:L(E.amount,E.currency)})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${F(E.status)}`,children:E.status})}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:Z(E.billingCycle)}),E.billingCycle==="Custom"&&E.customBillingCycle&&a.jsxs("div",{className:"text-xs text-gray-500",children:["(",E.customBillingCycle,")"]})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm text-gray-900",children:A(E.dueDate)}),a.jsx("div",{className:"text-xs text-gray-500",children:"Inicio"})]}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:D(E)}),a.jsx("div",{className:"text-xs text-gray-500",children:"Vencimiento"})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"text-gray-600 text-sm max-w-xs truncate",children:E.clientNotes||"--"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"flex items-center space-x-2",children:u.has(E.id)?a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-xs text-orange-600 font-medium mb-1",children:"Por pagar"}),a.jsxs("button",{onClick:()=>window.location.href="#payments",className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700",title:"Ir a Pago",children:[a.jsx(yl,{className:"h-4 w-4 mr-1"}),"Ir a Pago"]})]}):a.jsxs("div",{className:"flex flex-col space-y-2",children:[a.jsxs("button",{onClick:()=>{const M=_(E);if(E.billingCycle!=="One-Time"&&(M==null||p!=null&&p.renewalSettings&&M>(p.renewalSettings.reminderDays??0))){j(E);return}le(E)},disabled:l.has(E.id),className:`inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${l.has(E.id)?"text-gray-400 bg-gray-200 cursor-not-allowed":"text-white bg-blue-600 hover:bg-blue-700"}`,title:l.has(E.id)?"Creando solicitud...":E.billingCycle==="One-Time"?"Solicitar de Nuevo":"Solicitar de Nuevo (ir a Renovaciones fuera de ventana)",children:[a.jsx(Ji,{className:"h-4 w-4 mr-1"}),l.has(E.id)?"Creando...":u.has(E.id)?"Ir a Pago":"Solicitar de Nuevo"]}),E.billingCycle!=="One-Time"&&a.jsxs("button",{onClick:()=>j(E),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",title:"Aumentar ciclo de este servicio",children:[a.jsx(ul,{className:"h-4 w-4 mr-1"}),"Aumentar Ciclo"]})]})})})]},E.id))})]})}),k.isOpen&&k.service&&a.jsx(kO,{isOpen:k.isOpen,onClose:()=>C({isOpen:!1,service:null}),onConfirm:()=>U(k.service),service:k.service,paymentType:k.service.billingCycle,warningMessage:k.service.billingCycle==="One-Time"?`Se crear una solicitud de pago nico para el servicio "${k.service.serviceType}". La solicitud vencer en 30 das desde la fecha actual.`:`Se crear una solicitud de pago de renovacin para el servicio "${k.service.serviceType}" con ciclo ${Z(k.service.billingCycle)}. La solicitud vencer en la fecha de vencimiento del servicio.`})]})}function jO({bankAccounts:t,serviceNumber:e,amount:n,currency:r,onUpload:i}){const s=(o,l)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:l||"USD"}).format(o);return!t||t.length===0?a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:a.jsx("p",{className:"text-yellow-800",children:"No hay cuentas bancarias configuradas. Contacta al administrador."})}):a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Ji,{}),a.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Instrucciones para Transferencia Bancaria"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Informacin del Pago"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Nmero de Servicio:"}),a.jsx("span",{className:"ml-2 font-mono text-blue-600",children:e})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Monto a Pagar:"}),a.jsx("span",{className:"ml-2 font-semibold text-green-600",children:s(n,r)})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Cuentas Disponibles para Transferencia"}),a.jsx("div",{className:"space-y-4",children:t.map((o,l)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h5",{className:"font-medium text-gray-700",children:["Opcin ",l+1]}),a.jsx("span",{className:"text-sm text-gray-500",children:o.accountType})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-600",children:"Banco:"}),a.jsx("span",{className:"ml-2 text-gray-800",children:o.bankName})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-600",children:"Nmero de Cuenta:"}),a.jsx("span",{className:"ml-2 font-mono text-blue-600",children:o.accountNumber})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("span",{className:"font-medium text-gray-600",children:"Titular:"}),a.jsx("span",{className:"ml-2 text-gray-800",children:o.accountHolder})]})]})]},o.id))})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Instrucciones Paso a Paso"}),a.jsxs("ol",{className:"space-y-2 text-sm text-gray-700",children:[a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"1"}),a.jsx("span",{children:"Realiza una transferencia bancaria a cualquiera de las cuentas mostradas arriba"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"2"}),a.jsxs("span",{children:["Usa el ",a.jsx("strong",{children:"Nmero de Servicio"})," como referencia en la transferencia"]})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"3"}),a.jsxs("span",{children:["Transfiere el monto exacto: ",a.jsx("strong",{children:s(n,r)})]})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"4"}),a.jsx("span",{children:"Guarda el comprobante de transferencia"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-semibold mr-3 mt-0.5",children:"5"}),a.jsx("span",{children:"Enva el comprobante por email o sube una foto en el sistema"})]})]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:" Informacin Importante"}),a.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[a.jsx("li",{children:" El pago puede tardar hasta 24 horas en ser procesado"}),a.jsx("li",{children:" Asegrate de incluir el nmero de servicio como referencia"}),a.jsx("li",{children:" El monto debe ser exacto para evitar retrasos"}),a.jsx("li",{children:" Contacta al administrador si tienes alguna duda"})]})]}),a.jsx("div",{className:"text-center",children:a.jsxs("label",{className:"inline-block px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium cursor-pointer",children:["Subir Comprobante de Transferencia",a.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:o=>{var l;return i&&((l=o.target.files)==null?void 0:l[0])&&i(o.target.files[0])}})]})})]})]})}function CO({user:t,userProfile:e,companySettings:n}){const{addNotification:r}=pn(),[i,s]=ue.useState([]),[o,l]=ue.useState(""),[c,u]=ue.useState("Todos"),[f,v]=ue.useState(!0),[g,p]=ue.useState([]),[T,k]=ue.useState(!1),[C,b]=ue.useState(null),[P,R]=ue.useState(null),[D,Z]=ue.useState({}),[le,U]=ue.useState(!1),[j,_]=ue.useState(null),F=()=>{if(!P)return null;if(P.gateways)return P.gateways;const{bold:w,paypal:S,payu:V,bankTransfer:ee}=P,re={};return w&&(re.bold={name:"Bold",...w}),S&&(re.paypal={name:"PayPal",...S}),V&&(re.payu={name:"PayU",...V}),ee&&(re.bankTransfer={name:"Transferencia Bancaria",...ee}),re},A=["Todos","Pendiente","Procesando","Completado","Fallido","Cancelado","Reembolsado"];ue.useEffect(()=>{const w=dt(Be,"artifacts",Fe,"public","data","settings","paymentConfig"),S=Gt(w,V=>{V.exists()?(R(V.data()),console.log("Payment config loaded:",V.data())):(console.log("No payment config found, using defaults"),R({gateways:{bold:{enabled:!0,name:"Bold",autoApprove:!1},paypal:{enabled:!0,name:"PayPal",autoApprove:!1},payu:{enabled:!0,name:"PayU",autoApprove:!1},bankTransfer:{enabled:!0,name:"Transferencia Bancaria",autoApprove:!1}},bankAccounts:[]}))},V=>{console.error("Error loading payment config:",V)});return()=>S()},[]),ue.useEffect(()=>{if(!(t!=null&&t.uid)){v(!1);return}const w=An(Ut(Be,"artifacts",Fe,"public","data","payments"),ur("userId","==",t.uid)),S=Gt(w,V=>{const ee=V.docs.map(re=>({id:re.id,...re.data()}));console.log("Payments loaded:",ee.length,ee),ee.sort((re,ce)=>{var ye,Ee;const he=((ye=re.createdAt)==null?void 0:ye.seconds)||0;return(((Ee=ce.createdAt)==null?void 0:Ee.seconds)||0)-he}),s(ee),v(!1)},V=>{console.error("Error loading payments:",V),r("Error al cargar los pagos","error"),v(!1)});return()=>S()},[t==null?void 0:t.uid,r]),ue.useEffect(()=>{const w=dt(Be,"artifacts",Fe,"public","data","settings","paymentConfig"),S=Gt(w,V=>{var ee;if(V.exists()){const re=V.data();(ee=re.bankTransfer)!=null&&ee.accounts&&p(re.bankTransfer.accounts)}});return()=>S()},[]);const L=i.filter(w=>{const S=o===""||w.serviceNumber&&w.serviceNumber.toLowerCase().includes(o.toLowerCase())||w.serviceType&&w.serviceType.toLowerCase().includes(o.toLowerCase())||w.serviceName&&w.serviceName.toLowerCase().includes(o.toLowerCase())||w.transactionId&&w.transactionId.toLowerCase().includes(o.toLowerCase()),V=c==="Todos"||w.status===c,ee=S&&V;return console.log("Payment filter:",{payment:w.id,serviceType:w.serviceType,serviceName:w.serviceName,status:w.status,searchTerm:o,statusFilter:c,matchesSearch:S,matchesStatus:V,result:ee}),ee}),E=w=>({Pendiente:"bg-yellow-100 text-yellow-800",Procesando:"bg-blue-100 text-blue-800",Completado:"bg-green-100 text-green-800",Fallido:"bg-red-100 text-red-800",Cancelado:"bg-gray-100 text-gray-800",Reembolsado:"bg-purple-100 text-purple-800"})[w]||"bg-gray-100 text-gray-800",M=w=>({Bold:"bg-blue-100 text-blue-800",PayPal:"bg-yellow-100 text-yellow-800",PayU:"bg-green-100 text-green-800","Transferencia Bancaria":"bg-purple-100 text-purple-800",Manual:"bg-gray-100 text-gray-800"})[w]||"bg-gray-100 text-gray-800",G=w=>{const S={invoiceNumber:`INV-${w.id.slice(-8).toUpperCase()}`,date:new Date(w.createdAt.seconds*1e3).toLocaleDateString(),dueDate:w.dueDate?new Date(w.dueDate.seconds*1e3).toLocaleDateString():"N/A",clientName:w.clientName||(e==null?void 0:e.fullName)||"Cliente",clientEmail:w.clientEmail||(t==null?void 0:t.email)||"N/A",serviceNumber:w.serviceNumber||"N/A",serviceType:w.serviceType||"Servicio",description:w.description||"Descripcin del servicio",amount:w.amount||0,currency:w.currency||"USD",status:w.status||"Pendiente",gateway:w.gateway||"N/A",transactionId:w.transactionId||"N/A",paymentMethod:w.paymentMethod||"N/A"},V=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>Invoice ${S.invoiceNumber}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
          .invoice { background: white; max-width: 800px; margin: 0 auto; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
          .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #e5e5e5; padding-bottom: 20px; }
          .company-name { font-size: 24px; font-weight: bold; color: #2563eb; margin-bottom: 5px; }
          .invoice-title { font-size: 18px; color: #666; }
          .invoice-details { display: flex; justify-content: space-between; margin-bottom: 30px; }
          .client-info, .invoice-info { flex: 1; }
          .client-info h3, .invoice-info h3 { margin: 0 0 10px 0; color: #333; font-size: 16px; }
          .client-info p, .invoice-info p { margin: 5px 0; color: #666; font-size: 14px; }
          .service-details { margin-bottom: 30px; }
          .service-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
          .service-table th, .service-table td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e5e5; }
          .service-table th { background: #f8f9fa; font-weight: bold; color: #333; }
          .service-table .amount { text-align: right; font-weight: bold; }
          .total { text-align: right; margin-top: 20px; }
          .total-amount { font-size: 20px; font-weight: bold; color: #2563eb; }
          .status { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; }
          .status.completado { background: #d1fae5; color: #065f46; }
          .status.pendiente { background: #fef3c7; color: #92400e; }
          .status.fallido { background: #fee2e2; color: #991b1b; }
          .status.cancelado { background: #f3f4f6; color: #374151; }
          .footer { margin-top: 40px; text-align: center; color: #666; font-size: 12px; border-top: 1px solid #e5e5e5; padding-top: 20px; }
        </style>
      </head>
      <body>
        <div class="invoice">
          <div class="header">
            <div class="company-name">${(n==null?void 0:n.companyName)||"App Gestor"}</div>
            <div class="invoice-title">FACTURA</div>
          </div>
          
          <div class="invoice-details">
            <div class="client-info">
              <h3>Cliente</h3>
              <p><strong>${S.clientName}</strong></p>
              <p>${S.clientEmail}</p>
            </div>
            <div class="invoice-info">
              <h3>Detalles de la Factura</h3>
              <p><strong>Nmero:</strong> ${S.invoiceNumber}</p>
              <p><strong>Fecha:</strong> ${S.date}</p>
              <p><strong>Vencimiento:</strong> ${S.dueDate}</p>
              <p><strong>Estado:</strong> <span class="status ${S.status.toLowerCase()}">${S.status}</span></p>
            </div>
          </div>
          
          <div class="service-details">
            <h3>Detalles del Servicio</h3>
            <table class="service-table">
              <thead>
                <tr>
                  <th>Servicio</th>
                  <th>Descripcin</th>
                  <th>Monto</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>${S.serviceType}</td>
                  <td>${S.description}</td>
                  <td class="amount">${S.currency} ${S.amount.toFixed(2)}</td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <div class="total">
            <div class="total-amount">Total: ${S.currency} ${S.amount.toFixed(2)}</div>
          </div>
          
          <div class="footer">
            <p>Mtodo de Pago: ${S.paymentMethod}</p>
            <p>Gateway: ${S.gateway}</p>
            ${S.transactionId!=="N/A"?`<p>ID de Transaccin: ${S.transactionId}</p>`:""}
            <p>Gracias por su negocio</p>
          </div>
        </div>
      </body>
      </html>
    `,ee=new Blob([V],{type:"text/html"}),re=URL.createObjectURL(ee),ce=document.createElement("a");ce.href=re,ce.download=`invoice-${S.invoiceNumber}.html`,document.body.appendChild(ce),ce.click(),document.body.removeChild(ce),URL.revokeObjectURL(re),r("Invoice descargado exitosamente","success")},K=w=>w?new Date(w.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",z=(w,S)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:S||"USD"}).format(w),q=w=>{switch(w){case"Completado":return"";case"Pendiente":return"";case"Procesando":return"";case"Fallido":return"";case"Cancelado":return"";case"Reembolsado":return"";default:return""}},H=w=>{b(w),k(!0)},X=async(w,S)=>{const V=F(),ee=V==null?void 0:V[S];if(ee)if(S==="bankTransfer"){if(w.gateway!=="Transferencia Bancaria")try{const re=dt(Be,"artifacts",Fe,"public","data","payments",w.id);await gr(re,{gateway:"Transferencia Bancaria",updatedAt:new Date}),r("Pasarela cambiada a Transferencia Bancaria","success")}catch{r("No se pudo actualizar la pasarela del pago","error")}H({...w,gateway:"Transferencia Bancaria"})}else r(`Redirigiendo a ${ee.name} para procesar el pago`,"info")},ne=async(w,S)=>{if(!S||!(w!=null&&w.id)){r("Selecciona una imagen vlida","warning");return}try{Z(ye=>({...ye,[w.id]:!0})),console.log(" Iniciando subida de comprobante va PHP...");const V=new FormData;V.append("file",S);const ee=window.location.origin+"/upload.php";console.log(" Enviando a:",ee);const re=await fetch(ee,{method:"POST",body:V});if(console.log(" Respuesta recibida:",re.status,re.statusText),!re.ok){const ye=await re.text();throw console.error(" Error del servidor:",ye),new Error(`upload_failed_${re.status}: ${ye}`)}const ce=await re.json();console.log(" Respuesta JSON:",ce);const he=ce==null?void 0:ce.url;if(!he)throw console.error(" No se recibi URL en la respuesta:",ce),new Error("missing_url");const me=dt(Be,"artifacts",Fe,"public","data","payments",w.id);await gr(me,{proofUrl:he,proofUploadedAt:new Date,status:"Procesando"}),console.log(" Comprobante guardado en Firestore:",he),b(ye=>ye&&ye.id===w.id?{...ye,proofUrl:he,status:"Procesando"}:ye),s(ye=>ye.map(Ee=>Ee.id===w.id?{...Ee,proofUrl:he,status:"Procesando"}:Ee)),k(!1),r("Comprobante subido correctamente","success")}catch(V){console.error(" Upload proof failed:",V),r(`No se pudo subir el comprobante: ${V.message}`,"error")}finally{Z(V=>({...V,[w.id]:!1}))}};return f?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(Ji,{}),"Mis Pagos"]}),a.jsxs("div",{className:"text-sm text-gray-500",children:[L.length," pago",L.length!==1?"s":""," encontrado",L.length!==1?"s":""]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar por servicio o transaccin...",value:o,onChange:w=>l(w.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md"}),a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Vu,{})})]}),a.jsx("select",{value:c,onChange:w=>u(w.target.value),className:"w-full p-2 border rounded-md",children:A.map(w=>a.jsx("option",{value:w,children:w},w))})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Total Pagado"}),a.jsx("div",{className:"text-2xl font-bold text-green-600",children:z(i.filter(w=>w.status==="Completado").reduce((w,S)=>w+(S.amount||0),0),"USD")})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Pendientes"}),a.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:i.filter(w=>w.status==="Pendiente").length})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Completados"}),a.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.filter(w=>w.status==="Completado").length})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Fallidos"}),a.jsx("div",{className:"text-2xl font-bold text-red-600",children:i.filter(w=>w.status==="Fallido").length})]})]}),L.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(Ji,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes pagos registrados"}),a.jsx("p",{className:"text-gray-500",children:"Los pagos aparecern aqu una vez que realices una transaccin."})]}):a.jsx("div",{className:"space-y-4",children:L.map(w=>a.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("span",{className:"text-2xl",children:q(w.status)}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:w.serviceName||w.serviceType||"Servicio"}),a.jsx("p",{className:"text-sm text-gray-500 font-mono",children:w.serviceNumber||w.id}),w.serviceDescription&&a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:w.serviceDescription}),w.isRenewal&&a.jsxs("div",{className:"text-xs text-green-600 font-medium mt-1",children:["Renovacin: ",w.renewalPeriod||"N/A"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Monto:"}),a.jsx("div",{className:"font-semibold text-lg text-gray-900",children:z(w.amount,w.currency)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Estado:"}),a.jsx("div",{className:"mt-1",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${E(w.status)}`,children:w.status})})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Pasarela:"}),a.jsx("div",{className:"mt-1",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${M(w.gateway)}`,children:w.gateway})})]})]}),a.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:[a.jsxs("div",{children:["Fecha: ",K(w.createdAt)]}),w.completedAt&&a.jsxs("div",{children:["Completado: ",K(w.completedAt)]}),w.startDate&&w.endDate&&a.jsx("div",{className:"text-blue-600 mt-2",children:a.jsxs("div",{children:["Perodo: ",K(w.startDate)," - ",K(w.endDate)]})}),w.transactionId&&a.jsxs("div",{className:"font-mono",children:["ID: ",w.transactionId]}),w.isRenewal&&w.renewalMonths&&a.jsxs("div",{className:"text-green-600",children:["Duracin: ",w.renewalMonths," meses"]})]})]}),a.jsxs("div",{className:"mt-4 md:mt-0 md:ml-4 flex flex-wrap gap-2",children:[(w.status==="Completado"||w.status==="Fallido"||w.status==="Cancelado")&&a.jsxs("button",{onClick:()=>G(w),className:"inline-flex items-center px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm",children:[a.jsx(yl,{className:"h-4 w-4 mr-1"}),"Descargar Invoice"]}),w.status==="Pendiente"&&a.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{const S=F();return S?Object.entries(S).map(([V,ee])=>ee.enabled?a.jsxs("button",{onClick:()=>X(w,V),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:["Pagar con ",ee.name]},V):null):null})()}),w.gateway==="Transferencia Bancaria"&&a.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[w.status==="Pendiente"&&a.jsxs("label",{className:`px-4 py-2 ${D[w.id]?"bg-gray-200 text-gray-400 cursor-wait":"bg-gray-100 text-gray-800 hover:bg-gray-200 cursor-pointer"} rounded-lg text-sm`,children:[D[w.id]?"Subiendo...":"Subir Comprobante",a.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:S=>{var V;return((V=S.target.files)==null?void 0:V[0])&&ne(w,S.target.files[0])}})]}),w.proofUrl&&a.jsx("button",{onClick:()=>{_(w.proofUrl),U(!0)},className:"px-4 py-2 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 text-sm",children:"Ver Comprobante"}),w.status==="Procesando"&&a.jsx("span",{className:"text-sm text-blue-600 font-medium",children:"Comprobante en revisin"})]})]})]})},w.id))}),T&&C&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsx("div",{className:"bg-white rounded-lg shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Instrucciones de Transferencia"}),a.jsx("button",{onClick:()=>k(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsx(jO,{bankAccounts:g,serviceNumber:C.serviceNumber,amount:C.amount,currency:C.currency,onUpload:w=>ne(C,w)})]})})}),le&&j&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-50 flex justify-center items-center p-4",onClick:()=>U(!1),children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-5xl w-full max-h-[95vh] overflow-hidden flex flex-col",onClick:w=>w.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b bg-gray-50",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Comprobante de Pago"}),a.jsx("button",{onClick:()=>U(!1),className:"text-gray-400 hover:text-gray-600 text-2xl font-bold w-8 h-8 flex items-center justify-center","aria-label":"Cerrar",children:""})]}),a.jsx("div",{className:"flex-1 overflow-auto p-4 bg-gray-100 flex justify-center items-center min-h-[400px]",children:a.jsx("img",{src:j,alt:"Comprobante de pago",className:"max-w-full max-h-[80vh] object-contain rounded-lg shadow-lg",onError:w=>{w.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="%23999"%3ENo se pudo cargar la imagen%3C/text%3E%3C/svg%3E'}})}),a.jsxs("div",{className:"p-4 border-t bg-gray-50 flex justify-end gap-2",children:[a.jsx("a",{href:j,target:"_blank",rel:"noreferrer",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:"Abrir en Nueva Pestaa"}),a.jsx("button",{onClick:()=>{const w=document.createElement("a");w.href=j,w.download=`comprobante-${Date.now()}.${j.split(".").pop().split("?")[0]}`,document.body.appendChild(w),w.click(),document.body.removeChild(w)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm",children:"Descargar"}),a.jsx("button",{onClick:()=>U(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 text-sm",children:"Cerrar"})]})]})})]})}function IO({user:t,userProfile:e}){const{addNotification:n}=pn(),[r,i]=ue.useState([]),[s,o]=ue.useState(null),[l,c]=ue.useState(!0),[u,f]=ue.useState(null),[v,g]=ue.useState(new Set),[p,T]=ue.useState(!1),k=[{key:"monthly",label:"Mensual",months:1},{key:"quarterly",label:"Trimestral",months:3},{key:"semiAnnual",label:"Semestral",months:6},{key:"annual",label:"Anual",months:12},{key:"biennial",label:"Bienal (2 aos)",months:24},{key:"triennial",label:"Trienal (3 aos)",months:36}];ue.useEffect(()=>{const K=dt(Be,"artifacts",Fe,"public","data","settings","renewalConfig"),z=Gt(K,q=>{q.exists()?(o(q.data()),console.log("Renewal config loaded:",q.data())):(console.log("No renewal config found, using defaults"),o({discounts:{monthly:{enabled:!1,percentage:0},quarterly:{enabled:!0,percentage:5},semiAnnual:{enabled:!0,percentage:10},annual:{enabled:!0,percentage:15},biennial:{enabled:!0,percentage:25},triennial:{enabled:!0,percentage:35}},taxSettings:{ivaEnabled:!0,ivaPercentage:19,ivaIncluded:!1,taxName:"IVA"}}))},q=>{console.error("Error loading renewal config:",q)});return()=>z()},[]),ue.useEffect(()=>{const K=localStorage.getItem("selectedServiceForRenewal");if(K)try{const z=JSON.parse(K);f(z),n(`Servicio "${z.serviceType}" seleccionado para renovacin`,"success"),localStorage.removeItem("selectedServiceForRenewal")}catch(z){console.error("Error parsing selected service:",z)}},[]),ue.useEffect(()=>{if(!u||r.length===0)return;const K=document.getElementById(`service-${u.id}`);K&&K.scrollIntoView({behavior:"smooth",block:"start"})},[u,r]),ue.useEffect(()=>{if(!(t!=null&&t.uid))return;const K=An(Ut(Be,"artifacts",Fe,"public","data","payments"),ur("userId","==",t.uid),ur("status","==","Pendiente"),ur("isRenewal","==",!0)),z=Gt(K,q=>{const H=new Set;q.docs.forEach(X=>{const ne=X.data();ne.serviceId&&H.add(ne.serviceId)}),g(H)},q=>{console.error("Error loading pending renewals:",q)});return()=>z()},[t==null?void 0:t.uid]);const C=K=>{if(!K.dueDate||!K.billingCycle||K.billingCycle==="One-Time")return K.expirationDate?new Date(K.expirationDate.seconds*1e3):null;const z=new Date(K.dueDate.seconds*1e3);let q=new Date(z);switch(K.billingCycle){case"Monthly":q.setMonth(q.getMonth()+1);break;case"Semiannually":q.setMonth(q.getMonth()+6);break;case"Annually":q.setFullYear(q.getFullYear()+1);break;case"Biennially":q.setFullYear(q.getFullYear()+2);break;case"Triennially":q.setFullYear(q.getFullYear()+3);break;default:return null}return q},b=K=>K.billingCycle==="One-Time"?K.dueDate?new Date(K.dueDate.seconds*1e3):null:C(K);ue.useEffect(()=>{if(!(t!=null&&t.uid)){c(!1);return}const K=An(Ut(Be,"artifacts",Fe,"public","data","services"),ur("assignedUserId","==",t.uid)),z=Gt(K,X=>{const ne=X.docs.map(w=>({id:w.id,...w.data()}));i(ne)},X=>{console.error("Error loading services:",X),n("Error al cargar los servicios","error")}),q=dt(Be,"artifacts",Fe,"public","data","settings","renewalConfig"),H=Gt(q,X=>{X.exists()&&o(X.data()),c(!1)});return()=>{z(),H()}},[t==null?void 0:t.uid,n]);const P=(K,z)=>{var w,S;if(!((S=(w=s==null?void 0:s.discounts)==null?void 0:w[z])!=null&&S.enabled))return K;const q=s.discounts[z],H=K*q.discount/100,X=K-H,ne=Math.round(X/s.pricingSettings.roundToNearest)*s.pricingSettings.roundToNearest;return Math.max(ne,s.pricingSettings.minimumAmount)},R=K=>{var z;if(!((z=s==null?void 0:s.taxSettings)!=null&&z.ivaEnabled)||s.taxSettings.ivaIncluded)return K;{const q=K*s.taxSettings.ivaPercentage/100;return K+q}},D=K=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(K),Z=K=>{const z=b(K);if(!z)return 0;const q=new Date,H=z.getTime()-q.getTime();return Math.ceil(H/(1e3*60*60*24))},le=K=>{switch(K){case"Activo":return"bg-green-100 text-green-800";case"Periodo de Gracia Vencido":return"bg-yellow-100 text-yellow-800";case"Pendiente Pago":return"bg-orange-100 text-orange-800";case"Pago":return"bg-blue-100 text-blue-800";case"Cancelado":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},U=K=>{switch(K){case"Monthly":return 1;case"Quarterly":return 3;case"Semi-Annual":return 6;case"Annually":return 12;case"Biennial":return 24;case"Triennial":return 36;case"One-Time":return 0;default:return 1}},j=(K,z)=>{var X;const q=U(K.billingCycle),H=((X=k.find(ne=>ne.key===z))==null?void 0:X.months)||0;return q===0?!1:H>=q},_=(K,z)=>{var w;const q=b(K);if(!q)return{startDate:null,endDate:null};const H=((w=k.find(S=>S.key===z))==null?void 0:w.months)||0,X=new Date(q),ne=new Date(X);return ne.setMonth(ne.getMonth()+H),{startDate:X,endDate:ne}},F=(K,z)=>{var X;const q=U(K.billingCycle);return q===0?"Volver a Comprar":(((X=k.find(ne=>ne.key===z))==null?void 0:X.months)||0)<q?"Perodo Insuficiente":"Renovar"},A=()=>{window.location.href="#payments"},L=K=>{if(!K)return null;if(K.gateways)return K.gateways;const{bold:z,paypal:q,payu:H,bankTransfer:X}=K,ne={};return z&&(ne.bold={name:"Bold",...z}),q&&(ne.paypal={name:"PayPal",...q}),H&&(ne.payu={name:"PayU",...H}),X&&(ne.bankTransfer={name:"Transferencia Bancaria",...X}),ne},[E,M]=ue.useState(null);ue.useEffect(()=>{const K=dt(Be,"artifacts",Fe,"public","data","settings","paymentConfig"),z=Gt(K,q=>{q.exists()&&M(q.data())});return()=>z()},[]);const G=async(K,z)=>{var q,H,X,ne;if(v.has(K.id)){n("Ya tienes una solicitud de renovacin pendiente para este servicio","warning");return}if(p){n("Ya se est procesando una solicitud de renovacin","warning");return}T(!0);try{const{startDate:w,endDate:S}=_(K,z),V=K.amount,ee=P(V,z),re=R(ee);let ce=E&&L(E);const he=ce?Object.values(ce).filter(Ge=>Ge.enabled):[];let me="Pendiente de Seleccin",ye="Renovacin";he.length===1&&(me=he[0].name,ye=he[0].name);const Ee=K.currency||"USD",Pe={userId:t.uid,serviceId:K.id,serviceName:K.serviceType,serviceType:K.serviceType,serviceDescription:K.description,serviceNumber:K.serviceNumber,amount:re,originalAmount:V,discount:V-ee,currency:Ee,status:"Pendiente",paymentMethod:ye,paymentType:"Renovacin",gateway:me,transactionId:null,dueDate:ht.fromDate(new Date(w)),renewalPeriod:((q=k.find(Ge=>Ge.key===z))==null?void 0:q.label)||z,renewalMonths:((H=k.find(Ge=>Ge.key===z))==null?void 0:H.months)||0,startDate:ht.fromDate(new Date(w)),endDate:ht.fromDate(new Date(S)),createdAt:ht.now(),updatedAt:ht.now(),notes:`Renovacin de ${(X=k.find(Ge=>Ge.key===z))==null?void 0:X.label} para el servicio ${K.serviceType}`,isRenewal:!0},Re=Ut(Be,`artifacts/${Fe}/public/data/payments`);await Sa(Re,Pe);const be={service:K,period:z,startDate:w,endDate:S,originalPrice:V,discountedPrice:ee,finalPrice:re};localStorage.setItem("renewalData",JSON.stringify(be));const ie=F(K,z);n(`${ie} ${(ne=k.find(Ge=>Ge.key===z))==null?void 0:ne.label} - Redirigiendo a pagos`,"success"),g(Ge=>new Set([...Ge,K.id])),setTimeout(()=>{window.location.href="#payments"},1500)}catch(w){console.error("Error creating renewal payment:",w),n("Error al crear la solicitud de renovacin. Intenta nuevamente.","error")}finally{T(!1)}};return l?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("main",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(ul,{}),"Renovaciones de Servicios"]})}),r.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(ul,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes servicios para renovar"}),a.jsx("p",{className:"text-gray-500",children:"Contacta al administrador para que te asigne servicios."})]}):a.jsx("div",{className:"space-y-6",children:r.map(K=>{const z=Z(K),q=z<=30&&z>0,H=z<=0,X=u&&u.id===K.id;return a.jsxs("div",{id:`service-${K.id}`,className:`bg-white rounded-xl shadow-lg p-6 ${X?"ring-2 ring-blue-500 border-blue-200":""}`,children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:K.serviceType}),X&&a.jsx("span",{className:"px-2 py-1 text-xs font-semibold text-blue-700 bg-blue-100 rounded-full",children:"Seleccionado"})]}),a.jsx("p",{className:"text-sm text-gray-500 font-mono",children:K.serviceNumber}),a.jsx("p",{className:"text-sm text-gray-600",children:K.description})]}),a.jsx("div",{className:"mt-2 md:mt-0",children:a.jsx("span",{className:`px-3 py-1 text-sm font-semibold rounded-full ${le(K.status)}`,children:K.status})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Precio Actual:"}),a.jsx("div",{className:"font-semibold text-lg text-gray-900",children:D(K.amount)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:K.billingCycle==="One-Time"?"Fecha de Inicio:":"Fecha de Vencimiento:"}),a.jsx("div",{className:`font-semibold ${H?"text-red-600":q?"text-orange-600":"text-gray-900"}`,children:(()=>{const ne=b(K);return ne?ne.toLocaleDateString():"N/A"})()}),a.jsx("div",{className:"text-xs text-gray-500",children:H?"Vencido":q?`${z} das restantes`:`${z} das restantes`})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Ciclo Actual:"}),a.jsx("div",{className:"font-semibold text-gray-900",children:K.billingCycle})]})]}),a.jsxs("div",{className:"border-t pt-6",children:[a.jsxs("h4",{className:"text-md font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(uA,{}),U(K.billingCycle)===0?"Opciones de Compra":"Opciones de Renovacin"]}),U(K.billingCycle)===0?a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.725-1.36 3.49 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Servicio de Pago nico"}),a.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:a.jsx("p",{children:'Este servicio es de pago nico. Para volver a adquirirlo, contacta al administrador o selecciona "Volver a Comprar" si est disponible.'})})]})]})}):a.jsxs("div",{className:"space-y-4",children:[(()=>{var w,S;const ne=k.find(V=>U(K.billingCycle)===V.months);if(ne){const V=K.amount,ee=P(V,ne.key),re=R(ee),ce=(w=s==null?void 0:s.discounts)==null?void 0:w[ne.key],he=V-ee,{startDate:me,endDate:ye}=_(K,ne.key);return a.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h5",{className:"font-semibold text-blue-900 flex items-center gap-2",children:[a.jsx(ul,{className:"h-4 w-4"}),"Renovacin de Perodo Actual"]}),a.jsx("span",{className:"px-3 py-1 bg-blue-200 text-blue-800 text-sm font-semibold rounded-full",children:ne.label})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[a.jsxs("div",{children:["Precio base: ",D(V)]}),(ce==null?void 0:ce.enabled)&&he>0&&a.jsxs("div",{className:"text-green-600",children:["Ahorras: ",D(he)]})]}),a.jsx("div",{className:"font-bold text-xl text-blue-600",children:D(re)}),((S=s==null?void 0:s.taxSettings)==null?void 0:S.ivaEnabled)&&a.jsx("div",{className:"text-xs text-gray-500",children:s.taxSettings.ivaIncluded?"IVA incluido":`+ ${s.taxSettings.taxName} ${s.taxSettings.ivaPercentage}%`})]}),a.jsx("div",{children:me&&ye&&a.jsxs("div",{className:"p-3 bg-white border border-blue-200 rounded-lg",children:[a.jsx("div",{className:"text-xs font-medium text-blue-800 mb-2",children:"Fechas de Renovacin:"}),a.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[a.jsxs("div",{children:["Fecha de Vencimiento: ",me.toLocaleDateString()]}),a.jsxs("div",{children:["Fecha Nueva Renovacin: ",ye.toLocaleDateString()]})]})]})})]}),v.has(K.id)?a.jsx("button",{onClick:A,className:"w-full mt-4 px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-colors",children:"Ver Solicitud Pendiente"}):a.jsx("button",{onClick:()=>G(K,ne.key),disabled:p,className:`w-full mt-4 px-6 py-3 font-semibold rounded-lg transition-colors ${p?"bg-gray-400 text-white cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:p?"Creando...":`Renovar ${ne.label}`})]})}return null})(),a.jsxs("div",{children:[a.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-3",children:"Otras Opciones de Renovacin:"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(ne=>{var Pe,Re,be;const w=K.amount,S=P(w,ne.key),V=R(S),ee=(Pe=s==null?void 0:s.discounts)==null?void 0:Pe[ne.key],re=w-S,ce=j(K,ne),he=F(K,ne),me=U(K.billingCycle)===ne.months,ye=!((Re=s==null?void 0:s.discounts)!=null&&Re[ne.key])||s.discounts[ne.key].enabled,Ee=ce&&!me&&ye;return Ee?a.jsxs("div",{className:"border rounded-lg p-4 transition-shadow border-gray-200 hover:shadow-md",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h5",{className:"font-medium text-gray-800",children:ne.label}),(ee==null?void 0:ee.enabled)&&Ee&&a.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-semibold rounded-full",children:["-",ee.discount,"%"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsxs("div",{children:["Precio base: ",D(w)]}),(ee==null?void 0:ee.enabled)&&re>0&&a.jsxs("div",{className:"text-green-600",children:["Ahorras: ",D(re)]})]}),a.jsx("div",{className:"font-semibold text-lg text-blue-600",children:D(V)}),((be=s==null?void 0:s.taxSettings)==null?void 0:be.ivaEnabled)&&a.jsx("div",{className:"text-xs text-gray-500",children:s.taxSettings.ivaIncluded?"IVA incluido":`+ ${s.taxSettings.taxName} ${s.taxSettings.ivaPercentage}%`}),(()=>{const{startDate:ie,endDate:Ge}=_(K,ne);return ie&&Ge?a.jsxs("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx("div",{className:"text-xs font-medium text-blue-800 mb-2",children:"Fechas de Renovacin:"}),a.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[a.jsxs("div",{children:["Fecha de Vencimiento: ",ie.toLocaleDateString()]}),a.jsxs("div",{children:["Fecha Nueva Renovacin: ",Ge.toLocaleDateString()]})]})]}):null})(),v.has(K.id)?a.jsx("button",{onClick:A,className:"w-full px-4 py-2 rounded-md text-sm font-medium bg-green-600 text-white hover:bg-green-700",children:"Ver Solicitud"}):a.jsx("button",{onClick:()=>G(K,ne.key),disabled:p,className:`w-full px-4 py-2 rounded-md text-sm font-medium ${p?"bg-gray-400 text-white cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:p?"Creando...":`${he} ${ne.label}`})]})]},ne.key):null})})]})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h5",{className:"font-medium text-gray-800 mb-2",children:"Informacin Importante"}),a.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[a.jsxs("li",{children:[" ",a.jsx("strong",{children:'La "Renovacin de Perodo Actual" siempre est disponible y destacada'})]}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"Fecha de Vencimiento"}),": Fecha actual de vencimiento del servicio"]}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"Fecha Nueva Renovacin"}),": Fecha calculada despus de sumar el perodo"]}),a.jsx("li",{children:" Los descuentos se aplican automticamente segn el perodo seleccionado (si estn configurados)"}),a.jsx("li",{children:" Los precios se redondean para evitar decimales"}),a.jsx("li",{children:" El IVA se calcula segn la configuracin actual"}),a.jsxs("li",{children:[" ",a.jsx("strong",{children:"La renovacin extiende el servicio desde la fecha de vencimiento actual"})]}),a.jsx("li",{children:" El perodo de renovacin no puede ser inferior al ciclo actual del servicio"}),a.jsx("li",{children:' Los servicios de pago nico requieren "Volver a Comprar" en lugar de renovar'}),a.jsx("li",{children:" Al seleccionar una renovacin, sers redirigido a la seccin de pagos para proceder"})]})]})]},K.id)})})]})}function PO({user:t,userProfile:e}){const{addNotification:n}=pn(),[r,i]=ue.useState([]),[s,o]=ue.useState(!0),[l,c]=ue.useState(!1),[u,f]=ue.useState(null),[v,g]=ue.useState(!1),[p,T]=ue.useState({subject:"",department:"Soporte Tcnico",priority:"Media",description:""}),k=["Soporte Tcnico","Facturacin","Ventas","General"],C=["Baja","Media","Alta","Crtica"];ue.useEffect(()=>{if(!(t!=null&&t.uid)){o(!1);return}const _=An(Ut(Be,"artifacts",Fe,"public","data","tickets"),ur("clientId","==",t.uid)),F=Gt(_,A=>{const L=A.docs.map(E=>({id:E.id,...E.data()}));L.sort((E,M)=>{var z,q;const G=((z=E.createdAt)==null?void 0:z.seconds)||0;return(((q=M.createdAt)==null?void 0:q.seconds)||0)-G}),i(L),o(!1)},A=>{console.error("Error loading tickets:",A),n("Error al cargar los tickets","error"),o(!1)});return()=>F()},[t==null?void 0:t.uid,n,e]);const b=async _=>{_.preventDefault(),console.log(" handleCreateTicket llamado - Iniciando creacin de ticket");try{console.log(" Creando ticket en Firestore...");const F={...p,ticketNumber:`TKT-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,status:"Abierto",clientId:t.uid,clientName:(e==null?void 0:e.fullName)||t.email,clientEmail:t.email,assignedTo:null,assignedToName:null,createdAt:ht.now(),updatedAt:ht.now(),lastReplyAt:ht.now(),lastReplyBy:"Cliente",replyCount:0,attachments:[]},L=(await Sa(Ut(Be,"artifacts",Fe,"public","data","tickets"),F)).id;try{console.log(" Iniciando envo de notificaciones por email para ticket:",L),await fr(),console.log(" Configuracin de email cargada");const E=(e==null?void 0:e.fullName)||t.email,M=F.ticketNumber,G=F.subject,K=F.description,z=F.department,q=F.priority,H=`
          <h2>Ticket Creado Exitosamente</h2>
          <p>Estimado/a <strong>${E}</strong>,</p>
          <p>Hemos recibido tu ticket de soporte. Nuestro equipo lo revisar y te responder pronto.</p>
          <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
            <p><strong>Nmero de Ticket:</strong> ${M}</p>
            <p><strong>Asunto:</strong> ${G}</p>
            <p><strong>Departamento:</strong> ${z}</p>
            <p><strong>Prioridad:</strong> ${q}</p>
            <p><strong>Descripcin:</strong></p>
            <p style="white-space: pre-wrap;">${K}</p>
          </div>
          <p>Puedes hacer seguimiento a tu ticket desde tu panel de cliente.</p>
          <p>Saludos cordiales,<br>Equipo de Soporte</p>
        `;console.log(" Enviando email al cliente:",t.email);const X=await ar({to:t.email,toName:E,subject:`Ticket Creado - ${M}`,html:H,text:`Ticket Creado Exitosamente

Estimado/a ${E},

Hemos recibido tu ticket de soporte. Nuestro equipo lo revisar y te responder pronto.

Nmero de Ticket: ${M}
Asunto: ${G}
Departamento: ${z}
Prioridad: ${q}

Descripcin:
${K}

Puedes hacer seguimiento a tu ticket desde tu panel de cliente.

Saludos cordiales,
Equipo de Soporte`,type:"Notificacin",recipientType:"Cliente",module:"tickets",event:"ticketReply",metadata:{ticketId:L,ticketNumber:M}});console.log(" Resultado email cliente:",X);const ne=`
          <h2>Nuevo Ticket Creado</h2>
          <p>Se ha creado un nuevo ticket de soporte que requiere atencin.</p>
          <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
            <p><strong>Nmero de Ticket:</strong> ${M}</p>
            <p><strong>Cliente:</strong> ${E} (${t.email})</p>
            <p><strong>Asunto:</strong> ${G}</p>
            <p><strong>Departamento:</strong> ${z}</p>
            <p><strong>Prioridad:</strong> ${q}</p>
            <p><strong>Descripcin:</strong></p>
            <p style="white-space: pre-wrap;">${K}</p>
          </div>
          <p>Por favor, revisa y asigna el ticket desde el panel de administracin.</p>
        `,w=await fr(),S=(w==null?void 0:w.fromEmail)||t.email;console.log(" Enviando email al administrador:",S);const V=await ar({to:S,toName:(w==null?void 0:w.fromName)||"Administrador",subject:`Nuevo Ticket - ${M} - ${G}`,html:ne,text:`Nuevo Ticket Creado

Se ha creado un nuevo ticket de soporte que requiere atencin.

Nmero de Ticket: ${M}
Cliente: ${E} (${t.email})
Asunto: ${G}
Departamento: ${z}
Prioridad: ${q}

Descripcin:
${K}

Por favor, revisa y asigna el ticket desde el panel de administracin.`,type:"Notificacin",recipientType:"Administrador",module:"tickets",event:"newTicket",metadata:{ticketId:L,ticketNumber:M,clientEmail:t.email,clientName:E}});console.log(" Resultado email administrador:",V),console.log(" Notificaciones por email completadas")}catch(E){console.error(" Error sending ticket notification emails:",E),console.error(" Detalles del error:",E.message,E.stack)}n("Ticket creado exitosamente","success"),c(!1),T({subject:"",department:"Soporte Tcnico",priority:"Media",description:""})}catch(F){console.error("Error creating ticket:",F),n("Error al crear el ticket","error")}},P=_=>{f(_),g(!0)},R=async _=>{try{const F=dt(Be,"artifacts",Fe,"public","data","tickets",_),A=await vs(F);if(!A.exists()){n("Ticket no encontrado","error");return}const L={id:A.id,...A.data()};await gr(F,{status:"Cerrado",updatedAt:ht.now()});try{console.log(" [CLIENT] Iniciando envo de notificaciones por cierre de ticket"),await fr();const E=L.ticketNumber,M=L.subject,G=(e==null?void 0:e.fullName)||t.email,K=await fr(),z=K==null?void 0:K.fromEmail;console.log(" [CLIENT] Enviando email al cliente por cierre:",t.email);const q=`
          <h2>Ticket ${E} Cerrado</h2>
          <p>Estimado/a <strong>${G}</strong>,</p>
          <p>Has cerrado tu ticket de soporte. Si necesitas ayuda adicional, puedes crear un nuevo ticket.</p>
          <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
            <p><strong>Nmero de Ticket:</strong> ${E}</p>
            <p><strong>Asunto:</strong> ${M}</p>
            <p><strong>Estado:</strong> Cerrado</p>
          </div>
          <p>Gracias por usar nuestro servicio de soporte.</p>
          <p>Saludos cordiales,<br>Equipo de Soporte</p>
        `;if(await ar({to:t.email,toName:G,subject:`Ticket ${E} - Cerrado`,html:q,text:`Ticket ${E} Cerrado

Estimado/a ${G},

Has cerrado tu ticket de soporte. Si necesitas ayuda adicional, puedes crear un nuevo ticket.

Nmero de Ticket: ${E}
Asunto: ${M}
Estado: Cerrado

Gracias por usar nuestro servicio de soporte.

Saludos cordiales,
Equipo de Soporte`,type:"Notificacin",recipientType:"Cliente",module:"tickets",event:"ticketResolved",metadata:{ticketId:_,ticketNumber:E,action:"closed_by_client"}}),z){console.log(" [CLIENT] Enviando email al administrador por cierre:",z);const H=`
            <h2>Ticket ${E} Cerrado por Cliente</h2>
            <p>Un cliente ha cerrado su ticket de soporte.</p>
            <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
              <p><strong>Nmero de Ticket:</strong> ${E}</p>
              <p><strong>Cliente:</strong> ${G} (${t.email})</p>
              <p><strong>Asunto:</strong> ${M}</p>
              <p><strong>Estado:</strong> Cerrado</p>
            </div>
          `;await ar({to:z,toName:(K==null?void 0:K.fromName)||"Administrador",subject:`Ticket ${E} - Cerrado por Cliente`,html:H,text:`Ticket ${E} Cerrado por Cliente

Un cliente ha cerrado su ticket de soporte.

Nmero de Ticket: ${E}
Cliente: ${G} (${t.email})
Asunto: ${M}
Estado: Cerrado`,type:"Notificacin",recipientType:"Administrador",module:"tickets",event:"ticketUpdate",metadata:{ticketId:_,ticketNumber:E,action:"closed_by_client",clientEmail:t.email}})}console.log(" [CLIENT] Notificaciones por cierre completadas")}catch(E){console.error(" [CLIENT] Error sending close ticket notification emails:",E)}n("Ticket cerrado exitosamente","success")}catch(F){console.error("Error closing ticket:",F),n("Error al cerrar el ticket","error")}},D=_=>({Abierto:"bg-red-100 text-red-800","En Progreso":"bg-yellow-100 text-yellow-800",Respondido:"bg-blue-100 text-blue-800",Cerrado:"bg-gray-100 text-gray-800","Esperando Cliente":"bg-orange-100 text-orange-800"})[_]||"bg-gray-100 text-gray-800",Z=_=>({Baja:"bg-green-100 text-green-800",Media:"bg-yellow-100 text-yellow-800",Alta:"bg-orange-100 text-orange-800",Crtica:"bg-red-100 text-red-800"})[_]||"bg-gray-100 text-gray-800",le=_=>({"Soporte Tcnico":"bg-blue-100 text-blue-800",Facturacin:"bg-green-100 text-green-800",Ventas:"bg-purple-100 text-purple-800",General:"bg-gray-100 text-gray-800"})[_]||"bg-gray-100 text-gray-800",U=_=>_?new Date(_.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"--",j=_=>{if(!_)return"--";const F=new Date,A=new Date(_.seconds*1e3),L=F.getTime()-A.getTime(),E=Math.floor(L/(1e3*60*60*24)),M=Math.floor(L/(1e3*60*60)),G=Math.floor(L/(1e3*60));return E>0?`hace ${E} da${E>1?"s":""}`:M>0?`hace ${M} hora${M>1?"s":""}`:G>0?`hace ${G} minuto${G>1?"s":""}`:"hace unos segundos"};return s?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("main",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(ic,{}),"Mis Tickets de Soporte"]}),a.jsxs("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[a.jsx(Vh,{}),"Nuevo Ticket"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:a.jsx(hs,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Abiertos"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(_=>_.status==="Abierto").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(yh,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Respondidos"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(_=>_.status==="Respondido").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:a.jsx(hs,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"En Progreso"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(_=>_.status==="En Progreso").length})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:a.jsx(ic,{})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Cerrados"}),a.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.filter(_=>_.status==="Cerrado").length})]})]})})]}),r.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(ic,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes tickets"}),a.jsx("p",{className:"text-gray-500 mb-4",children:"Crea tu primer ticket para obtener soporte."}),a.jsx("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Crear Primer Ticket"})]}):a.jsx("div",{className:"space-y-4",children:r.map(_=>a.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("span",{className:"font-mono text-sm font-medium text-blue-600",children:_.ticketNumber}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${D(_.status)}`,children:_.status}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${Z(_.priority)}`,children:_.priority}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${le(_.department)}`,children:_.department})]}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:_.subject}),a.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:_.description}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(hs,{}),a.jsxs("span",{children:["Creado ",j(_.createdAt)]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(op,{}),a.jsxs("span",{children:[_.replyCount," respuesta",_.replyCount!==1?"s":""]})]}),_.assignedToName&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(yh,{}),a.jsxs("span",{children:["Asignado a ",_.assignedToName]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>P(_),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md",title:"Ver ticket completo",children:a.jsx(yl,{})}),_.status!=="Cerrado"&&a.jsx("button",{onClick:()=>R(_.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-md",title:"Cerrar ticket",children:a.jsx(ap,{})})]})]})},_.id))}),l&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Crear Nuevo Ticket"}),a.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("form",{onSubmit:b,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto *"}),a.jsx("input",{type:"text",value:p.subject,onChange:_=>T(F=>({...F,subject:_.target.value})),className:"w-full p-2 border rounded-md",placeholder:"Describe brevemente tu problema o consulta",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento *"}),a.jsx("select",{value:p.department,onChange:_=>T(F=>({...F,department:_.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:k.map(_=>a.jsx("option",{value:_,children:_},_))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridad *"}),a.jsx("select",{value:p.priority,onChange:_=>T(F=>({...F,priority:_.target.value})),className:"w-full p-2 border rounded-md",required:!0,children:C.map(_=>a.jsx("option",{value:_,children:_},_))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin *"}),a.jsx("textarea",{value:p.description,onChange:_=>T(F=>({...F,description:_.target.value})),className:"w-full p-2 border rounded-md",rows:6,placeholder:"Describe tu problema o consulta en detalle. Incluye cualquier informacin relevante que pueda ayudar a resolver tu ticket ms rpidamente.",required:!0})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>c(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Crear Ticket"})]})]})]})}),v&&u&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:["Ticket ",u.ticketNumber]}),a.jsx("button",{onClick:()=>g(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${D(u.status)}`,children:u.status})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prioridad"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${Z(u.priority)}`,children:u.priority})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Departamento"}),a.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${le(u.department)}`,children:u.department})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Asignado a"}),a.jsx("div",{className:"text-sm text-gray-900",children:u.assignedToName||"Sin asignar"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Creado"}),a.jsx("div",{className:"text-sm text-gray-900",children:U(u.createdAt)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"ltima actividad"}),a.jsx("div",{className:"text-sm text-gray-900",children:j(u.lastReplyAt)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto"}),a.jsx("div",{className:"text-sm text-gray-900 p-3 bg-gray-50 rounded-md",children:u.subject})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripcin"}),a.jsx("div",{className:"text-sm text-gray-900 p-4 bg-gray-50 rounded-md whitespace-pre-wrap",children:u.description})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Historial de Mensajes"}),a.jsx("div",{className:"border border-gray-200 rounded-md p-4",children:a.jsx(iS,{ticketId:u.id,userRole:"client",currentUser:t})})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t",children:[a.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cerrar"}),u.status!=="Cerrado"&&a.jsx("button",{onClick:()=>{R(u.id),g(!1)},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Cerrar Ticket"}),a.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Responder"})]})]})]})})]})}function RO({user:t,userProfile:e,companySettings:n}){const[r,i]=ue.useState("services");ue.useEffect(()=>{const o=()=>{const l=(window.location.hash||"").replace("#","");(l==="services"||l==="payments"||l==="renewals"||l==="tickets")&&i(l)};return o(),window.addEventListener("hashchange",o),()=>window.removeEventListener("hashchange",o)},[]);const s=()=>{switch(r){case"tickets":return a.jsx(PO,{user:t,userProfile:e});case"payments":return a.jsx(CO,{user:t,userProfile:e,companySettings:n});case"renewals":return a.jsx(IO,{user:t,userProfile:e});case"services":default:return a.jsx(TO,{user:t,userProfile:e})}};return a.jsxs("main",{className:"container mx-auto",children:[a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex space-x-8 px-4 sm:px-6 lg:px-8","aria-label":"Tabs",children:[a.jsxs("button",{onClick:()=>i("services"),className:`${r==="services"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(sp,{})," Mis Servicios"]}),a.jsxs("button",{onClick:()=>i("payments"),className:`${r==="payments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(Ji,{})," Mis Pagos"]}),a.jsxs("button",{onClick:()=>i("renewals"),className:`${r==="renewals"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(ul,{})," Renovaciones"]}),a.jsxs("button",{onClick:()=>i("tickets"),className:`${r==="tickets"?"border-blue-500 text-blue-600":"border-transparent text-gray-500"} flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm`,children:[a.jsx(ic,{})," Tickets de Soporte"]})]})}),s()]})}const LO=async(t,e,n=24)=>{try{const r=window.location.protocol,i=window.location.host,s=window.location.pathname.split("/").slice(0,-1).join("/")||"",o=`${r}//${i}${s}`,l=await fetch(`${o}/create-password-reset-token.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,appId:e,expiresInHours:n})}),c=await l.json();if(!l.ok||!c.success)throw new Error(c.error||"Error al crear token de restablecimiento");return{token:c.token,userId:c.userId,userData:c.userData||{}}}catch(r){throw console.error("Error creating password reset token via API:",r),r}};function DO({companySettings:t}){const{addNotification:e}=pn(),[n,r]=ue.useState(!0),[i,s]=ue.useState(""),[o,l]=ue.useState(""),[c,u]=ue.useState(!1),[f,v]=ue.useState(""),[g,p]=ue.useState(!1),T=async C=>{C.preventDefault();try{if(n){const b=await QC(Nr,i,o),P=await Na(An(Ut(Be,"artifacts",Fe,"public","data","users"),ur("__name__","==",b.user.uid)));if(P.docs.length===0)throw new Error("No se encontr el perfil de usuario.");const R=P.docs[0].data();if(R.status==="pending"||R.status==="disabled")throw await Yl(Nr),new Error("Tu cuenta est pendiente de activacin o ha sido deshabilitada.")}else{const b=await qm(Nr,i,o);await XC(b.user);const P=Ut(Be,"artifacts",Fe,"public","data","users");let D=(await Na(P)).empty?"superadmin":"client";const Z=D==="superadmin"?"active":"pending",le=D!=="superadmin";await ws(dt(Be,"artifacts",Fe,"public","data","users",b.user.uid),{email:i,role:D,status:Z,isProfileComplete:!1,createdAt:ht.now(),fullName:"",identification:"",requiresPasswordChange:le}),D==="superadmin"?e("Registro exitoso! Eres el primer usuario y tienes permisos de superadministrador.","success"):(e("Registro exitoso! Revisa tu correo para verificar la cuenta. Un administrador debe activar tu usuario.","success"),await Yl(Nr))}}catch(b){e(b.message,"error")}},k=async C=>{if(C.preventDefault(),!f){e("Por favor, ingresa tu email","error");return}p(!0);try{const b=await LO(f,Fe,24),{token:P,userId:R,userData:D}=b,Z=`${window.location.origin}${window.location.pathname}`,le=`${Z}?token=${P}`;await fr();const U=await Qy("Restablecer Contrasea");let j,_;if(U){const F={clientName:D.fullName||f||"Usuario",clientEmail:f,resetPasswordUrl:le,...D};j=Cu(U.subject,F,{companySettings:t}),_=Cu(U.body,F,{companySettings:t})}else j=`Restablecer tu contrasea${t!=null&&t.companyName?` - ${t.companyName}`:""}`,_=`Hola ${D.fullName||f},

Has solicitado restablecer tu contrasea en ${(t==null?void 0:t.companyName)||"nuestro sistema"}.

 INSTRUCCIONES:

1. Haz clic en el siguiente enlace para restablecer tu contrasea:
   ${le}

2. En la pgina de restablecimiento, ingresa una contrasea segura (mnimo 6 caracteres)

3. Confirma tu contrasea ingresndola nuevamente

4. Haz clic en "Restablecer Contrasea"

5. Una vez restablecida tu contrasea, sers redirigido automticamente al inicio de sesin

 IMPORTANTE:
- El enlace expirar en 24 horas
- Si no solicitaste este restablecimiento, ignora este email
- Si tienes problemas, contacta con soporte

 ENLACE DIRECTO AL SISTEMA:
${Z}

Si tienes alguna pregunta o necesitas ayuda, no dudes en contactarnos.

Equipo de Soporte
${(t==null?void 0:t.companyName)||""}`;await ar({to:f,toName:D.fullName||f,subject:j,html:_.replace(/\n/g,"<br>"),text:_,type:"Restablecimiento de Contrasea",recipientType:"Cliente",module:"auth",event:"passwordReset",metadata:{userId:R,userEmail:f}}),e(`Se ha enviado un enlace de restablecimiento a ${f}. Revisa tu correo.`,"success"),u(!1),v("")}catch(b){console.error("Error enviando email de reset:",b);let P="Error al enviar el email de restablecimiento.";b.message.includes("no encontrado")?P="No se encontr una cuenta con ese email.":b.message.includes("invlido")&&(P="El email proporcionado no es vlido."),e(P,"error")}finally{p(!1)}};return a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-sm w-full",children:[a.jsx("div",{className:"flex justify-center mb-6",children:t.logoUrl?a.jsx("img",{src:t.logoUrl,alt:"Logo de la Empresa",className:"max-h-16"}):a.jsx("h1",{className:"text-3xl font-bold",children:t.companyName||"Gestor de Pagos"})}),a.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:n?"Iniciar Sesin":"Crear Cuenta"}),a.jsxs("form",{onSubmit:T,children:[a.jsx("input",{type:"email",value:i,onChange:C=>s(C.target.value),placeholder:"Email",className:"w-full p-2 mb-4 border rounded",required:!0}),a.jsx("input",{type:"password",value:o,onChange:C=>l(C.target.value),placeholder:"Contrasea",className:"w-full p-2 mb-4 border rounded",required:!0}),n&&a.jsx("button",{type:"button",onClick:()=>u(!0),className:"w-full text-sm text-blue-600 hover:underline mb-2 text-right",children:"Olvidaste tu contrasea?"}),a.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700",children:n?"Entrar":"Registrarse"})]}),a.jsx("button",{onClick:()=>r(!n),className:"w-full mt-4 text-sm text-blue-600 hover:underline",children:n?"No tienes cuenta? Regstrate":"Ya tienes cuenta? Inicia sesin"}),c&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Restablecer Contrasea"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Ingresa tu email y te enviaremos un enlace para restablecer tu contrasea."}),a.jsxs("form",{onSubmit:k,children:[a.jsx("input",{type:"email",value:f,onChange:C=>v(C.target.value),placeholder:"Email",className:"w-full p-2 mb-4 border rounded",required:!0}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:()=>{u(!1),v("")},className:"flex-1 bg-gray-200 text-gray-800 p-2 rounded hover:bg-gray-300",children:"Cancelar"}),a.jsx("button",{type:"submit",disabled:g,className:"flex-1 bg-blue-600 text-white p-2 rounded hover:bg-blue-700 disabled:opacity-50",children:g?"Enviando...":"Enviar Enlace"})]})]})]})})]})})}function OO({isOpen:t,onSave:e}){const{addNotification:n}=pn(),[r,i]=ue.useState(""),[s,o]=ue.useState(""),[l,c]=ue.useState(""),u=async f=>{if(f.preventDefault(),r.length<6){c("La contrasea debe tener al menos 6 caracteres.");return}if(r!==s){c("Las contraseas no coinciden.");return}c("");try{await e(r),n("Contrasea cambiada exitosamente.","success")}catch{n("Error al cambiar la contrasea.","error")}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-md w-full",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Cambio de Contrasea Requerido"}),a.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Por seguridad, debes establecer una nueva contrasea para continuar."}),a.jsxs("form",{onSubmit:u,className:"space-y-4",children:[a.jsx("input",{type:"password",value:r,onChange:f=>i(f.target.value),placeholder:"Nueva Contrasea",className:"w-full p-2 border rounded-md",required:!0}),a.jsx("input",{type:"password",value:s,onChange:f=>o(f.target.value),placeholder:"Confirmar Nueva Contrasea",className:"w-full p-2 border rounded-md",required:!0}),l&&a.jsx("p",{className:"text-red-500 text-sm",children:l}),a.jsx("button",{type:"submit",className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md",children:"Guardar Contrasea"})]})]})}):null}function MO({companySettings:t,onResetComplete:e}){const{addNotification:n}=pn(),[r,i]=ue.useState(""),[s,o]=ue.useState(""),[l,c]=ue.useState(!1),[u,f]=ue.useState(!0),[v,g]=ue.useState(""),[p,T]=ue.useState("");ue.useEffect(()=>{(async()=>{const b=new URLSearchParams(window.location.search),P=b.get("oobCode"),R=b.get("mode");if(!P||R!=="resetPassword"){g("Enlace invlido o expirado. Por favor, solicita un nuevo enlace de restablecimiento."),f(!1);return}try{const D=await YC(Nr,P);T(D),f(!1)}catch(D){console.error("Error verificando cdigo de reset:",D);let Z="El enlace de restablecimiento es invlido o ha expirado.";D.code==="auth/expired-action-code"?Z="El enlace de restablecimiento ha expirado. Por favor, solicita uno nuevo.":D.code==="auth/invalid-action-code"&&(Z="El enlace de restablecimiento es invlido. Por favor, solicita uno nuevo."),g(Z),f(!1)}})()},[searchParams]);const k=async C=>{if(C.preventDefault(),g(""),r.length<6){g("La contrasea debe tener al menos 6 caracteres.");return}if(r!==s){g("Las contraseas no coinciden.");return}const b=searchParams.get("oobCode");if(!b){g("Cdigo de restablecimiento no encontrado.");return}c(!0);try{await GC(Nr,b,r),n("Contrasea restablecida exitosamente. Ahora puedes iniciar sesin.","success"),window.history.replaceState({},document.title,window.location.pathname),e&&setTimeout(()=>{e()},2e3)}catch(P){console.error("Error al restablecer contrasea:",P);let R="Error al restablecer la contrasea.";P.code==="auth/expired-action-code"?R="El enlace ha expirado. Por favor, solicita uno nuevo.":P.code==="auth/invalid-action-code"?R="El enlace es invlido. Por favor, solicita uno nuevo.":P.code==="auth/weak-password"&&(R="La contrasea es muy dbil. Por favor, usa una contrasea ms segura."),g(R)}finally{c(!1)}};return u?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-md w-full text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Verificando enlace de restablecimiento..."})]})}):v&&!p?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-md w-full",children:[a.jsx("div",{className:"text-center mb-6",children:t!=null&&t.logoUrl?a.jsx("img",{src:t.logoUrl,alt:"Logo",className:"max-h-16 mx-auto mb-4"}):a.jsx("h1",{className:"text-2xl font-bold mb-4",children:(t==null?void 0:t.companyName)||"Gestor de Pagos"})}),a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:a.jsx("p",{className:"text-red-800",children:v})}),a.jsx("button",{onClick:()=>{window.history.replaceState({},document.title,window.location.pathname),e&&e()},className:"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700",children:"Volver al Inicio de Sesin"})]})}):a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-md w-full",children:[a.jsxs("div",{className:"text-center mb-6",children:[t!=null&&t.logoUrl?a.jsx("img",{src:t.logoUrl,alt:"Logo",className:"max-h-16 mx-auto mb-4"}):a.jsx("h1",{className:"text-2xl font-bold mb-4",children:(t==null?void 0:t.companyName)||"Gestor de Pagos"}),a.jsx("h2",{className:"text-2xl font-bold",children:"Restablecer Contrasea"}),a.jsxs("p",{className:"text-gray-600 mt-2",children:["Ingresa tu nueva contrasea para ",p]})]}),v&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:a.jsx("p",{className:"text-red-800 text-sm",children:v})}),a.jsxs("form",{onSubmit:k,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nueva Contrasea"}),a.jsx("input",{type:"password",value:r,onChange:C=>i(C.target.value),placeholder:"Mnimo 6 caracteres",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0,minLength:6})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Nueva Contrasea"}),a.jsx("input",{type:"password",value:s,onChange:C=>o(C.target.value),placeholder:"Repite la contrasea",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0,minLength:6})]}),a.jsx("button",{type:"submit",disabled:l||!r||!s,className:"w-full bg-blue-600 text-white p-3 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:l?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Restableciendo..."]}):"Restablecer Contrasea"})]}),a.jsx("button",{onClick:()=>{window.history.replaceState({},document.title,window.location.pathname),e&&e()},className:"w-full mt-4 text-sm text-blue-600 hover:underline",children:"Volver al Inicio de Sesin"})]})})}function FO({companySettings:t,onResetComplete:e}){const{addNotification:n}=pn(),[r,i]=ue.useState(""),[s,o]=ue.useState(""),[l,c]=ue.useState(!1),[u,f]=ue.useState(!0),[v,g]=ue.useState(""),[p,T]=ue.useState(""),[k,C]=ue.useState(""),[b,P]=ue.useState(!1);ue.useEffect(()=>{(async()=>{const le=new URLSearchParams(window.location.search).get("token");if(!le){g("Token no encontrado en la URL. Por favor, usa el enlace completo que recibiste por correo."),f(!1);return}C(le);try{const U=await N8(le);if(!U.valid){g(U.error||"Token invlido o expirado"),f(!1);return}T(U.email),P(!0),f(!1)}catch(U){console.error("Error validando token:",U),g("Error al validar el token. Por favor, intenta nuevamente."),f(!1)}})()},[]);const R=async D=>{if(D.preventDefault(),g(""),r.length<6){g("La contrasea debe tener al menos 6 caracteres.");return}if(r!==s){g("Las contraseas no coinciden.");return}if(!k){g("Token no encontrado.");return}c(!0);try{const Z=await fetch("/reset-password-with-token.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:k,newPassword:r})}),le=await Z.json();if(!Z.ok||!le.success)throw new Error(le.error||"Error al restablecer la contrasea");n("Contrasea restablecida exitosamente. Ahora puedes iniciar sesin.","success"),window.history.replaceState({},document.title,window.location.pathname),e&&setTimeout(()=>{e()},2e3)}catch(Z){console.error("Error al restablecer contrasea:",Z),g(Z.message||"Error al restablecer la contrasea. Por favor, intenta nuevamente.")}finally{c(!1)}};return u?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-md w-full text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Verificando token de restablecimiento..."})]})}):v&&!b?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-md w-full",children:[a.jsx("div",{className:"text-center mb-6",children:t!=null&&t.logoUrl?a.jsx("img",{src:t.logoUrl,alt:"Logo",className:"max-h-16 mx-auto mb-4"}):a.jsx("h1",{className:"text-2xl font-bold mb-4",children:(t==null?void 0:t.companyName)||"Gestor de Pagos"})}),a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:a.jsx("p",{className:"text-red-800",children:v})}),a.jsx("button",{onClick:()=>{window.history.replaceState({},document.title,window.location.pathname),e&&e()},className:"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700",children:"Volver al Inicio de Sesin"})]})}):a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:a.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-xl max-w-md w-full",children:[a.jsxs("div",{className:"text-center mb-6",children:[t!=null&&t.logoUrl?a.jsx("img",{src:t.logoUrl,alt:"Logo",className:"max-h-16 mx-auto mb-4"}):a.jsx("h1",{className:"text-2xl font-bold mb-4",children:(t==null?void 0:t.companyName)||"Gestor de Pagos"}),a.jsx("h2",{className:"text-2xl font-bold",children:"Restablecer Contrasea"}),a.jsxs("p",{className:"text-gray-600 mt-2",children:["Ingresa tu nueva contrasea para ",p]})]}),v&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:a.jsx("p",{className:"text-red-800 text-sm",children:v})}),a.jsxs("form",{onSubmit:R,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nueva Contrasea"}),a.jsx("input",{type:"password",value:r,onChange:D=>i(D.target.value),placeholder:"Mnimo 6 caracteres",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0,minLength:6})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Nueva Contrasea"}),a.jsx("input",{type:"password",value:s,onChange:D=>o(D.target.value),placeholder:"Repite la contrasea",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0,minLength:6})]}),a.jsx("button",{type:"submit",disabled:l||!r||!s,className:"w-full bg-blue-600 text-white p-3 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:l?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Restableciendo..."]}):"Restablecer Contrasea"})]}),a.jsx("button",{onClick:()=>{window.history.replaceState({},document.title,window.location.pathname),e&&e()},className:"w-full mt-4 text-sm text-blue-600 hover:underline",children:"Volver al Inicio de Sesin"})]})})}function UO({isOpen:t,onComplete:e,user:n,userProfile:r}){const{addNotification:i}=pn(),[s,o]=ue.useState({fullName:(r==null?void 0:r.fullName)||"",identification:(r==null?void 0:r.identification)||"",phone:(r==null?void 0:r.phone)||"",address:(r==null?void 0:r.address)||""}),[l,c]=ue.useState(!1);ue.useEffect(()=>{const v=new URLSearchParams(window.location.search),g=v.get("uid");v.get("email");const p=v.get("name"),T=v.get("id");g&&g===(n==null?void 0:n.uid)&&(p||T)&&o(k=>({...k,fullName:p?decodeURIComponent(p):k.fullName,identification:T?decodeURIComponent(T):k.identification}))},[n==null?void 0:n.uid]);const u=v=>{const{name:g,value:p}=v.target;o(T=>({...T,[g]:p}))},f=async v=>{if(v.preventDefault(),!s.fullName.trim()){i("El nombre completo es obligatorio","error");return}c(!0);try{const g=dt(Be,"artifacts",Fe,"public","data","users",n.uid);await gr(g,{fullName:s.fullName.trim(),identification:s.identification.trim(),phone:s.phone.trim(),address:s.address.trim(),isProfileComplete:!0,profileCompletedAt:new Date}),i("Perfil completado exitosamente","success"),e()}catch(g){console.error("Error completing profile:",g),i("Error al completar el perfil","error")}finally{c(!1)}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Completar Perfil"}),a.jsxs("p",{className:"text-gray-600 mt-2",children:["Bienvenido ",n.email,"! Confirma o actualiza tu informacin para continuar."]})]}),a.jsxs("form",{onSubmit:f,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Completo *"}),a.jsx("input",{name:"fullName",value:s.fullName,onChange:u,placeholder:"Tu nombre completo",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Identificacin"}),a.jsx("input",{name:"identification",value:s.identification,onChange:u,placeholder:"Cdula, DNI, etc.",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telfono"}),a.jsx("input",{name:"phone",value:s.phone,onChange:u,placeholder:"+57 300 123 4567",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Direccin"}),a.jsx("input",{name:"address",value:s.address,onChange:u,placeholder:"Tu direccin",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]})]}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Informacin Importante"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[a.jsx("li",{children:" Los datos mostrados fueron configurados por el administrador"}),a.jsx("li",{children:" Puedes confirmar o modificar la informacin"}),a.jsx("li",{children:" Esta informacin se usar para la facturacin"}),a.jsx("li",{children:" Puedes actualizar estos datos ms tarde"})]})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx("button",{type:"submit",disabled:l,className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold disabled:opacity-50 flex items-center gap-2",children:l?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Completando..."]}):"Completar Perfil"})})]})]})}):null}function VO({onComplete:t}){const{addNotification:e}=pn(),[n,r]=ue.useState(1),[i,s]=ue.useState({companyName:"",identification:"",address:"",phone:"",email:"",website:""}),[o,l]=ue.useState({email:"",password:"",confirmPassword:"",fullName:"",identification:""}),[c,u]=ue.useState(!1),f=T=>{const{name:k,value:C}=T.target;s(b=>({...b,[k]:C}))},v=T=>{const{name:k,value:C}=T.target;l(b=>({...b,[k]:C}))},g=T=>{if(T.preventDefault(),!i.companyName){e("El nombre de la empresa es obligatorio","error");return}r(2)},p=async T=>{if(T.preventDefault(),o.password!==o.confirmPassword){e("Las contraseas no coinciden","error");return}if(o.password.length<6){e("La contrasea debe tener al menos 6 caracteres","error");return}u(!0);try{const k=await qm(Nr,o.email,o.password);await ws(dt(Be,"artifacts",Fe,"public","data","users",k.user.uid),{email:o.email,fullName:o.fullName,identification:o.identification,role:"superadmin",status:"active",isProfileComplete:!0,createdAt:ht.now(),requiresPasswordChange:!1}),await ws(dt(Be,"artifacts",Fe,"public","data","settings","company_info"),{...i,isDemoMode:!1,createdAt:ht.now()}),e("Configuracin inicial completada exitosamente!","success"),r(3),setTimeout(()=>{t()},2e3)}catch(k){console.error("Error en configuracin inicial:",k),e(`Error: ${k.message}`,"error")}finally{u(!1)}};return n===1?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Configuracin Inicial"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Paso 1 de 2: Informacin de la Empresa"})]}),a.jsxs("form",{onSubmit:g,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"companyName",value:i.companyName,onChange:f,placeholder:"Nombre de la Empresa *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),a.jsx("input",{name:"identification",value:i.identification,onChange:f,placeholder:"NIT / Identificacin Fiscal",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"address",value:i.address,onChange:f,placeholder:"Direccin",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"}),a.jsx("input",{name:"phone",value:i.phone,onChange:f,placeholder:"Telfono",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"email",type:"email",value:i.email,onChange:f,placeholder:"Email de Contacto",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"}),a.jsx("input",{name:"website",value:i.website,onChange:f,placeholder:"Sitio Web",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold",children:"Continuar"})})]})]})}):n===2?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Crear Superadministrador"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Paso 2 de 2: Cuenta de Administrador Principal"})]}),a.jsxs("form",{onSubmit:p,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"fullName",value:o.fullName,onChange:v,placeholder:"Nombre Completo *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),a.jsx("input",{name:"identification",value:o.identification,onChange:v,placeholder:"Identificacin",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500"})]}),a.jsx("input",{name:"email",type:"email",value:o.email,onChange:v,placeholder:"Email del Administrador *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{name:"password",type:"password",value:o.password,onChange:v,placeholder:"Contrasea *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0}),a.jsx("input",{name:"confirmPassword",type:"password",value:o.confirmPassword,onChange:v,placeholder:"Confirmar Contrasea *",className:"w-full p-3 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{className:"flex justify-between pt-4",children:[a.jsx("button",{type:"button",onClick:()=>r(1),className:"px-6 py-3 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 font-semibold",children:"Atrs"}),a.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold disabled:opacity-50",children:c?"Creando...":"Completar Configuracin"})]})]})]})}):n===3?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 flex justify-center items-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-md w-full text-center",children:[a.jsx("div",{className:"text-green-500 text-6xl mb-4",children:""}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Configuracin Completada!"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"El sistema est listo para usar. Sers redirigido al dashboard en unos segundos..."}),a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"})]})}):null}if(typeof window<"u")try{i8()}catch(t){console.warn("No se pudo configurar el filtro de errores:",t)}function BO(){const{addNotification:t}=pn(),[e,n]=ue.useState(null),[r,i]=ue.useState(null),[s,o]=ue.useState(!0),[l,c]=ue.useState({companyName:""}),[u,f]=ue.useState(!1),[v,g]=ue.useState(!1),p=async()=>{try{console.log(" Verificando si el sistema est configurado...");try{if((await ZL()).hasUsers)return console.log(" Usuarios encontrados en Firestore"),!0}catch(L){console.warn(" Error accediendo a Firestore:",L.message)}return await e8()?(console.log(" Usuarios encontrados en Authentication"),!0):(console.log(" Asumiendo que el sistema est configurado (hay errores de permisos)"),!0)}catch(A){return console.error(" Error verificando configuracin:",A),!0}};ue.useEffect(()=>{(async()=>{try{console.log(" Iniciando verificacin de configuracin..."),console.log(" Verificando configuracin de empresa...");const L=dt(Be,"artifacts",Fe,"public","data","settings","company_info"),E=await vs(L);if(E.exists()){console.log(" Configuracin de empresa encontrada");const G=E.data();console.log(" Configuracin:",G),c(G),g(!0),f(!1),console.log(" Sistema configurado con configuracin existente");return}console.log(" No hay configuracin, verificando si hay usuarios..."),await p()?(console.log(" Sistema ya configurado, saltando setup inicial"),c({companyName:""}),g(!0),f(!1)):(console.log(" Sistema no configurado, mostrando setup inicial"),f(!0))}catch(L){console.error(" Error checking configuration:",L),L.code==="permission-denied"&&(console.error(" Error de permisos de Firestore. Verifica que las reglas estn configuradas correctamente."),console.error(" Consulta firebase-rules.txt para las reglas necesarias.")),console.log(" Error en verificacin, asumiendo que el sistema est configurado"),c({companyName:"App Gestor"}),g(!0),f(!1)}})()},[]),ue.useEffect(()=>{if(!v)return;a8().catch(L=>{console.error("Error inicializando plantillas de contrasea:",L)});const A=nI(Nr,L=>{if(L){const E=dt(Be,"artifacts",Fe,"public","data","users",L.uid),M=Gt(E,async G=>{if(G.exists()){const K=G.data();K.status==="active"||K.role==="superadmin"?(i(K),n(L)):(console.warn("Usuario inactivo o sin permisos:",K),t("Tu cuenta no est activa. Contacta al administrador.","error"),Yl(Nr))}else console.warn("No se encontr el perfil de usuario en la base de datos"),console.log("Usuario no tiene perfil en Firestore, cerrando sesin..."),t("Usuario no encontrado en el sistema. Contacta al administrador.","error"),Yl(Nr);o(!1)},G=>{if(console.error("Error fetching user data:",G),G.code==="permission-denied"){console.warn(" Error de permisos al obtener datos del usuario. Cerrando sesin..."),Yl(Nr).catch(K=>{console.error("Error al cerrar sesin:",K)}),o(!1);return}L&&(console.error(" Verifica que las reglas de Firestore permitan lectura/escritura para usuarios autenticados."),t("Error al cargar el perfil de usuario. Intenta nuevamente.","error")),o(!1)});return()=>M()}else n(null),i(null),o(!1)});return()=>{A()}},[v]);const T=async A=>{const L=Nr.currentUser;if(L)try{await JC(L,A);const E=dt(Be,"artifacts",Fe,"public","data","users",L.uid);await gr(E,{requiresPasswordChange:!1})}catch(E){console.error("Error updating password:",E),t("Hubo un error al cambiar la contrasea.","error"),Yl(Nr)}},k=()=>{Yl(Nr)},C=(l==null?void 0:l.inactivityTimeoutMinutes)||10;r8(()=>{t(`Sesin cerrada por inactividad (${C} minutos sin actividad)`,"warning"),setTimeout(()=>{k()},1e3)},C,!!e);const P=()=>{f(!1),g(!0),window.location.reload()};if(u)return a.jsx(VO,{onComplete:P});if(s)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"Cargando..."});const R=new URLSearchParams(window.location.search),D=R.get("token"),Z=R.get("oobCode"),le=R.get("mode"),U=D&&!Z,j=Z&&le==="resetPassword";if(U)return a.jsx(FO,{companySettings:l,onResetComplete:()=>{window.history.replaceState({},document.title,window.location.pathname),window.location.reload()}});if(j)return a.jsx(MO,{companySettings:l,onResetComplete:()=>{window.history.replaceState({},document.title,window.location.pathname),window.location.reload()}});if(r!=null&&r.requiresPasswordChange&&(r==null?void 0:r.role)!=="superadmin"&&(r==null?void 0:r.role)!=="admin")return a.jsx(OO,{isOpen:!0,onSave:T});const _=R.get("uid"),F=_&&_===(e==null?void 0:e.uid);return(r==null?void 0:r.role)==="client"&&(!(r!=null&&r.isProfileComplete)&&(r==null?void 0:r.requiresPasswordChange)===!1||F)?a.jsx(UO,{isOpen:!0,onComplete:()=>{i(A=>({...A,isProfileComplete:!0})),F&&window.history.replaceState({},document.title,window.location.pathname)},user:e,userProfile:r}):a.jsx("div",{className:"bg-gray-50 min-h-screen font-sans text-gray-800",children:e?a.jsxs(a.Fragment,{children:[a.jsx("header",{className:"bg-white shadow-md",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center",children:[l.logoUrl?a.jsx("img",{src:l.logoUrl,alt:l.companyName,className:"max-h-10"}):a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:l.companyName}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("span",{className:"text-sm text-gray-600 hidden sm:block",children:e.email}),a.jsx("button",{onClick:k,className:"text-gray-500 hover:text-red-600",children:a.jsx(o8,{})})]})]})}),(r==null?void 0:r.role)==="superadmin"||(r==null?void 0:r.role)==="admin"?a.jsx(SO,{user:e,userRole:r==null?void 0:r.role,companySettings:l,onLogout:k}):a.jsx(RO,{user:e,userProfile:r,companySettings:l})]}):a.jsx("div",{className:"flex flex-col min-h-screen",children:a.jsx("div",{className:"flex-grow",children:a.jsx(DO,{companySettings:l})})})})}function $O(){return a.jsx(n8,{children:a.jsx(BO,{})})}S0.createRoot(document.getElementById("root")).render(a.jsx(a3.StrictMode,{children:a.jsx($O,{})}));export{hn as _,qO as c,qS as g};
